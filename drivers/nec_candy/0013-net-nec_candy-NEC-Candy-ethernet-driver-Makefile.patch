From d04c330e7f36bf8027b21e68fd0fece79532ee82 Mon Sep 17 00:00:00 2001
From: Shinya Kuribayashi <shinya.kuribayashi@necel.com>
Date: Tue, 28 Apr 2009 14:19:33 +0900
Subject: [PATCH] net: nec_candy: NEC Candy ethernet driver - Makefile and Kconfig

Add kbuild hooks for the NEC Candy ethernet driver.
At this point in the series, you can configure and build this driver.

Signed-off-by: Shinya Kuribayashi <shinya.kuribayashi@necel.com>
---
 drivers/net/Kconfig  |   40 ++++++++++++++++++++++++++++++++++++++++
 drivers/net/Makefile |    1 +
 2 files changed, 41 insertions(+), 0 deletions(-)

diff --git a/drivers/net/Kconfig b/drivers/net/Kconfig
index 280f7de..f8c2ed7 100644
--- a/drivers/net/Kconfig
+++ b/drivers/net/Kconfig
@@ -1250,6 +1250,46 @@ config IBMVETH
 
 source "drivers/net/ibm_newemac/Kconfig"
 
+config NEC_CANDY
+	tristate "NEC Candy Ethernet support"
+	depends on NEC_CMBVR4133 || EMMA_HAS_NEC_CANDY
+	help
+	  This driver supports the NEC "Candy" Ethernet devices found
+	  on some NEC MIPS boards.
+
+config CANDY_NAPI
+	bool "Enable NAPI support"
+	depends on NEC_CANDY
+	default n
+	help
+	  NAPI is a driver API designed to reduce CPU and interrupt load
+	  when the driver is receiving lots of packets from the card.
+
+	  If your estimated Rx load is 10kpps or more, or if the card will be
+	  deployed on potentially unfriendly networks (e.g. in a firewall),
+	  then say Y here.
+
+	  You may want to say N here in case of low packets rates where latency
+	  is extremely important and no packet overload is likely.
+
+	  See <file:Documentation/networking/NAPI_HOWTO.txt> for more
+	  information.
+
+	  If in doubt, say Y.
+
+config CANDY_AFCE2
+	bool "Use Auto Flow Control"
+	depends on NEC_CANDY
+	default n
+	help
+	  Flow control is realized during full-duplex communication by using
+	  a PAUSE control frame conforming to IEEE 802.3x. During half-duplex
+	  communication, flow control is realized by a back-pressure function.
+	  Flow control is executed if the number of remaining receive buffer
+	  descriptors are less than a threshold value.
+
+	  If unsure, say N.
+
 config NET_PCI
 	bool "EISA, VLB, PCI and on board controllers"
 	depends on ISA || EISA || PCI
diff --git a/drivers/net/Makefile b/drivers/net/Makefile
index de81c8a..30502a0 100644
--- a/drivers/net/Makefile
+++ b/drivers/net/Makefile
@@ -222,6 +222,7 @@ obj-$(CONFIG_PASEMI_MAC) += pasemi_mac_driver.o
 pasemi_mac_driver-objs := pasemi_mac.o pasemi_mac_ethtool.o
 obj-$(CONFIG_MLX4_CORE) += mlx4/
 obj-$(CONFIG_ENC28J60) += enc28j60.o
+obj-$(CONFIG_NEC_CANDY) += nec_candy.o
 
 obj-$(CONFIG_MACB) += macb.o
 
-- 
1.6.0.4

