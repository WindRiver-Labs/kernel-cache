From 809ac6f1dc567295496c6d45da505e6bf2814e31 Mon Sep 17 00:00:00 2001
From: peter fuerst <post@pfrst.de>
Date: Sun, 17 May 2009 23:49:45 +0200
Subject: [PATCH 053/117] MIPS: IP28: Change to build with -mr10k-cache-barrier=store

commit 809ac6f1dc567295496c6d45da505e6bf2814e31 from linux-mips

Richard Sandiford's new code for inserting the cache-barriers, for GCC
4.3 and above and already incorporated in the current GCC-release, uses
a slightly different option-syntax.

Signed-off-by: peter fuerst <post@pfrst.de>
Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
(cherry picked from commit e8833b2c705a21297877914e096990ba6c1ad9f3)
---
 arch/mips/Makefile |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/mips/Makefile b/arch/mips/Makefile
index 8649da7..a15fd59 100644
--- a/arch/mips/Makefile
+++ b/arch/mips/Makefile
@@ -455,12 +455,12 @@ endif
 # Simplified: what IP22 does at 128MB+ in ksegN, IP28 does at 512MB+ in xkphys
 #
 ifdef CONFIG_SGI_IP28
-  ifeq ($(call cc-option-yn,-mr10k-cache-barrier=1), n)
-      $(error gcc doesn't support needed option -mr10k-cache-barrier=1)
+  ifeq ($(call cc-option-yn,-mr10k-cache-barrier=store), n)
+      $(error gcc doesn't support needed option -mr10k-cache-barrier=store)
   endif
 endif
 core-$(CONFIG_SGI_IP28)		+= arch/mips/sgi-ip22/
-cflags-$(CONFIG_SGI_IP28)	+= -mr10k-cache-barrier=1 -Iinclude/asm-mips/mach-ip28
+cflags-$(CONFIG_SGI_IP28)	+= -mr10k-cache-barrier=store -Iinclude/asm-mips/mach-ip28
 load-$(CONFIG_SGI_IP28)		+= 0xa800000020004000
 
 #
-- 
1.7.0

