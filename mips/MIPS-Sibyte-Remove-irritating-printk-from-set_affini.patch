From 48902551d20ae70285036f002b7c27d974f4dbb5 Mon Sep 17 00:00:00 2001
From: Thomas Bogendoerfer <tsbogend@alpha.franken.de>
Date: Sat, 6 Jun 2009 09:53:55 +0200
Subject: [PATCH 059/117] MIPS: Sibyte: Remove irritating printk from set_affinity

commit 48902551d20ae70285036f002b7c27d974f4dbb5 from linux-mips

set_affinity() will be called with cpui masks, which have more than one
cpu set.  Instead of generating noise we now select the first set
cpu and use that for setting affinity.  The printk was being triggered
frequently by recent distributions running on recent kernels.

Signed-off-by: Thomas Bogendoerfer <tsbogend@alpha.franken.de>
Signed-off-by: Ralf Baechle <ralf@linux-mips.org>
(cherry picked from commit 14275ccdb1e4b487cca745aba994699c426a31ee)
---
 arch/mips/sibyte/bcm1480/irq.c |    4 ----
 arch/mips/sibyte/sb1250/irq.c  |    5 -----
 2 files changed, 0 insertions(+), 9 deletions(-)

diff --git a/arch/mips/sibyte/bcm1480/irq.c b/arch/mips/sibyte/bcm1480/irq.c
index cd1d152..abc8929 100644
--- a/arch/mips/sibyte/bcm1480/irq.c
+++ b/arch/mips/sibyte/bcm1480/irq.c
@@ -116,10 +116,6 @@ static void bcm1480_set_affinity(unsigned int irq, cpumask_t mask)
 	unsigned long flags;
 	unsigned int irq_dirty;
 
-	if (cpus_weight(mask) != 1) {
-		printk("attempted to set irq affinity for irq %d to multiple CPUs\n", irq);
-		return;
-	}
 	i = first_cpu(mask);
 
 	/* Convert logical CPU to physical CPU */
diff --git a/arch/mips/sibyte/sb1250/irq.c b/arch/mips/sibyte/sb1250/irq.c
index d4f37cd..475d9e9 100644
--- a/arch/mips/sibyte/sb1250/irq.c
+++ b/arch/mips/sibyte/sb1250/irq.c
@@ -111,11 +111,6 @@ static void sb1250_set_affinity(unsigned int irq, cpumask_t mask)
 
 	i = first_cpu(mask);
 
-	if (cpus_weight(mask) > 1) {
-		printk("attempted to set irq affinity for irq %d to multiple CPUs\n", irq);
-		return;
-	}
-
 	/* Convert logical CPU to physical CPU */
 	cpu = cpu_logical_map(i);
 
-- 
1.7.0

