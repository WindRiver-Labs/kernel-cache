From e2b49cf38a326fb56ef053cf0d8d09ae776a5184 Mon Sep 17 00:00:00 2001
From: Lans Zhang <jia.zhang@windriver.com>
Date: Wed, 20 May 2009 15:32:10 +0800
Subject: [PATCH] mips/cavium: return correct sockopt size for n32 on 64bit target

Replace sys_getsockopt with compat_sys_getsockopt to get the
correct sockopt size, which guarantees requested match filled
with the correct size against the size checking.

Signed-off-by: Benson Li <Benson.Li@windriver.com>
Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
---
 arch/mips/kernel/scall64-n32.S |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/mips/kernel/scall64-n32.S b/arch/mips/kernel/scall64-n32.S
index 8287d3d..1b50477 100644
--- a/arch/mips/kernel/scall64-n32.S
+++ b/arch/mips/kernel/scall64-n32.S
@@ -174,7 +174,7 @@ EXPORT(sysn32_call_table)
 	PTR	sys_getpeername
 	PTR	sys_socketpair
 	PTR	compat_sys_setsockopt
-	PTR	sys_getsockopt
+	PTR     compat_sys_getsockopt
 	PTR	sys_clone			/* 6055 */
 	PTR	sys_fork
 	PTR	sys32_execve
-- 
1.6.3.3

