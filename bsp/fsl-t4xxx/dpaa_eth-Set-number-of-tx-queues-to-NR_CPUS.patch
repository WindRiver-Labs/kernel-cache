From 288351ccb7d8c821030cb0a88f0245942d34082f Mon Sep 17 00:00:00 2001
From: Andy Fleming <afleming@freescale.com>
Date: Fri, 13 Jul 2012 14:47:16 -0500
Subject: [PATCH 55/57] dpaa_eth: Set number of tx queues to NR_CPUS

commit fd8ad2ad54cd78f31a115550c957429f2b7dbdfa from
https://git.freescale.com/git-private/cgit.cgi/ppc/t4240/linux.git

The TX code for dpaa_eth relies on having one tx queue for each
cpu in the system. The problem is that we hard-coded the number
of TX queues to be 8, which was "fine" when we only had up to 8
cores, but problematic when we have 24. NR_CPUS will ensure that
we never have fewer queues than cores.

Signed-off-by: Andy Fleming <afleming@freescale.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.h |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.h b/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
index 4b938ef..b271bf4 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
@@ -58,7 +58,7 @@
 
 
 /* number of Tx queues to FMan */
-#define DPAA_ETH_TX_QUEUES	8
+#define DPAA_ETH_TX_QUEUES	NR_CPUS
 #define DPAA_ETH_RX_QUEUES	128
 
 #if defined(CONFIG_DPAA_FMAN_UNIT_TESTS)
-- 
1.7.9.7

