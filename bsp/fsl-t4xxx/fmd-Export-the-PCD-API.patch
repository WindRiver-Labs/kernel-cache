From 52f8258a535a69893474e4eac049ae294b733a4f Mon Sep 17 00:00:00 2001
From: Andrei Pistirica <sorin.pistirica@freescale.com>
Date: Wed, 20 Jun 2012 17:47:27 +0000
Subject: [PATCH 34/57] fmd: Export the PCD API

commit 1a8ec5d6ed514e9a7a96f496b15078cfb4625258 from
https://git.freescale.com/git-private/cgit.cgi/ppc/t4240/linux.git

This patch provides support for kernel modules to call FMan LLD API.
Since NCSW LLD code cannot be modified, create a new header instead of
adding EXPORT_SYMBOL in the .c files.

Signed-off-by: Andrei Pistirica <sorin.pistirica@freescale.com>
Signed-off-by: Anca Floarea  <Anca.Floarea@freescale.com>
Signed-off-by: Emil Medve <Emilian.Medve@Freescale.com>
---
 .../dpa/NetCommSw/src/inc/wrapper/lnxwrp_exp_sym.h |   98 ++++++++++++++++++++
 .../dpa/NetCommSw/src/wrapper/lnxwrp_fm.c          |    2 +
 2 files changed, 100 insertions(+)
 create mode 100644 drivers/net/ethernet/freescale/dpa/NetCommSw/src/inc/wrapper/lnxwrp_exp_sym.h

diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/inc/wrapper/lnxwrp_exp_sym.h b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/inc/wrapper/lnxwrp_exp_sym.h
new file mode 100644
index 0000000..debe462
--- /dev/null
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/inc/wrapper/lnxwrp_exp_sym.h
@@ -0,0 +1,98 @@
+/* Copyright (c) 2008-2012 Freescale Semiconductor, Inc.
+ * All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions are met:
+ *     * Redistributions of source code must retain the above copyright
+ *       notice, this list of conditions and the following disclaimer.
+ *     * Redistributions in binary form must reproduce the above copyright
+ *       notice, this list of conditions and the following disclaimer in the
+ *       documentation and/or other materials provided with the distribution.
+ *     * Neither the name of Freescale Semiconductor nor the
+ *       names of its contributors may be used to endorse or promote products
+ *       derived from this software without specific prior written permission.
+ *
+ *
+ * ALTERNATIVELY, this software may be distributed under the terms of the
+ * GNU General Public License ("GPL") as published by the Free Software
+ * Foundation, either version 2 of that License or (at your option) any
+ * later version.
+ *
+ * THIS SOFTWARE IS PROVIDED BY Freescale Semiconductor ``AS IS'' AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+ * DISCLAIMED. IN NO EVENT SHALL Freescale Semiconductor BE LIABLE FOR ANY
+ * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
+ * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ */
+
+/*
+ @File          lnxwrp_exp_sym.h
+ @Description   FMan exported routines
+*/
+
+#ifndef __LNXWRP_EXP_SYM_H
+#define __LNXWRP_EXP_SYM_H
+
+#include "fm_port_ext.h"
+#include "fm_pcd_ext.h"
+
+
+/* FMAN Port exported routines */
+EXPORT_SYMBOL(FM_PORT_Disable);
+EXPORT_SYMBOL(FM_PORT_Enable);
+EXPORT_SYMBOL(FM_PORT_SetPCD);
+EXPORT_SYMBOL(FM_PORT_SetOpWorkarounds);
+
+/* Runtime PCD exported routines */
+EXPORT_SYMBOL(FM_PCD_Enable);
+EXPORT_SYMBOL(FM_PCD_Disable);
+EXPORT_SYMBOL(FM_PCD_GetCounter);
+EXPORT_SYMBOL(FM_PCD_PrsLoadSw);
+EXPORT_SYMBOL(FM_PCD_KgSetDfltValue);
+EXPORT_SYMBOL(FM_PCD_KgSetAdditionalDataAfterParsing);
+EXPORT_SYMBOL(FM_PCD_SetException);
+EXPORT_SYMBOL(FM_PCD_ModifyCounter);
+EXPORT_SYMBOL(FM_PCD_SetPlcrStatistics);
+EXPORT_SYMBOL(FM_PCD_SetPrsStatistics);
+EXPORT_SYMBOL(FM_PCD_ForceIntr);
+EXPORT_SYMBOL(FM_PCD_HcTxConf);
+EXPORT_SYMBOL(FM_PCD_SetNetEnvCharacteristics);
+EXPORT_SYMBOL(FM_PCD_DeleteNetEnvCharacteristics);
+EXPORT_SYMBOL(FM_PCD_KgSetScheme);
+EXPORT_SYMBOL(FM_PCD_KgDeleteScheme);
+EXPORT_SYMBOL(FM_PCD_KgGetSchemeCounter);
+EXPORT_SYMBOL(FM_PCD_KgSetSchemeCounter);
+EXPORT_SYMBOL(FM_PCD_CcBuildTree);
+EXPORT_SYMBOL(FM_PCD_CcDeleteTree);
+EXPORT_SYMBOL(FM_PCD_CcSetNode);
+EXPORT_SYMBOL(FM_PCD_CcDeleteNode);
+EXPORT_SYMBOL(FM_PCD_CcTreeModifyNextEngine);
+EXPORT_SYMBOL(FM_PCD_CcNodeModifyNextEngine);
+EXPORT_SYMBOL(FM_PCD_CcNodeModifyMissNextEngine);
+EXPORT_SYMBOL(FM_PCD_CcNodeRemoveKey);
+EXPORT_SYMBOL(FM_PCD_CcNodeAddKey);
+EXPORT_SYMBOL(FM_PCD_CcNodeModifyKeyAndNextEngine);
+EXPORT_SYMBOL(FM_PCD_CcNodeModifyKey);
+EXPORT_SYMBOL(FM_PCD_CcIndexedHashNodeGetBucket);
+EXPORT_SYMBOL(FM_PCD_CcNodeGetNextEngine);
+EXPORT_SYMBOL(FM_PCD_CcNodeGetKeyCounter);
+EXPORT_SYMBOL(FM_PCD_PlcrSetProfile);
+EXPORT_SYMBOL(FM_PCD_PlcrDeleteProfile);
+EXPORT_SYMBOL(FM_PCD_PlcrGetProfileCounter);
+EXPORT_SYMBOL(FM_PCD_PlcrSetProfileCounter);
+
+#if defined(FM_CAPWAP_SUPPORT) || defined(FM_IP_FRAG_N_REASSEM_SUPPORT)
+EXPORT_SYMBOL(FM_PCD_ManipSetNode);
+EXPORT_SYMBOL(FM_PCD_ManipDeleteNode);
+#endif /* defined(FM_CAPWAP_SUPPORT) || ... */
+
+#ifdef FM_CAPWAP_SUPPORT
+EXPORT_SYMBOL(FM_PCD_StatisticsSetNode);
+#endif /* FM_CAPWAP_SUPPORT */
+
+#endif /* __LNXWRP_EXP_SYM_H */
diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
index 9b84edf..8f8d2d2 100644
--- a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
@@ -78,6 +78,8 @@
 #include "lnxwrp_sysfs_fm.h"
 #include "lnxwrp_sysfs_fm_port.h"
 
+#include "lnxwrp_exp_sym.h"
+
 #define PROC_PRINT(args...) offset += sprintf(buf+offset,args)
 
 #define ADD_ADV_CONFIG_NO_RET(_func, _param)    \
-- 
1.7.9.7

