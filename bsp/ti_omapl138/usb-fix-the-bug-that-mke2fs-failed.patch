From 5a45e71e472ca83ef5b73441bfc32e473b8ca042 Mon Sep 17 00:00:00 2001
From: Stanley.Miao <stanley.miao@windriver.com>
Date: Wed, 9 Dec 2009 16:29:12 +0800
Subject: [PATCH] usb: fix the bug that mke2fs failed.

There has to be a delay before the DMA transfer started, or it might fail.

Signed-off-by: Stanley.Miao <stanley.miao@windriver.com>
---
 drivers/usb/musb/da8xx.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/usb/musb/da8xx.c b/drivers/usb/musb/da8xx.c
index 29acb10..146c164 100644
--- a/drivers/usb/musb/da8xx.c
+++ b/drivers/usb/musb/da8xx.c
@@ -415,6 +415,7 @@ static irqreturn_t da8xx_interrupt(int irq, void *hci)
 			u32 rx = (pend0 >> 26) & 0x3;
 
 			DBG(4, "CPPI 4.1 IRQ: Tx %x, Rx %x\n", tx, rx);
+			udelay(50);
 			cppi41_completion(musb, rx, tx);
 			ret = IRQ_HANDLED;
 		}
-- 
1.6.0.3

