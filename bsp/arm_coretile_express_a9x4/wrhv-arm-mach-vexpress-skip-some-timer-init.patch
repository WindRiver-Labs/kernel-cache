From 2535bb65c1fab19983fc7525b6a4b8acd1e457db Mon Sep 17 00:00:00 2001
From: Jim Somerville <Jim.Somerville@windriver.com>
Date: Tue, 20 Sep 2011 19:28:19 -0400
Subject: [PATCH] wrhv: arm: mach-vexpress skip some timer init

We don't use, and don't want to bind either of these
timers into our interrupt system.

Signed-off-by: Jim Somerville <Jim.Somerville@windriver.com>
---
 arch/arm/mach-vexpress/v2m.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-vexpress/v2m.c b/arch/arm/mach-vexpress/v2m.c
index 9177901..2cf192f 100644
--- a/arch/arm/mach-vexpress/v2m.c
+++ b/arch/arm/mach-vexpress/v2m.c
@@ -56,11 +56,13 @@ static void __init v2m_timer_init(void)
 {
 	versatile_sched_clock_init(MMIO_P2V(V2M_SYS_24MHZ), 24000000);
 
+#ifndef CONFIG_WRHV
 	writel(0, MMIO_P2V(V2M_TIMER0) + TIMER_CTRL);
 	writel(0, MMIO_P2V(V2M_TIMER1) + TIMER_CTRL);
 
 	sp804_clocksource_init(MMIO_P2V(V2M_TIMER1));
 	sp804_clockevents_init(MMIO_P2V(V2M_TIMER0), IRQ_V2M_TIMER0);
+#endif
 }
 
 struct sys_timer v2m_timer = {
-- 
1.7.0.4

