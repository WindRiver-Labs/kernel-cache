From 3788aa79165be1cc01ee40502c3e3a279a02d803 Mon Sep 17 00:00:00 2001
From: Michel Thebeau <michel.thebeau@windriver.com>
Date: Thu, 27 Sep 2012 10:29:16 -0400
Subject: [PATCH] mxc/CAN: update usage of add_interrupt_randomness()

The following upstream stable commit adds a flag/action parameter to
add_interrupt_randomness(), so that if:

         * we don't have a valid cycle counter, and we see
         * back-to-back timer interrupts, then skip giving credit for
         * any entropy.

upstream commit 17ef73f8c0be242d38efe9b28d9caaca9c3ef442
    random: make 'add_interrupt_randomness()' do something sane

This interrupt in drivers/net/can/flexcan/drv.c is "IRQF_SHARED", so
pass that on to add_interrupt_randomness().

Signed-off-by: Michel Thebeau <michel.thebeau@windriver.com>
---
 drivers/net/can/flexcan/drv.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/net/can/flexcan/drv.c b/drivers/net/can/flexcan/drv.c
index 97e9fda..7cc5b80e 100644
--- a/drivers/net/can/flexcan/drv.c
+++ b/drivers/net/can/flexcan/drv.c
@@ -427,7 +427,7 @@ static int flexcan_open(struct net_device *dev)
 	if (request_irq(flexcan->irq, flexcan_irq_handler, IRQF_SHARED,
 			dev->name, dev))
 		goto irq_err;
-	add_interrupt_randomness(flexcan->irq);
+	add_interrupt_randomness(flexcan->irq, IRQF_SHARED);
 
 	if (flexcan_hw_open(flexcan))
 		goto open_err;
-- 
1.7.9.7

