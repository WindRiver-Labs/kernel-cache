From e1cd337d4d76e58274fa01968bbd6076b8f86dc5 Mon Sep 17 00:00:00 2001
From: Felipe Balbi <balbi@ti.com>
Date: Fri, 28 Aug 2015 02:27:51 +0000
Subject: [PATCH 528/800] usb: dwc3: core: remove oevt

we don't need to mess around with that for
suspend/resume. In fact we could cause events
to be missed by clearing them on resume mistakenly.

Signed-off-by: Felipe Balbi <balbi@ti.com>
Signed-off-by: Sekhar Nori <nsekhar@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/usb/dwc3/core.c |    2 --
 drivers/usb/dwc3/core.h |    1 -
 2 files changed, 0 insertions(+), 3 deletions(-)

diff --git a/drivers/usb/dwc3/core.c b/drivers/usb/dwc3/core.c
index 7922f88..6318541 100644
--- a/drivers/usb/dwc3/core.c
+++ b/drivers/usb/dwc3/core.c
@@ -1575,7 +1575,6 @@ static int dwc3_suspend(struct device *dev)
 	if (dwc->current_mode == DWC3_GCTL_PRTCAP_OTG) {
 		dwc->ocfg = dwc3_readl(dwc->regs, DWC3_OCFG);
 		dwc->octl = dwc3_readl(dwc->regs, DWC3_OCTL);
-		dwc->oevt = dwc3_readl(dwc->regs, DWC3_OEVT);
 		dwc3_otg_mask_irq(dwc);
 	}
 
@@ -1625,7 +1624,6 @@ static int dwc3_resume(struct device *dev)
 	if (dwc->current_mode == DWC3_GCTL_PRTCAP_OTG) {
 		dwc3_writel(dwc->regs, DWC3_OCFG, dwc->ocfg);
 		dwc3_writel(dwc->regs, DWC3_OCTL, dwc->octl);
-		dwc3_writel(dwc->regs, DWC3_OEVT, dwc->oevt);
 		dwc3_otg_unmask_irq(dwc);
 	}
 
diff --git a/drivers/usb/dwc3/core.h b/drivers/usb/dwc3/core.h
index 0b2be84..86e0fbd 100644
--- a/drivers/usb/dwc3/core.h
+++ b/drivers/usb/dwc3/core.h
@@ -876,7 +876,6 @@ struct dwc3 {
 	u32			gctl;
 	u32			ocfg;
 	u32			octl;
-	u32			oevt;
 
 	u32			current_mode;
 	u32			nr_scratch;
-- 
1.7.5.4

