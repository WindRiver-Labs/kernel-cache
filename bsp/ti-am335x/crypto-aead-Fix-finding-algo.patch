From f7d20cdcacd975574ce5f29062f354edf65c3228 Mon Sep 17 00:00:00 2001
From: Lokesh Vutla <lokeshvutla@ti.com>
Date: Mon, 13 Jul 2015 11:16:09 +0530
Subject: [PATCH 236/800] crypto: aead: Fix finding algo

crypto_aead_type doesn't look for crypto_nivaead_type algos
and checks only for crypto_aead_type. So all the crypto_nivaead_type
algos doesn't give any interface to the user.
Fixing the same.

Signed-off-by: Lokesh Vutla <lokeshvutla@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 crypto/aead.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/crypto/aead.c b/crypto/aead.c
index 2222710..3b7e257 100644
--- a/crypto/aead.c
+++ b/crypto/aead.c
@@ -479,6 +479,9 @@ struct crypto_alg *crypto_lookup_aead(const char *name, u32 type, u32 mask)
 	if (alg->cra_type == &crypto_aead_type)
 		return alg;
 
+	if (alg->cra_type == &crypto_nivaead_type)
+		return alg;
+
 	if (!alg->cra_aead.ivsize)
 		return alg;
 
-- 
1.7.5.4

