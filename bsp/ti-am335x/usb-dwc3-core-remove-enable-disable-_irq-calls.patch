From 2e493eeecefa413688f822df9518a23176676c1c Mon Sep 17 00:00:00 2001
From: Felipe Balbi <balbi@ti.com>
Date: Fri, 28 Aug 2015 02:27:47 +0000
Subject: [PATCH 524/800] usb: dwc3: core: remove {enable, disable}_irq()
 calls

We're already masking/unmasking all OTG irqs via
dwc3's registers, there's no need to fiddle with
{enable,disable}_irq().

Also, disable_irq() might_sleep() and that's what's
really causing the warning to be printed out.

Signed-off-by: Felipe Balbi <balbi@ti.com>
Signed-off-by: Sekhar Nori <nsekhar@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/usb/dwc3/core.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

diff --git a/drivers/usb/dwc3/core.c b/drivers/usb/dwc3/core.c
index 557c6ba..ffeecae 100644
--- a/drivers/usb/dwc3/core.c
+++ b/drivers/usb/dwc3/core.c
@@ -1571,7 +1571,6 @@ static int dwc3_suspend(struct device *dev)
 		dwc->oevt = dwc3_readl(dwc->regs, DWC3_OEVT);
 		dwc->oevten = dwc3_readl(dwc->regs, DWC3_OEVTEN);
 		dwc3_writel(dwc->regs, DWC3_OEVTEN, 0);
-		disable_irq(dwc->otg_irq);
 	}
 
 	if (dwc->dr_mode == USB_DR_MODE_PERIPHERAL ||
@@ -1622,7 +1621,6 @@ static int dwc3_resume(struct device *dev)
 		dwc3_writel(dwc->regs, DWC3_OCTL, dwc->octl);
 		dwc3_writel(dwc->regs, DWC3_OEVT, dwc->oevt);
 		dwc3_writel(dwc->regs, DWC3_OEVTEN, dwc->oevten);
-		enable_irq(dwc->otg_irq);
 	}
 
 	if (dwc->dr_mode == USB_DR_MODE_PERIPHERAL ||
-- 
1.7.5.4

