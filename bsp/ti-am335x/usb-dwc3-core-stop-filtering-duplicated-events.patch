From d4a5be78e5d3c015542c00e057df8b7e3e716fd4 Mon Sep 17 00:00:00 2001
From: Felipe Balbi <balbi@ti.com>
Date: Fri, 28 Aug 2015 16:14:39 -0500
Subject: [PATCH 543/800] usb: dwc3: core: stop filtering duplicated events

we're making sure duplicated calls won't touch
the HW and it's a lot cleaner than adding conditionals
to filter at dwc3 level.

OTG layer might want to know about duplicated events
at some point.

Signed-off-by: Felipe Balbi <balbi@ti.com>
Signed-off-by: Sekhar Nori <nsekhar@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/usb/dwc3/core.c |   10 ++++------
 1 files changed, 4 insertions(+), 6 deletions(-)

diff --git a/drivers/usb/dwc3/core.c b/drivers/usb/dwc3/core.c
index 2751a94..aefe13a 100644
--- a/drivers/usb/dwc3/core.c
+++ b/drivers/usb/dwc3/core.c
@@ -842,12 +842,10 @@ static void dwc3_otg_fsm_sync(struct dwc3 *dwc)
 	id = !!(reg & DWC3_OSTS_CONIDSTS);
 	vbus = !!(reg & DWC3_OSTS_BSESVLD);
 
-	if (id != dwc->fsm->id || vbus != dwc->fsm->vbus) {
-		dev_dbg(dwc->dev, "id %d vbus %d\n", id, vbus);
-		dwc->fsm->id = id;
-		dwc->fsm->vbus = vbus;
-		usb_otg_sync_inputs(dwc->fsm);
-	}
+	dev_dbg(dwc->dev, "id %d vbus %d\n", id, vbus);
+	dwc->fsm->id = id;
+	dwc->fsm->vbus = vbus;
+	usb_otg_sync_inputs(dwc->fsm);
 }
 
 static void dwc3_otg_mask_irq(struct dwc3 *dwc)
-- 
1.7.5.4

