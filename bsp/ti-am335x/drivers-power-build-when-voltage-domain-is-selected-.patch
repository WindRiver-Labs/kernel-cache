From 7f940c4933b54237165714fe5ad3ae85c7eb5a08 Mon Sep 17 00:00:00 2001
From: Nishanth Menon <nm@ti.com>
Date: Mon, 19 Oct 2015 11:30:28 -0500
Subject: [PATCH 794/800] drivers: power: build when voltage domain is
 selected as well

drivers/power is not built when CONFIG_POWER_SUPPLY is disabled.

This does not allow voltage domain driver to get built as well, since
voltage domain drivers are in drivers/power/voltdm. So force power
directory to be entered for build when voltagedomain is defined as well.

This fixes the following build error with randconfig:

drivers/built-in.o: In function `cpufreq_exit':
linux/drivers/cpufreq/cpufreq-voltdm.c:217: undefined reference to `of_pm_voltdm_notifier_unregister'
drivers/built-in.o: In function `cpufreq_init':
linux/drivers/cpufreq/cpufreq-voltdm.c:165: undefined reference to `of_pm_voltdm_notifier_register'
drivers/built-in.o: In function `voltdm_cpufreq_probe':
linux/drivers/cpufreq/cpufreq-voltdm.c:291: undefined reference to `of_pm_voltdm_notifier_register'
linux/drivers/cpufreq/cpufreq-voltdm.c:312: undefined reference to `of_pm_voltdm_notifier_unregister'

Reported-by: Tomi Valkeinen <tomi.valkeinen@ti.com>
Signed-off-by: Nishanth Menon <nm@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/Makefile |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/Makefile b/drivers/Makefile
index 46d2554..08749aa 100644
--- a/drivers/Makefile
+++ b/drivers/Makefile
@@ -105,6 +105,7 @@ obj-$(CONFIG_PPS)		+= pps/
 obj-$(CONFIG_PTP_1588_CLOCK)	+= ptp/
 obj-$(CONFIG_W1)		+= w1/
 obj-$(CONFIG_POWER_SUPPLY)	+= power/
+obj-$(CONFIG_VOLTAGE_DOMAIN)	+= power/
 obj-$(CONFIG_HWMON)		+= hwmon/
 obj-$(CONFIG_THERMAL)		+= thermal/
 obj-$(CONFIG_WATCHDOG)		+= watchdog/
-- 
1.7.5.4

