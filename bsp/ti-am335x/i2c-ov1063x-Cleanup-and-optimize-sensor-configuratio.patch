From 078f9c5a435756f3337eb04c7e548ac894f75e6a Mon Sep 17 00:00:00 2001
From: Nikhil Devshatwar <nikhil.nd@ti.com>
Date: Wed, 26 Aug 2015 19:28:57 -0500
Subject: [PATCH 533/800] i2c: ov1063x: Cleanup and optimize sensor
 configuration

Remove unnecessary delay for sensor internal writes.
Also remove the LVDS specific sensor configuration parameters.
No need to configure the sensor registers differently for LVDS cameras.

Exception for this being the PLL values. Configure the LVDS specific
PLL values (which work for the normal cameras also)

Signed-off-by: Nikhil Devshatwar <nikhil.nd@ti.com>
Signed-off-by: Benoit Parrot <bparrot@ti.com>
Signed-off-by: Jyri Sarha <jsarha@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/media/i2c/ov1063x.c      |    2 --
 drivers/media/i2c/ov1063x_regs.h |   23 -----------------------
 2 files changed, 0 insertions(+), 25 deletions(-)

diff --git a/drivers/media/i2c/ov1063x.c b/drivers/media/i2c/ov1063x.c
index 493e341..dad3344 100644
--- a/drivers/media/i2c/ov1063x.c
+++ b/drivers/media/i2c/ov1063x.c
@@ -637,8 +637,6 @@ static int ov1063x_set_params(struct i2c_client *client, u32 width, u32 height)
 	if (ret)
 		return ret;
 
-	/* Wait for settings to take effect */
-	usleep_range(500000, 500100);
 
 	return 0;
 }
diff --git a/drivers/media/i2c/ov1063x_regs.h b/drivers/media/i2c/ov1063x_regs.h
index f17d012..45819e0 100644
--- a/drivers/media/i2c/ov1063x_regs.h
+++ b/drivers/media/i2c/ov1063x_regs.h
@@ -62,13 +62,8 @@ static const struct ov1063x_reg ov1063x_regs_default[] = {
 		 */
 		/* {0x3003, 0x1B}, */ /* fps = 30fps. */
 		/* {0x3004, 0x03}, */
-#ifdef CONFIG_VIDEO_TI_LVDS
 		{0x3003, 0x20}, /* fps = 15fps. */
 		{0x3004, 0x3},
-#else
-		{0x3003, 0x28}, /* fps = 15fps. */
-		{0x3004, 0x31},
-#endif
 		{0x3005, 0x20},
 		{0x3006, 0x91},
 		{0x3600, 0x74},
@@ -117,13 +112,8 @@ static const struct ov1063x_reg ov1063x_regs_default[] = {
 		{0x380b, 0xd0},
 		{0x380c, 0x6},
 		{0x380d, 0xf6}, /* 1280x720 */
-#ifdef CONFIG_VIDEO_TI_LVDS
-		{0x380e, 0x3},
-		{0x380f, 0x80},
-#else
 		{0x380e, 0x2},
 		{0x380f, 0xec}, /* 1280x720 */
-#endif
 		{0x3811, 0x8},
 		{0x381f, 0xc},
 		{0x3621, 0x63},
@@ -307,11 +297,7 @@ static const struct ov1063x_reg ov1063x_regs_default[] = {
 		{0x5252, 0x12},
 		{0x5254, 0x18},
 		{0x5256, 0x1e},
-#ifdef CONFIG_VIDEO_TI_LVDS
-		{0x4605, 0x8},
-#else
 		{0x4605, 0x00}, /* 8-bit YUV mode. */
-#endif
 		{0x4606, 0x7},
 		{0x4607, 0x71},
 		{0x460a, 0x2},
@@ -351,11 +337,7 @@ static const struct ov1063x_reg ov1063x_regs_default[] = {
 		{0x4611, 0x1},
 		{0x4612, 0x0},
 		{0x4613, 0x1},
-#ifdef CONFIG_VIDEO_TI_LVDS
-		{0x4605, 0x8},
-#else
 		{0x4605, 0x00},
-#endif
 		{0x4608, 0x0},
 		{0x4609, 0x8},
 		{0x6804, 0x0},
@@ -612,11 +594,7 @@ static const struct ov1063x_reg ov1063x_regs_default[] = {
 		 * 0x6706[3:0] :: 8 = 24MHz
 		 * 0x6706[3:0] :: 9 = 27MHz
 		 */
-#ifdef CONFIG_VIDEO_TI_LVDS
-		{0x6706, 0x78},
-#else
 		{0x6706, 0x71},
-#endif
 		{0x6708, 0x5},
 		{0x3822, 0x50},
 		{0x6f06, 0x6f},
@@ -653,7 +631,6 @@ static const struct ov1063x_reg ov1063x_regs_default[] = {
 		{0x301b, 0xf0},
 		{0x301c, 0xf0},
 		{0x301a, 0xf0},
-		{0x301c, 0x70},
 };
 
 static const struct ov1063x_reg ov1063x_regs_change_mode[] = {
-- 
1.7.5.4

