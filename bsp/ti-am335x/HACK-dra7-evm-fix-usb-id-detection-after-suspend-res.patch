From 1ee6cc83cadc9b90f20a9fa796cc2a00d6a8c985 Mon Sep 17 00:00:00 2001
From: Roger Quadros <rogerq@ti.com>
Date: Sat, 12 Sep 2015 20:03:50 +0300
Subject: [PATCH 564/800] HACK: dra7-evm: fix usb id detection after
 suspend/resume

On dra7, the omap-gpio driver stops generating interrupts if
disable_irq_wake is called on the gpio interrupt causing us
to miss usb otg adapter changes.

We fix our USB case by not calling disable_irq_wake ever
but this must be ideally fixed in the omap-gpio driver.
That's why this is a HACK.

Cc: Nishant Menon <nm@ti.com>
Cc: Lokesh Vutla <lokeshvutla@ti.com>
Signed-off-by: Roger Quadros <rogerq@ti.com>
Signed-off-by: Sekhar Nori <nsekhar@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/extcon/extcon-usb-gpio.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/extcon/extcon-usb-gpio.c b/drivers/extcon/extcon-usb-gpio.c
index 56edde5..be4bd4f 100644
--- a/drivers/extcon/extcon-usb-gpio.c
+++ b/drivers/extcon/extcon-usb-gpio.c
@@ -156,7 +156,7 @@ static int usb_extcon_probe(struct platform_device *pdev)
 	}
 
 	platform_set_drvdata(pdev, info);
-	device_init_wakeup(dev, 1);
+	device_init_wakeup(dev, 0);
 
 	/* Perform initial detection */
 	usb_extcon_detect_cable(&info->wq_detcable.work);
-- 
1.7.5.4

