From 4b3e5063abe6391ce6e85b39ec7d38a951c97f7e Mon Sep 17 00:00:00 2001
From: Suman Anna <s-anna@ti.com>
Date: Mon, 23 Feb 2015 13:59:05 -0600
Subject: [PATCH 790/800] remoteproc/pruss: set recovery_disabled flag
 properly

The error recovery feature is not supported for the PRU
remote processors. The flag is a negative flag, so mark
the rproc configuration flag appropriately for PRUs.

The debugfs interface behavior is unchanged, as there
are no true triggers for recovery anyways for the PRU
processors.

Signed-off-by: Suman Anna <s-anna@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/remoteproc/pruss_remoteproc.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/remoteproc/pruss_remoteproc.c b/drivers/remoteproc/pruss_remoteproc.c
index eec7f1e..84b48af 100644
--- a/drivers/remoteproc/pruss_remoteproc.c
+++ b/drivers/remoteproc/pruss_remoteproc.c
@@ -687,6 +687,9 @@ static int pru_rproc_probe(struct platform_device *pdev)
 		dev_err(dev, "rproc_alloc failed\n");
 		return -ENOMEM;
 	}
+	/* error recovery is not supported for PRUs */
+	rproc->recovery_disabled = true;
+
 	pru = rproc->priv;
 	pru->id = pdata->id;
 	pru->pruss = platform_get_drvdata(ppdev);
-- 
1.7.5.4

