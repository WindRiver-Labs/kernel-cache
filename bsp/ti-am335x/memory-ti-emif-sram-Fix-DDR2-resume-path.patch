From fe5c184870a7ff8d6b27ed441261b1950407b274 Mon Sep 17 00:00:00 2001
From: Dave Gerlach <d-gerlach@ti.com>
Date: Thu, 9 Jul 2015 11:14:36 -0500
Subject: [PATCH 222/800] memory: ti-emif-sram: Fix DDR2 resume path

DDR2 systems, like Beaglebone White, require a write to SDRAM_CONFIG
register during resume path. This patch fixes an error that caused this
write to be skipped on all AM335x systems, having no effect on the more
common DDR3 systems but preventing DDR2 systems from resuming at all
when EMIF context is lost.

Signed-off-by: Dave Gerlach <d-gerlach@ti.com>
[zou: Original patch taken from PROCESSOR-SDK-LINUX-AM335X 02_00_01_07]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/memory/ti-emif-sram-pm.S |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/memory/ti-emif-sram-pm.S b/drivers/memory/ti-emif-sram-pm.S
index 7b5ce44..63f6201 100644
--- a/drivers/memory/ti-emif-sram-pm.S
+++ b/drivers/memory/ti-emif-sram-pm.S
@@ -146,7 +146,7 @@ ENTRY(ti_emif_restore_context)
 
 	ldr	r2, ti_emif_sram_config
 	cmp	r2, #EMIF_SRAM_AM43_REG_LAYOUT
-	bne	emif_skip_save_extra_regs
+	bne	emif_skip_restore_extra_regs
 
 	ldr     r1, emif_rd_wr_level_ramp_ctrl
 	str	r1, [r0, #EMIF_READ_WRITE_LEVELING_RAMP_CONTROL]
-- 
1.7.5.4

