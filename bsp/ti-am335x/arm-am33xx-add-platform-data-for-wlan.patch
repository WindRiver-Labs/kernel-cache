From f68b1efbd97179a5baf206af7d22007ad5427415 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Fri, 7 Mar 2014 11:25:00 +0800
Subject: [PATCH 182/188] arm: am33xx: add platform data for wlan

enable wlan0 irq for am33xx.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-omap2/devices.c |   13 ++++++++-----
 1 files changed, 8 insertions(+), 5 deletions(-)

diff --git a/arch/arm/mach-omap2/devices.c b/arch/arm/mach-omap2/devices.c
index bc89028..dbec50f 100644
--- a/arch/arm/mach-omap2/devices.c
+++ b/arch/arm/mach-omap2/devices.c
@@ -484,9 +484,6 @@ void __init omap_init_wl12xx_of(void)
 {
 	int ret;
 
-	if (!of_have_populated_dt())
-		return;
-
 	if (of_machine_is_compatible("ti,omap4-sdp")) {
 		wl12xx.board_ref_clock = WL12XX_REFCLOCK_26;
 		wl12xx.board_tcxo_clock = WL12XX_TCXOCLOCK_26;
@@ -494,9 +491,15 @@ void __init omap_init_wl12xx_of(void)
 	} else if (of_machine_is_compatible("ti,omap4-panda")) {
 		wl12xx.board_ref_clock = WL12XX_REFCLOCK_38;
 		wl12xx.irq = gpio_to_irq(53);
-	} else {
+	} else if (of_machine_is_compatible("ti,am33xx")) {
+		wl12xx.board_ref_clock = WL12XX_REFCLOCK_38;
+		if (of_machine_is_compatible("ti,am335x-evm")) {
+			wl12xx.irq = gpio_to_irq(113);
+		} else {  /* This is for evmsk */
+			wl12xx.irq = gpio_to_irq(31);
+		}
+	} else
 		return;
-	}
 
 	ret = wl12xx_set_platform_data(&wl12xx);
 	if (ret) {
-- 
1.7.5.4

