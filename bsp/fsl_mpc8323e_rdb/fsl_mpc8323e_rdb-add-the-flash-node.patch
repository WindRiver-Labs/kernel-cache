From 8bc98d528e5dbd71439f746fcb87049cd7d2805e Mon Sep 17 00:00:00 2001
From: Luo Chunbo <chunbo.luo@windriver.com>
Date: Mon, 22 Mar 2010 16:12:58 +0800
Subject: [PATCH 1/2] fsl_mpc8323e_rdb: add the flash node

Add the flash node to support the MTD partitions.

Signed-off-by: Li Wang <li.wang@windriver.com>
Signed-off-by: Luo Chunbo <chunbo.luo@windriver.com>
---
 arch/powerpc/boot/dts/mpc832x_rdb.dts |   35 +++++++++++++++++++++++++++++++++
 1 files changed, 35 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/boot/dts/mpc832x_rdb.dts b/arch/powerpc/boot/dts/mpc832x_rdb.dts
index f4fadb2..d7951e0 100644
--- a/arch/powerpc/boot/dts/mpc832x_rdb.dts
+++ b/arch/powerpc/boot/dts/mpc832x_rdb.dts
@@ -220,6 +220,41 @@
 		};
 	};
 
+	localbus@e0000000 {
+		#address-cells = <2>;
+		#size-cells = <1>;
+		compatible = "simple-bus";
+		reg = <0xe0000000 0x1000>;
+
+		ranges = <0x0 0x0 0xfe000000 0x01000000>;	/*16MB Flash*/
+
+		flash@0,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
+			compatible = "cfi-flash";
+			reg = <0x0 0x0 0x1000000>;
+			bank-width = <2>;
+			device-width = <1>;
+			partition@0x0 {
+				label = "U-Boot";
+				reg = <0x00000000 0x00080000>;
+				read-only;
+			};
+			partition@0x80000 {
+				label = "Device tree (dtb)";
+				reg = <0x00080000 0x00080000>;
+			};
+			partition@0x100000 {
+				label = "Kernel image";
+				reg = <0x00100000 0x00300000>;
+			};
+			partition@0x400000 {
+				label = "Filesystem";
+				reg = <0x00400000 0x00c00000>;
+			};
+		};
+	};
+
 	qe@e0100000 {
 		#address-cells = <1>;
 		#size-cells = <1>;
-- 
1.6.5.2

