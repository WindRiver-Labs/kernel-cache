From ab68f7c1bb0e6349d0e83f20e3255decc0a1ba53 Mon Sep 17 00:00:00 2001
From: zou cao <cao.zou@windriver.com>
Date: Tue, 11 Jul 2017 17:47:18 +0800
Subject: [PATCH 1/6] arm64: dts: r8a7795-es1: fixed the conflict places of
 vsp1 and display

Fxied the conflict places of vsp1 and display, these conflict places is
in introducde from v4.9/rcar-3.5.1 of renesas, regress these parts to
v4.2/rcar-3.0.x

Signed-off-by: zou cao <cao.zou@windriver.com>
---
 .../boot/dts/renesas/r8a7795-es1-salvator-x.dts    |    2 +-
 arch/arm64/boot/dts/renesas/r8a7795-es1.dtsi       |  166 +++++--------------
 2 files changed, 45 insertions(+), 123 deletions(-)

diff --git a/arch/arm64/boot/dts/renesas/r8a7795-es1-salvator-x.dts b/arch/arm64/boot/dts/renesas/r8a7795-es1-salvator-x.dts
index 5dff839..3f672d3 100644
--- a/arch/arm64/boot/dts/renesas/r8a7795-es1-salvator-x.dts
+++ b/arch/arm64/boot/dts/renesas/r8a7795-es1-salvator-x.dts
@@ -390,7 +390,7 @@
 		 <&programmable_clk0>, <&du_dotclkin1>, <&du_dotclkin2>,
 		 <&programmable_clk1>;
 
-	backlight-gpios = <&gpio6 7 GPIO_ACTIVE_HIGH>;
+	backlight = <&gpio6 7 GPIO_ACTIVE_HIGH>;
 
 	ports {
 		port@0 {
diff --git a/arch/arm64/boot/dts/renesas/r8a7795-es1.dtsi b/arch/arm64/boot/dts/renesas/r8a7795-es1.dtsi
index a11ef4a..0f984fd 100644
--- a/arch/arm64/boot/dts/renesas/r8a7795-es1.dtsi
+++ b/arch/arm64/boot/dts/renesas/r8a7795-es1.dtsi
@@ -2664,16 +2664,19 @@
 			compatible = "renesas,qos";
 		};
 
-		vsp@fe920000 {
-			compatible = "renesas,vspm-vsp2";
-			reg = <0 0xfe920000 0 0x8000>;
+		vspbd: vspm@fe960000 {
+			compatible = "renesas,vspm";
+			reg = <0 0xfe960000 0 0x8000>, <0 0xfe96f000 0 0x200>;
+			interrupts = <GIC_SPI 266 IRQ_TYPE_LEVEL_HIGH>;
+			clocks = <&cpg CPG_MOD 626>, <&cpg CPG_MOD 607>;
+			clock-names = "vsp", "fcp";
+			renesas,#ch = <3>;
+			renesas,#rpf = <31>;
+			renesas,#rpf_clut = <4>;
+			renesas,#wpf_rot = <0>;
 			renesas,has-bru;
-			renesas,has-lut;
-			renesas,has-clu;
-			renesas,has-hgo;
-			renesas,#rpf = <5>;
-			renesas,#uds = <0>;
-			renesas,#wpf = <1>;
+			renesas,#read_outstanding = <0>;
+			power-domains = <&sysc R8A7795_PD_A3VP>;
 		};
 
 		vspbc: vspm@fe920000 {
@@ -2692,44 +2695,6 @@
 			renesas,has-bru;
 			renesas,#read_outstanding = <0>;
 			power-domains = <&sysc R8A7795_PD_A3VP>;
-			status = "disabled";
-		};
-
-		vsp@fe960000 {
-			compatible = "renesas,vspm-vsp2";
-			reg = <0 0xfe960000 0 0x8000>;
-			renesas,has-bru;
-			renesas,#rpf = <5>;
-			renesas,#uds = <0>;
-			renesas,#wpf = <1>;
-		};
-
-		vspbd: vspm@fe960000 {
-			compatible = "renesas,vspm";
-			reg = <0 0xfe960000 0 0x8000>, <0 0xfe96f000 0 0x200>;
-			interrupts = <GIC_SPI 266 IRQ_TYPE_LEVEL_HIGH>;
-			clocks = <&cpg CPG_MOD 626>, <&cpg CPG_MOD 607>;
-			clock-names = "vsp", "fcp";
-			renesas,#ch = <3>;
-			renesas,#rpf = <31>;
-			renesas,#rpf_clut = <4>;
-			renesas,#wpf_rot = <0>;
-			renesas,has-bru;
-			renesas,#read_outstanding = <0>;
-			power-domains = <&sysc R8A7795_PD_A3VP>;
-			status = "disabled";
-		};
-
-		vsp@fe9a0000 {
-			compatible = "renesas,vspm-vsp2";
-			reg = <0 0xfe9a0000 0 0x8000>;
-			renesas,has-lut;
-			renesas,has-clu;
-			renesas,has-hgo;
-			renesas,has-hgt;
-			renesas,#rpf = <1>;
-			renesas,#uds = <1>;
-			renesas,#wpf = <1>;
 		};
 
 		vspi0: vspm@fe9a0000 {
@@ -2753,19 +2718,6 @@
 			renesas,has-shp;
 			renesas,#read_outstanding = <2>;
 			power-domains = <&sysc R8A7795_PD_A3VP>;
-			status = "disabled";
-		};
-
-		vsp@fe9b0000 {
-			compatible = "renesas,vspm-vsp2";
-			reg = <0 0xfe9b0000 0 0x8000>;
-			renesas,has-lut;
-			renesas,has-clu;
-			renesas,has-hgo;
-			renesas,has-hgt;
-			renesas,#rpf = <1>;
-			renesas,#uds = <1>;
-			renesas,#wpf = <1>;
 		};
 
 		vspi1: vspm@fe9b0000 {
@@ -2789,19 +2741,6 @@
 			renesas,has-shp;
 			renesas,#read_outstanding = <2>;
 			power-domains = <&sysc R8A7795_PD_A3VP>;
-			status = "disabled";
-		};
-
-		vsp@fe9c0000 {
-			compatible = "renesas,vspm-vsp2";
-			reg = <0 0xfe9c0000 0 0x8000>;
-			renesas,has-lut;
-			renesas,has-clu;
-			renesas,has-hgo;
-			renesas,has-hgt;
-			renesas,#rpf = <1>;
-			renesas,#uds = <1>;
-			renesas,#wpf = <1>;
 		};
 
 		vspi2: vspm@fe9c0000 {
@@ -2825,82 +2764,61 @@
 			renesas,has-shp;
 			renesas,#read_outstanding = <2>;
 			power-domains = <&sysc R8A7795_PD_A3VP>;
-			status = "disabled";
 		};
 
 		vspd0: vsp@fea20000 {
-			compatible = "renesas,vsp2";
+			compatible = "renesas,vsp2d";
 			reg = <0 0xfea20000 0 0x4000>;
 			interrupts = <GIC_SPI 466 IRQ_TYPE_LEVEL_HIGH>;
-			clocks = <&cpg CPG_MOD 623>;
-			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
-
-			renesas,fcp = <&fcpvd0>;
-		};
-
-		fcpvd0: fcp@fea27000 {
-			compatible = "renesas,fcpv";
-			reg = <0 0xfea27000 0 0x200>;
-			clocks = <&cpg CPG_MOD 603>;
+			clocks = <&cpg CPG_MOD 623>, <&cpg CPG_MOD 603>;
 			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
+			renesas,has-bru;
+			renesas,has-lif;
+			renesas,#rpf = <5>;
+			renesas,#wpf = <1>;
 		};
 
 		vspd1: vsp@fea28000 {
-			compatible = "renesas,vsp2";
+			compatible = "renesas,vsp2d";
 			reg = <0 0xfea28000 0 0x4000>;
 			interrupts = <GIC_SPI 467 IRQ_TYPE_LEVEL_HIGH>;
-			clocks = <&cpg CPG_MOD 622>;
-			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
-
-			renesas,fcp = <&fcpvd1>;
-		};
-
-		fcpvd1: fcp@fea2f000 {
-			compatible = "renesas,fcpv";
-			reg = <0 0xfea2f000 0 0x200>;
-			clocks = <&cpg CPG_MOD 602>;
+			clocks = <&cpg CPG_MOD 622>, <&cpg CPG_MOD 602>;
 			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
+			renesas,has-bru;
+			renesas,has-lif;
+			renesas,#rpf = <5>;
+			renesas,#wpf = <1>;
 		};
 
 		vspd2: vsp@fea30000 {
-			compatible = "renesas,vsp2";
+			compatible = "renesas,vsp2d";
 			reg = <0 0xfea30000 0 0x4000>;
 			interrupts = <GIC_SPI 468 IRQ_TYPE_LEVEL_HIGH>;
-			clocks = <&cpg CPG_MOD 621>;
-			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
-
-			renesas,fcp = <&fcpvd2>;
-		};
-
-		fcpvd2: fcp@fea37000 {
-			compatible = "renesas,fcpv";
-			reg = <0 0xfea37000 0 0x200>;
-			clocks = <&cpg CPG_MOD 601>;
+			clocks = <&cpg CPG_MOD 621>, <&cpg CPG_MOD 601>;
 			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
+			renesas,has-bru;
+			renesas,has-lif;
+			renesas,#rpf = <5>;
+			renesas,#wpf = <1>;
 		};
 
 		vspd3: vsp@fea38000 {
-			compatible = "renesas,vsp2";
+			compatible = "renesas,vsp2d";
 			reg = <0 0xfea38000 0 0x4000>;
 			interrupts = <GIC_SPI 469 IRQ_TYPE_LEVEL_HIGH>;
-			clocks = <&cpg CPG_MOD 620>;
-			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
-
-			renesas,fcp = <&fcpvd3>;
-		};
-
-		fcpvd3: fcp@fea3f000 {
-			compatible = "renesas,fcpv";
-			reg = <0 0xfea3f000 0 0x200>;
-			clocks = <&cpg CPG_MOD 600>;
+			clocks = <&cpg CPG_MOD 620>, <&cpg CPG_MOD 600>;
 			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
+			renesas,has-bru;
+			renesas,has-lif;
+			renesas,#rpf = <5>;
+			renesas,#wpf = <1>;
 		};
 
 		du: display@feb00000 {
 			compatible = "renesas,du-r8a7795";
 			reg = <0 0xfeb00000 0 0x80000>,
 			      <0 0xfeb90000 0 0x14>;
-			reg-names = "du", "lvds.0";
+			reg-names = "du", "lvds";
 			interrupts = <GIC_SPI 256 IRQ_TYPE_LEVEL_HIGH>,
 				     <GIC_SPI 268 IRQ_TYPE_LEVEL_HIGH>,
 				     <GIC_SPI 269 IRQ_TYPE_LEVEL_HIGH>,
@@ -2913,11 +2831,13 @@
 				 <&du_dotclkin0>, <&du_dotclkin1>,
 				 <&du_dotclkin2>, <&du_dotclkin3>;
 			clock-names = "du.0", "du.1", "du.2", "du.3",
-				      "lvds.0", "dclkin.0", "dclkin.1",
+				      "lvds", "dclkin.0", "dclkin.1",
 				      "dclkin.2", "dclkin.3";
 			status = "disabled";
 
 			vsps = <&vspd0 &vspd1 &vspd2 &vspd3>;
+			hdmi = <&hdmi0 &hdmi1>;
+			hdmi-num = <2>;
 
 			ports {
 				#address-cells = <1>;
@@ -2947,24 +2867,26 @@
 		};
 
 		hdmi0: hdmi0@fead0000 {
-			compatible = "renesas,rcar-dw-hdmi";
+			compatible = "rockchip,rcar-dw-hdmi";
 			reg = <0 0xfead0000 0 0x10000>;
 			interrupts = <0 389 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 729>;
 			clock-names = "isfr";
 			interlaced = <1>;
 			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
+			clock-iahb = <0>;
 			status = "disabled";
 		};
 
 		hdmi1: hdmi1@feae0000 {
-			compatible = "renesas,rcar-dw-hdmi";
+			compatible = "rockchip,rcar-dw-hdmi";
 			reg = <0 0xfeae0000 0 0x10000>;
 			interrupts = <0 436 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&cpg CPG_MOD 728>;
 			clock-names = "isfr";
 			interlaced = <1>;
 			power-domains = <&sysc R8A7795_PD_ALWAYS_ON>;
+			clock-iahb = <0>;
 			status = "disabled";
 		};
 
-- 
1.7.5.4

