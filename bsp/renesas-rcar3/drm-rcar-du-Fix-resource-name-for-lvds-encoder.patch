From 14936f1add8865ad112fec41de8ac223427ea410 Mon Sep 17 00:00:00 2001
From: Koji Matsuoka <koji.matsuoka.xm@renesas.com>
Date: Thu, 10 Sep 2015 15:12:55 +0900
Subject: [PATCH 1954/2066] drm: rcar-du: Fix resource name for lvds encoder

Signed-off-by: Koji Matsuoka <koji.matsuoka.xm@renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/gpu/drm/rcar-du/rcar_du_lvdsenc.c |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

diff --git a/drivers/gpu/drm/rcar-du/rcar_du_lvdsenc.c b/drivers/gpu/drm/rcar-du/rcar_du_lvdsenc.c
index 368abb4..8d347cf 100644
--- a/drivers/gpu/drm/rcar-du/rcar_du_lvdsenc.c
+++ b/drivers/gpu/drm/rcar-du/rcar_du_lvdsenc.c
@@ -253,10 +253,15 @@ int rcar_du_lvdsenc_enable(struct rcar_du_lvdsenc *lvds, struct drm_crtc *crtc,
 static int rcar_du_lvdsenc_get_resources(struct rcar_du_lvdsenc *lvds,
 					 struct platform_device *pdev)
 {
+	struct rcar_du_device *rcdu = lvds->dev;
 	struct resource *mem;
 	char name[7];
 
-	sprintf(name, "lvds.%u", lvds->index);
+	if (rcar_du_has(rcdu, RCAR_DU_FEATURE_GEN3_REGS) &&
+		(rcdu->info->num_lvds <= 1))
+		sprintf(name, "lvds");
+	else
+		sprintf(name, "lvds.%u", lvds->index);
 
 	mem = platform_get_resource_byname(pdev, IORESOURCE_MEM, name);
 	lvds->mmio = devm_ioremap_resource(&pdev->dev, mem);
-- 
1.7.5.4

