From a4a953673b46119f8974c5e1c7d1e7dfdaa559f7 Mon Sep 17 00:00:00 2001
From: Takeshi Kihara <takeshi.kihara.df@renesas.com>
Date: Mon, 6 Jun 2016 09:00:38 +0900
Subject: [PATCH 1254/2066] watchdog: renesas-wdt: Add set_timeout operation
 support

This patch adds set_timeout operation support to rwdt_ops.

Signed-off-by: Takeshi Kihara <takeshi.kihara.df@renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/watchdog/renesas_wdt.c |   10 ++++++++++
 1 files changed, 10 insertions(+), 0 deletions(-)

diff --git a/drivers/watchdog/renesas_wdt.c b/drivers/watchdog/renesas_wdt.c
index cf61c92..83b513f 100644
--- a/drivers/watchdog/renesas_wdt.c
+++ b/drivers/watchdog/renesas_wdt.c
@@ -60,6 +60,15 @@ static int rwdt_init_timeout(struct watchdog_device *wdev)
 	return 0;
 }
 
+static int rwdt_set_timeout(struct watchdog_device *wdev,
+			    unsigned int new_timeout)
+{
+	wdev->timeout = new_timeout;
+	rwdt_init_timeout(wdev);
+
+	return 0;
+}
+
 static int rwdt_start(struct watchdog_device *wdev)
 {
 	struct rwdt_priv *priv = watchdog_get_drvdata(wdev);
@@ -105,6 +114,7 @@ static const struct watchdog_ops rwdt_ops = {
 	.start = rwdt_start,
 	.stop = rwdt_stop,
 	.ping = rwdt_init_timeout,
+	.set_timeout = rwdt_set_timeout,
 	.get_timeleft = rwdt_get_timeleft,
 };
 
-- 
1.7.5.4

