From 45057b96c6d95e83d89bfcdf2b0446473daf89f1 Mon Sep 17 00:00:00 2001
From: Gaku Inami <gaku.inami.xw@bp.renesas.com>
Date: Mon, 30 Jan 2017 20:41:18 +0900
Subject: [PATCH 1724/2066] Revert "usb: renesas_usbhs: Fix issue when hotplug
 workqueue run before resume"

This reverts commit 326f1948316b ("usb: renesas_usbhs: Fix issue
when hotplug workqueue run before resume")

Signed-off-by: Gaku Inami <gaku.inami.xw@bp.renesas.com>
Signed-off-by: Kazuya Mizuguchi <kazuya.mizuguchi.ks@renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/usb/renesas_usbhs/common.c |    6 ------
 1 files changed, 0 insertions(+), 6 deletions(-)

diff --git a/drivers/usb/renesas_usbhs/common.c b/drivers/usb/renesas_usbhs/common.c
index 910f34f..8aac1e5 100644
--- a/drivers/usb/renesas_usbhs/common.c
+++ b/drivers/usb/renesas_usbhs/common.c
@@ -735,10 +735,7 @@ static int usbhsc_suspend(struct device *dev)
 {
 	struct usbhs_priv *priv = dev_get_drvdata(dev);
 	struct usbhs_mod *mod = usbhs_mod_get_current(priv);
-	struct renesas_usbhs_platform_info *info = dev_get_platdata(dev);
-	struct renesas_usbhs_driver_callback *dfunc = &info->driver_callback;
 
-	dfunc->notify_hotplug = NULL;
 	if (mod) {
 		usbhs_mod_call(priv, stop, priv);
 		usbhs_mod_change(priv, -1);
@@ -754,14 +751,11 @@ static int usbhsc_resume(struct device *dev)
 {
 	struct usbhs_priv *priv = dev_get_drvdata(dev);
 	struct platform_device *pdev = usbhs_priv_to_pdev(priv);
-	struct renesas_usbhs_platform_info *info = dev_get_platdata(dev);
-	struct renesas_usbhs_driver_callback *dfunc = &info->driver_callback;
 
 	if (!usbhsc_flags_has(priv, USBHSF_RUNTIME_PWCTRL))
 		usbhsc_power_ctrl(priv, 1);
 
 	usbhs_platform_call(priv, phy_reset, pdev);
-	dfunc->notify_hotplug = usbhsc_drvcllbck_notify_hotplug;
 
 	usbhsc_drvcllbck_notify_hotplug(pdev);
 
-- 
1.7.5.4

