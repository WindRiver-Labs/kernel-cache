From b6b77ae3bc64651ab7d7a956233b345ff3d7baf4 Mon Sep 17 00:00:00 2001
From: Dien Pham <dien.pham.ry@rvc.renesas.com>
Date: Thu, 2 Jun 2016 22:25:01 +0700
Subject: [PATCH 1253/2066] soc: renesas: rcar-sysc: Apply wait 1us for only
 turning off power domain

Currently, adding wait 1us is applied for both of
turning on and off power domain. So, this patch
updates checking for only turning off.

Signed-off-by: Dien Pham <dien.pham.ry@rvc.renesas.com>
(cherry picked from commit efa84b98641f51c71eb54d9b6c17947f81b30f59)
Signed-off-by: Takeshi Kihara <takeshi.kihara.df@renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/soc/renesas/rcar-sysc.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/soc/renesas/rcar-sysc.c b/drivers/soc/renesas/rcar-sysc.c
index e272c10..5e6e8b1 100644
--- a/drivers/soc/renesas/rcar-sysc.c
+++ b/drivers/soc/renesas/rcar-sysc.c
@@ -88,9 +88,9 @@ static int rcar_sysc_pwr_on_off(const struct rcar_sysc_ch *sysc_ch, bool on)
 		return -EAGAIN;
 
 	/* Start W/A for A3VP, A3VC, and A3IR domains */
-	if (!strcmp("a3vp", to_pd_name(sysc_ch))
+	if (!on && (!strcmp("a3vp", to_pd_name(sysc_ch))
 		|| !strcmp("a3ir", to_pd_name(sysc_ch))
-		|| !strcmp("a3vc", to_pd_name(sysc_ch)))
+		|| !strcmp("a3vc", to_pd_name(sysc_ch))))
 		udelay(1);
 
 	/* Submit power shutoff or power resume request */
-- 
1.7.5.4

