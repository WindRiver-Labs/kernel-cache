From 76f069f0b680736b646f728c6e55abe0b2f74711 Mon Sep 17 00:00:00 2001
From: Gaku Inami <gaku.inami.xw@bp.renesas.com>
Date: Tue, 27 Dec 2016 16:06:16 +0900
Subject: [PATCH 1695/2066] Revert "pwm: rcar: Use pm_runtime_get/put when
 resume"

This reverts commit 7d78bf4e2b80 ("pwm: rcar: Use pm_runtime_get/put when")

For the suspend/resume function is revised in pwm-rcar driver,
the conventional implementation will be reverted once.

Signed-off-by: Gaku Inami <gaku.inami.xw@bp.renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/pwm/pwm-rcar.c |    6 ++----
 1 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/drivers/pwm/pwm-rcar.c b/drivers/pwm/pwm-rcar.c
index fbca00a..1922512 100644
--- a/drivers/pwm/pwm-rcar.c
+++ b/drivers/pwm/pwm-rcar.c
@@ -410,11 +410,9 @@ static int rcar_pwm_resume(struct device *dev)
 	struct platform_device *pdev = to_platform_device(dev);
 	struct rcar_ip *ip = rcar_pwm_get_ip(pdev->name);
 
-	if (ip) {
-		pm_runtime_get_sync(dev);
+	if (ip)
 		ret = rcar_handle_registers(ip, DO_RESTORE);
-		pm_runtime_put(dev);
-	} else {
+	else {
 		pr_err("%s: Failed to find PWM device\n", __func__);
 		ret = -ENODEV;
 	}
-- 
1.7.5.4

