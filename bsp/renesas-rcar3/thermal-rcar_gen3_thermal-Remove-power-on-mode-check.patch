From f506696b59deb04413701dc685ed6f2cb5e7ca94 Mon Sep 17 00:00:00 2001
From: Hien Dang <hien.dang.eb@rvc.renesas.com>
Date: Fri, 25 Dec 2015 08:48:26 +0700
Subject: [PATCH 1280/2066] thermal: rcar_gen3_thermal: Remove power on mode
 checking during init

According to updated hardware flow, it is not necessary to
check CTSR.PONSEQSTOP bit. Therefore, checking this bit
during module initialization is removed.

Signed-off-by: Hien Dang <hien.dang.eb@rvc.renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/thermal/rcar_gen3_thermal.c |    6 ++----
 1 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/drivers/thermal/rcar_gen3_thermal.c b/drivers/thermal/rcar_gen3_thermal.c
index 46826d7..7117da6 100644
--- a/drivers/thermal/rcar_gen3_thermal.c
+++ b/drivers/thermal/rcar_gen3_thermal.c
@@ -392,14 +392,11 @@ static int rcar_gen3_thermal_get_temp(void *devdata, int *temp)
 
 static int rcar_gen3_thermal_init(struct rcar_thermal_priv *priv)
 {
-	unsigned long status;
 	unsigned long flags;
 
 	spin_lock_irqsave(&priv->lock, flags);
-	status = rcar_thermal_read(priv, REG_GEN3_CTSR);
 
-	if ((status & PONSEQSTOP) == POWERON)
-		rcar_thermal_write(priv, REG_GEN3_CTSR,  0x0);
+	rcar_thermal_write(priv, REG_GEN3_CTSR,  0x0);
 
 	rcar_thermal_write(priv, REG_GEN3_CTSR,
 			PONM | AOUT | THBGR | VMEN);
@@ -413,6 +410,7 @@ static int rcar_gen3_thermal_init(struct rcar_thermal_priv *priv)
 						TEMPD_IRQ_SHIFT(priv->id));
 
 	spin_unlock_irqrestore(&priv->lock, flags);
+
 	return 0;
 }
 
-- 
1.7.5.4

