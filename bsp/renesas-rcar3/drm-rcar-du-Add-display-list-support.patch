From b5cf0a6456587616fa3a1ba7243ef347e7b00686 Mon Sep 17 00:00:00 2001
From: Takashi Saito <takashi.saitou.ry@renesas.com>
Date: Mon, 31 Aug 2015 19:19:49 +0900
Subject: [PATCH 1956/2066] drm: rcar-du: Add display list support

Signed-off-by: Koji Matsuoka <koji.matsuoka.xm@renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/gpu/drm/rcar-du/rcar_du_vsp.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/rcar-du/rcar_du_vsp.c b/drivers/gpu/drm/rcar-du/rcar_du_vsp.c
index 9aab1d3..cb7959f 100644
--- a/drivers/gpu/drm/rcar-du/rcar_du_vsp.c
+++ b/drivers/gpu/drm/rcar-du/rcar_du_vsp.c
@@ -22,6 +22,7 @@
 #include <linux/of_platform.h>
 #include <linux/videodev2.h>
 
+#define VSP1_DL_SUPPORT
 #include <media/vsp1.h>
 
 #include "rcar_du_drv.h"
@@ -66,12 +67,18 @@ void rcar_du_vsp_enable(struct rcar_du_crtc *crtc)
 	 */
 	crtc->group->need_restart = true;
 
+#ifdef VSP1_DL_SUPPORT
+	vsp1_du_setup_dl(crtc->vsp->vsp, 2, 2);
+#endif
 	vsp1_du_setup_lif(crtc->vsp->vsp, mode->hdisplay, mode->vdisplay);
 }
 
 void rcar_du_vsp_disable(struct rcar_du_crtc *crtc)
 {
 	vsp1_du_setup_lif(crtc->vsp->vsp, 0, 0);
+#ifdef VSP1_DL_SUPPORT
+	vsp1_du_reset_dl(crtc->vsp->vsp);
+#endif
 }
 
 static const u32 formats_xlate[][2] = {
-- 
1.7.5.4

