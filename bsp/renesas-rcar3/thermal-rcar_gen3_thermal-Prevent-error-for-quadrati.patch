From e4f5436672cf94d7ea355a526b716ec895df069d Mon Sep 17 00:00:00 2001
From: Thao Nguyen <thao.nguyen.yb@rvc.renesas.com>
Date: Tue, 31 May 2016 20:44:09 +0700
Subject: [PATCH 1302/2066] thermal: rcar_gen3_thermal: Prevent error for
 quadratic formula

Currently, converting from temperature code for detecting interrupt
only works with linear formula of charateristic correction.
Quadratic formula does not support this feature.

Signed-off-by: Thao Nguyen <thao.nguyen.yb@rvc.renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/thermal/rcar_gen3_thermal.c |   14 +++++++++++---
 1 files changed, 11 insertions(+), 3 deletions(-)

diff --git a/drivers/thermal/rcar_gen3_thermal.c b/drivers/thermal/rcar_gen3_thermal.c
index b7ea467..08e1d01 100644
--- a/drivers/thermal/rcar_gen3_thermal.c
+++ b/drivers/thermal/rcar_gen3_thermal.c
@@ -2,7 +2,7 @@
  *  R-Car Gen3 THS/CIVM thermal sensor driver
  *  Based on drivers/thermal/rcar_thermal.c
  *
- * Copyright (C) 2015 Renesas Electronics Corporation.
+ * Copyright (C) 2015-2016 Renesas Electronics Corporation.
  *
  *  This program is free software; you can redistribute it and/or modify
  *  it under the terms of the GNU General Public License as published by
@@ -349,6 +349,12 @@ int _quadratic_temp_converter(struct equation_coefs coef, int temp_code)
 
 	return round_temp(temp);
 }
+
+int _quadratic_celsius_to_temp(struct equation_coefs coef,
+					int ctemp)
+{
+	return 0;
+}
 #else
 int _linear_temp_converter(struct equation_coefs coef,
 					int temp_code)
@@ -391,9 +397,11 @@ int thermal_celsius_to_temp(struct equation_coefs coef,
 					int ctemp)
 {
 	int temp_code;
-
+#ifdef APPLY_QUADRATIC_EQUATION
+	temp_code = _quadratic_celsius_to_temp(coef, ctemp);
+#else
 	temp_code = _linear_celsius_to_temp(coef, ctemp);
-
+#endif /* APPLY_QUADRATIC_EQUATION */
 	return temp_code;
 }
 
-- 
1.7.5.4

