From ad473402a74bf1ec0f9b8cd339219cf84ae8f788 Mon Sep 17 00:00:00 2001
From: Khiem Nguyen <khiem.nguyen.xt@renesas.com>
Date: Mon, 7 Nov 2016 20:16:31 +0700
Subject: [PATCH 1266/2066] ARM: cpuidle: Wrap ARM64 support code properly

To prevent unnecessary errors while compiling with ARM 32-bit configs,
wrap the ARM64 support code properly.

Signed-off-by: Khiem Nguyen <khiem.nguyen.xt@renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/cpuidle/cpuidle-arm.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/cpuidle/cpuidle-arm.c b/drivers/cpuidle/cpuidle-arm.c
index 1699b92..f064be0 100644
--- a/drivers/cpuidle/cpuidle-arm.c
+++ b/drivers/cpuidle/cpuidle-arm.c
@@ -81,6 +81,7 @@ static struct cpuidle_driver arm_idle_driver = {
 	}
 };
 
+#if IS_ENABLED(CONFIG_ARM64)
 static int __init arm_idle_driver_init(struct cpuidle_driver *drv, int part_id)
 {
 	struct cpumask *cpumask;
@@ -102,6 +103,7 @@ static int __init arm_idle_driver_init(struct cpuidle_driver *drv, int part_id)
 
 	return 0;
 }
+#endif
 
 static const struct of_device_id arm_idle_state_match[] __initconst = {
 	{ .compatible = "arm,idle-state",
@@ -122,10 +124,12 @@ static int __init arm_idle_init(void)
 	struct cpuidle_driver *drv = &arm_idle_driver;
 	struct cpuidle_device *dev;
 
+#if IS_ENABLED(CONFIG_ARM64)
 	/* Support CPUIdle for Cortex-A57 only */
 	ret = arm_idle_driver_init(drv, ARM_CPU_PART_CORTEX_A57);
 	if (ret)
 		return ret;
+#endif
 
 	/*
 	 * Initialize idle states data, starting at index 1.
-- 
1.7.5.4

