From 3ba865bc7f808192a089607c85a6709ea2c2ec2d Mon Sep 17 00:00:00 2001
From: Hien Dang <hien.dang.eb@rvc.renesas.com>
Date: Thu, 26 May 2016 13:19:32 +0700
Subject: [PATCH 1295/2066] thermal: rcar_gen3_thermal: Use helper function to
 get of_data

Use of_device_get_match_data to get of_data.
This will help to tighten the code and make it more readable.

Signed-off-by: Hien Dang <hien.dang.eb@rvc.renesas.com>
[zou:Original patch taken from
git://git.kernel.org/pub/scm/linux/kernel/git/horms/renesas-bsp.git
 v4.9/rcar-3.5.1]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 drivers/thermal/rcar_gen3_thermal.c |    7 ++-----
 1 files changed, 2 insertions(+), 5 deletions(-)

diff --git a/drivers/thermal/rcar_gen3_thermal.c b/drivers/thermal/rcar_gen3_thermal.c
index ed4f442..ccbfc42 100644
--- a/drivers/thermal/rcar_gen3_thermal.c
+++ b/drivers/thermal/rcar_gen3_thermal.c
@@ -568,7 +568,6 @@ static int rcar_gen3_thermal_probe(struct platform_device *pdev)
 	int ret = -ENODEV;
 	int idle;
 	struct device_node *tz_nd, *tmp_nd;
-	const struct of_device_id *of_id;
 
 	priv = devm_kzalloc(dev, sizeof(*priv), GFP_KERNEL);
 	if (!priv)
@@ -581,10 +580,8 @@ static int rcar_gen3_thermal_probe(struct platform_device *pdev)
 	pm_runtime_enable(dev);
 	pm_runtime_get_sync(dev);
 
-	of_id = of_match_device(rcar_thermal_dt_ids, dev);
-	if (of_id)
-		priv->data = of_id->data;
-	else
+	priv->data = of_device_get_match_data(dev);
+	if (!priv->data)
 		goto error_unregister;
 
 	irq = platform_get_resource(pdev, IORESOURCE_IRQ, 0);
-- 
1.7.5.4

