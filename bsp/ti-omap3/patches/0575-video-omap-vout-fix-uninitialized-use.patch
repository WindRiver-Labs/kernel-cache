From b1b1036058e12d148d395df58128739006bc3abd Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Thu, 16 Aug 2012 14:28:55 +0800
Subject: [PATCH 575/609] video: omap: vout: fix uninitialized use

mode may be used uninitialized in this function when pixelformat=0,
so we return as default.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/media/video/omap/omap_vout.c |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

diff --git a/drivers/media/video/omap/omap_vout.c b/drivers/media/video/omap/omap_vout.c
index 88cf9d9..c327b98 100644
--- a/drivers/media/video/omap/omap_vout.c
+++ b/drivers/media/video/omap/omap_vout.c
@@ -334,8 +334,6 @@ static int video_mode_to_dss_mode(struct omap_vout_device *vout)
 	ovl = ovid->overlays[0];
 
 	switch (pix->pixelformat) {
-	case 0:
-		break;
 	case V4L2_PIX_FMT_YUYV:
 		mode = OMAP_DSS_COLOR_YUV2;
 		break;
@@ -355,6 +353,7 @@ static int video_mode_to_dss_mode(struct omap_vout_device *vout)
 	case V4L2_PIX_FMT_BGR32:
 		mode = OMAP_DSS_COLOR_RGBX32;
 		break;
+	case 0: /* return -EINVAL too for meaningless FMT 0*/
 	default:
 		mode = -EINVAL;
 	}
-- 
1.7.5.4

