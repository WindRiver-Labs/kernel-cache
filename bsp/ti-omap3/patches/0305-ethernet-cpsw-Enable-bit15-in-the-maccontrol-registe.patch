From e5163fb4d04d53865284dc927507f65915b55084 Mon Sep 17 00:00:00 2001
From: Vaibhav Hiremath <hvaibhav@ti.com>
Date: Tue, 10 Jul 2012 14:45:15 +0800
Subject: [PATCH 305/609] ethernet: cpsw: Enable bit15 in the maccontrol
 register for 100Mbps.

Original commit: ddb8c729d458eed7b3ffae1849ea74f3d39435aa

  From git://arago-project.org/git/projects/linux-am33x.git
  And ti-sdk-am335x-evm-05.05.00.00-Linux-x86-Install image

Signed-off-by: Vaibhav Hiremath <hvaibhav@ti.com>
---
 drivers/net/ethernet/ti/cpsw.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/net/ethernet/ti/cpsw.c b/drivers/net/ethernet/ti/cpsw.c
index 01b617c..4c67697 100644
--- a/drivers/net/ethernet/ti/cpsw.c
+++ b/drivers/net/ethernet/ti/cpsw.c
@@ -381,6 +381,10 @@ static void _cpsw_adjust_link(struct cpsw_slave *slave,
 
 		if (phy->speed == 1000)
 			mac_control |= BIT(7);	/* GIGABITEN	*/
+
+		if (phy->speed == 100)
+			mac_control |= BIT(15);
+
 		if (phy->duplex)
 			mac_control |= BIT(0);	/* FULLDUPLEXEN	*/
 		*link = true;
-- 
1.7.5.4

