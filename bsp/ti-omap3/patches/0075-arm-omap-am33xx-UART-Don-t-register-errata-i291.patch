From 6a0feb34f4c36429cfe8893250f72340a61d3395 Mon Sep 17 00:00:00 2001
From: Vaibhav Bedia <vaibhav.bedia@ti.com>
Date: Tue, 17 Jan 2012 11:28:44 +0530
Subject: [PATCH 075/609] arm: omap: am33xx: UART: Don't register errata i291

Original commit: 0ff6bd6dbc9ad2fa5c171becd754cbbd6d01b7e6

  From git://arago-project.org/git/projects/linux-am33x.git
  And ti-sdk-am335x-evm-05.05.00.00-Linux-x86-Install image

UART_ERRATA_i291_DMA_FORCEIDLE is not applicable to the
AM33XX family

Signed-off-by: Vaibhav Bedia <vaibhav.bedia@ti.com>
---
 arch/arm/mach-omap2/serial.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-omap2/serial.c b/arch/arm/mach-omap2/serial.c
index ac38b24..ad30505 100644
--- a/arch/arm/mach-omap2/serial.c
+++ b/arch/arm/mach-omap2/serial.c
@@ -310,7 +310,7 @@ void __init omap_serial_init_port(struct omap_board_data *bdata,
 		omap_up.errata |= UART_ERRATA_i202_MDR1_ACCESS;
 
 	/* Enable DMA Mode Force Idle Errata i291 for omap34xx/3630 */
-	if (cpu_is_omap34xx() || cpu_is_omap3630())
+	if ((cpu_is_omap34xx() || cpu_is_omap3630()) && !cpu_is_am33xx())
 		omap_up.errata |= UART_ERRATA_i291_DMA_FORCEIDLE;
 
 	pdata = &omap_up;
-- 
1.7.5.4

