From babffe4144a8ea7eaca8cd213bad30fbcb8ce9fe Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 16 Jul 2012 16:42:47 +0800
Subject: [PATCH 013/609] ARM: OMAP: AM33XX: set proper 32K_TIMER dependency

A reference commit: 9b88699cc4599ca3625f8a5ec9960141ae152050

  From git://arago-project.org/git/projects/linux-am33x.git
  And ti-sdk-am335x-evm-05.05.00.00-Linux-x86-Install image

This patch try to set proper dependency between 32K_TIMER
and SOC_AM33XX, otherwise the board will be stuck in timer
initialization, and no output from serial.

The root cause is that AM33XX has no 32K timer at all.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/plat-omap/Kconfig |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/arm/plat-omap/Kconfig b/arch/arm/plat-omap/Kconfig
index eefb311..e3bbebe 100644
--- a/arch/arm/plat-omap/Kconfig
+++ b/arch/arm/plat-omap/Kconfig
@@ -31,7 +31,7 @@ config ARCH_OMAP2PLUS
 	select HAVE_TRACE_CLOCK if LTT
 	select HAVE_TRACE_CLOCK_32_TO_64 if LTT
 	select OMAP3_EMU if LTT
-	select OMAP_32K_TIMER
+	select OMAP_32K_TIMER if !SOC_AM33XX
 	help
 	  "Systems based on OMAP2, OMAP3 or OMAP4"
 
@@ -147,7 +147,7 @@ config OMAP_MPU_TIMER
 
 config OMAP_32K_TIMER
 	bool "Use 32KHz timer"
-	depends on ARCH_OMAP16XX || ARCH_OMAP2PLUS
+	depends on ARCH_OMAP16XX || ARCH_OMAP2PLUS && !SOC_AM33XX
 	default y if (ARCH_OMAP16XX || ARCH_OMAP2PLUS)
 	help
 	  Select this option if you want to enable the OMAP 32KHz timer.
-- 
1.7.5.4

