From cc5c49869e456a89be388630ab8c2b6fe67e1dc4 Mon Sep 17 00:00:00 2001
From: Guoqing Jiang <Guoqing.Jiang@windriver.com>
Date: Mon, 8 Oct 2012 13:56:00 +0800
Subject: [PATCH 603/609] ARM: OMAP2+: am335x: WLAN support for EVM-SK

Refer to commit 02fa178be88ec98dba468fddcc6c6a90679855f5 from
git://arago-project.org/git/projects/linux-am33x.git

Set the right gpio pins and mux mode for wlan.

Configure SDIO card to support WLAN and UART1 to support
Bluetooth on AM335x EVM-SK.

Signed-off-by: Vita Preskovsky <vitap@ti.com>
[vaibhav.bedia@ti.com - Fix a few checkpatch errors, update
the $SUBJECT to be in line with the general convention and
make use of the evm_id variable for board specific init]
Signed-off-by: Vaibhav Bedia <vaibhav.bedia@ti.com>
Integrated-by: Guoqing Jiang <Guoqing.Jiang@windriver.com>
---
 arch/arm/mach-omap2/board-am335xevm.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/arch/arm/mach-omap2/board-am335xevm.c b/arch/arm/mach-omap2/board-am335xevm.c
index d8f78e9..100e682 100644
--- a/arch/arm/mach-omap2/board-am335xevm.c
+++ b/arch/arm/mach-omap2/board-am335xevm.c
@@ -912,7 +912,7 @@ static struct pinmux_config ecap2_pin_mux[] = {
 
 #define AM335XEVM_WLAN_PMENA_GPIO	GPIO_TO_PIN(1, 30)
 #define AM335XEVM_WLAN_IRQ_GPIO		GPIO_TO_PIN(3, 17)
-#define AM335XEVM_SK_WLAN_IRQ_GPIO      GPIO_TO_PIN(1, 29)
+#define AM335XEVM_SK_WLAN_IRQ_GPIO      GPIO_TO_PIN(0, 31)
 
 struct wl12xx_platform_data am335xevm_wlan_data = {
 	.irq = OMAP_GPIO_IRQ(AM335XEVM_WLAN_IRQ_GPIO),
@@ -948,8 +948,8 @@ static struct pinmux_config wl12xx_pin_mux[] = {
  };
 
 static struct pinmux_config wl12xx_pin_mux_sk[] = {
-	{"gpmc_wpn.gpio0_31", OMAP_MUX_MODE7 | AM33XX_PIN_OUTPUT},
-	{"gpmc_csn0.gpio1_29", OMAP_MUX_MODE7 | AM33XX_PIN_INPUT},
+	{"gpmc_wpn.gpio0_31", OMAP_MUX_MODE7 | AM33XX_PIN_INPUT},
+	{"gpmc_csn0.gpio1_29", OMAP_MUX_MODE7 | AM33XX_PIN_OUTPUT_PULLUP},
 	{"mcasp0_ahclkx.gpio3_21", OMAP_MUX_MODE7 | AM33XX_PIN_OUTPUT},
 	{NULL, 0},
 };
@@ -1761,7 +1761,7 @@ static void wl12xx_init(int evm_id, int profile)
 	struct omap_mmc_platform_data *mmc_data;
 
 	if (evm_id == EVM_SK) {
-		am335xevm_wlan_data.wlan_enable_gpio = GPIO_TO_PIN(0, 31);
+		am335xevm_wlan_data.wlan_enable_gpio = GPIO_TO_PIN(1, 29);
 		am335xevm_wlan_data.bt_enable_gpio = GPIO_TO_PIN(3, 21);
 		am335xevm_wlan_data.irq =
 				OMAP_GPIO_IRQ(AM335XEVM_SK_WLAN_IRQ_GPIO);
-- 
1.7.5.4

