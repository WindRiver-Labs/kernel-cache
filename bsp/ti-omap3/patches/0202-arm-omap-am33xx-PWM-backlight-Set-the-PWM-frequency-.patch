From 37d9b0bde16f3e80b8b96a51f9ffff01e06d1242 Mon Sep 17 00:00:00 2001
From: "Philip, Avinash" <avinashphilip@ti.com>
Date: Sun, 12 Aug 2012 22:42:51 +0800
Subject: [PATCH 202/609] arm: omap: am33xx: PWM: backlight: Set the PWM
 frequency to 20KHz.

Original commit: 4de01b1a2b503aa4b43db60a45b86261ee920502

  From git://arago-project.org/git/projects/linux-am33x.git
  And ti-sdk-am335x-evm-05.05.00.00-Linux-x86-Install image

PWM frequency in audible frequency (< 20KHz) range causes some noise on
brightness values other than 100%. Also with the the PWM frequency of
100 Hz, flickers are also visible. So this patch fixes PWM frequency to
20KHz (outside audible range) and put lth_brightness value to 21 to
obtain a linear scale of brightness from 0 to 100%.

Signed-off-by: Philip, Avinash <avinashphilip@ti.com>
---
 arch/arm/mach-omap2/board-am335xevm.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-omap2/board-am335xevm.c b/arch/arm/mach-omap2/board-am335xevm.c
index 7fac5d8..738bc1a 100644
--- a/arch/arm/mach-omap2/board-am335xevm.c
+++ b/arch/arm/mach-omap2/board-am335xevm.c
@@ -82,13 +82,14 @@ static const struct display_panel disp_panel = {
 /* LCD backlight platform Data */
 #define AM335X_BACKLIGHT_MAX_BRIGHTNESS        100
 #define AM335X_BACKLIGHT_DEFAULT_BRIGHTNESS    100
-#define AM335X_PWM_PERIOD_NANO_SECONDS        (10000 * 10)
+#define AM335X_PWM_PERIOD_NANO_SECONDS        (5000 * 10)
 
 #define PWM_DEVICE_ID   "ecap.0"
 
 static struct platform_pwm_backlight_data am335x_backlight_data = {
 	.pwm_id         = PWM_DEVICE_ID,
 	.ch             = -1,
+	.lth_brightness	= 21,
 	.max_brightness = AM335X_BACKLIGHT_MAX_BRIGHTNESS,
 	.dft_brightness = AM335X_BACKLIGHT_DEFAULT_BRIGHTNESS,
 	.pwm_period_ns  = AM335X_PWM_PERIOD_NANO_SECONDS,
-- 
1.7.5.4

