From 9e0f55ac5303ce02bfb47443c4d98fe9cc6d485c Mon Sep 17 00:00:00 2001
From: "Raj, Deepu" <deepu.raj@ti.com>
Date: Mon, 21 Nov 2011 12:29:20 +0530
Subject: [PATCH 488/609] ASoC: 320aic3x: suspend/resume cache_sync fix

Original commit: 555bdd908e31e9ef5458f3f19cf6143e622a8769

  From git://arago-project.org/git/projects/linux-am33x.git
  And ti-sdk-am335x-evm-05.05.00.00-Linux-x86-Install image

 This patch fixes audio resume failure. AIC3X codec driver is not
 generating disable regulator event due to unknown reason.
 Need to revisit the patch to find the reason and fix the same.

Signed-off-by: Raj, Deepu <deepu.raj@ti.com>
Signed-off-by: Hebbar, Gururaja <gururaja.hebbar@ti.com>
---
 sound/soc/codecs/tlv320aic3x.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/sound/soc/codecs/tlv320aic3x.c b/sound/soc/codecs/tlv320aic3x.c
index b8f0262..9ea5e17 100644
--- a/sound/soc/codecs/tlv320aic3x.c
+++ b/sound/soc/codecs/tlv320aic3x.c
@@ -1118,6 +1118,11 @@ static int aic3x_set_power(struct snd_soc_codec *codec, int power)
 		codec->cache_only = 1;
 		ret = regulator_bulk_disable(ARRAY_SIZE(aic3x->supplies),
 					     aic3x->supplies);
+		/* Enable cache sync if regulator disable
+		 * event is not triggerd.
+		 * ToDo : Revisit later to fix it
+		 */
+		codec->cache_sync = 1;
 	}
 out:
 	return ret;
-- 
1.7.5.4

