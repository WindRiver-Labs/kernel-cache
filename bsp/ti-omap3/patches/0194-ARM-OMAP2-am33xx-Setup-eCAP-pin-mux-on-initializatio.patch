From 62ebc5a122628a4528997e53064ba1e9e8ebc9ac Mon Sep 17 00:00:00 2001
From: "Philip, Avinash" <avinashphilip@ti.com>
Date: Sun, 12 Aug 2012 14:30:47 +0800
Subject: [PATCH 194/609] ARM: OMAP2+: am33xx: Setup eCAP pin-mux on
 initialization

Original commit: 53bc5554edb1b2ad0e4ddd596d28f3073bbe4ce7

  From git://arago-project.org/git/projects/linux-am33x.git
  And ti-sdk-am335x-evm-05.05.00.00-Linux-x86-Install image

Pinmuxing done from late_initcall will fail if CONFIG_DEBUG_FS is not
enabled. Hence move pin_mux setup to profile_detection stage.

Signed-off-by: Philip, Avinash <avinashphilip@ti.com>
---
 arch/arm/mach-omap2/board-am335xevm.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-omap2/board-am335xevm.c b/arch/arm/mach-omap2/board-am335xevm.c
index 9fab3a8..38d961c 100644
--- a/arch/arm/mach-omap2/board-am335xevm.c
+++ b/arch/arm/mach-omap2/board-am335xevm.c
@@ -847,6 +847,7 @@ static struct pinmux_config wl12xx_pin_mux_evm_rev1_0[] = {
 static void enable_ecap0(int evm_id, int profile)
 {
 	backlight_enable = true;
+	setup_pin_mux(ecap0_pin_mux);
 }
 /* Setup pwm-backlight */
 static struct platform_device am335x_backlight = {
@@ -862,7 +863,6 @@ static int __init ecap0_init(void)
 	int status = 0;
 
 	if (backlight_enable) {
-		setup_pin_mux(ecap0_pin_mux);
 		platform_device_register(&am335x_backlight);
 	}
 	return status;
-- 
1.7.5.4

