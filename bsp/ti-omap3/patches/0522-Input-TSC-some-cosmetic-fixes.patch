From aa5c78ccbceb71e9d65ac6ef217c835b90001d9f Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Thu, 16 Aug 2012 11:14:18 +0800
Subject: [PATCH 522/609] Input: TSC: some cosmetic fixes

This patch fixes some compiling errors to meet the updates
to the latest kernel version.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/input/touchscreen/ti_tscadc.c |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/drivers/input/touchscreen/ti_tscadc.c b/drivers/input/touchscreen/ti_tscadc.c
index 1652090..5c44996 100644
--- a/drivers/input/touchscreen/ti_tscadc.c
+++ b/drivers/input/touchscreen/ti_tscadc.c
@@ -116,7 +116,7 @@ static void tscadc_writel(struct tscadc *tsc, unsigned int reg,
 	writel(val, tsc->tsc_base + reg);
 }
 
-static void step_config(struct tscadc *ts_dev)
+static void tscadc_step_config(struct tscadc *ts_dev)
 {
 	unsigned int	config;
 	int i;
@@ -293,6 +293,8 @@ static irqreturn_t tscadc_irq(int irq, void *dev)
 		irqclr |= IRQENB_PENUP;
 	}
 
+	irqclr |= IRQENB_HW_PEN;
+
 	tscadc_writel(ts_dev, REG_IRQSTATUS, irqclr);
 	/* check pending interrupts */
 	tscadc_writel(ts_dev, REG_IRQEOI, 0x0);
@@ -359,7 +361,6 @@ static int __devinit tscadc_probe(struct platform_device *pdev)
 		err = -ENOMEM;
 		goto err_release_mem_region;
 	}
-	irqclr |= IRQENB_HW_PEN;
 
 	err = request_irq(ts_dev->irq, tscadc_irq,
 			  0, pdev->dev.driver->name, ts_dev);
@@ -408,7 +409,7 @@ static int __devinit tscadc_probe(struct platform_device *pdev)
 
 	tscadc_idle_config(ts_dev);
 	tscadc_writel(ts_dev, REG_IRQENABLE, IRQENB_FIFO1THRES);
-	step_config(ts_dev);
+	tscadc_step_config(ts_dev);
 	tscadc_writel(ts_dev, REG_FIFO1THR, 6);
 
 	ctrl |= CNTRLREG_TSCSSENB;
@@ -436,7 +437,6 @@ static int __devinit tscadc_probe(struct platform_device *pdev)
 err_disable_clk:
 	pm_runtime_put_sync(&pdev->dev);
 	pm_runtime_disable(&pdev->dev);
-err_free_irq:
 	free_irq(ts_dev->irq, ts_dev);
 err_unmap_regs:
 	iounmap(ts_dev->tsc_base);
@@ -519,8 +519,8 @@ static int tscadc_resume(struct platform_device *pdev)
 	restore &= ~(CNTRLREG_POWERDOWN);
 	tscadc_writel(ts_dev, REG_CTRL, restore);
 
-	tsc_idle_config(ts_dev);
-	step_config(ts_dev);
+	tscadc_idle_config(ts_dev);
+	tscadc_step_config(ts_dev);
 	tscadc_writel(ts_dev, REG_FIFO1THR, 6);
 	restore = tscadc_readl(ts_dev, REG_CTRL);
 	tscadc_writel(ts_dev, REG_CTRL,
-- 
1.7.5.4

