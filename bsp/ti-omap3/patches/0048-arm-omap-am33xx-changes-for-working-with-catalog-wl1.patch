From 1b9d6ff34475e39aa890ecb73ac7d5ab7252dddd Mon Sep 17 00:00:00 2001
From: Eyal Reizer <eyalr@ti.com>
Date: Mon, 14 Nov 2011 09:44:10 +0200
Subject: [PATCH 048/609] arm: omap: am33xx: changes for working with catalog
 wl1271 com6m module

Original commit: 2c50b711be828b6e59b24ff0c20b6ed7fbbe2ccd

  From git://arago-project.org/git/projects/linux-am33x.git
  And ti-sdk-am335x-evm-05.05.00.00-Linux-x86-Install image

* The catalog COM6M module is using a 38.4Mhz crystal

* Do not activate the BT enable pin during boot. this is done from the
  appliaction when BT is brought up.

Signed-off-by: Eyal Reizer <eyalr@ti.com>
Signed-off-by: Vaibhav Hiremath <hvaibhav@ti.com>
---
 arch/arm/mach-omap2/board-am335xevm.c |    7 ++-----
 1 files changed, 2 insertions(+), 5 deletions(-)

diff --git a/arch/arm/mach-omap2/board-am335xevm.c b/arch/arm/mach-omap2/board-am335xevm.c
index d3bdc17..b3863d4 100644
--- a/arch/arm/mach-omap2/board-am335xevm.c
+++ b/arch/arm/mach-omap2/board-am335xevm.c
@@ -606,8 +606,7 @@ static int backlight_enable;
 
 struct wl12xx_platform_data am335xevm_wlan_data = {
 	.irq = OMAP_GPIO_IRQ(AM335XEVM_WLAN_IRQ_GPIO),
-	.board_ref_clock = WL12XX_REFCLOCK_26, /* 26 MHz */
-	.board_tcxo_clock = WL12XX_REFCLOCK_26, /* 26 MHz */
+	.board_ref_clock = WL12XX_REFCLOCK_38_XTAL, /* 38.4Mhz */
 };
 
 /* Module pin mux for wlan and bluetooth */
@@ -937,10 +936,8 @@ static void wl12xx_bluetooth_enable(void)
 	if (status < 0)
 		pr_err("Failed to request gpio for bt_enable");
 
-	pr_info("Enable bluetooth...\n");
+	pr_info("Configure Bluetooth Enable pin...\n");
 	gpio_direction_output(AM335XEVM_BT_ENABLE_GPIO, 0);
-	msleep(1);
-	gpio_set_value(AM335XEVM_BT_ENABLE_GPIO, 1);
 }
 
 static int wl12xx_set_power(struct device *dev, int slot, int on, int vdd)
-- 
1.7.5.4

