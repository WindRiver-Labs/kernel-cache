From 92fb795028ccc15eaa4c1d1e265117237c1e2f94 Mon Sep 17 00:00:00 2001
From: Guoqing Jiang <Guoqing.Jiang@windriver.com>
Date: Tue, 9 Oct 2012 09:42:06 +0800
Subject: [PATCH 602/609] OMAP: PM: disable idle on suspend for GPIO0

Refer to upstream c8c9fda5069456eb9e0e403c19764b2e257802e1

For am335x sk board, we need to ensure gpio0 device doesn't enter idle
status, otherwise the board can't be wake up after sleep.

Signed-off-by: Kevin Hilman <khilman@ti.com>
Signed-off-by: Rafael J. Wysocki <rjw@sisk.pl>
Integrated-by: Guoqing Jiang <Guoqing.Jiang@windriver.com>
---
 arch/arm/mach-omap2/gpio.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-omap2/gpio.c b/arch/arm/mach-omap2/gpio.c
index 2f994e5..690630e 100644
--- a/arch/arm/mach-omap2/gpio.c
+++ b/arch/arm/mach-omap2/gpio.c
@@ -136,6 +136,11 @@ static int __init omap2_gpio_dev_init(struct omap_hwmod *oh, void *unused)
 		return PTR_ERR(pdev);
 	}
 
+#ifdef CONFIG_MACH_AM335XEVM
+	if (id == 1)
+		omap_device_disable_idle_on_suspend(pdev);
+#endif
+
 	return 0;
 }
 
-- 
1.7.5.4

