From dce0e1f72a12d9d16377ba6bc70509112257b15f Mon Sep 17 00:00:00 2001
From: Zhang Xiao <xiao.zhang@windriver.com>
Date: Wed, 1 Aug 2018 06:02:04 +0000
Subject: [PATCH] ARM: iproc: Setup scheduler clock

plat-iproc has no hardware scheduler clock yet, thus the jiffy is used
as the default scheduler clock. Setup a real hardware clock to make it
more accurate.

Signed-off-by: Zhang Xiao <xiao.zhang@windriver.com>
---
 arch/arm/plat-iproc/timer-sp.c |    1 +
 1 file changed, 1 insertion(+)

diff --git a/arch/arm/plat-iproc/timer-sp.c b/arch/arm/plat-iproc/timer-sp.c
index e364815a..9aba7e8 100644
--- a/arch/arm/plat-iproc/timer-sp.c
+++ b/arch/arm/plat-iproc/timer-sp.c
@@ -135,6 +135,7 @@ void __init iproc_clocksource_init(void __iomem *base)
 	// ref - arch/arcm/mach-u300/timer.c (2.6.37 vs 2.6.38)
 	clocksource_register_hz(cs, cpu_clk_freq);
 
+	setup_sched_clock(read_sched_clock, 32, cpu_clk_freq);
 }
 
 
-- 
1.7.9.5

