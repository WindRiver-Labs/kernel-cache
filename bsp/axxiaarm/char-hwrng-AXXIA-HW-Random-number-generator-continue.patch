From 76b0de6866a4772986962b5bbe2f5517b7c6d422 Mon Sep 17 00:00:00 2001
From: Sreedevi Joshi <sreedevi.joshi@intel.com>
Date: Fri, 24 Apr 2015 13:32:10 -0500
Subject: [PATCH 24/86] char: hwrng: AXXIA HW Random number generator
 (continue)

AXXIA TRNG block driver for random number generation has been added.
This provides HW Random number generation using AXXIA HW block. When
enabled in the device tree, /dev/hwrng device is available and random
numbers can be read from there.

Signed-off-by: Sreedevi Joshi <sreedevi.joshi@intel.com>
[Original patch is from linux-yocto-4.1 axxia/base branch.]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/arm64/boot/dts/intel/axc67xx-sim.dtsi |    7 +++++++
 arch/arm64/boot/dts/intel/axc67xx.dtsi     |    7 +++++++
 arch/arm64/boot/dts/intel/axm5601-emu.dts  |    4 ++++
 arch/arm64/boot/dts/intel/axm5602-emu.dts  |    4 ++++
 arch/arm64/boot/dts/intel/axm5606-emu.dts  |    3 +++
 arch/arm64/boot/dts/intel/axm56xx-sim.dtsi |    6 ++++++
 arch/arm64/boot/dts/intel/axm56xx.dtsi     |    6 ++++++
 7 files changed, 37 insertions(+), 0 deletions(-)

diff --git a/arch/arm64/boot/dts/intel/axc67xx-sim.dtsi b/arch/arm64/boot/dts/intel/axc67xx-sim.dtsi
index 5303a21..d711aa9 100644
--- a/arch/arm64/boot/dts/intel/axc67xx-sim.dtsi
+++ b/arch/arm64/boot/dts/intel/axc67xx-sim.dtsi
@@ -316,6 +316,13 @@
 			status = "disabled";
 		};
 
+		trng: trng@8031060000 {
+			compatible = "lsi,trng";
+			reg = <0x80 0x31060000 0x20000>;
+			interrupts = <GIC_SPI 8 IRQ_TYPE_LEVEL_HIGH>;
+			status = "disabled";
+		};
+
 		pci0: pci@c000000000 {
 			compatible = "lsi,plb-pciex";
 			device_type = "pci";
diff --git a/arch/arm64/boot/dts/intel/axc67xx.dtsi b/arch/arm64/boot/dts/intel/axc67xx.dtsi
index 53b73ff..cd64261 100644
--- a/arch/arm64/boot/dts/intel/axc67xx.dtsi
+++ b/arch/arm64/boot/dts/intel/axc67xx.dtsi
@@ -316,6 +316,13 @@
 			status = "disabled";
 		};
 
+		trng: trng@8031060000 {
+			compatible = "lsi,trng";
+			reg = <0x80 0x31060000 0x20000>;
+			interrupts = <GIC_SPI 8 IRQ_TYPE_LEVEL_HIGH>;
+			status = "disabled";
+		};
+
 		pci0: pci@c000000000 {
 			compatible = "lsi,plb-pciex";
 			device_type = "pci";
diff --git a/arch/arm64/boot/dts/intel/axm5601-emu.dts b/arch/arm64/boot/dts/intel/axm5601-emu.dts
index 74305ae..6d4577b 100644
--- a/arch/arm64/boot/dts/intel/axm5601-emu.dts
+++ b/arch/arm64/boot/dts/intel/axm5601-emu.dts
@@ -57,3 +57,7 @@
 &mtc {
 	status = "okay";
 };
+
+&trng {
+	status = "okay";
+};
diff --git a/arch/arm64/boot/dts/intel/axm5602-emu.dts b/arch/arm64/boot/dts/intel/axm5602-emu.dts
index 5127f27..5add2ff 100644
--- a/arch/arm64/boot/dts/intel/axm5602-emu.dts
+++ b/arch/arm64/boot/dts/intel/axm5602-emu.dts
@@ -57,3 +57,7 @@
 &mtc {
 	status = "okay";
 };
+
+&trng {
+	status = "okay";
+};
diff --git a/arch/arm64/boot/dts/intel/axm5606-emu.dts b/arch/arm64/boot/dts/intel/axm5606-emu.dts
index 2cb5016..d99ba6a 100644
--- a/arch/arm64/boot/dts/intel/axm5606-emu.dts
+++ b/arch/arm64/boot/dts/intel/axm5606-emu.dts
@@ -57,3 +57,6 @@
 &mtc {
 	status = "okay";
 };
+&trng {
+	status = "okay";
+};
diff --git a/arch/arm64/boot/dts/intel/axm56xx-sim.dtsi b/arch/arm64/boot/dts/intel/axm56xx-sim.dtsi
index 5acbe15..115035c 100644
--- a/arch/arm64/boot/dts/intel/axm56xx-sim.dtsi
+++ b/arch/arm64/boot/dts/intel/axm56xx-sim.dtsi
@@ -216,6 +216,12 @@
 			interrupts = <GIC_SPI 60 IRQ_TYPE_LEVEL_HIGH>;
 			status = "disabled";
 		};
+		trng: trng@8031060000 {
+			compatible = "lsi,trng";
+			reg = <0x80 0x31060000 0x20000>;
+			interrupts = <GIC_SPI 4 IRQ_TYPE_LEVEL_HIGH>;
+			status = "disabled";
+		};
 
 		pci0: pci@c000000000 {
 			compatible = "lsi,plb-pciex";
diff --git a/arch/arm64/boot/dts/intel/axm56xx.dtsi b/arch/arm64/boot/dts/intel/axm56xx.dtsi
index 99287f2..17a99e1 100644
--- a/arch/arm64/boot/dts/intel/axm56xx.dtsi
+++ b/arch/arm64/boot/dts/intel/axm56xx.dtsi
@@ -218,6 +218,12 @@
 			interrupts = <GIC_SPI 28 IRQ_TYPE_LEVEL_HIGH>;
 			status = "disabled";
 		};
+		trng: trng@8031060000 {
+			compatible = "lsi,trng";
+			reg = <0x80 0x31060000 0x20000>;
+			interrupts = <GIC_SPI 4 IRQ_TYPE_LEVEL_HIGH>;
+			status = "disabled";
+		};
 
 		pci0: pci@c000000000 {
 			compatible = "lsi,plb-pciex";
-- 
1.7.5.4

