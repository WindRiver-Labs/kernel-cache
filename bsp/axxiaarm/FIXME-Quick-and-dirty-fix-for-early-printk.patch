From e9fb79d0adb6f547877f0301f3bd966a89ef107b Mon Sep 17 00:00:00 2001
From: Zhenbo Gao <zhenbo.gao@windriver.com>
Date: Thu, 2 Jun 2016 17:51:12 +0800
Subject: [PATCH] FIXME: Quick and dirty fix for early printk

Signed-off-by: Fredrik Markstrom <fredrik.markstrom@gmail.com>

The mapping of UART physical address is not right before paging_init,
which is 0x10080000 but not 0x2010080000, so early_printk() can't work
fine before paging_init(after setup_early_printk)

Signed-off-by: Zhenbo Gao <zhenbo.gao@windriver.com>
---
 arch/arm/kernel/head.S |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/arch/arm/kernel/head.S b/arch/arm/kernel/head.S
index a2511e7..93427b7 100644
--- a/arch/arm/kernel/head.S
+++ b/arch/arm/kernel/head.S
@@ -297,6 +297,7 @@ __create_page_tables:
 	orr	r3, r7, r3, lsl #SECTION_SHIFT
 #ifdef CONFIG_ARM_LPAE
 	mov	r7, #1 << (54 - 32)		@ XN
+	orr	r7, r7, #0x20
 #ifdef CONFIG_CPU_ENDIAN_BE8
 	str	r7, [r0], #4
 	str	r3, [r0], #4
-- 
1.7.5.4

