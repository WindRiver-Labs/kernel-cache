From fe22a0f2aa4269dff6c62000261fc86d59dc7eb1 Mon Sep 17 00:00:00 2001
From: Zhang Xiao <xiao.zhang@windriver.com>
Date: Tue, 28 Jun 2016 17:30:21 +0800
Subject: [PATCH] preempt-rt timers: bug fix on unused variable __tvec_bases

In preempt-rt kernel, __tvec_bases will be defined but not used
in case of CONFIG_PREEMPT_RT_FULL and !CONFIG_SMP. Fix it.

Signed-off-by: Zhang Xiao <xiao.zhang@windriver.com>
---
 kernel/time/timer.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/kernel/time/timer.c b/kernel/time/timer.c
index c68ba87..02d2787 100644
--- a/kernel/time/timer.c
+++ b/kernel/time/timer.c
@@ -1713,7 +1713,7 @@ static void __init init_timer_cpus(void)
 	for_each_possible_cpu(cpu) {
 		if (cpu == local_cpu)
 			base = &boot_tvec_bases;
-#ifdef CONFIG_SMP
+#if defined(CONFIG_SMP) || defined(CONFIG_PREEMPT_RT_FULL)
 		else
 			base = per_cpu_ptr(&__tvec_bases, cpu);
 #endif
-- 
1.7.5.4

