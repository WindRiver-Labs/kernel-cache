From a751f8d9149b35b2c005a53a7fd90be7766998c2 Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Mon, 11 Jan 2010 21:33:27 -0800
Subject: [PATCH 3/6] WRHV/fsl_p4080: Add PCIE node

Add PCIE bus nodes on the dts file from the native dts. Only add
'target-id' property for configuring LAW.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/boot/dts/wrhv_p4080ds.dts |   40 ++++++++++++++++++++++++++++++++
 1 files changed, 40 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/boot/dts/wrhv_p4080ds.dts b/arch/powerpc/boot/dts/wrhv_p4080ds.dts
index 1c8581e..b542cfa 100644
--- a/arch/powerpc/boot/dts/wrhv_p4080ds.dts
+++ b/arch/powerpc/boot/dts/wrhv_p4080ds.dts
@@ -33,6 +33,7 @@
 		ethernet9 = &enet9;
 */
 		serial0 = &serial0;
+		pci0 = &pci0;
 		usb0 = &usb0;
 		usb1 = &usb1;
 		dma0 = &dma0;
@@ -1565,6 +1566,45 @@
 		interrupts = <16 2 56 2 57 2 60 2 61 2 62 2 63 2>;
 	};
 
+	pci0: pcie@fe200000 {
+		compatible = "fsl,p4080-pcie";
+		device_type = "pci";
+		target-id = <0>;
+		#interrupt-cells = <1>;
+		#size-cells = <2>;
+		#address-cells = <3>;
+		reg = <0 0xfe200000 0 0x1000>;
+		bus-range = <0x0 0xff>;
+		ranges = <0x02000000 0 0x80000000 0 0x80000000 0x0 0x20000000
+			  0x01000000 0 0x00000000 0 0xf8000000 0x0 0x00010000>;
+		clock-frequency = <0x1fca055>;
+		fsl,msi = <&msi0>;
+		interrupt-parent = <&mpic>;
+		interrupts = <16 2>;
+
+		interrupt-map-mask = <0xf800 0 0 7>;
+		interrupt-map = <
+			/* IDSEL 0x0 */
+			0000 0 0 1 &mpic 40 1
+			0000 0 0 2 &mpic 1 1
+			0000 0 0 3 &mpic 2 1
+			0000 0 0 4 &mpic 3 1
+			>;
+		pcie@0 {
+			reg = <0 0 0 0 0>;
+			#size-cells = <2>;
+			#address-cells = <3>;
+			device_type = "pci";
+			ranges = <0x02000000 0 0x80000000
+				  0x02000000 0 0x80000000
+				  0 0x20000000
+
+				  0x01000000 0 0x00000000
+				  0x01000000 0 0x00000000
+				  0 0x00010000>;
+		};
+	};
+
 	fsl,dpaa {
 		compatible = "fsl,p4080-dpaa", "fsl,dpaa";
 
-- 
1.6.5.2

