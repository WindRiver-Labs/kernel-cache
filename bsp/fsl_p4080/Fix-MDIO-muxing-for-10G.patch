From f240f96ef49bc33feb5be495047f3082e38081ed Mon Sep 17 00:00:00 2001
From: Andy Fleming <afleming@freescale.com>
Date: Thu, 15 Oct 2009 16:16:34 -0500
Subject: [PATCH 08/26] Fix MDIO muxing for 10G

The 10G PHY in slot 4 is accessible using a mux value of 1, rather than
2.  Doing this allows 10G to work on both ports.  Also, fix minor unit
address issue

Signed-off-by: Andy Fleming <afleming@freescale.com>
[Applied FSL SDK 2.0.3 patch "kernel-2.6.30-Fix-MDIO-muxing-for-10G.patch"]
Integrated-by: Yuri Nedel <Yuri.Nedel@windriver.com>
---
 arch/powerpc/boot/dts/p4080ds.dts     |    8 ++++----
 arch/powerpc/boot/dts/p4080ds_36b.dts |    8 ++++----
 2 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/arch/powerpc/boot/dts/p4080ds.dts b/arch/powerpc/boot/dts/p4080ds.dts
index 9fe598d..4389feb 100644
--- a/arch/powerpc/boot/dts/p4080ds.dts
+++ b/arch/powerpc/boot/dts/p4080ds.dts
@@ -39,7 +39,7 @@
 		emi1_slot4 = &p4080mdio1;
 		emi1_slot5 = &p4080mdio3;
 		emi1_rgmii = &p4080mdio0;
-		emi2_slot4 = &p4080xmdio2;
+		emi2_slot4 = &p4080xmdio1;
 		emi2_slot5 = &p4080xmdio3;
 		serial0 = &serial0;
 		serial1 = &serial1;
@@ -1022,7 +1022,7 @@
 			interrupt-parent = <&mpic>;
 		};
 
-		gpio: gpio@130000 {
+		gpio: gpio@130008 {
 			compatible = "fsl,qoriq-gpio";
 			reg = <0x130008 0xff8>;
 		};
@@ -1454,12 +1454,12 @@
 				reg = <0xf1000 0x1000>;
 				interrupts = <100 1>;
 
-				p4080xmdio2: p4080ds-xmdio2 {
+				p4080xmdio1: p4080ds-xmdio1 {
 					#address-cells = <1>;
 					#size-cells = <0>;
 					compatible = "fsl,p4080ds-xmdio";
 					fsl,mdio-handle = <&xmdio0>;
-					fsl,muxval = <2>;
+					fsl,muxval = <1>;
 
 					phy11: ethernet-phy@0 {
 						reg = <0x0>;
diff --git a/arch/powerpc/boot/dts/p4080ds_36b.dts b/arch/powerpc/boot/dts/p4080ds_36b.dts
index c6e0fab..ef932ad 100644
--- a/arch/powerpc/boot/dts/p4080ds_36b.dts
+++ b/arch/powerpc/boot/dts/p4080ds_36b.dts
@@ -40,7 +40,7 @@
 		emi1_slot4 = &p4080mdio1;
 		emi1_slot5 = &p4080mdio3;
 		emi1_rgmii = &p4080mdio0;
-		emi2_slot4 = &p4080xmdio2;
+		emi2_slot4 = &p4080xmdio1;
 		emi2_slot5 = &p4080xmdio3;
 		serial0 = &serial0;
 		serial1 = &serial1;
@@ -1023,7 +1023,7 @@
 			interrupt-parent = <&mpic>;
 		};
 
-		gpio: gpio@130000 {
+		gpio: gpio@130008 {
 			compatible = "fsl,qoriq-gpio";
 			reg = <0x130008 0xff8>;
 		};
@@ -1455,12 +1455,12 @@
 				reg = <0xf1000 0x1000>;
 				interrupts = <100 1>;
 
-				p4080xmdio2: p4080ds-xmdio2 {
+				p4080xmdio1: p4080ds-xmdio1 {
 					#address-cells = <1>;
 					#size-cells = <0>;
 					compatible = "fsl,p4080ds-xmdio";
 					fsl,mdio-handle = <&xmdio0>;
-					fsl,muxval = <2>;
+					fsl,muxval = <1>;
 
 					phy11: ethernet-phy@0 {
 						reg = <0x0>;
-- 
1.6.5.2

