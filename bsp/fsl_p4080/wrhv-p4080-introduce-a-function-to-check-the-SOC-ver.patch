From 77831c9fa4a6e06c2eecbd1ae88912bb37b2bb49 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Tue, 14 Dec 2010 15:49:05 +0800
Subject: [PATCH 3/5] wrhv/p4080: introduce a function to check the SOC version

In some cases we need to check the SOC version. So introduce
a function for that.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/platforms/85xx/wrhv_p4080_ds.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/platforms/85xx/wrhv_p4080_ds.c b/arch/powerpc/platforms/85xx/wrhv_p4080_ds.c
index 84a168a..9b2f594 100644
--- a/arch/powerpc/platforms/85xx/wrhv_p4080_ds.c
+++ b/arch/powerpc/platforms/85xx/wrhv_p4080_ds.c
@@ -41,6 +41,13 @@ extern unsigned long long wrhv_get_law_base(int index);
 extern int wrhv_set_law_attr(int index, unsigned int attr);
 extern int wrhv_get_law_attr(int index);
 
+static int __init p4080_is_svr_rev(int maj, int min)
+{
+	u32 svr = mfspr(SPRN_SVR);
+
+	return ((svr >> 4) & 0xf) == maj && (svr & 0xf) == min;
+}
+
 static void __init wrhv_mpc85xx_pic_init(void)
 {
 	wrhv_init_irq();
-- 
1.7.0

