From a6fed1f99cf65e0460b1aaee1e9ea08bc9f0f7d7 Mon Sep 17 00:00:00 2001
From: Yong Zhang <yong.zhang@windriver.com>
Date: Thu, 12 Dec 2013 15:25:56 +0800
Subject: [PATCH] dpa: firmware.S: don't use relative path

Otherwise build will fail if build directory is set
to other place, such as:

drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/firmware.S: Assembler messages:
drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/firmware.S:5: Error: file not found: fsl_fman_ucode_p4080_91_1-wrhv-guest.bin
remake[5]: *** [drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/firmware.o] Error 1

Signed-off-by: Yong Zhang <yong.zhang@windriver.com>
---
 .../NetCommSw/src/wrappers/Peripherals/FM/Makefile |    1 +
 .../src/wrappers/Peripherals/FM/firmware.S         |    2 +-
 2 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/Makefile b/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/Makefile
index 30ecd94..ec0dbf0 100644
--- a/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/Makefile
+++ b/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/Makefile
@@ -16,6 +16,7 @@ fsl-ncsw-PFM-objs	:=   lnxwrp_fm.o lnxwrp_fm_ioctls.o
 
 ifdef CONFIG_PPC85xx_VT_MODE
 	fsl-ncsw-PFM-objs	+=	firmware.o
+	AFLAGS_firmware.o	+=	-I$(srctree)/$(src)
 endif
 
 obj-$(CONFIG_COMPAT)     +=   lnxwrp_fm_compat_ioctls.o
diff --git a/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/firmware.S b/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/firmware.S
index a1d9691..f0ba01e 100644
--- a/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/firmware.S
+++ b/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/firmware.S
@@ -1,4 +1,4 @@
 	.section .firmware,"a"
 	.globl p4080_fman_firmware
 p4080_fman_firmware:
-	.incbin "../linux/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/fsl_fman_ucode_p4080_91_1-wrhv-guest.bin"
+	.incbin "fsl_fman_ucode_p4080_91_1-wrhv-guest.bin"
-- 
1.7.5.4

