From e022ec9eb5c0731c2e62ce2dce8f0ea452de0968 Mon Sep 17 00:00:00 2001
From: Geoff Thorpe <Geoff.Thorpe@freescale.com>
Date: Mon, 21 Dec 2009 23:55:37 -0500
Subject: [PATCH] qman: removed alignment attribute from qman_fq

The qman_fq struct is padding out to a full cacheline, so any data
appended by applications begins in the adjacent cacheline. This is
wasteful and results in a performance hit due to extra cacheline
stashing.

Signed-off-by: Yashpal Dutta <yashpal.dutta@freescale.com>
Signed-off-by: Geoff Thorpe <Geoff.Thorpe@freescale.com>
Signed-off-by: Paul Barrette <paul.barrette@freescale.com>
[Kevin: Original patch taken from Freescale p4080 SDK 2.0.2 tar
package, apply cleanly to kernel 2.6.27]
Integrated-by: Kevin Hao <kexin.hao@windriver.com>
---
 include/linux/fsl_qman.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/include/linux/fsl_qman.h b/include/linux/fsl_qman.h
index 10798dc..29aa49a 100644
--- a/include/linux/fsl_qman.h
+++ b/include/linux/fsl_qman.h
@@ -1240,7 +1240,7 @@ struct qman_fq {
 	enum qman_fq_state state;
 	int cgr_groupid;
 	struct rb_node node;
-} ____cacheline_aligned;
+};
 
 /* Flags to qman_create_fq() */
 #define QMAN_FQ_FLAG_NO_ENQUEUE      0x00000001 /* can't enqueue */
-- 
1.6.0.4

