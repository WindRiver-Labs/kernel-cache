From 3bceffa51c1ed1d1b1f2841517817b5f2142b916 Mon Sep 17 00:00:00 2001
From: Bruce Ashfield <bruce.ashfield@windriver.com>
Date: Tue, 8 Dec 2009 16:34:50 -0500
Subject: [PATCH] p4080: update to vbi conventions

The original implementation of the p4080 guest was using old
vbi naming conventions.

Signed-off-by: Bruce Ashfield <bruce.ashfield@windriver.com>
---
 arch/powerpc/include/asm/reg_wrhv.h        |    4 ++--
 arch/powerpc/platforms/85xx/wrhv_p4080ds.c |   10 +++++-----
 2 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/arch/powerpc/include/asm/reg_wrhv.h b/arch/powerpc/include/asm/reg_wrhv.h
index cee1378..27b4302 100644
--- a/arch/powerpc/include/asm/reg_wrhv.h
+++ b/arch/powerpc/include/asm/reg_wrhv.h
@@ -89,8 +89,8 @@
 #ifdef CONFIG_PPC85xx_VT_MODE
 #define WRHV_INT_UNLOCK(tmpr1,tmpr2)                    \
 	wrteei	1;                               \
-	lis	tmpr1,wrhvStatus@ha;                    \
-	lwz	tmpr1,wrhvStatus@l(tmpr1);              \
+	lis	tmpr1,wr_status@ha;                    \
+	lwz	tmpr1,wr_status@l(tmpr1);              \
 	lwz	tmpr1,VB_STATUS_INT_PENDING(tmpr1);     \
 	cmpwi	0,tmpr1,0;                              \
 	beq	1f;                                     \
diff --git a/arch/powerpc/platforms/85xx/wrhv_p4080ds.c b/arch/powerpc/platforms/85xx/wrhv_p4080ds.c
index ca419d4..f517ade 100644
--- a/arch/powerpc/platforms/85xx/wrhv_p4080ds.c
+++ b/arch/powerpc/platforms/85xx/wrhv_p4080ds.c
@@ -31,9 +31,9 @@
 
 #include <asm/wrhv.h>
 
-extern struct vb_config *wrhvConfig;
-extern struct vb_status *wrhvStatus;
-extern struct vb_control *wrhvControl;
+extern struct vb_config *wr_config;
+extern struct vb_status *wr_status;
+extern struct vb_control *wr_control;
 
 static void __init wrhv_sbc85xx_pic_init(void)
 {
@@ -146,11 +146,11 @@ static int __init p4080_ds_probe(void)
 {
 	unsigned long root = of_get_flat_dt_root();
 
-	/* wrhvConfig should have been initialized in wrhv_init(),
+	/* wr_config should have been initialized in wrhv_init(),
 	 * continue to complete the vbi initialization here.
 	 */
 	wrhv_mapping(); /* Map vb_config structure */
-	vbi_init(wrhvConfig);
+	vbi_init(wr_config);
 
 	strncpy(cmd_line, VBI_BOOTLINE_ADDR_GET(), VB_MAX_BOOTLINE_LENGTH - 1);
 	cmd_line[VB_MAX_BOOTLINE_LENGTH - 1] = 0;
-- 
1.6.5.2

