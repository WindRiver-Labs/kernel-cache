From be9fbc676930fe8e37a4c270bc035d13de815743 Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Wed, 12 May 2010 16:39:48 +0800
Subject: [PATCH 06/15] WRHV/fsl_p4080: disable paravirt-pvr for E500mc.

On E500mc the guest OS can access PVR so undefine paravirt-pvr implementation.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/kernel/vbi/wrhv.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/kernel/vbi/wrhv.c b/arch/powerpc/kernel/vbi/wrhv.c
index 649873d..e0d7d78 100644
--- a/arch/powerpc/kernel/vbi/wrhv.c
+++ b/arch/powerpc/kernel/vbi/wrhv.c
@@ -1278,7 +1278,9 @@ void wrhv_init(void)
 	pv_irq_ops.irq_of_parse_and_map =
 			wrhv_irq_of_parse_and_map;
 
+#ifndef CONFIG_PPC85xx_VT_MODE
 	pv_cpu_ops.get_pvr = wrhv_get_pvr;
+#endif
 	pv_cpu_ops.DebugException = wrhv_DebugException;
 	pv_cpu_ops.kgdb_arch_handle_exception =
 		wrhv_kgdb_arch_handle_exception;
-- 
1.6.5.2

