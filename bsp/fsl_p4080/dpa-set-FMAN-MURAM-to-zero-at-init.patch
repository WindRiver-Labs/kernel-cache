From 98916c3541daa9795f4efc34caa588697ea0072f Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Tue, 2 Mar 2010 15:01:59 +0800
Subject: [PATCH] dpa: set FMAN MURAM to zero at init

The MURAM may contain ECC erros. So we need set it to zero at init.
This patch is extracted from FMD7 in Freescale P4080 SDK 2.0.2.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../net/dpa/NetCommSw/Peripherals/FM/fm_muram.c    |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/drivers/net/dpa/NetCommSw/Peripherals/FM/fm_muram.c b/drivers/net/dpa/NetCommSw/Peripherals/FM/fm_muram.c
index 2b5b3c4..5dde95a 100644
--- a/drivers/net/dpa/NetCommSw/Peripherals/FM/fm_muram.c
+++ b/drivers/net/dpa/NetCommSw/Peripherals/FM/fm_muram.c
@@ -53,6 +53,11 @@ t_Handle FM_MURAM_ConfigAndInit(uint64_t baseAddress, uint32_t size)
         return NULL;
 
     }
+
+#ifndef VERIFICATION_SUPPORT
+    IOMemSet32(CAST_UINT64_TO_POINTER(baseAddress), 0, size);
+#endif /* VERIFICATION_SUPPORT */
+
     if (MM_Init(&h_Mem, baseAddress, size) != E_OK)
         return NULL;
     if (!h_Mem)
-- 
1.6.0.4

