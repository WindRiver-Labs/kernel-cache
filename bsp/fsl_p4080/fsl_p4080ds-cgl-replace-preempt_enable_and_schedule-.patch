From 756de7e72f1eac5262c0bb56de06fb8abea784dc Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Fri, 2 Jul 2010 13:05:58 +0800
Subject: [PATCH 1/2] fsl_p4080ds/cgl: replace preempt_enable_and_schedule as the preempt kernel expect

We should use preempt_enable_and_schedule to replace those original implementation,
preempt_enable_no_resched() & schedule() since the function, preempt_enable_no_resched,
was improved to debug missed preemption checks.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/kernel/idle.c |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/kernel/idle.c b/arch/powerpc/kernel/idle.c
index 1228ea6..6f22729 100644
--- a/arch/powerpc/kernel/idle.c
+++ b/arch/powerpc/kernel/idle.c
@@ -120,8 +120,7 @@ void wait_idle(void)
 		if (cpu_should_die())
 			cpu_die();
 
-		preempt_enable_no_resched();
-		schedule();
+		preempt_enable_and_schedule();
 		preempt_disable();
 	}
 }
-- 
1.6.5.2

