From 5f796c1c138a6e5b84b7b588aa055c4c5fc1ec1a Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Wed, 14 Oct 2009 14:33:40 +0800
Subject: [PATCH] mtd: fix compile error for Freescale eSPI flash driver

The original patch of this driver is against 2.6.30. The argument
mtd of of_mtd_parse_partitions is unused and is removed in 2.6.30.
So we should put a NULL argument in 2.6.27 kernel to fix the compile
error.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/mtd/devices/fsl_m25p80.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/mtd/devices/fsl_m25p80.c b/drivers/mtd/devices/fsl_m25p80.c
index e5fd701..12f2aa4 100644
--- a/drivers/mtd/devices/fsl_m25p80.c
+++ b/drivers/mtd/devices/fsl_m25p80.c
@@ -658,7 +658,7 @@ void parse_flash_partition(struct spi_device *spi)
 	static int num_flash;
 	struct device_node *np = spi->dev.archdata.of_node;
 
-	nr_parts = of_mtd_parse_partitions(&spi->dev, np, &parts);
+	nr_parts = of_mtd_parse_partitions(&spi->dev, NULL, np, &parts);
 	if (!nr_parts)
 		goto end;
 
-- 
1.5.5.1

