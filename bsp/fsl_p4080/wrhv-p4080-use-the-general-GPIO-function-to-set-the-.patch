From 2a0d1bc8a9703abebcf762d8cb0ea4354b533fd9 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Wed, 2 Mar 2011 10:05:10 +0800
Subject: [PATCH 2/2] wrhv/p4080: use the general GPIO function to set the multiplex of MDIO

Previously we set the GPIO directly in our MDIO driver. But now we use
the general GPIO lib function to do this work in the new MDIO driver.
So adjust the DTS according to this change.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/boot/dts/wrhv_p4080ds.dts |   17 ++++++++++++-----
 1 files changed, 12 insertions(+), 5 deletions(-)

diff --git a/arch/powerpc/boot/dts/wrhv_p4080ds.dts b/arch/powerpc/boot/dts/wrhv_p4080ds.dts
index 4cc3bf7..2cb95a0 100644
--- a/arch/powerpc/boot/dts/wrhv_p4080ds.dts
+++ b/arch/powerpc/boot/dts/wrhv_p4080ds.dts
@@ -913,6 +913,14 @@
 			};
 		};
 
+		gpio0: gpio@130000 {
+			compatible = "fsl,p4080-gpio", "fsl,qoriq-gpio";
+			reg = <0x130000 0x1000>;
+			interrupts = <55 2 0 0>;
+			#gpio-cells = <2>;
+			gpio-controller;
+		};
+
 		usb0: usb@210000 {
 			compatible = "fsl,p4080-usb2-mph",
 					"fsl,mpc85xx-usb2-mph", "fsl-usb2-mph";
@@ -1032,11 +1040,6 @@
 			clock-frequency = <0>;
 		};
 
-		gpio: gpio@130008 {
-			compatible = "fsl,qoriq-gpio";
-			reg = <0x130000 0x1000>;
-		};
-
 		crypto: crypto@300000 {
 			compatible = "fsl,p4080-sec4.0", "fsl,sec4.0";
 			#address-cells = <1>;
@@ -1298,6 +1301,8 @@
 				compatible = "fsl,fman-mdio";
 				reg = <0xe1120 0xee0>;
 				interrupts = <100 1>;
+				gpios = <&gpio0 0 0
+					 &gpio0 1 0>;
 
 				tbi0: tbi-phy@8 {
 					reg = <0x8>;
@@ -1473,6 +1478,8 @@
 				compatible = "fsl,fman-xmdio";
 				reg = <0xf1000 0x1000>;
 				interrupts = <100 1>;
+				gpios = <&gpio0 2 0
+					 &gpio0 3 0>;
 
 				p4080xmdio1: p4080ds-xmdio1 {
 					#address-cells = <1>;
-- 
1.6.5.2

