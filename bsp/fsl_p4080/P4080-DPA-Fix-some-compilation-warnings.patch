From a2e791f62dc526a8ac0bdb9d1d2ce137924da8ae Mon Sep 17 00:00:00 2001
From: Emil Medve <Emilian.Medve@freescale.com>
Date: Tue, 13 Oct 2009 14:31:50 -0500
Subject: [PATCH] P4080/DPA: Fix some compilation warnings

CC	drivers/net/dpa/dpa-ethtool.o
.../linux-2.6/drivers/net/dpa/dpa-ethtool.c: In function 'dpa_get_pauseparam':
.../linux-2.6/drivers/net/dpa/dpa-ethtool.c:210: warning: 'return' with a value, in function returning void
  CC	drivers/net/dpa/mac-api.o
.../linux-2.6/drivers/net/dpa/mac-api.c: In function 'init':
../linux-2.6/drivers/net/dpa/mac-api.c:114: warning: assignment makes integer from pointer without a cast

Signed-off-by: Emil Medve <Emilian.Medve@Freescale.com>
[Kevin: Original patch taken from Freescale p4080 SDK 2.0 ISO image.
Apply cleanly to kernel 2.6.27]
Integrated-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/dpa/dpa-ethtool.c |    2 +-
 drivers/net/dpa/mac-api.c     |    3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/net/dpa/dpa-ethtool.c b/drivers/net/dpa/dpa-ethtool.c
index a5cb87a..0f70d55 100644
--- a/drivers/net/dpa/dpa-ethtool.c
+++ b/drivers/net/dpa/dpa-ethtool.c
@@ -231,7 +231,7 @@ void __cold dpa_get_pauseparam(struct net_device *net_dev, struct ethtool_pausep
 		cpu_netdev_info(net_dev,
 				"%s:%hu:%s(): This is a MAC-less interface\n",
 				__file__, __LINE__, __func__);
-		return -ENODEV;
+		return;
 	}
 	if (unlikely(priv->mac_dev->phy_dev == NULL)) {
 		cpu_netdev_err(net_dev, "%s:%hu:%s(): phy device not initialized\n",
diff --git a/drivers/net/dpa/mac-api.c b/drivers/net/dpa/mac-api.c
index 1c67508..6039b25 100644
--- a/drivers/net/dpa/mac-api.c
+++ b/drivers/net/dpa/mac-api.c
@@ -115,7 +115,8 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 
 	priv = (typeof(priv))macdev_priv(mac_dev);
 
-	param.baseAddr =  devm_ioremap(mac_dev->dev, mac_dev->res->start, 0x2000);
+	param.baseAddr =  (typeof(param.baseAddr))(uintptr_t)devm_ioremap(
+		mac_dev->dev, mac_dev->res->start, 0x2000);
 	param.enetMode	= macdev2enetinterface(mac_dev);
 	memcpy(&param.addr, mac_dev->addr, min(sizeof(param.addr), sizeof(mac_dev->addr)));
 	param.f_Exceptions	= mac_exception;
-- 
1.6.0.4

