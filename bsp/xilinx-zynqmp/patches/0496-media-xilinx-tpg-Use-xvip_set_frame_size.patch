From 11998a455491c0f93fae0622d8baf7ae2dc56101 Mon Sep 17 00:00:00 2001
From: Hyun Kwon <hyun.kwon@xilinx.com>
Date: Tue, 18 Mar 2014 09:18:52 -0700
Subject: [PATCH 496/827] media: xilinx: tpg: Use xvip_set_frame_size()

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

Use xvip_set_frame_size().

Signed-off-by: Hyun Kwon <hyunk@xilinx.com>
Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit dc9ae7fc86b96daa27f16aa1ab0f507ef00162b8)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/media/platform/xilinx/xilinx-tpg.c | 6 +-----
 1 file changed, 1 insertion(+), 5 deletions(-)

diff --git a/drivers/media/platform/xilinx/xilinx-tpg.c b/drivers/media/platform/xilinx/xilinx-tpg.c
index 4a2a0d8..cc08477 100644
--- a/drivers/media/platform/xilinx/xilinx-tpg.c
+++ b/drivers/media/platform/xilinx/xilinx-tpg.c
@@ -126,17 +126,13 @@ static inline struct xtpg_device *to_tpg(struct v4l2_subdev *subdev)
 static int xtpg_s_stream(struct v4l2_subdev *subdev, int enable)
 {
 	struct xtpg_device *xtpg = to_tpg(subdev);
-	const u32 width = xtpg->format.width;
-	const u32 height = xtpg->format.height;
 
 	if (!enable) {
 		xvip_stop(&xtpg->xvip);
 		return 0;
 	}
 
-	xvip_write(&xtpg->xvip, XVIP_ACTIVE_SIZE,
-		   (height << XVIP_ACTIVE_VSIZE_SHIFT) |
-		   (width << XVIP_ACTIVE_HSIZE_SHIFT));
+	xvip_set_frame_size(&xtpg->xvip, &xtpg->format);
 
 	xvip_start(&xtpg->xvip);
 
-- 
2.9.3

