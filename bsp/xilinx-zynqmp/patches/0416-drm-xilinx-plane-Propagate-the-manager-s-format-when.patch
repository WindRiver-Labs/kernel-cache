From c086301e1439491165f59cbf648dc7805c7585f6 Mon Sep 17 00:00:00 2001
From: Hyun Kwon <hyun.kwon@xilinx.com>
Date: Wed, 15 Jan 2014 16:29:11 -0800
Subject: [PATCH 416/827] drm: xilinx: plane: Propagate the manager's format when no plane format is found

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

Propate the manager's format to the plane when no plane format is found.
This happens when there's no format conversion IPs in the pipeline,
and the plane needs to be set to the manager's format.

Signed-off-by: Hyun Kwon <hyunk@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit eedf80b038937e01a70650e35347faf34100e084)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/gpu/drm/xilinx/xilinx_drm_plane.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/gpu/drm/xilinx/xilinx_drm_plane.c b/drivers/gpu/drm/xilinx/xilinx_drm_plane.c
index dce0dd8..494bc01 100644
--- a/drivers/gpu/drm/xilinx/xilinx_drm_plane.c
+++ b/drivers/gpu/drm/xilinx/xilinx_drm_plane.c
@@ -498,9 +498,9 @@ xilinx_drm_plane_create(struct xilinx_drm_plane_manager *manager,
 			plane->format = manager->format;
 	}
 
-	/* If there's no IP other than VDMA, choose XRGB8888 */
+	/* If there's no IP other than VDMA, pick the manager's format */
 	if (plane->format == -1)
-		plane->format = DRM_FORMAT_XRGB8888;
+		plane->format = manager->format;
 
 	/* initialize drm plane */
 	ret = drm_plane_init(manager->drm, &plane->base, possible_crtcs,
-- 
2.9.3

