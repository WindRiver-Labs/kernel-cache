From 413affbc9a920665b63928df6312115952180b91 Mon Sep 17 00:00:00 2001
From: Hyun Kwon <hyun.kwon@xilinx.com>
Date: Thu, 24 Apr 2014 19:38:59 -0700
Subject: [PATCH 532/827] media: xilinx: dma: Stop entity chain walk at the entity with no sink pad

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

When starting or stopping the pipeline, the pipeline driver walks
the entities chain, and starts or stops all of them. When the walk reaches
the entity with no sink pad, walk needs to stop. xvip_get_entity_sink()
returns either the valid sink pad, or NULL when the entity doesn't have any
sink pad. When NULL is returned, stop the walk.

Signed-off-by: Hyun Kwon <hyunk@xilinx.com>
Acked-by: Radhey Shyam Pandey <radheys@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit db9f423f4bf09027aa6334504acce6f3ca4a649d)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/media/platform/xilinx/xilinx-dma.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/media/platform/xilinx/xilinx-dma.c b/drivers/media/platform/xilinx/xilinx-dma.c
index db60a1f..7615176 100644
--- a/drivers/media/platform/xilinx/xilinx-dma.c
+++ b/drivers/media/platform/xilinx/xilinx-dma.c
@@ -138,8 +138,8 @@ static int xvip_pipeline_start_stop(struct xvip_pipeline *pipe, bool start)
 
 	while (1) {
 		pad = xvip_get_entity_sink(entity, pad);
-		if (IS_ERR(pad))
-			return PTR_ERR(pad);
+		if (pad == NULL)
+			break;
 
 		if (!(pad->flags & MEDIA_PAD_FL_SINK))
 			break;
-- 
2.9.3

