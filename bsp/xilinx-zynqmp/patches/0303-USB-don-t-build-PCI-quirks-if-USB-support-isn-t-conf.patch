From a17922a3183c36a6bba97b66db4f75102d187b6f Mon Sep 17 00:00:00 2001
From: Alan Stern <stern@rowland.harvard.edu>
Date: Wed, 22 Apr 2015 12:11:59 -0400
Subject: [PATCH 303/827] USB: don't build PCI quirks if USB support isn't configured

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

The USB PCI quirks code gets built into the kernel whenever CONFIG_PCI
is enabled, even if CONFIG_USB is not set.  This can cause unnecessary
messages to show up in the kernel log, such as "CONFIG_USB_XHCI_HCD is
turned off, defaulting to EHCI" (which makes no sense when the kernel
has been configured without host-side USB support).

This patch addresses the problem by building pci-quirks.o only when
CONFIG_PCI and CONFIG_USB are both enabled.

Signed-off-by: Alan Stern <stern@rowland.harvard.edu>
Reported-by: Toralf FÃ¶rster <toralf.foerster@gmx.de>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
(cherry picked from commit 3091fa77ffb1b91f4ac3ae005efe6213508f7ec1)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/usb/host/Makefile | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/usb/host/Makefile b/drivers/usb/host/Makefile
index da03d8b..e0a4543 100644
--- a/drivers/usb/host/Makefile
+++ b/drivers/usb/host/Makefile
@@ -24,7 +24,9 @@ endif
 
 obj-$(CONFIG_USB_WHCI_HCD)	+= whci/
 
-obj-$(CONFIG_PCI)		+= pci-quirks.o
+ifneq ($(CONFIG_USB), )
+	obj-$(CONFIG_PCI)	+= pci-quirks.o
+endif
 
 obj-$(CONFIG_USB_EHCI_HCD)	+= ehci-hcd.o
 obj-$(CONFIG_USB_EHCI_PCI)	+= ehci-pci.o
-- 
2.9.3

