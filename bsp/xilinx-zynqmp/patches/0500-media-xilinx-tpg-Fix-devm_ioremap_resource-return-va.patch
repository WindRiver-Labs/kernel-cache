From fe161e6ae59d445f7c94a38ecf7b15518c39d493 Mon Sep 17 00:00:00 2001
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date: Tue, 18 Mar 2014 09:18:56 -0700
Subject: [PATCH 500/827] media: xilinx: tpg: Fix devm_ioremap_resource() return value check

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

devm_ioremap_resource() returns a negative integer on failure, not a
NULL pointer. Fix the error check.

Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit 4ecd116a5c3f01b3f5d3a84086c59c0041f70cf4)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/media/platform/xilinx/xilinx-tpg.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/media/platform/xilinx/xilinx-tpg.c b/drivers/media/platform/xilinx/xilinx-tpg.c
index 2a17c65..2a1c79c 100644
--- a/drivers/media/platform/xilinx/xilinx-tpg.c
+++ b/drivers/media/platform/xilinx/xilinx-tpg.c
@@ -573,8 +573,8 @@ static int xtpg_probe(struct platform_device *pdev)
 
 	res = platform_get_resource(pdev, IORESOURCE_MEM, 0);
 	xtpg->xvip.iomem = devm_ioremap_resource(&pdev->dev, res);
-	if (xtpg->xvip.iomem == NULL)
-		return -ENODEV;
+	if (IS_ERR(xtpg->xvip.iomem))
+		return PTR_ERR(xtpg->xvip.iomem);
 
 	/* Reset and initialize the core */
 	xvip_reset(&xtpg->xvip);
-- 
2.9.3

