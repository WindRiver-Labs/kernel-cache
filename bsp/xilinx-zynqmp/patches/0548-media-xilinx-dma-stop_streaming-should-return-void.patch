From 52f258ff7b99d894490c5b1c6b1931c93e8465f2 Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Thu, 30 Oct 2014 07:39:09 +0100
Subject: [PATCH 548/827] media: xilinx: dma: stop_streaming should return void

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

Fix our driver to follow change in mainline code.
Based on mainline patch:
"[media] vb2: stop_streaming should return void"
(sha1: e37559b22c63b557d242bfa1a07ab1b8f7d5d9f1)

Warning log:
drivers/media/platform/xilinx/xilinx-dma.c:505:2: warning:
initialization from incompatible pointer type [enabled by default]
  .stop_streaming = xvip_dma_stop_streaming,
  ^
drivers/media/platform/xilinx/xilinx-dma.c:505:2: warning: (near
initialization for 'xvip_dma_queue_qops.stop_streaming') [enabled by
default]

Reported-by: Wendy Liang <wendy.liang@xilinx.com>
Acked-by: Christian Kohn <christian.kohn@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit f15a5d2a731991698740dbd5c8b96d50dceccd5b)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/media/platform/xilinx/xilinx-dma.c | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/drivers/media/platform/xilinx/xilinx-dma.c b/drivers/media/platform/xilinx/xilinx-dma.c
index 75ad491..f399b92 100644
--- a/drivers/media/platform/xilinx/xilinx-dma.c
+++ b/drivers/media/platform/xilinx/xilinx-dma.c
@@ -471,7 +471,7 @@ error:
 	return ret;
 }
 
-static int xvip_dma_stop_streaming(struct vb2_queue *vq)
+static void xvip_dma_stop_streaming(struct vb2_queue *vq)
 {
 	struct xvip_dma *dma = vb2_get_drv_priv(vq);
 	struct xvip_pipeline *pipe = to_xvip_pipeline(&dma->video.entity);
@@ -491,8 +491,6 @@ static int xvip_dma_stop_streaming(struct vb2_queue *vq)
 	/* Cleanup the pipeline and mark it as being stopped. */
 	xvip_pipeline_cleanup(pipe);
 	media_entity_pipeline_stop(&dma->video.entity);
-
-	return 0;
 }
 
 static struct vb2_ops xvip_dma_queue_qops = {
-- 
2.9.3

