From 361b9123abdf9133e24c93006688e9361b161aaf Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Thu, 28 Jul 2016 15:06:21 +0200
Subject: [PATCH 089/827] soc: xilinx: Guard code which is called only for debugfs

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

Some functions are called only when debugfs for PM is enabled.
This patch removes compilation warnings:
drivers/soc/xilinx/zynqmp/pm.c:251:12: warning: ‘zynqmp_pm_self_suspend’
defined but not used [-Wunused-function]
 static int zynqmp_pm_self_suspend(const u32 node,
            ^
drivers/soc/xilinx/zynqmp/pm.c:300:12: warning:
‘zynqmp_pm_abort_suspend’ defined but not used [-Wunused-function]
 static int zynqmp_pm_abort_suspend(const enum zynqmp_pm_abort_reason
reason)
            ^
drivers/soc/xilinx/zynqmp/pm.c:494:12: warning:
‘zynqmp_pm_register_notifier’ defined but not used [-Wunused-function]
 static int zynqmp_pm_register_notifier(const u32 node, const u32 event,

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit 40d3a2a9427b899f43a2d60fe3bb3bd6b081d4c5)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/soc/xilinx/zynqmp/pm.c | 58 ++++++++++++++++++++++--------------------
 1 file changed, 30 insertions(+), 28 deletions(-)

diff --git a/drivers/soc/xilinx/zynqmp/pm.c b/drivers/soc/xilinx/zynqmp/pm.c
index 9666546..18ecc37 100644
--- a/drivers/soc/xilinx/zynqmp/pm.c
+++ b/drivers/soc/xilinx/zynqmp/pm.c
@@ -240,6 +240,7 @@ static int invoke_pm_fn(u32 pm_api_id, u32 arg0, u32 arg1, u32 arg2, u32 arg3,
 
 /* PM-APIs for suspending of APU */
 
+#ifdef CONFIG_ZYNQMP_PM_API_DEBUGFS
 /**
  * zynqmp_pm_self_suspend - PM call for master to suspend itself
  * @node:	Node ID of the master or subsystem
@@ -256,6 +257,35 @@ static int zynqmp_pm_self_suspend(const u32 node,
 }
 
 /**
+ * zynqmp_pm_abort_suspend - PM call to announce that a prior suspend request
+ *				is to be aborted.
+ * @reason:	Reason for the abort
+ *
+ * Return:	Returns status, either success or error+reason
+ */
+static int zynqmp_pm_abort_suspend(const enum zynqmp_pm_abort_reason reason)
+{
+	return invoke_pm_fn(ABORT_SUSPEND, reason, 0, 0, 0, NULL);
+}
+
+/**
+ * zynqmp_pm_register_notifier - Register the PU to be notified of PM events
+ * @node:	Node ID of the slave
+ * @event:	The event to be notified about
+ * @wake:	Wake up on event
+ * @enable:	Enable or disable the notifier
+ *
+ * Return:	Returns status, either success or error+reason
+ */
+static int zynqmp_pm_register_notifier(const u32 node, const u32 event,
+				       const u32 wake, const u32 enable)
+{
+	return invoke_pm_fn(REGISTER_NOTIFIER, node, event,
+						wake, enable, NULL);
+}
+#endif
+
+/**
  * zynqmp_pm_request_suspend - PM call to request for another PU or subsystem to
  *					be suspended gracefully.
  * @node:	Node ID of the targeted PU or subsystem
@@ -291,18 +321,6 @@ int zynqmp_pm_force_powerdown(const u32 target,
 EXPORT_SYMBOL_GPL(zynqmp_pm_force_powerdown);
 
 /**
- * zynqmp_pm_abort_suspend - PM call to announce that a prior suspend request
- *				is to be aborted.
- * @reason:	Reason for the abort
- *
- * Return:	Returns status, either success or error+reason
- */
-static int zynqmp_pm_abort_suspend(const enum zynqmp_pm_abort_reason reason)
-{
-	return invoke_pm_fn(ABORT_SUSPEND, reason, 0, 0, 0, NULL);
-}
-
-/**
  * zynqmp_pm_request_wakeup - PM call for to wake up selected master or subsystem
  * @node:	Node ID of the master or subsystem
  * @ack:	Flag to specify whether acknowledge requested
@@ -482,22 +500,6 @@ int zynqmp_pm_get_operating_characteristic(const u32 node,
 }
 EXPORT_SYMBOL_GPL(zynqmp_pm_get_operating_characteristic);
 
-/**
- * zynqmp_pm_register_notifier - Register the PU to be notified of PM events
- * @node:	Node ID of the slave
- * @event:	The event to be notified about
- * @wake:	Wake up on event
- * @enable:	Enable or disable the notifier
- *
- * Return:	Returns status, either success or error+reason
- */
-static int zynqmp_pm_register_notifier(const u32 node, const u32 event,
-				       const u32 wake, const u32 enable)
-{
-	return invoke_pm_fn(REGISTER_NOTIFIER, node, event,
-						wake, enable, NULL);
-}
-
 /* Direct-Control API functions */
 
 /**
-- 
2.9.3

