From d7699124715c8024ce8e4e8af4e5effe31c96e2e Mon Sep 17 00:00:00 2001
From: VNSL Durga <vnsl.durga.challa@xilinx.com>
Date: Thu, 24 Mar 2016 22:45:05 +0530
Subject: [PATCH 015/827] dma: zynqmp: Modified zynqmp_dma_tx_status API

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

As current implementation queue multiple requests from the
higher layer into a single request to dma engine, it is difficult
to get residue for request basis. So not updating the residue
information.

Signed-off-by: VNSL Durga <vnsldurg@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Acked-by: Punnaiah Choudary Kalluri <punnaia@xilinx.com>
(cherry picked from commit cae1f360de498822fa45f697a3068d3841b57999)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/dma/xilinx/zynqmp_dma.c | 10 +---------
 1 file changed, 1 insertion(+), 9 deletions(-)

diff --git a/drivers/dma/xilinx/zynqmp_dma.c b/drivers/dma/xilinx/zynqmp_dma.c
index 833de25..a25f756 100644
--- a/drivers/dma/xilinx/zynqmp_dma.c
+++ b/drivers/dma/xilinx/zynqmp_dma.c
@@ -750,15 +750,7 @@ static enum dma_status zynqmp_dma_tx_status(struct dma_chan *dchan,
 				      dma_cookie_t cookie,
 				      struct dma_tx_state *txstate)
 {
-	struct zynqmp_dma_chan *chan = to_chan(dchan);
-	enum dma_status ret;
-
-	ret = dma_cookie_status(dchan, cookie, txstate);
-	if (ret != DMA_COMPLETE)
-		dma_set_residue(txstate, readl(chan->regs +
-					ZYNQMP_DMA_TOTAL_BYTE));
-
-	return ret;
+	return dma_cookie_status(dchan, cookie, txstate);
 }
 
 /**
-- 
2.9.3

