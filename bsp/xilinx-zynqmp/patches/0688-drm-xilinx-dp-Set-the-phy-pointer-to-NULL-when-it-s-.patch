From 2aea803ef21a1879e61d079dcd2085cb32975f3a Mon Sep 17 00:00:00 2001
From: Hyun Kwon <hyun.kwon@xilinx.com>
Date: Fri, 1 Jul 2016 16:45:23 -0700
Subject: [PATCH 688/827] drm: xilinx: dp: Set the phy pointer to NULL when it's an error value

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

The phy pointer should be NULL, otherwise phy_exit() results in fault.

Signed-off-by: Hyun Kwon <hyun.kwon@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit d311adfa3593bc903f012c06da090db08ba8bc30)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/gpu/drm/xilinx/xilinx_drm_dp.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/gpu/drm/xilinx/xilinx_drm_dp.c b/drivers/gpu/drm/xilinx/xilinx_drm_dp.c
index c195140..1da915a 100644
--- a/drivers/gpu/drm/xilinx/xilinx_drm_dp.c
+++ b/drivers/gpu/drm/xilinx/xilinx_drm_dp.c
@@ -1422,6 +1422,7 @@ static int xilinx_drm_dp_probe(struct platform_device *pdev)
 			if (IS_ERR(dp->phy[i])) {
 				dev_err(dp->dev, "failed to get phy lane\n");
 				ret = PTR_ERR(dp->phy[i]);
+				dp->phy[i] = NULL;
 				goto error_dp_sub;
 			}
 
-- 
2.9.3

