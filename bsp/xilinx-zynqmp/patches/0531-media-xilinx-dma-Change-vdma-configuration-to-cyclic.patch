From 70fd4fc0309f8dea8795cfd5a5dd57d06f7786cb Mon Sep 17 00:00:00 2001
From: Hyun Kwon <hyun.kwon@xilinx.com>
Date: Tue, 18 Mar 2014 09:18:13 -0700
Subject: [PATCH 531/827] media: xilinx: dma: Change vdma configuration to cyclic-mode

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

VDMA in non-cyclic mode doesn't work with fsync enabled. Fsync is needed
to synchronize the pipeline with external input. So VDMA is configured to
cyclic mode in this patch, with fsync enabled at synthesis. This patch is
the only way to run the pipeline with external input, and it will be
revisited after IP level investigation.

Signed-off-by: Hyun Kwon <hyun.kwon@xilinx.com>
Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit 77301da001028668cc0805ca5342150d30db14e4)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/media/platform/xilinx/xilinx-dma.c | 2 --
 1 file changed, 2 deletions(-)

diff --git a/drivers/media/platform/xilinx/xilinx-dma.c b/drivers/media/platform/xilinx/xilinx-dma.c
index 0265663..db60a1f 100644
--- a/drivers/media/platform/xilinx/xilinx-dma.c
+++ b/drivers/media/platform/xilinx/xilinx-dma.c
@@ -644,8 +644,6 @@ xvip_dma_set_format(struct file *file, void *fh, struct v4l2_format *format)
 	config.hsize = dma->format.width * info->bpp;
 	config.stride = dma->format.bytesperline;
 	config.ext_fsync = 2;
-	config.frm_cnt_en = 1;
-	config.coalesc = 1;
 
 	dmaengine_device_control(dma->dma, DMA_SLAVE_CONFIG,
 				 (unsigned long)&config);
-- 
2.9.3

