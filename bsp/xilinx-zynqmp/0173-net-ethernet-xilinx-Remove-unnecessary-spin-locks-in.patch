From b41250f9c83075a27b2cc69cfff0abf498eac163 Mon Sep 17 00:00:00 2001
From: Kedareswara rao Appana <appana.durga.rao@xilinx.com>
Date: Mon, 22 Feb 2016 19:07:34 +0530
Subject: [PATCH 173/188] net: ethernet: xilinx: Remove unnecessary spin locks
 in the tx irq handler

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

Spinlocks are not required in the tx interrupt handler
this patch removes the same.

Signed-off-by: Kedareswara rao Appana <appanad@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit aa6482b6aa7ac1f1723bc919d3a613c13fba6ebc)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/net/ethernet/xilinx/xilinx_axienet_main.c | 2 --
 1 file changed, 2 deletions(-)

diff --git a/drivers/net/ethernet/xilinx/xilinx_axienet_main.c b/drivers/net/ethernet/xilinx/xilinx_axienet_main.c
index b2bf90f..e31496e9 100644
--- a/drivers/net/ethernet/xilinx/xilinx_axienet_main.c
+++ b/drivers/net/ethernet/xilinx/xilinx_axienet_main.c
@@ -1130,9 +1130,7 @@ static irqreturn_t axienet_tx_irq(int irq, void *_ndev)
 	status = axienet_dma_in32(lp, XAXIDMA_TX_SR_OFFSET);
 	if (status & (XAXIDMA_IRQ_IOC_MASK | XAXIDMA_IRQ_DELAY_MASK)) {
 		axienet_dma_out32(lp, XAXIDMA_TX_SR_OFFSET, status);
-		spin_lock(&lp->tx_lock);
 		axienet_start_xmit_done(lp->ndev);
-		spin_unlock(&lp->tx_lock);
 		goto out;
 	}
 	if (!(status & XAXIDMA_IRQ_ALL_MASK))
-- 
2.0.2

