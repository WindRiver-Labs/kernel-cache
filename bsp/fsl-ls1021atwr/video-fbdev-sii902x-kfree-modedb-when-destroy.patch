From d8253bc5f86056623c8679c22065f0412553a011 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 21 Aug 2017 08:18:05 +0800
Subject: [PATCH 1/1] video: fbdev: sii902x: kfree modedb when destroy

Since modedb does not belong to sii902x, it will not be kfreed when sii902x
free, so we need to explicitly free it.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/video/fbdev/fsl-sii902x.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/video/fbdev/fsl-sii902x.c b/drivers/video/fbdev/fsl-sii902x.c
index 31be41b..6867545 100644
--- a/drivers/video/fbdev/fsl-sii902x.c
+++ b/drivers/video/fbdev/fsl-sii902x.c
@@ -507,6 +507,8 @@ static int sii902x_probe(struct i2c_client *client,
 
 static int sii902x_remove(struct i2c_client *client)
 {
+	if (sii902x && sii902x->fbi && sii902x->fbi->monspecs.modedb)
+		fb_destroy_modedb(sii902x->fbi->monspecs.modedb);
 	fb_unregister_client(&nb);
 	sii902x_poweroff();
 	return 0;
-- 
2.9.3

