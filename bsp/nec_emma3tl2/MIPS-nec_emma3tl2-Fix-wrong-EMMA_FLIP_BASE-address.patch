From d48fd99fcaa6f9e421b81a555eab33bdb4136f9a Mon Sep 17 00:00:00 2001
From: Shinya Kuribayashi <shinya.kuribayashi@necel.com>
Date: Tue, 10 Nov 2009 02:47:35 -0800
Subject: [PATCH] MIPS: nec_emma3tl2: Fix wrong EMMA_FLIP_BASE address

The FLIP bus bridge control register set should start with an offset
0x100, so fix it in avoiding needless confusion.  No logical change.

Signed-off-by: Shinya Kuribayashi <shinya.kuribayashi@necel.com>
---
 arch/mips/emma/et10158/setup.c   |    2 +-
 include/asm-mips/emma/emma3tl2.h |   10 +++++-----
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/arch/mips/emma/et10158/setup.c b/arch/mips/emma/et10158/setup.c
index 361e060..40489cc 100644
--- a/arch/mips/emma/et10158/setup.c
+++ b/arch/mips/emma/et10158/setup.c
@@ -114,7 +114,7 @@ static void __init flip_init(void)
 {
 	struct flip_regs *flip;
 
-	flip = ioremap(EMMA_FLIP_BASE + 0x100, sizeof(struct flip_regs));
+	flip = ioremap(EMMA_FLIP_BASE, sizeof(struct flip_regs));
 
 	/* For USB HCs */
 	emma_out(flip->m_ctr[0], SWAP1_BYTE);
diff --git a/include/asm-mips/emma/emma3tl2.h b/include/asm-mips/emma/emma3tl2.h
index a2470e6..50707ce 100644
--- a/include/asm-mips/emma/emma3tl2.h
+++ b/include/asm-mips/emma/emma3tl2.h
@@ -23,7 +23,7 @@
 #define EMMA_ETHER_BASE			0x10012000
 #define EMMA_PBRD_BASE			0x10100000
 #define EMMA_TIMER_BASE			0x10110000
-#define EMMA_FLIP_BASE			0x10200000
+#define EMMA_FLIP_BASE			0x10200100
 
 #define EMMA_BHIF_STRAP_0		(EMMA_BHIF_BASE + 0x0010)
 #define EMMA_BHIF_CLKSEL		(EMMA_BHIF_BASE + 0x001c)
@@ -89,10 +89,10 @@
 #define EMMA_GPIO3_INT_CND_A		(EMMA_GPIO0_BASE + 0xec)
 #define EMMA_GPIO3_INT_CND_B		(EMMA_GPIO0_BASE + 0xf4)
 
-#define EMMA_OHCI_CONFIG_BASE		(EMMA_FLIP_BASE + 0x0200)
-#define EMMA_EHCI_CONFIG_BASE		(EMMA_FLIP_BASE + 0x0500)
-#define EMMA_EHCI_BASE			(EMMA_FLIP_BASE + 0x0f00)
-#define EMMA_OHCI_BASE			(EMMA_FLIP_BASE + 0x1000)
+#define EMMA_OHCI_CONFIG_BASE	(EMMA_FLIP_BASE + 0x0100) /* 0x1020.0200 */
+#define EMMA_EHCI_CONFIG_BASE	(EMMA_FLIP_BASE + 0x0400) /* 0x1020.0500 */
+#define EMMA_EHCI_BASE		(EMMA_FLIP_BASE + 0x0e00) /* 0x1020.0F00 */
+#define EMMA_OHCI_BASE		(EMMA_FLIP_BASE + 0x0f00) /* 0x1020.1000 */
 
 /*
  *  Memory map (physical address)
-- 
1.6.5.2

