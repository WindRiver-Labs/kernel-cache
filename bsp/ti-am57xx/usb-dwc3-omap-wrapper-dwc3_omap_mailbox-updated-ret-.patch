From 7b440aee26700671811375f16916ea25e4028238 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 7 Jul 2014 13:27:56 +0800
Subject: [PATCH 192/263] usb: dwc3-omap: wrapper dwc3_omap_mailbox updated
 ret val

This commit comes from branch ti-linux-3.12.y:
  git://git.ti.com/ti-linux-kernel/ti-linux-kernel.git

The cf526666 comes from the following git repo:

    git://git.ti.com/ti-linux-kernel/ti-linux-kernel.git

Instead of returning IRQ_NONE, it returns a 0 on success.
This allows it to be called if needed from a non irq function routine
nicely.

Change-Id: Ic7db386a91bd6661f686c519d04d57a3c1e0407b
Signed-off-by: Ruchika Kharwar <ruchika@ti.com>
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/usb/dwc3/dwc3-omap.c |    7 ++++---
 1 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/drivers/usb/dwc3/dwc3-omap.c b/drivers/usb/dwc3/dwc3-omap.c
index d296f8a..dd36bc5 100644
--- a/drivers/usb/dwc3/dwc3-omap.c
+++ b/drivers/usb/dwc3/dwc3-omap.c
@@ -202,9 +202,10 @@ int dwc3_omap_mailbox(enum omap_dwc3_vbus_id_status status)
 	u32			val;
 	struct dwc3_omap	*omap = _omap;
 
-	if (!omap)
+	if (!omap) {
+		dev_dbg(omap->dev, "not ready , deferring\n");
 		return -EPROBE_DEFER;
-
+	}
 	switch (status) {
 	case OMAP_DWC3_ID_GROUND:
 		dev_dbg(omap->dev, "ID GND\n");
@@ -296,7 +297,7 @@ static irqreturn_t dwc3_omap_interrupt(int irq, void *_omap)
 
 	dwc3_omap_write_irq0_status(omap, reg);
 
-	return IRQ_HANDLED;
+	return 0;
 }
 
 static int dwc3_omap_remove_core(struct device *dev, void *c)
-- 
1.7.5.4

