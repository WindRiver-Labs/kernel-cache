From 5753c4d43041d01a69db7ae9ee8d6cffd9fd5e78 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Thu, 14 Aug 2014 16:12:04 +0800
Subject: [PATCH 5/5] gpio: omap: remove unnecessary pair of
 pm_runtime_get/put when irq

Since it has already been done on pm_runtime_get after having
done gpio_request, so we remove this redundant ops pair on pm.
It's OK on standard kernel, but there should be some spinlock
issue on rt-kernel.

Signed-off-by: Zumeng chen <zumeng.chen@windriver.com>
---
 drivers/gpio/gpio-omap.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

diff --git a/drivers/gpio/gpio-omap.c b/drivers/gpio/gpio-omap.c
index 5405212..b74ec99 100644
--- a/drivers/gpio/gpio-omap.c
+++ b/drivers/gpio/gpio-omap.c
@@ -730,7 +730,6 @@ static void gpio_irq_handler(unsigned int irq, struct irq_desc *desc)
 
 	bank = irq_get_handler_data(irq);
 	isr_reg = bank->base + bank->regs->irqstatus;
-	pm_runtime_get_sync(bank->dev);
 
 	if (WARN_ON(!isr_reg))
 		goto exit;
@@ -786,7 +785,6 @@ static void gpio_irq_handler(unsigned int irq, struct irq_desc *desc)
 exit:
 	if (!unmasked)
 		chained_irq_exit(chip, desc);
-	pm_runtime_put(bank->dev);
 }
 
 static void gpio_irq_shutdown(struct irq_data *d)
-- 
1.7.5.4

