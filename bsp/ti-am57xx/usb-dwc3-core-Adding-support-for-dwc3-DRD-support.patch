From bd9a69dd12de64609b13afae66726dbb4f469c09 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 7 Jul 2014 14:57:02 +0800
Subject: [PATCH 200/263] usb: dwc3: core: Adding support for dwc3 DRD support

The 50b388d4 comes from the following git repo:

      git://git.ti.com/ti-linux-kernel/ti-linux-kernel.git

Adding support for dwc3 DRD support.

Change-Id: Ic7ee04a0904b173586bdb4259f74a781ab63de84
Signed-off-by: Ravi Babu <ravibabu@ti.com>
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/usb/dwc3/core.c |   10 ++--------
 1 files changed, 2 insertions(+), 8 deletions(-)

diff --git a/drivers/usb/dwc3/core.c b/drivers/usb/dwc3/core.c
index ebc4338..80ecfaa 100644
--- a/drivers/usb/dwc3/core.c
+++ b/drivers/usb/dwc3/core.c
@@ -552,15 +552,9 @@ static int dwc3_probe(struct platform_device *pdev)
 		break;
 	case USB_DR_MODE_OTG:
 		dwc3_set_mode(dwc, DWC3_GCTL_PRTCAP_OTG);
-		ret = dwc3_host_init(dwc);
-		if (ret) {
-			dev_err(dev, "failed to initialize host\n");
-			goto err2;
-		}
-
-		ret = dwc3_gadget_init(dwc);
+		ret = dwc3_otg_init(dwc);
 		if (ret) {
-			dev_err(dev, "failed to initialize gadget\n");
+			dev_err(dev, "failed to initialize otg\n");
 			goto err2;
 		}
 		break;
-- 
1.7.5.4

