From 5aa17f9d544020ea4bd363821e6a0a3571570808 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Tue, 5 Aug 2014 07:43:57 +0800
Subject: [PATCH 141/263] arm: omap2+: dra7-evm: add gcc core hwmod support

This patch comes from:

  git://git.omapzoom.org/kernel/omap.git

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-omap2/omap_hwmod_7xx_data.c |   22 ++++++++++++++++++++++
 1 files changed, 22 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-omap2/omap_hwmod_7xx_data.c b/arch/arm/mach-omap2/omap_hwmod_7xx_data.c
index cef5b70..6358ef0 100644
--- a/arch/arm/mach-omap2/omap_hwmod_7xx_data.c
+++ b/arch/arm/mach-omap2/omap_hwmod_7xx_data.c
@@ -248,8 +248,19 @@ static struct omap_hwmod dra7xx_atl_hwmod = {
  *
  */
 
+static struct omap_hwmod_class_sysconfig dra7xx_bb2d_sysc = {
+	.rev_offs	= 0x0000,
+};
+
 static struct omap_hwmod_class dra7xx_bb2d_hwmod_class = {
 	.name	= "bb2d",
+	.sysc	= &dra7xx_bb2d_sysc,
+};
+
+/* bb2d */
+static struct omap_hwmod_irq_info dra7xx_bb2d_irqs[] = {
+	{ .irq = 125 + DRA7XX_IRQ_GIC_START },
+	{ .irq = -1 }
 };
 
 /* bb2d */
@@ -257,6 +268,7 @@ static struct omap_hwmod dra7xx_bb2d_hwmod = {
 	.name		= "bb2d",
 	.class		= &dra7xx_bb2d_hwmod_class,
 	.clkdm_name	= "dss_clkdm",
+	.mpu_irqs	= dra7xx_bb2d_irqs,
 	.main_clk	= "dpll_core_h24x2_ck",
 	.prcm = {
 		.omap4 = {
@@ -2963,11 +2975,21 @@ static struct omap_hwmod_ocp_if dra7xx_l4_per2__atl = {
 	.user		= OCP_USER_MPU | OCP_USER_SDMA,
 };
 
+static struct omap_hwmod_addr_space dra7xx_bb2d_addrs[] = {
+	{
+		.pa_start	= 0x59000000,
+		.pa_end		= 0x590007ff,
+		.flags      = ADDR_TYPE_RT
+	},
+	{ }
+};
+
 /* l3_main_1 -> bb2d */
 static struct omap_hwmod_ocp_if dra7xx_l3_main_1__bb2d = {
 	.master		= &dra7xx_l3_main_1_hwmod,
 	.slave		= &dra7xx_bb2d_hwmod,
 	.clk		= "l3_iclk_div",
+	.addr		= dra7xx_bb2d_addrs,
 	.user		= OCP_USER_MPU | OCP_USER_SDMA,
 };
 
-- 
1.7.5.4

