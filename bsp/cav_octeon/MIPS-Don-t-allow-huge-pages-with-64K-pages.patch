From 5b441947458c78e89f01e96c4508ebb8827a4993 Mon Sep 17 00:00:00 2001
From: ltian <le.tian@windriver.com>
Date: Mon, 15 Nov 2010 14:37:38 +0800
Subject: [PATCH 104/132] MIPS: Don't allow huge pages with 64K pages.

Source: Cavium SDK 2.0.0-366

With CONFIG_PAGE_SIZE_64KB, huge pages end up being 512MB.  This is
larger than the sparsemem block size thus causing failure early in the
boot process, so we disallow it.

Signed-off-by: David Daney <ddaney@caviumnetworks.com>
Signed-off-by: ltian <le.tian@windriver.com>
---
 arch/mips/Kconfig |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/mips/Kconfig b/arch/mips/Kconfig
index 4333804..c0a0617 100644
--- a/arch/mips/Kconfig
+++ b/arch/mips/Kconfig
@@ -914,7 +914,7 @@ config SYS_SUPPORTS_LITTLE_ENDIAN
 
 config SYS_SUPPORTS_HUGETLBFS
 	bool
-	depends on CPU_SUPPORTS_HUGEPAGES && 64BIT
+	depends on CPU_SUPPORTS_HUGEPAGES && 64BIT && !PAGE_SIZE_64KB
 	default y
 
 config IRQ_CPU
-- 
1.6.5.2

