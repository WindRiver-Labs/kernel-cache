From 40a1e99e6d446d1a158c94df2d99e8d9fd1ea8bf Mon Sep 17 00:00:00 2001
From: Yong Zhang <yong.zhang@windriver.com>
Date: Thu, 23 Jun 2011 10:45:09 +0800
Subject: [PATCH] Cavium: call octeon_user_io_init() directly

octeon_user_io_init() has acknowledged CONFIG_CAVIUM_OCTEON_USER_MEM &&
CONFIG_CAVIUM_OCTEON_USER_MEM_PER_PROCESS by itself, remove
the ifdefs from it's caller. And some data must be set by
octeon_user_io_init() unconditionally.

Signed-off-by: Yong Zhang <yong.zhang@windriver.com>
---
 arch/mips/cavium-octeon/smp.c |    4 +---
 1 files changed, 1 insertions(+), 3 deletions(-)

diff --git a/arch/mips/cavium-octeon/smp.c b/arch/mips/cavium-octeon/smp.c
index 05575d9..63804ae 100644
--- a/arch/mips/cavium-octeon/smp.c
+++ b/arch/mips/cavium-octeon/smp.c
@@ -235,10 +235,8 @@ static void __cpuinit octeon_smp_finish(void)
 		"\tdmtc0 %0, $22\n" : "=r" (tmp));
 #endif
 
-#if defined(CONFIG_CAVIUM_OCTEON_USER_MEM) || \
-	defined(CONFIG_CAVIUM_OCTEON_USER_MEM_PER_PROCESS)
 	octeon_user_io_init();
-#endif
+
 	/* to generate the first CPU timer interrupt */
 	write_c0_compare(read_c0_count() + mips_hpt_frequency / HZ);
 }
-- 
1.7.0.4

