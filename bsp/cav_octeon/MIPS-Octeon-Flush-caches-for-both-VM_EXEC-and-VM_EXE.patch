From 1d5b4b6ee742a62351fe6f990ee1ae8646f4d2b9 Mon Sep 17 00:00:00 2001
From: ltian <le.tian@windriver.com>
Date: Mon, 15 Nov 2010 14:39:50 +0800
Subject: [PATCH 107/132] MIPS: Octeon: Flush caches for both VM_EXEC and VM_EXECUTABLE.

Source: Cavium SDK 2.0.0-366

Add checking for VM_EXECUTABLE to determine whether needs flush I-cache.

Signed-off-by: David Daney <ddaney@caviumnetworks.com>
Signed-off-by: ltian <le.tian@windriver.com>
---
 arch/mips/mm/c-octeon.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/mips/mm/c-octeon.c b/arch/mips/mm/c-octeon.c
index 16c4d25..a56a464 100644
--- a/arch/mips/mm/c-octeon.c
+++ b/arch/mips/mm/c-octeon.c
@@ -150,7 +150,7 @@ static void octeon_flush_cache_sigtramp(unsigned long addr)
 static void octeon_flush_cache_range(struct vm_area_struct *vma,
 				     unsigned long start, unsigned long end)
 {
-	if (vma->vm_flags & VM_EXEC)
+	if (vma->vm_flags & (VM_EXEC | VM_EXECUTABLE))
 		octeon_flush_icache_all_cores(vma);
 }
 
@@ -165,7 +165,7 @@ static void octeon_flush_cache_range(struct vm_area_struct *vma,
 static void octeon_flush_cache_page(struct vm_area_struct *vma,
 				    unsigned long page, unsigned long pfn)
 {
-	if (vma->vm_flags & VM_EXEC)
+	if (vma->vm_flags & (VM_EXEC | VM_EXECUTABLE))
 		octeon_flush_icache_all_cores(vma);
 }
 
-- 
1.6.5.2

