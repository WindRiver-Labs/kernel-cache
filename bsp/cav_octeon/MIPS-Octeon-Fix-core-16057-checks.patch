From 7d5085e3d73b5254404e82b3f4b5d7d19144c390 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Mon, 13 Feb 2012 15:16:19 -0800
Subject: [PATCH 3/3] MIPS: Octeon: Fix core-16057 checks.

Source: SDK.2.3.0-427

Use the proper PrId value checks.

Signed-off-by: David Daney <david.daney@cavium.com>
Integrated-by: Yong Zhang <yong.zhang@windriver.com>
---
 .../asm/mach-cavium-octeon/kernel-entry-init.h     |   10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h b/arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h
index 90abc80..b529dea 100644
--- a/arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h
+++ b/arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h
@@ -126,14 +126,14 @@ skip:
 	or	v0, v0, 0x300		# (6 << 7)
 
 	mfc0	v1, CP0_PRID_REG
-	and	t1, v1, 0xfff0
+	and	t1, v1, 0xfff8
 	xor	t1, t1, 0x9000		# 63-P1
 	beqz	t1, 4f
-	and	t1, v1, 0xfff0
-	xor	t1, t1, 0x9010		# 63-P2
+	and	t1, v1, 0xfff8
+	xor	t1, t1, 0x9008		# 63-P2
 	beqz	t1, 4f
-	and	t1, v1, 0xfff0
-	xor	t1, t1, 0x9100		# 68-P0
+	and	t1, v1, 0xfff8
+	xor	t1, t1, 0x9100		# 68-P1
 	beqz	t1, 4f
 	and	t1, v1, 0xff00
 	xor	t1, t1, 0x9200		# 66-PX
-- 
1.7.9.7

