From a3f4011def12475ebfd6ada3402345c38e5604be Mon Sep 17 00:00:00 2001
From: ltian <le.tian@windriver.com>
Date: Mon, 15 Nov 2010 14:38:31 +0800
Subject: [PATCH 105/132] MIPS: Optimize TLB handlers for Octeon CPUs

Source: Cavium SDK 2.0.0-366

Octeon can use scratch registers in the TLB handlers.  Octeon II can
use LDX instructions.

Signed-off-by: David Daney <ddaney@caviumnetworks.com>
Signed-off-by: ltian <le.tian@windriver.com>
---
 arch/mips/mm/tlbex.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/arch/mips/mm/tlbex.c b/arch/mips/mm/tlbex.c
index b4feb40..db3f409 100644
--- a/arch/mips/mm/tlbex.c
+++ b/arch/mips/mm/tlbex.c
@@ -65,9 +65,11 @@ static inline int __maybe_unused r10000_llsc_war(void)
 	return R10000_LLSC_WAR;
 }
 
-static int use_lwx_insns(void)
+static int use_bbit_insns(void)
 {
 	switch (current_cpu_type()) {
+	case CPU_CAVIUM_OCTEON:
+	case CPU_CAVIUM_OCTEON_PLUS:
 	case CPU_CAVIUM_OCTEON2:
 		return 1;
 	default:
@@ -75,11 +77,9 @@ static int use_lwx_insns(void)
 	}
 }
 
-static int use_bbit_insns(void)
+static int use_lwx_insns(void)
 {
 	switch (current_cpu_type()) {
-	case CPU_CAVIUM_OCTEON:
-	case CPU_CAVIUM_OCTEON_PLUS:
 	case CPU_CAVIUM_OCTEON2:
 		return 1;
 	default:
-- 
1.6.5.2

