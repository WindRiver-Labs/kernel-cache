From 73a27944e36814dfe07579a883b91edd2627b2f3 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Thu, 24 Feb 2011 17:34:21 +0800
Subject: [PATCH 12/30] WRHV: Cavium: Paravirtualize Cavium's specific IRQ init

In MIPS, each board has its own arch_init_irq, so paravirtualize
Cavium's. And, since IRQ init function is common for all of MIPS
GOS, so add the real arch_init_irq into another commit so that
it can be shared by other MIPS GOS BSP.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/mips/cavium-octeon/octeon-irq.c |   10 +++++++++-
 1 files changed, 9 insertions(+), 1 deletions(-)

diff --git a/arch/mips/cavium-octeon/octeon-irq.c b/arch/mips/cavium-octeon/octeon-irq.c
index 523ca5b..d8eb957 100644
--- a/arch/mips/cavium-octeon/octeon-irq.c
+++ b/arch/mips/cavium-octeon/octeon-irq.c
@@ -672,7 +672,10 @@ static struct irq_chip octeon_irq_chip_ciu1_wd = {
 static void (*octeon_ciu0_ack)(unsigned int);
 static void (*octeon_ciu1_ack)(unsigned int);
 
-void __init arch_init_irq(void)
+void paravirt_arch_init_irq(void)
+	__attribute__ ((weak, alias("native_arch_init_irq")));
+
+void __init native_arch_init_irq(void)
 {
 	unsigned int irq;
 	struct irq_chip *chip0;
@@ -739,6 +742,11 @@ void __init arch_init_irq(void)
 	set_c0_status(0x300 << 2);
 }
 
+void __init arch_init_irq(void)
+{
+	paravirt_arch_init_irq();
+}
+
 asmlinkage void plat_irq_dispatch(void)
 {
 	const unsigned long core_id = cvmx_get_core_num();
-- 
1.6.5.2

