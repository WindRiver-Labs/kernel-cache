From 235d4d99eb6267030f2699dedfc3173b7941acca Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Thu, 9 Dec 2010 14:29:17 +0800
Subject: [PATCH 19/30] WRHV: Cavium: Paravirtualize read_c0_prid

Hardcode CN63XX and CN58XX prid value for read_c0_prid.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/mips/include/asm/mipsregs.h |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/arch/mips/include/asm/mipsregs.h b/arch/mips/include/asm/mipsregs.h
index d5cb54d..203c319 100644
--- a/arch/mips/include/asm/mipsregs.h
+++ b/arch/mips/include/asm/mipsregs.h
@@ -928,7 +928,15 @@ do {									\
 #define read_c0_epc()		__read_ulong_c0_register($14, 0)
 #define write_c0_epc(val)	__write_ulong_c0_register($14, 0, val)
 
+#ifdef CONFIG_WRHV
+#ifdef CONFIG_CAVIUM_OCTEON2
+#define read_c0_prid()		(PRID_COMP_CAVIUM | PRID_IMP_CAVIUM_CN63XX)
+#else
+#define read_c0_prid()		(PRID_COMP_CAVIUM | PRID_IMP_CAVIUM_CN58XX)
+#endif
+#else
 #define read_c0_prid()		__read_32bit_c0_register($15, 0)
+#endif
 
 #define read_c0_config()	__read_32bit_c0_register($16, 0)
 #define read_c0_config1()	__read_32bit_c0_register($16, 1)
-- 
1.6.5.2

