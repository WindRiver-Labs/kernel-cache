From 600f39fa63e7fda79784563d1ffb94eb406e7126 Mon Sep 17 00:00:00 2001
From: yhe <yongli.he@windriver.com>
Date: Thu, 14 Jun 2012 16:34:04 +0800
Subject: [PATCH 07/21] p2020ds: add srio support

Add the corresponding RapidIO device node on dts.

Signed-off-by: Yongli He <yongli.he@windriver.com>
Integrated-by: Wei Yang <wei.yang@windriver.com>
---
 arch/powerpc/boot/dts/fsl/p2020si-post.dtsi |   17 +++++++++++++++++
 arch/powerpc/boot/dts/p2020ds.dts           |   11 +++++++++++
 2 files changed, 28 insertions(+)

diff --git a/arch/powerpc/boot/dts/fsl/p2020si-post.dtsi b/arch/powerpc/boot/dts/fsl/p2020si-post.dtsi
index 7d155b3..e3e9023 100644
--- a/arch/powerpc/boot/dts/fsl/p2020si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p2020si-post.dtsi
@@ -125,6 +125,22 @@
 	};
 };
 
+&rio {
+	compatible = "fsl,srio";
+	interrupts = <48 2 0 0>;
+	#address-cells = <2>;
+	#size-cells = <2>;
+	fsl,srio-rmu-handle = <&rmu>;
+	ranges;
+
+	port1 {
+		#address-cells = <2>;
+		#size-cells = <2>;
+		cell-index = <1>;
+	};
+
+};
+
 &soc {
 	#address-cells = <1>;
 	#size-cells = <1>;
@@ -201,6 +217,7 @@
 		compatible = "fsl,p2020-esdhc", "fsl,esdhc";
 	};
 
+/include/ "pq3-rmu-0.dtsi"
 /include/ "pq3-sec3.1-0.dtsi"
 /include/ "pq3-mpic.dtsi"
 /include/ "pq3-mpic-timer-B.dtsi"
diff --git a/arch/powerpc/boot/dts/p2020ds.dts b/arch/powerpc/boot/dts/p2020ds.dts
index cdb1b81..0ee16b2 100644
--- a/arch/powerpc/boot/dts/p2020ds.dts
+++ b/arch/powerpc/boot/dts/p2020ds.dts
@@ -30,6 +30,17 @@
 		reg = <0 0xffe05000 0 0x1000>;
 	};
 
+
+	rio: rapidio@ffec0000 {
+		reg = <0x0 0xffec0000 0 0x20000>;
+
+		port1 {
+			ranges = <0 0 0x0 0xa0000000 0 0x10000000>;
+		};
+
+	};
+
+
 	board_soc: soc: soc@ffe00000 {
 		ranges = <0x0 0x0 0xffe00000 0x100000>;
 		spi0: spi@7000 {
-- 
1.7.9.7

