From 2f63facbcd7db3da736e880372d8b4b3e6c0a538 Mon Sep 17 00:00:00 2001
From: Wei Yang <Wei.Yang@windriver.com>
Date: Wed, 10 Oct 2012 13:55:46 +0800
Subject: [PATCH] gianfar: Adjust the argument passed to put_page

The skb_frag_struct structure is changed in 3.4 kernel, hence the
argument passed to put_page need to be adjusted.

Signed-off-by: Wei Yang <Wei.Yang@windriver.com>
---
 drivers/net/ethernet/freescale/gianfar.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/net/ethernet/freescale/gianfar.c b/drivers/net/ethernet/freescale/gianfar.c
index d3a96bc..5a0b98b 100644
--- a/drivers/net/ethernet/freescale/gianfar.c
+++ b/drivers/net/ethernet/freescale/gianfar.c
@@ -3478,7 +3478,7 @@ static void gfar_free_skb(struct sk_buff *skb)
 		if (skb_shinfo(skb)->nr_frags) {
 			int i;
 			for (i = 0; i < skb_shinfo(skb)->nr_frags; i++)
-				put_page(&skb_shinfo(skb)->frags[i].page);
+				put_page(skb_shinfo(skb)->frags[i].page.p);
 			skb_shinfo(skb)->nr_frags = 0;
 			skb->data_len = 0;
 		}
-- 
1.7.0.2

