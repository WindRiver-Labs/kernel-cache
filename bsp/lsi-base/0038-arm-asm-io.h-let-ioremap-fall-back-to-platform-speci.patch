From b02a70c3c5dde37cab278e09b4245749e913ca97 Mon Sep 17 00:00:00 2001
From: Paul Butler <paul.butler@windriver.com>
Date: Thu, 25 Apr 2013 16:13:08 +0800
Subject: [PATCH 38/76] arm/asm/io.h: let ioremap() fall back to platform specific one

Signed-off-by: Paul Butler <paul.butler@windriver.com>
---
 arch/arm/include/asm/io.h |   20 +++++++++++++++-----
 1 files changed, 15 insertions(+), 5 deletions(-)

diff --git a/arch/arm/include/asm/io.h b/arch/arm/include/asm/io.h
index 9af5563..1b37696 100644
--- a/arch/arm/include/asm/io.h
+++ b/arch/arm/include/asm/io.h
@@ -264,11 +264,21 @@ extern void _memset_io(volatile void __iomem *, int, size_t);
  * Documentation/io-mapping.txt.
  *
  */
-#define ioremap(cookie,size)		__arm_ioremap((cookie), (size), MT_DEVICE)
-#define ioremap_nocache(cookie,size)	__arm_ioremap((cookie), (size), MT_DEVICE)
-#define ioremap_cached(cookie,size)	__arm_ioremap((cookie), (size), MT_DEVICE_CACHED)
-#define ioremap_wc(cookie,size)		__arm_ioremap((cookie), (size), MT_DEVICE_WC)
-#define iounmap				__arm_iounmap
+
+#ifndef __arch_ioremap
+#define __arch_ioremap			__arm_ioremap
+#define __arch_iounmap			__iounmap
+#endif
+
+#define ioremap(cookie, size) \
+	__arch_ioremap((cookie), (size), MT_DEVICE)
+#define ioremap_nocache(cookie, size) \
+	__arch_ioremap((cookie), (size), MT_DEVICE)
+#define ioremap_cached(cookie, size) \
+	__arch_ioremap((cookie), (size), MT_DEVICE_CACHED)
+#define ioremap_wc(cookie, size) \
+	__arch_ioremap((cookie), (size), MT_DEVICE_WC)
+#define iounmap				__arch_iounmap
 
 /*
  * io{read,write}{8,16,32} macros
-- 
1.7.0.5

