From c6b75989751001224d928c91b4eec3f2aa0a8a97 Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Thu, 10 Apr 2014 14:37:02 +0200
Subject: [PATCH 353/793] zynq: ocm: Fix IRQ handler return value

Return IRQ_HANDLED only when interrupt is handled.

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
---
 arch/arm/mach-zynq/zynq_ocm.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/arch/arm/mach-zynq/zynq_ocm.c b/arch/arm/mach-zynq/zynq_ocm.c
index c3ea4b0..bcd1502 100644
--- a/arch/arm/mach-zynq/zynq_ocm.c
+++ b/arch/arm/mach-zynq/zynq_ocm.c
@@ -51,7 +51,7 @@ struct zynq_ocm_dev {
  * @irq:	IRQ number
  * @data:	Pointer to the zynq_ocm_dev structure
  *
- * Return:	IRQ_HANDLED always
+ * Return:	IRQ_HANDLED when handled; IRQ_NONE otherwise.
  */
 static irqreturn_t zynq_ocm_irq_handler(int irq, void *data)
 {
@@ -66,11 +66,12 @@ static irqreturn_t zynq_ocm_irq_handler(int irq, void *data)
 		err_addr = readl(zynq_ocm->base + ZYNQ_OCM_PARITY_ERRADDRESS);
 		pr_err("%s: OCM err intr generated at 0x%04x (stat: 0x%08x).",
 		       __func__, err_addr, sts & ZYNQ_OCM_IRQ_STS_ERR_MASK);
+		return IRQ_HANDLED;
 	}
 	pr_warn("%s: Interrupt generated by OCM, but no error is found.",
 		__func__);
 
-	return IRQ_HANDLED;
+	return IRQ_NONE;
 }
 
 /**
-- 
1.7.5.4

