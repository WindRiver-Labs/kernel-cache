From 22ba7fef0c11a9b992444079415f1cbebb52a172 Mon Sep 17 00:00:00 2001
From: Zhong Hongbo <hongbo.zhong@windriver.com>
Date: Thu, 17 Jul 2014 02:56:35 +0000
Subject: [PATCH 039/509] arm: zynq: Don't use arm_global_timer with cpufreq

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit a65ae500dc231342bee07e520e34b4f85a66316d

The timer frequency of the arm_global_timer depends on the CPU
frequency. With cpufreq altering that frequency the arm_global_timer
does not maintain a stable time base. Therefore don't enable that timer
in case cpufreq is enabled.

Cc: Russell King <linux@arm.linux.org.uk>
Signed-off-by: Soren Brinkmann <soren.brinkmann@xilinx.com>
Signed-off-by: Daniel Lezcano <daniel.lezcano@linaro.org>
Acked-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit 61f1fc7e9258a169ac8afb5ddf657a181e60d052)
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-zynq/Kconfig |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-zynq/Kconfig b/arch/arm/mach-zynq/Kconfig
index 2f696d4..75b123a 100644
--- a/arch/arm/mach-zynq/Kconfig
+++ b/arch/arm/mach-zynq/Kconfig
@@ -5,6 +5,7 @@ config ARCH_ZYNQ
 	select ARCH_REQUIRE_GPIOLIB
 	select ARM_AMBA
 	select ARM_GIC
+	select ARM_GLOBAL_TIMER if !CPU_FREQ
 	select CACHE_L2X0
 	select CADENCE_TTC_TIMER
 	select GENERIC_ALLOCATOR
-- 
1.7.5.4

