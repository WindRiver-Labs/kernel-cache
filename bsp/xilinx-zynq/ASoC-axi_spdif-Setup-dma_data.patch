From b51c57bb3565dfb15c90612d80f21ec77c00e2fe Mon Sep 17 00:00:00 2001
From: Lars-Peter Clausen <lars@metafoo.de>
Date: Fri, 10 May 2013 13:47:23 +0200
Subject: [PATCH 266/509] ASoC: axi_spdif: Setup dma_data

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 8fd97d0734cd4cfbf95eb72869d2c5951abd4cdf

Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 sound/soc/xlnx/axi-spdif.c |    9 +++++++--
 1 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/sound/soc/xlnx/axi-spdif.c b/sound/soc/xlnx/axi-spdif.c
index 8213e54..167e7b7 100644
--- a/sound/soc/xlnx/axi-spdif.c
+++ b/sound/soc/xlnx/axi-spdif.c
@@ -40,8 +40,9 @@ struct axi_spdif {
 	struct snd_dmaengine_dai_dma_data dma_data;
 };
 
-#define AXI_SPDIF_REG_CTRL 0x0
-#define AXI_SPDIF_REG_STAT 0x4
+#define AXI_SPDIF_REG_CTRL	0x0
+#define AXI_SPDIF_REG_STAT	0x4
+#define AXI_SPDIF_REG_TX_FIFO	0xc
 
 #define AXI_SPDIF_CTRL_TXDATA BIT(1)
 #define AXI_SPDIF_CTRL_TXEN BIT(0)
@@ -202,6 +203,10 @@ static int axi_spdif_probe(struct platform_device *pdev)
 	if (!spdif->base)
 		return -EBUSY;
 
+	spdif->dma_data.addr = res->start + AXI_SPDIF_REG_TX_FIFO;
+	spdif->dma_data.addr_width = 4;
+	spdif->dma_data.maxburst = 1;
+
 	platform_set_drvdata(pdev, spdif);
 
 	of_property_read_u32(pdev->dev.of_node, "clock-frequency", &spdif->clock);
-- 
1.7.5.4

