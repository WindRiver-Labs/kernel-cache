From 475a2857ef758b79b207a89568bafb36193370cf Mon Sep 17 00:00:00 2001
From: Liming Wang <liming.wang@windriver.com>
Date: Fri, 5 Jul 2013 15:29:28 +0800
Subject: [PATCH 3/3] arm/zynq: Add device tree file to support PCIe for zc706 board

Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 arch/arm/boot/dts/zynq-zc706-pcie-snippet.dtsi |   73 ++++++++++++++++++++++++
 arch/arm/boot/dts/zynq-zc706-sd-pcie.dts       |   18 ++++++
 2 files changed, 91 insertions(+), 0 deletions(-)
 create mode 100644 arch/arm/boot/dts/zynq-zc706-pcie-snippet.dtsi
 create mode 100644 arch/arm/boot/dts/zynq-zc706-sd-pcie.dts

diff --git a/arch/arm/boot/dts/zynq-zc706-pcie-snippet.dtsi b/arch/arm/boot/dts/zynq-zc706-pcie-snippet.dtsi
new file mode 100644
index 0000000..96f5be6
--- /dev/null
+++ b/arch/arm/boot/dts/zynq-zc706-pcie-snippet.dtsi
@@ -0,0 +1,73 @@
+
+axi_pcie_0: axi-pcie@50000000 {
+	#address-cells = <3>;
+	#size-cells = <2>;
+	compatible = "xlnx,axi-pcie-1.05.a";
+	interrupts = < 0 59 4 >;
+	ranges = < 0x02000000 0x00000000 0x60000000 0x60000000 0x00000000 0x10000000 >;
+	reg = < 0x50000000 0x1000000 >;
+	xlnx,axi-aclk-freq-hz = <0x7735940>;
+	xlnx,axibar-0 = <0x60000000>;
+	xlnx,axibar-1 = <0xffffffff>;
+	xlnx,axibar-2 = <0xffffffff>;
+	xlnx,axibar-3 = <0xffffffff>;
+	xlnx,axibar-4 = <0xffffffff>;
+	xlnx,axibar-5 = <0xffffffff>;
+	xlnx,axibar-as-0 = <0x0>;
+	xlnx,axibar-as-1 = <0x0>;
+	xlnx,axibar-as-2 = <0x0>;
+	xlnx,axibar-as-3 = <0x0>;
+	xlnx,axibar-as-4 = <0x0>;
+	xlnx,axibar-as-5 = <0x0>;
+	xlnx,axibar-highaddr-0 = <0x6fffffff>;
+	xlnx,axibar-highaddr-1 = <0x0>;
+	xlnx,axibar-highaddr-2 = <0x0>;
+	xlnx,axibar-highaddr-3 = <0x0>;
+	xlnx,axibar-highaddr-4 = <0x0>;
+	xlnx,axibar-highaddr-5 = <0x0>;
+	xlnx,axibar-num = <0x1>;
+	xlnx,axibar2pciebar-0 = <0x60000000>;
+	xlnx,axibar2pciebar-1 = <0x0>;
+	xlnx,axibar2pciebar-2 = <0x0>;
+	xlnx,axibar2pciebar-3 = <0x0>;
+	xlnx,axibar2pciebar-4 = <0x0>;
+	xlnx,axibar2pciebar-5 = <0x0>;
+	xlnx,class-code = <0x60400>;
+	xlnx,comp-timeout = <0x1>;
+	xlnx,device-id = <0x706>;
+	xlnx,ep-link-partner-rcb = <0x0>;
+	xlnx,family = "zynq";
+	xlnx,include-baroffset-reg = <0x1>;
+	xlnx,include-rc = <0x1>;
+	xlnx,instance = "axi_pcie_0";
+	xlnx,interrupt-pin = <0x0>;
+	xlnx,max-link-speed = <0x0>;
+	xlnx,no-of-lanes = <0x4>;
+	xlnx,num-msi-req = <0x0>;
+	xlnx,pcie-cap-slot-implemented = <0x1>;
+	xlnx,pcie-use-mode = "3.0";
+	xlnx,pciebar-as = <0x0>;
+	xlnx,pciebar-len-0 = <0x1e>;
+	xlnx,pciebar-len-1 = <0xd>;
+	xlnx,pciebar-len-2 = <0xd>;
+	xlnx,pciebar-num = <0x1>;
+	xlnx,pciebar2axibar-0 = <0x0>;
+	xlnx,pciebar2axibar-0-sec = <0x1>;
+	xlnx,pciebar2axibar-1 = <0xffffffff>;
+	xlnx,pciebar2axibar-1-sec = <0x1>;
+	xlnx,pciebar2axibar-2 = <0xffffffff>;
+	xlnx,pciebar2axibar-2-sec = <0x1>;
+	xlnx,ref-clk-freq = <0x0>;
+	xlnx,ref-clk-freq-hz = <0x5f5e100>;
+	xlnx,rev-id = <0x0>;
+	xlnx,s-axi-ctl-aclk-freq-hz = <0x7735940>;
+	xlnx,s-axi-ctl-protocol = "AXI4LITE";
+	xlnx,s-axi-id-width = <0x1>;
+	xlnx,s-axi-support-threads = <0x1>;
+	xlnx,s-axi-supports-narrow-burst = <0x1>;
+	xlnx,s-axi-supports-read = <0x1>;
+	xlnx,s-axi-supports-write = <0x1>;
+	xlnx,subsystem-id = <0x6100>;
+	xlnx,subsystem-vendor-id = <0x0>;
+	xlnx,vendor-id = <0x10ee>;
+};
diff --git a/arch/arm/boot/dts/zynq-zc706-sd-pcie.dts b/arch/arm/boot/dts/zynq-zc706-sd-pcie.dts
new file mode 100644
index 0000000..d8e86f0
--- /dev/null
+++ b/arch/arm/boot/dts/zynq-zc706-sd-pcie.dts
@@ -0,0 +1,18 @@
+/dts-v1/;
+
+/ {
+	model = "Xilinx ZC706";
+	compatible = "xlnx,zynq-zc706";
+	#address-cells = <0x1>;
+	#size-cells = <0x1>;
+	interrupt-parent = <&intc>;
+
+	/*root on SD second partition*/
+	chosen {
+		bootargs = "console=ttyPS0,115200 earlyprintk root=/dev/mmcblk0p2 ro rootwait";
+		linux,stdout-path = "/amba@0/uart@e0001000";
+	};
+
+/include/ "zc702.dtsi"
+/include/ "zynq-zc706-pcie-snippet.dtsi"
+};
-- 
1.7.0

