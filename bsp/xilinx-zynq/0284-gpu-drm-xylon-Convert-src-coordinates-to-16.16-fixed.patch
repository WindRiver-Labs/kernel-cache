From 15b75b3e09e6b402364b111ac3ceff5295c96fc0 Mon Sep 17 00:00:00 2001
From: Radhey Shyam Pandey <radhey.shyam.pandey@xilinx.com>
Date: Tue, 19 May 2015 17:16:32 +0530
Subject: [PATCH 284/290] gpu: drm: xylon: Convert src coordinates to 16.16
 fixed point

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

Convert src coordinates to 16.16 fixed point format.
It fixes the issue where src coordindates are passed as 0
when update_plane is called from crtc helper function.

Signed-off-by: Radhey Shyam Pandey <radheys@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Tested-by: Christian Kohn <christian.kohn@xilinx.com>
(cherry picked from commit e19a2c3862663565f78024c98eb3f3a45ed7acce)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/gpu/drm/xylon/xylon_crtc.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/gpu/drm/xylon/xylon_crtc.c b/drivers/gpu/drm/xylon/xylon_crtc.c
index deb3277..ecb0b0c 100644
--- a/drivers/gpu/drm/xylon/xylon_crtc.c
+++ b/drivers/gpu/drm/xylon/xylon_crtc.c
@@ -172,9 +172,9 @@ static int xylon_drm_crtc_mode_set_base(struct drm_crtc *base_crtc,
 				  0, 0,
 				  base_crtc->hwmode.hdisplay,
 				  base_crtc->hwmode.vdisplay,
-				  x, y,
-				  base_crtc->hwmode.hdisplay,
-				  base_crtc->hwmode.vdisplay);
+				  x << 16, y << 16,
+				  base_crtc->hwmode.hdisplay << 16,
+				  base_crtc->hwmode.vdisplay << 16);
 	if (ret) {
 		DRM_ERROR("failed set plane mode\n");
 		return ret;
-- 
2.0.2

