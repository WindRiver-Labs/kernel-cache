From 3df1c6fc9139d089dd7870cb715eddcdf71eacdc Mon Sep 17 00:00:00 2001
From: Nicolae Rosia <nicolae.rosia@certsign.ro>
Date: Mon, 5 Jan 2015 18:02:35 +0200
Subject: [PATCH 009/456] ARM: zynq: xilinx_axidma: get rid of useless and
 confusing variables

update_cookie and to_transfer are being initialized with the same value
and assigned with a different value under the same condition.
Get rid of them and move their action when testing the condition

Signed-off-by: Nicolae Rosia <nicolae.rosia@certsign.ro>
Acked-by: Kedareswara rao Appana <appanad@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit b9ed63f516c3f83c4c8813c20dfcf80e499843b5)
---
 drivers/dma/xilinx/xilinx_axidma.c |   10 +---------
 1 files changed, 1 insertions(+), 9 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axidma.c b/drivers/dma/xilinx/xilinx_axidma.c
index c67cee0..237f530 100644
--- a/drivers/dma/xilinx/xilinx_axidma.c
+++ b/drivers/dma/xilinx/xilinx_axidma.c
@@ -520,8 +520,6 @@ static int dma_reset(struct xilinx_dma_chan *chan)
 static irqreturn_t dma_intr_handler(int irq, void *data)
 {
 	struct xilinx_dma_chan *chan = data;
-	int update_cookie = 0;
-	int to_transfer = 0;
 	u32 stat, reg;
 
 	reg = dma_read(chan, XILINX_DMA_CONTROL_OFFSET);
@@ -559,15 +557,9 @@ static irqreturn_t dma_intr_handler(int irq, void *data)
 		dev_dbg(chan->dev, "Inter-packet latency too long\n");
 
 	if (stat & XILINX_DMA_XR_IRQ_IOC_MASK) {
-		update_cookie = 1;
-		to_transfer = 1;
-	}
-
-	if (update_cookie)
 		xilinx_dma_update_completed_cookie(chan);
-
-	if (to_transfer)
 		chan->start_transfer(chan);
+	}
 
 	tasklet_schedule(&chan->tasklet);
 	return IRQ_HANDLED;
-- 
1.7.5.4

