From 6fc2ebd7015bb517a73bd18087790957b6155a22 Mon Sep 17 00:00:00 2001
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date: Fri, 12 Sep 2014 23:15:41 +0300
Subject: [PATCH 293/456] v4l: xilinx: tpg: Rename compatible string to
 xlnx,v-tpg

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

This matches the compatible string values used by the DT generator.

Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
(cherry picked from commit 0ff7ce3db0767018d5cf57c46286978c74fc578e)

Conflicts:
	drivers/media/platform/xilinx/xilinx-tpg.c
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 .../bindings/media/xilinx/xlnx,axi-tpg.txt         |   62 ------------------
 .../bindings/media/xilinx/xlnx,v-tpg.txt           |   68 ++++++++++++++++++++
 drivers/media/platform/xilinx/xilinx-tpg.c         |    4 +-
 3 files changed, 70 insertions(+), 64 deletions(-)
 delete mode 100644 Documentation/devicetree/bindings/media/xilinx/xlnx,axi-tpg.txt
 create mode 100644 Documentation/devicetree/bindings/media/xilinx/xlnx,v-tpg.txt

diff --git a/Documentation/devicetree/bindings/media/xilinx/xlnx,axi-tpg.txt b/Documentation/devicetree/bindings/media/xilinx/xlnx,axi-tpg.txt
deleted file mode 100644
index 75b8825..0000000
--- a/Documentation/devicetree/bindings/media/xilinx/xlnx,axi-tpg.txt
+++ /dev/null
@@ -1,62 +0,0 @@
-Xilinx Video Test Pattern Generator (TPG)
------------------------------------------
-
-Required properties:
-
-- compatible: Must be "xlnx,axi-tpg-5.0".
-
-- reg: Physical base address and length of the registers set for the device.
-
-- xlnx,axi-video-format, xlnx,axi-video-width: Video format and width, as
-  defined in video.txt.
-
-- port: Video port, using the DT bindings defined in ../video-interfaces.txt.
-  The TPG has a single output port numbered 0.
-
-Optional properties:
-
-- xlnx,vtc: A phandle referencing the Video Timing Controller that generates
-  video timings for the TPG test patterns.
-
-- timing-gpios: Specifier for a GPIO that controls the timing mux at the TPG
-  input. The GPIO active level corresponds to the selection of VTC-generated
-  video timings.
-
-The xlnx,vtc and timing-gpios properties are mandatory when the TPG is
-synthesized with two ports and forbidden when synthesized with one port.
-
-Example:
-
-	axi_tpg_0: axi_tpg@40050000 {
-		compatible = "xlnx,axi-tpg-5.0";
-		reg = <0x40050000 0x10000>;
-
-		xlnx,vtc = <&vtc_3>;
-		timing-gpios = <&ps7_gpio_0 55 GPIO_ACTIVE_LOW>;
-
-		ports {
-			#address-cells = <1>;
-			#size-cells = <0>;
-
-			port@0 {
-				reg = <0>;
-
-				xlnx,axi-video-format = "yuv422";
-				xlnx,axi-video-width = <8>;
-
-				tpg_in: endpoint {
-					remote-endpoint = <&adv7611_out>;
-				};
-			};
-			port@1 {
-				reg = <1>;
-
-				xlnx,axi-video-format = "yuv422";
-				xlnx,axi-video-width = <8>;
-
-				tpg1_out: endpoint {
-					remote-endpoint = <&switch_in0>;
-				};
-			}:
-		};
-	};
diff --git a/Documentation/devicetree/bindings/media/xilinx/xlnx,v-tpg.txt b/Documentation/devicetree/bindings/media/xilinx/xlnx,v-tpg.txt
new file mode 100644
index 0000000..4c567a1
--- /dev/null
+++ b/Documentation/devicetree/bindings/media/xilinx/xlnx,v-tpg.txt
@@ -0,0 +1,68 @@
+Xilinx Video Test Pattern Generator (TPG)
+-----------------------------------------
+
+Required properties:
+
+- compatible: Must contain at least one of
+
+    "xlnx,v-tpg-5.0" (TPG version 5.0)
+    "xlnx,v-tpg-6.0" (TPG version 6.0)
+
+  TPG versions backward-compatible with previous versions should list all
+  compatible versions in the newer to older order.
+
+- reg: Physical base address and length of the registers set for the device.
+
+- xlnx,axi-video-format, xlnx,axi-video-width: Video format and width, as
+  defined in video.txt.
+
+- port: Video port, using the DT bindings defined in ../video-interfaces.txt.
+  The TPG has a single output port numbered 0.
+
+Optional properties:
+
+- xlnx,vtc: A phandle referencing the Video Timing Controller that generates
+  video timings for the TPG test patterns.
+
+- timing-gpios: Specifier for a GPIO that controls the timing mux at the TPG
+  input. The GPIO active level corresponds to the selection of VTC-generated
+  video timings.
+
+The xlnx,vtc and timing-gpios properties are mandatory when the TPG is
+synthesized with two ports and forbidden when synthesized with one port.
+
+Example:
+
+	axi_tpg_0: axi_tpg@40050000 {
+		compatible = "xlnx,v-tpg-6.0", "xlnx,v-tpg-5.0";
+		reg = <0x40050000 0x10000>;
+
+		xlnx,vtc = <&vtc_3>;
+		timing-gpios = <&ps7_gpio_0 55 GPIO_ACTIVE_LOW>;
+
+		ports {
+			#address-cells = <1>;
+			#size-cells = <0>;
+
+			port@0 {
+				reg = <0>;
+
+				xlnx,axi-video-format = "yuv422";
+				xlnx,axi-video-width = <8>;
+
+				tpg_in: endpoint {
+					remote-endpoint = <&adv7611_out>;
+				};
+			};
+			port@1 {
+				reg = <1>;
+
+				xlnx,axi-video-format = "yuv422";
+				xlnx,axi-video-width = <8>;
+
+				tpg1_out: endpoint {
+					remote-endpoint = <&switch_in0>;
+				};
+			}:
+		};
+	};
diff --git a/drivers/media/platform/xilinx/xilinx-tpg.c b/drivers/media/platform/xilinx/xilinx-tpg.c
index 1050e7c..460645e 100644
--- a/drivers/media/platform/xilinx/xilinx-tpg.c
+++ b/drivers/media/platform/xilinx/xilinx-tpg.c
@@ -890,7 +890,7 @@ static int xtpg_remove(struct platform_device *pdev)
 static SIMPLE_DEV_PM_OPS(xtpg_pm_ops, xtpg_pm_suspend, xtpg_pm_resume);
 
 static const struct of_device_id xtpg_of_id_table[] = {
-	{ .compatible = "xlnx,axi-tpg-5.0" },
+	{ .compatible = "xlnx,v-tpg-5.0" },
 	{ }
 };
 MODULE_DEVICE_TABLE(of, xtpg_of_id_table);
@@ -898,7 +898,7 @@ MODULE_DEVICE_TABLE(of, xtpg_of_id_table);
 static struct platform_driver xtpg_driver = {
 	.driver = {
 		.owner		= THIS_MODULE,
-		.name		= "xilinx-axi-tpg",
+		.name		= "xilinx-tpg",
 		.pm		= &xtpg_pm_ops,
 		.of_match_table	= xtpg_of_id_table,
 	},
-- 
1.7.5.4

