From 007a1818f3172ffa063780d55f548db9762d0404 Mon Sep 17 00:00:00 2001
From: Srikanth Thokala <srikanth.thokala@xilinx.com>
Date: Mon, 25 Nov 2013 19:50:43 +0530
Subject: [PATCH 322/509] axivdma: xilinx: Remove irq_dispose_mapping() as it
 is not required

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 96e27ce0655c44628b4f372ca6e8b7a3a12278de

This patch removes the call irq_dispose_mapping() as in the code
we are not mapping the interrupt using create_mapping().  This
patch fixes the kernel crash when unloading this driver module.

Signed-off-by: Srikanth Thokala <sthokal@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/dma/xilinx/xilinx_axivdma.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axivdma.c b/drivers/dma/xilinx/xilinx_axivdma.c
index 7ce4948..e3c8a90 100644
--- a/drivers/dma/xilinx/xilinx_axivdma.c
+++ b/drivers/dma/xilinx/xilinx_axivdma.c
@@ -1001,7 +1001,6 @@ static void xilinx_vdma_chan_remove(struct xilinx_vdma_chan *chan)
 	vdma_ctrl_clr(chan, XILINX_VDMA_REG_DMACR,
 		      XILINX_VDMA_DMAXR_ALL_IRQ_MASK);
 
-	irq_dispose_mapping(chan->irq);
 	list_del(&chan->common.device_node);
 }
 
@@ -1120,7 +1119,6 @@ static int xilinx_vdma_chan_probe(struct xilinx_vdma_device *xdev,
 	return 0;
 
 error:
-	irq_dispose_mapping(chan->irq);
 	return err;
 }
 
-- 
1.7.5.4

