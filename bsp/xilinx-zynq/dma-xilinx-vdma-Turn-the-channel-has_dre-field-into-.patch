From 309b6f24040f57a83eec1c68dd29e5dd093c0ec5 Mon Sep 17 00:00:00 2001
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date: Wed, 22 May 2013 22:59:51 +0200
Subject: [PATCH 298/509] dma: xilinx: vdma: Turn the channel has_dre field
 into a local variable

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 1bc055f5ac55f23b569fef7e38eb3d3cb8a6ad74

The field value is assigned and used locally only, replace it with a
local variable.

Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Acked-by: Srikanth Thokala <sthokal@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/dma/xilinx/xilinx_axivdma.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axivdma.c b/drivers/dma/xilinx/xilinx_axivdma.c
index 0efed82..04b74df 100644
--- a/drivers/dma/xilinx/xilinx_axivdma.c
+++ b/drivers/dma/xilinx/xilinx_axivdma.c
@@ -166,7 +166,6 @@ struct xilinx_vdma_chan {
 	enum dma_transfer_direction direction;	/* Transfer direction */
 	int num_frms;				/* Number of frames */
 	bool has_sg;				/* Support scatter transfers */
-	bool has_dre;				/* For unaligned transfers */
 	bool genlock;				/* Support genlock mode */
 	int err;				/* Channel has errors */
 	struct tasklet_struct tasklet;		/* Cleanup work after irq */
@@ -1039,6 +1038,7 @@ static int xilinx_vdma_chan_probe(struct xilinx_vdma_device *xdev,
 				  struct device_node *node)
 {
 	struct xilinx_vdma_chan *chan;
+	bool has_dre = false;
 	u32 device_id;
 	u32 value;
 	int err;
@@ -1053,7 +1053,7 @@ static int xilinx_vdma_chan_probe(struct xilinx_vdma_device *xdev,
 	chan->xdev = xdev;
 
 	if (of_property_read_bool(node, "xlnx,include-dre"))
-		chan->has_dre = true;
+		has_dre = true;
 
 	if (of_property_read_bool(node, "xlnx,genlock-mode"))
 		chan->genlock = true;
@@ -1064,9 +1064,9 @@ static int xilinx_vdma_chan_probe(struct xilinx_vdma_device *xdev,
 
 		/* If data width is greater than 8 bytes, DRE is not in hw */
 		if (width > 8)
-			chan->has_dre = false;
+			has_dre = false;
 
-		if (!chan->has_dre)
+		if (!has_dre)
 			xdev->common.copy_align = fls(width - 1);
 	}
 
-- 
1.7.5.4

