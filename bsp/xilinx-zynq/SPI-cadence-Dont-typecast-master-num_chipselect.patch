From c4ff8cd7046087de9fd728ab886911078c7f0557 Mon Sep 17 00:00:00 2001
From: Harini Katakam <harini.katakam@xilinx.com>
Date: Mon, 17 Mar 2014 13:16:52 +0530
Subject: [PATCH 094/509] SPI: cadence: Dont typecast master->num_chipselect

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 22f8b8275c1beb9b398f27dd022020ca744da77b

Use a local integer variable to get property and then write the same
in master->num_chipselect.

There is an option to use of_property_read_u16 but for
that different device-tree description has to be used
num-chip-select = /bits/ 16 <4>;
This change will be discussed in mainling process.

Signed-off-by: Harini Katakam <harinik@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/spi/spi-cadence.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/drivers/spi/spi-cadence.c b/drivers/spi/spi-cadence.c
index 89c4e0d..6c49f62 100644
--- a/drivers/spi/spi-cadence.c
+++ b/drivers/spi/spi-cadence.c
@@ -572,6 +572,7 @@ static int cdns_unprepare_transfer_hardware(struct spi_master *master)
 static int cdns_spi_probe(struct platform_device *pdev)
 {
 	int ret = 0, irq;
+	u32 num_cs;
 	struct spi_master *master;
 	struct cdns_spi *xspi;
 	struct resource *res;
@@ -639,7 +640,8 @@ static int cdns_spi_probe(struct platform_device *pdev)
 	init_completion(&xspi->done);
 
 	ret = of_property_read_u32(pdev->dev.of_node, "num-chip-select",
-				   (u32 *)&master->num_chipselect);
+				   &num_cs);
+	master->num_chipselect = num_cs;
 	if (ret < 0) {
 		dev_err(&pdev->dev, "couldn't determine num-chip-select\n");
 		goto clk_dis_all;
-- 
1.7.5.4

