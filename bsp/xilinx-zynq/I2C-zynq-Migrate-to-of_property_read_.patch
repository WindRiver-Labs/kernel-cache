From e32c934bb651623589906d593593b5455bcf8ea0 Mon Sep 17 00:00:00 2001
From: Soren Brinkmann <soren.brinkmann@xilinx.com>
Date: Mon, 20 Jan 2014 10:40:04 -0800
Subject: [PATCH 169/509] I2C: zynq: Migrate to of_property_read_*

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 998712e1878d22660f8c5a2dd6af4b7f88d5e90c

Convert the last call to of_get_property() to of_property_read_*().
Which also allows to get rid of the now unused 'prop' variable and makes
initialization of 'ret' unnecessary.

Signed-off-by: Soren Brinkmann <soren.brinkmann@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/i2c/busses/i2c-zynq.c |   10 ++++------
 1 files changed, 4 insertions(+), 6 deletions(-)

diff --git a/drivers/i2c/busses/i2c-zynq.c b/drivers/i2c/busses/i2c-zynq.c
index 69e1cad..1d6551f 100644
--- a/drivers/i2c/busses/i2c-zynq.c
+++ b/drivers/i2c/busses/i2c-zynq.c
@@ -813,8 +813,7 @@ static int zynq_i2c_probe(struct platform_device *pdev)
 {
 	struct resource *r_mem = NULL;
 	struct zynq_i2c *id;
-	int ret = 0;
-	const unsigned int *prop;
+	int ret;
 	/*
 	 * Allocate memory for zynq_i2c structure.
 	 * Initialize the structure to zero and set the platform data.
@@ -835,10 +834,9 @@ static int zynq_i2c_probe(struct platform_device *pdev)
 
 	id->irq = platform_get_irq(pdev, 0);
 
-	prop = of_get_property(pdev->dev.of_node, "bus-id", NULL);
-	if (prop) {
-		id->adap.nr = be32_to_cpup(prop);
-	} else {
+	ret = of_property_read_u32(pdev->dev.of_node, "bus-id",
+			(u32 *)&id->adap.nr);
+	if (ret) {
 		dev_err(&pdev->dev, "couldn't determine bus-id\n");
 		return -ENXIO;
 	}
-- 
1.7.5.4

