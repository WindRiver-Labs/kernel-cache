From 5df8564bc4d30a4e6f54888950aeccb36b104a36 Mon Sep 17 00:00:00 2001
From: Zhong Hongbo <hongbo.zhong@windriver.com>
Date: Fri, 22 Aug 2014 07:08:34 +0000
Subject: [PATCH 501/509] xilinx_dma: Fix the compile warning

drivers/dma/xilinx_dma.c:
In function 'xilinx_dma_chan_probe':
drivers/dma/xilinx_dma.c:1408:23:
warning: assignment makes pointer from integer without a cast [enabled
by default]
  chan->common.private = (chan->direction & 0xFF) |
                       ^
drivers/dma/xilinx_dma.c:
In function 'xilinx_dma_of_probe':
drivers/dma/xilinx_dma.c:1495:39:
warning: assignment from incompatible pointer type [enabled by default]
   xdev->common.device_prep_dma_cyclic = xilinx_dma_prep_dma_cyclic;

Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/dma/xilinx_dma.c |    9 ++++++---
 1 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/drivers/dma/xilinx_dma.c b/drivers/dma/xilinx_dma.c
index 4504f50..8579419 100644
--- a/drivers/dma/xilinx_dma.c
+++ b/drivers/dma/xilinx_dma.c
@@ -225,6 +225,7 @@ struct xilinx_dma_chan {
 	int    err;                       /* Channel has errors */
 	struct tasklet_struct tasklet;    /* Cleanup work after irq */
 	u32    feature;                   /* IP feature */
+	u32    private;
 	void   (*start_transfer)(struct xilinx_dma_chan *chan);
 	struct xilinx_dma_config config;  /* Device configuration info */
 
@@ -878,7 +879,8 @@ err:
  */
 static struct dma_async_tx_descriptor *xilinx_dma_prep_dma_cyclic(
 	struct dma_chan *dchan, dma_addr_t buf_addr, size_t buf_len,
-	size_t period_len, enum dma_transfer_direction direction, void *context)
+	size_t period_len, enum dma_transfer_direction direction,
+        unsigned long flags, void *context)
 {
 	struct xilinx_dma_desc_hw *hw;
 	struct xilinx_dma_transfer *t;
@@ -1405,8 +1407,9 @@ static int xilinx_dma_chan_probe(struct xilinx_dma_device *xdev,
 	/* Used by dmatest channel matching in slave transfers
 	 * Can change it to be a structure to have more matching information
 	 */
-	chan->common.private = (chan->direction & 0xFF) |
-		(chan->feature & XILINX_DMA_IP_MASK);
+	chan->private = (chan->direction & 0xff) | 
+			(chan->feature & XILINX_DMA_IP_MASK);
+	chan->common.private = (void *)&(chan->private);
 
 	if (!chan->has_DRE)
 		xdev->common.copy_align = ilog2(width);
-- 
1.7.5.4

