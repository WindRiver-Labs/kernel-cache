From bd1a3d19051d0ab4b7959ff31d2b974d787531ee Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 5 Jan 2015 16:43:18 +0800
Subject: [PATCH 327/456] drm: xilinx: remove the non-existing function usage

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

This patch comes from:
   https://github.com/Xilinx/linux-xlnx.git

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/gpu/drm/xilinx/xilinx_drm_drv.c |    4 +++-
 drivers/gpu/drm/xylon/xylon_drv.c       |    4 +++-
 2 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/drivers/gpu/drm/xilinx/xilinx_drm_drv.c b/drivers/gpu/drm/xilinx/xilinx_drm_drv.c
index 68295bd..a20afb3 100644
--- a/drivers/gpu/drm/xilinx/xilinx_drm_drv.c
+++ b/drivers/gpu/drm/xilinx/xilinx_drm_drv.c
@@ -424,7 +424,9 @@ static int xilinx_drm_platform_probe(struct platform_device *pdev)
 /* exit xilinx drm platform */
 static int xilinx_drm_platform_remove(struct platform_device *pdev)
 {
-	drm_platform_exit(&xilinx_drm_driver, pdev);
+	struct xilinx_drm_private *private = platform_get_drvdata(pdev);
+
+	drm_put_dev(private->drm);
 
 	return 0;
 }
diff --git a/drivers/gpu/drm/xylon/xylon_drv.c b/drivers/gpu/drm/xylon/xylon_drv.c
index e0b9eae..5090576 100644
--- a/drivers/gpu/drm/xylon/xylon_drv.c
+++ b/drivers/gpu/drm/xylon/xylon_drv.c
@@ -312,7 +312,9 @@ static int xylon_drm_platform_probe(struct platform_device *pdev)
 
 static int xylon_drm_platform_remove(struct platform_device *pdev)
 {
-	drm_platform_exit(&xylon_drm_driver, pdev);
+	struct xylon_drm_device *xdev = platform_get_drvdata(pdev);
+
+	drm_put_dev(xdev->dev);
 
 	return 0;
 }
-- 
1.7.5.4

