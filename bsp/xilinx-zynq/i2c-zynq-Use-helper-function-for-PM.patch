From 75ff00cdd123918fcda51910f86de3c60cdf21d2 Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Mon, 30 Sep 2013 11:25:17 +0200
Subject: [PATCH 162/509] i2c: zynq: Use helper function for PM

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 6c7824a2f8bc8bc89a1923a8d6271fd1c9869de1

Simplify code by using helper macro.

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/i2c/busses/i2c-zynq.c |   12 +++---------
 1 files changed, 3 insertions(+), 9 deletions(-)

diff --git a/drivers/i2c/busses/i2c-zynq.c b/drivers/i2c/busses/i2c-zynq.c
index ad180e3..19f83f3 100644
--- a/drivers/i2c/busses/i2c-zynq.c
+++ b/drivers/i2c/busses/i2c-zynq.c
@@ -785,15 +785,9 @@ static int xi2cps_resume(struct device *_dev)
 
 	return 0;
 }
+#endif
 
-static const struct dev_pm_ops xi2cps_dev_pm_ops = {
-	SET_SYSTEM_SLEEP_PM_OPS(xi2cps_suspend, xi2cps_resume)
-};
-#define XI2CPS_PM	(&xi2cps_dev_pm_ops)
-
-#else /* ! CONFIG_PM_SLEEP */
-#define XI2CPS_PM	NULL
-#endif /* ! CONFIG_PM_SLEEP */
+static SIMPLE_DEV_PM_OPS(xi2cps_dev_pm_ops, xi2cps_suspend, xi2cps_resume);
 
 /************************/
 /* Platform bus binding */
@@ -946,7 +940,7 @@ static struct platform_driver xi2cps_drv = {
 		.name  = DRIVER_NAME,
 		.owner = THIS_MODULE,
 		.of_match_table = xi2cps_of_match,
-		.pm = XI2CPS_PM,
+		.pm = &xi2cps_dev_pm_ops,
 	},
 	.probe  = xi2cps_probe,
 	.remove = xi2cps_remove,
-- 
1.7.5.4

