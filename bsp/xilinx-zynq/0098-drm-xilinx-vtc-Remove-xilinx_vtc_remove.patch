From f3bcab9a6eb099c434e5a9cd0eb9f61c5e9206b5 Mon Sep 17 00:00:00 2001
From: Hyun Kwon <hyunk@xilinx.com>
Date: Fri, 18 Oct 2013 18:10:50 -0700
Subject: [PATCH 098/290] drm: xilinx: vtc: Remove xilinx_vtc_remove()

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

Remove xilinx_vtc_remove() as devm_* managed functions are used
in xilinx_vtc.c.

Signed-off-by: Hyun Kwon <hyunk@xilinx.com>
(cherry picked from commit 2cf6c3074538ca35f249fabcba9bd5b1b1f7f8a5)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/gpu/drm/xilinx/xilinx_drm_crtc.c | 6 +-----
 drivers/gpu/drm/xilinx/xilinx_vtc.c      | 6 ------
 drivers/gpu/drm/xilinx/xilinx_vtc.h      | 1 -
 3 files changed, 1 insertion(+), 12 deletions(-)

diff --git a/drivers/gpu/drm/xilinx/xilinx_drm_crtc.c b/drivers/gpu/drm/xilinx/xilinx_drm_crtc.c
index 0366ca2..9a773d3 100644
--- a/drivers/gpu/drm/xilinx/xilinx_drm_crtc.c
+++ b/drivers/gpu/drm/xilinx/xilinx_drm_crtc.c
@@ -228,8 +228,6 @@ void xilinx_drm_crtc_destroy(struct drm_crtc *base_crtc)
 
 	drm_crtc_cleanup(base_crtc);
 
-	xilinx_vtc_remove(crtc->vtc);
-
 	xilinx_drm_plane_destroy_planes(crtc->plane_manager);
 	xilinx_drm_plane_destroy_private(crtc->plane_manager, crtc->priv_plane);
 	xilinx_drm_plane_remove_manager(crtc->plane_manager);
@@ -449,14 +447,12 @@ struct drm_crtc *xilinx_drm_crtc_create(struct drm_device *drm)
 	ret = drm_crtc_init(drm, &crtc->base, &xilinx_drm_crtc_funcs);
 	if (ret) {
 		DRM_ERROR("failed to initialize crtc\n");
-		goto err_init;
+		goto err_out;
 	}
 	drm_crtc_helper_add(&crtc->base, &xilinx_drm_crtc_helper_funcs);
 
 	return &crtc->base;
 
-err_init:
-	xilinx_vtc_remove(crtc->vtc);
 err_out:
 	xilinx_drm_plane_destroy_planes(crtc->plane_manager);
 	xilinx_drm_plane_destroy_private(crtc->plane_manager, crtc->priv_plane);
diff --git a/drivers/gpu/drm/xilinx/xilinx_vtc.c b/drivers/gpu/drm/xilinx/xilinx_vtc.c
index 51a2e28..2e0a5bd 100644
--- a/drivers/gpu/drm/xilinx/xilinx_vtc.c
+++ b/drivers/gpu/drm/xilinx/xilinx_vtc.c
@@ -572,9 +572,3 @@ struct xilinx_vtc *xilinx_vtc_probe(struct device *dev,
 
 	return vtc;
 }
-
-/* remove vtc */
-void xilinx_vtc_remove(struct xilinx_vtc *vtc)
-{
-	xilinx_vtc_reset(vtc);
-}
diff --git a/drivers/gpu/drm/xilinx/xilinx_vtc.h b/drivers/gpu/drm/xilinx/xilinx_vtc.h
index b11f0a5..53a93d2 100644
--- a/drivers/gpu/drm/xilinx/xilinx_vtc.h
+++ b/drivers/gpu/drm/xilinx/xilinx_vtc.h
@@ -36,6 +36,5 @@ struct device_node;
 
 struct xilinx_vtc *xilinx_vtc_probe(struct device *dev,
 				    struct device_node *node);
-void xilinx_vtc_remove(struct xilinx_vtc *vtc);
 
 #endif /* _XILINX_VTC_H_ */
-- 
2.0.2

