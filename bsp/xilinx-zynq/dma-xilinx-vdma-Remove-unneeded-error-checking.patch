From 96a80d30e75c14d2bec907a8166fdd47c42c8ed8 Mon Sep 17 00:00:00 2001
From: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Date: Thu, 23 May 2013 00:06:48 +0200
Subject: [PATCH 304/509] dma: xilinx: vdma: Remove unneeded error checking

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit f52dd1b518be652bd60fd62bde62ace6f5ffd11b

Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com>
Acked-by: Srikanth Thokala <sthokal@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/dma/xilinx/xilinx_axivdma.c |   16 +++-------------
 1 files changed, 3 insertions(+), 13 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axivdma.c b/drivers/dma/xilinx/xilinx_axivdma.c
index a079d7c..015bccc 100644
--- a/drivers/dma/xilinx/xilinx_axivdma.c
+++ b/drivers/dma/xilinx/xilinx_axivdma.c
@@ -774,17 +774,12 @@ static struct dma_async_tx_descriptor *xilinx_vdma_prep_slave_sg(
 	enum dma_transfer_direction direction, unsigned long flags,
 	void *context)
 {
-	struct xilinx_vdma_chan *chan;
+	struct xilinx_vdma_chan *chan = to_xilinx_chan(dchan);
 	struct xilinx_vdma_desc_sw *first = NULL, *prev = NULL, *new = NULL;
 	struct xilinx_vdma_desc_hw *hw = NULL, *prev_hw = NULL;
-	int i;
 	struct scatterlist *sg;
 	dma_addr_t dma_src;
-
-	if (!dchan)
-		return NULL;
-
-	chan = to_xilinx_chan(dchan);
+	unsigned int i;
 
 	if (chan->direction != direction)
 		return NULL;
@@ -898,14 +893,9 @@ fail:
 static int xilinx_vdma_device_control(struct dma_chan *dchan,
 				enum dma_ctrl_cmd cmd, unsigned long arg)
 {
-	struct xilinx_vdma_chan *chan;
+	struct xilinx_vdma_chan *chan = to_xilinx_chan(dchan);
 	unsigned long flags;
 
-	if (!dchan)
-		return -EINVAL;
-
-	chan = to_xilinx_chan(dchan);
-
 	if (cmd == DMA_TERMINATE_ALL) {
 		/* Halt the DMA engine */
 		xilinx_vdma_halt(chan);
-- 
1.7.5.4

