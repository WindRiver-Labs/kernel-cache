From 4b01498f08be0f9a3604aa8417ceca503ac2e628 Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Fri, 21 Feb 2014 15:32:16 +0100
Subject: [PATCH 111/182] usb: phy-zynq: Use SIMPLE_DEV_PM_OPS

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

Simplify code around PM functions.

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit 131056ef8315790eb28dfe91b44df76d46852f1b)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/usb/phy/phy-zynq-usb.c |   13 ++++---------
 1 files changed, 4 insertions(+), 9 deletions(-)

diff --git a/drivers/usb/phy/phy-zynq-usb.c b/drivers/usb/phy/phy-zynq-usb.c
index cdebe1b..f043066 100644
--- a/drivers/usb/phy/phy-zynq-usb.c
+++ b/drivers/usb/phy/phy-zynq-usb.c
@@ -2267,16 +2267,11 @@ error:
 	transceiver_suspend(pdev);
 	return ret;
 }
-
-static const struct dev_pm_ops zynq_otg_dev_pm_ops = {
-	SET_SYSTEM_SLEEP_PM_OPS(zynq_otg_suspend, zynq_otg_resume)
-};
-#define ZYNQ_OTG_PM	(&zynq_otg_dev_pm_ops)
-
-#else /* ! CONFIG_PM_SLEEP */
-#define ZYNQ_OTG_PM	NULL
 #endif /* ! CONFIG_PM_SLEEP */
 
+static SIMPLE_DEV_PM_OPS(zynq_otg_dev_pm_ops, zynq_otg_suspend,
+			 zynq_otg_resume);
+
 #ifndef CONFIG_USB_ZYNQ_DR_OF
 static struct platform_driver zynq_otg_driver = {
 #else
@@ -2287,7 +2282,7 @@ struct platform_driver zynq_otg_driver = {
 	.driver		= {
 		.owner	= THIS_MODULE,
 		.name	= DRIVER_NAME,
-		.pm	= ZYNQ_OTG_PM,
+		.pm	= &zynq_otg_dev_pm_ops,
 	},
 };
 
-- 
1.7.5.4

