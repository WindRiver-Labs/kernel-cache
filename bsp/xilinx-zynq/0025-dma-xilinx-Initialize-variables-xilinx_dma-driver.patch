From 75ba72fe69472b0d62b1ce7c26244fa72a89735b Mon Sep 17 00:00:00 2001
From: Joseph Zavodny <Joseph.Zavodny@jhuapl.edu>
Date: Tue, 25 Aug 2015 15:27:58 -0400
Subject: [PATCH 25/53] dma: xilinx: Initialize variables xilinx_dma driver.

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

desc was never initialized so dereferencing that pointer would invariably
result in a null pointer exception.  The residue must also be initialized
to zero.  These changes both fix compiler warnings.

Signed-off-by: Joseph Zavodny <Joseph.Zavodny@jhuapl.edu>
Acked-by: Kedareswara rao Appana <appanad@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit debaf4756da79ba1af81053a1b718449c600615b)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/dma/xilinx/xilinx_dma.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_dma.c b/drivers/dma/xilinx/xilinx_dma.c
index cbcd130..6f6c450d 100644
--- a/drivers/dma/xilinx/xilinx_dma.c
+++ b/drivers/dma/xilinx/xilinx_dma.c
@@ -484,12 +484,12 @@ static enum dma_status xilinx_dma_tx_status(struct dma_chan *dchan,
 					    struct dma_tx_state *txstate)
 {
 	struct xilinx_dma_chan *chan = to_xilinx_chan(dchan);
-	struct xilinx_dma_tx_descriptor *desc;
+	struct xilinx_dma_tx_descriptor *desc = chan->active_desc;
 	struct xilinx_dma_tx_segment *segment;
 	struct xilinx_dma_desc_hw *hw;
 	enum dma_status ret;
 	unsigned long flags;
-	u32 residue;
+	u32 residue = 0;
 
 	ret = dma_cookie_status(dchan, cookie, txstate);
 	if (ret == DMA_COMPLETE || !txstate)
-- 
1.7.10.4

