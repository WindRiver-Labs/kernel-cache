From bc3173d5b87a68948be77da0c3925be681d41842 Mon Sep 17 00:00:00 2001
From: Harini Katakam <harini.katakam@xilinx.com>
Date: Mon, 17 Mar 2014 13:16:54 +0530
Subject: [PATCH 096/509] SPI: cadence: Simplify return logic in
 prepare_transfer_hardware function

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 02312e9e83490db5593273b14c9cf1a6177b17ed

Simplify return logic in prepare_transfer_hardware function

Signed-off-by: Harini Katakam <harinik@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/spi/spi-cadence.c |   11 +++++------
 1 files changed, 5 insertions(+), 6 deletions(-)

diff --git a/drivers/spi/spi-cadence.c b/drivers/spi/spi-cadence.c
index 11e9136..c4a2e73 100644
--- a/drivers/spi/spi-cadence.c
+++ b/drivers/spi/spi-cadence.c
@@ -458,15 +458,14 @@ static int cdns_spi_start_transfer(struct spi_device *spi,
 static int cdns_prepare_transfer_hardware(struct spi_master *master)
 {
 	struct cdns_spi *xspi = spi_master_get_devdata(master);
-	int status = 0;
 
-	if (xspi->driver_state == CDNS_SPI_DRIVER_STATE_READY)
-		cdns_spi_write(xspi->regs + CDNS_SPI_ER_OFFSET,
+	if (xspi->driver_state != CDNS_SPI_DRIVER_STATE_READY)
+		return -EINVAL;
+
+	cdns_spi_write(xspi->regs + CDNS_SPI_ER_OFFSET,
 				CDNS_SPI_ER_ENABLE_MASK);
-	else
-		status = -EINVAL;
 
-	return status;
+	return 0;
 }
 
 /**
-- 
1.7.5.4

