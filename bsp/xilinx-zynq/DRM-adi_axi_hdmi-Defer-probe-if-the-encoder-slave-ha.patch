From e337f95a817d6814a7ed98374f4c5d5b6569aa9a Mon Sep 17 00:00:00 2001
From: Lars-Peter Clausen <lars@metafoo.de>
Date: Tue, 25 Jun 2013 18:44:58 +0200
Subject: [PATCH 237/509] DRM: adi_axi_hdmi: Defer probe if the encoder slave
 has no driver

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 15d911fbdf34eee3fc7b6c0236d18cae83cca4ab

Signed-off-by: Lars-Peter Clausen <lars@metafoo.de>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/gpu/drm/adi_axi_hdmi/axi_hdmi_drv.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/gpu/drm/adi_axi_hdmi/axi_hdmi_drv.c b/drivers/gpu/drm/adi_axi_hdmi/axi_hdmi_drv.c
index 4b05090..ffba8b35 100644
--- a/drivers/gpu/drm/adi_axi_hdmi/axi_hdmi_drv.c
+++ b/drivers/gpu/drm/adi_axi_hdmi/axi_hdmi_drv.c
@@ -171,7 +171,7 @@ static int axi_hdmi_platform_probe(struct platform_device *pdev)
 	private->encoder_slave = of_find_i2c_device_by_node(slave_node);
 	of_node_put(slave_node);
 
-	if (!private->encoder_slave)
+	if (!private->encoder_slave || !private->encoder_slave->dev.driver)
 		return -EPROBE_DEFER;
 
 	private->dma = of_dma_request_slave_channel(pdev->dev.of_node, "video");
-- 
1.7.5.4

