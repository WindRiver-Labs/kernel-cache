From f6892f94d242977c97e7de4d3d2f91e0e57b6744 Mon Sep 17 00:00:00 2001
From: Zhong Hongbo <hongbo.zhong@windriver.com>
Date: Tue, 21 Aug 2012 16:26:01 +0800
Subject: [PATCH 34/36] Xilinx: ARM: EmacPs: Ignore collisions for half duplex
 mode

For half duplex mode the collisions were being reported as errors.
For half duplex mode collisions are expected to occur for heavy
traffic and it is not an error case. Only when number of retries
exceeds the limit, then only it should be reported as an error.
This patch fixes the issue.

Signed-off-by: Anirudha <anirudh@xilinx.com>
Integrated-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 drivers/net/ethernet/xilinx/xilinx_emacps.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/xilinx/xilinx_emacps.c b/drivers/net/ethernet/xilinx/xilinx_emacps.c
index b02762c..80b6da7 100644
--- a/drivers/net/ethernet/xilinx/xilinx_emacps.c
+++ b/drivers/net/ethernet/xilinx/xilinx_emacps.c
@@ -1097,8 +1097,8 @@ static void xemacps_tx_poll(struct net_device *ndev)
 	 */
 	if (regval & (XEMACPS_TXSR_URUN_MASK | XEMACPS_TXSR_RXOVR_MASK |
 		XEMACPS_TXSR_HRESPNOK_MASK | XEMACPS_TXSR_COL1000_MASK |
-		XEMACPS_TXSR_BUFEXH_MASK | XEMACPS_TXSR_COL100_MASK)) {
-		printk(KERN_ERR "%s: TX error 0x%x, resetting buffers?\n",
+		XEMACPS_TXSR_BUFEXH_MASK)) {
+		printk(KERN_ERR "%s: TX ERROR 0x%x\n",
 			ndev->name, regval);
 		lp->stats.tx_errors++;
 	}
-- 
1.7.9.7

