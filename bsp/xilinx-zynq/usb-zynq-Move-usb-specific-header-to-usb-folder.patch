From 445efad99fbb96f56995a624429127adfc1d724c Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Fri, 24 Jan 2014 11:34:31 +0100
Subject: [PATCH 103/182] usb: zynq: Move usb specific header to usb folder

This patch comes from:
  https://github.com/Xilinx/linux-xlnx.git

xilinx_device.h was used for different drivers
but currently it is just used for usb that's why
move it to proper folder.

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit f5d5a2556bab36bd6631d0d89fcdd45e7652483b)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/usb/gadget/zynq_udc.c  |    2 +-
 drivers/usb/host/ehci-zynq.c   |    2 +-
 drivers/usb/host/zynq-dr-of.c  |    2 +-
 drivers/usb/phy/phy-zynq-usb.c |    2 +-
 include/linux/usb/zynq_usb.h   |   65 ++++++++++++++++++++++++++++++++++++++
 include/linux/xilinx_devices.h |   67 ----------------------------------------
 6 files changed, 69 insertions(+), 71 deletions(-)
 create mode 100644 include/linux/usb/zynq_usb.h
 delete mode 100644 include/linux/xilinx_devices.h

diff --git a/drivers/usb/gadget/zynq_udc.c b/drivers/usb/gadget/zynq_udc.c
index b9bcd6e..2fe0ca3 100644
--- a/drivers/usb/gadget/zynq_udc.c
+++ b/drivers/usb/gadget/zynq_udc.c
@@ -33,7 +33,7 @@
 #include <linux/usb/otg.h>
 #include <linux/dma-mapping.h>
 #include <linux/platform_device.h>
-#include <linux/xilinx_devices.h>
+#include <linux/usb/zynq_usb.h>
 #include <linux/dmapool.h>
 #include <linux/delay.h>
 
diff --git a/drivers/usb/host/ehci-zynq.c b/drivers/usb/host/ehci-zynq.c
index eb24a61..c3a7d27 100644
--- a/drivers/usb/host/ehci-zynq.c
+++ b/drivers/usb/host/ehci-zynq.c
@@ -18,7 +18,7 @@
 #include <linux/delay.h>
 #include <linux/pm.h>
 #include <linux/platform_device.h>
-#include <linux/xilinx_devices.h>
+#include <linux/usb/zynq_usb.h>
 #include <linux/usb/otg.h>
 #include <linux/usb/zynq_otg.h>
 
diff --git a/drivers/usb/host/zynq-dr-of.c b/drivers/usb/host/zynq-dr-of.c
index 814f663..c5889da 100644
--- a/drivers/usb/host/zynq-dr-of.c
+++ b/drivers/usb/host/zynq-dr-of.c
@@ -18,7 +18,7 @@
 #include <linux/kernel.h>
 #include <linux/module.h>
 #include <linux/platform_device.h>
-#include <linux/xilinx_devices.h>
+#include <linux/usb/zynq_usb.h>
 #include <linux/err.h>
 #include <linux/io.h>
 #include <linux/of_platform.h>
diff --git a/drivers/usb/phy/phy-zynq-usb.c b/drivers/usb/phy/phy-zynq-usb.c
index f5e1ac0..b61b243 100644
--- a/drivers/usb/phy/phy-zynq-usb.c
+++ b/drivers/usb/phy/phy-zynq-usb.c
@@ -37,7 +37,7 @@
 
 #include "../core/usb.h"
 
-#include <linux/xilinx_devices.h>
+#include <linux/usb/zynq_usb.h>
 #include <linux/usb/zynq_otg.h>
 
 #define	DRIVER_NAME	"zynq-otg"
diff --git a/include/linux/usb/zynq_usb.h b/include/linux/usb/zynq_usb.h
new file mode 100644
index 0000000..18be80f
--- /dev/null
+++ b/include/linux/usb/zynq_usb.h
@@ -0,0 +1,65 @@
+/*
+ * Definitions for any platform device related flags or structures for
+ * Xilinx EDK IPs
+ *
+ * Author: MontaVista Software, Inc.
+ *         source@mvista.com
+ *
+ * 2002-2005 (c) MontaVista Software, Inc.  This file is licensed under the
+ * terms of the GNU General Public License version 2.  This program is licensed
+ * "as is" without any warranty of any kind, whether express or implied.
+ */
+
+#ifdef __KERNEL__
+#ifndef _XILINX_DEVICE_H_
+#define _XILINX_DEVICE_H_
+
+#include <linux/types.h>
+#include <linux/version.h>
+#include <linux/platform_device.h>
+
+/*- PS USB Controller IP -*/
+enum zynq_usb2_operating_modes {
+	ZYNQ_USB2_MPH_HOST,
+	ZYNQ_USB2_DR_HOST,
+	ZYNQ_USB2_DR_DEVICE,
+	ZYNQ_USB2_DR_OTG,
+};
+
+enum zynq_usb2_phy_modes {
+	ZYNQ_USB2_PHY_NONE,
+	ZYNQ_USB2_PHY_ULPI,
+	ZYNQ_USB2_PHY_UTMI,
+	ZYNQ_USB2_PHY_UTMI_WIDE,
+	ZYNQ_USB2_PHY_SERIAL,
+};
+
+struct clk;
+struct platform_device;
+
+struct zynq_usb2_platform_data {
+	/* board specific information */
+	enum zynq_usb2_operating_modes	operating_mode;
+	enum zynq_usb2_phy_modes	phy_mode;
+	unsigned int			port_enables;
+	unsigned int			workaround;
+
+	int		(*init)(struct platform_device *);
+	void		(*exit)(struct platform_device *);
+	void __iomem	*regs;		/* ioremap'd register base */
+	struct usb_phy	*otg;
+	struct usb_phy	*ulpi;
+	int		irq;
+	struct clk	*clk;
+	struct notifier_block clk_rate_change_nb;
+	unsigned	big_endian_mmio:1;
+	unsigned	big_endian_desc:1;
+	unsigned	es:1;		/* need USBMODE:ES */
+	unsigned	le_setup_buf:1;
+	unsigned	have_sysif_regs:1;
+	unsigned	invert_drvvbus:1;
+	unsigned	invert_pwr_fault:1;
+};
+
+#endif /* _XILINX_DEVICE_H_ */
+#endif /* __KERNEL__ */
diff --git a/include/linux/xilinx_devices.h b/include/linux/xilinx_devices.h
deleted file mode 100644
index 540a2b3..0000000
--- a/include/linux/xilinx_devices.h
+++ /dev/null
@@ -1,67 +0,0 @@
-/*
- * include/linux/xilinx_devices.h
- *
- * Definitions for any platform device related flags or structures for
- * Xilinx EDK IPs
- *
- * Author: MontaVista Software, Inc.
- *         source@mvista.com
- *
- * 2002-2005 (c) MontaVista Software, Inc.  This file is licensed under the
- * terms of the GNU General Public License version 2.  This program is licensed
- * "as is" without any warranty of any kind, whether express or implied.
- */
-
-#ifdef __KERNEL__
-#ifndef _XILINX_DEVICE_H_
-#define _XILINX_DEVICE_H_
-
-#include <linux/types.h>
-#include <linux/version.h>
-#include <linux/platform_device.h>
-
-/*- PS USB Controller IP -*/
-enum zynq_usb2_operating_modes {
-	ZYNQ_USB2_MPH_HOST,
-	ZYNQ_USB2_DR_HOST,
-	ZYNQ_USB2_DR_DEVICE,
-	ZYNQ_USB2_DR_OTG,
-};
-
-enum zynq_usb2_phy_modes {
-	ZYNQ_USB2_PHY_NONE,
-	ZYNQ_USB2_PHY_ULPI,
-	ZYNQ_USB2_PHY_UTMI,
-	ZYNQ_USB2_PHY_UTMI_WIDE,
-	ZYNQ_USB2_PHY_SERIAL,
-};
-
-struct clk;
-struct platform_device;
-
-struct zynq_usb2_platform_data {
-	/* board specific information */
-	enum zynq_usb2_operating_modes	operating_mode;
-	enum zynq_usb2_phy_modes	phy_mode;
-	unsigned int			port_enables;
-	unsigned int			workaround;
-
-	int		(*init)(struct platform_device *);
-	void		(*exit)(struct platform_device *);
-	void __iomem	*regs;		/* ioremap'd register base */
-	struct usb_phy	*otg;
-	struct usb_phy	*ulpi;
-	int		irq;
-	struct clk	*clk;
-	struct notifier_block clk_rate_change_nb;
-	unsigned	big_endian_mmio:1;
-	unsigned	big_endian_desc:1;
-	unsigned	es:1;		/* need USBMODE:ES */
-	unsigned	le_setup_buf:1;
-	unsigned	have_sysif_regs:1;
-	unsigned	invert_drvvbus:1;
-	unsigned	invert_pwr_fault:1;
-};
-
-#endif /* _XILINX_DEVICE_H_ */
-#endif /* __KERNEL__ */
-- 
1.7.5.4

