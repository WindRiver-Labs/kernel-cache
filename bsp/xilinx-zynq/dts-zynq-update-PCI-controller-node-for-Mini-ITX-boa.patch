From 7192fd5ef45161f7ecdb51815c4e48ae08c85c05 Mon Sep 17 00:00:00 2001
From: Quanyang Wang <quanyang.wang@windriver.com>
Date: Thu, 27 Aug 2015 04:00:13 +0000
Subject: [PATCH 2/4] dts: zynq: update PCI controller node for Mini-ITX board

update PCI controller node for Mini-ITX board for the new PCI driver which
picked from upstream.

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/arm/boot/dts/zynq-mini-itx-adv7511-pcie.dts |   90 +++++-----------------
 1 files changed, 19 insertions(+), 71 deletions(-)

diff --git a/arch/arm/boot/dts/zynq-mini-itx-adv7511-pcie.dts b/arch/arm/boot/dts/zynq-mini-itx-adv7511-pcie.dts
index f69eb7b..2f1e089 100644
--- a/arch/arm/boot/dts/zynq-mini-itx-adv7511-pcie.dts
+++ b/arch/arm/boot/dts/zynq-mini-itx-adv7511-pcie.dts
@@ -3,76 +3,24 @@
 
 / {
 	axi_pcie_0: axi-pcie@50000000 {
-		#address-cells = <3>;
-		#size-cells = <2>;
-		compatible = "xlnx,axi-pcie-1.05.a";
-		interrupt-parent = <&gic>;
-		interrupts = <0 59 4>;
-		ranges = <0x02000000 0x00000000 0x60000000 0x60000000 0x00000000 0x10000000>;
-		reg = <0x50000000 0x1000000>;
-		xlnx,axi-aclk-freq-hz = <0x7735940>;
-		xlnx,axibar-0 = <0x60000000>;
-		xlnx,axibar-1 = <0xffffffff>;
-		xlnx,axibar-2 = <0xffffffff>;
-		xlnx,axibar-3 = <0xffffffff>;
-		xlnx,axibar-4 = <0xffffffff>;
-		xlnx,axibar-5 = <0xffffffff>;
-		xlnx,axibar-as-0 = <0x0>;
-		xlnx,axibar-as-1 = <0x0>;
-		xlnx,axibar-as-2 = <0x0>;
-		xlnx,axibar-as-3 = <0x0>;
-		xlnx,axibar-as-4 = <0x0>;
-		xlnx,axibar-as-5 = <0x0>;
-		xlnx,axibar-highaddr-0 = <0x6fffffff>;
-		xlnx,axibar-highaddr-1 = <0x0>;
-		xlnx,axibar-highaddr-2 = <0x0>;
-		xlnx,axibar-highaddr-3 = <0x0>;
-		xlnx,axibar-highaddr-4 = <0x0>;
-		xlnx,axibar-highaddr-5 = <0x0>;
-		xlnx,axibar-num = <0x1>;
-		xlnx,axibar2pciebar-0 = <0x60000000>;
-		xlnx,axibar2pciebar-1 = <0x0>;
-		xlnx,axibar2pciebar-2 = <0x0>;
-		xlnx,axibar2pciebar-3 = <0x0>;
-		xlnx,axibar2pciebar-4 = <0x0>;
-		xlnx,axibar2pciebar-5 = <0x0>;
-		xlnx,class-code = <0x60400>;
-		xlnx,comp-timeout = <0x1>;
-		xlnx,device-id = <0x706>;
-		xlnx,ep-link-partner-rcb = <0x0>;
-		xlnx,family = "zynq";
-		xlnx,include-baroffset-reg = <0x1>;
-		xlnx,include-rc = <0x1>;
-		xlnx,instance = "axi_pcie_0";
-		xlnx,interrupt-pin = <0x0>;
-		xlnx,max-link-speed = <0x0>;
-		xlnx,no-of-lanes = <0x4>;
-		xlnx,num-msi-req = <0x0>;
-		xlnx,pcie-cap-slot-implemented = <0x1>;
-		xlnx,pcie-use-mode = "3.0";
-		xlnx,pciebar-as = <0x0>;
-		xlnx,pciebar-len-0 = <0x1e>;
-		xlnx,pciebar-len-1 = <0xd>;
-		xlnx,pciebar-len-2 = <0xd>;
-		xlnx,pciebar-num = <0x1>;
-		xlnx,pciebar2axibar-0 = <0x0>;
-		xlnx,pciebar2axibar-0-sec = <0x1>;
-		xlnx,pciebar2axibar-1 = <0xffffffff>;
-		xlnx,pciebar2axibar-1-sec = <0x1>;
-		xlnx,pciebar2axibar-2 = <0xffffffff>;
-		xlnx,pciebar2axibar-2-sec = <0x1>;
-		xlnx,ref-clk-freq = <0x0>;
-		xlnx,ref-clk-freq-hz = <0x5f5e100>;
-		xlnx,rev-id = <0x0>;
-		xlnx,s-axi-ctl-aclk-freq-hz = <0x7735940>;
-		xlnx,s-axi-ctl-protocol = "AXI4LITE";
-		xlnx,s-axi-id-width = <0x1>;
-		xlnx,s-axi-support-threads = <0x1>;
-		xlnx,s-axi-supports-narrow-burst = <0x1>;
-		xlnx,s-axi-supports-read = <0x1>;
-		xlnx,s-axi-supports-write = <0x1>;
-		xlnx,subsystem-id = <0x6100>;
-		xlnx,subsystem-vendor-id = <0x0>;
-		xlnx,vendor-id = <0x10ee>;
+       #address-cells = <3>;
+       #size-cells = <2>;
+       #interrupt-cells = <1>;
+       compatible = "xlnx,axi-pcie-host-1.00.a";
+       reg = < 0x50000000 0x10000000 >;
+       device_type = "pci";
+       interrupts = < 0 59 4 >;
+       interrupt-map-mask = <0 0 0 7>;
+       interrupt-map = <0 0 0 1 &pcie_intc 1>,
+               <0 0 0 2 &pcie_intc 2>,
+               <0 0 0 3 &pcie_intc 3>,
+               <0 0 0 4 &pcie_intc 4>;
+       ranges = < 0x02000000 0 0x60000000 0x60000000 0 0x10000000 >;
+
+       pcie_intc: interrupt-controller {
+           interrupt-controller;
+           #address-cells = <0>;
+           #interrupt-cells = <1>;
+		};
 	} ;
 };
-- 
1.7.5.4

