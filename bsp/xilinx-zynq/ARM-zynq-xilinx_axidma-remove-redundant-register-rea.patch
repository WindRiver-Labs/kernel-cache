From f89c30673680e1a9dd276f748769242d75078e12 Mon Sep 17 00:00:00 2001
From: Nicolae Rosia <nicolae.rosia@certsign.ro>
Date: Mon, 5 Jan 2015 18:10:17 +0200
Subject: [PATCH 023/456] ARM: zynq: xilinx_axidma: remove redundant register
 read from dma_intr_handler

Since we enable all interrupts, there's no reason to mask any of them.

Signed-off-by: Nicolae Rosia <nicolae.rosia@certsign.ro>
Acked-by: Kedareswara rao Appana <appanad@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit d1d52cfd2221ad4746e8a421e3e8c4859641c8da)
---
 drivers/dma/xilinx/xilinx_axidma.c |    7 +------
 1 files changed, 1 insertions(+), 6 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axidma.c b/drivers/dma/xilinx/xilinx_axidma.c
index dfbfe03..3baed51 100644
--- a/drivers/dma/xilinx/xilinx_axidma.c
+++ b/drivers/dma/xilinx/xilinx_axidma.c
@@ -521,9 +521,7 @@ static int dma_reset(struct xilinx_dma_chan *chan)
 static irqreturn_t dma_intr_handler(int irq, void *data)
 {
 	struct xilinx_dma_chan *chan = data;
-	u32 stat, reg;
-
-	reg = dma_read(chan, XILINX_DMA_CONTROL_OFFSET);
+	u32 stat;
 
 	stat = dma_read(chan, XILINX_DMA_STATUS_OFFSET);
 	if (!(stat & XILINX_DMA_XR_IRQ_ALL_MASK))
@@ -533,9 +531,6 @@ static irqreturn_t dma_intr_handler(int irq, void *data)
 	dma_write(chan, XILINX_DMA_STATUS_OFFSET,
 		  XILINX_DMA_XR_IRQ_ALL_MASK);
 
-	/* Check for only the interrupts which are enabled */
-	stat &= (reg & XILINX_DMA_XR_IRQ_ALL_MASK);
-
 	if (stat & XILINX_DMA_XR_IRQ_ERROR_MASK) {
 		dev_err(chan->dev,
 			"Channel %x has errors %x, cdr %x tdr %x\n",
-- 
1.7.5.4

