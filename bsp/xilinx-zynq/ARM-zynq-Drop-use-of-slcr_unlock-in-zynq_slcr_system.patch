From a22deb07cbc0747e7cf6a3faf729c29af4da6101 Mon Sep 17 00:00:00 2001
From: Josh Cartwright <joshc@ni.com>
Date: Thu, 19 Mar 2015 08:33:53 -0500
Subject: [PATCH] ARM: zynq: Drop use of slcr_unlock in
 zynq_slcr_system_restart

commit ef6ca1a84a3da9bf45d31399090153e00fc6cd68 upstream

The SLCR is unconditionally unlocked early on boot in zynq_slcr_init()
and not ever re-locked. As such, it is not necessary to explicitly unlock in
the restart codepath.

Signed-off-by: Josh Cartwright <joshc@ni.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Zhenbo Gao <zhenbo.gao@windriver.com>
---
 arch/arm/mach-zynq/slcr.c |    7 -------
 1 files changed, 0 insertions(+), 7 deletions(-)

diff --git a/arch/arm/mach-zynq/slcr.c b/arch/arm/mach-zynq/slcr.c
index 8c14fa8..a771907 100644
--- a/arch/arm/mach-zynq/slcr.c
+++ b/arch/arm/mach-zynq/slcr.c
@@ -114,13 +114,6 @@ void zynq_slcr_system_reset(void)
 	u32 reboot;
 
 	/*
-	 * Unlock the SLCR then reset the system.
-	 * Note that this seems to require raw i/o
-	 * functions or there's a lockup?
-	 */
-	zynq_slcr_unlock();
-
-	/*
 	 * Clear 0x0F000000 bits of reboot status register to workaround
 	 * the FSBL not loading the bitstream after soft-reboot
 	 * This is a temporary solution until we know more.
-- 
1.7.5.4

