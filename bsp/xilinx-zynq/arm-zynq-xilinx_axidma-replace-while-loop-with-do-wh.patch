From 128640ec28c9ac10c90eaf2f7c364338e7758233 Mon Sep 17 00:00:00 2001
From: Nicolae Rosia <nicolae.rosia@certsign.ro>
Date: Tue, 2 Dec 2014 21:33:31 +0200
Subject: [PATCH 004/456] arm: zynq: xilinx_axidma: replace while loop with do
 while

Signed-off-by: Nicolae Rosia <nicolae.rosia@certsign.ro>
Acked-by: Soren Brinkmann <soren.brinkmann@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
(cherry picked from commit f6fde7c81c126ea8470cd28a08b1c5855d8063ea)
---
 drivers/dma/xilinx/xilinx_axidma.c |   12 ++++--------
 1 files changed, 4 insertions(+), 8 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axidma.c b/drivers/dma/xilinx/xilinx_axidma.c
index 3e23fe9..8da6695 100644
--- a/drivers/dma/xilinx/xilinx_axidma.c
+++ b/drivers/dma/xilinx/xilinx_axidma.c
@@ -314,13 +314,11 @@ static void dma_halt(struct xilinx_dma_chan *chan)
 		  ~XILINX_DMA_CR_RUNSTOP_MASK);
 
 	/* Wait for the hardware to halt */
-	while (loop) {
+	do {
 		if (dma_read(chan, XILINX_DMA_STATUS_OFFSET) &
 		      XILINX_DMA_SR_HALTED_MASK)
 			break;
-
-		loop -= 1;
-	}
+	} while (loop--);
 
 	if (!loop) {
 		pr_debug("Cannot stop channel %x: %x\n",
@@ -341,13 +339,11 @@ static void dma_start(struct xilinx_dma_chan *chan)
 		  XILINX_DMA_CR_RUNSTOP_MASK);
 
 	/* Wait for the hardware to start */
-	while (loop) {
+	do {
 		if (!(dma_read(chan, XILINX_DMA_STATUS_OFFSET) &
 		    XILINX_DMA_SR_HALTED_MASK))
 			break;
-
-		loop -= 1;
-	}
+	} while (loop--);
 
 	if (!loop) {
 		pr_debug("Cannot start channel %x: %x\n",
-- 
1.7.5.4

