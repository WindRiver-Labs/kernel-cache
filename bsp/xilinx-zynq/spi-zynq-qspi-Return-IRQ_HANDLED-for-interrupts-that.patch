From 323a8e5da690650167d433b8d4489047f879f61a Mon Sep 17 00:00:00 2001
From: Punnaiah Choudary Kalluri <punnaia@xilinx.com>
Date: Mon, 7 Apr 2014 19:46:45 +0530
Subject: [PATCH 119/509] spi: zynq-qspi: Return IRQ_HANDLED for interrupts
 that are processed

https://github.com/analogdevicesinc/linux.git xcomm_zynq
commit 5356c69d1f8659c9afb754d33009ee27f90d5ce9

Return IRQ_HANDLED only when interrupts are processed and IRQ_NONE
otherwise.

Signed-off-by: Punnaiah Choudary Kalluri <punnaia@xilinx.com>
Signed-off-by: Harini Katakam <harinik@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/spi/spi-zynq-qspi.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/drivers/spi/spi-zynq-qspi.c b/drivers/spi/spi-zynq-qspi.c
index 5080c57..4e02855 100644
--- a/drivers/spi/spi-zynq-qspi.c
+++ b/drivers/spi/spi-zynq-qspi.c
@@ -507,9 +507,10 @@ static irqreturn_t zynq_qspi_irq(int irq, void *dev_id)
 				spi_finalize_current_transfer(master);
 			}
 		}
+		return IRQ_HANDLED;
 	}
 
-	return IRQ_HANDLED;
+	return IRQ_NONE;
 }
 
 /**
-- 
1.7.5.4

