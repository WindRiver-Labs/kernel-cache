From 396dfc949ade3e20204f4e8641c19fb7993f771f Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Tue, 27 Dec 2011 15:37:28 +0800
Subject: [PATCH 10/18] net/dpa: support 10M/100M half duplex in SGMII mode
 for dtsec

The dtsec Ethernet doesn't support 1000M half duplex when working in
SGMII mode, but it does support 10M/100M half duplex in this mode.
And these two features are also explicitly listed as supported
features in DTSEC_SUPPORTED. So enable 10M/100M half duplex for
SGMII.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../net/dpa/NetCommSw/Peripherals/FM/MAC/dtsec.c   |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/net/dpa/NetCommSw/Peripherals/FM/MAC/dtsec.c b/drivers/net/dpa/NetCommSw/Peripherals/FM/MAC/dtsec.c
index 81f4746..f7797e6 100644
--- a/drivers/net/dpa/NetCommSw/Peripherals/FM/MAC/dtsec.c
+++ b/drivers/net/dpa/NetCommSw/Peripherals/FM/MAC/dtsec.c
@@ -1300,7 +1300,7 @@ static t_Error DtsecAdjustLink(t_Handle h_Dtsec, e_EnetSpeed speed, bool fullDup
     SANITY_CHECK_RETURN_ERROR(p_DtsecMemMap, E_INVALID_HANDLE);
 
     if (!fullDuplex &&
-        ((speed >= e_ENET_SPEED_1000) ||
+        ((speed >= e_ENET_SPEED_1000) &&
          (ENET_INTERFACE_FROM_MODE(p_Dtsec->enetMode) == e_ENET_IF_SGMII)))
         RETURN_ERROR(MAJOR, E_CONFLICT, ("Ethernet interface does not support Half Duplex mode"));
 
-- 
1.7.9.7

