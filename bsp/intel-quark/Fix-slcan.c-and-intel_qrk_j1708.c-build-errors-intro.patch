From 174c376e77089f150be4808ba42bd461bc42d8eb Mon Sep 17 00:00:00 2001
From: Lans Zhang <jia.zhang@windriver.com>
Date: Thu, 1 Jan 2015 13:49:47 +0800
Subject: [PATCH 19/31] Fix slcan.c and intel_qrk_j1708.c build errors
 introduced by vendor's patchset.

The fix resolves the following build errors:

error: request for member 'ifindex' in something not a structure or union
   can_skb_prv(skb)->ifindex = sl->dev->ifindex;

Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
---
 drivers/net/can/slcan.c                      |    2 +-
 drivers/platform/x86/quark/intel_qrk_j1708.c |    1 +
 2 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/drivers/net/can/slcan.c b/drivers/net/can/slcan.c
index 4840b76..4d2908a 100644
--- a/drivers/net/can/slcan.c
+++ b/drivers/net/can/slcan.c
@@ -223,7 +223,7 @@ static void slc_bump(struct slcan_channel *sl)
 	skb->ip_summed = CHECKSUM_UNNECESSARY;
 
 	can_skb_reserve(skb);
-	can_skb_prv(skb)->ifindex = sl->dev->ifindex;
+	can_skb_prv(skb)->ifindex = sl->dev[dev_idx]->ifindex;
 
 	memcpy(skb_put(skb, sizeof(struct can_frame)),
 	       &cf, sizeof(struct can_frame));
diff --git a/drivers/platform/x86/quark/intel_qrk_j1708.c b/drivers/platform/x86/quark/intel_qrk_j1708.c
index 309365d..c82b023 100644
--- a/drivers/platform/x86/quark/intel_qrk_j1708.c
+++ b/drivers/platform/x86/quark/intel_qrk_j1708.c
@@ -43,6 +43,7 @@
 #include <linux/module.h>
 #include <linux/slab.h>
 #include <linux/serial_core.h>
+#include <linux/device.h>
 #include <linux/math64.h>
 #include <asm/desc.h>
 #include <linux/intel_qrk_j1708.h>
-- 
1.7.5.4

