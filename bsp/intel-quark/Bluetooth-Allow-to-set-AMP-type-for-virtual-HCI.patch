From c414676dc49d7f96b643d693f59bd1d923bb1fe3 Mon Sep 17 00:00:00 2001
From: Andrei Emeltchenko <andrei.emeltchenko@intel.com>
Date: Mon, 14 Nov 2011 12:42:48 +0200
Subject: [PATCH 0003/1187] Bluetooth: Allow to set AMP type for virtual HCI

commit 36acbb1adadf1ba300f14ee904a7d3f23120e0d6	upstream

Type can be changed during re-opening device /dev/vhci.

Signed-off-by: Andrei Emeltchenko <andrei.emeltchenko@intel.com>
Acked-by: Marcel Holtmann <marcel@holtmann.org>
Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>
Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
---
 drivers/bluetooth/hci_vhci.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/bluetooth/hci_vhci.c b/drivers/bluetooth/hci_vhci.c
index 158bfe5..476b4db 100644
--- a/drivers/bluetooth/hci_vhci.c
+++ b/drivers/bluetooth/hci_vhci.c
@@ -239,6 +239,9 @@ static int vhci_open(struct inode *inode, struct file *file)
 	if (amp)
 		hdev->dev_type = HCI_AMP;
 
+	if (amp)
+		hdev->dev_type = HCI_AMP;
+
 	hdev->open     = vhci_open_dev;
 	hdev->close    = vhci_close_dev;
 	hdev->flush    = vhci_flush;
-- 
1.7.5.4

