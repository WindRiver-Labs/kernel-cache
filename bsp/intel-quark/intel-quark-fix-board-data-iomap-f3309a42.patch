From d1bf84101a6384225f98373558715b018f8023be Mon Sep 17 00:00:00 2001
From: Lans Zhang <jia.zhang@windriver.com>
Date: Thu, 6 Mar 2014 12:55:16 +0800
Subject: [PATCH 6/7] intel-quark: fix board-data iomap.

The failure of ioremap() -> no cln-plat -> cannot get platform id item
within mfh -> intel_cln_plat_get_id() returns CLANTON_PLAT_UNDEFINED ->
stmmac driver cannot be initialized properly.

To fix this issue from root, be aware of using a proper value of mapped
area determined by the maximum size of MFH and platform data area,
which cannot conflict with other MFH items.

Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
---
 drivers/platform/x86/quark/intel_qrk_board_data.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/platform/x86/quark/intel_qrk_board_data.c b/drivers/platform/x86/quark/intel_qrk_board_data.c
index db7f76a..2a0cc3b 100644
--- a/drivers/platform/x86/quark/intel_qrk_board_data.c
+++ b/drivers/platform/x86/quark/intel_qrk_board_data.c
@@ -43,7 +43,7 @@
 #define MTD_PART_LEN				0x00040000
 #define MFH_PADDING				0x1E8
 #define MFH_MAGIC				0x5F4D4648
-#define FLASH_SIZE				0x00400000
+#define FLASH_SIZE				(PLATFORM_DATA_OFFSET + 0x1000)
 
 /* MFH types supported @ version #1 */
 #define MFH_ITEM_FW_STAGE1			0x00000000
-- 
1.7.5.4

