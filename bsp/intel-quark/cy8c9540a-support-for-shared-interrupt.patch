From 42f06d675a6557eb00e1f7e154006a9e4ac6d55b Mon Sep 17 00:00:00 2001
From: Adrian Bradianu <adrian.bradianu@windriver.com>
Date: Thu, 5 Jun 2014 18:19:46 +0300
Subject: [PATCH 2/2] cy8c9540a : support for shared interrupt

Add the IRQF_SHARED flag to request_threaded_irq as on
ECS GEN2 board there are two I2C I/O expanders and both
share the same interrupt.

Signed-off-by: Adrian Bradianu <adrian.bradianu@windriver.com>
---
 drivers/mfd/cy8c9540a.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/drivers/mfd/cy8c9540a.c b/drivers/mfd/cy8c9540a.c
index 444e5ab..a483416 100644
--- a/drivers/mfd/cy8c9540a.c
+++ b/drivers/mfd/cy8c9540a.c
@@ -479,7 +479,8 @@ static int cy8c9540a_irq_setup(struct cy8c9540a *dev)
 	}
 
 	ret = request_threaded_irq(client->irq, NULL, cy8c9540a_irq_handler,
-				   IRQF_TRIGGER_FALLING | IRQF_ONESHOT,
+				   IRQF_TRIGGER_FALLING | IRQF_ONESHOT |
+				   IRQF_SHARED,
 				   dev_name(&client->dev), dev);
 	if (ret) {
 		dev_err(&client->dev, "failed to request irq %d\n",
-- 
1.7.5.4

