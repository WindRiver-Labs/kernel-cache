From 08550ea27cff8b2499c40bd45f912f0506a0da13 Mon Sep 17 00:00:00 2001
From: Lans Zhang <jia.zhang@windriver.com>
Date: Mon, 28 Apr 2014 15:31:14 +0800
Subject: [PATCH] Fix build error if UIO=m.

Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
---
 drivers/base/Makefile |    2 +-
 drivers/base/uio.c    |    5 +++++
 drivers/uio/uio.c     |    2 --
 3 files changed, 6 insertions(+), 3 deletions(-)
 create mode 100644 drivers/base/uio.c

diff --git a/drivers/base/Makefile b/drivers/base/Makefile
index 5aa2d70..cd92958 100644
--- a/drivers/base/Makefile
+++ b/drivers/base/Makefile
@@ -4,7 +4,7 @@ obj-y			:= core.o bus.o dd.o syscore.o \
 			   driver.o class.o platform.o \
 			   cpu.o firmware.o init.o map.o devres.o \
 			   attribute_container.o transport_class.o \
-			   topology.o
+			   topology.o uio.o
 obj-$(CONFIG_DEVTMPFS)	+= devtmpfs.o
 obj-$(CONFIG_CMA) += dma-contiguous.o
 obj-y			+= power/
diff --git a/drivers/base/uio.c b/drivers/base/uio.c
new file mode 100644
index 0000000..65330c3
--- /dev/null
+++ b/drivers/base/uio.c
@@ -0,0 +1,5 @@
+#include <linux/module.h>
+
+int uio_initialized;
+
+EXPORT_SYMBOL(uio_initialized);
diff --git a/drivers/uio/uio.c b/drivers/uio/uio.c
index 50e4ca1..45db2aa 100644
--- a/drivers/uio/uio.c
+++ b/drivers/uio/uio.c
@@ -26,8 +26,6 @@
 #include <linux/cdev.h>
 #include <linux/uio_driver.h>
 
-int uio_initialized;
-
 #define UIO_MAX_DEVICES		(1U << MINORBITS)
 
 struct uio_device {
-- 
1.7.5.4

