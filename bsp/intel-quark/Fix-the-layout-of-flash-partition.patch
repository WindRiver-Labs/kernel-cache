From efb9faf6c4a2d08b359aa8180ccdb15d72409274 Mon Sep 17 00:00:00 2001
From: Pengyu Ma <pengyu.ma@windriver.com>
Date: Mon, 11 May 2015 17:33:18 +0800
Subject: [PATCH 1/9] Fix the layout of flash partition

The setting of partition table should align to layout.conf defined by
spi-layout-tools.

Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
Signed-off-by: Pengyu Ma <pengyu.ma@windriver.com>
---
 .../x86/intel-quark/intel_quark_platform_galileo.c |   10 +++++-----
 .../intel_quark_platform_galileo_gen2.c            |   10 +++++-----
 2 files changed, 10 insertions(+), 10 deletions(-)

diff --git a/drivers/platform/x86/intel-quark/intel_quark_platform_galileo.c b/drivers/platform/x86/intel-quark/intel_quark_platform_galileo.c
index 2228ca9..b97e8a8 100644
--- a/drivers/platform/x86/intel-quark/intel_quark_platform_galileo.c
+++ b/drivers/platform/x86/intel-quark/intel_quark_platform_galileo.c
@@ -168,23 +168,23 @@ static struct pxa2xx_spi_chip qrk_ffrd_spi_1_cs_0 = {
 struct mtd_partition ilb_partitions[] = {
 	{
 		.name		= "grub",
-		.size		= 4096,
+		.size		= 0x80000,
 		.offset		= 0,
 	},
 	{
 		.name		= "grub.conf",
-		.size		= 0xA00,
-		.offset		= 0x50500,
+		.size		= 4096,
+		.offset		= 0x4FE000,
 	},
 	{
 		.name		= "layout.conf",
 		.size		= 4096,
-		.offset		= 0x708000,
+		.offset		= 0x4FF000,
 	},
 	{
 		.name		= "sketch",
 		.size		= 0x40000,
-		.offset		= 0x750000,
+		.offset		= 0x100000,
 	},
 	{
 		.name		= "raw",
diff --git a/drivers/platform/x86/intel-quark/intel_quark_platform_galileo_gen2.c b/drivers/platform/x86/intel-quark/intel_quark_platform_galileo_gen2.c
index 5aa0ce3..a6a35bf 100644
--- a/drivers/platform/x86/intel-quark/intel_quark_platform_galileo_gen2.c
+++ b/drivers/platform/x86/intel-quark/intel_quark_platform_galileo_gen2.c
@@ -157,23 +157,23 @@ static struct pxa2xx_spi_chip qrk_ffrd_spi_1_cs_0 = {
 struct mtd_partition galileo_gen2_ilb_partitions[] = {
 	{
 		.name		= "grub",
-		.size		= 4096,
+		.size		= 0x80000,
 		.offset		= 0,
 	},
 	{
 		.name		= "grub.conf",
-		.size		= 0xA00,
-		.offset		= 0x50500,
+		.size		= 4096,
+		.offset		= 0x4FE000,
 	},
 	{
 		.name		= "layout.conf",
 		.size		= 4096,
-		.offset		= 0x708000,
+		.offset		= 0x4FF000,
 	},
 	{
 		.name		= "sketch",
 		.size		= 0x40000,
-		.offset		= 0x750000,
+		.offset		= 0x100000,
 	},
 	{
 		.name		= "raw",
-- 
1.7.5.4

