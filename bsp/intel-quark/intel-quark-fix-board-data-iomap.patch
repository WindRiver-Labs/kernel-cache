From b104451c91be2d6deba2729bb741830368903a55 Mon Sep 17 00:00:00 2001
From: Lans Zhang <jia.zhang@windriver.com>
Date: Thu, 23 Jan 2014 13:06:51 +0800
Subject: [PATCH 6/8] intel-quark: fix board-data iomap.

The failure of ioremap() -> no cln-plat -> cannot get platform id item
within mfh -> intel_cln_plat_get_id() returns CLANTON_PLAT_UNDEFINED ->
stmmac driver cannot be initialized properly.

To fix this issue from root, be aware of using a proper value of mapped
area determined by the maximum size of MFH and platform data area,
which cannot conflict with other MFH items.

Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
---
 drivers/platform/x86/quark/intel_cln_board_data.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/platform/x86/quark/intel_cln_board_data.c b/drivers/platform/x86/quark/intel_cln_board_data.c
index 3888e3e..ecbeb31 100644
--- a/drivers/platform/x86/quark/intel_cln_board_data.c
+++ b/drivers/platform/x86/quark/intel_cln_board_data.c
@@ -43,7 +43,7 @@
 #define MTD_PART_LEN				0x00040000
 #define MFH_PADDING				0x1E8
 #define MFH_MAGIC				0x5F4D4648
-#define FLASH_SIZE				0x00400000
+#define FLASH_SIZE				(PLATFORM_DATA_OFFSET + 0x1000)
 
 /* MFH types supported @ version #1 */
 #define MFH_ITEM_FW_STAGE1			0x00000000
-- 
1.7.5.4

