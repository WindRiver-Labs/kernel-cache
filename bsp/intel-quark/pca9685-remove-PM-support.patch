From 033261d72b442c10b642af82fa799f7951756c39 Mon Sep 17 00:00:00 2001
From: Lans Zhang <jia.zhang@windriver.com>
Date: Fri, 27 Feb 2015 17:00:58 +0800
Subject: [PATCH 2/2] pca9685: remove PM support

source: intel quark BSP 1.1.0 vendor drop

Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
---
 drivers/mfd/pca9685-core.c |   67 --------------------------------------------
 1 files changed, 0 insertions(+), 67 deletions(-)

diff --git a/drivers/mfd/pca9685-core.c b/drivers/mfd/pca9685-core.c
index 0fd5881..a5960ec 100644
--- a/drivers/mfd/pca9685-core.c
+++ b/drivers/mfd/pca9685-core.c
@@ -242,72 +242,6 @@ static int pca9685_remove(struct i2c_client *client)
 	return ret;
 }
 
-#ifdef CONFIG_PM
-
-/**
- * pca9685_suspend - suspend PM callback
- * @dev - pointer to device
- * Returns 0 if success, negative value otherwhise.
- *
- * Put the register map into cache only mode, mark the register cache as
- * dirty and save the state of volatile registers (MODE1).
- */
-static int pca9685_suspend(struct device *dev)
-{
-	int ret = 0;
-	struct i2c_client *i2c = container_of(dev, struct i2c_client, dev);
-	struct pca9685 *pca = i2c_get_clientdata(i2c);
-
-	/* Save state of MODE1 register which is marked as volatile */
-	ret = regmap_read(pca->regmap, PCA9685_MODE1, &pca->reg_mode1);
-	if (ret < 0)
-		dev_err(&i2c->dev, "Error saving MODE1 register: %d\n", ret);
-	regcache_cache_only(pca->regmap, true);
-	regcache_mark_dirty(pca->regmap);
-	return ret;
-}
-
-/**
- * pca9685_resume - resume PM callback
- * @dev - pointer to device
- * Returns 0 if success, negative value otherwhise.
- *
- * Sync the register cache with the hardware and restore MODE2 register.
- */
-static int pca9685_resume(struct device *dev)
-{
-	struct i2c_client *i2c = container_of(dev, struct i2c_client, dev);
-	struct pca9685 *pca = i2c_get_clientdata(i2c);
-	int ret;
-
-	ret = regcache_sync(pca->regmap);
-	if (ret) {
-		dev_err(&i2c->dev,
-			"Failed to sync the register cache with the hw: %d\n",
-			ret);
-		goto err;
-	}
-	regcache_cache_only(pca->regmap, false);
-	/* Restore the MODE1 volatile register */
-	ret = regmap_write(pca->regmap, PCA9685_MODE1, pca->reg_mode1);
-	if (ret) {
-		dev_err(&i2c->dev, "Error restoring MODE1 register: %d\n",
-				ret);
-	}
-err:
-	return ret;
-}
-#else /* !CONFIG_PM */
-
-#define pca9685_suspend	NULL
-#define pca9685_resume	NULL
-
-#endif /* CONFIG_PM */
-const struct dev_pm_ops pca9685_pm_ops = {
-	.suspend	= pca9685_suspend,
-	.resume		= pca9685_resume,
-};
-
 static const struct i2c_device_id pca9685_id[] = {
 	{ "pca9685", 0 },
 	{ /* sentinel */ },
@@ -318,7 +252,6 @@ static struct i2c_driver pca9685_i2c_driver = {
 	.driver = {
 		.name	= "mfd-pca9685",
 		.owner	= THIS_MODULE,
-		.pm	= &pca9685_pm_ops,
 	},
 	.probe     = pca9685_probe,
 	.remove    = pca9685_remove,
-- 
1.7.5.4

