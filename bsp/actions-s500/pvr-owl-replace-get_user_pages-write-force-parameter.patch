From 6355a82d687ad004564c5462e90d02121ea78451 Mon Sep 17 00:00:00 2001
From: Li Zhou <li.zhou@windriver.com>
Date: Tue, 15 Jan 2019 10:28:01 +0800
Subject: [PATCH] pvr&owl: replace get_user_pages() write/force parameters
 with gup_flags

Replace get_user_pages() write/force parameters with gup_flags
in pvr and owl codes, because the parameters of get_user_pages
function have been changed as below:
-		    int write, int force, struct page **pages,
+		    unsigned int gup_flags, struct page **pages,

Here do the modification referring to the earlier commit:
<mm: replace get_user_pages() write/force parameters with gup_flags>

Signed-off-by: Li Zhou <li.zhou@windriver.com>
---
 .../eurasia_km/services4/srvkm/env/linux/osfunc.c  |    2 +-
 .../services4/srvkm/env/linux/osfunc.c             |    2 +-
 drivers/video/fbdev/owl/dss/mmu.c                  |    2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/gpu/pvr/eurasia_km/services4/srvkm/env/linux/osfunc.c b/drivers/gpu/pvr/eurasia_km/services4/srvkm/env/linux/osfunc.c
index a74bce4..ad22fe4 100755
--- a/drivers/gpu/pvr/eurasia_km/services4/srvkm/env/linux/osfunc.c
+++ b/drivers/gpu/pvr/eurasia_km/services4/srvkm/env/linux/osfunc.c
@@ -3609,7 +3609,7 @@ PVRSRV_ERROR OSAcquirePhysPageAddr(IMG_VOID *pvCPUVAddr,
     bMMapSemHeld = IMG_TRUE;
 
     /* Get page list */
-    psInfo->iNumPagesMapped = get_user_pages(current, current->mm, uStartAddr, psInfo->iNumPages, 1, 0, psInfo->ppsPages, NULL);
+    psInfo->iNumPagesMapped = get_user_pages(current, current->mm, uStartAddr, psInfo->iNumPages, FOLL_WRITE, psInfo->ppsPages, NULL);
 
     if (psInfo->iNumPagesMapped >= 0)
     {
diff --git a/drivers/gpu/pvr/eurasia_km_linux/services4/srvkm/env/linux/osfunc.c b/drivers/gpu/pvr/eurasia_km_linux/services4/srvkm/env/linux/osfunc.c
index c982fd4..314b858 100755
--- a/drivers/gpu/pvr/eurasia_km_linux/services4/srvkm/env/linux/osfunc.c
+++ b/drivers/gpu/pvr/eurasia_km_linux/services4/srvkm/env/linux/osfunc.c
@@ -3700,7 +3700,7 @@ PVRSRV_ERROR OSAcquirePhysPageAddr(IMG_VOID *pvCPUVAddr,
     bMMapSemHeld = IMG_TRUE;
 
     /* Get page list */
-    psInfo->iNumPagesMapped = get_user_pages(current, current->mm, uStartAddr, psInfo->iNumPages, 1, 0, psInfo->ppsPages, NULL);
+    psInfo->iNumPagesMapped = get_user_pages(current, current->mm, uStartAddr, psInfo->iNumPages, FOLL_WRITE, psInfo->ppsPages, NULL);
 
     if (psInfo->iNumPagesMapped >= 0)
     {
diff --git a/drivers/video/fbdev/owl/dss/mmu.c b/drivers/video/fbdev/owl/dss/mmu.c
index 49c352c..f8c410b 100755
--- a/drivers/video/fbdev/owl/dss/mmu.c
+++ b/drivers/video/fbdev/owl/dss/mmu.c
@@ -465,7 +465,7 @@ int mmu_va_to_da(u64 va, u32 length, u32 *da)
 	DSSDBG("start_addr 0x%llx, entry->pages 0x%p \n",
 		start_addr, entry->pages);
 	entry->num_pages_mapped = get_user_pages(current, current->mm, start_addr,
-				entry->num_pages, 1, 0, entry->pages, NULL);
+				entry->num_pages, FOLL_WRITE, entry->pages, NULL);
 	DSSDBG("mmu_va_to_da: map all the pages needed\
 		(wanted: %d, got %d) entry->addr %p \n",
 		entry->num_pages, entry->num_pages_mapped,entry->addr);
-- 
1.7.9.5

