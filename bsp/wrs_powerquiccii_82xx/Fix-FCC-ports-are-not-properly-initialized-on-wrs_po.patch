From c846a926fe9d305dd785d9eb32be79fec8b7d293 Mon Sep 17 00:00:00 2001
From: Xufeng Zhang <xufeng.zhang@windriver.com>
Date: Wed, 1 Jun 2011 15:54:32 +0800
Subject: [PATCH] Fix FCC ports are not properly initialized on wrs_powerquiccii_82xx

Some of I/O ports for FCC1 and FCC3 are not properly initialized,
so FCC1 and FCC3 are not working normally:
FCC1: Received nonoctet aligned frame sometimes.
FCC3: Cannot answer when ping from another machine.

Fix this problem by properly initialize I/O ports based on chip
Reference Manual.

Signed-off-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 arch/powerpc/platforms/82xx/sbcpq2.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/platforms/82xx/sbcpq2.c b/arch/powerpc/platforms/82xx/sbcpq2.c
index 470192b..faa9f85 100644
--- a/arch/powerpc/platforms/82xx/sbcpq2.c
+++ b/arch/powerpc/platforms/82xx/sbcpq2.c
@@ -125,6 +125,7 @@ static __initdata struct cpm_pin sbcpq2_pins[] = {
 	{0, 31, CPM_PIN_INPUT | CPM_PIN_SECONDARY},
 	{2, 21, CPM_PIN_INPUT | CPM_PIN_PRIMARY},
 	{2, 22, CPM_PIN_INPUT | CPM_PIN_PRIMARY},
+	{2, 23, CPM_PIN_INPUT | CPM_PIN_PRIMARY},
 
 	/*FCC2*/
 	{1, 18, CPM_PIN_INPUT | CPM_PIN_PRIMARY},
@@ -159,8 +160,8 @@ static __initdata struct cpm_pin sbcpq2_pins[] = {
 	{1, 15, CPM_PIN_OUTPUT | CPM_PIN_PRIMARY},
 	{1, 16, CPM_PIN_INPUT | CPM_PIN_PRIMARY},
 	{1, 17, CPM_PIN_INPUT | CPM_PIN_PRIMARY},
-	{2, 16, CPM_PIN_INPUT | CPM_PIN_SECONDARY},
-	{2, 17, CPM_PIN_INPUT | CPM_PIN_SECONDARY},
+	{2, 16, CPM_PIN_INPUT | CPM_PIN_PRIMARY},
+	{2, 17, CPM_PIN_INPUT | CPM_PIN_PRIMARY},
 
 
 	/* SCC1 */
-- 
1.7.0.4

