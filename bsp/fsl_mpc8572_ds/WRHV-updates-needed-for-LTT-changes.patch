From 5294ca69ed005e5d94786ba5b0c2aaf156f5fd81 Mon Sep 17 00:00:00 2001
From: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
Date: Sat, 5 Jun 2010 18:09:57 -0400
Subject: [PATCH] WRHV: updates needed for LTT changes

LTT has been changed.  We need to change too!

Signed-off-by: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
---
 arch/powerpc/kernel/vbi/wrhv.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/kernel/vbi/wrhv.c b/arch/powerpc/kernel/vbi/wrhv.c
index dbc8441..e09a3a9 100644
--- a/arch/powerpc/kernel/vbi/wrhv.c
+++ b/arch/powerpc/kernel/vbi/wrhv.c
@@ -108,6 +108,7 @@
 
 #include <linux/perf_event.h>
 #include <asm/trace.h>
+#include <trace/irq.h>
 #include <asm/ptrace.h>
 
 /* powerpc clocksource/clockevent code */
@@ -605,7 +606,7 @@ void wrhv_do_IRQ(struct pt_regs *regs)
 	struct pt_regs *old_regs = set_irq_regs(regs);
 	unsigned int irq;
 
-	trace_irq_entry(regs);
+	trace_irq_entry(0, regs, NULL);
 
 	irq_enter();
 
@@ -632,7 +633,7 @@ check_again:
 	}
 #endif
 
-	trace_irq_exit(regs);
+	trace_irq_exit(IRQ_HANDLED);
 }
 
 unsigned int wrhv_map_irq_of_desc(char *irq_name, int32_t irq_dir)
-- 
1.6.0.3

