From ca03bf14390b26f33e753076d994c9966b5ccff6 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Fri, 18 Nov 2011 14:01:58 +0800
Subject: [PATCH 29/41] drivers: ag71xx: fix error mii control read

ag71xx_mii_ctrl_rr is the leftover from uboot stuffs, so replace
it with ag71xx_rr, and add the related control constant in switch.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/net/ag71xx/ag71xx.h      |    2 +-
 drivers/net/ag71xx/ag71xx_main.c |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ag71xx/ag71xx.h b/drivers/net/ag71xx/ag71xx.h
index 97e5fb2..14709c8 100644
--- a/drivers/net/ag71xx/ag71xx.h
+++ b/drivers/net/ag71xx/ag71xx.h
@@ -347,7 +347,7 @@ static inline void ag71xx_check_reg_offset(struct ag71xx *ag, unsigned reg)
 	switch (reg) {
 	case AG71XX_REG_MAC_CFG1 ... AG71XX_REG_MAC_MFL:
 	case AG71XX_REG_MAC_IFCTL ... AG71XX_REG_TX_SM:
-	case AG71XX_REG_MII_CFG:
+	case AG71XX_REG_MII_CFG ... AG71XX_REG_MII_CTRL:
 		break;
 
 	default:
diff --git a/drivers/net/ag71xx/ag71xx_main.c b/drivers/net/ag71xx/ag71xx_main.c
index 3ebf4b1..1d4ec4f 100644
--- a/drivers/net/ag71xx/ag71xx_main.c
+++ b/drivers/net/ag71xx/ag71xx_main.c
@@ -610,7 +610,7 @@ void ag71xx_link_adjust(struct ag71xx *ag)
 		ag->dev->name,
 		ag71xx_rr(ag, AG71XX_REG_MAC_CFG2),
 		ag71xx_rr(ag, AG71XX_REG_MAC_IFCTL),
-		ag71xx_mii_ctrl_rr(ag));
+		ag71xx_rr(ag, AG71XX_REG_MII_CTRL));
 }
 
 static int ag71xx_open(struct net_device *dev)
-- 
1.7.4.1

