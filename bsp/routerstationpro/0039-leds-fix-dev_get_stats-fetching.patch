From 81e1d743e92507cf1aef7bfed5a7bb37253e7096 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Fri, 16 Dec 2011 10:26:04 +0800
Subject: [PATCH 39/41] leds: fix dev_get_stats fetching

commit "Updates leds support for ar71xx" introduced a compilation
issue when calling dev_get_stats.

We fix this by making the assigned variable non-constant and by
providing a temporary variable to the routine.

Signed-off-by:Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/leds/ledtrig-netdev.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/leds/ledtrig-netdev.c b/drivers/leds/ledtrig-netdev.c
index 6c56acb..f16c217 100644
--- a/drivers/leds/ledtrig-netdev.c
+++ b/drivers/leds/ledtrig-netdev.c
@@ -307,8 +307,9 @@ done:
 static void netdev_trig_timer(unsigned long arg)
 {
 	struct led_netdev_data *trigger_data = (struct led_netdev_data *)arg;
-	const struct net_device_stats *dev_stats;
+	struct rtnl_link_stats64 *dev_stats;
 	unsigned new_activity;
+	struct rtnl_link_stats64 temp;
 
 	write_lock(&trigger_data->lock);
 
@@ -318,7 +319,7 @@ static void netdev_trig_timer(unsigned long arg)
 		goto no_restart;
 	}
 
-	dev_stats = dev_get_stats(trigger_data->net_dev);
+	dev_stats = dev_get_stats(trigger_data->net_dev, &temp);
 	new_activity =
 		((trigger_data->mode & MODE_TX) ? dev_stats->tx_packets : 0) +
 		((trigger_data->mode & MODE_RX) ? dev_stats->rx_packets : 0);
-- 
1.7.4.1

