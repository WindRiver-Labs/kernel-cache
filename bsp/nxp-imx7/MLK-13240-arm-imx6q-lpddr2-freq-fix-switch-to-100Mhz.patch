From aec08734940d57e6829270fc7046a37ec1bb909c Mon Sep 17 00:00:00 2001
From: Adrian Alonso <adrian.alonso@nxp.com>
Date: Thu, 15 Sep 2016 15:49:41 -0500
Subject: [PATCH 84/85] MLK-13240: arm: imx6q: lpddr2 freq fix switch to
 100Mhz

Fix switch_to_100Mhz miss to store updated podf dividers
for system clocks running at 100Mhz (audio mode)

Signed-off-by: Adrian Alonso <adrian.alonso@nxp.com>
(Cherry picked from commit f54f8c9e1fbb0c937c3ad2e0867ccc2d4d50e77a)
[zou:Original patch taken from
git://git.freescale.com/imx/linux-imx.git imx_4.1.15_2.0.0_ga]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 arch/arm/mach-imx/lpddr2_freq_imx6q.S |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-imx/lpddr2_freq_imx6q.S b/arch/arm/mach-imx/lpddr2_freq_imx6q.S
index d0ccb98..d032742 100644
--- a/arch/arm/mach-imx/lpddr2_freq_imx6q.S
+++ b/arch/arm/mach-imx/lpddr2_freq_imx6q.S
@@ -68,6 +68,7 @@ skip_periph_clk_switch_400m:
 	bic	r9, r9, r6
 	orr	r9, r9, #(0x1F << 16)
 	orr	r9, r9, #(0x1D << 8)
+	str	r9, [r2, #CCM_CBCDR]
 
 	wait_for_ccm_handshake
 
-- 
1.7.5.4

