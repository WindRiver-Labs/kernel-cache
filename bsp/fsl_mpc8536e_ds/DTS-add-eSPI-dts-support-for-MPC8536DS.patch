From 4034b4498c28c7cbbece135ac6a942f684f1c5f9 Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Fri, 28 May 2010 15:07:27 +0800
Subject: [PATCH 2/8] DTS: add eSPI dts support for MPC8536DS

Extracted from MPC8536DS_20091124_ltib.iso vendor drop.

Add the SPI node and the partitions to DTS file

Signed-off-by: Mingkai Hu <Mingkai.hu@freescale.com>
Integrated-by: Andrew Liu <shengping.liu@windriver.com>
---
 arch/powerpc/boot/dts/mpc8536ds.dts |   53 +++++++++++++++++++++++++++++++++++
 1 files changed, 53 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/boot/dts/mpc8536ds.dts b/arch/powerpc/boot/dts/mpc8536ds.dts
index 815cebb..b78d332 100644
--- a/arch/powerpc/boot/dts/mpc8536ds.dts
+++ b/arch/powerpc/boot/dts/mpc8536ds.dts
@@ -108,6 +108,59 @@
 			};
 		};
 
+		spi@7000 {
+			cell-index = <0>;
+			#address-cells = <1>;
+			#size-cells = <0>;
+			compatible = "fsl,espi";
+			reg = <0x7000 0x1000>;
+			interrupts = <59 0x2>;
+			interrupt-parent = <&mpic>;
+			espi,num-ss-bits = <4>;
+			mode = "cpu";
+
+			fsl_m25p80@0 {
+				#address-cells = <1>;
+				#size-cells = <1>;
+				compatible = "fsl,espi-flash";
+				reg = <0>;
+				linux,modalias = "fsl_m25p80";
+				spi-max-frequency = <40000000>; /* input clock */
+				partition@u-boot-spi {
+					label = "u-boot-spi";
+					reg = <0x00000000 0x00100000>;
+					read-only;
+				};
+				partition@kernel {
+					label = "kernel-spi";
+					reg = <0x00100000 0x00500000>;
+				};
+				partition@dtb {
+					label = "dtb-spi";
+					reg = <0x00600000 0x00100000>;
+				};
+			};
+			fsl_m25p80@1 {
+				compatible = "fsl,espi-flash";
+				reg = <1>;
+				linux,modalias = "fsl_m25p80";
+				spi-max-frequency = <40000000>;
+			};
+			fsl_m25p80@2 {
+				compatible = "fsl,espi-flash";
+				reg = <2>;
+				linux,modalias = "fsl_m25p80";
+				spi-max-frequency = <40000000>;
+			};
+			fsl_m25p80@3 {
+				compatible = "fsl,espi-flash";
+				reg = <3>;
+				linux,modalias = "fsl_m25p80";
+				spi-max-frequency = <40000000>;
+			};
+		};
+
+
 		dma@21300 {
 			#address-cells = <1>;
 			#size-cells = <1>;
-- 
1.6.5.2

