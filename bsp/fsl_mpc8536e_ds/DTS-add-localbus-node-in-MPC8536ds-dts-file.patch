From 2ab088cd1838db00b3657543c0cc2f49abecf17a Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Mon, 24 May 2010 16:09:04 +0800
Subject: [PATCH 7/8] DTS: add localbus node in MPC8536ds dts file

Extracted part from MPC8536DS_20091124_ltib.iso and
ported part from MPC8572DS_20091221_ltib.iso endor drop

Add NAND flash partitions and board control FPGA node for mpc8536ds.
[ Adjusted to apply cleanly to the WRS kernel. Functionality unchanged. ]
Signed-off-by: Mingkai Hu <Mingkai.hu@freescale.com>
Integrated-by: Andrew Liu <shengping.liu@windriver.com>
---
 arch/powerpc/boot/dts/mpc8536ds.dts |   81 +++++++++++++++++++++++++++++++++++
 1 files changed, 81 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/boot/dts/mpc8536ds.dts b/arch/powerpc/boot/dts/mpc8536ds.dts
index b78d332..e9f64ff 100644
--- a/arch/powerpc/boot/dts/mpc8536ds.dts
+++ b/arch/powerpc/boot/dts/mpc8536ds.dts
@@ -45,6 +45,87 @@
 		reg = <0 0 0 0>;	// Filled by U-Boot
 	};
 
+	localbus@ffe05000 {
+		#address-cells = <2>;
+		#size-cells = <1>;
+		compatible = "fsl,mpc8536-elbc", "fsl,elbc", "simple-bus";
+		reg = <0 0xffe05000 0 0x1000>;
+		interrupts = <19 2>;
+		interrupt-parent = <&mpic>;
+
+		ranges = <0x0 0x0 0x0 0xe8000000 0x08000000
+			  0x1 0x0 0x0 0xe8000000 0x08000000
+			  0x2 0x0 0x0 0xffa00000 0x00040000
+			  0x3 0x0 0x0 0xffdf0000 0x00008000
+			  0x4 0x0 0x0 0xffa40000 0x00040000
+			  0x5 0x0 0x0 0xffa80000 0x00040000
+			  0x6 0x0 0x0 0xffac0000 0x00040000>;
+
+		nand@2,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
+			compatible = "fsl,mpc8536-fcm-nand",
+				     "fsl,elbc-fcm-nand";
+			reg = <0x2 0x0 0x40000>;
+
+			partition@u-boot {
+				reg = <0x0 0x02000000>;
+				label = "u-boot-nand";
+				read-only;
+			};
+
+			partition@jffs2 {
+				reg = <0x02000000 0x10000000>;
+				label = "jffs2-nand";
+			};
+
+			partition@ramdisk {
+				reg = <0x12000000 0x08000000>;
+				label = "ramdisk-nand";
+				read-only;
+			};
+
+			partition@kernel {
+				reg = <0x1a000000 0x04000000>;
+				label = "kernel-nand";
+			};
+
+			partition@dtb {
+				reg = <0x1e000000 0x01000000>;
+				label = "dtb-nand";
+				read-only;
+			};
+
+			partition@empty {
+				reg = <0x1f000000 0x21000000>;
+				label = "empty-nand";
+			};
+		};
+		
+		nand@4,0 {
+			compatible = "fsl,mpc8572-fcm-nand",
+				     "fsl,elbc-fcm-nand";
+			reg = <0x4 0x0 0x40000>;
+		};
+
+		nand@5,0 {
+			compatible = "fsl,mpc8572-fcm-nand",
+				     "fsl,elbc-fcm-nand";
+			reg = <0x5 0x0 0x40000>;
+		};
+
+		nand@6,0 {
+			compatible = "fsl,mpc8572-fcm-nand",
+				     "fsl,elbc-fcm-nand";
+			reg = <0x6 0x0 0x40000>;
+		};
+	
+		board-control@3,0 {
+			compatible = "fsl,mpc8536ds-fpga-pixis";
+			reg = <0x3 0x0 0x8000>;
+		};
+	};
+
 	soc@ffe00000 {
 		#address-cells = <1>;
 		#size-cells = <1>;
-- 
1.6.5.2

