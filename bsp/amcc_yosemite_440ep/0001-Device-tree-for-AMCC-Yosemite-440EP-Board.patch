From 0ab466adc21fe73cbae9ebf6a7373cd02302607e Mon Sep 17 00:00:00 2001
From: Thomas Tai <Thomas.Tai@windriver.com>
Date: Wed, 10 Sep 2008 09:54:45 -0400
Subject: [PATCH] Device tree for AMCC Yosemite 440EP Board

Added MTD map for AMCC Yosemite 440EP Board, changed
serial port baudrate to match u-boot baudrate and
added index number for I2C initialization.

Signed-off-by: Thomas Tai <Thomas.Tai@windriver.com>
---
 arch/powerpc/boot/dts/yosemite.dts |   26 +++++++++++++++++++++++++-
 1 files changed, 25 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/boot/dts/yosemite.dts b/arch/powerpc/boot/dts/yosemite.dts
index e39422a..00613fa 100644
--- a/arch/powerpc/boot/dts/yosemite.dts
+++ b/arch/powerpc/boot/dts/yosemite.dts
@@ -138,6 +138,27 @@
 				clock-frequency = <0>; /* Filled in by zImage */
 				interrupts = <0x5 0x1>;
 				interrupt-parent = <&UIC1>;
+
+				flash@fc000000 {
+					compatible = "cfi-flash";
+					reg = <0x00000000 0xfc000000 0x02000000>;
+					bank-width = <2>;
+					#address-cells = <1>;
+					#size-cells = <1>;
+					partition@0 {
+						label = "bootloader";
+						reg = <0x00000000 0x00080000>; /* two 256KiB sectors */
+					};
+					partition@1 {
+						label = "kernel";
+						reg = <0x00080000 0x00200000>; /* 2 MiB */
+					};
+					partition@2 {
+						label = "rootfs";
+						reg = <0x00280000 0x1D80000>; /* 29.5 MiB */
+					};
+				};
+
 			};
 
 			UART0: serial@ef600300 {
@@ -146,7 +167,7 @@
 				reg = <0xef600300 0x00000008>;
 				virtual-reg = <0xef600300>;
 				clock-frequency = <0>; /* Filled in by zImage */
-				current-speed = <115200>;
+				current-speed = <9600>;
 				interrupt-parent = <&UIC0>;
 				interrupts = <0x0 0x4>;
 			};
@@ -191,6 +212,7 @@
 				reg = <0xef600700 0x00000014>;
 				interrupt-parent = <&UIC0>;
 				interrupts = <0x2 0x4>;
+				index=<0>;
 			};
 
 			IIC1: i2c@ef600800 {
@@ -198,6 +220,7 @@
 				reg = <0xef600800 0x00000014>;
 				interrupt-parent = <&UIC0>;
 				interrupts = <0x7 0x4>;
+				index=<1>;
 			};
 
 			spi@ef600900 {
@@ -303,4 +326,5 @@
 	chosen {
 		linux,stdout-path = "/plb/opb/serial@ef600300";
 	};
+
 };
-- 
1.5.5.1

