From 954545cbe0ff5268d737452df81dae0de5167f95 Mon Sep 17 00:00:00 2001
From: Bin Jiang <bin.jiang@windriver.com>
Date: Thu, 23 May 2013 10:38:12 +0800
Subject: [PATCH 1/2] NET: octeon-ethernet: Disable two features for
 CONFIG_CAVIUM_RESERVE32

Source: Cavium SDK 2.3-427

Disable USE_SKBUFFS_IN_HW and REUSE_SKBUFFS_WITHOUT_FREE, since they
make 32bit userspace application fail to run.

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 drivers/net/ethernet/octeon/ethernet-defines.h |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/octeon/ethernet-defines.h b/drivers/net/ethernet/octeon/ethernet-defines.h
index 4a62bb1..eda9755 100644
--- a/drivers/net/ethernet/octeon/ethernet-defines.h
+++ b/drivers/net/ethernet/octeon/ethernet-defines.h
@@ -77,16 +77,17 @@
 
 #if CONFIG_CAVIUM_RESERVE32 > 0
 #define USE_32BIT_SHARED	1
+#define USE_SKBUFFS_IN_HW           0
+#define REUSE_SKBUFFS_WITHOUT_FREE  0
 #else
 #define USE_32BIT_SHARED	0
-#endif
-
 #define USE_SKBUFFS_IN_HW           1
 #ifdef CONFIG_NETFILTER
 #define REUSE_SKBUFFS_WITHOUT_FREE  0
 #else
 #define REUSE_SKBUFFS_WITHOUT_FREE  1
 #endif
+#endif
 
 #define USE_HW_TCPUDP_CHECKSUM      1
 
-- 
1.7.5.4

