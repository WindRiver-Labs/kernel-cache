From b912e89c31a3954a0b5c1039750154fa283b7060 Mon Sep 17 00:00:00 2001
From: Guoqing Jiang <Guoqing.Jiang@windriver.com>
Date: Thu, 10 Jan 2013 10:13:12 +0800
Subject: [PATCH 10/23] fsl_imx53: add pmu device support for mx53 chip

PMU resource is different between mx6 and mx53, so add mx53
related pmu device support.

Signed-off-by: Guoqing Jiang <Guoqing.Jiang@windriver.com>
---
 arch/arm/plat-mxc/devices/platform-imx-pmu.c |   20 +++++++++++++++++++-
 1 file changed, 19 insertions(+), 1 deletion(-)

diff --git a/arch/arm/plat-mxc/devices/platform-imx-pmu.c b/arch/arm/plat-mxc/devices/platform-imx-pmu.c
index cf29415..7c5b897 100644
--- a/arch/arm/plat-mxc/devices/platform-imx-pmu.c
+++ b/arch/arm/plat-mxc/devices/platform-imx-pmu.c
@@ -23,6 +23,21 @@
 #include <mach/devices-common.h>
 #include <asm/pmu.h>
 
+static struct resource mx53_pmu_resources[] = {
+	[0] = {
+		.start	= MX53_INT_PMU,
+		.end	= MX53_INT_PMU,
+		.flags	= IORESOURCE_IRQ,
+	},
+};
+
+struct platform_device mx53_pmu_device = {
+	.name		= "arm-pmu",
+	.id		= ARM_PMU_DEVICE_CPU,
+	.num_resources	= ARRAY_SIZE(mx53_pmu_resources),
+	.resource	= mx53_pmu_resources,
+};
+
 static struct resource mx6_pmu_resources[] = {
 	[0] = {
 		.start	= MXC_INT_CHEETAH_PERFORM,
@@ -40,5 +55,8 @@ struct platform_device mx6_pmu_device = {
 
 void __init imx_add_imx_armpmu()
 {
-	platform_device_register(&mx6_pmu_device);
+	if (cpu_is_mx6())
+		platform_device_register(&mx6_pmu_device);
+	else if (cpu_is_mx53())
+		platform_device_register(&mx53_pmu_device);
 }
-- 
1.7.9.7

