From 31403bfec7859712aa3258ec6ea102cf8b7b3884 Mon Sep 17 00:00:00 2001
From: Wang Hui <Hui.Wang@windriver.com>
Date: Wed, 27 May 2009 09:58:42 +0800
Subject: [PATCH 63/77] imx27_dma: increase CONSISTENT_DMA_SIZE for camera use

For arm architecture, The CONSISTENT_DMA_SIZE is defined
conditionally. If the machiche level does not define it, the arch
level will define it as the default size(SZ_2M). But On imx27ads
board, a lot of hardware like usb, mmc/sd, camera interface
will use dma. When all these hardware work together,the default
dma_size(SZ_2M) isn't enough. So we must define a
machine-specific consistent_dma_size in the header file.

Signed-off-by: Wang Hui <Hui.Wang@windriver.com>
---
 arch/arm/plat-mxc/include/mach/board-mx27ads.h |    3 +++
 arch/arm/plat-mxc/include/mach/hardware.h      |    3 +++
 2 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/arch/arm/plat-mxc/include/mach/board-mx27ads.h b/arch/arm/plat-mxc/include/mach/board-mx27ads.h
index 61e66da..178d2b5 100644
--- a/arch/arm/plat-mxc/include/mach/board-mx27ads.h
+++ b/arch/arm/plat-mxc/include/mach/board-mx27ads.h
@@ -49,6 +49,9 @@
  * PBC Controller parameters
  */
 
+/* Size of contiguous memory for DMA and other h/w blocks */
+#define CONSISTENT_DMA_SIZE     (14<<20)
+
 /*
  * Base address of PBC controller, CS4
  */
diff --git a/arch/arm/plat-mxc/include/mach/hardware.h b/arch/arm/plat-mxc/include/mach/hardware.h
index 3c0164d..802f06f 100644
--- a/arch/arm/plat-mxc/include/mach/hardware.h
+++ b/arch/arm/plat-mxc/include/mach/hardware.h
@@ -58,6 +58,9 @@
 #ifdef CONFIG_ARCH_MX2
 # ifdef CONFIG_MACH_MX27
 #  include <mach/mx27.h>
+#  ifdef CONFIG_MACH_MX27ADS
+#   include <mach/board-mx27ads.h>
+#  endif
 # endif
 #endif
 
-- 
1.6.3.1

