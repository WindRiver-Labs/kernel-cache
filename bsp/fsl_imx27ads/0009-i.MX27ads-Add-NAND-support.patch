From d9902a4a1fe4570fcb8183e0c80a183a6d83de37 Mon Sep 17 00:00:00 2001
From: Alexander Smirnov <asmirnov@embeddedalley.com>
Date: Mon, 29 Dec 2008 18:23:15 +0300
Subject: [PATCH] i.MX27ads: Add NAND support

Add NAND support

Signed-off-by: Alexander Smirnov <asmirnov@embeddedalley.com>
---
 arch/arm/mach-mx2/mx27ads.c |   11 +++++++++++
 1 files changed, 11 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-mx2/mx27ads.c b/arch/arm/mach-mx2/mx27ads.c
index 36c472b..70d17aa 100644
--- a/arch/arm/mach-mx2/mx27ads.c
+++ b/arch/arm/mach-mx2/mx27ads.c
@@ -36,6 +36,7 @@
 #include <mach/imx-uart.h>
 #include <mach/iomux-mx1-mx2.h>
 #include <mach/board-mx27ads.h>
+#include <mach/mxc_nand.h>
 
 #include "devices.h"
 
@@ -101,6 +102,13 @@ static struct platform_device mx27ads_nor_mtd_device = {
 	.resource = &mxc_flash_resource,
 };
 
+#ifdef CONFIG_MTD_NAND
+static struct mxc_nand_platform_data mx27ads_nand_board_info = {
+	.width = 1,
+	.hw_ecc = 1,
+};
+#endif
+
 #if defined(CONFIG_CS89x0) || defined(CONFIG_CS89x0_MODULE)
 /*! Null terminated portlist used to probe for the CS8900A device on ISA Bus
  * Add 3 to reset the page window before probing (fixes eth probe when deployed
@@ -420,6 +428,9 @@ static void __init mx27ads_board_init(void)
 	mxc_register_device(&mxc_uart_device3, &uart_pdata[3]);
 	mxc_register_device(&mxc_uart_device4, &uart_pdata[4]);
 	mxc_register_device(&mxc_uart_device5, &uart_pdata[5]);
+#ifdef CONFIG_MTD_NAND
+	mxc_register_device(&mxc_nand_device, &mx27ads_nand_board_info);
+#endif
 
 	platform_add_devices(platform_devices, ARRAY_SIZE(platform_devices));
 }
-- 
1.6.0.3

