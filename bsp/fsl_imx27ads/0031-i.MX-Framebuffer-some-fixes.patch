From 75b075619c9f57863582a96a0ed083109dc5362b Mon Sep 17 00:00:00 2001
From: Alexander Smirnov <asmirnov@embeddedalley.com>
Date: Mon, 29 Dec 2008 19:07:48 +0300
Subject: [PATCH] i.MX Framebuffer: some fixes

i.MX Framebuffer: some fixes

Signed-off-by: Alexander Smirnov <asmirnov@embeddedalley.com>
---
 drivers/video/imxfb.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/drivers/video/imxfb.c b/drivers/video/imxfb.c
index 03df41b..1a1cbca 100644
--- a/drivers/video/imxfb.c
+++ b/drivers/video/imxfb.c
@@ -401,6 +401,9 @@ static void imxfb_disable_controller(struct imxfb_info *fbi)
 	struct imx_fb_platform_data *pdata = fbi->pdev->dev.platform_data;
 	int ret;
 
+	if (!fbi->enabled)
+		return;
+
 	if (pdata->backlight_power)
 		pdata->backlight_power(0);
 	if (pdata->lcd_power)
@@ -415,6 +418,8 @@ static void imxfb_disable_controller(struct imxfb_info *fbi)
 		if (ret != 0)
 			pr_err("Failing to disable LCD pins\n");
 	}
+
+	fbi->enabled = 0;
 }
 
 static int imxfb_blank(int blank, struct fb_info *info)
-- 
1.6.0.3

