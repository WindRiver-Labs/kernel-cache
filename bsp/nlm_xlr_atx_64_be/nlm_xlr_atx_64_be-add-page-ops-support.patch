From 6f1662116e040172685ff8909086414fbea88862 Mon Sep 17 00:00:00 2001
From: Jack Tan <jack.tan@windriver.com>
Date: Wed, 19 May 2010 23:57:28 +0800
Subject: [PATCH 09/47] nlm_xlr_atx_64_be: add page ops support

Extracted from RMI SDK 1.7.0.

Add XLR's page operation support.

Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 arch/mips/include/asm/page.h |   11 +++++++++++
 1 files changed, 11 insertions(+), 0 deletions(-)

diff --git a/arch/mips/include/asm/page.h b/arch/mips/include/asm/page.h
index 300ea57..b263722 100644
--- a/arch/mips/include/asm/page.h
+++ b/arch/mips/include/asm/page.h
@@ -78,8 +78,19 @@ static inline void clear_user_page(void *addr, unsigned long vaddr,
 		flush_data_cache_page((unsigned long)addr);
 }
 
+#ifdef CONFIG_RMI_PHOENIX
+static inline void copy_user_page(void *vto, void *vfrom, unsigned long vaddr,
+		    struct page *to)
+{
+	extern void phoenix_flush_dcache_page(struct page *to);
+
+	copy_page(vto, vfrom);
+	phoenix_flush_dcache_page(to);
+}
+#else
 extern void copy_user_page(void *vto, void *vfrom, unsigned long vaddr,
 	struct page *to);
+#endif
 struct vm_area_struct;
 extern void copy_user_highpage(struct page *to, struct page *from,
 	unsigned long vaddr, struct vm_area_struct *vma);
-- 
1.7.0.4

