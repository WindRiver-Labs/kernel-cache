From 79f3a187ede05e888536674d512c2a89bdc1ab0f Mon Sep 17 00:00:00 2001
From: Yong Zhang <yong.zhang@windriver.com>
Date: Fri, 20 Jul 2012 16:06:27 +0800
Subject: [PATCH] crypro/rmi: fix wrong usage of kunmap_atomic()

kunmap_atomic() should get the return value of kmap_atomic,
not the page.

Otherwise, below warning shows:
drivers/crypto/rmi/rmisec.c: In function 'ecc_init':
drivers/crypto/rmi/rmisec.c:1707:
error: negative width in bit-field '<anonymous>'

Found by debug aid from stack based kmap_atomic/kunmap_atomic

Signed-off-by: Yong Zhang <yong.zhang@windriver.com>
---
 drivers/crypto/rmi/rmisec.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/crypto/rmi/rmisec.c b/drivers/crypto/rmi/rmisec.c
index 563d8d4..b2b4e40 100644
--- a/drivers/crypto/rmi/rmisec.c
+++ b/drivers/crypto/rmi/rmisec.c
@@ -1704,7 +1704,7 @@ static int ecc_init(void)
 	ecc = (unsigned char *) kmap_atomic(page, KM_USER0);
 	mem.ptr = ecc;
 	memcpy(ecc, ecc_uc_data, sizeof(ecc_uc_data));
-	kunmap_atomic(page, KM_USER0);
+	kunmap_atomic(ecc, KM_USER0);
 	local_irq_restore(flags);
 	ecc = NULL;
 
-- 
1.7.0

