From 49a753fe4d772bbf051ae94e1517cdffb4091f0d Mon Sep 17 00:00:00 2001
From: fli <fupan.li@windriver.com>
Date: Mon, 20 May 2013 15:42:38 +0800
Subject: [PATCH 1/8] Revert "Fix build error for Haswell hda."

This reverts commit 1da6083d681a145fdaa2f9fdf2e5210597f40fe4.

Signed-off-by: fupan li <fupan.li@windriver.com>
---
 sound/pci/hda/hda_local.h  |   47 --------------------------------------------
 sound/pci/hda/patch_hdmi.c |    3 ++
 2 files changed, 3 insertions(+), 47 deletions(-)

diff --git a/sound/pci/hda/hda_local.h b/sound/pci/hda/hda_local.h
index b4636c6..2491dd0 100644
--- a/sound/pci/hda/hda_local.h
+++ b/sound/pci/hda/hda_local.h
@@ -378,53 +378,6 @@ int snd_hda_add_new_ctls(struct hda_codec *codec,
 			 const struct snd_kcontrol_new *knew);
 
 /*
- *  * Fix-up pin default configurations and add default verbs
- *   */
-
-struct hda_pintbl {
-        hda_nid_t nid;
-        u32 val;
-};
-
-struct hda_model_fixup {
-        const int id;
-        const char *name;
-};
-
-struct hda_fixup {
-        int type;
-        bool chained:1;         /* call the chained fixup(s) after this */
-        bool chained_before:1;  /* call the chained fixup(s) before this */
-        int chain_id;
-        union {
-                const struct hda_pintbl *pins;
-                const struct hda_verb *verbs;
-                void (*func)(struct hda_codec *codec,
-                             const struct hda_fixup *fix,
-                             int action);
-        } v;
-};
-
-
-
-/* fixup types */
-enum {
-        HDA_FIXUP_INVALID,
-        HDA_FIXUP_PINS,
-        HDA_FIXUP_VERBS,
-        HDA_FIXUP_FUNC,
-        HDA_FIXUP_PINCTLS,
-};
-
-/* fixup action definitions */
-enum {
-        HDA_FIXUP_ACT_PRE_PROBE,
-        HDA_FIXUP_ACT_PROBE,
-        HDA_FIXUP_ACT_INIT,
-        HDA_FIXUP_ACT_BUILD,
-};
-
-/*
  * unsolicited event handler
  */
 
diff --git a/sound/pci/hda/patch_hdmi.c b/sound/pci/hda/patch_hdmi.c
index 376fc66..f04edee 100644
--- a/sound/pci/hda/patch_hdmi.c
+++ b/sound/pci/hda/patch_hdmi.c
@@ -1413,6 +1413,9 @@ static int patch_generic_hdmi(struct hda_codec *codec)
 
 	codec->spec = spec;
 
+	snd_hda_pick_fixup(codec, hdmi_models, hdmi_fixup_tbl, hdmi_fixups);
+	snd_hda_apply_fixup(codec, HDA_FIXUP_ACT_PRE_PROBE);
+
 	if (codec->vendor_id == 0x80862807)
 		intel_haswell_fixup_connect_list(codec);
 
-- 
1.7.5.4

