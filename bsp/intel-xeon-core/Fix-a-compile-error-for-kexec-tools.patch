From a813210bfce836305e033d3637d2efb47c934cc2 Mon Sep 17 00:00:00 2001
From: Xufeng Zhang <xufeng.zhang@windriver.com>
Date: Wed, 30 Apr 2014 10:33:18 +0800
Subject: [PATCH 2/2] Fix a compile error for kexec-tools

When compile kexec-tools on intel-xeon-core, below building
error happens:
In file included from bitbake_build/tmp/sysroots/intel-xeon-core/usr/include/linux/fb.h:5:0
	from kexec/arch/i386/x86-linux-setup.c:29:
bitbake_build/tmp/sysroots/intel-xeon-core/usr/include/linux/i2c.h:149:15: \
	error: missing binary operator before token "("

Signed-off-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 include/linux/i2c.h |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/include/linux/i2c.h b/include/linux/i2c.h
index 12bb474..f6e35de 100644
--- a/include/linux/i2c.h
+++ b/include/linux/i2c.h
@@ -618,10 +618,12 @@ union i2c_smbus_data {
 #define I2C_SMBUS_BLOCK_PROC_CALL   7		/* SMBus 2.0 */
 #define I2C_SMBUS_I2C_BLOCK_DATA    8
 
+#ifdef __KERNEL__
 #if IS_ENABLED(CONFIG_ACPI_I2C)
 extern void acpi_i2c_register_devices(struct i2c_adapter *adap);
 #else
 static inline void acpi_i2c_register_devices(struct i2c_adapter *adap) {}
 #endif
+#endif
 
 #endif /* _LINUX_I2C_H */
-- 
1.7.5.4

