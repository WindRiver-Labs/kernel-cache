From 9a2dd2cef9224a19dc0fd6b52dda50f4a0ffa330 Mon Sep 17 00:00:00 2001
From: Yunguo Wei <yunguo.wei@windriver.com>
Date: Wed, 15 May 2013 17:18:33 +0800
Subject: [PATCH] Fix build error for Haswell hda.

This is a temporary workround to make hda build on intel-xeon-core.

Signed-off-by: Yunguo Wei <yunguo.wei@windriver.com>
---
 sound/pci/hda/hda_local.h  |   47 ++++++++++++++++++++++++++++++++++++++++++++
 sound/pci/hda/patch_hdmi.c |    3 --
 2 files changed, 47 insertions(+), 3 deletions(-)

diff --git a/sound/pci/hda/hda_local.h b/sound/pci/hda/hda_local.h
index 2491dd0..b4636c6 100644
--- a/sound/pci/hda/hda_local.h
+++ b/sound/pci/hda/hda_local.h
@@ -378,6 +378,53 @@ int snd_hda_add_new_ctls(struct hda_codec *codec,
 			 const struct snd_kcontrol_new *knew);
 
 /*
+ *  * Fix-up pin default configurations and add default verbs
+ *   */
+
+struct hda_pintbl {
+        hda_nid_t nid;
+        u32 val;
+};
+
+struct hda_model_fixup {
+        const int id;
+        const char *name;
+};
+
+struct hda_fixup {
+        int type;
+        bool chained:1;         /* call the chained fixup(s) after this */
+        bool chained_before:1;  /* call the chained fixup(s) before this */
+        int chain_id;
+        union {
+                const struct hda_pintbl *pins;
+                const struct hda_verb *verbs;
+                void (*func)(struct hda_codec *codec,
+                             const struct hda_fixup *fix,
+                             int action);
+        } v;
+};
+
+
+
+/* fixup types */
+enum {
+        HDA_FIXUP_INVALID,
+        HDA_FIXUP_PINS,
+        HDA_FIXUP_VERBS,
+        HDA_FIXUP_FUNC,
+        HDA_FIXUP_PINCTLS,
+};
+
+/* fixup action definitions */
+enum {
+        HDA_FIXUP_ACT_PRE_PROBE,
+        HDA_FIXUP_ACT_PROBE,
+        HDA_FIXUP_ACT_INIT,
+        HDA_FIXUP_ACT_BUILD,
+};
+
+/*
  * unsolicited event handler
  */
 
diff --git a/sound/pci/hda/patch_hdmi.c b/sound/pci/hda/patch_hdmi.c
index f04edee..376fc66 100644
--- a/sound/pci/hda/patch_hdmi.c
+++ b/sound/pci/hda/patch_hdmi.c
@@ -1413,9 +1413,6 @@ static int patch_generic_hdmi(struct hda_codec *codec)
 
 	codec->spec = spec;
 
-	snd_hda_pick_fixup(codec, hdmi_models, hdmi_fixup_tbl, hdmi_fixups);
-	snd_hda_apply_fixup(codec, HDA_FIXUP_ACT_PRE_PROBE);
-
 	if (codec->vendor_id == 0x80862807)
 		intel_haswell_fixup_connect_list(codec);
 
-- 
1.7.5.4

