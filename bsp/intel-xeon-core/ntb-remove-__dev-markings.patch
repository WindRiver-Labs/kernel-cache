From 131de100e92648db5f98acac9a4e168c93bf2bc3 Mon Sep 17 00:00:00 2001
From: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Date: Thu, 17 Jan 2013 19:17:42 -0800
Subject: [PATCH 03/70] ntb: remove __dev* markings

Upstream: 8292ac21f35b94e9ce717bcd038dad92a42d8396

These are now gone from the kernel, so remove them from the newly-added
drivers before they start to cause build errors for people.

Cc: Jon Mason <jon.mason@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
Signed-off-by: Yunguo Wei <yunguo.wei@windriver.com>
---
 drivers/net/ntb_netdev.c    |    2 +-
 drivers/ntb/ntb_hw.c        |   16 +++++++---------
 drivers/ntb/ntb_transport.c |    4 ++--
 3 files changed, 10 insertions(+), 12 deletions(-)

diff --git a/drivers/net/ntb_netdev.c b/drivers/net/ntb_netdev.c
index af48a69..4e52fd2 100644
--- a/drivers/net/ntb_netdev.c
+++ b/drivers/net/ntb_netdev.c
@@ -323,7 +323,7 @@ static const struct ntb_queue_handlers ntb_netdev_handlers = {
 	.event_handler = ntb_netdev_event_handler,
 };
 
-static int __devinit ntb_netdev_probe(struct pci_dev *pdev)
+static int ntb_netdev_probe(struct pci_dev *pdev)
 {
 	struct net_device *ndev;
 	struct ntb_netdev *dev;
diff --git a/drivers/ntb/ntb_hw.c b/drivers/ntb/ntb_hw.c
index facad51..4c71b17 100644
--- a/drivers/ntb/ntb_hw.c
+++ b/drivers/ntb/ntb_hw.c
@@ -637,7 +637,7 @@ static int ntb_bwd_setup(struct ntb_device *ndev)
 	return 0;
 }
 
-static int __devinit ntb_device_setup(struct ntb_device *ndev)
+static int ntb_device_setup(struct ntb_device *ndev)
 {
 	int rc;
 
@@ -909,7 +909,7 @@ static int ntb_setup_intx(struct ntb_device *ndev)
 	return 0;
 }
 
-static int __devinit ntb_setup_interrupts(struct ntb_device *ndev)
+static int ntb_setup_interrupts(struct ntb_device *ndev)
 {
 	int rc;
 
@@ -943,7 +943,7 @@ done:
 	return 0;
 }
 
-static void __devexit ntb_free_interrupts(struct ntb_device *ndev)
+static void ntb_free_interrupts(struct ntb_device *ndev)
 {
 	struct pci_dev *pdev = ndev->pdev;
 
@@ -973,7 +973,7 @@ static void __devexit ntb_free_interrupts(struct ntb_device *ndev)
 	}
 }
 
-static int __devinit ntb_create_callbacks(struct ntb_device *ndev)
+static int ntb_create_callbacks(struct ntb_device *ndev)
 {
 	int i;
 
@@ -1006,9 +1006,7 @@ static void ntb_free_callbacks(struct ntb_device *ndev)
 	kfree(ndev->db_cb);
 }
 
-static int __devinit
-ntb_pci_probe(struct pci_dev *pdev,
-	      __attribute__((unused)) const struct pci_device_id *id)
+static int ntb_pci_probe(struct pci_dev *pdev, const struct pci_device_id *id)
 {
 	struct ntb_device *ndev;
 	int rc, i;
@@ -1122,7 +1120,7 @@ err:
 	return rc;
 }
 
-static void __devexit ntb_pci_remove(struct pci_dev *pdev)
+static void ntb_pci_remove(struct pci_dev *pdev)
 {
 	struct ntb_device *ndev = pci_get_drvdata(pdev);
 	int i;
@@ -1152,6 +1150,6 @@ static struct pci_driver ntb_pci_driver = {
 	.name = KBUILD_MODNAME,
 	.id_table = ntb_pci_tbl,
 	.probe = ntb_pci_probe,
-	.remove = __devexit_p(ntb_pci_remove),
+	.remove = ntb_pci_remove,
 };
 module_pci_driver(ntb_pci_driver);
diff --git a/drivers/ntb/ntb_transport.c b/drivers/ntb/ntb_transport.c
index c907e07..250190f 100644
--- a/drivers/ntb/ntb_transport.c
+++ b/drivers/ntb/ntb_transport.c
@@ -217,7 +217,7 @@ struct bus_type ntb_bus_type = {
 
 static LIST_HEAD(ntb_transport_list);
 
-static int __devinit ntb_bus_init(struct ntb_transport *nt)
+static int ntb_bus_init(struct ntb_transport *nt)
 {
 	if (list_empty(&ntb_transport_list)) {
 		int rc = bus_register(&ntb_bus_type);
@@ -230,7 +230,7 @@ static int __devinit ntb_bus_init(struct ntb_transport *nt)
 	return 0;
 }
 
-static void __devexit ntb_bus_remove(struct ntb_transport *nt)
+static void ntb_bus_remove(struct ntb_transport *nt)
 {
 	struct ntb_transport_client_dev *client_dev, *cd;
 
-- 
1.7.5.4

