From f0d646aa5cf0ffce7e13cd121735d9c6626009b2 Mon Sep 17 00:00:00 2001
From: Dave Jiang <dave.jiang@intel.com>
Date: Tue, 26 Mar 2013 13:54:39 -0700
Subject: [PATCH 64/70] bwd: only support dual-cast for multicast on BWD
 platform

This patch is provided by dave.jiang@intel.com via e-mail, and not
committed to mainline yet.

Software to warn when # of multicast destination is set beyond 2. This is
a hardware limitation on this platform.

Signed-off-by: Dave Jiang <dave.jiang@intel.com>
Signed-off-by: Yunguo Wei <yunguo.wei@windriver.com>
---
 drivers/dma/ioat/dma_v3.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/dma/ioat/dma_v3.c b/drivers/dma/ioat/dma_v3.c
index bfa3df4..cc12c16 100644
--- a/drivers/dma/ioat/dma_v3.c
+++ b/drivers/dma/ioat/dma_v3.c
@@ -859,6 +859,8 @@ ioat3_prep_mcast_lock(struct dma_chan *c, dma_addr_t *dma_dest,
 	if (dest_num < 1)
 		return NULL;
 
+	WARN_ONCE(dest_num > 2, "IOAT DMA multicast dests > 2, BWD limitation");
+
 	num_descs = ioat2_xferlen_to_descs(ioat, len);
 	if (num_descs && ioat2_check_space_lock(ioat, num_descs) == 0)
 		idx = ioat->head;
-- 
1.7.5.4

