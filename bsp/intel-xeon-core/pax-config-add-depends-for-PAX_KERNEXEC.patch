From 198bb11552102e0d469da642c40b179140132257 Mon Sep 17 00:00:00 2001
From: Thomas Tai <thomas.tai@windriver.com>
Date: Fri, 5 Apr 2013 14:36:45 -0400
Subject: [PATCH] pax config: add depends for PAX_KERNEXEC

kgdb test fails due to CONFIG_PAX_KERNEXEC is being
enabled, add a depend such that CONFIG_PAX_KERNEXEC will
not be enabled if CONFIG_KGDB_TESTS is enabled.

Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 security/Kconfig |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/security/Kconfig b/security/Kconfig
index 3d7ddf8..61725af 100644
--- a/security/Kconfig
+++ b/security/Kconfig
@@ -574,7 +574,7 @@ config PAX_DLRESOLVE
 config PAX_KERNEXEC
 	bool "Enforce non-executable kernel pages"
 	default y if GRKERNSEC_CONFIG_AUTO && (GRKERNSEC_CONFIG_VIRT_NONE || (GRKERNSEC_CONFIG_VIRT_EPT && GRKERNSEC_CONFIG_VIRT_GUEST) || (GRKERNSEC_CONFIG_VIRT_EPT && GRKERNSEC_CONFIG_VIRT_KVM))
-	depends on X86 && (!X86_32 || X86_WP_WORKS_OK) && !XEN
+	depends on X86 && (!X86_32 || X86_WP_WORKS_OK) && !XEN && !KGDB_TESTS
 	select PAX_PER_CPU_PGD if X86_64 || (X86_32 && X86_PAE)
 	select PAX_KERNEXEC_PLUGIN if X86_64
 	help
-- 
1.7.0

