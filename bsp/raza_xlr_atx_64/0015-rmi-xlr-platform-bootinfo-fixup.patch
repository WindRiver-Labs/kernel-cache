From 40126207e8bdeb95914d43c2ac8c1c26eb4e19c2 Mon Sep 17 00:00:00 2001
From: Jack Tan <jack.tan@windriver.com>
Date: Tue, 16 Dec 2008 19:07:08 +0800
Subject: [PATCH] rmi xlr platform bootinfo fixup

boot_mem_map structure need a modification in order to consistent with RMI's
bootloader. Because kernel get boot_mem_map data from bootloader by a pointer.

Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 include/asm-mips/bootinfo.h |   22 ++++++++++++++++++++--
 1 files changed, 20 insertions(+), 2 deletions(-)

diff --git a/include/asm-mips/bootinfo.h b/include/asm-mips/bootinfo.h
index 610fe3a..6db53b8 100644
--- a/include/asm-mips/bootinfo.h
+++ b/include/asm-mips/bootinfo.h
@@ -76,9 +76,19 @@ extern unsigned long mips_machtype;
 struct boot_mem_map {
 	int nr_map;
 	struct boot_mem_map_entry {
-		phys_t addr;	/* start of memory segment */
-		phys_t size;	/* size of memory segment */
+/*
+ * kernel get boot_mem_map from bootloader, so data structure
+ * need to consistent with bootloader.
+*/
+#ifdef CONFIG_RMI_PHOENIX
+		uint64_t addr;  /* start of memory segment */
+		uint64_t size;  /* size of memory segment */
+		uint32_t type;  /* type of memory segment */
+#else
+		phys_t addr;    /* start of memory segment */
+		phys_t size;    /* size of memory segment */
 		long type;		/* type of memory segment */
+#endif
 	} map[BOOT_MEM_MAP_MAX];
 };
 
@@ -107,4 +117,12 @@ extern unsigned long fw_arg0, fw_arg1, fw_arg2, fw_arg3;
  */
 extern void plat_mem_setup(void);
 
+#ifdef CONFIG_RMI_PHOENIX
+#define MAX_EXCLUDE 16
+struct boot_mem_map_exclude_region {
+    uint64_t start;
+    uint64_t end;
+};
+#endif
+
 #endif /* _ASM_BOOTINFO_H */
-- 
1.6.0.2.GIT

