From 4208276fa2b130ad72ff34703d7e381524a674a2 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Thu, 13 Dec 2012 15:19:54 +0800
Subject: [PATCH 145/169] arm: mxs: fix compiling errors

fix compiling errors for 3.4.x due to not implemented function.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-mxs/mach-mxs.c |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-mxs/mach-mxs.c b/arch/arm/mach-mxs/mach-mxs.c
index ce4fd2a..2d78482 100644
--- a/arch/arm/mach-mxs/mach-mxs.c
+++ b/arch/arm/mach-mxs/mach-mxs.c
@@ -152,6 +152,8 @@ static void __init update_fec_mac_prop(enum mac_oui oui)
 	int i;
 
 	for (i = 0; i < 2; i++) {
+		struct property *old;
+
 		np = of_find_compatible_node(from, NULL, "fsl,imx28-fec");
 		if (!np)
 			return;
@@ -191,7 +193,12 @@ static void __init update_fec_mac_prop(enum mac_oui oui)
 		macaddr[4] = (val >> 8) & 0xff;
 		macaddr[5] = (val >> 0) & 0xff;
 
-		prom_update_property(np, newmac);
+
+		old = of_find_property(np, newmac->name, NULL);
+		if (old)
+			prom_update_property(np, newmac, old);
+		else
+			prom_add_property(np, newmac);
 	}
 }
 
-- 
1.7.0

