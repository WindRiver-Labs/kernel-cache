From 0db8f0f58c6fe5065d1a2dd9903e2f02f0650cfe Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Tue, 7 Feb 2012 15:27:38 -0800
Subject: [PATCH 169/236] MIPS: Octeon: Change kernel load address for kexec

commit edd3b404f84317b95d08a01514bc59a809f300ab changed kernel load
address to 0x100000 from 0x1100000 for making more memory usable.
But, kexec tools assume the memory segment starts from 0x1000000, so
kexec tools can't load kernel image started from 0x100000.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/mips/Makefile |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/mips/Makefile b/arch/mips/Makefile
index 596eb44..a360942 100644
--- a/arch/mips/Makefile
+++ b/arch/mips/Makefile
@@ -688,9 +688,13 @@ else
 ifdef CONFIG_WRHV
 load-$(CONFIG_CPU_CAVIUM_OCTEON) 	+= 0xffffffffc0001000
 else
+ifdef CONFIG_KEXEC
+load-$(CONFIG_CPU_CAVIUM_OCTEON) 	+= 0xffffffff81100000
+else
 load-$(CONFIG_CPU_CAVIUM_OCTEON) 	+= 0xffffffff80100000
 endif
 endif
+endif
 
 ifdef CONFIG_PHYSICAL_START
 load-y				= $(CONFIG_PHYSICAL_START)
-- 
1.7.0

