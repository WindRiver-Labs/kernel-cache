From e205937d34d2a925f39a80fe92c2a852042f513b Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Wed, 15 Feb 2012 16:59:18 -0800
Subject: [PATCH 217/236] NET: octeon_mgmt: Increase TX IFG for broken switches.

Source: Cavium SDK 2.3-427

Signed-off-by: David Daney <david.daney@cavium.com>
Integrated-by: Jiang Bin <bin.jiang@windriver.com>
---
 drivers/net/octeon/octeon_mgmt.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/drivers/net/octeon/octeon_mgmt.c b/drivers/net/octeon/octeon_mgmt.c
index f444a80..0d75f73 100644
--- a/drivers/net/octeon/octeon_mgmt.c
+++ b/drivers/net/octeon/octeon_mgmt.c
@@ -1183,6 +1183,12 @@ static int octeon_mgmt_open(struct net_device *netdev)
 
 		/* For compensation state to lock. */
 		ndelay(1040 * NS_PER_PHY_CLK);
+
+		/*
+		 * Some Ethernet switches cannot handle standard
+		 * Interframe Gap, increase to 16 bytes.
+		 */
+		cvmx_write_csr(CVMX_AGL_GMX_TX_IFG, 0x88);
 	}
 
 	octeon_mgmt_rx_fill_ring(netdev);
-- 
1.7.0

