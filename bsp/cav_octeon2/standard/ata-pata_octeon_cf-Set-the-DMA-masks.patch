From 798492492f632ee3cf027390633f0c6a37a6cf2b Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Tue, 14 Feb 2012 10:00:17 -0800
Subject: [PATCH 225/236] ata: pata_octeon_cf: Set the DMA masks.

Source: Cavium SDK 2.3-427

The OCTEON DMA engines have 64-bit addressing. Communicate that fact
to the drivers so they don't use the SWIOTLB.

Signed-off-by: David Daney <david.daney@cavium.com>
Integrated-by: Jiang Bin <bin.jiang@windriver.com>
---
 drivers/ata/pata_octeon_cf.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/ata/pata_octeon_cf.c b/drivers/ata/pata_octeon_cf.c
index 81293a0..58f59f5 100644
--- a/drivers/ata/pata_octeon_cf.c
+++ b/drivers/ata/pata_octeon_cf.c
@@ -1040,6 +1040,9 @@ static int __devinit octeon_cf_probe(struct platform_device *pdev)
 	}
 	cf_port->c0 = ap->ioaddr.ctl_addr;
 
+	pdev->dev.coherent_dma_mask = DMA_BIT_MASK(64);
+	pdev->dev.dma_mask = &pdev->dev.coherent_dma_mask;
+
 	ata_port_desc(ap, "cmd %p ctl %p", base, ap->ioaddr.ctl_addr);
 
 
-- 
1.7.0

