From ca0a3d985e88c640da3374e24a670cf59d9ba023 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Wed, 31 Aug 2011 15:42:17 -0700
Subject: [PATCH 128/236] netdev: octeon-ethernet: Don't build ethernet-mem.c unless needed.

Source: Cavium SDK 2.2-414

Signed-off-by: David Daney <david.daney@cavium.com>
Integrated-by: Yang Shi <yang.shi@windriver.com>
---
 drivers/net/octeon/Makefile |   14 +++++++++++++-
 1 files changed, 13 insertions(+), 1 deletions(-)

diff --git a/drivers/net/octeon/Makefile b/drivers/net/octeon/Makefile
index cbafb3a..f008731 100644
--- a/drivers/net/octeon/Makefile
+++ b/drivers/net/octeon/Makefile
@@ -26,7 +26,19 @@ octeon-ethernet-objs += ethernet-spi.o
 octeon-ethernet-objs += ethernet-tx.o
 octeon-ethernet-objs += ethernet-xaui.o
 octeon-ethernet-objs += ethernet-proc.o
+
 ifdef CONFIG_RAPIDIO
 octeon-ethernet-objs += ethernet-srio.o
 endif
-obj-y += ethernet-mem.o
\ No newline at end of file
+
+ifdef CONFIG_CAVIUM_OCTEON_RAPIDIO
+need-ethernet-mem = 1
+endif
+
+ifdef CONFIG_OCTEON_ETHERNET
+need-ethernet-mem = 1
+endif
+
+ifdef need-ethernet-mem
+obj-y += ethernet-mem.o
+endif
\ No newline at end of file
-- 
1.7.0

