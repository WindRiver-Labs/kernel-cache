From 7f96874e8ab4dee38cefb1ac051d70dbc0f78e10 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Thu, 9 Feb 2012 13:58:52 -0800
Subject: [PATCH 171/238] MIPS: Octeon: Fix cpu hotplug compile error

When enabling CPU_HOTPLUG, below error is triggered:
linux/arch/mips/cavium-octeon/smp.c:341: error: ISO C90 forbids mixed declarations and code

Move irq_flags assignment to the below of CPU_HOTPLUG code block.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/mips/cavium-octeon/smp.c |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/arch/mips/cavium-octeon/smp.c b/arch/mips/cavium-octeon/smp.c
index 14cea20..da2a744 100644
--- a/arch/mips/cavium-octeon/smp.c
+++ b/arch/mips/cavium-octeon/smp.c
@@ -331,12 +331,6 @@ void octeon_prepare_cpus(unsigned int max_cpus)
 	u64 mask;
 	unsigned long irq_flags;
 
-#ifdef CONFIG_PREEMPT_HARDIRQS
-	irq_flags = IRQF_DISABLED | IRQF_NODELAY;
-#else
-	irq_flags = IRQF_DISABLED;
-#endif
- 
 #ifdef CONFIG_HOTPLUG_CPU
 	unsigned long t;
 	struct linux_app_boot_info *labi;
@@ -354,6 +348,12 @@ void octeon_prepare_cpus(unsigned int max_cpus)
 	octeon_hotplug_entry_addr = (uint32_t)CKSEG0ADDR(t);
 #endif
 
+#ifdef CONFIG_PREEMPT_HARDIRQS
+	irq_flags = IRQF_DISABLED | IRQF_NODELAY;
+#else
+	irq_flags = IRQF_DISABLED;
+#endif
+
 #ifdef CONFIG_WRHV
 	wrhv_request_ipis();
 #else
-- 
1.7.0

