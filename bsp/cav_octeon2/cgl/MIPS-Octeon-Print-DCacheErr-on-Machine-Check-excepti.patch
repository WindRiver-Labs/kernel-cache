From 213ed72d2441d5ef632322867ed3de201f9338c9 Mon Sep 17 00:00:00 2001
From: David Daney <ddaney@caviumnetworks.com>
Date: Wed, 11 May 2011 18:11:07 -0700
Subject: [PATCH 022/238] MIPS: Octeon: Print DCacheErr on Machine Check exception.

Source: Cavium SDK 2.1.0-407

Signed-off-by: David Daney <ddaney@caviumnetworks.com>
Integrated-by: Phil Staub <Phil.Staub@windriver.com>
---
 arch/mips/kernel/traps.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/arch/mips/kernel/traps.c b/arch/mips/kernel/traps.c
index 6651468..6a13841 100644
--- a/arch/mips/kernel/traps.c
+++ b/arch/mips/kernel/traps.c
@@ -1127,8 +1127,11 @@ asmlinkage void do_mcheck(struct pt_regs *regs)
 	const int field = 2 * sizeof(unsigned long);
 	int multi_match = regs->cp0_status & ST0_TS;
 
-	show_regs(regs);
+	show_registers(regs);
 
+#ifdef CONFIG_CPU_CAVIUM_OCTEON
+	printk(KERN_ERR "DCacheErr: %0llx\n", read_octeon_c0_dcacheerr());
+#endif
 	if (multi_match) {
 		printk("Index   : %0x\n", read_c0_index());
 		printk("Pagemask: %0x\n", read_c0_pagemask());
-- 
1.7.0

