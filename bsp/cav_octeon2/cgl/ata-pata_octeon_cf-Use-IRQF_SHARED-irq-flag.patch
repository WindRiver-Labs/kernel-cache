From 5856cf492a3d30558604b3e6711ed024837f8ae0 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Wed, 11 Apr 2012 10:49:36 +0800
Subject: [PATCH 226/238] ata: pata_octeon_cf: Use IRQF_SHARED irq flag.

Source: Cavium SDK 2.3-427

The DMA interrupt is shared amoung multiple devices, so we must use
IRQF_SHARED.

Signed-off-by: David Daney <david.daney@cavium.com>
Integrated-by: Jiang Bin <bin.jiang@windriver.com>
---
 drivers/ata/pata_octeon_cf.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/ata/pata_octeon_cf.c b/drivers/ata/pata_octeon_cf.c
index 7702939..13c074e 100644
--- a/drivers/ata/pata_octeon_cf.c
+++ b/drivers/ata/pata_octeon_cf.c
@@ -883,7 +883,7 @@ static int __devinit octeon_cf_probe(struct platform_device *pdev)
 	irq_handler_t irq_handler = NULL;
 	void __iomem *base;
 	struct octeon_cf_port *cf_port;
-	unsigned long irq_flags = 0;
+	unsigned long irq_flags = IRQF_SHARED;
 	int rv = -ENOMEM;
 
 	node = pdev->dev.of_node;
@@ -1049,7 +1049,7 @@ static int __devinit octeon_cf_probe(struct platform_device *pdev)
 		 cf_port->is_true_ide ? ", True IDE" : "");
  
 #ifdef CONFIG_PREEMPT_HARDIRQS
-	irq_flags = IRQF_NODELAY;
+	irq_flags |= IRQF_NODELAY;
 #endif
 
 	return ata_host_activate(host, irq, irq_handler, irq_flags, &octeon_cf_sht);
-- 
1.7.0

