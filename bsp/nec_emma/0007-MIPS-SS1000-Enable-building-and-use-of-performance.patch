From 9ad8a9714419dfaa9f71faf525b4e139dde3bd7e Mon Sep 17 00:00:00 2001
From: Mark Asselstine <mark.asselstine@windriver.com>
Date: Tue, 28 Apr 2009 14:06:01 +0900
Subject: [PATCH] MIPS: SS1000: Enable building and use of performance register driver

Enable oprofile support for the SS1000 processor core.
This will allow the performance register driver to be build and used.

Signed-off-by: Mark Asselstine <mark.asselstine@windriver.com>
Signed-off-by: Shinya Kuribayashi <shinya.kuribayashi@necel.com>
---
 arch/mips/oprofile/Makefile         |    1 +
 arch/mips/oprofile/common.c         |    1 +
 arch/mips/oprofile/op_model_r5500.c |    1 +
 3 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/arch/mips/oprofile/Makefile b/arch/mips/oprofile/Makefile
index dfb616f..67eeac4 100644
--- a/arch/mips/oprofile/Makefile
+++ b/arch/mips/oprofile/Makefile
@@ -15,4 +15,5 @@ oprofile-$(CONFIG_CPU_MIPS64)		+= op_model_mipsxx.o
 oprofile-$(CONFIG_CPU_R10000)		+= op_model_mipsxx.o
 oprofile-$(CONFIG_CPU_SB1)		+= op_model_mipsxx.o
 oprofile-$(CONFIG_CPU_R5500)		+= op_model_r5500.o
+oprofile-$(CONFIG_CPU_SS1000)		+= op_model_r5500.o
 oprofile-$(CONFIG_CPU_RM9000)		+= op_model_rm9000.o
diff --git a/arch/mips/oprofile/common.c b/arch/mips/oprofile/common.c
index 4158136..a15c85e 100644
--- a/arch/mips/oprofile/common.c
+++ b/arch/mips/oprofile/common.c
@@ -97,6 +97,7 @@ int __init oprofile_arch_init(struct oprofile_operations *ops)
 		break;
 
 	case CPU_R5500:
+	case CPU_SS1000:
 		lmodel = &op_model_r5500_ops;
 		break;
 	};
diff --git a/arch/mips/oprofile/op_model_r5500.c b/arch/mips/oprofile/op_model_r5500.c
index 9b0d20f..3c8d904 100644
--- a/arch/mips/oprofile/op_model_r5500.c
+++ b/arch/mips/oprofile/op_model_r5500.c
@@ -128,6 +128,7 @@ static int __init r5500_init(void)
 
 	switch (current_cpu_type()) {
 	case CPU_R5500:
+	case CPU_SS1000:
 		op_model_r5500_ops.cpu_type = "mips/vr5500";
 		break;
 
-- 
1.6.0.4

