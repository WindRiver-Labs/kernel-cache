From 788f7d1214716164d834e5caf024b762fd05d4b7 Mon Sep 17 00:00:00 2001
From: Catalin Enache <catalin.enache@windriver.com>
Date: Tue, 21 Jan 2014 14:41:43 +0200
Subject: [PATCH 62/66] ARM: replace the default read_current_timer

read_current_timer is used by get_cycles since "ARM: 7538/1: delay:
add registration mechanism for delay timer sources", and get_cycles
can be used by device drivers in loadable modules, so it has to
be exported

Signed-off-by: Catalin Enache <catalin.enache@windriver.com>
---
 arch/arm/lib/delay.c      |    2 ++
 arch/arm/mach-msm/timer.c |    1 +
 2 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/arch/arm/lib/delay.c b/arch/arm/lib/delay.c
index 0dc5385..c50e3f9 100644
--- a/arch/arm/lib/delay.c
+++ b/arch/arm/lib/delay.c
@@ -37,6 +37,7 @@ struct arm_delay_ops arm_delay_ops = {
 static const struct delay_timer *delay_timer;
 static bool delay_calibrated;
 
+#if 0
 int read_current_timer(unsigned long *timer_val)
 {
 	if (!delay_timer)
@@ -46,6 +47,7 @@ int read_current_timer(unsigned long *timer_val)
 	return 0;
 }
 EXPORT_SYMBOL_GPL(read_current_timer);
+#endif
 
 static void __timer_delay(unsigned long cycles)
 {
diff --git a/arch/arm/mach-msm/timer.c b/arch/arm/mach-msm/timer.c
index 0eb99ae..2aa7f38 100644
--- a/arch/arm/mach-msm/timer.c
+++ b/arch/arm/mach-msm/timer.c
@@ -945,6 +945,7 @@ int read_current_timer(unsigned long *timer_val)
 	*timer_val = msm_read_timer_count(dgt, GLOBAL_TIMER);
 	return 0;
 }
+EXPORT_SYMBOL(read_current_timer);
 
 static void __init msm_sched_clock_init(void)
 {
-- 
1.7.5.4

