From 09c5cb9f3f1e6fa706446dd7cd4d460918e206c9 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Thu, 9 Oct 2008 11:28:39 +0800
Subject: [PATCH] fix acpi ec read write bug

Fill in command unit of transaction_data structure, otherwise
gpe_transaction will skip read or write instruction.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/acpi/ec.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/acpi/ec.c b/drivers/acpi/ec.c
index fb88914..7471163 100644
--- a/drivers/acpi/ec.c
+++ b/drivers/acpi/ec.c
@@ -156,7 +156,7 @@ static inline u8 acpi_ec_read_data(struct acpi_ec *ec)
 static inline void acpi_ec_write_cmd(struct acpi_ec *ec, u8 command)
 {
 	pr_debug(PREFIX "<--- command = 0x%2.2x\n", command);
-	outb(command, ec->command_addr);
+	outb((ec->t.command = command), ec->command_addr);
 }
 
 static inline void acpi_ec_write_data(struct acpi_ec *ec, u8 data)
-- 
1.5.5.1

