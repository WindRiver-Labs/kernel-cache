From e58037d73fcbb81eb92e4da6e6049aadee5a548c Mon Sep 17 00:00:00 2001
From: Zhao Yakui <yakui.zhao@intel.com>
Date: Thu, 9 Oct 2008 11:28:37 +0800
Subject: [PATCH] ACPI: Avoid twice read access to EC data I/O port

In current kernel when OS reads the data returned by the EC controller, the
EC data I/O port is accessed twice. In fact is is meaningless.
Only once access to EC data I/O port is enough to get data returned by EC
controller.

Signed-off-by : Zhao Yakui <yakui.zhao@intel.com>
Acked-by      : Alexey Starikovskiy <astarikovskiy@suse.de>
Signed-off-by: Andi Kleen <ak@linux.intel.com>

Got from linux-next, commit:e0c42ae0f9e3b6a318ea065bc912bbcbd4a90d06
---
 drivers/acpi/ec.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/acpi/ec.c b/drivers/acpi/ec.c
index 13593f9..fb88914 100644
--- a/drivers/acpi/ec.c
+++ b/drivers/acpi/ec.c
@@ -150,7 +150,7 @@ static inline u8 acpi_ec_read_data(struct acpi_ec *ec)
 {
 	u8 x = inb(ec->data_addr);
 	pr_debug(PREFIX "---> data = 0x%2.2x\n", x);
-	return inb(ec->data_addr);
+	return x;
 }
 
 static inline void acpi_ec_write_cmd(struct acpi_ec *ec, u8 command)
-- 
1.5.5.1

