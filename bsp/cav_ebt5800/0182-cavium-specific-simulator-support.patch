From b3369cc985c0e253b8f6a70029c72c0c7854b16d Mon Sep 17 00:00:00 2001
From: auto commit <unknown@unknown>
Date: Fri, 24 Oct 2008 12:23:18 -0700
Subject: [PATCH] cavium: specific simulator support

Signed-off-by: Tomaso Paoletti <tpaoletti@caviumnetworks.com>
---
 arch/mips/cavium-octeon/simulator.c |   28 ++++++++++++++++++++++++++++
 1 files changed, 28 insertions(+), 0 deletions(-)
 create mode 100644 arch/mips/cavium-octeon/simulator.c

diff --git a/arch/mips/cavium-octeon/simulator.c b/arch/mips/cavium-octeon/simulator.c
new file mode 100644
index 0000000..dc7e19e
--- /dev/null
+++ b/arch/mips/cavium-octeon/simulator.c
@@ -0,0 +1,28 @@
+/*
+ * This file is subject to the terms and conditions of the GNU General Public
+ * License.  See the file "COPYING" in the main directory of this archive
+ * for more details.
+ *
+ * Copyright (C) 2004-2007 Cavium Networks
+ */
+
+
+/**
+ * Octeon Simulator magic printf interface. Generates printf
+ * style output on the simulator console. Format arguments
+ * must all be %ll?. Nothing other than 64bit numbers can
+ * be displayed.
+ *
+ * @param fmt    Format string
+ */
+void octeon_simprintf(const char *fmt, ...)
+{
+	asm volatile ("\
+		      sync\n\
+		      add $25, $0, 6\n\
+		      dli $15,0x8000000feffe0000\n\
+		      dadd $24, $31, $0\n\
+		      jalr $15\n\
+		      dadd $31, $24, $0\n\
+		      " : : );
+}
-- 
1.5.5.1

