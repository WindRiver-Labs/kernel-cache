From 92143e72200f7ca4a19497385c9cc4c7b390458c Mon Sep 17 00:00:00 2001
From: auto commit <unknown@unknown>
Date: Fri, 24 Oct 2008 12:22:58 -0700
Subject: [PATCH] cavium: stray __INIT prevents linking

There is a stray __INIT which will cause a link error.  Looking at
older versions, it appeared to be wrapped in a QEMU #ifdef, so
once again it finds itself in the same boat.

Signed-off-by: Paul Gortmaker <Paul.Gortmaker@windriver.com>
---
 arch/mips/kernel/head.S |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/mips/kernel/head.S b/arch/mips/kernel/head.S
index 492a0a8..29917ba 100644
--- a/arch/mips/kernel/head.S
+++ b/arch/mips/kernel/head.S
@@ -196,7 +196,11 @@ NESTED(kernel_entry, 16, sp)			# kernel entry point
 	j		start_kernel
 	END(kernel_entry)
 
+/* You can't do this on Cavium (or maybe all MIPS64 SMP) or you will error on:
+   relocation truncated to fit: R_MIPS_PC16 against `smp_bootstrap'  */
+#ifndef CONFIG_CPU_CAVIUM_OCTEON
 	__CPUINIT
+#endif
 
 #ifdef CONFIG_SMP
 /*
-- 
1.5.5.1

