From 37d0f3967442cd02db1e09e87369f4166ba2e859 Mon Sep 17 00:00:00 2001
From: auto commit <unknown@unknown>
Date: Fri, 24 Oct 2008 12:22:33 -0700
Subject: [PATCH] cavium: SA_SHIRQ and request_irq cleanup

SA_SHIRQ is gone, and you get nagged if you don't at least
pretend to care about the return value of request_irq

Signed-off-by: Tomaso Paoletti <tpaoletti@caviumnetworks.com>
Signed-off-by: Paul Gortmaker <Paul.Gortmaker@windriver.com>
---
 arch/mips/cavium-octeon/i8259.c  |    4 ++--
 arch/mips/cavium-octeon/serial.c |    2 +-
 arch/mips/cavium-octeon/setup.c  |    4 ++--
 arch/mips/cavium-octeon/smp.c    |    4 ++--
 4 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/arch/mips/cavium-octeon/i8259.c b/arch/mips/cavium-octeon/i8259.c
index fc57a1e..4c72584 100644
--- a/arch/mips/cavium-octeon/i8259.c
+++ b/arch/mips/cavium-octeon/i8259.c
@@ -165,11 +165,11 @@ void octeon_i8259_setup(int irq_line)
 		printk("8259: Setting GPIO %d for the interrupt\n",
 		       irq_line - 24);
 		cvmx_write_csr(CVMX_GPIO_BIT_CFGX(irq_line - 24), 0x114);
-		request_irq(irq_line, octeon_i8259_interrupt, SA_SHIRQ, "8259",
+		request_irq(irq_line, octeon_i8259_interrupt, IRQF_SHARED, "8259",
 			    octeon_i8259_interrupt);
 	} else if ((irq_line >= 44) && (irq_line <= 47)) {
 		printk("8259: Using PCI INT-%c\n", irq_line - 44 + 'A');
-		request_irq(irq_line, octeon_i8259_interrupt, SA_SHIRQ, "8259",
+		request_irq(irq_line, octeon_i8259_interrupt, IRQF_SHARED, "8259",
 			    octeon_i8259_interrupt);
 	} else {
 		panic("8259: Don't know how to setup the interrupt IRQ %d\n",
diff --git a/arch/mips/cavium-octeon/serial.c b/arch/mips/cavium-octeon/serial.c
index 6446af6..16a7a1f 100644
--- a/arch/mips/cavium-octeon/serial.c
+++ b/arch/mips/cavium-octeon/serial.c
@@ -155,7 +155,7 @@ static int octeon_serial_init(void)
 	}
 #if defined(CONFIG_KGDB) || defined(CONFIG_CAVIUM_GDB)
 	request_irq(OCTEON_IRQ_UART0 + DEBUG_UART, interruptDebugChar,
-		    SA_SHIRQ, "KGDB", interruptDebugChar);
+		    IRQF_SHARED, "KGDB", interruptDebugChar);
 
 	/* Enable uart1 interrupts for debugger Control-C processing */
 	cvmx_write_csr(CVMX_MIO_UARTX_IER(DEBUG_UART),
diff --git a/arch/mips/cavium-octeon/setup.c b/arch/mips/cavium-octeon/setup.c
index ff56a2c..4948a23 100644
--- a/arch/mips/cavium-octeon/setup.c
+++ b/arch/mips/cavium-octeon/setup.c
@@ -155,7 +155,7 @@ static irqreturn_t octeon_main_timer_interrupt(int irq, void *dev_id)
 void __init plat_timer_setup(struct irqaction *irq)
 {
 	irq->handler = octeon_main_timer_interrupt;
-	irq->flags |= SA_SHIRQ;
+	irq->flags |= IRQF_SHARED;
 	setup_irq(7, irq);
 }
 
@@ -412,7 +412,7 @@ void prom_free_prom_memory(void)
 	cvmx_interrupt_rsl_enable();
 
 	/* Add an interrupt handler for general failures. */
-	request_irq(OCTEON_IRQ_RML, octeon_rlm_interrupt, SA_SHIRQ, "RML/RSL",
+	request_irq(OCTEON_IRQ_RML, octeon_rlm_interrupt, IRQF_SHARED, "RML/RSL",
 		    octeon_rlm_interrupt);
 
 	/* This call is here so that it is performed after any TLB
diff --git a/arch/mips/cavium-octeon/smp.c b/arch/mips/cavium-octeon/smp.c
index 196673f..17f3b89 100644
--- a/arch/mips/cavium-octeon/smp.c
+++ b/arch/mips/cavium-octeon/smp.c
@@ -159,9 +159,9 @@ void prom_init_secondary(void)
 void plat_prepare_cpus(unsigned int max_cpus)
 {
 	cvmx_write_csr(CVMX_CIU_MBOX_CLRX(cvmx_get_core_num()), 0xffffffff);
-	request_irq(OCTEON_IRQ_MBOX0, mailbox_interrupt, SA_SHIRQ, "mailbox0",
+	request_irq(OCTEON_IRQ_MBOX0, mailbox_interrupt, IRQF_SHARED, "mailbox0",
 		    mailbox_interrupt);
-	request_irq(OCTEON_IRQ_MBOX1, mailbox_interrupt, SA_SHIRQ, "mailbox1",
+	request_irq(OCTEON_IRQ_MBOX1, mailbox_interrupt, IRQF_SHARED, "mailbox1",
 		    mailbox_interrupt);
 }
 
-- 
1.5.5.1

