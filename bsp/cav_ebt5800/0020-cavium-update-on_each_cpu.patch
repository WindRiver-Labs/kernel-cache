From d36572eee33666c1032ad4387955f605acc55825 Mon Sep 17 00:00:00 2001
From: auto commit <unknown@unknown>
Date: Fri, 24 Oct 2008 12:22:37 -0700
Subject: [PATCH] cavium: update on_each_cpu

Reflect changes in the prototype of on_each_cpu().
Applies to 2.6.27 and later kernels.

Signed-off-by: Tomaso Paoletti <tpaoletti@caviumnetworks.com>
---
 arch/mips/cavium-octeon/perf_counters.c |    4 ++--
 arch/mips/kernel/irq-octeon.c           |    2 +-
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/mips/cavium-octeon/perf_counters.c b/arch/mips/cavium-octeon/perf_counters.c
index 3b6939c..01229a2 100644
--- a/arch/mips/cavium-octeon/perf_counters.c
+++ b/arch/mips/cavium-octeon/perf_counters.c
@@ -387,7 +387,7 @@ static void proc_perf_setup(void)
 	strcpy(l2counter2, proc_perf_l2label[proc_perf_l2counter_control[2]]);
 	strcpy(l2counter3, proc_perf_l2label[proc_perf_l2counter_control[3]]);
 
-	on_each_cpu(proc_perf_setup_counters, NULL, 1, 1);
+	on_each_cpu(proc_perf_setup_counters, NULL, 1);
 
 	l2control.u64 = 0;
 	l2control.s.cnt3ena = 1;
@@ -409,7 +409,7 @@ static void proc_perf_setup(void)
 
 static void proc_perf_update(void)
 {
-	on_each_cpu(proc_perf_update_counters, NULL, 1, 1);
+	on_each_cpu(proc_perf_update_counters, NULL, 1);
 	mb();
 	proc_perf_l2counter_data[0] = cvmx_read_csr(OCTEON_L2C_PFC0);
 	proc_perf_l2counter_data[1] = cvmx_read_csr(OCTEON_L2C_PFC1);
diff --git a/arch/mips/kernel/irq-octeon.c b/arch/mips/kernel/irq-octeon.c
index ccecfd2..5ab001b 100644
--- a/arch/mips/kernel/irq-octeon.c
+++ b/arch/mips/kernel/irq-octeon.c
@@ -64,7 +64,7 @@ static void octeon_irq_core_disable(unsigned int irq)
 {
 #ifdef CONFIG_SMP
 	on_each_cpu((void (*)(void *)) octeon_irq_core_disable_local,
-		    (void *) (long) irq, 0, 1);
+		    (void *) (long) irq, 1);
 #else
 	octeon_irq_core_disable_local(irq);
 #endif
-- 
1.5.5.1

