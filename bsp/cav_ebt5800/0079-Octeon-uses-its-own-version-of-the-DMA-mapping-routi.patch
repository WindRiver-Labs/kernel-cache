From 8019381f5cc97016b24ea7f5b321f8d7e5142fd2 Mon Sep 17 00:00:00 2001
From: auto commit <unknown@unknown>
Date: Fri, 24 Oct 2008 12:22:59 -0700
Subject: [PATCH] Octeon uses its own version of the DMA mapping routines

to allow 32bit devices to access memory higher than 4GB. The
Octeon version of this file is arch/mips/cavium-octeon/dma-octeon.c
---
 arch/mips/mm/Makefile |   11 ++++++++++-
 1 files changed, 10 insertions(+), 1 deletions(-)

diff --git a/arch/mips/mm/Makefile b/arch/mips/mm/Makefile
index 6032f5c..0c1b90e 100644
--- a/arch/mips/mm/Makefile
+++ b/arch/mips/mm/Makefile
@@ -2,9 +2,18 @@
 # Makefile for the Linux/MIPS-specific parts of the memory manager.
 #
 
-obj-y				+= cache.o dma-default.o extable.o fault.o \
+OCTEON_ROOT = $(srctree)/arch/mips/cavium-octeon
+
+obj-y				+= cache.o extable.o fault.o \
 				   init.o tlbex.o tlbex-fault.o uasm.o page.o
 
+ifndef CONFIG_CPU_CAVIUM_OCTEON
+# The Octeon uses its own version of the DMA mapping routines
+# to allow 32bit devices to access memory higher than 4GB. The
+# Octeon version of this file is arch/mips/cavium-octeon/dma-octeon.c
+obj-y				+= dma-default.o
+endif
+
 obj-$(CONFIG_32BIT)		+= ioremap.o pgtable-32.o
 obj-$(CONFIG_64BIT)		+= pgtable-64.o
 obj-$(CONFIG_HIGHMEM)		+= highmem.o
-- 
1.5.5.1

