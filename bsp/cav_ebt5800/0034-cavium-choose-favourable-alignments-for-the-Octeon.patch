From be7e50fe69abba4f8690fe6e575d4d16197a6345 Mon Sep 17 00:00:00 2001
From: auto commit <unknown@unknown>
Date: Fri, 24 Oct 2008 12:22:40 -0700
Subject: [PATCH] cavium: choose favourable alignments for the Octeon

Adjust the alignments in vmlinux.lds.S to be more favourable to
the Octeon cache.

Signed-off-by: Tomaso Paoletti <tpaoletti@caviumnetworks.com>
Signed-off-by: Paul Gortmaker <Paul.Gortmaker@windriver.com>
---
 arch/mips/kernel/vmlinux.lds.S |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/arch/mips/kernel/vmlinux.lds.S b/arch/mips/kernel/vmlinux.lds.S
index afb119f..7aa7480 100644
--- a/arch/mips/kernel/vmlinux.lds.S
+++ b/arch/mips/kernel/vmlinux.lds.S
@@ -104,7 +104,11 @@ SECTIONS
 	. = ALIGN(_PAGE_SIZE);
 	__nosave_end = .;
 
+#ifdef CONFIG_CPU_CAVIUM_OCTEON
+	. = ALIGN(128);
+#else
 	. = ALIGN(32);
+#endif
 	.data.cacheline_aligned : {
 		*(.data.cacheline_aligned)
 	}
@@ -159,7 +163,11 @@ SECTIONS
 	}
 #endif
 	PERCPU(_PAGE_SIZE)
+#ifdef CONFIG_CPU_CAVIUM_OCTEON
+	. = ALIGN(128);
+#else
 	. = ALIGN(_PAGE_SIZE);
+#endif
 	__init_end = .;
 	/* freed after init ends here */
 
-- 
1.5.5.1

