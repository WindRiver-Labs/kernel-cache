From 2119606ca409218ff9bd1f3ac70ecd7dbac19af1 Mon Sep 17 00:00:00 2001
From: John Jacques <john.jacques@intel.com>
Date: Mon, 30 Nov 2015 13:22:05 -0600
Subject: [PATCH 115/131] arch/arm/mach-axxia: Update the Axxia GIC Driver

Replace the use of the depricated __this_cpu_ptr() with
raw_cpu_ptr().

Signed-off-by: John Jacques <john.jacques@intel.com>
[Original patch is from linux-yocto-4.1 axxia/base branch.]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/arm/mach-axxia/axxia-gic.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/arch/arm/mach-axxia/axxia-gic.c b/arch/arm/mach-axxia/axxia-gic.c
index ecee2d9..e086277 100644
--- a/arch/arm/mach-axxia/axxia-gic.c
+++ b/arch/arm/mach-axxia/axxia-gic.c
@@ -741,11 +741,11 @@ static void gic_cpu_save(void)
 	if (!dist_base || !cpu_base)
 		return;
 
-	ptr = __this_cpu_ptr(gic_data.saved_ppi_enable[this_cluster]);
+	ptr = raw_cpu_ptr(gic_data.saved_ppi_enable[this_cluster]);
 	for (i = 0; i < DIV_ROUND_UP(32, 32); i++)
 		ptr[i] = readl_relaxed(dist_base + GIC_DIST_ENABLE_SET + i * 4);
 
-	ptr = __this_cpu_ptr(gic_data.saved_ppi_conf[this_cluster]);
+	ptr = raw_cpu_ptr(gic_data.saved_ppi_conf[this_cluster]);
 	for (i = 0; i < DIV_ROUND_UP(32, 16); i++)
 		ptr[i] = readl_relaxed(dist_base + GIC_DIST_CONFIG + i * 4);
 
@@ -767,11 +767,11 @@ static void gic_cpu_restore(void)
 	if (!dist_base || !cpu_base)
 		return;
 
-	ptr = __this_cpu_ptr(gic_data.saved_ppi_enable[this_cluster]);
+	ptr = raw_cpu_ptr(gic_data.saved_ppi_enable[this_cluster]);
 	for (i = 0; i < DIV_ROUND_UP(32, 32); i++)
 		writel_relaxed(ptr[i], dist_base + GIC_DIST_ENABLE_SET + i * 4);
 
-	ptr = __this_cpu_ptr(gic_data.saved_ppi_conf[this_cluster]);
+	ptr = raw_cpu_ptr(gic_data.saved_ppi_conf[this_cluster]);
 	for (i = 0; i < DIV_ROUND_UP(32, 16); i++)
 		writel_relaxed(ptr[i], dist_base + GIC_DIST_CONFIG + i * 4);
 
-- 
2.8.1

