From 208cbc4adc5d9c8f257313f683a236bd18f74207 Mon Sep 17 00:00:00 2001
From: Eran Ben-Avi <benavi@marvell.com>
Date: Thu, 15 Aug 2013 19:35:29 +0300
Subject: [PATCH 0966/1825] tdm: alp: clean make defconfig warnings

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 02921d3ebb55f4a96a06429958ff297745dfd5b2

        Fix tdm driver Kconfig parsing collisions
        between Armada and Feroceon machines.
        Use single shared TDM driver Kconfig under
        kernel telephony drivers.

Change-Id: I5de9fff0079a2460d83d15c777f95cb9fbb9cf38
Signed-off-by: Eran Ben-Avi <benavi@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/3054
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../plat-armada/mv_drivers_lsp/mv_phone/Kconfig    |  151 +---------------
 .../plat-feroceon/mv_drivers_lsp/mv_phone/Kconfig  |  140 +--------------
 drivers/staging/telephony/Kconfig                  |    3 +
 drivers/staging/telephony/Makefile                 |    7 +-
 drivers/staging/telephony/mv_tdm/Kconfig           |  200 ++++++++++++++++++++
 5 files changed, 212 insertions(+), 289 deletions(-)
 create mode 100644 drivers/staging/telephony/mv_tdm/Kconfig

diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_phone/Kconfig b/arch/arm/plat-armada/mv_drivers_lsp/mv_phone/Kconfig
index 21879bd..82f7ea2 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_phone/Kconfig
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_phone/Kconfig
@@ -1,153 +1,6 @@
-menu "Telephony options"
+menu "SoC Telephony support"
 	depends on MV_INCLUDE_TDM
 
-config  MV_PHONE
-	bool "Support for Marvell telephony(VoIP)"
-	depends on MV_INCLUDE_TDM && PHONE
-	select MV_TDM_USE_DCO if ARCH_AVANTA_LP
-	default y
-	---help---
-	Choosing this option enables the Marvell telephony underlying
-	support for various VoIP applications.
-	Note, kernel Telephony subsystem must be chosen too.
-
-config MV_TDM_USE_DCO
-	bool
-	default y
-
-choice
-	prompt "TDM Unit"
-	depends on MV_PHONE
-	default MV_TDM_SUPPORT
-
-config MV_TDM_SUPPORT
-	bool "Support legacy TDM(2 channels)"
-	---help---
-	Choosing this option enables Marvell 2CH TDM voice interface.
-
-config MV_COMM_UNIT_SUPPORT
-	depends on ARCH_FEROCEON_KW2
-	bool "Support CommUnit(up to 32 channels)"
-	---help---
-	Choosing this option enables Marvell 32CH CommUnit voice interface.
-
-endchoice
-
-choice
-	prompt "SLIC Vendor"
-	depends on MV_PHONE
-	default ZARLINK_SLIC_SUPPORT
-
-config LANTIQ_SLIC_SUPPORT
-	bool "Support Lantiq devices"
-	---help---
-	Choosing this option enables Lantiq external SLIC device.
-
-config SILABS_SLIC_SUPPORT
-	bool "Support Silicon Labs devices"
-	---help---
-	Choosing this option enables Silabs external SLIC device.
-
-config ZARLINK_SLIC_SUPPORT
-	bool "Support Zarlink/Legirity devices"
-
-
-endchoice
-
-choice
-	prompt "SLIC Device"
-	depends on MV_PHONE && LANTIQ_SLIC_SUPPORT
-	default LANTIQ_SLIC_DUSLIC_XT
-
-config LANTIQ_SLIC_DUSLIC_XT
-	bool "Support Lantiq DUSLIC-xT SLIC family"
-
-endchoice
-
-choice
-	prompt "SLIC Device"
-	depends on MV_PHONE && SILABS_SLIC_SUPPORT
-	default SILAB_SLIC_EXTERNAL_DRIVER
-
-config SILAB_SLIC_EXTERNAL_DRIVER
-	bool "Support Silicon Labs SLIC external driver modules"
-
-endchoice
-
-choice
-	prompt "SLIC Device"
-	depends on MV_PHONE && ZARLINK_SLIC_SUPPORT
-	default ZARLINK_SLIC_EXTERNAL_DRIVER
-
-config ZARLINK_SLIC_EXTERNAL_DRIVER
-	bool "Support Zarlink SLIC external driver modules"
-	---help---
-	Choosing this option enables Zarlink external slic driver support.
-
-endchoice
-
-choice
-	prompt "PCM Clock Frequency"
-	depends on MV_PHONE
-	default MV_TDM_PCM_CLK_8MHZ
-	---help---
-	This menu selects the PCM clock frequency generated by the TDM master.
-	SLIC should be configured accordingly in order to maintain bus coherency.
-
-config MV_TDM_PCM_CLK_8MHZ
-	bool "Support 8MHz PCM clock"
-	---help---
-	Choosing this option selects 8MHz PCM clock frequency.
-
-config MV_TDM_PCM_CLK_4MHZ
-	bool "Support 4MHz PCM clock"
-	---help---
-	Choosing this option selects 4MHz PCM clock frequency.
-
-config MV_TDM_PCM_CLK_2MHZ
-	bool "Support 2MHz PCM clock"
-	---help---
-	Choosing this option selects 2MHz PCM clock frequency.
-
-endchoice
-
-choice 
-	prompt "TDM voice processing"
-	depends on MV_PHONE
-	default MV_TDM_DUMMY
-
-config MV_TDM_DUMMY
-	bool "Support TDM voice processing in softIRQ"
-	---help---
-	Choosing this option enables TDM voice processing in softIRQ.
-
-config MV_PHONE_USE_IRQ_PROCESSING
-	bool "Support TDM voice processing in IRQ"
-	---help---
-	Choosing this option enables TDM voice processing in IRQ.
-
-config MV_PHONE_USE_FIQ_PROCESSING
-	bool "Support TDM voice processing in FIQ"
-	---help---
-	Choosing this option enables TDM voice processing in FIQ.
-
-endchoice
-
-config MV_PHONE_USE_SLIC_LIBS
-	bool "Use binary SLIC drivers"
-	depends on MV_PHONE && !LANTIQ_SLIC_SUPPORT && \
-		   !ZARLINK_SLIC_EXTERNAL_DRIVER && !SILAB_SLIC_EXTERNAL_DRIVER
-	default y
-	---help---
-	Unselect this option only if you have source code of SLIC drivers.
-	If unsure, say "y"
-
-config MV_TDM_EXT_STATS
-	bool "Enable legacy TDM extended statistics"
-	depends on MV_TDM_SUPPORT
-	default n
-	---help---
-	Choosing this option will export extended statistics to procfs.
-	This is relevant only for the legacy TDM unit.
+	comment "See under:  Staging drivers -> Telephony support -> Marvell Telephony Options"
 
 endmenu
diff --git a/arch/arm/plat-feroceon/mv_drivers_lsp/mv_phone/Kconfig b/arch/arm/plat-feroceon/mv_drivers_lsp/mv_phone/Kconfig
index 32b1fa0..82f7ea2 100644
--- a/arch/arm/plat-feroceon/mv_drivers_lsp/mv_phone/Kconfig
+++ b/arch/arm/plat-feroceon/mv_drivers_lsp/mv_phone/Kconfig
@@ -1,142 +1,6 @@
-menu "Telephony options"
+menu "SoC Telephony support"
 	depends on MV_INCLUDE_TDM
 
-config  MV_PHONE
-	bool "Support for Marvell telephony(VoIP)"
-	depends on MV_INCLUDE_TDM
-	default y
-	---help---
-	  Choosing this option enables the Marvell telephony underlying
-	  support for various VoIP applications.
-	  Note, kernel Telephony subsystem must be chosen too.
-
-choice
-	prompt "TDM Unit"
-	depends on MV_PHONE
-	default MV_TDM_SUPPORT
-
-config MV_TDM_SUPPORT
-	bool "Support legacy TDM(2 channels)"
-
-config MV_COMM_UNIT_SUPPORT
-	depends on ARCH_FEROCEON_KW2
-	bool "Support CommUnit(up to 32 channels)"
-
-endchoice
-
-choice
-	prompt "SLIC Vendor"
-	depends on MV_PHONE
-	default ZARLINK_SLIC_SUPPORT
-
-config LANTIQ_SLIC_SUPPORT
-	bool "Support Lantiq devices"
-
-config SILABS_SLIC_SUPPORT
-	bool "Support Silicon Labs devices"
-
-config ZARLINK_SLIC_SUPPORT
-	bool "Support Zarlink/Legirity devices"
-
-
-endchoice
-
-choice
-	prompt "SLIC Device"
-	depends on MV_PHONE && LANTIQ_SLIC_SUPPORT
-	default LANTIQ_SLIC_DUSLIC_XT
-
-config LANTIQ_SLIC_DUSLIC_XT
-	bool "Support Lantiq DUSLIC-xT SLIC family"
-
-endchoice
-
-choice
-	prompt "SLIC Device"
-	depends on MV_PHONE && SILABS_SLIC_SUPPORT
-	default SILAB_SLIC_EXTERNAL_DRIVER
-
-config SILAB_SLIC_EXTERNAL_DRIVER
-	bool "Support Silicon Labs SLIC external driver modules"
-
-endchoice
-
-choice
-	prompt "SLIC Device"
-	depends on MV_PHONE && ZARLINK_SLIC_SUPPORT
-	default ZARLINK_SLIC_EXTERNAL_DRIVER
-
-config ZARLINK_SLIC_EXTERNAL_DRIVER
-	bool "Support Zarlink SLIC external driver modules"
-
-endchoice
-
-choice
-	prompt "PCM Clock Frequency"
-	depends on MV_PHONE
-	default MV_TDM_PCM_CLK_8MHZ
-	---help---
-	This menu selects the PCM clock frequency generated by the TDM master.
-	SLIC should be configured accordingly in order to maintain bus coherency.
-
-config MV_TDM_PCM_CLK_8MHZ
-	bool "Support 8MHz PCM clock"
-
-config MV_TDM_PCM_CLK_4MHZ
-	bool "Support 4MHz PCM clock"
-
-config MV_TDM_PCM_CLK_2MHZ
-	bool "Support 2MHz PCM clock"
-
-endchoice
-
-choice
-	prompt "TDM Clock Source"
-	depends on MV_PHONE
-	default MV_TDM_USE_INTERNAL_PCLK_SOURCE
-
-config MV_TDM_USE_INTERNAL_PCLK_SOURCE
-	bool "Support PCLK internally generated"
-
-config MV_TDM_USE_EXTERNAL_PCLK_SOURCE
-	bool "Support PCLK from external source"
-
-config MV_TDM_USE_DCO
-	bool "Support PCLK from DCO enabled PLL"
-
-endchoice
-
-choice
-	prompt "TDM voice processing"
-	depends on MV_PHONE
-	default MV_TDM_DUMMY
-
-config MV_TDM_DUMMY
-	bool "Support TDM voice processing in softIRQ"
-
-config MV_PHONE_USE_IRQ_PROCESSING
-	bool "Support TDM voice processing in IRQ"
-
-config MV_PHONE_USE_FIQ_PROCESSING
-	bool "Support TDM voice processing in FIQ"
-
-endchoice
-
-config MV_PHONE_USE_SLIC_LIBS
-	bool "Use binary SLIC drivers"
-	depends on MV_PHONE && !LANTIQ_SLIC_SUPPORT && \
-		   !ZARLINK_SLIC_EXTERNAL_DRIVER && !SILAB_SLIC_EXTERNAL_DRIVER
-	default y
-	---help---
-	Unselect this option only if you have source code of SLIC drivers.
-	If unsure, say "y"
-
-config MV_TDM_EXT_STATS
-	bool "Enable legacy TDM extended statistics"
-	depends on MV_TDM_SUPPORT
-	default n
-	---help---
-	Choosing this option will export extended statistics to procfs.
-	This is relevant only for the legacy TDM unit.
+	comment "See under:  Staging drivers -> Telephony support -> Marvell Telephony Options"
 
 endmenu
diff --git a/drivers/staging/telephony/Kconfig b/drivers/staging/telephony/Kconfig
index b5f78b6..8452adf 100644
--- a/drivers/staging/telephony/Kconfig
+++ b/drivers/staging/telephony/Kconfig
@@ -44,4 +44,7 @@ config PHONE_IXJ_PCMCIA
 	  cards manufactured by Quicknet Technologies, Inc.  This changes the
 	  card initialization code to work with the card manager daemon.
 
+
+source drivers/staging/telephony/mv_tdm/Kconfig
+
 endif # PHONE
diff --git a/drivers/staging/telephony/Makefile b/drivers/staging/telephony/Makefile
index 6feb83b..5f9d91a 100644
--- a/drivers/staging/telephony/Makefile
+++ b/drivers/staging/telephony/Makefile
@@ -5,8 +5,11 @@
 obj-$(CONFIG_PHONE) += phonedev.o
 obj-$(CONFIG_PHONE_IXJ) += ixj.o
 obj-$(CONFIG_PHONE_IXJ_PCMCIA) += ixj_pcmcia.o
-ifeq ($(CONFIG_PLAT_ARMADA),y)
+
+ifeq ($(CONFIG_ARCH_AVANTA_LP),y)
 obj-$(CONFIG_MV_PHONE) += ../../../arch/arm/plat-armada/mv_drivers_lsp/mv_phone/
-else
+endif
+
+ifeq ($(CONFIG_ARCH_FEROCEON),y)
 obj-$(CONFIG_MV_PHONE) += ../../../arch/arm/plat-feroceon/mv_drivers_lsp/mv_phone/
 endif
diff --git a/drivers/staging/telephony/mv_tdm/Kconfig b/drivers/staging/telephony/mv_tdm/Kconfig
new file mode 100644
index 0000000..b1b7ad8
--- /dev/null
+++ b/drivers/staging/telephony/mv_tdm/Kconfig
@@ -0,0 +1,200 @@
+menu "Marvell Telephony options"
+	depends on MV_INCLUDE_TDM
+
+config  MV_PHONE
+	bool "Support for Marvell telephony(VoIP)"
+	depends on MV_INCLUDE_TDM && PHONE
+	default y
+	---help---
+	Choosing this option enables the Marvell telephony underlying
+	support for various VoIP applications.
+	Note, kernel Telephony subsystem must be chosen too.
+
+choice
+	prompt "TDM Unit"
+	depends on MV_PHONE
+	default MV_TDM_SUPPORT
+
+config MV_TDM_SUPPORT
+	bool "Support legacy TDM(2 channels)"
+	---help---
+	Choosing this option enables Marvell
+	2CH TDM voice interface.
+	The TDM bus may be used for transferring
+	voice samples thru analog phone interface.
+
+config MV_COMM_UNIT_SUPPORT
+	depends on ARCH_FEROCEON_KW2
+	bool "Support CommUnit(up to 32 channels)"
+	---help---
+	Choosing this option enables Marvell 32CH CommUnit voice interface.
+
+endchoice
+
+choice
+	prompt "SLIC Vendor"
+	depends on MV_PHONE
+	default ZARLINK_SLIC_SUPPORT
+
+config LANTIQ_SLIC_SUPPORT
+	bool "Support Lantiq devices"
+	---help---
+	Choosing this option enables Lantiq external
+	SLIC device.
+	Lantiq external SLIC interface may
+	be connected to external analog phone equipment.
+
+config SILABS_SLIC_SUPPORT
+	bool "Support Silicon Labs devices"
+	---help---
+	Choosing this option enables Silabs external
+	SLIC device.
+	Silabs external SLIC interface may
+	be connected to external analog phone equipment.
+
+config ZARLINK_SLIC_SUPPORT
+	bool "Support Zarlink/Legirity devices"
+
+
+endchoice
+
+choice
+	prompt "SLIC Device"
+	depends on MV_PHONE && LANTIQ_SLIC_SUPPORT
+	default LANTIQ_SLIC_DUSLIC_XT
+
+config LANTIQ_SLIC_DUSLIC_XT
+	bool "Support Lantiq DUSLIC-xT SLIC family"
+
+endchoice
+
+choice
+	prompt "SLIC Device"
+	depends on MV_PHONE && SILABS_SLIC_SUPPORT
+	default SILAB_SLIC_EXTERNAL_DRIVER
+
+config SILAB_SLIC_EXTERNAL_DRIVER
+	bool "Support Silicon Labs SLIC external driver modules"
+
+endchoice
+
+choice
+	prompt "SLIC Device"
+	depends on MV_PHONE && ZARLINK_SLIC_SUPPORT
+	default ZARLINK_SLIC_EXTERNAL_DRIVER
+
+config ZARLINK_SLIC_EXTERNAL_DRIVER
+	bool "Support Zarlink SLIC external driver modules"
+	---help---
+	Choosing this option enables Zarlink external slic driver support.
+
+endchoice
+
+choice
+	prompt "TDM Clock Source"
+	depends on MV_PHONE
+	default MV_TDM_USE_DCO
+
+config MV_TDM_USE_INTERNAL_PCLK_SOURCE
+	bool "Support PCLK internally generated"
+	depends on ARCH_FEROCEON
+	---help---
+	Choosing this option will enable
+	use of internally generated source clock
+	as PCM clock output, provided to TDM
+	interface.
+
+config MV_TDM_USE_EXTERNAL_PCLK_SOURCE
+	bool "Support PCLK from external source"
+	depends on ARCH_FEROCEON
+	---help---
+	Choosing this option will enable
+	use of external source clock
+	as PCM clock output, provided to TDM
+	interface.
+
+config MV_TDM_USE_DCO
+	bool "Support PCLK from DCO enabled PLL"
+	---help---
+	Choosing this option will enable
+	the use of DCO source clock provided
+	to TDM interface.
+
+endchoice
+
+choice
+	prompt "PCM Clock Frequency"
+	depends on MV_PHONE
+	default MV_TDM_PCM_CLK_8MHZ
+	---help---
+	This menu selects the PCM clock frequency generated
+	by the TDM master.
+	SLIC should be configured accordingly in order to
+	maintain bus coherency.
+
+config MV_TDM_PCM_CLK_8MHZ
+	bool "Support 8MHz PCM clock"
+	---help---
+	Choosing this option selects 8MHz PCM
+	clock frequency.
+	The source clock is driver according to
+	TDM Clock Source user selection.
+
+config MV_TDM_PCM_CLK_4MHZ
+	bool "Support 4MHz PCM clock"
+	---help---
+	Choosing this option selects 4MHz PCM
+	clock frequency.
+	The source clock is driver according to
+	TDM Clock Source user selection.
+
+config MV_TDM_PCM_CLK_2MHZ
+	bool "Support 2MHz PCM clock"
+	---help---
+	Choosing this option selects 2MHz PCM
+	clock frequency.
+	The source clock is driver according to
+	TDM Clock Source user selection.
+
+endchoice
+
+choice
+	prompt "TDM voice processing"
+	depends on MV_PHONE
+	default MV_PHONE_USE_SOFTIRQ_PROCESSING
+
+config MV_PHONE_USE_SOFTIRQ_PROCESSING
+	bool "Support TDM voice processing in softIRQ"
+	---help---
+	Choosing this option enables TDM voice
+	processing in softIRQ.
+	The voice data path is handled in high
+	tasklet context.
+
+config MV_PHONE_USE_IRQ_PROCESSING
+	bool "Support TDM voice processing in IRQ"
+	---help---
+	Choosing this option enables TDM voice
+	processing in IRQ.
+	The voice data path is fully handled in
+	interrupt context.
+
+config MV_PHONE_USE_FIQ_PROCESSING
+	bool "Support TDM voice processing in FIQ"
+	---help---
+	Choosing this option enables TDM voice
+	processing in FIQ.
+	The voice data path is fully handled in
+	fast interrupt context.
+
+endchoice
+
+config MV_TDM_EXT_STATS
+	bool "Enable legacy TDM extended statistics"
+	depends on MV_TDM_SUPPORT
+	default n
+	---help---
+	Choosing this option will export extended statistics to procfs.
+	This is relevant only for the legacy TDM unit.
+
+endmenu
-- 
1.7.5.4

