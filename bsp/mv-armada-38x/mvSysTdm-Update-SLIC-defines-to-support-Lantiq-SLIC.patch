From 48ffaf2f154bc3a31f3b0359236dbd56aefbda69 Mon Sep 17 00:00:00 2001
From: Eran Ben-Avi <benavi@marvell.com>
Date: Wed, 10 Jul 2013 19:20:01 +0300
Subject: [PATCH 0780/1825] mvSysTdm: Update SLIC defines to support Lantiq
 SLIC.

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 2f94a98b0efa85a0cbba2e5ebe33947f6619d694

	This commit adds all necessary defines for proper configuration
	of the mvSysTdm module when Lantiq SLIC is used.

Change-Id: Icda2b11552afa6de8c15b83b1226ecb084eb93a9
Signed-off-by: Piotr Ziecik <kosmo@semihalf.com>
Signed-off-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-feroceon-kw2/config/mvSysTdmConfig.h |    4 +++-
 arch/arm/mach-feroceon-kw2/mv_hal_if/mvSysTdm.c    |    8 ++++----
 2 files changed, 7 insertions(+), 5 deletions(-)

diff --git a/arch/arm/mach-feroceon-kw2/config/mvSysTdmConfig.h b/arch/arm/mach-feroceon-kw2/config/mvSysTdmConfig.h
index 30d73df..4b04d34 100644
--- a/arch/arm/mach-feroceon-kw2/config/mvSysTdmConfig.h
+++ b/arch/arm/mach-feroceon-kw2/config/mvSysTdmConfig.h
@@ -106,7 +106,7 @@ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 	#elif defined(CONFIG_SILAB_SLIC_SI3226)
 		#define SI3226X
 	#endif
-#else /* CONFIG_ZARLINK_SLIC_SUPPORT) */
+#elif defined(CONFIG_ZARLINK_SLIC_SUPPORT)
 	#define ZARLINK_SLIC_SUPPORT
 	#define SLIC_TIMER_EVENT_SUPPORT
 	#if defined(CONFIG_ZARLINK_SLIC_VE880)
@@ -116,6 +116,8 @@ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 	#elif defined(CONFIG_ZARLINK_SLIC_VE792)
 		#define ZARLINK_SLIC_VE792
 	#endif
+#else /* CONFIG_LANTIQ_SLIC_SUPPORT */
+	#define LANTIQ_SLIC_SUPPORT
 #endif
 
 #if defined(CONFIG_MV_TDM_USE_EXTERNAL_PCLK_SOURCE)
diff --git a/arch/arm/mach-feroceon-kw2/mv_hal_if/mvSysTdm.c b/arch/arm/mach-feroceon-kw2/mv_hal_if/mvSysTdm.c
index f6f4d03..c315f14 100644
--- a/arch/arm/mach-feroceon-kw2/mv_hal_if/mvSysTdm.c
+++ b/arch/arm/mach-feroceon-kw2/mv_hal_if/mvSysTdm.c
@@ -135,7 +135,7 @@ MV_STATUS mvSysTdmInit(MV_TDM_PARAMS* tdmParams)
 
 MV_VOID mvSysTdmSpiRead(MV_U16 lineId, MV_U8* cmdBuff, MV_U8 cmdSize, MV_U8* dataBuff, MV_U8 dataSize)
 {
-#if defined(MV_TDM_SUPPORT) && !defined(ZARLINK_SLIC_SUPPORT) && !defined(SILABS_SLIC_SUPPORT)
+#if defined(MV_TDM_SUPPORT) && !defined(ZARLINK_SLIC_SUPPORT) && !defined(SILABS_SLIC_SUPPORT) && !defined(LANTIQ_SLIC_SUPPORT)
 
 	if((cmdSize > 4) || (dataSize > MAX_DATA_LENGTH))
 	{
@@ -145,7 +145,7 @@ MV_VOID mvSysTdmSpiRead(MV_U16 lineId, MV_U8* cmdBuff, MV_U8 cmdSize, MV_U8* dat
 
 	mvTdmSpiRead(cmdBuff, cmdSize, dataBuff, dataSize, lineId);
 
-#else /* MV_COMM_UNIT_SUPPORT || ZARLINK_SLIC_SUPPORT || SILABS_SLIC_SUPPORT */
+#else /* MV_COMM_UNIT_SUPPORT || ZARLINK_SLIC_SUPPORT || SILABS_SLIC_SUPPORT || LANTIQ_SLIC_SUPPORT */
 
 	/* Set SPI parameters(lineId = devId) */
 	mvSpiParamsSet(mvBoardTdmSpiIdGet(), mvBoardTdmSpiCsGet(lineId), SPI_TYPE_SLIC);
@@ -171,7 +171,7 @@ MV_VOID mvSysTdmSpiRead(MV_U16 lineId, MV_U8* cmdBuff, MV_U8 cmdSize, MV_U8* dat
 *******************************************************************************/
 MV_VOID mvSysTdmSpiWrite(MV_U16 lineId, MV_U8* cmdBuff, MV_U8 cmdSize, MV_U8* dataBuff, MV_U8 dataSize)
 {
-#if defined(MV_TDM_SUPPORT) && !defined(ZARLINK_SLIC_SUPPORT) && !defined(SILABS_SLIC_SUPPORT)
+#if defined(MV_TDM_SUPPORT) && !defined(ZARLINK_SLIC_SUPPORT) && !defined(SILABS_SLIC_SUPPORT) && !defined(LANTIQ_SLIC_SUPPORT)
 
 	if((cmdSize > 3) || (dataSize > MAX_DATA_LENGTH))
 	{
@@ -181,7 +181,7 @@ MV_VOID mvSysTdmSpiWrite(MV_U16 lineId, MV_U8* cmdBuff, MV_U8 cmdSize, MV_U8* da
 
 	mvTdmSpiWrite(cmdBuff, cmdSize, dataBuff, dataSize, lineId);
 
-#else /* MV_COMM_UNIT_SUPPORT || ZARLINK_SLIC_SUPPORT || SILABS_SLIC_SUPPORT*/
+#else /* MV_COMM_UNIT_SUPPORT || ZARLINK_SLIC_SUPPORT || SILABS_SLIC_SUPPORT || LANTIQ_SLIC_SUPPORT */
 
 	/* Set SPI parameters(lineId = devId) */
 	mvSpiParamsSet(mvBoardTdmSpiIdGet(), mvBoardTdmSpiCsGet(lineId), SPI_TYPE_SLIC);
-- 
1.7.5.4

