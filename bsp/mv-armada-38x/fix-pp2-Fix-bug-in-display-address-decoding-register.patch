From 3a4cc74ea27c9bd2807a4cb9285cbd9aacb57736 Mon Sep 17 00:00:00 2001
From: Dmitri Epshtein <dima@marvell.com>
Date: Sat, 12 Oct 2013 20:05:42 -0400
Subject: [PATCH 1018/1825] fix: pp2: Fix bug in display address decoding
 registers

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit ed4d045444d160c3d57a7176e234e790b14f8720

	Polarity of window enable was changed from 0 to 1

Change-Id: I40906818045617589d642a23c5d1869201e66de8
Signed-off-by: Dmitri Epshtein <dima@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/3681
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Igor Patrik <igorp@marvell.com>
Reviewed-by: Jonatan Farhadian <yonif@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2AddrDec.c |    2 +-
 .../arm/plat-armada/mv_hal/pp2/gbe/mvPp2GbeDebug.c |    3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2AddrDec.c b/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2AddrDec.c
index 75676e7..d7c00a4 100644
--- a/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2AddrDec.c
+++ b/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2AddrDec.c
@@ -311,7 +311,7 @@ MV_STATUS mvPp2WinRead(MV_U32 dummy/*backward compability*/, MV_U32 winNum, MV_U
 	pAddrDecWin->targetId = (baseReg & ETH_WIN_TARGET_MASK) >> ETH_WIN_TARGET_OFFS;
 
 	/* Check if window is enabled   */
-	if (~(mvPp2RdReg(ETH_BASE_ADDR_ENABLE_REG)) & (1 << winNum))
+	if ((mvPp2RdReg(ETH_BASE_ADDR_ENABLE_REG)) & (1 << winNum))
 		pAddrDecWin->enable = MV_TRUE;
 	else
 		pAddrDecWin->enable = MV_FALSE;
diff --git a/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2GbeDebug.c b/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2GbeDebug.c
index adc8eb1..3ff0840 100644
--- a/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2GbeDebug.c
+++ b/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2GbeDebug.c
@@ -421,8 +421,9 @@ void mvPp2AddrDecodeRegs(void)
 
 	regValue = mvPp2RdReg(ETH_BASE_ADDR_ENABLE_REG);
 	for (win = 0; win < ETH_MAX_DECODE_WIN; win++) {
-		if (regValue & (1 << win))
+		if ((regValue & (1 << win)) == 0)
 			continue; /* window is disable */
+
 		mvOsPrintf("\t win[%d]\n", win);
 		mvPp2PrintReg(ETH_WIN_BASE_REG(win), "\t ETH_WIN_BASE_REG");
 		mvPp2PrintReg(ETH_WIN_SIZE_REG(win), "\t ETH_WIN_SIZE_REG");
-- 
1.7.5.4

