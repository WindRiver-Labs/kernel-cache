From c6d79259d3c75c75528b8f819db2adf97ed0c270 Mon Sep 17 00:00:00 2001
From: Yelena <yelena@marvell.com>
Date: Thu, 24 Oct 2013 09:48:33 +0200
Subject: [PATCH 1056/1825] pp2: hal - new function added for netap support

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit bd0570fbc6f9130514e73565b044320a6291ac26

Change-Id: I17cd6cac21d538fde41a72e695361aeba1e646e8
Reviewed-on: http://vgitil04.il.marvell.com:8080/3842
Reviewed-by: Uri Eliyahu <uriel@marvell.com>
Reviewed-by: Dmitri Epshtein <dima@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h |   10 ++++++++++
 1 files changed, 10 insertions(+), 0 deletions(-)

diff --git a/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h b/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h
index 162d081..3e8a4a9 100644
--- a/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h
+++ b/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h
@@ -370,6 +370,16 @@ static INLINE void mvPp2RxqNonOccupDescAdd(int port, int rxq, int rx_desc)
 	mvPp2WrReg(MV_PP2_RXQ_STATUS_UPDATE_REG(prxq), regVal);
 }
 
+/* Decrement number of processed descriptors */
+static INLINE void mvPp2RxqOccupDescDec(int port, int rxq, int rx_done)
+{
+	MV_U32 regVal;
+	int prxq = mvPp2LogicRxqToPhysRxq(port, rxq);
+
+	regVal = (rx_done << MV_PP2_RXQ_NUM_PROCESSED_OFFSET);
+	mvPp2WrReg(MV_PP2_RXQ_STATUS_UPDATE_REG(prxq), regVal);
+}
+
 /*-------------------------------------------------------------------------------*/
 /* Get number of TXQ descriptors waiting to be transmitted by HW */
 static INLINE int mvPp2TxqPendDescNumGet(int port, int txp, int txq)
-- 
1.7.5.4

