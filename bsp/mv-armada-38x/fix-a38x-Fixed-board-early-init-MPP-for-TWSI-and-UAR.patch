From cd372d2e21ba6767158af0999921002cd0a9264b Mon Sep 17 00:00:00 2001
From: Eli Nidam <elini@marvell.com>
Date: Mon, 28 Oct 2013 15:11:19 +0200
Subject: [PATCH 1124/1825] fix: a38x: Fixed board early init MPP for TWSI and
 UART

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit fbfeb1c89d1235981af10f67407f02249c3fe94c

        1. Added early set mpp for group 0 (TWSI and UART0)
        2. Remove set mpp for group 1 (from Avanta) not use for A38x

Change-Id: Id3af03471f25a197a57c720d999a4c5661e1d053
Signed-off-by: Eli Nidam <elini@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/3884
Reviewed-by: Omri Itach <omrii@marvell.com>
Tested-by: Omri Itach <omrii@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../armada_38x_family/boardEnv/mvBoardEnvSpec.h    |    3 ++-
 .../armada_38x_family/ctrlEnv/mvCtrlEnvLib.c       |    3 ---
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/arch/arm/mach-armada38x/armada_38x_family/boardEnv/mvBoardEnvSpec.h b/arch/arm/mach-armada38x/armada_38x_family/boardEnv/mvBoardEnvSpec.h
index b641a01..d021d63 100644
--- a/arch/arm/mach-armada38x/armada_38x_family/boardEnv/mvBoardEnvSpec.h
+++ b/arch/arm/mach-armada38x/armada_38x_family/boardEnv/mvBoardEnvSpec.h
@@ -108,7 +108,8 @@
    57-59	SDIO 8 Bit				5
     51		USB Device detect0			0
 */
-#define GROUP1_DEFAULT_MPP_SPI_I2C         0x22000022  /* SPI , I2C */
+#define GROUP0_DEFAULT_MPP_TWSI_I2C         0x1111  /* TWSI , I2C */
+#define GROUP0_DEFAULT_MPP_TWSI_I2C_MASK    0xFFFF  /* TWSI , I2C */
 /*******************************************************************************
 * A380 DB-68xx board
 *******************************************************************************/
diff --git a/arch/arm/mach-armada38x/armada_38x_family/ctrlEnv/mvCtrlEnvLib.c b/arch/arm/mach-armada38x/armada_38x_family/ctrlEnv/mvCtrlEnvLib.c
index 73b27bb..a89a8e2 100644
--- a/arch/arm/mach-armada38x/armada_38x_family/ctrlEnv/mvCtrlEnvLib.c
+++ b/arch/arm/mach-armada38x/armada_38x_family/ctrlEnv/mvCtrlEnvLib.c
@@ -322,9 +322,6 @@ MV_STATUS mvCtrlEnvInit(MV_VOID)
 {
 	MV_U32 i, gppMask;
 
-	/* Set I2C MPP's(MPP Group 1), before reading board configuration, using TWSI read */
-	MV_REG_WRITE(mvCtrlMppRegGet(1), GROUP1_DEFAULT_MPP_SPI_I2C);
-
 
 	/* If set to Auto detect, read board config info, update MPP group types*/
 	if (mvBoardConfigAutoDetectEnabled()) {
-- 
1.7.5.4

