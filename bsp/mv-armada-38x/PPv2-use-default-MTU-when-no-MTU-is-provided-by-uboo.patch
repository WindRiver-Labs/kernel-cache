From a0ffb37fe6b03d7d9f6b5a2fc5f27423506fbc48 Mon Sep 17 00:00:00 2001
From: Yoni Farhadian <yonif@marvell.com>
Date: Mon, 20 May 2013 13:41:08 +0300
Subject: [PATCH 0657/1825] PPv2: use default MTU when no MTU is provided by
 uboot

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 6926dc67a1c8622189493887b115334c214becc3

Change-Id: I8731f12f8e333a11b47153cc28abe06689648bb6
Reviewed-on: http://vgitil04.il.marvell.com:8080/1876
Reviewed-by: Star_Automation <star@marvell.com>
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-avantalp/core.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-avantalp/core.c b/arch/arm/mach-avantalp/core.c
index be2a906..8192683 100644
--- a/arch/arm/mach-avantalp/core.c
+++ b/arch/arm/mach-avantalp/core.c
@@ -535,6 +535,11 @@ static void mv_pp2_giga_pdev_register(struct platform_device *pdev)
 
 	if (port < MV_UBOOT_ETH_PORTS) {
 		plat_data->mtu = mvMtu[port];
+		if (plat_data->mtu == 0) {
+			plat_data->mtu = 1500;
+			printk(KERN_ERR "%s: warning - failed to use MTU from uboot env, changing to default MTU (1500).\n", __func__);
+		}
+
 		memcpy(plat_data->mac_addr, mvMacAddr[port], 6);
 	} else {
 		plat_data->mtu = 1500;
-- 
1.7.5.4

