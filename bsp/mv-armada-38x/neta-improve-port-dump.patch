From 2d6262a3ffee0ace1178d4ddf8f5a8ee827b8fb5 Mon Sep 17 00:00:00 2001
From: Uri Eliyahu <uriel@marvell.com>
Date: Tue, 4 Mar 2014 12:26:56 +0200
Subject: [PATCH 1441/1825] neta: improve port dump

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 00d068f41ad3c210134cea87f628b1f762e1183e

Change-Id: Iff6ef813c13831285bc1e88dfd082920b2d6c817
Signed-off-by: Uri Eliyahu <uriel@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../mv_drivers_lsp/mv_neta/net_dev/mv_netdev.c     |   18 +++++-------------
 1 files changed, 5 insertions(+), 13 deletions(-)

diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_neta/net_dev/mv_netdev.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_neta/net_dev/mv_netdev.c
index a0531e8..3e848ff 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_neta/net_dev/mv_netdev.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_neta/net_dev/mv_netdev.c
@@ -5815,12 +5815,7 @@ void mv_eth_netdev_print(struct net_device *dev)
 			(unsigned int)(dev->flags), (unsigned int)(dev->gflags),
 			netif_running(dev), netif_oper_up(dev));
 
-	if (mv_eth_netdev_find(dev->ifindex)) {
-		struct eth_port *pp = MV_ETH_PRIV(dev);
-
-		if (pp)
-			printk(KERN_ERR "pp=%p\n", pp);
-	} else
+	if (!mv_eth_netdev_find(dev->ifindex))
 		/* mux net device */
 		mv_mux_netdev_print(dev);
 }
@@ -5851,8 +5846,9 @@ void mv_eth_port_status_print(unsigned int port)
 	if (!pp)
 		return;
 
-	printk(KERN_ERR "\n");
-	printk(KERN_ERR "port=%d, flags=0x%lx, rx_weight=%d\n", port, pp->flags, pp->weight);
+	pr_info("\nport=%d, flags=0x%lx, rx_weight=%d, %s\n", port, pp->flags, pp->weight,
+			pp->tagged ? "tagged" : "untagged");
+
 	if (pp->flags & MV_ETH_F_CONNECT_LINUX)
 		printk(KERN_ERR "%s: ", pp->dev->name);
 	else
@@ -5969,12 +5965,8 @@ void mv_eth_port_status_print(unsigned int port)
 	if (pp->dev)
 		mv_eth_netdev_print(pp->dev);
 
-	if (pp->tagged) {
-		printk(KERN_CONT "TAGGED PORT\n\n");
+	if (pp->tagged)
 		mv_mux_netdev_print_all(port);
-	} else
-		printk(KERN_CONT "UNTAGGED PORT\n");
-
 }
 
 /***********************************************************************************
-- 
1.7.5.4

