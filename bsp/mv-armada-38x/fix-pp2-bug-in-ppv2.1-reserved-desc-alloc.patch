From 52da355bb2d0ea27e8d2b09cb91ab4dcedaded74 Mon Sep 17 00:00:00 2001
From: Uri Eliyahu <uriel@marvell.com>
Date: Mon, 25 Nov 2013 17:36:00 +0200
Subject: [PATCH 1153/1825] fix: pp2: bug in ppv2.1 reserved desc alloc

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit b2692507f112bac1691381a3f2ef6809c095df53

	- bug in reserved descriptors allocation function
	- fix for ppv2.1 (A0)

Change-Id: I253f973bf23bf69fe444bc3ebea09a7dad4c73be
Signed-off-by: Uri Eliyahu <uriel@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/4448
Reviewed-by: Dmitri Epshtein <dima@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h b/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h
index a986a51..eab38bc 100644
--- a/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h
+++ b/arch/arm/plat-armada/mv_hal/pp2/gbe/mvPp2Gbe.h
@@ -393,7 +393,7 @@ static INLINE int mvPp2TxqAllocReservedDesc(int port, int txp, int txq, int num)
 	MV_U32 regVal, ptxq;
 
 	ptxq = MV_PPV2_TXQ_PHYS(port, txp, txq);
-	regVal = (ptxq << MV_PP2_TXQ_RSVD_REQ_Q_OFFSET) || (num << MV_PP2_TXQ_RSVD_REQ_DESC_OFFSET);
+	regVal = (ptxq << MV_PP2_TXQ_RSVD_REQ_Q_OFFSET) | (num << MV_PP2_TXQ_RSVD_REQ_DESC_OFFSET);
 	mvPp2WrReg(MV_PP2_TXQ_RSVD_REQ_REG, regVal);
 
 	regVal = mvPp2RdReg(MV_PP2_TXQ_RSVD_RSLT_REG);
-- 
1.7.5.4

