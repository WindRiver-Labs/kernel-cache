From f842ab66700ebc4be2b878a7350abfe8f5d51bf0 Mon Sep 17 00:00:00 2001
From: Omri Itach <omrii@marvell.com>
Date: Mon, 3 Dec 2012 17:41:19 +0200
Subject: [PATCH 0376/1825] Fix for Compilation error in piuxiu support patch
 below. The newly added code uses a routine
 compiled with PERF support only.

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 3b57210b1b4004723928e4282687960b5c925e7b

Author: Hanna Hawa <hannah@marvell.com>
Date:   Tue Nov 20 13:32:32 2012 +0200

    Added pmu_request_irq function to support Code Performance Analyzer (Pixiu)

Change-Id: I20ff36717d330024cde19408f5ed1ea085478261

Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-armadaxp/irq.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-armadaxp/irq.c b/arch/arm/mach-armadaxp/irq.c
index e792403..3151f58 100644
--- a/arch/arm/mach-armadaxp/irq.c
+++ b/arch/arm/mach-armadaxp/irq.c
@@ -323,6 +323,7 @@ void __init axp_init_irq(void)
 
 }
 
+#if (defined(CONFIG_PERF_EVENTS) && defined(CONFIG_HW_PERF_EVENTS))
 /*
  * This functions used by Pixiu driver under tools/pixiu.
  */
@@ -348,5 +349,5 @@ void pmu_free_irq(int irq)
         free_irq(irq, NULL);
 }
 EXPORT_SYMBOL(pmu_free_irq);
-
+#endif
 
-- 
1.7.5.4

