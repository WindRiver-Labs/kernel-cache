From 3a24d6c800c1fc97cc0452f636e7e4c66af265ab Mon Sep 17 00:00:00 2001
From: Omri Itach <omrii@marvell.com>
Date: Sun, 9 Jun 2013 13:19:21 +0300
Subject: [PATCH 0711/1825] ALP: Fixed MPP Auto detection: use UART1 instead
 of LEDS (for AMP support)

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 8804e2f8514a6ef16f3065423de28bc70529b0a6

Change-Id: Ica37121135b3c5fce074ce3d0ae8907cb1c1d096
Signed-off-by: Omri Itach <omrii@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/2180
Reviewed-by: Eli Nidam <elini@marvell.com>
Reviewed-by: Star_Automation <star@marvell.com>
Reviewed-by: Igor Patrik <igorp@marvell.com>
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../avanta_lp_family/boardEnv/mvBoardEnvLib.c      |   10 ++++++++--
 1 files changed, 8 insertions(+), 2 deletions(-)

diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
index 53a1d03..1fba5a5 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
@@ -914,11 +914,17 @@ MV_VOID mvBoardMppIdUpdate(MV_VOID)
 	if (ethComplexOptions & MV_ETHCOMP_GE_MAC0_2_RGMII0) {
 		mvBoardMppTypeSet(5, GE0_UNIT_PON_TX_FAULT);
 		mvBoardMppTypeSet(6, GE0_UNIT);
-		mvBoardMppTypeSet(7, GE0_UNIT_LED_MATRIX);
+		if (mvCtrlGetCpuNum() == 0) /* if using Dual CPU ,set UART1 */
+			mvBoardMppTypeSet(7, GE0_UNIT_LED_MATRIX);
+		else
+			mvBoardMppTypeSet(7, GE0_UNIT_UA1_PTP);
 	} else if (ethComplexOptions & MV_ETHCOMP_SW_P4_2_RGMII0) {
 		mvBoardMppTypeSet(5, SWITCH_P4_PON_TX_FAULT);
 		mvBoardMppTypeSet(6, SWITCH_P4);
-		mvBoardMppTypeSet(7, SWITCH_P4_LED_MATRIX);
+		if (mvCtrlGetCpuNum() == 0) /* if using Dual CPU ,set UART1 */
+			mvBoardMppTypeSet(7, SWITCH_P4_LED_MATRIX);
+		else
+			mvBoardMppTypeSet(7, SWITCH_P4_UA1_PTP);
 	}
 }
 
-- 
1.7.5.4

