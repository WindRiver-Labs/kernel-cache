From 9f9f40ed5d0bc33d8b1402dfa94f5f9027dc6adf Mon Sep 17 00:00:00 2001
From: Eran Ben-Avi <benavi@marvell.com>
Date: Thu, 11 Jul 2013 18:12:27 +0300
Subject: [PATCH 0812/1825] ALP: Include FIQ vector for AvantaLP.

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit c5aba6cd102b5a5ae395f2f238313826d22fd378

Change-Id: Icd6df21b015a629fbedfd0124aaaa30b45a35270
Signed-off-by: Grzegorz Jaszczyk <jaz@semihalf.com>
Signed-off-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/kernel/entry-armv.S |    5 ++---
 1 files changed, 2 insertions(+), 3 deletions(-)

diff --git a/arch/arm/kernel/entry-armv.S b/arch/arm/kernel/entry-armv.S
index f3ee506..9ec2a04 100644
--- a/arch/arm/kernel/entry-armv.S
+++ b/arch/arm/kernel/entry-armv.S
@@ -1170,7 +1170,7 @@ __stubs_start:
  * other mode than FIQ...  Ok you can switch to another mode, but you can't
  * get out of that mode without clobbering one register.
  */
-#ifdef CONFIG_ARCH_FEROCEON
+#if defined(CONFIG_ARCH_FEROCEON) || defined(CONFIG_ARCH_AVANTA_LP)
 vector_fiq:
 #ifdef CONFIG_MV_PHONE_USE_FIQ_PROCESSING
 	/* if no handler installed, bail out */
@@ -1205,10 +1205,9 @@ fiq_cnt:
 	.long 0
 .previous
 #else /* CONFIG_MV_PHONE_USE_FIQ_PROCESSING */
-	disable_fiq
 	subs	pc, lr, #4
 #endif /* CONFIG_MV_PHONE_USE_FIQ_PROCESSING */
-#else /* !CONFIG_ARCH_FEROCEON */
+#else /* !CONFIG_ARCH_FEROCEON && !CONFIG_ARCH_AVANTA_LP*/
 vector_fiq:
 	subs	pc, lr, #4
 #endif
-- 
1.7.5.4

