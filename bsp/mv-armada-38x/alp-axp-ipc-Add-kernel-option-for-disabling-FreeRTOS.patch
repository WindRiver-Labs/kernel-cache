From 5c910a79e9a46e7b5ae06c8c512875e5719d87c6 Mon Sep 17 00:00:00 2001
From: Piotr Ziecik <kosmo@semihalf.com>
Date: Mon, 7 Apr 2014 15:27:23 +0200
Subject: [PATCH 1547/1825] =?UTF-8?q?alp/axp:=20ipc=EF=BC=9A=20Add=20kernel=20?=
 =?UTF-8?q?option=20for=20disabling=20FreeRTOS=20IPC=20Demo.?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit aa5fac184ed7ed7c8edffecdb5802e52e4b0b9f7

	The FreeRTOS IPC Demo cannot be used together with
	DFEV on Dragonite, so it is not compiled-in when
	DFEV SLIC support is enabled.

Change-Id: Ie0404f3318586c70e947e82d84a5006318f35936
Signed-off-by: Piotr Ziecik <kosmo@semihalf.com>
Signed-off-by: Victor Gu <xigu@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/6994
Reviewed-by: Yehuda Yitschak <yehuday@marvell.com>
Tested-by: Yehuda Yitschak <yehuday@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/Kconfig                       |    5 +++++
 .../arm/plat-armada/mv_drivers_lsp/mv_ipc/Makefile |    5 ++---
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/arch/arm/plat-armada/Kconfig b/arch/arm/plat-armada/Kconfig
index 49b9c94..b51c957 100644
--- a/arch/arm/plat-armada/Kconfig
+++ b/arch/arm/plat-armada/Kconfig
@@ -302,6 +302,11 @@ config MV_IPC_FREERTOS_DRIVER
         depends on (MV_AMP_ENABLE || MV_INCLUDE_DRAGONITE) && !MV_IPC_LINUX_AMP_DRIVER
 	default n
 
+config MV_IPC_FREERTOS_DEMO
+	bool "Enable freeRTOS IPC Demo"
+	depends on MV_IPC_FREERTOS_DRIVER && !LANTIQ_DFEV_SLIC_SUPPORT
+	default n
+
 config MV_DRAM_BASE
        hex  "AMP build usage - Do not change"
        depends on MV_AMP_ENABLE
diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_ipc/Makefile b/arch/arm/plat-armada/mv_drivers_lsp/mv_ipc/Makefile
index 6956533..aa381d0 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_ipc/Makefile
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_ipc/Makefile
@@ -11,6 +11,5 @@ obj-$(CONFIG_MV_IPC_LINUX_AMP_DRIVER) += linux_amp/
 
 #kernel<->freeRTOS AMP mode
 obj-$(CONFIG_MV_IPC_FREERTOS_DRIVER) += linux_freertos/mv_ipc_os.o linux_freertos/mv_ipc_doorbell.o \
-								linux_freertos/mv_ipc_poll.o linux_freertos/mv_ipc_common.o \
-								linux_freertos/ipc_demo.o
-
+					linux_freertos/mv_ipc_poll.o linux_freertos/mv_ipc_common.o
+obj-$(CONFIG_MV_IPC_FREERTOS_DEMO) += linux_freertos/ipc_demo.o
-- 
1.7.5.4

