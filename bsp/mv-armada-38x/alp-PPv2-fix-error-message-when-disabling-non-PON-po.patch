From d20698f40530c6845aee60c4e30a36461ae0e8ae Mon Sep 17 00:00:00 2001
From: Yoni Farhadian <yonif@marvell.com>
Date: Wed, 26 Jun 2013 15:55:06 +0300
Subject: [PATCH 0740/1825] alp: PPv2: fix error message when disabling non
 PON port

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 4f0c133b9588ee1428ce60301003fb8d81e5d7b8

Change-Id: I83966b64b76ca9ca319e509853462adda4d0b5cb
Signed-off-by: Yoni Farhadian <yonif@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/2358
Reviewed-by: Igor Patrik <igorp@marvell.com>
Tested-by: Igor Patrik <igorp@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c      |    9 +++++----
 1 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
index 1282600..4c9cf5b 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
@@ -3782,7 +3782,6 @@ int mv_eth_suspend_internals(struct eth_port *pp)
  ***********************************************************/
 int mv_eth_stop_internals(struct eth_port *pp)
 {
-
 	int queue, txp;
 
 	if (!test_and_clear_bit(MV_ETH_F_STARTED_BIT, &(pp->flags))) {
@@ -3798,9 +3797,11 @@ int mv_eth_stop_internals(struct eth_port *pp)
 		mv_eth_txp_clean(pp->port, txp);
 
 
-	if (!MV_PON_PORT(pp->port) && (mvPp2PortDisable(pp->port) != MV_OK)) {
-		printk(KERN_ERR "GbE port %d: ethPortDisable failed\n", pp->port);
-		goto error;
+	if (!MV_PON_PORT(pp->port)) {
+		if (mvPp2PortDisable(pp->port) != MV_OK) {
+			printk(KERN_ERR "GbE port %d: ethPortDisable failed\n", pp->port);
+			goto error;
+		}
 	}
 #ifdef CONFIG_MV_INCLUDE_PON
 	else if (mv_pon_disable() != MV_OK) {
-- 
1.7.5.4

