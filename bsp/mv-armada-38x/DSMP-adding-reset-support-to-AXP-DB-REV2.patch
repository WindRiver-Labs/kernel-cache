From abc74ead6feac145eb593896f714ad78adfcb719 Mon Sep 17 00:00:00 2001
From: Tawfik Bayouk <tawfik@marvell.com>
Date: Tue, 21 Aug 2012 17:34:04 +0300
Subject: [PATCH 0091/1825] DSMP adding reset support to AXP-DB-REV2

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 06e5b8e6058ebfc427a5b247366e13a885cffe36

Change-Id: Ic152b21a9af2216446ef9e1737c77ae365de665b
Signed-off-by: Tawfik Bayouk <tawfik@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-armadaxp/Makefile.boot |   13 +++++++++----
 arch/arm/mach-armadaxp/core.c        |    5 ++++-
 2 files changed, 13 insertions(+), 5 deletions(-)

diff --git a/arch/arm/mach-armadaxp/Makefile.boot b/arch/arm/mach-armadaxp/Makefile.boot
index ff0a4b5..0ef7d93 100644
--- a/arch/arm/mach-armadaxp/Makefile.boot
+++ b/arch/arm/mach-armadaxp/Makefile.boot
@@ -1,4 +1,9 @@
-   zreladdr-y	+= 0x00008000
-params_phys-y	:= 0x00000100
-initrd_phys-y	:= 0x00800000
-
+ifdef CONFIG_MV_AMP_ENABLE
+   zreladdr-y   := $(CONFIG_MV_ZREL_ADDR)
+params_phys-y   := $(CONFIG_MV_PARAM_PHYS)
+initrd_phys-y   := $(CONFIG_MV_INITRD_PHYS)
+else
+    zreladdr-y	:= 0x00008000
+ params_phys-y	:= 0x00000100
+ initrd_phys-y	:= 0x00800000
+endif
diff --git a/arch/arm/mach-armadaxp/core.c b/arch/arm/mach-armadaxp/core.c
index 422ce8d..ff8602d 100644
--- a/arch/arm/mach-armadaxp/core.c
+++ b/arch/arm/mach-armadaxp/core.c
@@ -1336,8 +1336,11 @@ static void __init axp_db_init(void)
 	cpu_fabric_common_init();
 
 	/* Select appropriate Board ID for Machine */
+#ifdef CONFIG_ARMADA_XP_REV_A0
+	gBoardId = DB_88F78XX0_BP_REV2_ID;
+#else
 	gBoardId = DB_88F78XX0_BP_ID;
-
+#endif
 	/* Before initializing the HAL, select Z1A serdes cfg if needed */
 	if (support_Z1A_serdes_cfg)
 		mvBoardSerdesZ1ASupport();
-- 
1.7.5.4

