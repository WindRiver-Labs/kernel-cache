From 6de4a3e1896dc84c9699ebf0d55bbf057558e88b Mon Sep 17 00:00:00 2001
From: Nadav Haklai <nadavh@marvell.com>
Date: Wed, 24 Oct 2012 10:40:44 +0200
Subject: [PATCH 0266/1825] Fix sysfs command to read/write from PHY
 registers. All arguments for all commands in hex
 format

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit b3d2da2b5c0b8cef3cc1e63c6165bafc49555fdd

Change-Id: I40046743d9ec3c7d094e996e9c0d1626b4b32811
Signed-off-by: Nadav Haklai <nadavh@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../plat-armada/mv_drivers_lsp/mv_phy/phy_sysfs.c  |   13 ++++++-------
 1 files changed, 6 insertions(+), 7 deletions(-)

diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_phy/phy_sysfs.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_phy/phy_sysfs.c
index b7c39ea..b2e599f 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_phy/phy_sysfs.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_phy/phy_sysfs.c
@@ -34,18 +34,17 @@ disclaimer.
 
 #include "gbe/mvNeta.h"
 #include "net_dev/mv_netdev.h"
-/*#include "../eth-phy/mvEthPhy.h"*/
 #include "eth-phy/mvEthPhy.h"
 
 static ssize_t phy_help(char *buf)
 {
 	int off = 0;
 
-	off += sprintf(buf+off, "echo a       > status        - print port Speed, Duplex, Auto-negotiation, Link, <a-phy address>. \n");
-	off += sprintf(buf+off, "echo a r     > read_reg      - read ethernet phy <a-phy address> register <r-hex>\n");
-	off += sprintf(buf+off, "echo a r v   > write_reg     - write value <v-hex> to ethernet phy register <r-hex>\n");
-	off += sprintf(buf+off, "echo p       > phy_init      - init phy <p-port> .\n");
-	off += sprintf(buf+off, "echo a       > restart_an    - restart ethernet Phy <a-phy address> Auto-Negotiationinit.\n");
+	off += sprintf(buf+off, "echo a       > status        - print phy status <a-phy address>.\n");
+	off += sprintf(buf+off, "echo a r     > read_reg      - read phy <a-phy address> register <r-hex>\n");
+	off += sprintf(buf+off, "echo a r v   > write_reg     - write value <v-hex> to  phy (a-phy address) register <r-hex>\n");
+	off += sprintf(buf+off, "echo p       > phy_init      - init phy <p-port>.\n");
+	off += sprintf(buf+off, "echo a       > restart_an    - restart phy <a-phy address> Auto-Negotiation.\n");
 
 	return off;
 }
@@ -107,7 +106,7 @@ static ssize_t phy_3_hex_store(struct device *dev,
 		return -EPERM;
 
 	err = p = reg = val = 0;
-	sscanf(buf, "%d %x %x", &p, &reg, &val);
+	sscanf(buf, "%x %x %x", &p, &reg, &val);
 
 	local_irq_save(flags);
 
-- 
1.7.5.4

