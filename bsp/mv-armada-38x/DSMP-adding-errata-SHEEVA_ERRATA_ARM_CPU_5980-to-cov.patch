From 764396b45ddfbcd79c23d354c609c0f8979f5174 Mon Sep 17 00:00:00 2001
From: Tawfik Bayouk <tawfik@marvell.com>
Date: Tue, 21 Aug 2012 17:33:40 +0300
Subject: [PATCH 0064/1825] DSMP adding errata SHEEVA_ERRATA_ARM_CPU_5980 to
 cover core eratta 5980

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 7252bbccc666999427a96c4a4e6e412b0fab5af9

Change-Id: I56086ee618f1ff2c50ea5a2133d3a65349b966a5
Signed-off-by: Tawfik Bayouk <tawfik@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mm/Kconfig |   18 ++++++++++++++++++
 1 files changed, 18 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mm/Kconfig b/arch/arm/mm/Kconfig
index aa1723a..42a68b9 100644
--- a/arch/arm/mm/Kconfig
+++ b/arch/arm/mm/Kconfig
@@ -967,6 +967,24 @@ config SHEEVA_ERRATA_ARM_CPU_4948
 	  line boundary (i.e., unaligned access). If it does occur, L0 data
 	  cache can be disabled
 
+
+
+config SHEEVA_ERRATA_ARM_CPU_5980
+
+        bool "Sheeva Errata 5980: Ordering Issues associated with Streaming device write"
+        depends on  CPU_SHEEVA_PJ4B_V7 && ARMADA_XP_REV_A0
+	default y
+        help
+	A stream of device writes are performed with the same AXI ID, followed by a write-back, write-allocate cacheable
+	exclusive write that has the same AXI ID.  There is an issue with the System L2 AXI logic that allows the response of
+	the exclusive write to return with EXOK prior to the response of all of the devices.
+	WA:
+		Disable the device write streaming capability.  This can be done by:
+		;; use read/modify/write
+		;; set bit 29 to .1. (default is 0)
+		MCR p15, 1, <Rd>, c15, c1,2
+
+
 config SHEEVA_ERRATA_ARM_CPU_PMU_RESET
 	bool "Sheeva Errata CPU Performance counters reset"
 	depends on CPU_SHEEVA_PJ4B_V6 || CPU_SHEEVA_PJ4B_V7
-- 
1.7.5.4

