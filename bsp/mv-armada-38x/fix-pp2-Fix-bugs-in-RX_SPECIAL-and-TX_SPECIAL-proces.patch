From bb9438460b2f579ab49dfdfd33312746a7fed55d Mon Sep 17 00:00:00 2001
From: Dmitri Epshtein <dima@marvell.com>
Date: Thu, 22 Aug 2013 13:22:07 -0400
Subject: [PATCH 0960/1825] fix: pp2: Fix bugs in RX_SPECIAL and TX_SPECIAL
 processing.

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 2f440ea40063bfb2fd405465e65692f78c1486b1

	Fix eth_rx_refill under CONFIG_MV_ETH_RX_SPECIAL
	Fix disable zero padding in mv_eth_tx()

Change-Id: I9cc5a0ed0bd0b4899daa4fb593a71dc4b9cf191e
Signed-off-by: Dmitri Epshtein <dima@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/3072
Reviewed-by: Jonatan Farhadian <yonif@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c      |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
index 90df3dd..d72dbe7 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
@@ -1662,7 +1662,7 @@ static inline int mv_eth_rx(struct eth_port *pp, int rx_todo, int rxq, struct na
 				STAT_INFO(pp->stats.rx_special++);
 
 				/* Refill processing */
-				mv_eth_refill(ppool, &bm, 0);
+				mv_eth_refill(ppool, bm, 0);
 				mvOsCacheLineInv(NULL, rx_desc);
 				continue;
 			}
@@ -1816,7 +1816,7 @@ static int mv_eth_tx(struct sk_buff *skb, struct net_device *dev)
 		/*
 		 * First and Last descriptor
 		 */
-		if (tx_spec.flags & MV_ETH_TX_F_NO_PAD)
+		if (tx_spec_ptr->flags & MV_ETH_TX_F_NO_PAD)
 			tx_cmd |= PP2_TX_F_DESC_MASK | PP2_TX_L_DESC_MASK | PP2_TX_PADDING_DISABLE_MASK;
 		else
 			tx_cmd |= PP2_TX_F_DESC_MASK | PP2_TX_L_DESC_MASK;
-- 
1.7.5.4

