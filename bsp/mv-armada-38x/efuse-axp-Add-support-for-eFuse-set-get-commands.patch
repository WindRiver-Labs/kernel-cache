From b44da91911e9cff6a5c4f9a812c6b37f1f97ab21 Mon Sep 17 00:00:00 2001
From: kostap <kostap@marvell.com>
Date: Mon, 10 Feb 2014 14:47:00 +0200
Subject: [PATCH 1357/1825] efuse: axp: Add support for eFuse set/get commands

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 0517b27b64b282f34913583ecc9fa53ed47ccd74

	Support eFuse commands group in AXP platform
	The eFuse is not yet enabled in the board configuration.

Change-Id: I45530481b7d063cb4831be22051acd86cde4ce69
Signed-off-by: kostap <kostap@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/5587
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Eli Nidam <elini@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../armada_xp_family/ctrlEnv/mvCtrlEnvRegs.h       |   50 ++++++++++++++++++++
 1 files changed, 50 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvRegs.h b/arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvRegs.h
index 92ebf45..5c53326 100755
--- a/arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvRegs.h
+++ b/arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvRegs.h
@@ -573,6 +573,56 @@ typedef enum {
 	PEXIF_MAX	= 10
 } MV_PEXIF_INDX;
 
+/* EFUSE control */
+#define EFUSE_BASE_ADDR				(0x10000)
+#define EFUSE_SW_CTRL_REG			(0x10008)
+
+#define EFUSE_CTRL_ACCESS_DONE_OFFS		31
+#define EFUSE_CTRL_ACCESS_DONE_MASK		(1 << EFUSE_CTRL_ACCESS_DONE_OFFS)
+#define EFUSE_CTRL_BURN_OK_OFFS			30
+#define EFUSE_CTRL_BURN_OK_MASK			(1 << EFUSE_CTRL_BURN_OK_OFFS)
+#define EFUSE_CTRL_BURN_ADDR_OFFS		8
+#define EFUSE_CTRL_BURN_ADDR_MASK		(0xFF << EFUSE_CTRL_BURN_ADDR_OFFS)
+#define EFUSE_CTRL_UPLOAD_TRIG_OFFS		2
+#define EFUSE_CTRL_UPLOAD_TRIG_MASK		(1 << EFUSE_CTRL_UPLOAD_TRIG_OFFS)
+#define EFUSE_CTRL_BURN_TRIG_OFFS		1
+#define EFUSE_CTRL_BURN_TRIG_MASK		(1 << EFUSE_CTRL_BURN_TRIG_OFFS)
+#define EFUSE_CTRL_ACCESS_MODE_OFFS		0
+#define EFUSE_CTRL_ACCESS_MODE_MASK		(1 << EFUSE_CTRL_ACCESS_MODE_OFFS)
+
+#define EFUSE_BURN_ADDR_SEC_CTRL		10
+#define EFUSE_BURN_ADDR_BOX_ID			11
+#define EFUSE_BURN_ADDR_AES_KEY_0_63		12
+#define EFUSE_BURN_ADDR_AES_KEY_64_127		13
+#define EFUSE_BURN_ADDR_RSA_KEY_0_63		14
+
+
+/* EFUSE protection bits - FSB  */
+#define EFUSE_PROTECTION_FSB_REG		(0x1000C)
+#define EFUSE_FSB_BIT				31
+
+/* Secure boot related eFuse entries */
+#define SEC_AES_KEY_REG				(0x10080)
+#define SEC_RSA_KEY_REG				(0x10020)
+#define SEC_BOX_ID_REG				(0x10014)
+#define SEC_BOOT_VIS_CTRL_REG			(0x100B0)
+#define SEC_BOOT_CTRL_REG			(0x10010)
+
+#define SEC_BOOT_MODE_OFFS			0
+#define SEC_BOOT_MODE_MASK			(0x1 << SEC_BOOT_MODE_OFFS)
+#define SEC_JTAG_DSBL_OFFS			1
+#define SEC_JTAG_DSBL_MASK			(0x1 << SEC_JTAG_DSBL_OFFS)
+#define SEC_BOOT_DEV_OFFS			4
+#define SEC_BOOT_DEV_MASK			(0xFF << SEC_BOOT_DEV_OFFS)
+#define SEC_FLASH_ID_OFFS			16
+#define SEC_FLASH_ID_MASK			(0xFFFFUL << SEC_FLASH_ID_OFFS)
+
+#define EFUSE_BOOT_SRC_SPI			(0x1 << 0)
+#define EFUSE_BOOT_SRC_NAND			(0x1 << 1)
+#define EFUSE_BOOT_SRC_SATA			(0x1 << 2)
+#define EFUSE_BOOT_SRC_NOR			(0x1 << 3)
+
+
 #endif /* MV_ASMLANGUAGE */
 
 #ifdef __cplusplus
-- 
1.7.5.4

