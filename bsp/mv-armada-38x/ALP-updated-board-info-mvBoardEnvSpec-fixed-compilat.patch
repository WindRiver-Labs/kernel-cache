From 2d4e3582b0d5d3b1085891b9dc83d651137682d8 Mon Sep 17 00:00:00 2001
From: Omri Itach <omrii@marvell.com>
Date: Thu, 18 Apr 2013 13:21:20 +0300
Subject: [PATCH 0600/1825] ALP: updated board info (mvBoardEnvSpec) & fixed
 compilation erros

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit bd806530e057917b1a18b50d7e0bf729d12a1544

Change-Id: Ia4eccdd84d539841453beec7299fb27a4a34b1b1
Reviewed-on: http://vgitil04.il.marvell.com:8080/1613
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../avanta_lp_family/boardEnv/mvBoardEnvLib.c      |    7 ++++---
 .../avanta_lp_family/boardEnv/mvBoardEnvSpec.c     |    4 ++--
 .../avanta_lp_family/boardEnv/mvBoardEnvSpec.h     |    6 +++---
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c        |   14 +++++++-------
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h       |   18 +++++++++---------
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h       |    3 +--
 6 files changed, 26 insertions(+), 26 deletions(-)

diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
index 5b8a2a4..d19c687 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
@@ -408,13 +408,14 @@ MV_BOOL mvBoardIsPortLoopback(MV_U32 ethPortNum)
 *******************************************************************************/
 MV_U32 mvBoardTclkGet(MV_VOID)
 {
-	MV_U32 value;
+	MV_U32 tclk;
 #ifdef CONFIG_MACH_AVANTA_LP_FPGA
 	/* FPGA is limited to 25Mhz */
 	return MV_FPGA_CORE_CLK;
 #else
-	value = ((MV_REG_READ(MPP_SAMPLE_AT_RESET(1)) & (0x400000)) >> 22);
-	switch (value) {
+	tclk = (MV_REG_READ(MPP_SAMPLE_AT_RESET(1)));
+	tclk = ((tclk & 0x400000) >> 22);
+	switch (tclk) {
 	case 0:
 		return _166MHz;
 	case 1:
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.c b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.c
index 44ed315..8fa2ab9 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.c
@@ -167,7 +167,7 @@ MV_BOARD_IO_EXPANDER_TYPE_INFO db88f6650InfoBoardIOExpanderInfo[] = {
 MV_BOARD_TWSI_INFO db88f6660InfoBoardTwsiDev[] = {
 	/* {{MV_BOARD_DEV_CLASS devClass, MV_U8 devClassId,  MV_U8 twsiDevAddr, MV_U8 twsiDevAddrType}} */
 	{ BOARD_DEV_TWSI_SATR,		0,	0x4C,	   ADDR7_BIT	},
-	{ BOARD_DEV_TWSI_SATR,		1,	0x4D,	   ADDR7_BIT	},
+	{ BOARD_DEV_TWSI_SATR,		1,	0x4E,	   ADDR7_BIT	},
 	{ BOARD_DEV_TWSI_EEPROM,	0,	0x54,	   ADDR7_BIT	},
 	{ BOARD_DEV_TWSI_IO_EXPANDER,	0,	0x21,	   ADDR7_BIT	},
 	{ BOARD_DEV_TWSI_IO_EXPANDER,	1,	0x22,	   ADDR7_BIT	},
@@ -287,7 +287,7 @@ MV_BOARD_INFO db88f6660_board_info = {
 MV_BOARD_TWSI_INFO db88f6650InfoBoardTwsiDev[] = {
 	/* {{MV_BOARD_DEV_CLASS devClass, MV_U8 devClassId,  MV_U8 twsiDevAddr, MV_U8 twsiDevAddrType}} */
 	{ BOARD_DEV_TWSI_SATR,		0,	0x4C,	   ADDR7_BIT	},
-	{ BOARD_DEV_TWSI_SATR,		1,	0x4D,	   ADDR7_BIT	},
+	{ BOARD_DEV_TWSI_SATR,		1,	0x4E,	   ADDR7_BIT	},
 	{ BOARD_DEV_TWSI_EEPROM,	0,	0x54,	   ADDR7_BIT	},
 	{ BOARD_DEV_TWSI_IO_EXPANDER,	0,	0x21,	   ADDR7_BIT	},
 	{ BOARD_DEV_TWSI_IO_EXPANDER,	2,	0x24,	   ADDR7_BIT	},
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.h b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.h
index 1c1d76c..a76dd41 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.h
@@ -83,9 +83,9 @@
 #define BOARD_ID_BASE                   0x0
 
 #define RD_6650_ID                      (BOARD_ID_BASE)
-#define DB_6650_ID                      (RD_6650_ID + 1)
-#define RD_6660_ID                      (DB_6650_ID + 1)
-#define DB_6660_ID                      (RD_6660_ID + 1)
+#define RD_6660_ID                      (RD_6650_ID + 1)
+#define DB_6650_ID                      (RD_6660_ID + 1)
+#define DB_6660_ID                      (DB_6650_ID + 1)
 #define MV_BOARD_ID_AVANTA_LP_FPGA      (DB_6660_ID + 1)
 #define MV_MAX_BOARD_ID                 (MV_BOARD_ID_AVANTA_LP_FPGA + 1)
 #define MV_INVALID_BOARD_ID             0xFFFFFFFF
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
index f1d4a2a..e5f19a7 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
@@ -1017,8 +1017,8 @@ MV_U16 mvCtrlModelGet(MV_VOID)
 #ifdef CONFIG_MACH_AVANTA_LP_FPGA
 	ctrlId = MV_88F66X0;
 #else
-	ctrlId = MV_REG_READ(DEVICE_ID_REG);
-	ctrlId = (ctrlId & (DEVICE_ID_REG_VEND_ID_MASK)) >> DEVICE_ID_REG_DEV_ID_OFFS;
+	ctrlId = MV_REG_READ(DEV_ID_REG);
+	ctrlId = (ctrlId & (VENDOR_ID_MASK)) >> VENDOR_ID_OFFS;
 #endif
 	switch (ctrlId) {
 	case 0x6660:
@@ -1051,8 +1051,8 @@ MV_U8 mvCtrlRevGet(MV_VOID)
 {
 	MV_U8 value;
 
-	value = MV_REG_READ(DEVICE_VERSION_ID_REG);
-	return  ((value & (DEVICE_VERSION_ID_REG_REV_ID_MASK) ) >> DEVICE_VERSION_ID_REG_REV_ID_OFFS);
+	value = MV_REG_READ(DEV_VERSION_ID_REG);
+	return  ((value & (REVISON_ID_MASK) ) >> REVISON_ID_OFFS);
 }
 
 /*******************************************************************************
@@ -1546,9 +1546,9 @@ MV_VOID mvCtrlPwrClckSet(MV_UNIT_ID unitId, MV_U32 index, MV_BOOL enable)
 #if defined(MV_INCLUDE_USB)
 	case USB_UNIT_ID:
 		if (enable == MV_FALSE)
-			MV_REG_BIT_RESET(POWER_MNG_CTRL_REG, PMC_USB_STOP_CLK_MASK(index));
+			MV_REG_BIT_RESET(POWER_MNG_CTRL_REG, PMC_USB_STOP_CLK_MASK);
 		else
-			MV_REG_BIT_SET(POWER_MNG_CTRL_REG, PMC_USB_STOP_CLK_MASK(index));
+			MV_REG_BIT_SET(POWER_MNG_CTRL_REG, PMC_USB_STOP_CLK_MASK);
 
 		break;
 #endif
@@ -1611,7 +1611,7 @@ MV_BOOL mvCtrlPwrClckGet(MV_UNIT_ID unitId, MV_U32 index)
 #endif
 #if defined(MV_INCLUDE_USB)
 	case USB_UNIT_ID:
-		if ((reg & PMC_USB_STOP_CLK_MASK(index)) == PMC_USB_STOP_CLK_STOP(index))
+		if ((reg & PMC_USB_STOP_CLK_MASK) == PMC_USB_STOP_CLK_STOP)
 			state = MV_FALSE;
 		else
 			state = MV_TRUE;
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h
index e7759d4..6f38a18 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h
@@ -124,15 +124,15 @@ extern "C" {
 #define MPP_CONTROL_REG(id)                     (0x18000 + (id * 4))
 
 /* Sample at Reset */
-#define MPP_SAMPLE_AT_RESET(id)                 (0xE8200 + ( id * 0x4 ))
-#define DEVICE_ID_REG                            0x18238
-#define DEVICE_ID_REG_VEND_ID_OFFS               0
-#define DEVICE_ID_REG_VEND_ID_MASK               0xFFFF
-#define DEVICE_ID_REG_DEV_ID_OFFS                16
-#define DEVICE_ID_REG_DEV_ID_MASK                0xFFFF0000
-#define DEVICE_VERSION_ID_REG                    0x1823C
-#define DEVICE_VERSION_ID_REG_REV_ID_OFFS        8
-#define DEVICE_VERSION_ID_REG_REV_ID_MASK        0xF00
+#define MPP_SAMPLE_AT_RESET(id)		(0xE8200 + ( id * 0x4 ))
+#define DEV_ID_REG			0x18238
+#define VENDOR_ID_OFFS			0
+#define VENDOR_ID_MASK			0xFFFF
+#define DEVICE_ID_OFFS			16
+#define DEVICE_ID_MASK			0xFFFF0000
+#define DEV_VERSION_ID_REG		0x1823C
+#define REVISON_ID_OFFS			8
+#define REVISON_ID_MASK			0xF00
 
 /* SYSRSTn Length Counter */
 #define SYSRST_LENGTH_COUNTER_REG               0x18250
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h
index 298aaed..d015928 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h
@@ -468,8 +468,7 @@ typedef enum _mvTarget {
 	SPI_CS7,        /* 37 SPI_CS7				*/
 	BOOT_ROM_CS,    /* 38 BOOT_ROM_CS			*/
 	DEV_BOOCS,      /* 39 DEV_BOOCS				*/
-	CRYPT0_ENG,     /* 41 Crypto0 Engine			*/
-	CRYPT1_ENG,     /* 42 Crypto1 Engine			*/
+	CRYPT_ENG,     /* 41 Crypto0 Engine			*/
 	PNC_BM,         /* 43 PNC + BM				*/
 	MAX_TARGETS
 } MV_TARGET;
-- 
1.7.5.4

