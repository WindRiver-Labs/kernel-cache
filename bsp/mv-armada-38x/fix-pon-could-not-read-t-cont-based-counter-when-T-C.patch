From 4812da6b256f3b23a9b86d0a281f5f0d5b93d56d Mon Sep 17 00:00:00 2001
From: Victor Gu <xigu@marvell.com>
Date: Thu, 15 May 2014 13:46:11 +0800
Subject: [PATCH 1661/1825] fix: pon: could not read t-cont based counter when
 T-CONT >= 8

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 4f365da2fa8c52ba54c045e14e50d0c9d696bdd6

    need to adjust the index when read T-CONT counter register when T-CONT
equals or is big than 8
Signed-off-by: Victor Gu <xigu@marvell.com>

Change-Id: I2e0f5dcdad012cefab33448d3d3e913b69cf6f2c
Reviewed-on: http://vgitil04.il.marvell.com:8080/8043
Reviewed-by: Victor Gu <xigu@marvell.com>
Tested-by: Yehuda Yitschak <yehuday@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/mv_hal/pon/mvPonOnuMac.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/arm/plat-armada/mv_hal/pon/mvPonOnuMac.c b/arch/arm/plat-armada/mv_hal/pon/mvPonOnuMac.c
index 98b4f18..b497600 100755
--- a/arch/arm/plat-armada/mv_hal/pon/mvPonOnuMac.c
+++ b/arch/arm/plat-armada/mv_hal/pon/mvPonOnuMac.c
@@ -2874,7 +2874,7 @@ MV_STATUS mvOnuGponMacTxEthFramesTcontiCounterGet(MV_U32 tcontNum, MV_U32 *count
 	if (tcontNum < 8)
 		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_ETH_FRAMES, counter, tcontNum);
 	else
-		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_8_15_ETH_FRAME, counter, (tcontNum - 8));
+		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_8_15_ETH_FRAME, counter, tcontNum - 8);
 
 	return status;
 }
@@ -2934,7 +2934,7 @@ MV_STATUS mvOnuGponMacTxGemFramesTcontiCounterGet(MV_U32 tcontNum, MV_U32 *count
 	if (tcontNum < 8)
 		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_GEM_FRAMES, counter, tcontNum);
 	else
-		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_8_15_GEM_FRAME, counter, tcontNum);
+		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_8_15_GEM_FRAME, counter, tcontNum - 8);
 
 	return status;
 }
@@ -2964,7 +2964,7 @@ MV_STATUS mvOnuGponMacTxIdleGemFramesTcontiCounterGet(MV_U32 tcontNum, MV_U32 *c
 	if (tcontNum < 8)
 		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_IDLE_GEM, counter, tcontNum);
 	else
-		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_8_15_IDLE_GEM, counter, tcontNum);
+		status = asicOntGlbRegRead(mvAsicReg_GPON_TX_STAT_TCONT_i_8_15_IDLE_GEM, counter, tcontNum - 8);
 
 	return status;
 }
-- 
1.7.5.4

