From e2e89df4a6ee34e1f633555784d6d9d791403e08 Mon Sep 17 00:00:00 2001
From: Eli Nidam <elini@marvell.com>
Date: Tue, 17 Dec 2013 17:11:58 +0200
Subject: [PATCH 1225/1825] fix: axp: initialize static parameter value
 (modelId) different from 0.

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 5e0e6f90b31e1752214e54444d637789f6e9ba17

        static parameter in u-boot equal to 0 are not set in bss data segment,
        all data equal to 0 are set indirect table and initialize after code relocation.
        and it cannot be used before code relocation. when set modelId value 0xffff the compiler
        put the modelId in bss segment then we can use it before and after code relocation

Change-Id: If1ba7289ca1a0d4722c593c6b76cd7920bcd97b9
Signed-off-by: Eli Nidam <elini@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/4768
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Tawfik Bayouk <tawfik@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../armada_xp_family/ctrlEnv/mvCtrlEnvLib.c        |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)
 mode change 100755 => 100644 arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvLib.c

diff --git a/arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvLib.c b/arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvLib.c
old mode 100755
new mode 100644
index 837b0b8..2296dd0
--- a/arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvLib.c
+++ b/arch/arm/mach-armadaxp/armada_xp_family/ctrlEnv/mvCtrlEnvLib.c
@@ -829,9 +829,9 @@ MV_U16 mvCtrlModelGet(MV_VOID)
 	MV_U32 devId;
 	MV_U16 model = 0;
 	MV_U32 reg, reg2;
-	static MV_U16 modelId = 0x0;
+	static MV_U16 modelId = 0xffff;
 
-	if (modelId != 0x0)
+	if (modelId != 0xffff)
 		return modelId;
 
 	/* if PEX0 clocks are disabled - enabled it to read */
@@ -2034,7 +2034,7 @@ MV_STATUS mvCtrlSerdesPhyConfig(MV_VOID)
 			else if (serdesLineNum == 5)
 				powermngmntctrlregmap |= PMC_SATASTOPCLOCK_MASK(1);
 			else
-				goto err_cfg;		
+				goto err_cfg;
 
 		} else if (serdesLineCfg == serdesCfg[serdesLineNum][SERDES_UNIT_SGMII0])
 				powermngmntctrlregmap |= PMC_GESTOPCLOCK_MASK(0);
-- 
1.7.5.4

