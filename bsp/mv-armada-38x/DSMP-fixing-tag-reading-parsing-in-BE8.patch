From 551c604ca913e7ee627102fbceb7293949977fb3 Mon Sep 17 00:00:00 2001
From: Tawfik Bayouk <tawfik@marvell.com>
Date: Tue, 21 Aug 2012 17:35:26 +0300
Subject: [PATCH 0177/1825] DSMP fixing tag reading / parsing in BE8

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 6cfdb8c4e900ba7fe67ffdeb5d5fe69bd8e3377e

Change-Id: I8def308655925a8cd9c5a9ad72cd9575025f7d5b
Signed-off-by: Tawfik Bayouk <tawfik@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-armadaxp/core.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/arm/mach-armadaxp/core.c b/arch/arm/mach-armadaxp/core.c
index 33d4698..afb64b1 100644
--- a/arch/arm/mach-armadaxp/core.c
+++ b/arch/arm/mach-armadaxp/core.c
@@ -1578,10 +1578,10 @@ void __init axp_tag_fixup_mem32(struct machine_desc *mdesc, struct tag *t,
 	int total_size = PAGE_ALIGN(DEFAULT_FB_SIZE*4) * 2;
 	uint32_t memory_start;
 
-	for (; t->hdr.size; t = tag_next(t))
-		if ((t->hdr.tag == ATAG_MEM) && (t->u.mem.size >= total_size)) {
+	for (; read_tag(t->hdr.size); t = tag_next(t))
+		if ((read_tag(t->hdr.tag) == ATAG_MEM) && ( read_tag(t->u.mem.size) >= total_size)) {
 			if ((last_tag == NULL) ||
-			    (t->u.mem.start > last_tag->u.mem.start))
+			    (read_tag(t->u.mem.start) > last_tag->u.mem.start))
 				last_tag = t;
 		}
 
-- 
1.7.5.4

