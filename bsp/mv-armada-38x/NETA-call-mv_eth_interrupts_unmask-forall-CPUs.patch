From f957c26d80fe705ecca2d92bd85fcbf912cc97ca Mon Sep 17 00:00:00 2001
From: Tawfik Bayouk <tawfik@marvell.com>
Date: Tue, 21 Aug 2012 17:33:48 +0300
Subject: [PATCH 0074/1825] NETA call mv_eth_interrupts_unmask forall CPUs

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit c9bf96e24bf687673e19adcd9f00607b22e43a67

Change-Id: I5f54469bbb9bab4f7fce56eefbc6f8695a05199b
Signed-off-by: Tawfik Bayouk <tawfik@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../mv_drivers_lsp/mv_neta/net_dev/mv_ethernet.c   |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_neta/net_dev/mv_ethernet.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_neta/net_dev/mv_ethernet.c
index b82122a..6dd5742 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_neta/net_dev/mv_ethernet.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_neta/net_dev/mv_ethernet.c
@@ -48,6 +48,7 @@ disclaimer.
 #include "mv_switch.h"
 #endif /* CONFIG_MV_ETH_SWITCH_LINK */
 
+
 static int mv_eth_start(struct net_device *dev);
 static int mv_eth_set_mac_addr_internals(struct net_device *dev, void *addr);
 
@@ -61,7 +62,6 @@ static int mv_eth_start(struct net_device *dev)
 {
 	struct eth_port *priv = MV_ETH_PRIV(dev);
 	int group;
-
 	/* in default link is down */
 	netif_carrier_off(dev);
 
@@ -108,6 +108,7 @@ static int mv_eth_start(struct net_device *dev)
 
 		/* unmask interrupts */
 		mv_eth_interrupts_unmask(priv);
+		smp_call_function_many(cpu_online_mask, (smp_call_func_t)mv_eth_interrupts_unmask, (void *)priv, 1);
 
 		printk(KERN_NOTICE "%s: started\n", dev->name);
 	}
-- 
1.7.5.4

