From 38d0fe651cfaf8d5fe36427180c14f2c0a4abb70 Mon Sep 17 00:00:00 2001
From: Kosta Zertsekel <konszert@marvell.com>
Date: Wed, 3 Apr 2013 09:40:46 +0300
Subject: [PATCH 0526/1825] Use snprintf instead of sprintf

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit f3dbb7bcf144f7624d308734a0ae1f4d9f0b32fe

Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Change-Id: I67aede202adaa0c07965c9fe4755be346d9ac150
Reviewed-on: http://vgitil04.il.marvell.com:8080/1419
Reviewed-by: Omri Itach <omrii@marvell.com>
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../avanta_lp_family/boardEnv/mvBoardEnvLib.c      |    4 ++--
 .../avanta_lp_family/boardEnv/mvBoardEnvLib.h      |    2 +-
 arch/arm/mach-avantalp/core.c                      |    2 +-
 arch/arm/plat-armada/linux_oss/mvOs.h              |    1 +
 4 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
index afcf5c7..a506965 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
@@ -228,9 +228,9 @@ MV_U16 mvBoardRevGet(MV_VOID)
 *
 *       MV_ERROR if informantion can not be read.
 *******************************************************************************/
-MV_STATUS mvBoardNameGet(char *pNameBuff)
+MV_STATUS mvBoardNameGet(char *pNameBuff, MV_U32 size)
 {
-	mvOsSPrintf(pNameBuff, "%s", board->boardName);
+	mvOsSNPrintf(pNameBuff, size, "%s", board->boardName);
 	return MV_OK;
 }
 
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.h b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.h
index fffbfca..ca9fc33 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.h
@@ -412,7 +412,7 @@ typedef struct _boardInfo {
 MV_VOID mvBoardEnvInit(MV_VOID);
 MV_U16 mvBoardModelGet(MV_VOID);
 MV_U16 mvBoardRevGet(MV_VOID);
-MV_STATUS mvBoardNameGet(char *pNameBuff);
+MV_STATUS mvBoardNameGet(char *pNameBuff, MV_U32 size);
 MV_BOARD_SPEC_INIT *mvBoardSpecInitGet(MV_VOID);
 MV_BOOL mvBoardIsPortInSgmii(MV_U32 ethPortNum);
 MV_BOOL mvBoardIsPortInGmii(MV_U32 ethPortNum);
diff --git a/arch/arm/mach-avantalp/core.c b/arch/arm/mach-avantalp/core.c
index d1b82af..61415ff 100755
--- a/arch/arm/mach-avantalp/core.c
+++ b/arch/arm/mach-avantalp/core.c
@@ -678,7 +678,7 @@ void print_board_info(void)
 	printk("\n");
 	printk("  Marvell Avanta-LP");
 
-	mvBoardNameGet(name_buff);
+	mvBoardNameGet(name_buff, 50);
 	printk(" %s Board - ",name_buff);
 
 	mvCtrlModelRevNameGet(name_buff);
diff --git a/arch/arm/plat-armada/linux_oss/mvOs.h b/arch/arm/plat-armada/linux_oss/mvOs.h
index d86dd68..491454e 100644
--- a/arch/arm/plat-armada/linux_oss/mvOs.h
+++ b/arch/arm/plat-armada/linux_oss/mvOs.h
@@ -73,6 +73,7 @@ extern void mv_early_printk(char *fmt, ...);
 #define mvOsEarlyPrintf	    mv_early_printk
 #define mvOsOutput          printk
 #define mvOsSPrintf         sprintf
+#define mvOsSNPrintf        snprintf
 #define mvOsMalloc(_size_)  kmalloc(_size_, GFP_ATOMIC)
 #define mvOsFree            kfree
 #define mvOsMemcpy          memcpy
-- 
1.7.5.4

