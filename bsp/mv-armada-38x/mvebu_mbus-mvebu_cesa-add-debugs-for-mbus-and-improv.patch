From f9f0745c1ed89b2f7739f164467a9c959a449eba Mon Sep 17 00:00:00 2001
From: Nadav Haklai <nadavh@marvell.com>
Date: Wed, 12 Mar 2014 11:46:21 +0200
Subject: [PATCH 1464/1825] mvebu_mbus: mvebu_cesa: add debugs for mbus and
 improve debugs for CESA

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 45ef80a9d327260375ad2e6276dc62678395ced6

Change-Id: Ia0eb5b9929756e537006c77fd16894f6d33cb512
Signed-off-by: Grzegorz Jaszczyk <jaz@semihalf.com>
Signed-off-by: Nadav Haklai <nadavh@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/6354
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/mv_hal/cesa/mvCesaDebug.c |   19 ++++++++++++++++++-
 1 files changed, 18 insertions(+), 1 deletions(-)

diff --git a/arch/arm/plat-armada/mv_hal/cesa/mvCesaDebug.c b/arch/arm/plat-armada/mv_hal/cesa/mvCesaDebug.c
index eef9aac..36af359 100644
--- a/arch/arm/plat-armada/mv_hal/cesa/mvCesaDebug.c
+++ b/arch/arm/plat-armada/mv_hal/cesa/mvCesaDebug.c
@@ -76,6 +76,9 @@ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 #include "cesa_if.h"
 #endif
 
+
+#define MV_CESA_VERSION		3
+
 static const char *mvCesaDebugStateStr(MV_CESA_STATE state)
 {
 	switch (state) {
@@ -205,6 +208,7 @@ void mvCesaDebugMbuf(const char *str, MV_CESA_MBUF *pMbuf, int offset, int size)
 void mvCesaDebugRegs(void)
 {
 	MV_U8 chan = 0;
+	MV_U8 i = 0;
 
 	mvOsPrintf("\t CESA Registers:\n");
 
@@ -257,7 +261,20 @@ void mvCesaDebugRegs(void)
 			MV_CESA_TDMA_ERROR_CAUSE_REG(chan), MV_REG_READ(MV_CESA_TDMA_ERROR_CAUSE_REG(chan)));
 
 		mvOsPrintf("MV_CESA_TDMA_ERROR_MASK_REG         : 0x%X = 0x%08x\n",
-			MV_CESA_TDMA_ERROR_MASK_REG(chan), MV_REG_READ(MV_CESA_TDMA_ERROR_CAUSE_REG(chan)));
+			MV_CESA_TDMA_ERROR_MASK_REG(chan),
+			MV_REG_READ(MV_CESA_TDMA_ERROR_MASK_REG(chan)));
+
+		mvOsPrintf("\n=========== decoding windows ===========\n");
+		for (i = 0; i < MV_CESA_TDMA_ADDR_DEC_WIN; i++) {
+			mvOsPrintf("%s\t: 0x%X = 0x%08x\n",
+			    "MV_CESA_TDMA_BASE_ADDR_REG",
+			    MV_CESA_TDMA_BASE_ADDR_REG(chan, i),
+			    MV_REG_READ(MV_CESA_TDMA_BASE_ADDR_REG(chan, i)));
+			mvOsPrintf("%s\t: 0x%X = 0x%08x\n",
+			    "MV_CESA_TDMA_WIN_CTRL_REG",
+			    MV_CESA_TDMA_WIN_CTRL_REG(chan, i),
+			    MV_REG_READ(MV_CESA_TDMA_WIN_CTRL_REG(chan, i)));
+		}
 
 #endif
 	}
-- 
1.7.5.4

