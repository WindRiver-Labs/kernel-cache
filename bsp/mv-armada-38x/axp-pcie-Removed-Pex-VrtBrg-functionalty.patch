From 4fa7f1eab23f7b09cd28b53005bffed3a34bfe62 Mon Sep 17 00:00:00 2001
From: Igor Patrik <igorp@marvell.com>
Date: Wed, 3 Jul 2013 12:35:39 +0200
Subject: [PATCH 0761/1825] axp: pcie: Removed Pex VrtBrg functionalty

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 61bace062d7cbca0064df7c869eabcca0babfbca

	PEX Virtual Bringe not ported currently on 3.4,
	So removed calls and object from makefile to pass compilation.

Change-Id: Iaba735394b424afbcef5e3d118dc15ca98165832
Signed-off-by: Igor Patrik <igorp@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/2401
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-armadaxp/Makefile |    4 ++--
 arch/arm/mach-armadaxp/pex.c    |    2 --
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/arch/arm/mach-armadaxp/Makefile b/arch/arm/mach-armadaxp/Makefile
index 9752f1d..8d119ae 100755
--- a/arch/arm/mach-armadaxp/Makefile
+++ b/arch/arm/mach-armadaxp/Makefile
@@ -61,8 +61,8 @@ armadaxp-$(CONFIG_MV_INCLUDE_SDIO) 	+= $(HAL_SDMMC_DIR)/mvSdmmcAddrDec.o
 armadaxp-$(CONFIG_MV_INCLUDE_XOR) 	+= $(HAL_XOR_DIR)/mvXor.o $(HAL_XOR_DIR)/mvXorAddrDec.o		\
 					   $(HAL_IF_DIR)/mvSysXor.o
 armadaxp-$(CONFIG_MV_INCLUDE_PEX) 	+= $(HAL_PEX_DIR)/mvPex.o					\
-					   $(HAL_IF_DIR)/mvSysPex.o $(HAL_PEX_DIR)/mvPexAddrDec.o	\
-					   $(HAL_PEX_DIR)/mvVrtBrgPex.o
+					   $(HAL_IF_DIR)/mvSysPex.o $(HAL_PEX_DIR)/mvPexAddrDec.o
+
 armadaxp-$(CONFIG_MV_INCLUDE_PCI) 	+= $(HAL_PCI_DIR)/mvPci.o $(HAL_IF_DIR)/mvSysPci.o
 armadaxp-$(CONFIG_MV_INCLUDE_USB) 	+= $(HAL_USB_DIR)/mvUsb.o $(HAL_USB_DIR)/mvUsbAddrDec.o		\
 					   $(HAL_IF_DIR)/mvSysUsb.o
diff --git a/arch/arm/mach-armadaxp/pex.c b/arch/arm/mach-armadaxp/pex.c
index 4ea6bb6..a3e7675 100644
--- a/arch/arm/mach-armadaxp/pex.c
+++ b/arch/arm/mach-armadaxp/pex.c
@@ -127,7 +127,6 @@ void __init mv_pex_preinit(void)
 		/* Assign bus number 0 to first active/available bus */
 		if (pex0flg == 0) {
 			mvPexLocalBusNumSet(pexHWInf, 0xFF);
-			mvPexSecondaryBusNumSet(pexHWInf, 0x0);
 	       		pex0flg = 1;
 		}
 
@@ -372,7 +371,6 @@ struct pci_bus *mv_pex_scan_bus(int nr, struct pci_sys_data *sys)
 
 		if (MV_TRUE == mvCtrlPwrClckGet(PEX_UNIT_ID, pexNextHWInf)) {
 			mvPexLocalBusNumSet(pexNextHWInf, 0xFF);
-			mvPexSecondaryBusNumSet(pexNextHWInf, (bus->subordinate + 1));
 			break;
 		}
 	}
-- 
1.7.5.4

