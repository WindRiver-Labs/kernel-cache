From 1b513a6879c8d4652a0ece57944cbf4faba2146e Mon Sep 17 00:00:00 2001
From: Tawfik Bayouk <tawfik@marvell.com>
Date: Tue, 21 Aug 2012 17:35:46 +0300
Subject: [PATCH 0202/1825] Fix NFP neighbour hook

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 1401eb10b618fb7a9eeb90c392e30df1b3d4c9a9

Change-Id: Id29cb28a8ba61f1eccfb1279173a053e1c0105e6
Signed-off-by: Tawfik Bayouk <tawfik@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 net/core/neighbour.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/net/core/neighbour.c b/net/core/neighbour.c
index a305f07..792458d 100644
--- a/net/core/neighbour.c
+++ b/net/core/neighbour.c
@@ -3067,7 +3067,7 @@ void neigh_sync(int family)
 			continue;
 		nht = rcu_dereference_bh(tbl->nht);
 
-		for (h = 0; h <= nht->hash_mask; h++) {
+		for (h = 0; h < (1 << nht->hash_shift); h++) {
 			for (n = rcu_dereference_bh(nht->hash_buckets[h]); n != NULL;
 				 n = rcu_dereference_bh(n->next)) {
 					 if (n->dev == NULL)
-- 
1.7.5.4

