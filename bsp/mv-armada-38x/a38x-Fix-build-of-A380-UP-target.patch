From f9fddfe8f14056cb5aa901e99b0aa76066603018 Mon Sep 17 00:00:00 2001
From: Yehuda Yitschak <yehuday@marvell.com>
Date: Tue, 25 Feb 2014 10:17:54 +0200
Subject: [PATCH 1393/1825] a38x: Fix build of A380 UP target.

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 77af8edc1334b95a003faa44295fcb9d62239501

Change-Id: I4a9825027b61b35a57067101d49fcf8742974058
Signed-off-by: Michal Mazur <arg@semihalf.com>
Signed-off-by: Yehuda Yitschak <yehuday@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/5921
Reviewed-by: Shadi Ammouri <shadi@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-armada38x/time.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-armada38x/time.c b/arch/arm/mach-armada38x/time.c
index 32ab8eab..5339dd8 100644
--- a/arch/arm/mach-armada38x/time.c
+++ b/arch/arm/mach-armada38x/time.c
@@ -273,7 +273,9 @@ static void __init a38x_timer_init(void)
 {
 	u32 rate;
 
+#ifdef CONFIG_HAVE_ARM_TWD
 	clk_twd_lookup.clk->rate = mvCpuL2ClkGet();
+#endif
 	rate = A38X_TIMER_RATE;
 
 	printk(KERN_INFO "Initializing Armada-38x SoC Timers\n");
-- 
1.7.5.4

