From 58e0d91af5476ead39dd86b6c3062aab274da2c6 Mon Sep 17 00:00:00 2001
From: Kosta Zertsekel <konszert@marvell.com>
Date: Sun, 6 Jan 2013 13:22:02 +0200
Subject: [PATCH 0014/1825] DMSP Splice & NetDMA support: unmerged locking

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 713790f59338896ee4a41da2cbb0efeb41b257f7

Change-Id: Ic08dd5db8eb6c02e41b8e32abf53540a1e5b3749

Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/dma/mv_xor.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/dma/mv_xor.c b/drivers/dma/mv_xor.c
index cbe4a54..8a643a4 100644
--- a/drivers/dma/mv_xor.c
+++ b/drivers/dma/mv_xor.c
@@ -785,12 +785,15 @@ static enum dma_status mv_xor_status(struct dma_chan *chan,
 	struct mv_xor_chan *mv_chan = to_mv_xor_chan(chan);
 	enum dma_status ret;
 
+	/* spin_lock_bh(&mv_chan->lock); kostaz */
 	ret = dma_cookie_status(chan, cookie, txstate);
 	if (ret == DMA_SUCCESS) {
 		mv_xor_clean_completed_slots(mv_chan);
+		/* spin_unlock_bh(&mv_chan->lock); kostaz */
 		return ret;
 	}
 	mv_xor_slot_cleanup(mv_chan);
+	/* spin_unlock_bh(&mv_chan->lock); kostaz */
 
 	return dma_cookie_status(chan, cookie, txstate);
 }
-- 
1.7.5.4

