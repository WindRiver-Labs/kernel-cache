From e5cd424abebebf1690bfcbe9892ec025034fe0ea Mon Sep 17 00:00:00 2001
From: Nadav Haklai <nadavh@marvell.com>
Date: Sun, 25 May 2014 09:37:49 +0300
Subject: [PATCH 1694/1825] fix: pp2: add missing index write when clearing
 parser SRAM data registers

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit e6e543afa8c27d18b53aadb4be6510ae103112a3

Change-Id: I0a23e49aac6313cf69b8e5754575b898260c9779
Signed-off-by: Marcin Wojtas <mw@semihalf.com>
Signed-off-by: Nadav Haklai <nadavh@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/8241
Reviewed-by: Dmitri Epshtein <dima@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/mv_hal/pp2/prs/mvPp2PrsHw.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/arm/plat-armada/mv_hal/pp2/prs/mvPp2PrsHw.c b/arch/arm/plat-armada/mv_hal/pp2/prs/mvPp2PrsHw.c
index 2e13447..7a5a5e1 100644
--- a/arch/arm/plat-armada/mv_hal/pp2/prs/mvPp2PrsHw.c
+++ b/arch/arm/plat-armada/mv_hal/pp2/prs/mvPp2PrsHw.c
@@ -507,6 +507,8 @@ int mvPp2PrsHwClearAll()
 		for (i = 0; i < MV_PP2_PRC_TCAM_WORDS; i++)
 			mvPp2WrReg(MV_PP2_PRS_TCAM_DATA_REG(i), 0);
 
+		mvPp2WrReg(MV_PP2_PRS_SRAM_IDX_REG, index);
+
 		for (i = 0; i < MV_PP2_PRC_SRAM_WORDS; i++)
 			mvPp2WrReg(MV_PP2_PRS_SRAM_DATA_REG(i), 0);
 	}
-- 
1.7.5.4

