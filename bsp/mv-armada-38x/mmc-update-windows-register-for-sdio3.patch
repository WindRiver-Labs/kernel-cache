From 36788dc9e0c0b8bff66da8d3035ebb5f8b880628 Mon Sep 17 00:00:00 2001
From: Eli Nidam <elini@marvell.com>
Date: Tue, 18 Feb 2014 14:57:35 +0200
Subject: [PATCH 1371/1825] mmc: update windows register for sdio3

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 1c108cc18134aa1ceefb99b5e6367a0cd16d3c9e

Change-Id: Ib6bd450a272a8f3e7e17c0170409b11590c76202
Signed-off-by: Eli Nidam <elini@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/5775
Reviewed-by: Igor Patrik <igorp@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/mv_hal/sdmmc/mvSdmmcAddrDec.c |    8 +++++++-
 1 files changed, 7 insertions(+), 1 deletions(-)

diff --git a/arch/arm/plat-armada/mv_hal/sdmmc/mvSdmmcAddrDec.c b/arch/arm/plat-armada/mv_hal/sdmmc/mvSdmmcAddrDec.c
index 1c91de4..ca1b880 100644
--- a/arch/arm/plat-armada/mv_hal/sdmmc/mvSdmmcAddrDec.c
+++ b/arch/arm/plat-armada/mv_hal/sdmmc/mvSdmmcAddrDec.c
@@ -70,9 +70,13 @@ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 
 #define MV_SDMMC_MAX_ADDR_DECODE_WIN 4
 
+#ifdef MV_MMC_SDIO3
+#define MV_SDMMC_WIN_CTRL_REG(dev, win)        (MV_SDMMC_WINDOWS_REGS_OFFSET + 0x80 + ((win)<<3))
+#define MV_SDMMC_WIN_BASE_REG(dev, win)        (MV_SDMMC_WINDOWS_REGS_OFFSET + 0x84 + ((win)<<3))
+#else
 #define MV_SDMMC_WIN_CTRL_REG(dev, win)        (MV_SDMMC_REGS_BASE + 0x108 + ((win)<<3))
 #define MV_SDMMC_WIN_BASE_REG(dev, win)        (MV_SDMMC_REGS_BASE + 0x10c + ((win)<<3))
-
+#endif
 /* BITs in Windows 0-3 Control and Base Registers */
 #define MV_SDMMC_WIN_ENABLE_BIT               0
 #define MV_SDMMC_WIN_ENABLE_MASK              (1<<MV_SDMMC_WIN_ENABLE_BIT)
@@ -104,9 +108,11 @@ MV_TARGET sdmmcAddrDecPrioTab[] = {
 #if defined(MV_INCLUDE_SDRAM_CS3)
 	SDRAM_CS3,
 #endif
+#ifndef MV_MMC_SDIO3
 #if defined(MV_INCLUDE_PEX)
 	PEX0_MEM,
 #endif
+#endif
 	TBL_TERM
 };
 
-- 
1.7.5.4

