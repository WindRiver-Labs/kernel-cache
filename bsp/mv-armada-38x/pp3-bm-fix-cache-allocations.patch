From 4f9305cfc87379e9ce57e234c7c595f303d23c50 Mon Sep 17 00:00:00 2001
From: Dovrat <dovrat@marvell.com>
Date: Wed, 7 May 2014 12:49:55 +0300
Subject: [PATCH 1625/1825] pp3: bm: fix cache allocations

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 755360e53f74b28c16bb314da3eb8954f4694436

Change-Id: Ib54bb651639d332b4f0289859b7f6aec99e49c6f
Signed-off-by: Dovrat <dovrat@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/7867
Reviewed-by: Uri Eliyahu <uriel@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Yelena Krivosheev <yelena@marvell.com>
Reviewed-by: Dmitri Epshtein <dima@marvell.com>
Tested-by: Dmitri Epshtein <dima@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/net/ethernet/marvell/pp3/bm/mv_bm.c | 3466 ++++++++++++++-------------
 drivers/net/ethernet/marvell/pp3/bm/mv_bm.h |   81 +-
 2 files changed, 1819 insertions(+), 1728 deletions(-)

diff --git a/drivers/net/ethernet/marvell/pp3/bm/mv_bm.c b/drivers/net/ethernet/marvell/pp3/bm/mv_bm.c
index 33e972e..6301cd7 100644
--- a/drivers/net/ethernet/marvell/pp3/bm/mv_bm.c
+++ b/drivers/net/ethernet/marvell/pp3/bm/mv_bm.c
@@ -101,7 +101,13 @@ int bm_open(void)
 	return rc;
 }
 
-/*BM User Application Interface*/
+/*
+ * BM User Application Interface
+ */
+/*
+ * functions to configures BM attributes for read/write in DRAM
+ * default function, qm pools attributes functions, gp pools attributes function
+ */
 int bm_attr_all_pools_def_set(void)
 {
 	int rc = OK;
@@ -298,6 +304,9 @@ int bm_attr_gp_pool_set(u32 arDomain, u32 awDomain, u32 arCache, u32 awCache, u3
 	return rc;
 }
 
+/*
+ * BM module status
+ */
 int bm_enable_status_get(u32 *bm_req_rcv_en)
 {
 	u32 reg_base_address, reg_size, reg_offset;
@@ -320,6 +329,9 @@ int bm_enable_status_get(u32 *bm_req_rcv_en)
 	return rc;
 }
 
+/*
+ * Quick init of QM pools
+ */
 int bm_qm_gpm_pools_def_quick_init(u32 num_of_buffers, struct mv_a40 *qece_base_address, struct mv_a40 *pl_base_address)
 {
 	int rc = -BM_INPUT_NOT_IN_RANGE;
@@ -387,8 +399,8 @@ int bm_qm_gpm_pools_quick_init(u32 num_of_buffers, struct mv_a40 *qece_base_addr
 	pr_info("  cache_so_thr %d cache_si_thr %d cache_num_of_buffers %d\n",
 		cache_so_thr, cache_si_thr, cache_num_of_buffers);
 
-	granularity_of_pe_in_dram  = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM;		/* 64/4 */
-	granularity_of_pe_in_cache = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_CACHE;	/* 64/8 */
+	granularity_of_pe_in_dram  = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM; /* 64B/QM PE is 4B = 16 */
+	granularity_of_pe_in_cache = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_CACHE; /* 64B/QM PE is 4B = 16 */
 
 	if (num_of_buffers < cache_num_of_buffers) {
 		pr_err("number of buffers in dram should be equal or larger than cache number of buffers\n");
@@ -410,7 +422,7 @@ int bm_qm_gpm_pools_quick_init(u32 num_of_buffers, struct mv_a40 *qece_base_addr
 		pr_err("number of buffer in cahce should be multiplication of %d\n", granularity_of_pe_in_cache);
 		return rc;
 	}
-	if (af_thr       < ae_thr) {
+	if (af_thr       <= ae_thr) {
 		pr_err("almost full should be larger than almost empty\n");
 		return rc;
 	}
@@ -561,8 +573,8 @@ int bm_qm_dram_pools_quick_init(u32 num_of_buffers, struct mv_a40 *qece_base_add
 
 	BM_AVAILABLE_CHECK();
 
-	granularity_of_pe_in_dram  = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM;		/* 64/4 */
-	granularity_of_pe_in_cache = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_CACHE;	/* 64/4 */
+	granularity_of_pe_in_dram  = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM; /* 64B/QM PE is 4B = 16 */
+	granularity_of_pe_in_cache = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_CACHE; /* 64B/QM PE is 4B = 16 */
 
 	if (num_of_buffers < cache_num_of_buffers) {
 		pr_err("number of buffers in dram should be equal or larger than cache number of buffers\n");
@@ -656,7 +668,8 @@ int bm_qm_dram_pools_quick_init(u32 num_of_buffers, struct mv_a40 *qece_base_add
 	/*	for pools 2&3 it allocates the buffer memory before filling the pool	*/
 	rc = ENOMEM;
 	pl_buf_address_allocate.virt_lsb =
-			(u32)dma_alloc_coherent(NULL, num_of_buffers*4, &(pl_buf_address_allocate.dma_lsb), GFP_KERNEL);
+			(u32)dma_alloc_coherent(NULL, num_of_buffers*buffer_size, &(pl_buf_address_allocate.dma_lsb),
+			GFP_KERNEL);
 	if (pl_buf_address_allocate.virt_lsb == (u32)NULL)
 		return rc;
 		/*base_address_hi need to be resolved - ???*/
@@ -691,7 +704,8 @@ int bm_qm_dram_pools_quick_init(u32 num_of_buffers, struct mv_a40 *qece_base_add
 	/*	for pools 2&3 it allocates the buffer memory before filling the pool	*/
 	rc = ENOMEM;
 	qece_buf_address_allocate.virt_lsb =
-		(u32)dma_alloc_coherent(NULL, num_of_buffers*4, &(qece_buf_address_allocate.dma_lsb), GFP_KERNEL);
+		(u32)dma_alloc_coherent(NULL, num_of_buffers*buffer_size, &(qece_buf_address_allocate.dma_lsb),
+		GFP_KERNEL);
 	if (qece_buf_address_allocate.virt_lsb == (u32)NULL)
 		return rc;
 		/*base_address_hi need to be resolved - ???*/
@@ -761,6 +775,9 @@ int bm_pool_quick_init_status_get(u32 pool, u32 *completed)
 	return rc;
 }
 
+/*
+ * Init of GP pools
+ */
 int bm_gp_pool_def_basic_init(u32 pool, u32 num_of_buffers, struct mv_a40 *base_address,
 	u32 partition_model, u32 pool_pair)
 {
@@ -805,6 +822,17 @@ int bm_gp_pool_basic_init(u32 pool, u32 num_of_buffers, struct mv_a40 *base_addr
 	u32 granularity_of_pe_in_dram, granularity_of_pe_in_cache;
 
 	BM_AVAILABLE_CHECK();
+	pr_info("%s:\n", __func__);
+	pr_info("  num_of_buffers    %d\n", num_of_buffers);
+	pr_info("  base_address virtual 0x%02X%08X   physical 0x%02X%08X\n",
+		base_address->virt_msb, base_address->virt_lsb,
+		base_address->dma_msb,   base_address->dma_lsb);
+	pr_info("  ae_thr %d af_thr %d\n", ae_thr, af_thr);
+	pr_info("  cache_vmid %d cache_attr %d\n", cache_vmid, cache_attr);
+	pr_info("  cache_so_thr %d cache_si_thr %d cache_num_of_buffers %d\n",
+		cache_so_thr, cache_si_thr, cache_num_of_buffers);
+
+
 
 	if (pe_size == BM_PE_SIZE_IS_40_BITS) {
 		granularity_of_pe_in_dram  =
@@ -854,11 +882,12 @@ int bm_gp_pool_basic_init(u32 pool, u32 num_of_buffers, struct mv_a40 *base_addr
 			cache_so_thr, cache_si_thr);
 		return rc;
 	}
-	if ((pool                 <          BM_POOL_GP_MIN) || (pool                 >          BM_POOL_GP_MAX)) {
+	if ((pool                 <          BM_POOL_GP_MIN) || (pool             >          BM_POOL_GP_MAX)) {
 		pr_err("wrong pool number %d. should be in range %d..%d\n", pool, BM_POOL_GP_MIN, BM_POOL_GP_MAX);
 		return rc;
 	}
-	if ((num_of_buffers       < BM_NUM_OF_BUFFERS_GP_MIN) || (num_of_buffers       > BM_NUM_OF_BUFFERS_GP_MAX)) {
+	if ((num_of_buffers != 0) && /* pool can resides only in cache */
+		((num_of_buffers       < BM_NUM_OF_BUFFERS_GP_MIN) || (num_of_buffers > BM_NUM_OF_BUFFERS_GP_MAX))) {
 		pr_err("wrong number of buffer %d. should be in range %d..%d\n",
 			num_of_buffers, BM_NUM_OF_BUFFERS_GP_MIN, BM_NUM_OF_BUFFERS_GP_MAX);
 		return rc;
@@ -946,6 +975,146 @@ int bm_gp_pool_basic_init(u32 pool, u32 num_of_buffers, struct mv_a40 *base_addr
 	return rc;
 }
 
+int bm_gp_pool_def_quick_init(u32 pool, u32 num_of_buffers, u32 fill_level,
+					struct mv_a40 *base_address, u32 partition_model, u32 pool_pair)
+{
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 pe_size, ae_thr, af_thr, cache_vmid, cache_attr,
+					cache_so_thr, cache_si_thr, cache_num_of_buffers;
+
+	BM_AVAILABLE_CHECK();
+
+	pe_size              = BM_PE_SIZE_IS_32_BITS;
+	ae_thr               = BM_AE_THR_DEF(num_of_buffers);
+	af_thr               = BM_AF_THR_DEF(num_of_buffers);
+	cache_vmid           = BM_CACHE_VMID_DEF;
+	cache_attr           = BM_CACHE_ATTR_DEF;
+
+
+	if (partition_model == BM_BIG_PARTITION_IN_CACHE) {			/* large partition in cache */
+		cache_si_thr         = BM_CACHE_SI_THR_GP_BIG_DEF;
+		cache_so_thr         = BM_CACHE_SO_THR_GP_BIG_DEF;
+		cache_num_of_buffers = BM_CACHE_NUM_OF_BUFFERS_GP_BIG_DEF;
+	} else if (partition_model == BM_SMALL_PARTITION_IN_CACHE) {	/* small partition in cache */
+		cache_si_thr         = BM_CACHE_SI_THR_GP_SMALL_DEF;
+		cache_so_thr         = BM_CACHE_SO_THR_GP_SMALL_DEF;
+		cache_num_of_buffers = BM_CACHE_NUM_OF_BUFFERS_GP_SMALL_DEF;
+	} else
+		return rc;
+
+	rc = bm_gp_pool_quick_init(pool, num_of_buffers, fill_level, base_address,
+					pe_size, pool_pair, ae_thr, af_thr,
+					cache_vmid, cache_attr, cache_so_thr, cache_si_thr, cache_num_of_buffers);
+	return rc;
+}
+
+int bm_gp_pool_quick_init(u32 pool, u32 num_of_buffers, u32 fill_level, struct mv_a40 *base_address,
+				u32 pe_size, u32 pool_pair, u32 ae_thr, u32 af_thr,
+				u32 cache_vmid, u32 cache_attr, u32 cache_so_thr, u32 cache_si_thr,
+				u32 cache_num_of_buffers)
+{
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 quick_init/*, bm_req_rcv_en*/;
+	u32 granularity_of_pe_in_dram, granularity_of_pe_in_cache;
+
+	BM_AVAILABLE_CHECK();
+
+	quick_init = BM_QUICK_INIT_IS_ON;	/*quick_init is TRUE*/
+
+	if (pe_size == BM_PE_SIZE_IS_40_BITS) {
+		granularity_of_pe_in_dram  =
+			GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_40_BITS_IN_BYTES_IN_DRAM;	/* 64/8 */
+		granularity_of_pe_in_cache =
+			GRANULARITY_OF_64_BYTES / GP_PE_SIZE_IN_BYTES_IN_CACHE;			/* 64/8 */
+	} else if (pe_size == BM_PE_SIZE_IS_32_BITS) {
+		granularity_of_pe_in_dram  =
+			GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_32_BITS_IN_BYTES_IN_DRAM;	/* 64/4 */
+		granularity_of_pe_in_cache =
+			GRANULARITY_OF_64_BYTES / GP_PE_SIZE_IN_BYTES_IN_CACHE;			/* 64/8 */
+	} else
+		return rc;
+
+	if ((num_of_buffers % granularity_of_pe_in_dram) != 0)
+		return rc;
+	if         ((ae_thr % granularity_of_pe_in_dram) != 0)
+		return rc;
+	if         ((af_thr % granularity_of_pe_in_dram) != 0)
+		return rc;
+	if ((base_address->dma_lsb % granularity_of_pe_in_dram)  != 0)
+		return rc;
+	if ((cache_num_of_buffers % granularity_of_pe_in_cache) != 0)
+		return rc;
+
+	if (af_thr       < ae_thr)
+		return rc;
+	if (cache_so_thr < cache_si_thr + 16)
+		return rc;
+
+	if ((pool                 <          BM_POOL_GP_MIN) || (pool                 >          BM_POOL_GP_MAX))
+		return rc;
+	if ((num_of_buffers       < BM_NUM_OF_BUFFERS_GP_MIN) || (num_of_buffers      > BM_NUM_OF_BUFFERS_GP_MAX))
+		return rc;
+	if ((fill_level           < BM_FILL_LEVEL_MIN) || (fill_level           > BM_FILL_LEVEL_MAX(num_of_buffers)))
+		return rc;
+	if ((base_address->dma_msb < BM_DRAM_ADDRESS_MIN_MSB) ||
+		(base_address->dma_msb > BM_DRAM_ADDRESS_MAX_MSB))
+		return rc;
+	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MIN_MSB) &&
+		(base_address->dma_lsb <  BM_DRAM_ADDRESS_MIN_LSB))
+		return rc;
+	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MAX_MSB) &&
+		(base_address->dma_lsb >  BM_DRAM_ADDRESS_MAX_LSB))
+		return rc;
+	if ((pool_pair    <    BM_POOL_PAIR_MIN) || (pool_pair    >    BM_POOL_PAIR_MAX))
+		return rc;
+	if ((ae_thr       < BM_AE_THR_MIN(num_of_buffers)) || (ae_thr       > BM_AE_THR_MAX(num_of_buffers)))
+		return rc;
+	if ((af_thr       < BM_AF_THR_MIN(num_of_buffers)) || (af_thr       > BM_AF_THR_MAX(num_of_buffers)))
+		return rc;
+	if ((cache_vmid   <         BM_VMID_MIN) || (cache_vmid   >         BM_VMID_MAX))
+		return rc;
+	if ((cache_attr   <   BM_CACHE_ATTR_MIN) || (cache_attr   >   BM_CACHE_ATTR_MAX))
+		return rc;
+	if ((cache_so_thr < BM_CACHE_SO_THR_MIN) || (cache_so_thr > BM_CACHE_SI_THR_MAX(cache_num_of_buffers)))
+		return rc;
+	if ((cache_si_thr < BM_CACHE_SI_THR_MIN) || (cache_si_thr > BM_CACHE_SI_THR_MAX(cache_num_of_buffers)))
+		return rc;
+	if ((cache_num_of_buffers < BM_CACHE_NUM_OF_BUFFERS_GP_MIN)	||
+		(cache_num_of_buffers > BM_CACHE_NUM_OF_BUFFERS_GP_MAX))
+		return rc;
+
+	rc = bm_pool_dram_set(pool, num_of_buffers, pe_size, base_address, ae_thr, af_thr);
+	if (rc != OK)
+		return rc;
+	rc = bm_pool_fill_level_set(pool, num_of_buffers, pe_size, quick_init);
+	if (rc != OK)
+		return rc;
+	rc = bm_gp_pool_pe_size_set(pool, pe_size);
+	if (rc != OK)
+		return rc;
+	rc = bm_gp_pool_pair_set(pool, pool_pair);
+	if (rc != OK)
+		return rc;
+	rc = bm_pool_enable(pool, quick_init);
+	if (rc != OK)
+		return rc;
+	/* BM can be enabled before GP pool is enabled
+	rc = bm_enable_status_get(&bm_req_rcv_en);
+	if (rc != OK)
+		return rc;
+	if (bm_req_rcv_en == BM_UNIT_IS_ENABLED) {
+		rc = -BM_ATTR_CHANGE_AFTER_BM_ENABLE;
+		return rc;
+	}
+	*/
+
+	rc = OK;
+	return rc;
+}
+
+/*
+ * enable BM module
+ */
 int bm_enable(void)
 {
 	u32 reg_base_address, reg_size, reg_offset;
@@ -1016,6 +1185,9 @@ int bm_disable(void)
 	return rc;
 }
 
+/*
+ * General purpose functions for BM register reading and writing
+ */
 int bm_pool_fill_level_get(u32 pool, u32 *fill_level)
 {
 	u32 reg_base_address, reg_size, reg_offset;
@@ -1093,1084 +1265,1044 @@ int bm_vmid_set(u32 bm_vmid)
 	return rc;
 }
 
-int bm_gp_pool_def_quick_init(u32 pool, u32 num_of_buffers, u32 fill_level,
-					struct mv_a40 *base_address, u32 partition_model, u32 pool_pair)
+int bm_idle_status_get(u32 *status)
 {
+	u32 reg_base_address, reg_size, reg_offset;
 	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pe_size, ae_thr, af_thr, cache_vmid, cache_attr,
-					cache_so_thr, cache_si_thr, cache_num_of_buffers;
+	struct bm_bm_idle_st reg_bm_idle_st;
 
 	BM_AVAILABLE_CHECK();
 
-	pe_size              = BM_PE_SIZE_IS_32_BITS;
-	ae_thr               = BM_AE_THR_DEF(num_of_buffers);
-	af_thr               = BM_AF_THR_DEF(num_of_buffers);
-	cache_vmid           = BM_CACHE_VMID_DEF;
-	cache_attr           = BM_CACHE_ATTR_DEF;
+	if (((u32)status < BM_DATA_PTR_MIN) || ((u32)status > BM_DATA_PTR_MAX))
+		return rc;
 
+	reg_base_address =      bm.bm_idle_st;
+	reg_size   =   bm_reg_size.bm_idle_st;
+	reg_offset = bm_reg_offset.bm_idle_st * 0;
 
-	if (partition_model == BM_BIG_PARTITION_IN_CACHE) {			/* large partition in cache */
-		cache_si_thr         = BM_CACHE_SI_THR_GP_BIG_DEF;
-		cache_so_thr         = BM_CACHE_SO_THR_GP_BIG_DEF;
-		cache_num_of_buffers = BM_CACHE_NUM_OF_BUFFERS_GP_BIG_DEF;
-	} else if (partition_model == BM_SMALL_PARTITION_IN_CACHE) {	/* small partition in cache */
-		cache_si_thr         = BM_CACHE_SI_THR_GP_SMALL_DEF;
-		cache_so_thr         = BM_CACHE_SO_THR_GP_SMALL_DEF;
-		cache_num_of_buffers = BM_CACHE_NUM_OF_BUFFERS_GP_SMALL_DEF;
-	} else
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size,  (u32 *)&reg_bm_idle_st);
+	if (rc != OK)
 		return rc;
+	*status = reg_bm_idle_st.bm_idle_st;
 
-	rc = bm_gp_pool_quick_init(pool, num_of_buffers, fill_level, base_address,
-					pe_size, pool_pair, ae_thr, af_thr,
-					cache_vmid, cache_attr, cache_so_thr, cache_si_thr, cache_num_of_buffers);
+	rc = OK;
 	return rc;
 }
 
-int bm_gp_pool_quick_init(u32 pool, u32 num_of_buffers, u32 fill_level, struct mv_a40 *base_address,
-				u32 pe_size, u32 pool_pair, u32 ae_thr, u32 af_thr,
-				u32 cache_vmid, u32 cache_attr, u32 cache_so_thr, u32 cache_si_thr,
-				u32 cache_num_of_buffers)
+int bm_pool_status_get(u32 pool, u32 *pool_nempty, u32 *dpool_ae, u32 *dpool_af)
 {
+	u32 reg_base_address, reg_size, reg_offset;
 	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 quick_init/*, bm_req_rcv_en*/;
-	u32 granularity_of_pe_in_dram, granularity_of_pe_in_cache;
+	u32 pid, bid, pid_local;
+	struct bm_pool_st   reg_pool_st;
 
 	BM_AVAILABLE_CHECK();
 
-	quick_init = BM_QUICK_INIT_IS_ON;	/*quick_init is TRUE*/
-
-	if (pe_size == BM_PE_SIZE_IS_40_BITS) {
-		granularity_of_pe_in_dram  =
-			GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_40_BITS_IN_BYTES_IN_DRAM;	/* 64/8 */
-		granularity_of_pe_in_cache =
-			GRANULARITY_OF_64_BYTES / GP_PE_SIZE_IN_BYTES_IN_CACHE;			/* 64/8 */
-	} else if (pe_size == BM_PE_SIZE_IS_32_BITS) {
-		granularity_of_pe_in_dram  =
-			GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_32_BITS_IN_BYTES_IN_DRAM;	/* 64/4 */
-		granularity_of_pe_in_cache =
-			GRANULARITY_OF_64_BYTES / GP_PE_SIZE_IN_BYTES_IN_CACHE;			/* 64/8 */
-	} else
-		return rc;
-
-	if ((num_of_buffers % granularity_of_pe_in_dram) != 0)
-		return rc;
-	if         ((ae_thr % granularity_of_pe_in_dram) != 0)
+	if ((pool             <     BM_POOL_MIN) || (pool             >     BM_POOL_MAX))
 		return rc;
-	if         ((af_thr % granularity_of_pe_in_dram) != 0)
+	if ((pool             >  BM_POOL_QM_MAX) && (pool             <  BM_POOL_GP_MIN))
+		return rc; /* pools 4, 5, 6, 7 don't exist */
+	if (((u32)pool_nempty < BM_DATA_PTR_MIN) || ((u32)pool_nempty > BM_DATA_PTR_MAX))
 		return rc;
-	if ((base_address->dma_lsb % granularity_of_pe_in_dram)  != 0)
+	if (((u32)dpool_ae    < BM_DATA_PTR_MIN) || ((u32)dpool_ae    > BM_DATA_PTR_MAX))
 		return rc;
-	if ((cache_num_of_buffers % granularity_of_pe_in_cache) != 0)
+	if (((u32)dpool_af    < BM_DATA_PTR_MIN) || ((u32)dpool_af    > BM_DATA_PTR_MAX))
 		return rc;
 
-	if (af_thr       < ae_thr)
-		return rc;
-	if (cache_so_thr < cache_si_thr + 16)
-		return rc;
+	pid = (int)pool;
+	bid = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	if ((pool                 <          BM_POOL_GP_MIN) || (pool                 >          BM_POOL_GP_MAX))
-		return rc;
-	if ((num_of_buffers       < BM_NUM_OF_BUFFERS_GP_MIN) || (num_of_buffers      > BM_NUM_OF_BUFFERS_GP_MAX))
-		return rc;
-	if ((fill_level           < BM_FILL_LEVEL_MIN) || (fill_level           > BM_FILL_LEVEL_MAX(num_of_buffers)))
-		return rc;
-	if ((base_address->dma_msb < BM_DRAM_ADDRESS_MIN_MSB) ||
-		(base_address->dma_msb > BM_DRAM_ADDRESS_MAX_MSB))
-		return rc;
-	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MIN_MSB) &&
-		(base_address->dma_lsb <  BM_DRAM_ADDRESS_MIN_LSB))
-		return rc;
-	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MAX_MSB) &&
-		(base_address->dma_lsb >  BM_DRAM_ADDRESS_MAX_LSB))
-		return rc;
-	if ((pool_pair    <    BM_POOL_PAIR_MIN) || (pool_pair    >    BM_POOL_PAIR_MAX))
-		return rc;
-	if ((ae_thr       < BM_AE_THR_MIN(num_of_buffers)) || (ae_thr       > BM_AE_THR_MAX(num_of_buffers)))
-		return rc;
-	if ((af_thr       < BM_AF_THR_MIN(num_of_buffers)) || (af_thr       > BM_AF_THR_MAX(num_of_buffers)))
-		return rc;
-	if ((cache_vmid   <         BM_VMID_MIN) || (cache_vmid   >         BM_VMID_MAX))
-		return rc;
-	if ((cache_attr   <   BM_CACHE_ATTR_MIN) || (cache_attr   >   BM_CACHE_ATTR_MAX))
-		return rc;
-	if ((cache_so_thr < BM_CACHE_SO_THR_MIN) || (cache_so_thr > BM_CACHE_SI_THR_MAX(cache_num_of_buffers)))
-		return rc;
-	if ((cache_si_thr < BM_CACHE_SI_THR_MIN) || (cache_si_thr > BM_CACHE_SI_THR_MAX(cache_num_of_buffers)))
-		return rc;
-	if ((cache_num_of_buffers < BM_CACHE_NUM_OF_BUFFERS_GP_MIN)	||
-		(cache_num_of_buffers > BM_CACHE_NUM_OF_BUFFERS_GP_MAX))
+	reg_base_address =      bm.b_pool_n_st[bid];
+	reg_size   =   bm_reg_size.b_pool_n_st[bid];
+	reg_offset = bm_reg_offset.b_pool_n_st[bid] * pid_local;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_pool_st);
+	if (rc != OK)
 		return rc;
 
-	rc = bm_pool_dram_set(pool, num_of_buffers, pe_size, base_address, ae_thr, af_thr);
-	if (rc != OK)
-		return rc;
-	rc = bm_pool_fill_level_set(pool, num_of_buffers, pe_size, quick_init);
-	if (rc != OK)
-		return rc;
-	rc = bm_gp_pool_pe_size_set(pool, pe_size);
-	if (rc != OK)
-		return rc;
-	rc = bm_gp_pool_pair_set(pool, pool_pair);
-	if (rc != OK)
+	*pool_nempty = reg_pool_st.pool_nempty_st;
+	*dpool_ae    = reg_pool_st.dpool_ae_st;
+	*dpool_af    = reg_pool_st.dpool_af_st;
+
+	rc = OK;
+	return rc;
+}
+
+/*BM Internal functions*/
+int bm_pool_memory_fill(u32 pool, u32 num_of_buffers, struct mv_a40 *base_address)
+{
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 granularity_of_pe_in_dram;
+	u32 i, *p;
+	granularity_of_pe_in_dram = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM;	/* 64/4 */
+
+	BM_AVAILABLE_CHECK();
+
+	if ((num_of_buffers % granularity_of_pe_in_dram) != 0) /* UNIT_OF__1_BYTES = 1 */
+		return rc; /* PE_size is 22 bit */
+	if ((pool            <         BM_POOL_QM_MIN) || (pool            >         BM_POOL_QM_MAX))
 		return rc;
-	rc = bm_pool_enable(pool, quick_init);
-	if (rc != OK)
+	if ((pool == 0) || (pool == 1)) {
+		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers >  BM_NUM_OF_BUFFERS_QM_GPM_MAX))
+			return rc;
+	}
+	if ((pool == 2) || (pool == 3)) {
+		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers > BM_NUM_OF_BUFFERS_QM_DRAM_MAX))
+			return rc;
+	}
+	if ((base_address->dma_msb < BM_DRAM_ADDRESS_MIN_MSB) ||
+		(base_address->dma_msb > BM_DRAM_ADDRESS_MAX_MSB))
 		return rc;
-	/* BM can be enabled before GP pool is enabled
-	rc = bm_enable_status_get(&bm_req_rcv_en);
-	if (rc != OK)
+	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MIN_MSB) &&
+		(base_address->dma_lsb <  BM_DRAM_ADDRESS_MIN_LSB))
 		return rc;
-	if (bm_req_rcv_en == BM_UNIT_IS_ENABLED) {
-		rc = -BM_ATTR_CHANGE_AFTER_BM_ENABLE;
+	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MAX_MSB) &&
+		(base_address->dma_lsb >  BM_DRAM_ADDRESS_MAX_LSB))
 		return rc;
+
+    /*
+	 * Takes pool_base_address and use it as a pointer
+	 * to fill all PE's with incrementing value (starting with 1)
+	 * Write in Dram in BM pool section an incrementing index
+	 */
+
+	p = (u32 *)(base_address->virt_lsb);
+	pr_info("%s:\n", __func__);
+	pr_info("  num_of_buffers    %d\n", num_of_buffers);
+	pr_info("  base_address virtual 0x%02X%08X	physical 0x%02X%08X\n",
+		base_address->virt_msb, base_address->virt_lsb,
+		base_address->dma_msb, base_address->dma_lsb);
+
+	for (i = 0; i < num_of_buffers; i++) {
+		*p = i + 1;
+		p++;
 	}
-	*/
 
 	rc = OK;
 	return rc;
 }
 
-/*BM Debug functions*/
-int bm_global_registers_dump(void)
+int bm_pool_dram_set(u32 pool, u32 num_of_buffers, u32 pe_size, struct mv_a40 *base_address,
+						u32 ae_thr, u32 af_thr)
 {
 	u32 reg_base_address, reg_size, reg_offset;
-	int rc = !OK;
-	char reg_name[50];
-	struct bm_sys_nrec_common_d0_st  reg_sys_nrec_common_d0_st;
-	struct bm_sys_nrec_common_d1_st  reg_sys_nrec_common_d1_st;
-	struct bm_sys_nrec_common_d2_st  reg_sys_nrec_common_d2_st;
-	struct bm_sys_nrec_common_d3_st  reg_sys_nrec_common_d3_st;
-	struct bm_common_general_conf    reg_common_general_conf;
-	struct bm_dram_domain_conf       reg_dram_domain_conf;
-	struct bm_dram_cache_conf        reg_dram_cache_conf;
-	struct bm_dram_qos_conf          reg_dram_qos_conf;
-	struct bm_dm_axi_fifos_st        reg_dm_axi_fifos_st;
-	struct bm_drm_pend_fifo_st       reg_drm_pend_fifo_st;
-	struct bm_dm_axi_wr_pend_fifo_st reg_dm_axi_wr_pend_fifo_st;
-	struct bm_bm_idle_st             reg_bm_idle_st;
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 pid, bid, pid_local, dram_size, dram_ae_thr, dram_af_thr;
+	struct bm_d_mng_ball_stat_data          tab_dpr_d_mng_ball_stat;
+	u32 granularity_of_pe_in_dram;
 
 	BM_AVAILABLE_CHECK();
 
-	reg_base_address =      bm.sys_nrec_common_d0_st;
-	reg_size   =   bm_reg_size.sys_nrec_common_d0_st;
-	reg_offset = bm_reg_offset.sys_nrec_common_d0_st * 0;
-
-	pr_info("\n-------------- BM Global registers dump -----------");
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_d0_st);
-	if (rc != OK)
+	if ((pool >= BM_POOL_QM_MIN) && (pool <= BM_POOL_QM_MAX)) { /* QM pools */
+		granularity_of_pe_in_dram = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM;	/* 64/4 */
+	} else if ((pool >= BM_POOL_GP_MIN) && (pool <= BM_POOL_GP_MAX)) { /* GP pools */
+		if (pe_size == BM_PE_SIZE_IS_40_BITS)
+			granularity_of_pe_in_dram =
+				GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_40_BITS_IN_BYTES_IN_DRAM;	/* 64/8 */
+		else if (pe_size == BM_PE_SIZE_IS_32_BITS)
+			granularity_of_pe_in_dram =
+				GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_32_BITS_IN_BYTES_IN_DRAM;	/* 64/4 */
+		else
+			return rc;
+	} else
 		return rc;
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if ((num_of_buffers % granularity_of_pe_in_dram) != 0)
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset,
-		*((u32 *)&reg_sys_nrec_common_d0_st));
-
-	pr_info("\t sys_nrec_common_d0_st.qm_last_alc_viol_pid_st  = 0x%08X\n",
-				reg_sys_nrec_common_d0_st.qm_last_alc_viol_pid_st);
-	pr_info("\t sys_nrec_common_d0_st.qm_last_rls_viol_pid_st  = 0x%08X\n",
-				reg_sys_nrec_common_d0_st.qm_last_rls_viol_pid_st);
-	pr_info("\t sys_nrec_common_d0_st.ppe_last_alc_viol_pid_st = 0x%08X\n",
-				reg_sys_nrec_common_d0_st.ppe_last_alc_viol_pid_st);
-	pr_info("\t sys_nrec_common_d0_st.ppe_last_rls_viol_pid_st = 0x%08X\n",
-				reg_sys_nrec_common_d0_st.ppe_last_rls_viol_pid_st);
-
-	reg_base_address =      bm.sys_nrec_common_d1_st;
-	reg_size   =   bm_reg_size.sys_nrec_common_d1_st;
-	reg_offset = bm_reg_offset.sys_nrec_common_d1_st * 0;
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_d1_st);
-	if (rc != OK)
+	if         ((ae_thr % granularity_of_pe_in_dram) != 0)
 		return rc;
-	pr_info("\n");
-
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if         ((af_thr % granularity_of_pe_in_dram) != 0)
+		return rc;
+	if ((base_address->dma_lsb % GRANULARITY_OF_64_BYTES) != 0)
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset,
-		*((u32 *)&reg_sys_nrec_common_d1_st));
 
-	pr_info("\t sys_nrec_common_d1_st.mac_last_alc_viol_pid_st = 0x%08X\n",
-				reg_sys_nrec_common_d1_st.mac_last_alc_viol_pid_st);
-	pr_info("\t sys_nrec_common_d1_st.mac_last_rls_viol_pid_st = 0x%08X\n",
-				reg_sys_nrec_common_d1_st.mac_last_rls_viol_pid_st);
-	pr_info("\t sys_nrec_common_d1_st.drm_last_dram_err_pid_st = 0x%08X\n",
-				reg_sys_nrec_common_d1_st.drm_last_dram_err_pid_st);
-	pr_info("\t sys_nrec_common_d1_st.dwm_last_fail_so_pid_st  = 0x%08X\n",
-				reg_sys_nrec_common_d1_st.dwm_last_fail_so_pid_st);
+	if (af_thr       < ae_thr)
+		return rc;
 
-	reg_base_address =      bm.sys_nrec_common_d2_st;
-	reg_size   =   bm_reg_size.sys_nrec_common_d2_st;
-	reg_offset = bm_reg_offset.sys_nrec_common_d2_st * 0;
+	if ((pool            <            BM_POOL_MIN) || (pool            >            BM_POOL_MAX))
+		return rc;
+	if ((pool            >         BM_POOL_QM_MAX) && (pool            <         BM_POOL_GP_MIN))
+		return rc; /* pools 4, 5, 6, 7 don't exist */
+	if ((pool == 0) || (pool == 1)) {
+		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers >  BM_NUM_OF_BUFFERS_QM_GPM_MAX))
+			return rc;
+	} else if ((pool == 2) || (pool == 3)) {
+		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers > BM_NUM_OF_BUFFERS_QM_DRAM_MAX))
+			return rc;
+	} else if ((pool >= BM_POOL_GP_MIN) && (pool <= BM_POOL_GP_MAX)) {
+		if ((num_of_buffers < BM_NUM_OF_BUFFERS_GP_MIN) || (num_of_buffers >      BM_NUM_OF_BUFFERS_GP_MAX))
+			return rc; /* pools 4, 5, 6, 7 don't exist */
+	} else
+		return rc;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_d2_st);
-	if (rc != OK)
+	if ((pe_size         != BM_PE_SIZE_IS_32_BITS) && (pe_size         != BM_PE_SIZE_IS_40_BITS))
 		return rc;
-	pr_info("\n");
 
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if ((base_address->dma_msb < BM_DRAM_ADDRESS_MIN_MSB) ||
+		(base_address->dma_msb > BM_DRAM_ADDRESS_MAX_MSB))
+		return rc;
+	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MIN_MSB) &&
+		(base_address->dma_lsb <  BM_DRAM_ADDRESS_MIN_LSB))
+		return rc;
+	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MAX_MSB) &&
+		(base_address->dma_lsb >  BM_DRAM_ADDRESS_MAX_LSB))
+		return rc;
+	if ((ae_thr          < BM_AE_THR_MIN(num_of_buffers)) || (ae_thr          > BM_AE_THR_MAX(num_of_buffers)))
+		return rc;
+	if ((af_thr          < BM_AF_THR_MIN(num_of_buffers)) || (af_thr          > BM_AF_THR_MAX(num_of_buffers)))
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset,
-		*((u32 *)&reg_sys_nrec_common_d2_st));
 
-	pr_info("\t sys_nrec_common_d2_st.qm_last_alc_viol_blen_st  = 0x%08X\n",
-				reg_sys_nrec_common_d2_st.qm_last_alc_viol_blen_st);
-	pr_info("\t sys_nrec_common_d2_st.qm_last_rls_viol_blen_st  = 0x%08X\n",
-				reg_sys_nrec_common_d2_st.qm_last_rls_viol_blen_st);
-	pr_info("\t sys_nrec_common_d2_st.ppe_last_alc_viol_blen_st = 0x%08X\n",
-				reg_sys_nrec_common_d2_st.ppe_last_alc_viol_blen_st);
-	pr_info("\t sys_nrec_common_d2_st.ppe_last_rls_viol_blen_st = 0x%08X\n",
-				reg_sys_nrec_common_d2_st.ppe_last_rls_viol_blen_st);
+	pid       = (int)pool;
+	bid       = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	reg_base_address =      bm.sys_nrec_common_d3_st;
-	reg_size   =   bm_reg_size.sys_nrec_common_d3_st;
-	reg_offset = bm_reg_offset.sys_nrec_common_d3_st * 0;
+	reg_base_address =      bm.dpr_d_mng_ball_stat;
+	reg_size   =   bm_reg_size.dpr_d_mng_ball_stat;
+	reg_offset = bm_reg_offset.dpr_d_mng_ball_stat * BM_PID_TO_GLOBAL_POOL_IDX(pid);
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_d3_st);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_d_mng_ball_stat);
 	if (rc != OK)
 		return rc;
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	tab_dpr_d_mng_ball_stat.dram_start_msb = base_address->dma_msb;
+	tab_dpr_d_mng_ball_stat.dram_start_lsb = base_address->dma_lsb;
+	if (bid == 0) {
+		dram_ae_thr = BM_QM_PE_UNITS_TO_BYTES(ae_thr);
+		dram_af_thr = BM_QM_PE_UNITS_TO_BYTES(af_thr);
+		dram_size   = BM_QM_PE_UNITS_TO_BYTES(num_of_buffers);
+	} else if (bid != 0) {
+		dram_ae_thr = BM_GP_PE_UNITS_TO_BYTES(ae_thr,         pe_size);
+		dram_af_thr = BM_GP_PE_UNITS_TO_BYTES(af_thr,         pe_size);
+		dram_size   = BM_GP_PE_UNITS_TO_BYTES(num_of_buffers, pe_size);
+	} else
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset,
-		*((u32 *)&reg_sys_nrec_common_d3_st));
 
-	pr_info("\t sys_nrec_common_d3_st.mac_last_alc_viol_blen_st = 0x%08X\n",
-				reg_sys_nrec_common_d3_st.mac_last_alc_viol_blen_st);
-	pr_info("\t sys_nrec_common_d3_st.mac_last_rls_viol_blen_st = 0x%08X\n",
-				reg_sys_nrec_common_d3_st.mac_last_rls_viol_blen_st);
+	tab_dpr_d_mng_ball_stat.dram_ae_thr	= dram_ae_thr / UNIT_OF_64_BYTES;
+	tab_dpr_d_mng_ball_stat.dram_af_thr	= dram_af_thr / UNIT_OF_64_BYTES;
+	tab_dpr_d_mng_ball_stat.dram_size   = dram_size / UNIT_OF_64_BYTES;
+	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_d_mng_ball_stat);
+	return rc;
+}
 
-	reg_base_address =      bm.common_general_conf;
-	reg_size   =   bm_reg_size.common_general_conf;
-	reg_offset = bm_reg_offset.common_general_conf * 0;
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_common_general_conf);
-	if (rc != OK)
-		return rc;
-
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
-		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset,
-		*((u32 *)&reg_common_general_conf));
-
-	pr_info("\t common_general_conf.mac_last_alc_viol_pid_st = 0x%08X\n",
-				reg_common_general_conf.drm_si_decide_extra_fill);
-	pr_info("\t common_general_conf.mac_last_rls_viol_pid_st = 0x%08X\n",
-				reg_common_general_conf.dm_vmid);
-	pr_info("\t common_general_conf.drm_last_dram_err_pid_st = 0x%08X\n",
-				reg_common_general_conf.bm_req_rcv_en);
+int bm_pool_fill_level_set(u32 pool, u32 num_of_buffers, u32 pe_size, u32 quick_init)
+{
+	u32 reg_base_address, reg_size, reg_offset;
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 pid, bid, pid_local, dram_fill;
+	struct bm_tpr_drw_mng_ball_dyn_data         tab_tpr_drw_mng_ball_dyn;
+	u32 granularity_of_pe_in_dram;
 
-	reg_base_address =      bm.dram_domain_conf;
-	reg_size   =   bm_reg_size.dram_domain_conf;
-	reg_offset = bm_reg_offset.dram_domain_conf * 0;
+	BM_AVAILABLE_CHECK();
 
-	pr_info("\n");
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dram_domain_conf);
-	if (rc != OK)
+	if ((pool >= BM_POOL_QM_MIN) && (pool <= BM_POOL_QM_MAX)) { /* QM pools */
+		granularity_of_pe_in_dram = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM;	/* 64/4 */
+	} else if ((pool >= BM_POOL_GP_MIN) && (pool <= BM_POOL_GP_MAX)) { /* GP pools */
+		if (pe_size == BM_PE_SIZE_IS_40_BITS)
+			granularity_of_pe_in_dram =
+				GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_40_BITS_IN_BYTES_IN_DRAM;	/* 64/8 */
+		else if (pe_size == BM_PE_SIZE_IS_32_BITS)
+			granularity_of_pe_in_dram =
+				GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_32_BITS_IN_BYTES_IN_DRAM;	/* 64/4 */
+		else
+			return rc;
+	} else
 		return rc;
 
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if ((num_of_buffers % granularity_of_pe_in_dram) != 0)
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset,
-		*((u32 *)&reg_dram_domain_conf));
-
-	pr_info("\t dram_domain_conf.dwm_awdomain_b0  = 0x%08X\n", reg_dram_domain_conf.dwm_awdomain_b0);
-	pr_info("\t dram_domain_conf.dwm_awdomain_bgp = 0x%08X\n", reg_dram_domain_conf.dwm_awdomain_bgp);
-	pr_info("\t dram_domain_conf.drm_ardomain_b0  = 0x%08X\n", reg_dram_domain_conf.drm_ardomain_b0);
-	pr_info("\t dram_domain_conf.drm_ardomain_bgp = 0x%08X\n", reg_dram_domain_conf.drm_ardomain_bgp);
 
-	reg_base_address =      bm.dram_cache_conf;
-	reg_size   =   bm_reg_size.dram_cache_conf;
-	reg_offset = bm_reg_offset.dram_cache_conf * 0;
-
-	pr_info("\n");
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dram_cache_conf);
-	if (rc != OK)
+	if ((pool           <       BM_POOL_MIN) || (pool           >            BM_POOL_MAX))
 		return rc;
-
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if ((pool           >    BM_POOL_QM_MAX) && (pool           <         BM_POOL_GP_MIN))
+		return rc; /* pools 4, 5, 6, 7 don't exist */
+	if ((pool == 0) || (pool == 1)) {
+		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers >  BM_NUM_OF_BUFFERS_QM_GPM_MAX))
+			return rc;
+	} else if ((pool == 2) || (pool == 3)) {
+		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers > BM_NUM_OF_BUFFERS_QM_DRAM_MAX))
+			return rc;
+	} else if ((pool >= BM_POOL_GP_MIN) && (pool <= BM_POOL_GP_MAX)) {
+		if ((num_of_buffers < BM_NUM_OF_BUFFERS_GP_MIN) || (num_of_buffers >      BM_NUM_OF_BUFFERS_GP_MAX))
+			return rc; /* pools 4, 5, 6, 7 don't exist */
+	} else
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset,
-		*((u32 *)&reg_dram_cache_conf));
-
-	pr_info("\t dram_cache_conf.dwm_awcache_b0  = 0x%08X\n", reg_dram_cache_conf.dwm_awcache_b0);
-	pr_info("\t dram_cache_conf.dwm_awcache_bgp = 0x%08X\n", reg_dram_cache_conf.dwm_awcache_bgp);
-	pr_info("\t dram_cache_conf.drm_arcache_b0  = 0x%08X\n", reg_dram_cache_conf.drm_arcache_b0);
-	pr_info("\t dram_cache_conf.drm_arcache_bgp = 0x%08X\n", reg_dram_cache_conf.drm_arcache_bgp);
-
-	reg_base_address =      bm.dram_qos_conf;
-	reg_size   =   bm_reg_size.dram_qos_conf;
-	reg_offset = bm_reg_offset.dram_qos_conf * 0;
 
-	pr_info("\n");
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dram_qos_conf);
-	if (rc != OK)
+	if ((pe_size   != BM_PE_SIZE_IS_32_BITS) && (pe_size        != BM_PE_SIZE_IS_40_BITS))
 		return rc;
-
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if ((quick_init     < BM_QUICK_INIT_MIN) || (quick_init     >      BM_QUICK_INIT_MAX))
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_dram_qos_conf));
-
-	pr_info("\t dram_qos_conf.dwm_awqos_b0  = 0x%08X\n", reg_dram_qos_conf.dwm_awqos_b0);
-	pr_info("\t dram_qos_conf.dwm_awqos_bgp = 0x%08X\n", reg_dram_qos_conf.dwm_awqos_bgp);
-	pr_info("\t dram_qos_conf.drm_arqos_b0  = 0x%08X\n", reg_dram_qos_conf.drm_arqos_b0);
-	pr_info("\t dram_qos_conf.drm_arqos_bgp = 0x%08X\n", reg_dram_qos_conf.drm_arqos_bgp);
 
-	reg_base_address =      bm.dm_axi_fifos_st;
-	reg_size   =   bm_reg_size.dm_axi_fifos_st;
-	reg_offset = bm_reg_offset.dm_axi_fifos_st * 0;
+	pid       = (int)pool;
+	bid       = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	pr_info("\n");
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dm_axi_fifos_st);
-	if (rc != OK)
-		return rc;
+	reg_base_address =      bm.tpr_drw_mng_ball_dyn;
+	reg_size   =   bm_reg_size.tpr_drw_mng_ball_dyn;
+	reg_offset = bm_reg_offset.tpr_drw_mng_ball_dyn * BM_PID_TO_GLOBAL_POOL_IDX(pid);
 
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_drw_mng_ball_dyn);
 	if (rc != OK)
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_dm_axi_fifos_st));
 
-	pr_info("\t dm_axi_fifos_st.dwm_waddr_fifo_fill_st = 0x%08X\n",
-				reg_dm_axi_fifos_st.dwm_waddr_fifo_fill_st);
-	pr_info("\t dm_axi_fifos_st.dwm_wdata_fifo_fill_st = 0x%08X\n",
-				reg_dm_axi_fifos_st.dwm_wdata_fifo_fill_st);
-	pr_info("\t dm_axi_fifos_st.drm_raddr_fifo_fill_st = 0x%08X\n",
-				reg_dm_axi_fifos_st.drm_raddr_fifo_fill_st);
-	pr_info("\t dm_axi_fifos_st.drm_rdata_fifo_fill_st = 0x%08X\n",
-				reg_dm_axi_fifos_st.drm_rdata_fifo_fill_st);
+	if (bid == 0)
+		dram_fill	= BM_QM_PE_UNITS_TO_BYTES(num_of_buffers);
+	if (bid != 0)
+		dram_fill	= BM_GP_PE_UNITS_TO_BYTES(num_of_buffers, pe_size);
+	if (quick_init == 1) /* quick init is on */
+		tab_tpr_drw_mng_ball_dyn.dram_fill	= dram_fill/UNIT_OF__8_BYTES;
+	else /* quick init is off */
+		tab_tpr_drw_mng_ball_dyn.dram_fill	= 0;
+	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_drw_mng_ball_dyn);
+	return rc;
+}
 
-	reg_base_address =      bm.drm_pend_fifo_st;
-	reg_size   =   bm_reg_size.drm_pend_fifo_st;
-	reg_offset = bm_reg_offset.drm_pend_fifo_st * 0;
+int bm_pool_enable(u32 pool, u32 quick_init)
+{
+	u32 reg_base_address, reg_size, reg_offset;
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 pid, bid, pid_local;
+	struct bm_pool_conf_b0  reg_b0_pool_conf;
+	struct bm_pool_conf_bgp reg_bgp_pool_conf;
 
-	pr_info("\n");
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_drm_pend_fifo_st);
-	if (rc != OK)
-		return rc;
+	BM_AVAILABLE_CHECK();
 
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if ((pool       <       BM_POOL_MIN) || (pool       >       BM_POOL_MAX))
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_drm_pend_fifo_st));
-
-	pr_info("\t drm_pend_fifo_st.drm_pend_fifo_fill_st = 0x%08X\n",
-						reg_drm_pend_fifo_st.drm_pend_fifo_fill_st);
-
-	reg_base_address =      bm.dm_axi_wr_pend_fifo_st;
-	reg_size   =   bm_reg_size.dm_axi_wr_pend_fifo_st;
-	reg_offset = bm_reg_offset.dm_axi_wr_pend_fifo_st * 0;
-
-	pr_info("\n");
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dm_axi_wr_pend_fifo_st);
-	if (rc != OK)
+	if ((pool       >    BM_POOL_QM_MAX) && (pool       <    BM_POOL_GP_MIN))
+		return rc; /* pools 4, 5, 6, 7 don't exist */
+	if ((quick_init < BM_QUICK_INIT_MIN) || (quick_init > BM_QUICK_INIT_MAX))
 		return rc;
 
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
-		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_dm_axi_wr_pend_fifo_st));
+	pid = (int)pool;
+	bid = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	pr_info("\t dm_axi_wr_pend_fifo_st.axi_wr_pend_fifo_fill_st = 0x%08X\n",
-						reg_dm_axi_wr_pend_fifo_st.axi_wr_pend_fifo_fill_st);
+	reg_base_address =      bm.b_pool_n_conf[bid];
+	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
+	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
 
-	reg_base_address =      bm.bm_idle_st;
-	reg_size   =   bm_reg_size.bm_idle_st;
-	reg_offset = bm_reg_offset.bm_idle_st * 0;
+	if  (bid == 0) { /* QM pools */
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
+		if (rc != OK)
+			return rc;
 
-	pr_info("\n");
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bm_idle_st);
-	if (rc != OK)
-		return rc;
+		reg_b0_pool_conf.pool_enable		= ON;
+		reg_b0_pool_conf.pool_quick_init	= quick_init;
+		rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
+		if (rc != OK)
+			return rc;
+	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) { /* QP pools */
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+		if (rc != OK)
+			return rc;
 
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+		reg_bgp_pool_conf.pool_enable		= ON;
+		reg_bgp_pool_conf.pool_quick_init	= quick_init;
+		rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+		if (rc != OK)
+			return rc;
+	} else {
+		rc = -BM_INPUT_NOT_IN_RANGE;
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_bm_idle_st));
-
-	pr_info("\t bm_idle_st.bm_idle_st = 0x%08X\n", reg_bm_idle_st.bm_idle_st);
+	}
 
 	rc = OK;
 	return rc;
 }
 
-int bm_pool_registers_dump(u32 pool)
+int bm_gp_pool_pe_size_set(u32 pool, u32 pe_size)
 {
 	u32 reg_base_address, reg_size, reg_offset;
 	int rc = -BM_INPUT_NOT_IN_RANGE;
 	u32 pid, bid, pid_local;
-	char reg_name[50];
-
-	struct bm_pool_conf_b0              reg_pool_conf_b0;
-	struct bm_pool_conf_bgp             reg_pool_conf_bgp;
-	struct bm_pool_st                   reg_pool_st;
-	struct bm_c_mng_stat_data           tab_dpr_c_mng_stat;
-	struct bm_c_mng_dyn_data            tab_tpr_c_mng_dyn;
-	struct bm_d_mng_ball_stat_data      tab_dpr_d_mng_ball_stat_data;
-	struct bm_tpr_dro_mng_ball_dyn_data tab_tpr_dro_mng_ball_dyn_data;
-	struct bm_tpr_drw_mng_ball_dyn_data tab_tpr_drw_mng_ball_dyn_data;
-	struct bm_tpr_ctrs_0_data           tab_tpr_ctrs_0_data;
+	struct bm_pool_conf_bgp reg_bgp_pool_conf;
 
 	BM_AVAILABLE_CHECK();
 
-	if ((pool            <     BM_POOL_MIN) || (pool            >    BM_POOL_MAX))
+	if ((pool    < BM_POOL_GP_MIN) || (pool    > BM_POOL_GP_MAX))
+		return rc;
+	if ((pe_size != BM_PE_SIZE_IS_32_BITS) && (pe_size != BM_PE_SIZE_IS_40_BITS))
 		return rc;
-	if ((pool            >  BM_POOL_QM_MAX) && (pool            < BM_POOL_GP_MIN))
-		return rc; /* pools 4, 5, 6, 7 don't exist */
 
-	pid       = (int)pool;
-	bid       = BM_PID_TO_BANK(pid);
+	pid = (int)pool;
+	bid = BM_PID_TO_BANK(pid);
 	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	pr_info("\n bm_pool_registers_dump:");
-
 	reg_base_address =      bm.b_pool_n_conf[bid];
 	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
 	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
 
-	if  (bid == 0) {	/* QM pools */
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_pool_conf_b0);
-		if (rc != OK)
-			return rc;
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+	if (rc != OK)
+		return rc;
 
-		pr_info("\n");
-		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-		if (rc != OK)
-			return rc;
-		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_pool_conf_b0));
+	reg_bgp_pool_conf.pe_size	= pe_size;
+	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+	return rc;
+}
 
-		pr_info("\t b%d_pool_%d_conf.pool_enable     = 0x%08X\n",
-					bid, pid_local, reg_pool_conf_b0.pool_enable);
-		pr_info("\t b%d_pool_%d_conf.pool_quick_init = 0x%08X\n",
-					bid, pid_local, reg_pool_conf_b0.pool_quick_init);
-	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) {	/* QP pools */
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_pool_conf_bgp);
-		if (rc != OK)
-			return rc;
+int bm_gp_pool_pair_set(u32 pool, u32 pool_pair)
+{
+	u32 reg_base_address, reg_size, reg_offset;
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 pid, bid, pid_local;
+	struct bm_pool_conf_bgp reg_bgp_pool_n_conf;
 
-		pr_info("\n");
-		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-		if (rc != OK)
-			return rc;
-		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_pool_conf_bgp));
+	BM_AVAILABLE_CHECK();
 
-		pr_info("\t b%d_pool_%d_conf.pool_enable     = 0x%08X\n",
-					bid, pid_local, reg_pool_conf_bgp.pool_enable);
-		pr_info("\t b%d_pool_%d_conf.pool_in_pairs   = 0x%08X\n",
-					bid, pid_local, reg_pool_conf_bgp.pool_in_pairs);
-		pr_info("\t b%d_pool_%d_conf.PE_size         = 0x%08X\n",
-					bid, pid_local, reg_pool_conf_bgp.pe_size);
-		pr_info("\t b%d_pool_%d_conf.pool_quick_init = 0x%08X\n",
-					bid, pid_local, reg_pool_conf_bgp.pool_quick_init);
-	} else {
-		rc = -BM_INPUT_NOT_IN_RANGE;
+	if ((pool      <   BM_POOL_GP_MIN) || (pool      >   BM_POOL_GP_MAX))
+		return rc;
+	if ((pool_pair < BM_POOL_PAIR_MIN) || (pool_pair > BM_POOL_PAIR_MAX))
 		return rc;
-	}
 
-	reg_base_address =      bm.b_pool_n_st[bid];
-	reg_size   =   bm_reg_size.b_pool_n_st[bid];
-	reg_offset = bm_reg_offset.b_pool_n_st[bid] * pid_local;
+	pid = (int)pool;
+	bid = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_pool_st);
-	if (rc != OK)
-		return rc;
+	reg_base_address =      bm.b_pool_n_conf[bid];
+	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
+	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_n_conf);
 	if (rc != OK)
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_pool_st));
 
-	pr_info("\t b%d_pool_%d_st.pool_nempty_st          = 0x%08X\n",
-			bid, pid_local, reg_pool_st.pool_nempty_st);
-	pr_info("\t b%d_pool_%d_st.dpool_ae_st             = 0x%08X\n",
-			bid, pid_local, reg_pool_st.dpool_ae_st);
-	pr_info("\t b%d_pool_%d_st.dpool_af_st             = 0x%08X\n",
-			bid, pid_local, reg_pool_st.dpool_af_st);
-	pr_info("\t b%d_pool_%d_st.pool_fill_bgt_si_thr_st = 0x%08X\n",
-			bid, pid_local, reg_pool_st.pool_fill_bgt_si_thr_st);
+	reg_bgp_pool_n_conf.pool_in_pairs	= pool_pair;
+	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_n_conf);
+	return rc;
+}
 
-	reg_base_address =      bm.dpr_c_mng_stat[bid];
-	reg_size   =   bm_reg_size.dpr_c_mng_stat[bid];
-	reg_offset = bm_reg_offset.dpr_c_mng_stat[bid] * pid_local;
+int bm_pool_cache_set(u32 pool, u32 cache_vmid, u32 cache_attr, u32 cache_so_thr, u32 cache_si_thr,
+						u32 cache_num_of_buffers)
+{
+	u32 reg_base_address, reg_size, reg_offset;
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 pid, bid, pid_local, pid_temp, pid_local_temp;
+	u32 granularity_of_pe_in_cache, cache_start, cache_end, cache_end_max, pool_enable;
+	struct bm_pool_conf_b0    reg_b0_pool_conf;
+	struct bm_pool_conf_bgp   reg_bgp_pool_conf;
+	struct bm_c_mng_stat_data tab_dpr_c_mng_stat;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_c_mng_stat);
-	if (rc != OK)
-		return rc;
+	BM_AVAILABLE_CHECK();
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) /* QM pools */
+		granularity_of_pe_in_cache = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_CACHE;	/* 64/4 */
+	else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) /* GM pools */
+		granularity_of_pe_in_cache = GRANULARITY_OF_64_BYTES / GP_PE_SIZE_IN_BYTES_IN_CACHE;	/* 64/8 */
+	else
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&tab_dpr_c_mng_stat));
-
-	pr_info("\t dpr_c_mng_b%d_stat.cache_start  = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_start);
-	pr_info("\t dpr_c_mng_b%d_stat.cache_end    = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_end);
-	pr_info("\t dpr_c_mng_b%d_stat.cache_si_thr = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_si_thr);
-	pr_info("\t dpr_c_mng_b%d_stat.cache_so_thr = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_so_thr);
-	pr_info("\t dpr_c_mng_b%d_stat.cache_attr   = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_attr);
-	pr_info("\t dpr_c_mng_b%d_stat.cache_vmid   = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_vmid);
-
-	reg_base_address =      bm.tpr_c_mng_b_dyn[bid];
-	reg_size   =   bm_reg_size.tpr_c_mng_b_dyn[bid];
-	reg_offset = bm_reg_offset.tpr_c_mng_b_dyn[bid] * pid_local;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_c_mng_dyn);
-	if (rc != OK)
+	if ((cache_num_of_buffers % granularity_of_pe_in_cache) != 0)
 		return rc;
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if (cache_so_thr < cache_si_thr + 16) {
+		pr_err("cache swap out threshold should be larger than cache swap in plus 16\n");
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&tab_tpr_c_mng_dyn));
+	}
 
-	pr_info("\t tpr_c_mng_b%d_dyn.cache_fill_min = 0x%08X\n", bid, tab_tpr_c_mng_dyn.cache_fill_min);
-	pr_info("\t tpr_c_mng_b%d_dyn.cache_fill_max = 0x%08X\n", bid, tab_tpr_c_mng_dyn.cache_fill_max);
-	pr_info("\t tpr_c_mng_b%d_dyn.cache_rd_ptr   = 0x%08X\n", bid, tab_tpr_c_mng_dyn.cache_rd_ptr);
-	pr_info("\t tpr_c_mng_b%d_dyn.cache_wr_ptr   = 0x%08X\n", bid, tab_tpr_c_mng_dyn.cache_wr_ptr);
+	if ((pool                 <          BM_POOL_MIN) || (pool                 >          BM_POOL_MAX))
+		return rc;
+	if ((pool                 >       BM_POOL_QM_MAX) && (pool                 <       BM_POOL_GP_MIN))
+		return rc; /* pools 4, 5, 6, 7 don't exist */
+	if ((cache_vmid           <          BM_VMID_MIN) || (cache_vmid           >          BM_VMID_MAX))
+		return rc;
+	if ((cache_attr           <    BM_CACHE_ATTR_MIN) || (cache_attr           >    BM_CACHE_ATTR_MAX))
+		return rc;
+	if ((cache_so_thr         < BM_CACHE_SO_THR_MIN) || (cache_so_thr > BM_CACHE_SO_THR_MAX(cache_num_of_buffers)))
+		return rc;
+	/* Note: Make sure to set si_thr >= max_burst, and if max_burst is unknown - set si_thr >= 16. */
+	if ((cache_si_thr         < BM_CACHE_SI_THR_MIN) || (cache_si_thr > BM_CACHE_SI_THR_MAX(cache_num_of_buffers)))
+		return rc;
+	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) { /* QM pools */
+		if ((cache_num_of_buffers < BM_CACHE_NUM_OF_BUFFERS_QM_MIN) ||
+			(cache_num_of_buffers > BM_CACHE_NUM_OF_BUFFERS_QM_MAX))
+			return rc;
+		/* Note: for B[0]: must assign bits [1:0]==2b00, because each line in cache contains 4 PEs. */
+		if (cache_so_thr % 4 != 0)
+			return rc;
+		if (cache_si_thr % 4 != 0)
+			return rc;
 
-	reg_base_address =      bm.dpr_d_mng_ball_stat;
-	reg_size   =   bm_reg_size.dpr_d_mng_ball_stat;
-	reg_offset = bm_reg_offset.dpr_d_mng_ball_stat * BM_PID_TO_GLOBAL_POOL_IDX(pid);
+	} else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) { /* GM pools */
+		if ((cache_num_of_buffers < BM_CACHE_NUM_OF_BUFFERS_GP_MIN) ||
+			(cache_num_of_buffers > BM_CACHE_NUM_OF_BUFFERS_GP_MAX))
+			return rc;
+		/* When pool is configured to in_pairs==1, ignore bit [0] of this value. */
+		if (cache_so_thr % 2 != 0)
+			return rc;
+		if (cache_si_thr % 2 != 0)
+			return rc;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_d_mng_ball_stat_data);
-	if (rc != OK)
+	} else
 		return rc;
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
-		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&tab_dpr_d_mng_ball_stat_data));
+	pid = pool;
+	bid = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	pr_info("\t dpr_d_mng_ball_stat.dram_ae_thr = 0x%08X\n",     tab_dpr_d_mng_ball_stat_data.dram_ae_thr);
-	pr_info("\t dpr_d_mng_ball_stat.dram_af_thr = 0x%08X\n",     tab_dpr_d_mng_ball_stat_data.dram_af_thr);
-	pr_info("\t dpr_d_mng_ball_stat.dram_start  = 0x%02X%08X\n",
-		tab_dpr_d_mng_ball_stat_data.dram_start_msb, tab_dpr_d_mng_ball_stat_data.dram_start_lsb);
-	pr_info("\t dpr_d_mng_ball_stat.dram_size   = 0x%08X\n",     tab_dpr_d_mng_ball_stat_data.dram_size);
+	/* B0 - 4 pools shares same cache which is 512 lines, each with 4 PE's = 2048 PE's
+	   B1..B4 each bank has 7 pools that shares 1024 lines, each with 1 PE = 1024 PE's */
+	cache_end_max = 0;
+	/* run on all pools in bank and check what is the end of the occupied part */
+	for (pid_temp = BM_POOL_MIN; pid_temp < BM_POOL_MAX; pid_temp++) {
+		if (BM_PID_TO_BANK(pid_temp) != bid)
+			continue; /* run only on pools that are in bank */
+		if ((pid_temp > BM_POOL_QM_MAX) && (pid_temp < BM_POOL_GP_MIN))
+			continue; /* pools 4, 5, 6, 7 don't exist */
 
-	reg_base_address =      bm.tpr_dro_mng_ball_dyn;
-	reg_size   =   bm_reg_size.tpr_dro_mng_ball_dyn;
-	reg_offset = bm_reg_offset.tpr_dro_mng_ball_dyn * BM_PID_TO_GLOBAL_POOL_IDX(pid);
+		pid_local_temp = BM_PID_TO_PID_LOCAL(pid_temp);
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_dro_mng_ball_dyn_data);
-	if (rc != OK)
-		return rc;
+		reg_base_address =      bm.b_pool_n_conf[bid];
+		reg_size   =   bm_reg_size.b_pool_n_conf[bid];
+		reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local_temp;
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
-		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&tab_tpr_dro_mng_ball_dyn_data));
+		if  (bid == 0) { /* QM pools */
+			rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
+			if (rc != OK)
+				return rc;
+			pool_enable = reg_b0_pool_conf.pool_enable;
+		} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) { /* GP pools */
+			rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+			if (rc != OK)
+				return rc;
+			pool_enable = reg_bgp_pool_conf.pool_enable;
+		} else {
+			rc = -BM_INPUT_NOT_IN_RANGE;
+			return rc;
+		}
 
-	pr_info("\t tpr_dro_mng_ball_dyn.dram_rd_ptr = 0x%08X\n", tab_tpr_dro_mng_ball_dyn_data.dram_rd_ptr);
-	pr_info("\t tpr_dro_mng_ball_dyn.dram_wr_ptr = 0x%08X\n", tab_tpr_dro_mng_ball_dyn_data.dram_wr_ptr);
+		/* if pool is not enabled that we don't take its cache configuration into account */
+		if (pool_enable == OFF)
+			continue;	/* pool pid_local_temp is not enabled */
 
-	reg_base_address =      bm.tpr_drw_mng_ball_dyn;
-	reg_size   =   bm_reg_size.tpr_drw_mng_ball_dyn;
-	reg_offset = bm_reg_offset.tpr_drw_mng_ball_dyn * BM_PID_TO_GLOBAL_POOL_IDX(pid);
+		reg_base_address =      bm.dpr_c_mng_stat[bid];
+		reg_size   =   bm_reg_size.dpr_c_mng_stat[bid];
+		reg_offset = bm_reg_offset.dpr_c_mng_stat[bid] * pid_local_temp;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_drw_mng_ball_dyn_data);
-	if (rc != OK)
-		return rc;
+		rc = bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_c_mng_stat);
+		if (rc != OK)
+			return rc;
+		/* cache end is calculated in cache lines with granularity of 64B
+		   for B0 it is 16 PE's
+		   for B1..B4 it is 8 PE's */
+		cache_end_max = MV_MAX(cache_end_max, tab_dpr_c_mng_stat.cache_end);
+	}
+	pr_info("pool %d cache end max is %d\n", pool, cache_end_max);
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	reg_base_address =      bm.dpr_c_mng_stat[bid];
+	reg_size   =   bm_reg_size.dpr_c_mng_stat[bid];
+	reg_offset = bm_reg_offset.dpr_c_mng_stat[bid] * pid_local;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_c_mng_stat);
 	if (rc != OK)
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&tab_tpr_drw_mng_ball_dyn_data));
+	if (cache_end_max != 0)
+		cache_start  = cache_end_max + 1;
+	else
+		cache_start  = 0;
+	cache_end    = cache_start + (cache_num_of_buffers / granularity_of_pe_in_cache) - 1;
 
-	pr_info("\t tpr_drw_mng_ball_dyn.dram_fill = 0x%08X\n", tab_tpr_drw_mng_ball_dyn_data.dram_fill);
+	if (cache_start < BM_CACHE_START_MIN)
+		return -BM_INPUT_NOT_IN_RANGE;
+	if (cache_end   <   BM_CACHE_END_MIN)
+		return -BM_INPUT_NOT_IN_RANGE;
 
-	reg_base_address =      bm.tpr_ctrs_0_b[bid];
-	reg_size   =   bm_reg_size.tpr_ctrs_0_b[bid];
-	reg_offset = bm_reg_offset.tpr_ctrs_0_b[bid] * pid_local;
+	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) { /* QM pools */
+		if (cache_start  > BM_CACHE_QM_START_MAX)
+			return rc;
+		if (cache_end    > BM_CACHE_QM_END_MAX)
+			return -BM_INPUT_NOT_IN_RANGE;
+	} else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) { /* GM pools */
+		if (cache_start  > BM_CACHE_GP_START_MAX)
+			return rc;
+		if (cache_end    > BM_CACHE_GP_END_MAX)
+			return -BM_INPUT_NOT_IN_RANGE;
+	}
+/* Swap-out threshold. Unit is 1 PE.
+   Swap-in threshold. Unit is 1 PE.
+   start and end are in line units (GP - 1PE, QM - 4 PE's) and in 64B granularity */
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_ctrs_0_data);
-	if (rc != OK)
-		return rc;
+	pr_info("cache_start is %d ache_end is %d si %d so %d\n", cache_start, cache_end, cache_si_thr, cache_so_thr);
+	tab_dpr_c_mng_stat.cache_start  = cache_start;
+	tab_dpr_c_mng_stat.cache_end    = cache_end;
+	tab_dpr_c_mng_stat.cache_si_thr = cache_si_thr;
+	tab_dpr_c_mng_stat.cache_so_thr = cache_so_thr;
+	tab_dpr_c_mng_stat.cache_attr   = cache_attr;
+	tab_dpr_c_mng_stat.cache_vmid   = cache_vmid;
+	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_c_mng_stat);
+	return rc;
+}
 
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
-		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&tab_tpr_ctrs_0_data));
-
-	pr_info("\t tpr_ctrs_0_b%d.delayed_releases_ctr = 0x%08X\n",
-		bid, tab_tpr_ctrs_0_data.delayed_releases_ctr);
-	pr_info("\t tpr_ctrs_0_b%d.failed_allocs_ctr    = 0x%08X\n",
-		bid, tab_tpr_ctrs_0_data.failed_allocs_ctr);
-	pr_info("\t tpr_ctrs_0_b%d.released_pes_ctr     = 0x%08X\n",
-		bid, tab_tpr_ctrs_0_data.released_pes_ctr);
-	pr_info("\t tpr_ctrs_0_b%d.allocated_pes_ctr    = 0x%08X\n",
-		bid, tab_tpr_ctrs_0_data.allocated_pes_ctr);
-
-	rc = OK;
-	return rc;
-}
-
-int bm_bank_registers_dump(u32 bank)
+int bm_pool_disable(u32 pool)
 {
 	u32 reg_base_address, reg_size, reg_offset;
 	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 bid;
-	char reg_name[50];
-	struct bm_b_sys_rec_bank_d0_st       reg_b_sys_rec_bank_d0_st;
-	struct bm_b_sys_rec_bank_d1_st       reg_b_sys_rec_bank_d1_st;
-	struct bm_b_bank_req_fifos_st        reg_b_bank_req_fifos_st;
-	struct bm_b0_past_alc_fifos_st       reg_b0_past_alc_fifos_st;
-	struct bm_bgp_past_alc_fifos_st      reg_bgp_past_alc_fifos_st;
-	struct bm_b0_rls_wrp_ppe_fifos_st    reg_b0_rls_wrp_ppe_fifos_st;
+	u32 pid, bid, pid_local;
+	struct bm_pool_conf_b0  reg_b0_pool_conf;
+	struct bm_pool_conf_bgp reg_bgp_pool_conf;
 
 	BM_AVAILABLE_CHECK();
 
-	if ((bank            <     BM_BANK_MIN) || (bank            >     BM_BANK_MAX))
-		return rc;
-
-	bid       = bank;
-
-	pr_info("\n bm_bank_registers_dump:");
-
-	reg_base_address =      bm.b_sys_rec_bank_d0_st[bid];
-	reg_size   =   bm_reg_size.b_sys_rec_bank_d0_st[bid];
-	reg_offset = bm_reg_offset.b_sys_rec_bank_d0_st[bid] * bid;
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_sys_rec_bank_d0_st);
-	if (rc != OK)
-		return rc;
-
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
-		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_b_sys_rec_bank_d0_st));
-
-	pr_info("\t b%d_sys_rec_bank_d0_st.b_last_vmid_mis_alc_vmid_st = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d0_st.b_last_vmid_mis_alc_vmid_st);
-	pr_info("\t b%d_sys_rec_bank_d0_st.b_last_vmid_mis_rls_vmid_st = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d0_st.b_last_vmid_mis_rls_vmid_st);
-	pr_info("\t b%d_sys_rec_bank_d0_st.b_last_vmid_mis_alc_pid_st  = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d0_st.b_last_vmid_mis_alc_pid_st);
-	pr_info("\t b%d_sys_rec_bank_d0_st.b_last_vmid_mis_rls_pid_st  = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d0_st.b_last_vmid_mis_rls_pid_st);
-
-	reg_base_address =      bm.b_sys_rec_bank_d1_st[bid];
-	reg_size   =   bm_reg_size.b_sys_rec_bank_d1_st[bid];
-	reg_offset = bm_reg_offset.b_sys_rec_bank_d1_st[bid] * bid;
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_sys_rec_bank_d1_st);
-	if (rc != OK)
-		return rc;
-
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
-		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_b_sys_rec_bank_d1_st));
-
-	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_vmid_mis_alc_src_st = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d1_st.b_last_vmid_mis_alc_src_st);
-	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_vmid_mis_rls_src_st = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d1_st.b_last_vmid_mis_rls_src_st);
-	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_alc_dis_pool_src_st = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d1_st.b_last_alc_dis_pool_src_st);
-	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_rls_dis_pool_src_st = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d1_st.b_last_rls_dis_pool_src_st);
-	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_alc_dis_pool_pid_st = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d1_st.b_last_alc_dis_pool_pid_st);
-	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_rls_dis_pool_pid_st = 0x%08X\n",
-				bid, reg_b_sys_rec_bank_d1_st.b_last_rls_dis_pool_pid_st);
-
-	reg_base_address =      bm.b_bank_req_fifos_st;
-	reg_size   =   bm_reg_size.b_bank_req_fifos_st;
-	reg_offset = bm_reg_offset.b_bank_req_fifos_st * bid;
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_bank_req_fifos_st);
-	if (rc != OK)
-		return rc;
-
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
+	if ((pool  <    BM_POOL_MIN) || (pool  >     BM_POOL_MAX))
 		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_b_bank_req_fifos_st));
+	if ((pool  > BM_POOL_QM_MAX) && (pool  < BM_POOL_GP_MIN))
+		return rc; /* pools 4, 5, 6, 7 don't exist */
 
-	pr_info("\t b%d_bank_req_fifos_st.b_alc_fifo_fill_st = 0x%08X\n",
-				bid, reg_b_bank_req_fifos_st.b_alc_fifo_fill_st);
-	pr_info("\t b%d_bank_req_fifos_st.b_rls_fifo_fill_st = 0x%08X\n",
-				bid, reg_b_bank_req_fifos_st.b_rls_fifo_fill_st);
-	pr_info("\t b%d_bank_req_fifos_st.b_so_fifo_fill_st: = 0x%08X\n",
-				bid, reg_b_bank_req_fifos_st.b_so_fifo_fill_st);
-	pr_info("\t b%d_bank_req_fifos_st.b_si_fifo_fill_st: = 0x%08X\n",
-				bid, reg_b_bank_req_fifos_st.b_si_fifo_fill_st);
+	pid = (int)pool;
+	bid = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	if  (bid == 0) {	/* QM pools */
-		reg_base_address =      bm.b0_past_alc_fifos_st;
-		reg_size   =   bm_reg_size.b0_past_alc_fifos_st;
-		reg_offset = bm_reg_offset.b0_past_alc_fifos_st * bid;
+	reg_base_address =      bm.b_pool_n_conf[bid];
+	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
+	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
 
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_past_alc_fifos_st);
+	if  (bid == 0) { /* QM pools */
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
 		if (rc != OK)
 			return rc;
-
-		pr_info("\n");
-		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+		reg_b0_pool_conf.pool_enable = OFF;
+		rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
 		if (rc != OK)
 			return rc;
-		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_b0_past_alc_fifos_st));
-
-		pr_info("\t b0_past_alc_fifos_st.b0_past_alc_fifo_fill_st     = 0x%08X\n",
-				reg_b0_past_alc_fifos_st.b0_past_alc_fifo_fill_st);
-		pr_info("\t b0_past_alc_fifos_st.b0_past_alc_ppe_fifo_fill_st = 0x%08X\n",
-				reg_b0_past_alc_fifos_st.b0_past_alc_ppe_fifo_fill_st);
-	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) {	/* QP pools */
-		reg_base_address =      bm.bgp_past_alc_fifos_st;
-		reg_size   =   bm_reg_size.bgp_past_alc_fifos_st;
-		reg_offset = bm_reg_offset.bgp_past_alc_fifos_st * bid;
-
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_past_alc_fifos_st);
+	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) { /* QP pools */
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
 		if (rc != OK)
 			return rc;
 
-		pr_info("\n");
-		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+		reg_bgp_pool_conf.pool_enable = OFF;
+		rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
 		if (rc != OK)
 			return rc;
-		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_bgp_past_alc_fifos_st));
-
-		pr_info("\t bgp_past_alc_fifos_st.b1_past_alc_fifo_fill_st = 0x%08X\n",
-				reg_bgp_past_alc_fifos_st.b1_past_alc_fifo_fill_st);
-		pr_info("\t bgp_past_alc_fifos_st.b2_past_alc_fifo_fill_st = 0x%08X\n",
-				reg_bgp_past_alc_fifos_st.b2_past_alc_fifo_fill_st);
-		pr_info("\t bgp_past_alc_fifos_st.b3_past_alc_fifo_fill_st = 0x%08X\n",
-				reg_bgp_past_alc_fifos_st.b3_past_alc_fifo_fill_st);
-		pr_info("\t bgp_past_alc_fifos_st.b4_past_alc_fifo_fill_st = 0x%08X\n",
-				reg_bgp_past_alc_fifos_st.b4_past_alc_fifo_fill_st);
 	} else {
 		rc = -BM_INPUT_NOT_IN_RANGE;
 		return rc;
 	}
 
-	reg_base_address =      bm.b0_rls_wrp_ppe_fifos_st;
-	reg_size   =   bm_reg_size.b0_rls_wrp_ppe_fifos_st;
-	reg_offset = bm_reg_offset.b0_rls_wrp_ppe_fifos_st * bid;
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_rls_wrp_ppe_fifos_st);
-	if (rc != OK)
-		return rc;
-
-	pr_info("\n");
-	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-	if (rc != OK)
-		return rc;
-	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_b0_rls_wrp_ppe_fifos_st));
-
-	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_0_fill_st = 0x%08X\n",
-			reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_0_fill_st);
-	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_1_fill_st = 0x%08X\n",
-			reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_1_fill_st);
-	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_2_fill_st = 0x%08X\n",
-			reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_2_fill_st);
-	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_3_fill_st = 0x%08X\n",
-			reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_3_fill_st);
-
 	rc = OK;
 	return rc;
 }
-
-int bm_cache_memory_dump(u32 bank)
+/* Get if pool is enabled */
+int bm_pool_enabled_get(u32 pool, u32 *enabled, u32 *quick_init)
 {
 	u32 reg_base_address, reg_size, reg_offset;
 	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 bid, line;
-	char reg_name[50];
-
-	struct bm_cache_b0_mem_data     reg_cache_b0_data;
-	struct bm_cache_bgp_data        reg_cache_bgp_data;
+	u32 pid, bid, pid_local;
+	struct bm_pool_conf_b0  reg_b0_pool_conf;
+	struct bm_pool_conf_bgp reg_bgp_pool_conf;
 
 	BM_AVAILABLE_CHECK();
 
-	if ((bank            <     BM_BANK_MIN) || (bank            >     BM_BANK_MAX))
+	if ((pool       <       BM_POOL_MIN) || (pool       >       BM_POOL_MAX))
 		return rc;
+	if ((pool       >    BM_POOL_QM_MAX) && (pool       <    BM_POOL_GP_MIN))
+		return rc; /* pools 4, 5, 6, 7 don't exist */
 
-	bid       = bank;
+	pid = (int)pool;
+	bid = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	pr_info("\n bm_cache_memory_dump:");
+	reg_base_address =      bm.b_pool_n_conf[bid];
+	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
+	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
 
-	if  (bid == 0) {	/* QM pools */
-		for (line = 0; line < BM_NUM_OF_LINE_QM; line++) {
-			reg_base_address =      bm.sram_b_cache[bid];
-			reg_size   =   bm_reg_size.sram_b_cache[bid];
-			reg_offset = bm_reg_offset.sram_b_cache[bid] * line;
+	if  (bid == 0) { /* QM pools */
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
+		if (rc != OK)
+			return rc;
+		*enabled = reg_b0_pool_conf.pool_enable;
+		*quick_init = reg_b0_pool_conf.pool_quick_init;
+	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) { /* QP pools */
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+		if (rc != OK)
+			return rc;
 
-			rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_cache_b0_data);
-			if (rc != OK)
-				return rc;
+		*enabled = reg_bgp_pool_conf.pool_enable;
+		*quick_init = reg_bgp_pool_conf.pool_quick_init;
+	} else {
+		rc = -BM_INPUT_NOT_IN_RANGE;
+		return rc;
+	}
 
-			pr_info("\n");
-			rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-			if (rc != OK)
-				return rc;
-			pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-				reg_base_address + reg_offset, *((u32 *)&reg_cache_b0_data));
+	rc = OK;
+	return rc;
+}
+/* Get pe_size */
+int bm_pool_pe_size_get(u32 pool, u32 *pe_size)
+{
+	u32 reg_base_address, reg_size, reg_offset;
+	int rc = OK;
+	u32 pid, bid, pid_local;
+	struct bm_pool_conf_bgp reg_bgp_pool_conf;
 
-			pr_info("\t line %04d: sram_b%d_cache.cache_b0_data_0 = 0x%08X\n",
-						line, bid, reg_cache_b0_data.cache_b0_data_0);
-			pr_info("\t line %04d: sram_b%d_cache.cache_b0_data_1 = 0x%08X\n",
-						line, bid, reg_cache_b0_data.cache_b0_data_1);
-			pr_info("\t line %04d: sram_b%d_cache.cache_b0_data_2 = 0x%08X\n",
-						line, bid, reg_cache_b0_data.cache_b0_data_2);
-			pr_info("\t line %04d: sram_b%d_cache.cache_b0_data_3 = 0x%08X\n",
-						line, bid, reg_cache_b0_data.cache_b0_data_3);
-		}
-	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) {	/* QP pools */
-		pr_info("\n");
+	BM_AVAILABLE_CHECK();
 
-		for (line = 0; line < BM_NUM_OF_LINE_GP; line++) {
-			reg_base_address =      bm.sram_b_cache[bid];
-			reg_size   =   bm_reg_size.sram_b_cache[bid];
-			reg_offset = bm_reg_offset.sram_b_cache[bid] * line;
+	if ((pool            <     BM_POOL_MIN) || (pool            >    BM_POOL_MAX))
+		return -BM_INPUT_NOT_IN_RANGE;
+	if ((pool            >  BM_POOL_QM_MAX) && (pool            < BM_POOL_GP_MIN))
+		return -BM_INPUT_NOT_IN_RANGE; /* pools 4, 5, 6, 7 don't exist */
 
-			rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_cache_bgp_data);
-			if (rc != OK)
-				return rc;
+	pid = (int)pool;
+	bid = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-			pr_info("\n");
-			rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-			if (rc != OK)
-				return rc;
-			pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_cache_bgp_data));
+	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) { /* QM pools */
+		*pe_size = BM_PE_SIZE_IS_32_BITS;
+	} else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) { /* GM pools */
+		reg_base_address =      bm.b_pool_n_conf[bid];
+		reg_size   =   bm_reg_size.b_pool_n_conf[bid];
+		reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
 
-			pr_info("\t line %04d: sram_b%d_cache.cache_bgp_data = 0x%02X_%08X\n",
-				line, bid, reg_cache_bgp_data.cache_bgp_data_msb,
-							reg_cache_bgp_data.cache_bgp_data_lsb);
-		}
-	} else {
-		rc = -BM_INPUT_NOT_IN_RANGE;
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+		if (rc != OK)
+			return rc;
+
+		*pe_size = reg_bgp_pool_conf.pe_size;
+	} else
 		return rc;
-	}
 
-	rc = OK;
 	return rc;
 }
 
-int bm_idle_status_get(u32 *status)
+/* Get pool pointers - internal registers */
+int bm_pool_pointer_get(u32 pool, u32 *rd_ptr, u32 *wr_ptr)
 {
 	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	struct bm_bm_idle_st reg_bm_idle_st;
+	int rc = OK;
+	u32 pid, bid, pid_local;
+	u32 pe_size;
+	struct bm_tpr_dro_mng_ball_dyn_data tab_tpr_dro_mng_ball_dyn_data;
 
 	BM_AVAILABLE_CHECK();
 
-	if (((u32)status < BM_DATA_PTR_MIN) || ((u32)status > BM_DATA_PTR_MAX))
-		return rc;
+	if ((pool            <     BM_POOL_MIN) || (pool            >    BM_POOL_MAX))
+		return -BM_INPUT_NOT_IN_RANGE;
+	if ((pool            >  BM_POOL_QM_MAX) && (pool            < BM_POOL_GP_MIN))
+		return -BM_INPUT_NOT_IN_RANGE; /* pools 4, 5, 6, 7 don't exist */
 
-	reg_base_address =      bm.bm_idle_st;
-	reg_size   =   bm_reg_size.bm_idle_st;
-	reg_offset = bm_reg_offset.bm_idle_st * 0;
+	pid = (int)pool;
+	bid = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size,  (u32 *)&reg_bm_idle_st);
+	reg_base_address =      bm.tpr_dro_mng_ball_dyn;
+	reg_size   =   bm_reg_size.tpr_dro_mng_ball_dyn;
+	reg_offset = bm_reg_offset.tpr_dro_mng_ball_dyn * BM_PID_TO_GLOBAL_POOL_IDX(pid);
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_dro_mng_ball_dyn_data);
 	if (rc != OK)
 		return rc;
-	*status = reg_bm_idle_st.bm_idle_st;
 
-	rc = OK;
+	/*
+	 * r/w pointer of BM to pool is given in 64 bits unit. starting from 0
+	 * QM PE's are in 32bits so we multiply by 2 to get number of PE's
+	 * GP PE's can either be in 32bits or in 40 bits
+	*/
+	rc = bm_pool_pe_size_get(pool, &pe_size);
+	if (rc != OK)
+		return rc;
+	if (pe_size == BM_PE_SIZE_IS_32_BITS) {
+		*rd_ptr = tab_tpr_dro_mng_ball_dyn_data.dram_rd_ptr * 2;
+		*wr_ptr = tab_tpr_dro_mng_ball_dyn_data.dram_wr_ptr * 2;
+	} else if (pe_size == BM_PE_SIZE_IS_40_BITS) {
+		*rd_ptr = tab_tpr_dro_mng_ball_dyn_data.dram_rd_ptr;
+		*wr_ptr = tab_tpr_dro_mng_ball_dyn_data.dram_wr_ptr;
+	} else
+		return rc;
+
 	return rc;
 }
-
-int bm_pool_status_get(u32 pool, u32 *pool_nempty, u32 *dpool_ae, u32 *dpool_af)
+/* Get interupt cause for pool capacity*/
+int bm_bank_intr_pool_fill_get(u32 bank, u32 *ne, u32 *ae, u32 *af)
 {
 	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local;
-	struct bm_pool_st   reg_pool_st;
+	int rc = OK;
+	u32 bid;
 
 	BM_AVAILABLE_CHECK();
 
-	if ((pool             <     BM_POOL_MIN) || (pool             >     BM_POOL_MAX))
-		return rc;
-	if ((pool             >  BM_POOL_QM_MAX) && (pool             <  BM_POOL_GP_MIN))
-		return rc; /* pools 4, 5, 6, 7 don't exist */
-	if (((u32)pool_nempty < BM_DATA_PTR_MIN) || ((u32)pool_nempty > BM_DATA_PTR_MAX))
+	bid = bank;
+	reg_base_address =      bm.pool_nempty_intr_cause[bid];
+	reg_size   =   bm_reg_size.pool_nempty_intr_cause[bid];
+	reg_offset = bm_reg_offset.pool_nempty_intr_cause[bid] * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, ne);
+	if (rc != OK)
 		return rc;
-	if (((u32)dpool_ae    < BM_DATA_PTR_MIN) || ((u32)dpool_ae    > BM_DATA_PTR_MAX))
+
+	reg_base_address =      bm.dpool_ae_intr_cause[bid];
+	reg_size   =   bm_reg_size.dpool_ae_intr_cause[bid];
+	reg_offset = bm_reg_offset.dpool_ae_intr_cause[bid] * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, ae);
+	if (rc != OK)
 		return rc;
-	if (((u32)dpool_af    < BM_DATA_PTR_MIN) || ((u32)dpool_af    > BM_DATA_PTR_MAX))
+
+	reg_base_address =      bm.dpool_af_intr_cause[bid];
+	reg_size   =   bm_reg_size.dpool_af_intr_cause[bid];
+	reg_offset = bm_reg_offset.dpool_af_intr_cause[bid];
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, af);
+	if (rc != OK)
 		return rc;
 
-	pid = (int)pool;
-	bid = BM_PID_TO_BANK(pid);
+	return rc;
+}
+/* Get cache fill */
+int bm_pool_cache_fill_get(u32 pool, u32 *rd_ptr, u32 *wr_ptr, u32 *fill_min, u32 *fill_max)
+{
+	u32 reg_base_address, reg_size, reg_offset;
+	int rc = OK;
+	u32 bid, pid, pid_local;
+	struct bm_c_mng_dyn_data            tab_tpr_c_mng_dyn;
+
+	BM_AVAILABLE_CHECK();
+
+	if ((pool            <     BM_POOL_MIN) || (pool            >    BM_POOL_MAX))
+		return -BM_INPUT_NOT_IN_RANGE;
+	if ((pool            >  BM_POOL_QM_MAX) && (pool            < BM_POOL_GP_MIN))
+		return -BM_INPUT_NOT_IN_RANGE; /* pools 4, 5, 6, 7 don't exist */
+
+	pid       = (int)pool;
+	bid       = BM_PID_TO_BANK(pid);
 	pid_local = BM_PID_TO_PID_LOCAL(pid);
 
-	reg_base_address =      bm.b_pool_n_st[bid];
-	reg_size   =   bm_reg_size.b_pool_n_st[bid];
-	reg_offset = bm_reg_offset.b_pool_n_st[bid] * pid_local;
+	reg_base_address =      bm.tpr_c_mng_b_dyn[bid];
+	reg_size   =   bm_reg_size.tpr_c_mng_b_dyn[bid];
+	reg_offset = bm_reg_offset.tpr_c_mng_b_dyn[bid] * pid_local;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_pool_st);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_c_mng_dyn);
 	if (rc != OK)
 		return rc;
+	/*
+	 * QM pools in each cache line there are 4 PE's (4 Bytes)
+	 * GP pools in each cache line there is 1 PE's (8 Bytes)
+	 */
+	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) { /* QM pools */
+		*fill_min = tab_tpr_c_mng_dyn.cache_fill_min * 4;
+		*fill_max = tab_tpr_c_mng_dyn.cache_fill_max * 4;
+		*rd_ptr = tab_tpr_c_mng_dyn.cache_rd_ptr * 4;
+		*wr_ptr = tab_tpr_c_mng_dyn.cache_wr_ptr * 4;
+	} else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) { /* GM pools */
+		*fill_min = tab_tpr_c_mng_dyn.cache_fill_min;
+		*fill_max = tab_tpr_c_mng_dyn.cache_fill_max;
+		*rd_ptr = tab_tpr_c_mng_dyn.cache_rd_ptr;
+		*wr_ptr = tab_tpr_c_mng_dyn.cache_wr_ptr;
+	} else
+		return rc;
 
-	*pool_nempty = reg_pool_st.pool_nempty_st;
-	*dpool_ae    = reg_pool_st.dpool_ae_st;
-	*dpool_af    = reg_pool_st.dpool_af_st;
-
-	rc = OK;
 	return rc;
 }
 
-int bm_idle_debug(void)
+
+/*BM Debug functions*/
+int bm_global_registers_dump(void)
 {
 	u32 reg_base_address, reg_size, reg_offset;
 	int rc = !OK;
-	u32 bid;
-	struct bm_b_bank_req_fifos_st          reg_b_bank_req_fifos_st;
-	struct bm_b0_past_alc_fifos_st         reg_b0_past_alc_fifos_st;
-	struct bm_bgp_past_alc_fifos_st        reg_bgp_past_alc_fifos_st;
-	struct bm_b0_rls_wrp_ppe_fifos_st      reg_b0_rls_wrp_ppe_fifos_st;
-	struct bm_dm_axi_fifos_st              reg_dm_axi_fifos_st;
-	struct bm_drm_pend_fifo_st             reg_drm_pend_fifo_st;
-	struct bm_dm_axi_wr_pend_fifo_st       reg_dm_axi_wr_pend_fifo_st;
 	char reg_name[50];
+	struct bm_sys_nrec_common_d0_st  reg_sys_nrec_common_d0_st;
+	struct bm_sys_nrec_common_d1_st  reg_sys_nrec_common_d1_st;
+	struct bm_sys_nrec_common_d2_st  reg_sys_nrec_common_d2_st;
+	struct bm_sys_nrec_common_d3_st  reg_sys_nrec_common_d3_st;
+	struct bm_common_general_conf    reg_common_general_conf;
+	struct bm_dram_domain_conf       reg_dram_domain_conf;
+	struct bm_dram_cache_conf        reg_dram_cache_conf;
+	struct bm_dram_qos_conf          reg_dram_qos_conf;
+	struct bm_dm_axi_fifos_st        reg_dm_axi_fifos_st;
+	struct bm_drm_pend_fifo_st       reg_drm_pend_fifo_st;
+	struct bm_dm_axi_wr_pend_fifo_st reg_dm_axi_wr_pend_fifo_st;
+	struct bm_bm_idle_st             reg_bm_idle_st;
 
 	BM_AVAILABLE_CHECK();
 
-	for (bid = 0; bid < BM_NUMBER_OF_BANKS; bid++) {
-		reg_base_address =      bm.b_bank_req_fifos_st;
-		reg_size   =   bm_reg_size.b_bank_req_fifos_st;
-		reg_offset = bm_reg_offset.b_bank_req_fifos_st * bid;
-
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_bank_req_fifos_st);
-		if (rc != OK)
-			return rc;
-
-		pr_info("\n for bank = %d:\n", bid);
-		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-		if (rc != OK)
-			return rc;
-		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_b_bank_req_fifos_st));
-
-		pr_info("\t b%d_bank_req_fifos_st.b_alc_fifo_fill_st = 0x%08X\n",
-					bid, reg_b_bank_req_fifos_st.b_alc_fifo_fill_st);
-		pr_info("\t b%d_bank_req_fifos_st.b_rls_fifo_fill_st = 0x%08X\n",
-					bid, reg_b_bank_req_fifos_st.b_rls_fifo_fill_st);
-		pr_info("\t b%d_bank_req_fifos_st.b_so_fifo_fill_st  = 0x%08X\n",
-					bid, reg_b_bank_req_fifos_st.b_so_fifo_fill_st);
-		pr_info("\t b%d_bank_req_fifos_st.b_si_fifo_fill_st  = 0x%08X\n",
-					bid, reg_b_bank_req_fifos_st.b_si_fifo_fill_st);
-	}
+	reg_base_address =      bm.sys_nrec_common_d0_st;
+	reg_size   =   bm_reg_size.sys_nrec_common_d0_st;
+	reg_offset = bm_reg_offset.sys_nrec_common_d0_st * 0;
 
-	reg_base_address =      bm.b0_past_alc_fifos_st;
-	reg_size   =   bm_reg_size.b0_past_alc_fifos_st;
-	reg_offset = bm_reg_offset.b0_past_alc_fifos_st * 0;
+	pr_info("\n-------------- BM Global registers dump -----------");
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_past_alc_fifos_st);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_d0_st);
 	if (rc != OK)
 		return rc;
 
-	pr_info("\n for bank 0:\n");
+	pr_info("\n");
 	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
 	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_b0_past_alc_fifos_st));
+		reg_base_address + reg_offset,
+		*((u32 *)&reg_sys_nrec_common_d0_st));
 
-	pr_info("\t b0_past_alc_fifos_st.b0_past_alc_fifo_fill_st     = 0x%08X\n",
-				reg_b0_past_alc_fifos_st.b0_past_alc_fifo_fill_st);
-	pr_info("\t b0_past_alc_fifos_st.b0_past_alc_ppe_fifo_fill_st = 0x%08X\n",
-				reg_b0_past_alc_fifos_st.b0_past_alc_ppe_fifo_fill_st);
+	pr_info("\t sys_nrec_common_d0_st.qm_last_alc_viol_pid_st  = 0x%08X\n",
+				reg_sys_nrec_common_d0_st.qm_last_alc_viol_pid_st);
+	pr_info("\t sys_nrec_common_d0_st.qm_last_rls_viol_pid_st  = 0x%08X\n",
+				reg_sys_nrec_common_d0_st.qm_last_rls_viol_pid_st);
+	pr_info("\t sys_nrec_common_d0_st.ppe_last_alc_viol_pid_st = 0x%08X\n",
+				reg_sys_nrec_common_d0_st.ppe_last_alc_viol_pid_st);
+	pr_info("\t sys_nrec_common_d0_st.ppe_last_rls_viol_pid_st = 0x%08X\n",
+				reg_sys_nrec_common_d0_st.ppe_last_rls_viol_pid_st);
 
-	reg_base_address =      bm.bgp_past_alc_fifos_st;
-	reg_size   =   bm_reg_size.bgp_past_alc_fifos_st;
-	reg_offset = bm_reg_offset.bgp_past_alc_fifos_st * 0;
+	reg_base_address =      bm.sys_nrec_common_d1_st;
+	reg_size   =   bm_reg_size.sys_nrec_common_d1_st;
+	reg_offset = bm_reg_offset.sys_nrec_common_d1_st * 0;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_past_alc_fifos_st);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_d1_st);
 	if (rc != OK)
 		return rc;
+	pr_info("\n");
 
-	pr_info("\n for banks 1,2,3,4:\n");
 	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
 	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_bgp_past_alc_fifos_st));
+		reg_base_address + reg_offset,
+		*((u32 *)&reg_sys_nrec_common_d1_st));
 
-	pr_info("\t bgp_past_alc_fifos_st.b1_past_alc_fifo_fill_st = 0x%08X\n",
-				reg_bgp_past_alc_fifos_st.b1_past_alc_fifo_fill_st);
-	pr_info("\t bgp_past_alc_fifos_st.b2_past_alc_fifo_fill_st = 0x%08X\n",
-				reg_bgp_past_alc_fifos_st.b2_past_alc_fifo_fill_st);
-	pr_info("\t bgp_past_alc_fifos_st.b3_past_alc_fifo_fill_st = 0x%08X\n",
-				reg_bgp_past_alc_fifos_st.b3_past_alc_fifo_fill_st);
-	pr_info("\t bgp_past_alc_fifos_st.b4_past_alc_fifo_fill_st = 0x%08X\n",
-				reg_bgp_past_alc_fifos_st.b4_past_alc_fifo_fill_st);
+	pr_info("\t sys_nrec_common_d1_st.mac_last_alc_viol_pid_st = 0x%08X\n",
+				reg_sys_nrec_common_d1_st.mac_last_alc_viol_pid_st);
+	pr_info("\t sys_nrec_common_d1_st.mac_last_rls_viol_pid_st = 0x%08X\n",
+				reg_sys_nrec_common_d1_st.mac_last_rls_viol_pid_st);
+	pr_info("\t sys_nrec_common_d1_st.drm_last_dram_err_pid_st = 0x%08X\n",
+				reg_sys_nrec_common_d1_st.drm_last_dram_err_pid_st);
+	pr_info("\t sys_nrec_common_d1_st.dwm_last_fail_so_pid_st  = 0x%08X\n",
+				reg_sys_nrec_common_d1_st.dwm_last_fail_so_pid_st);
 
-	reg_base_address =      bm.b0_rls_wrp_ppe_fifos_st;
-	reg_size   =   bm_reg_size.b0_rls_wrp_ppe_fifos_st;
-	reg_offset = bm_reg_offset.b0_rls_wrp_ppe_fifos_st * 0;
+	reg_base_address =      bm.sys_nrec_common_d2_st;
+	reg_size   =   bm_reg_size.sys_nrec_common_d2_st;
+	reg_offset = bm_reg_offset.sys_nrec_common_d2_st * 0;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_rls_wrp_ppe_fifos_st);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_d2_st);
 	if (rc != OK)
 		return rc;
+	pr_info("\n");
 
-	pr_info("\n for bank 0:\n");
 	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
 	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_b0_rls_wrp_ppe_fifos_st));
+		reg_base_address + reg_offset,
+		*((u32 *)&reg_sys_nrec_common_d2_st));
 
-	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_0_fill_st = 0x%08X\n",
-					reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_0_fill_st);
-	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_1_fill_st = 0x%08X\n",
-					reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_1_fill_st);
-	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_2_fill_st = 0x%08X\n",
-					reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_2_fill_st);
-	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_3_fill_st = 0x%08X\n",
-					reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_3_fill_st);
+	pr_info("\t sys_nrec_common_d2_st.qm_last_alc_viol_blen_st  = 0x%08X\n",
+				reg_sys_nrec_common_d2_st.qm_last_alc_viol_blen_st);
+	pr_info("\t sys_nrec_common_d2_st.qm_last_rls_viol_blen_st  = 0x%08X\n",
+				reg_sys_nrec_common_d2_st.qm_last_rls_viol_blen_st);
+	pr_info("\t sys_nrec_common_d2_st.ppe_last_alc_viol_blen_st = 0x%08X\n",
+				reg_sys_nrec_common_d2_st.ppe_last_alc_viol_blen_st);
+	pr_info("\t sys_nrec_common_d2_st.ppe_last_rls_viol_blen_st = 0x%08X\n",
+				reg_sys_nrec_common_d2_st.ppe_last_rls_viol_blen_st);
+
+	reg_base_address =      bm.sys_nrec_common_d3_st;
+	reg_size   =   bm_reg_size.sys_nrec_common_d3_st;
+	reg_offset = bm_reg_offset.sys_nrec_common_d3_st * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_d3_st);
+	if (rc != OK)
+		return rc;
+
+	pr_info("\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset,
+		*((u32 *)&reg_sys_nrec_common_d3_st));
+
+	pr_info("\t sys_nrec_common_d3_st.mac_last_alc_viol_blen_st = 0x%08X\n",
+				reg_sys_nrec_common_d3_st.mac_last_alc_viol_blen_st);
+	pr_info("\t sys_nrec_common_d3_st.mac_last_rls_viol_blen_st = 0x%08X\n",
+				reg_sys_nrec_common_d3_st.mac_last_rls_viol_blen_st);
+
+	reg_base_address =      bm.common_general_conf;
+	reg_size   =   bm_reg_size.common_general_conf;
+	reg_offset = bm_reg_offset.common_general_conf * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_common_general_conf);
+	if (rc != OK)
+		return rc;
+
+	pr_info("\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset,
+		*((u32 *)&reg_common_general_conf));
+
+	pr_info("\t common_general_conf.mac_last_alc_viol_pid_st = 0x%08X\n",
+				reg_common_general_conf.drm_si_decide_extra_fill);
+	pr_info("\t common_general_conf.mac_last_rls_viol_pid_st = 0x%08X\n",
+				reg_common_general_conf.dm_vmid);
+	pr_info("\t common_general_conf.drm_last_dram_err_pid_st = 0x%08X\n",
+				reg_common_general_conf.bm_req_rcv_en);
+
+	reg_base_address =      bm.dram_domain_conf;
+	reg_size   =   bm_reg_size.dram_domain_conf;
+	reg_offset = bm_reg_offset.dram_domain_conf * 0;
+
+	pr_info("\n");
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dram_domain_conf);
+	if (rc != OK)
+		return rc;
+
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset,
+		*((u32 *)&reg_dram_domain_conf));
+
+	pr_info("\t dram_domain_conf.dwm_awdomain_b0  = 0x%08X\n", reg_dram_domain_conf.dwm_awdomain_b0);
+	pr_info("\t dram_domain_conf.dwm_awdomain_bgp = 0x%08X\n", reg_dram_domain_conf.dwm_awdomain_bgp);
+	pr_info("\t dram_domain_conf.drm_ardomain_b0  = 0x%08X\n", reg_dram_domain_conf.drm_ardomain_b0);
+	pr_info("\t dram_domain_conf.drm_ardomain_bgp = 0x%08X\n", reg_dram_domain_conf.drm_ardomain_bgp);
+
+	reg_base_address =      bm.dram_cache_conf;
+	reg_size   =   bm_reg_size.dram_cache_conf;
+	reg_offset = bm_reg_offset.dram_cache_conf * 0;
+
+	pr_info("\n");
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dram_cache_conf);
+	if (rc != OK)
+		return rc;
+
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset,
+		*((u32 *)&reg_dram_cache_conf));
+
+	pr_info("\t dram_cache_conf.dwm_awcache_b0  = 0x%08X\n", reg_dram_cache_conf.dwm_awcache_b0);
+	pr_info("\t dram_cache_conf.dwm_awcache_bgp = 0x%08X\n", reg_dram_cache_conf.dwm_awcache_bgp);
+	pr_info("\t dram_cache_conf.drm_arcache_b0  = 0x%08X\n", reg_dram_cache_conf.drm_arcache_b0);
+	pr_info("\t dram_cache_conf.drm_arcache_bgp = 0x%08X\n", reg_dram_cache_conf.drm_arcache_bgp);
+
+	reg_base_address =      bm.dram_qos_conf;
+	reg_size   =   bm_reg_size.dram_qos_conf;
+	reg_offset = bm_reg_offset.dram_qos_conf * 0;
+
+	pr_info("\n");
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dram_qos_conf);
+	if (rc != OK)
+		return rc;
+
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_dram_qos_conf));
+
+	pr_info("\t dram_qos_conf.dwm_awqos_b0  = 0x%08X\n", reg_dram_qos_conf.dwm_awqos_b0);
+	pr_info("\t dram_qos_conf.dwm_awqos_bgp = 0x%08X\n", reg_dram_qos_conf.dwm_awqos_bgp);
+	pr_info("\t dram_qos_conf.drm_arqos_b0  = 0x%08X\n", reg_dram_qos_conf.drm_arqos_b0);
+	pr_info("\t dram_qos_conf.drm_arqos_bgp = 0x%08X\n", reg_dram_qos_conf.drm_arqos_bgp);
 
-	pr_info("\n for all banks:\n");
 	reg_base_address =      bm.dm_axi_fifos_st;
 	reg_size   =   bm_reg_size.dm_axi_fifos_st;
 	reg_offset = bm_reg_offset.dm_axi_fifos_st * 0;
 
+	pr_info("\n");
 	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dm_axi_fifos_st);
 	if (rc != OK)
 		return rc;
@@ -2182,18 +2314,19 @@ int bm_idle_debug(void)
 		reg_base_address + reg_offset, *((u32 *)&reg_dm_axi_fifos_st));
 
 	pr_info("\t dm_axi_fifos_st.dwm_waddr_fifo_fill_st = 0x%08X\n",
-						reg_dm_axi_fifos_st.dwm_waddr_fifo_fill_st);
+				reg_dm_axi_fifos_st.dwm_waddr_fifo_fill_st);
 	pr_info("\t dm_axi_fifos_st.dwm_wdata_fifo_fill_st = 0x%08X\n",
-						reg_dm_axi_fifos_st.dwm_wdata_fifo_fill_st);
+				reg_dm_axi_fifos_st.dwm_wdata_fifo_fill_st);
 	pr_info("\t dm_axi_fifos_st.drm_raddr_fifo_fill_st = 0x%08X\n",
-						reg_dm_axi_fifos_st.drm_raddr_fifo_fill_st);
+				reg_dm_axi_fifos_st.drm_raddr_fifo_fill_st);
 	pr_info("\t dm_axi_fifos_st.drm_rdata_fifo_fill_st = 0x%08X\n",
-						reg_dm_axi_fifos_st.drm_rdata_fifo_fill_st);
+				reg_dm_axi_fifos_st.drm_rdata_fifo_fill_st);
 
 	reg_base_address =      bm.drm_pend_fifo_st;
 	reg_size   =   bm_reg_size.drm_pend_fifo_st;
 	reg_offset = bm_reg_offset.drm_pend_fifo_st * 0;
 
+	pr_info("\n");
 	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_drm_pend_fifo_st);
 	if (rc != OK)
 		return rc;
@@ -2205,12 +2338,13 @@ int bm_idle_debug(void)
 		reg_base_address + reg_offset, *((u32 *)&reg_drm_pend_fifo_st));
 
 	pr_info("\t drm_pend_fifo_st.drm_pend_fifo_fill_st = 0x%08X\n",
-					reg_drm_pend_fifo_st.drm_pend_fifo_fill_st);
+						reg_drm_pend_fifo_st.drm_pend_fifo_fill_st);
 
 	reg_base_address =      bm.dm_axi_wr_pend_fifo_st;
 	reg_size   =   bm_reg_size.dm_axi_wr_pend_fifo_st;
 	reg_offset = bm_reg_offset.dm_axi_wr_pend_fifo_st * 0;
 
+	pr_info("\n");
 	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dm_axi_wr_pend_fifo_st);
 	if (rc != OK)
 		return rc;
@@ -2222,1098 +2356,1034 @@ int bm_idle_debug(void)
 		reg_base_address + reg_offset, *((u32 *)&reg_dm_axi_wr_pend_fifo_st));
 
 	pr_info("\t dm_axi_wr_pend_fifo_st.axi_wr_pend_fifo_fill_st = 0x%08X\n",
-			reg_dm_axi_wr_pend_fifo_st.axi_wr_pend_fifo_fill_st);
+						reg_dm_axi_wr_pend_fifo_st.axi_wr_pend_fifo_fill_st);
+
+	reg_base_address =      bm.bm_idle_st;
+	reg_size   =   bm_reg_size.bm_idle_st;
+	reg_offset = bm_reg_offset.bm_idle_st * 0;
+
+	pr_info("\n");
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bm_idle_st);
+	if (rc != OK)
+		return rc;
+
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_bm_idle_st));
+
+	pr_info("\t bm_idle_st.bm_idle_st = 0x%08X\n", reg_bm_idle_st.bm_idle_st);
 
 	rc = OK;
 	return rc;
 }
 
-int bm_error_dump(void)
+int bm_pool_registers_dump(u32 pool)
 {
 	u32 reg_base_address, reg_size, reg_offset;
-	int rc = !OK;
-	u32 bid;
-	struct bm_b_sys_rec_bank_intr_cause     reg_b_sys_rec_bank_intr_cause;
-	struct bm_sw_debug_rec_intr_cause       reg_sw_debug_rec_intr_cause;
-	struct bm_sys_nrec_common_intr_cause    reg_sys_nrec_common_intr_cause;
-	struct bm_error_intr_cause              reg_error_intr_cause;
-	struct bm_func_intr_cause               reg_func_intr_cause;
-	struct bm_ecc_err_intr_cause            reg_ecc_err_intr_cause;
-	struct bm_b_pool_nempty_intr_cause      reg_b_pool_nempty_intr_cause;
-	struct bm_b_dpool_ae_intr_cause         reg_b_dpool_ae_intr_cause;
-	struct bm_b_dpool_af_intr_cause         reg_b_dpool_af_intr_cause;
+	int rc = -BM_INPUT_NOT_IN_RANGE;
+	u32 pid, bid, pid_local;
 	char reg_name[50];
 
+	struct bm_pool_conf_b0              reg_pool_conf_b0;
+	struct bm_pool_conf_bgp             reg_pool_conf_bgp;
+	struct bm_pool_st                   reg_pool_st;
+	struct bm_c_mng_stat_data           tab_dpr_c_mng_stat;
+	struct bm_c_mng_dyn_data            tab_tpr_c_mng_dyn;
+	struct bm_d_mng_ball_stat_data      tab_dpr_d_mng_ball_stat_data;
+	struct bm_tpr_dro_mng_ball_dyn_data tab_tpr_dro_mng_ball_dyn_data;
+	struct bm_tpr_drw_mng_ball_dyn_data tab_tpr_drw_mng_ball_dyn_data;
+	struct bm_tpr_ctrs_0_data           tab_tpr_ctrs_0_data;
+
 	BM_AVAILABLE_CHECK();
 
-	for (bid = 0; bid < BM_NUMBER_OF_BANKS; bid++) {
-		reg_base_address =      bm.b_sys_rec_bank_intr_cause[bid];
-		reg_size   =   bm_reg_size.b_sys_rec_bank_intr_cause[bid];
-		reg_offset = bm_reg_offset.b_sys_rec_bank_intr_cause[bid] * 0;
+	if ((pool            <     BM_POOL_MIN) || (pool            >    BM_POOL_MAX))
+		return rc;
+	if ((pool            >  BM_POOL_QM_MAX) && (pool            < BM_POOL_GP_MIN))
+		return rc; /* pools 4, 5, 6, 7 don't exist */
 
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_sys_rec_bank_intr_cause);
+	pid       = (int)pool;
+	bid       = BM_PID_TO_BANK(pid);
+	pid_local = BM_PID_TO_PID_LOCAL(pid);
+
+	pr_info("\n bm_pool_registers_dump:");
+
+	reg_base_address =      bm.b_pool_n_conf[bid];
+	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
+	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
+
+	if  (bid == 0) {	/* QM pools */
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_pool_conf_b0);
 		if (rc != OK)
 			return rc;
 
-		pr_info("\n for bank = %d:\n", bid);
+		pr_info("\n");
 		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 		if (rc != OK)
 			return rc;
 		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_b_sys_rec_bank_intr_cause));
+			reg_base_address + reg_offset, *((u32 *)&reg_pool_conf_b0));
 
-		pr_info("\t b%d_sys_rec_bank_intr_cause.sys_rec_bank_intr_cause_sum = %d\n",
-					bid, reg_b_sys_rec_bank_intr_cause.sys_rec_bank_intr_cause_sum);
-		pr_info("\t b%d_sys_rec_bank_intr_cause.alc_vmid_mis_s = 0x%08X\n",
-					bid, reg_b_sys_rec_bank_intr_cause.alc_vmid_mis_s);
-		pr_info("\t b%d_sys_rec_bank_intr_cause.rls_vmid_mis_s = 0x%08X\n",
-					bid, reg_b_sys_rec_bank_intr_cause.rls_vmid_mis_s);
-		pr_info("\t b%d_sys_rec_bank_intr_cause.alc_dis_pool_s = 0x%08X\n",
-					bid, reg_b_sys_rec_bank_intr_cause.alc_dis_pool_s);
-		pr_info("\t b%d_sys_rec_bank_intr_cause.rls_dis_pool_s = 0x%08X\n",
-					bid, reg_b_sys_rec_bank_intr_cause.rls_dis_pool_s);
+		pr_info("\t b%d_pool_%d_conf.pool_enable     = 0x%08X\n",
+					bid, pid_local, reg_pool_conf_b0.pool_enable);
+		pr_info("\t b%d_pool_%d_conf.pool_quick_init = 0x%08X\n",
+					bid, pid_local, reg_pool_conf_b0.pool_quick_init);
+	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) {	/* QP pools */
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_pool_conf_bgp);
+		if (rc != OK)
+			return rc;
+
+		pr_info("\n");
+		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+		if (rc != OK)
+			return rc;
+		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_pool_conf_bgp));
+
+		pr_info("\t b%d_pool_%d_conf.pool_enable     = 0x%08X\n",
+					bid, pid_local, reg_pool_conf_bgp.pool_enable);
+		pr_info("\t b%d_pool_%d_conf.pool_in_pairs   = 0x%08X\n",
+					bid, pid_local, reg_pool_conf_bgp.pool_in_pairs);
+		pr_info("\t b%d_pool_%d_conf.PE_size         = 0x%08X\n",
+					bid, pid_local, reg_pool_conf_bgp.pe_size);
+		pr_info("\t b%d_pool_%d_conf.pool_quick_init = 0x%08X\n",
+					bid, pid_local, reg_pool_conf_bgp.pool_quick_init);
+	} else {
+		rc = -BM_INPUT_NOT_IN_RANGE;
+		return rc;
 	}
 
-	reg_base_address =      bm.sw_debug_rec_intr_cause;
-	reg_size   =   bm_reg_size.sw_debug_rec_intr_cause;
-	reg_offset = bm_reg_offset.sw_debug_rec_intr_cause * 0;
+	reg_base_address =      bm.b_pool_n_st[bid];
+	reg_size   =   bm_reg_size.b_pool_n_st[bid];
+	reg_offset = bm_reg_offset.b_pool_n_st[bid] * pid_local;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sw_debug_rec_intr_cause);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_pool_st);
 	if (rc != OK)
 		return rc;
+
+	pr_info("\n");
 	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
 	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_sw_debug_rec_intr_cause));
+		reg_base_address + reg_offset, *((u32 *)&reg_pool_st));
 
-	pr_info("\t reg_sw_debug_rec_intr_cause.sw_debug_rec_intr_cause_sum = %d\n",
-				reg_sw_debug_rec_intr_cause.sw_debug_rec_intr_cause_sum);
-	pr_info("\t reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_c_s = %d\n",
-				reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_c_s);
-	pr_info("\t reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_c_dyn_s = %d\n",
-				reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_c_dyn_s);
-	pr_info("\t reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_d_dro_s = %d\n",
-				reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_d_dro_s);
-	pr_info("\t reg_sw_debug_rec_intr_cause.qm_bm_rf_err_s = %d\n",
-				reg_sw_debug_rec_intr_cause.qm_bm_rf_err_s);
+	pr_info("\t b%d_pool_%d_st.pool_nempty_st          = 0x%08X\n",
+			bid, pid_local, reg_pool_st.pool_nempty_st);
+	pr_info("\t b%d_pool_%d_st.dpool_ae_st             = 0x%08X\n",
+			bid, pid_local, reg_pool_st.dpool_ae_st);
+	pr_info("\t b%d_pool_%d_st.dpool_af_st             = 0x%08X\n",
+			bid, pid_local, reg_pool_st.dpool_af_st);
+	pr_info("\t b%d_pool_%d_st.pool_fill_bgt_si_thr_st = 0x%08X\n",
+			bid, pid_local, reg_pool_st.pool_fill_bgt_si_thr_st);
 
-	reg_base_address =      bm.sys_nrec_common_intr_cause;
-	reg_size   =   bm_reg_size.sys_nrec_common_intr_cause;
-	reg_offset = bm_reg_offset.sys_nrec_common_intr_cause * 0;
+	reg_base_address =      bm.dpr_c_mng_stat[bid];
+	reg_size   =   bm_reg_size.dpr_c_mng_stat[bid];
+	reg_offset = bm_reg_offset.dpr_c_mng_stat[bid] * pid_local;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_intr_cause);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_c_mng_stat);
 	if (rc != OK)
 		return rc;
+
+	pr_info("\n");
 	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
 	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_sys_nrec_common_intr_cause));
+		reg_base_address + reg_offset, *((u32 *)&tab_dpr_c_mng_stat));
 
-	pr_info("\t reg_sys_nrec_common_intr_cause.sys_nrec_common_intr_cause_sum = %d\n",
-				reg_sys_nrec_common_intr_cause.sys_nrec_common_intr_cause_sum);
-	pr_info("\t reg_sys_nrec_common_intr_cause.qm_alc_pairs_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.qm_alc_pairs_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.qm_rls_pairs_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.qm_rls_pairs_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.ppe_alc_pairs_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.ppe_alc_pairs_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.ppe_rls_pairs_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.ppe_rls_pairs_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.ppe_alc_blen_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.ppe_alc_blen_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.ppe_rls_blen_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.ppe_rls_blen_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.mac_alc_pairs_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.mac_alc_pairs_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.mac_rls_pairs_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.mac_rls_pairs_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.mac_alc_pid_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.mac_alc_pid_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.mac_rls_pid_viol_s = %d\n",
-				reg_sys_nrec_common_intr_cause.mac_rls_pid_viol_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.drm_dram_err_s = %d\n",
-				reg_sys_nrec_common_intr_cause.drm_dram_err_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.dwm_dram_err_s = %d\n",
-				reg_sys_nrec_common_intr_cause.dwm_dram_err_s);
-	pr_info("\t reg_sys_nrec_common_intr_cause.dwm_fail_so_dram_fill_s = %d\n",
-				reg_sys_nrec_common_intr_cause.dwm_fail_so_dram_fill_s);
+	pr_info("\t dpr_c_mng_b%d_stat.cache_start  = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_start);
+	pr_info("\t dpr_c_mng_b%d_stat.cache_end    = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_end);
+	pr_info("\t dpr_c_mng_b%d_stat.cache_si_thr = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_si_thr);
+	pr_info("\t dpr_c_mng_b%d_stat.cache_so_thr = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_so_thr);
+	pr_info("\t dpr_c_mng_b%d_stat.cache_attr   = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_attr);
+	pr_info("\t dpr_c_mng_b%d_stat.cache_vmid   = 0x%08X\n", bid, tab_dpr_c_mng_stat.cache_vmid);
 
-	reg_base_address =      bm.error_intr_cause;
-	reg_size   =   bm_reg_size.error_intr_cause;
-	reg_offset = bm_reg_offset.error_intr_cause * 0;
+	reg_base_address =      bm.tpr_c_mng_b_dyn[bid];
+	reg_size   =   bm_reg_size.tpr_c_mng_b_dyn[bid];
+	reg_offset = bm_reg_offset.tpr_c_mng_b_dyn[bid] * pid_local;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_error_intr_cause);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_c_mng_dyn);
 	if (rc != OK)
 		return rc;
+
+	pr_info("\n");
 	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
 	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_error_intr_cause));
+		reg_base_address + reg_offset, *((u32 *)&tab_tpr_c_mng_dyn));
 
-	pr_info("\t reg_error_intr_cause.qm_bm_err_intr_sum = %d\n",
-				reg_error_intr_cause.qm_bm_err_intr_sum);
-	pr_info("\t reg_error_intr_cause.ecc_err_intr_s = %d\n",
-				reg_error_intr_cause.ecc_err_intr_s);
-	pr_info("\t reg_error_intr_cause.b0_sys_events_rec_bank_s = %d\n",
-				reg_error_intr_cause.b0_sys_events_rec_bank_s);
-	pr_info("\t reg_error_intr_cause.b0_sys_events_rec_bank_s = %d\n",
-				reg_error_intr_cause.b0_sys_events_rec_bank_s);
-	pr_info("\t reg_error_intr_cause.b2_sys_events_rec_bank_s = %d\n",
-				reg_error_intr_cause.b1_sys_events_rec_bank_s);
-	pr_info("\t reg_error_intr_cause.b3_sys_events_rec_bank_s = %d\n",
-				reg_error_intr_cause.b3_sys_events_rec_bank_s);
-	pr_info("\t reg_error_intr_cause.b4_sys_events_rec_bank_s = %d\n",
-				reg_error_intr_cause.b4_sys_events_rec_bank_s);
-	pr_info("\t reg_error_intr_cause.sw_debug_events_rec_s = %d\n",
-				reg_error_intr_cause.sw_debug_events_rec_s);
-	pr_info("\t reg_error_intr_cause.sys_events_nrec_common_s = %d\n",
-				reg_error_intr_cause.sys_events_nrec_common_s);
+	pr_info("\t tpr_c_mng_b%d_dyn.cache_fill_min = 0x%08X\n", bid, tab_tpr_c_mng_dyn.cache_fill_min);
+	pr_info("\t tpr_c_mng_b%d_dyn.cache_fill_max = 0x%08X\n", bid, tab_tpr_c_mng_dyn.cache_fill_max);
+	pr_info("\t tpr_c_mng_b%d_dyn.cache_rd_ptr   = 0x%08X\n", bid, tab_tpr_c_mng_dyn.cache_rd_ptr);
+	pr_info("\t tpr_c_mng_b%d_dyn.cache_wr_ptr   = 0x%08X\n", bid, tab_tpr_c_mng_dyn.cache_wr_ptr);
 
-	reg_base_address =      bm.func_intr_cause;
-	reg_size   =   bm_reg_size.func_intr_cause;
-	reg_offset = bm_reg_offset.func_intr_cause * 0;
+	reg_base_address =      bm.dpr_d_mng_ball_stat;
+	reg_size   =   bm_reg_size.dpr_d_mng_ball_stat;
+	reg_offset = bm_reg_offset.dpr_d_mng_ball_stat * BM_PID_TO_GLOBAL_POOL_IDX(pid);
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_func_intr_cause);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_d_mng_ball_stat_data);
 	if (rc != OK)
 		return rc;
+
+	pr_info("\n");
 	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
 	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_func_intr_cause));
+		reg_base_address + reg_offset, *((u32 *)&tab_dpr_d_mng_ball_stat_data));
 
-	pr_info("\t reg_func_intr_cause.qm_bm_func_intr_sum = %d\n",
-				reg_func_intr_cause.qm_bm_func_intr_sum);
-	pr_info("\t reg_func_intr_cause.b0_pool_nempty_intr_s = %d\n",
-				reg_func_intr_cause.b0_pool_nempty_intr_s);
-	pr_info("\t reg_func_intr_cause.b0_dpool_ae_intr_s = %d\n",
-				reg_func_intr_cause.b0_dpool_ae_intr_s);
-	pr_info("\t reg_func_intr_cause.b0_dpool_af_intr_s = %d\n",
-				reg_func_intr_cause.b0_dpool_af_intr_s);
-	pr_info("\t reg_func_intr_cause.b1_pool_nempty_intr_s = %d\n",
-				reg_func_intr_cause.b1_pool_nempty_intr_s);
-	pr_info("\t reg_func_intr_cause.b1_dpool_ae_intr_s = %d\n",
-				reg_func_intr_cause.b1_dpool_ae_intr_s);
-	pr_info("\t reg_func_intr_cause.b1_dpool_af_intr_s = %d\n",
-				reg_func_intr_cause.b1_dpool_af_intr_s);
-	pr_info("\t reg_func_intr_cause.b2_pool_nempty_intr_s = %d\n",
-				reg_func_intr_cause.b2_pool_nempty_intr_s);
-	pr_info("\t reg_func_intr_cause.b2_dpool_ae_intr_s = %d\n",
-				reg_func_intr_cause.b2_dpool_ae_intr_s);
-	pr_info("\t reg_func_intr_cause.b2_dpool_af_intr_s = %d\n",
-				reg_func_intr_cause.b2_dpool_af_intr_s);
-	pr_info("\t reg_func_intr_cause.b3_pool_nempty_intr_s = %d\n",
-				reg_func_intr_cause.b3_pool_nempty_intr_s);
-	pr_info("\t reg_func_intr_cause.b3_dpool_ae_intr_s = %d\n",
-				reg_func_intr_cause.b3_dpool_ae_intr_s);
-	pr_info("\t reg_func_intr_cause.b3_dpool_af_intr_s = %d\n",
-				reg_func_intr_cause.b3_dpool_af_intr_s);
-	pr_info("\t reg_func_intr_cause.b4_pool_nempty_intr_s = %d\n",
-				reg_func_intr_cause.b4_pool_nempty_intr_s);
-	pr_info("\t reg_func_intr_cause.b4_dpool_ae_intr_s = %d\n",
-				reg_func_intr_cause.b4_dpool_ae_intr_s);
-	pr_info("\t reg_func_intr_cause.b4_dpool_af_intr_s = %d\n",
-				reg_func_intr_cause.b4_dpool_af_intr_s);
+	pr_info("\t dpr_d_mng_ball_stat.dram_ae_thr = 0x%08X\n",     tab_dpr_d_mng_ball_stat_data.dram_ae_thr);
+	pr_info("\t dpr_d_mng_ball_stat.dram_af_thr = 0x%08X\n",     tab_dpr_d_mng_ball_stat_data.dram_af_thr);
+	pr_info("\t dpr_d_mng_ball_stat.dram_start  = 0x%02X%08X\n",
+		tab_dpr_d_mng_ball_stat_data.dram_start_msb, tab_dpr_d_mng_ball_stat_data.dram_start_lsb);
+	pr_info("\t dpr_d_mng_ball_stat.dram_size   = 0x%08X\n",     tab_dpr_d_mng_ball_stat_data.dram_size);
 
-	reg_base_address =      bm.ecc_err_intr_cause;
-	reg_size   =   bm_reg_size.ecc_err_intr_cause;
-	reg_offset = bm_reg_offset.ecc_err_intr_cause * 0;
+	reg_base_address =      bm.tpr_dro_mng_ball_dyn;
+	reg_size   =   bm_reg_size.tpr_dro_mng_ball_dyn;
+	reg_offset = bm_reg_offset.tpr_dro_mng_ball_dyn * BM_PID_TO_GLOBAL_POOL_IDX(pid);
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_ecc_err_intr_cause);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_dro_mng_ball_dyn_data);
 	if (rc != OK)
 		return rc;
+
+	pr_info("\n");
 	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
 	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-		reg_base_address + reg_offset, *((u32 *)&reg_ecc_err_intr_cause));
-
-	pr_info("\t reg_ecc_err_intr_cause.ecc_err_intr_sum = %d\n",
-				reg_ecc_err_intr_cause.ecc_err_intr_sum);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b0_stat_ser_err_1_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b0_stat_ser_err_1_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b0_stat_ser_err_2_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b0_stat_ser_err_2_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b1_stat_ser_err_1_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b1_stat_ser_err_1_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b1_stat_ser_err_2_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b1_stat_ser_err_2_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b2_stat_ser_err_1_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b2_stat_ser_err_1_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b2_stat_ser_err_2_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b2_stat_ser_err_2_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b3_stat_ser_err_1_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b3_stat_ser_err_1_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b3_stat_ser_err_2_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b3_stat_ser_err_2_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b4_stat_ser_err_1_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b4_stat_ser_err_1_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b4_stat_ser_err_2_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_c_mng_b4_stat_ser_err_2_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_d_mng_ball_stat_ser_err_1_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_d_mng_ball_stat_ser_err_1_s);
-	pr_info("\t reg_ecc_err_intr_cause.dpr_d_mng_ball_stat_ser_err_2_s = %d\n",
-				reg_ecc_err_intr_cause.dpr_d_mng_ball_stat_ser_err_2_s);
-	pr_info("\t reg_ecc_err_intr_cause.sram_b0_cache_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.sram_b0_cache_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.sram_b1_cache_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.sram_b1_cache_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.sram_b2_cache_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.sram_b2_cache_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.sram_b3_cache_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.sram_b3_cache_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.sram_b4_cache_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.sram_b4_cache_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b0_dyn_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.tpr_c_mng_b0_dyn_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b1_dyn_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.tpr_c_mng_b1_dyn_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b2_dyn_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.tpr_c_mng_b2_dyn_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b3_dyn_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.tpr_c_mng_b3_dyn_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b4_dyn_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.tpr_c_mng_b4_dyn_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.tpr_dro_mng_ball_dyn_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.tpr_dro_mng_ball_dyn_ser_err_s);
-	pr_info("\t reg_ecc_err_intr_cause.tpr_drw_mng_ball_dyn_ser_err_s = %d\n",
-				reg_ecc_err_intr_cause.tpr_drw_mng_ball_dyn_ser_err_s);
+		reg_base_address + reg_offset, *((u32 *)&tab_tpr_dro_mng_ball_dyn_data));
 
-	for (bid = 0; bid < BM_NUMBER_OF_BANKS; bid++) {
-		reg_base_address =      bm.pool_nempty_intr_cause[bid];
-		reg_size   =   bm_reg_size.pool_nempty_intr_cause[bid];
-		reg_offset = bm_reg_offset.pool_nempty_intr_cause[bid] * 0;
+	pr_info("\t tpr_dro_mng_ball_dyn.dram_rd_ptr = 0x%08X\n", tab_tpr_dro_mng_ball_dyn_data.dram_rd_ptr);
+	pr_info("\t tpr_dro_mng_ball_dyn.dram_wr_ptr = 0x%08X\n", tab_tpr_dro_mng_ball_dyn_data.dram_wr_ptr);
 
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_pool_nempty_intr_cause);
-		if (rc != OK)
-			return rc;
-		pr_info("\n for bank = %d:\n", bid);
-		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-		if (rc != OK)
-			return rc;
-		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_b_pool_nempty_intr_cause));
+	reg_base_address =      bm.tpr_drw_mng_ball_dyn;
+	reg_size   =   bm_reg_size.tpr_drw_mng_ball_dyn;
+	reg_offset = bm_reg_offset.tpr_drw_mng_ball_dyn * BM_PID_TO_GLOBAL_POOL_IDX(pid);
 
-		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_nempty_intr_sum = %d\n",
-					bid, reg_b_pool_nempty_intr_cause.b_pool_nempty_intr_sum);
-		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_0_nempty_s = 0x%08X\n",
-					bid, reg_b_pool_nempty_intr_cause.b_pool_0_nempty_s);
-		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_1_nempty_s = 0x%08X\n",
-					bid, reg_b_pool_nempty_intr_cause.b_pool_1_nempty_s);
-		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_2_nempty_s = 0x%08X\n",
-					bid, reg_b_pool_nempty_intr_cause.b_pool_2_nempty_s);
-		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_3_nempty_s = 0x%08X\n",
-					bid, reg_b_pool_nempty_intr_cause.b_pool_3_nempty_s);
-		if (bid != 0) {
-			pr_info("\t b%d_pool_nempty_intr_cause.b_pool_4_nempty_s = 0x%08X\n",
-						bid, reg_b_pool_nempty_intr_cause.b_pool_4_nempty_s);
-			pr_info("\t b%d_pool_nempty_intr_cause.b_pool_5_nempty_s = 0x%08X\n",
-						bid, reg_b_pool_nempty_intr_cause.b_pool_5_nempty_s);
-			pr_info("\t b%d_pool_nempty_intr_cause.b_pool_6_nempty_s = 0x%08X\n",
-						bid, reg_b_pool_nempty_intr_cause.b_pool_6_nempty_s);
-		}
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_drw_mng_ball_dyn_data);
+	if (rc != OK)
+		return rc;
 
-		reg_base_address =      bm.dpool_ae_intr_cause[bid];
-		reg_size   =   bm_reg_size.dpool_ae_intr_cause[bid];
-		reg_offset = bm_reg_offset.dpool_ae_intr_cause[bid] * 0;
+	pr_info("\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&tab_tpr_drw_mng_ball_dyn_data));
 
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_dpool_ae_intr_cause);
-		if (rc != OK)
-			return rc;
-		pr_info("\n for bank = %d:\n", bid);
-		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-		if (rc != OK)
-			return rc;
-		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_b_dpool_ae_intr_cause));
+	pr_info("\t tpr_drw_mng_ball_dyn.dram_fill = 0x%08X\n", tab_tpr_drw_mng_ball_dyn_data.dram_fill);
 
-		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_ae_intr_sum = %d\n",
-					bid, reg_b_dpool_ae_intr_cause.b_dpool_ae_intr_sum);
-		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_0_ae_s = 0x%08X\n",
-					bid, reg_b_dpool_ae_intr_cause.b_dpool_0_ae_s);
-		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_1_ae_s = 0x%08X\n",
-					bid, reg_b_dpool_ae_intr_cause.b_dpool_1_ae_s);
-		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_2_ae_s = 0x%08X\n",
-					bid, reg_b_dpool_ae_intr_cause.b_dpool_2_ae_s);
-		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_3_ae_s = 0x%08X\n",
-					bid, reg_b_dpool_ae_intr_cause.b_dpool_3_ae_s);
-		if (bid != 0) {
-			pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_4_ae_s = 0x%08X\n",
-						bid, reg_b_dpool_ae_intr_cause.b_dpool_4_ae_s);
-			pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_5_ae_s = 0x%08X\n",
-						bid, reg_b_dpool_ae_intr_cause.b_dpool_5_ae_s);
-			pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_6_ae_s = 0x%08X\n",
-						bid, reg_b_dpool_ae_intr_cause.b_dpool_6_ae_s);
-		}
+	reg_base_address =      bm.tpr_ctrs_0_b[bid];
+	reg_size   =   bm_reg_size.tpr_ctrs_0_b[bid];
+	reg_offset = bm_reg_offset.tpr_ctrs_0_b[bid] * pid_local;
 
-		reg_base_address =      bm.dpool_af_intr_cause[bid];
-		reg_size   =   bm_reg_size.dpool_af_intr_cause[bid];
-		reg_offset = bm_reg_offset.dpool_af_intr_cause[bid];
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_ctrs_0_data);
+	if (rc != OK)
+		return rc;
 
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_dpool_af_intr_cause);
-		if (rc != OK)
-			return rc;
-		pr_info("\n for bank = %d:\n", bid);
-		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
-		if (rc != OK)
-			return rc;
-		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
-			reg_base_address + reg_offset, *((u32 *)&reg_b_dpool_af_intr_cause));
+	pr_info("\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&tab_tpr_ctrs_0_data));
 
-		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_af_intr_sum = %d\n",
-					bid, reg_b_dpool_af_intr_cause.b_dpool_af_intr_sum);
-		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_0_af_s = 0x%08X\n",
-					bid, reg_b_dpool_af_intr_cause.b_dpool_0_af_s);
-		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_1_af_s = 0x%08X\n",
-					bid, reg_b_dpool_af_intr_cause.b_dpool_1_af_s);
-		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_2_af_s = 0x%08X\n",
-					bid, reg_b_dpool_af_intr_cause.b_dpool_2_af_s);
-		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_3_af_s = 0x%08X\n",
-					bid, reg_b_dpool_af_intr_cause.b_dpool_3_af_s);
-		if (bid != 0) {
-			pr_info("\t b%d_dpool_af_intr_cause.b_dpool_4_af_s = 0x%08X\n",
-						bid, reg_b_dpool_af_intr_cause.b_dpool_4_af_s);
-			pr_info("\t b%d_dpool_af_intr_cause.b_dpool_5_af_s = 0x%08X\n",
-						bid, reg_b_dpool_af_intr_cause.b_dpool_5_af_s);
-			pr_info("\t b%d_dpool_af_intr_cause.b_dpool_6_af_s = 0x%08X\n",
-						bid, reg_b_dpool_af_intr_cause.b_dpool_6_af_s);
-		}
-	}
+	pr_info("\t tpr_ctrs_0_b%d.delayed_releases_ctr = 0x%08X\n",
+		bid, tab_tpr_ctrs_0_data.delayed_releases_ctr);
+	pr_info("\t tpr_ctrs_0_b%d.failed_allocs_ctr    = 0x%08X\n",
+		bid, tab_tpr_ctrs_0_data.failed_allocs_ctr);
+	pr_info("\t tpr_ctrs_0_b%d.released_pes_ctr     = 0x%08X\n",
+		bid, tab_tpr_ctrs_0_data.released_pes_ctr);
+	pr_info("\t tpr_ctrs_0_b%d.allocated_pes_ctr    = 0x%08X\n",
+		bid, tab_tpr_ctrs_0_data.allocated_pes_ctr);
 
 	rc = OK;
 	return rc;
 }
 
-/*BM Internal functions*/
-int bm_pool_memory_fill(u32 pool, u32 num_of_buffers, struct mv_a40 *base_address)
+int bm_bank_registers_dump(u32 bank)
 {
+	u32 reg_base_address, reg_size, reg_offset;
 	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 granularity_of_pe_in_dram;
-	u32 i, *p;
-	granularity_of_pe_in_dram = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM;	/* 64/4 */
+	u32 bid;
+	char reg_name[50];
+	struct bm_b_sys_rec_bank_d0_st       reg_b_sys_rec_bank_d0_st;
+	struct bm_b_sys_rec_bank_d1_st       reg_b_sys_rec_bank_d1_st;
+	struct bm_b_bank_req_fifos_st        reg_b_bank_req_fifos_st;
+	struct bm_b0_past_alc_fifos_st       reg_b0_past_alc_fifos_st;
+	struct bm_bgp_past_alc_fifos_st      reg_bgp_past_alc_fifos_st;
+	struct bm_b0_rls_wrp_ppe_fifos_st    reg_b0_rls_wrp_ppe_fifos_st;
 
 	BM_AVAILABLE_CHECK();
 
-	if ((num_of_buffers % granularity_of_pe_in_dram) != 0) /* UNIT_OF__1_BYTES = 1 */
-		return rc; /* PE_size is 22 bit */
-	if ((pool            <         BM_POOL_QM_MIN) || (pool            >         BM_POOL_QM_MAX))
-		return rc;
-	if ((pool == 0) || (pool == 1)) {
-		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers >  BM_NUM_OF_BUFFERS_QM_GPM_MAX))
-			return rc;
-	}
-	if ((pool == 2) || (pool == 3)) {
-		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers > BM_NUM_OF_BUFFERS_QM_DRAM_MAX))
-			return rc;
-	}
-	if ((base_address->dma_msb < BM_DRAM_ADDRESS_MIN_MSB) ||
-		(base_address->dma_msb > BM_DRAM_ADDRESS_MAX_MSB))
-		return rc;
-	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MIN_MSB) &&
-		(base_address->dma_lsb <  BM_DRAM_ADDRESS_MIN_LSB))
-		return rc;
-	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MAX_MSB) &&
-		(base_address->dma_lsb >  BM_DRAM_ADDRESS_MAX_LSB))
+	if ((bank            <     BM_BANK_MIN) || (bank            >     BM_BANK_MAX))
 		return rc;
 
-    /*
-	 * Takes pool_base_address and use it as a pointer
-	 * to fill all PE's with incrementing value (starting with 1)
-	 * Write in Dram in BM pool section an incrementing index
-	 */
-
-	p = (u32 *)(base_address->virt_lsb);
-	pr_info("%s:\n", __func__);
-	pr_info("  num_of_buffers    %d\n", num_of_buffers);
-	pr_info("  base_address virtual 0x%02X%08X	physical 0x%02X%08X\n",
-		base_address->virt_msb, base_address->virt_lsb,
-		base_address->dma_msb, base_address->dma_lsb);
-
-	for (i = 0; i < num_of_buffers; i++) {
-		*p = i + 1;
-		p++;
-	}
-
-	rc = OK;
-	return rc;
-}
+	bid       = bank;
 
-int bm_pool_dram_set(u32 pool, u32 num_of_buffers, u32 pe_size, struct mv_a40 *base_address,
-						u32 ae_thr, u32 af_thr)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local, dram_size, dram_ae_thr, dram_af_thr;
-	struct bm_d_mng_ball_stat_data          tab_dpr_d_mng_ball_stat;
-	u32 granularity_of_pe_in_dram;
+	pr_info("\n bm_bank_registers_dump:");
 
-	BM_AVAILABLE_CHECK();
+	reg_base_address =      bm.b_sys_rec_bank_d0_st[bid];
+	reg_size   =   bm_reg_size.b_sys_rec_bank_d0_st[bid];
+	reg_offset = bm_reg_offset.b_sys_rec_bank_d0_st[bid] * bid;
 
-	if ((pool >= BM_POOL_QM_MIN) && (pool <= BM_POOL_QM_MAX)) { /* QM pools */
-		granularity_of_pe_in_dram = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM;	/* 64/4 */
-	} else if ((pool >= BM_POOL_GP_MIN) && (pool <= BM_POOL_GP_MAX)) { /* GP pools */
-		if (pe_size == BM_PE_SIZE_IS_40_BITS)
-			granularity_of_pe_in_dram =
-				GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_40_BITS_IN_BYTES_IN_DRAM;	/* 64/8 */
-		else if (pe_size == BM_PE_SIZE_IS_32_BITS)
-			granularity_of_pe_in_dram =
-				GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_32_BITS_IN_BYTES_IN_DRAM;	/* 64/4 */
-		else
-			return rc;
-	} else
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_sys_rec_bank_d0_st);
+	if (rc != OK)
 		return rc;
 
-	if ((num_of_buffers % granularity_of_pe_in_dram) != 0)
-		return rc;
-	if         ((ae_thr % granularity_of_pe_in_dram) != 0)
-		return rc;
-	if         ((af_thr % granularity_of_pe_in_dram) != 0)
-		return rc;
-	if ((base_address->dma_lsb % GRANULARITY_OF_64_BYTES) != 0)
+	pr_info("\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
 		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_b_sys_rec_bank_d0_st));
 
-	if (af_thr       < ae_thr)
-		return rc;
+	pr_info("\t b%d_sys_rec_bank_d0_st.b_last_vmid_mis_alc_vmid_st = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d0_st.b_last_vmid_mis_alc_vmid_st);
+	pr_info("\t b%d_sys_rec_bank_d0_st.b_last_vmid_mis_rls_vmid_st = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d0_st.b_last_vmid_mis_rls_vmid_st);
+	pr_info("\t b%d_sys_rec_bank_d0_st.b_last_vmid_mis_alc_pid_st  = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d0_st.b_last_vmid_mis_alc_pid_st);
+	pr_info("\t b%d_sys_rec_bank_d0_st.b_last_vmid_mis_rls_pid_st  = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d0_st.b_last_vmid_mis_rls_pid_st);
 
-	if ((pool            <            BM_POOL_MIN) || (pool            >            BM_POOL_MAX))
-		return rc;
-	if ((pool            >         BM_POOL_QM_MAX) && (pool            <         BM_POOL_GP_MIN))
-		return rc; /* pools 4, 5, 6, 7 don't exist */
-	if ((pool == 0) || (pool == 1)) {
-		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers >  BM_NUM_OF_BUFFERS_QM_GPM_MAX))
-			return rc;
-	} else if ((pool == 2) || (pool == 3)) {
-		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers > BM_NUM_OF_BUFFERS_QM_DRAM_MAX))
-			return rc;
-	} else if ((pool >= BM_POOL_GP_MIN) && (pool <= BM_POOL_GP_MAX)) {
-		if ((num_of_buffers < BM_NUM_OF_BUFFERS_GP_MIN) || (num_of_buffers >      BM_NUM_OF_BUFFERS_GP_MAX))
-			return rc; /* pools 4, 5, 6, 7 don't exist */
-	} else
-		return rc;
+	reg_base_address =      bm.b_sys_rec_bank_d1_st[bid];
+	reg_size   =   bm_reg_size.b_sys_rec_bank_d1_st[bid];
+	reg_offset = bm_reg_offset.b_sys_rec_bank_d1_st[bid] * bid;
 
-	if ((pe_size         != BM_PE_SIZE_IS_32_BITS) && (pe_size         != BM_PE_SIZE_IS_40_BITS))
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_sys_rec_bank_d1_st);
+	if (rc != OK)
 		return rc;
 
-	if ((base_address->dma_msb < BM_DRAM_ADDRESS_MIN_MSB) ||
-		(base_address->dma_msb > BM_DRAM_ADDRESS_MAX_MSB))
-		return rc;
-	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MIN_MSB) &&
-		(base_address->dma_lsb <  BM_DRAM_ADDRESS_MIN_LSB))
-		return rc;
-	if ((base_address->dma_msb == BM_DRAM_ADDRESS_MAX_MSB) &&
-		(base_address->dma_lsb >  BM_DRAM_ADDRESS_MAX_LSB))
-		return rc;
-	if ((ae_thr          < BM_AE_THR_MIN(num_of_buffers)) || (ae_thr          > BM_AE_THR_MAX(num_of_buffers)))
-		return rc;
-	if ((af_thr          < BM_AF_THR_MIN(num_of_buffers)) || (af_thr          > BM_AF_THR_MAX(num_of_buffers)))
+	pr_info("\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
 		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_b_sys_rec_bank_d1_st));
 
-	pid       = (int)pool;
-	bid       = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
+	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_vmid_mis_alc_src_st = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d1_st.b_last_vmid_mis_alc_src_st);
+	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_vmid_mis_rls_src_st = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d1_st.b_last_vmid_mis_rls_src_st);
+	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_alc_dis_pool_src_st = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d1_st.b_last_alc_dis_pool_src_st);
+	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_rls_dis_pool_src_st = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d1_st.b_last_rls_dis_pool_src_st);
+	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_alc_dis_pool_pid_st = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d1_st.b_last_alc_dis_pool_pid_st);
+	pr_info("\t b%d_sys_rec_bank_d1_st.b_last_rls_dis_pool_pid_st = 0x%08X\n",
+				bid, reg_b_sys_rec_bank_d1_st.b_last_rls_dis_pool_pid_st);
 
-	reg_base_address =      bm.dpr_d_mng_ball_stat;
-	reg_size   =   bm_reg_size.dpr_d_mng_ball_stat;
-	reg_offset = bm_reg_offset.dpr_d_mng_ball_stat * BM_PID_TO_GLOBAL_POOL_IDX(pid);
+	reg_base_address =      bm.b_bank_req_fifos_st;
+	reg_size   =   bm_reg_size.b_bank_req_fifos_st;
+	reg_offset = bm_reg_offset.b_bank_req_fifos_st * bid;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_d_mng_ball_stat);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_bank_req_fifos_st);
 	if (rc != OK)
 		return rc;
 
-	tab_dpr_d_mng_ball_stat.dram_start_msb = base_address->dma_msb;
-	tab_dpr_d_mng_ball_stat.dram_start_lsb = base_address->dma_lsb;
-	if (bid == 0) {
-		dram_ae_thr = BM_QM_PE_UNITS_TO_BYTES(ae_thr);
-		dram_af_thr = BM_QM_PE_UNITS_TO_BYTES(af_thr);
-		dram_size   = BM_QM_PE_UNITS_TO_BYTES(num_of_buffers);
-	} else if (bid != 0) {
-		dram_ae_thr = BM_GP_PE_UNITS_TO_BYTES(ae_thr,         pe_size);
-		dram_af_thr = BM_GP_PE_UNITS_TO_BYTES(af_thr,         pe_size);
-		dram_size   = BM_GP_PE_UNITS_TO_BYTES(num_of_buffers, pe_size);
-	} else
-		return rc;
-
-	tab_dpr_d_mng_ball_stat.dram_ae_thr	= dram_ae_thr / UNIT_OF_64_BYTES;
-	tab_dpr_d_mng_ball_stat.dram_af_thr	= dram_af_thr / UNIT_OF_64_BYTES;
-	tab_dpr_d_mng_ball_stat.dram_size   = dram_size / UNIT_OF_64_BYTES;
-	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_d_mng_ball_stat);
-	return rc;
-}
-
-int bm_pool_fill_level_set(u32 pool, u32 num_of_buffers, u32 pe_size, u32 quick_init)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local, dram_fill;
-	struct bm_tpr_drw_mng_ball_dyn_data         tab_tpr_drw_mng_ball_dyn;
-	u32 granularity_of_pe_in_dram;
-
-	BM_AVAILABLE_CHECK();
-
-	if ((pool >= BM_POOL_QM_MIN) && (pool <= BM_POOL_QM_MAX)) { /* QM pools */
-		granularity_of_pe_in_dram = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_DRAM;	/* 64/4 */
-	} else if ((pool >= BM_POOL_GP_MIN) && (pool <= BM_POOL_GP_MAX)) { /* GP pools */
-		if (pe_size == BM_PE_SIZE_IS_40_BITS)
-			granularity_of_pe_in_dram =
-				GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_40_BITS_IN_BYTES_IN_DRAM;	/* 64/8 */
-		else if (pe_size == BM_PE_SIZE_IS_32_BITS)
-			granularity_of_pe_in_dram =
-				GRANULARITY_OF_64_BYTES / GP_PE_SIZE_OF_32_BITS_IN_BYTES_IN_DRAM;	/* 64/4 */
-		else
-			return rc;
-	} else
-		return rc;
-
-	if ((num_of_buffers % granularity_of_pe_in_dram) != 0)
-		return rc;
-
-	if ((pool           <       BM_POOL_MIN) || (pool           >            BM_POOL_MAX))
-		return rc;
-	if ((pool           >    BM_POOL_QM_MAX) && (pool           <         BM_POOL_GP_MIN))
-		return rc; /* pools 4, 5, 6, 7 don't exist */
-	if ((pool == 0) || (pool == 1)) {
-		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers >  BM_NUM_OF_BUFFERS_QM_GPM_MAX))
-			return rc;
-	} else if ((pool == 2) || (pool == 3)) {
-		if ((num_of_buffers < BM_NUM_OF_BUFFERS_QM_MIN) || (num_of_buffers > BM_NUM_OF_BUFFERS_QM_DRAM_MAX))
-			return rc;
-	} else if ((pool >= BM_POOL_GP_MIN) && (pool <= BM_POOL_GP_MAX)) {
-		if ((num_of_buffers < BM_NUM_OF_BUFFERS_GP_MIN) || (num_of_buffers >      BM_NUM_OF_BUFFERS_GP_MAX))
-			return rc; /* pools 4, 5, 6, 7 don't exist */
-	} else
-		return rc;
-
-	if ((pe_size   != BM_PE_SIZE_IS_32_BITS) && (pe_size        != BM_PE_SIZE_IS_40_BITS))
-		return rc;
-	if ((quick_init     < BM_QUICK_INIT_MIN) || (quick_init     >      BM_QUICK_INIT_MAX))
-		return rc;
-
-	pid       = (int)pool;
-	bid       = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
-
-	reg_base_address =      bm.tpr_drw_mng_ball_dyn;
-	reg_size   =   bm_reg_size.tpr_drw_mng_ball_dyn;
-	reg_offset = bm_reg_offset.tpr_drw_mng_ball_dyn * BM_PID_TO_GLOBAL_POOL_IDX(pid);
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_drw_mng_ball_dyn);
+	pr_info("\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_b_bank_req_fifos_st));
 
-	if (bid == 0)
-		dram_fill	= BM_QM_PE_UNITS_TO_BYTES(num_of_buffers);
-	if (bid != 0)
-		dram_fill	= BM_GP_PE_UNITS_TO_BYTES(num_of_buffers, pe_size);
-	if (quick_init == 1) /* quick init is on */
-		tab_tpr_drw_mng_ball_dyn.dram_fill	= dram_fill/UNIT_OF__8_BYTES;
-	else /* quick init is off */
-		tab_tpr_drw_mng_ball_dyn.dram_fill	= 0;
-	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_drw_mng_ball_dyn);
-	return rc;
-}
-
-int bm_pool_enable(u32 pool, u32 quick_init)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local;
-	struct bm_pool_conf_b0  reg_b0_pool_conf;
-	struct bm_pool_conf_bgp reg_bgp_pool_conf;
-
-	BM_AVAILABLE_CHECK();
-
-	if ((pool       <       BM_POOL_MIN) || (pool       >       BM_POOL_MAX))
-		return rc;
-	if ((pool       >    BM_POOL_QM_MAX) && (pool       <    BM_POOL_GP_MIN))
-		return rc; /* pools 4, 5, 6, 7 don't exist */
-	if ((quick_init < BM_QUICK_INIT_MIN) || (quick_init > BM_QUICK_INIT_MAX))
-		return rc;
-
-	pid = (int)pool;
-	bid = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
+	pr_info("\t b%d_bank_req_fifos_st.b_alc_fifo_fill_st = 0x%08X\n",
+				bid, reg_b_bank_req_fifos_st.b_alc_fifo_fill_st);
+	pr_info("\t b%d_bank_req_fifos_st.b_rls_fifo_fill_st = 0x%08X\n",
+				bid, reg_b_bank_req_fifos_st.b_rls_fifo_fill_st);
+	pr_info("\t b%d_bank_req_fifos_st.b_so_fifo_fill_st: = 0x%08X\n",
+				bid, reg_b_bank_req_fifos_st.b_so_fifo_fill_st);
+	pr_info("\t b%d_bank_req_fifos_st.b_si_fifo_fill_st: = 0x%08X\n",
+				bid, reg_b_bank_req_fifos_st.b_si_fifo_fill_st);
 
-	reg_base_address =      bm.b_pool_n_conf[bid];
-	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
-	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
+	if  (bid == 0) {	/* QM pools */
+		reg_base_address =      bm.b0_past_alc_fifos_st;
+		reg_size   =   bm_reg_size.b0_past_alc_fifos_st;
+		reg_offset = bm_reg_offset.b0_past_alc_fifos_st * bid;
 
-	if  (bid == 0) { /* QM pools */
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_past_alc_fifos_st);
 		if (rc != OK)
 			return rc;
 
-		reg_b0_pool_conf.pool_enable		= ON;
-		reg_b0_pool_conf.pool_quick_init	= quick_init;
-		rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
+		pr_info("\n");
+		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 		if (rc != OK)
 			return rc;
-	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) { /* QP pools */
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_b0_past_alc_fifos_st));
+
+		pr_info("\t b0_past_alc_fifos_st.b0_past_alc_fifo_fill_st     = 0x%08X\n",
+				reg_b0_past_alc_fifos_st.b0_past_alc_fifo_fill_st);
+		pr_info("\t b0_past_alc_fifos_st.b0_past_alc_ppe_fifo_fill_st = 0x%08X\n",
+				reg_b0_past_alc_fifos_st.b0_past_alc_ppe_fifo_fill_st);
+	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) {	/* QP pools */
+		reg_base_address =      bm.bgp_past_alc_fifos_st;
+		reg_size   =   bm_reg_size.bgp_past_alc_fifos_st;
+		reg_offset = bm_reg_offset.bgp_past_alc_fifos_st * bid;
+
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_past_alc_fifos_st);
 		if (rc != OK)
 			return rc;
 
-		reg_bgp_pool_conf.pool_enable		= ON;
-		reg_bgp_pool_conf.pool_quick_init	= quick_init;
-		rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+		pr_info("\n");
+		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 		if (rc != OK)
 			return rc;
+		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_bgp_past_alc_fifos_st));
+
+		pr_info("\t bgp_past_alc_fifos_st.b1_past_alc_fifo_fill_st = 0x%08X\n",
+				reg_bgp_past_alc_fifos_st.b1_past_alc_fifo_fill_st);
+		pr_info("\t bgp_past_alc_fifos_st.b2_past_alc_fifo_fill_st = 0x%08X\n",
+				reg_bgp_past_alc_fifos_st.b2_past_alc_fifo_fill_st);
+		pr_info("\t bgp_past_alc_fifos_st.b3_past_alc_fifo_fill_st = 0x%08X\n",
+				reg_bgp_past_alc_fifos_st.b3_past_alc_fifo_fill_st);
+		pr_info("\t bgp_past_alc_fifos_st.b4_past_alc_fifo_fill_st = 0x%08X\n",
+				reg_bgp_past_alc_fifos_st.b4_past_alc_fifo_fill_st);
 	} else {
 		rc = -BM_INPUT_NOT_IN_RANGE;
 		return rc;
 	}
 
-	rc = OK;
-	return rc;
-}
-
-int bm_gp_pool_pe_size_set(u32 pool, u32 pe_size)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local;
-	struct bm_pool_conf_bgp reg_bgp_pool_conf;
-
-	BM_AVAILABLE_CHECK();
+	reg_base_address =      bm.b0_rls_wrp_ppe_fifos_st;
+	reg_size   =   bm_reg_size.b0_rls_wrp_ppe_fifos_st;
+	reg_offset = bm_reg_offset.b0_rls_wrp_ppe_fifos_st * bid;
 
-	if ((pool    < BM_POOL_GP_MIN) || (pool    > BM_POOL_GP_MAX))
-		return rc;
-	if ((pe_size != BM_PE_SIZE_IS_32_BITS) && (pe_size != BM_PE_SIZE_IS_40_BITS))
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_rls_wrp_ppe_fifos_st);
+	if (rc != OK)
 		return rc;
 
-	pid = (int)pool;
-	bid = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
-
-	reg_base_address =      bm.b_pool_n_conf[bid];
-	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
-	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+	pr_info("\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_b0_rls_wrp_ppe_fifos_st));
 
-	reg_bgp_pool_conf.pe_size	= pe_size;
-	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_0_fill_st = 0x%08X\n",
+			reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_0_fill_st);
+	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_1_fill_st = 0x%08X\n",
+			reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_1_fill_st);
+	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_2_fill_st = 0x%08X\n",
+			reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_2_fill_st);
+	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_3_fill_st = 0x%08X\n",
+			reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_3_fill_st);
+
+	rc = OK;
 	return rc;
 }
 
-int bm_gp_pool_pair_set(u32 pool, u32 pool_pair)
+int bm_cache_memory_dump(u32 bank)
 {
 	u32 reg_base_address, reg_size, reg_offset;
 	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local;
-	struct bm_pool_conf_bgp reg_bgp_pool_n_conf;
+	u32 bid, line;
+	char reg_name[50];
+
+	struct bm_cache_b0_mem_data     reg_cache_b0_data;
+	struct bm_cache_bgp_data        reg_cache_bgp_data;
 
 	BM_AVAILABLE_CHECK();
 
-	if ((pool      <   BM_POOL_GP_MIN) || (pool      >   BM_POOL_GP_MAX))
+	if ((bank            <     BM_BANK_MIN) || (bank            >     BM_BANK_MAX))
 		return rc;
-	if ((pool_pair < BM_POOL_PAIR_MIN) || (pool_pair > BM_POOL_PAIR_MAX))
-		return rc;
-
-	pid = (int)pool;
-	bid = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
-
-	reg_base_address =      bm.b_pool_n_conf[bid];
-	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
-	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_n_conf);
-	if (rc != OK)
-		return rc;
-
-	reg_bgp_pool_n_conf.pool_in_pairs	= pool_pair;
-	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_n_conf);
-	return rc;
-}
-
-int bm_pool_cache_set(u32 pool, u32 cache_vmid, u32 cache_attr, u32 cache_so_thr, u32 cache_si_thr,
-						u32 cache_num_of_buffers)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local, pid_temp, pid_local_temp;
-	u32 granularity_of_pe_in_cache, cache_start, cache_end, cache_end_max, pool_enable;
-	struct bm_pool_conf_b0    reg_b0_pool_conf;
-	struct bm_pool_conf_bgp   reg_bgp_pool_conf;
-	struct bm_c_mng_stat_data tab_dpr_c_mng_stat;
-
-	BM_AVAILABLE_CHECK();
-
-	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) /* QM pools */
-		granularity_of_pe_in_cache = GRANULARITY_OF_64_BYTES / QM_PE_SIZE_IN_BYTES_IN_CACHE;	/* 64/4 */
-	else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) /* GM pools */
-		granularity_of_pe_in_cache = GRANULARITY_OF_64_BYTES / GP_PE_SIZE_IN_BYTES_IN_CACHE;	/* 64/8 */
-	else
-		return rc;
-
-	if ((cache_num_of_buffers % granularity_of_pe_in_cache) != 0)
-		return rc;
-	if (cache_so_thr < cache_si_thr + 16)
-		return rc;
-	if (cache_so_thr % 4 != 0)
-		return rc;
-	if (cache_si_thr % 4 != 0)
-		return rc;
-
-	if ((pool                 <          BM_POOL_MIN) || (pool                 >          BM_POOL_MAX))
-		return rc;
-	if ((pool                 >       BM_POOL_QM_MAX) && (pool                 <       BM_POOL_GP_MIN))
-		return rc; /* pools 4, 5, 6, 7 don't exist */
-	if ((cache_vmid           <          BM_VMID_MIN) || (cache_vmid           >          BM_VMID_MAX))
-		return rc;
-	if ((cache_attr           <    BM_CACHE_ATTR_MIN) || (cache_attr           >    BM_CACHE_ATTR_MAX))
-		return rc;
-	if ((cache_so_thr         < BM_CACHE_SO_THR_MIN) || (cache_so_thr > BM_CACHE_SO_THR_MAX(cache_num_of_buffers)))
-		return rc;
-	if ((cache_si_thr         < BM_CACHE_SI_THR_MIN) || (cache_si_thr > BM_CACHE_SI_THR_MAX(cache_num_of_buffers)))
-		return rc;
-	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) { /* QM pools */
-		if ((cache_num_of_buffers < BM_CACHE_NUM_OF_BUFFERS_QM_MIN) ||
-			(cache_num_of_buffers > BM_CACHE_NUM_OF_BUFFERS_QM_MAX))
-			return rc;
-	} else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) { /* GM pools */
-		if ((cache_num_of_buffers < BM_CACHE_NUM_OF_BUFFERS_GP_MIN) ||
-			(cache_num_of_buffers > BM_CACHE_NUM_OF_BUFFERS_GP_MAX))
-			return rc;
-	} else
-		return rc;
-
-	pid = pool;
-	bid = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
-
-	cache_end_max = 0;
 
-	for (pid_temp = BM_POOL_MIN; pid_temp < BM_POOL_MAX; pid_temp++) {
-		if (BM_PID_TO_BANK(pid_temp) != bid)
-			continue; /* run only on pools that are in bank */
-		if ((pid_temp > BM_POOL_QM_MAX) && (pid_temp < BM_POOL_GP_MIN))
-			continue; /* pools 4, 5, 6, 7 don't exist */
+	bid       = bank;
 
-		pid_local_temp = BM_PID_TO_PID_LOCAL(pid_temp);
+	pr_info("\n bm_cache_memory_dump:");
 
-		reg_base_address =      bm.b_pool_n_conf[bid];
-		reg_size   =   bm_reg_size.b_pool_n_conf[bid];
-		reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local_temp;
+	if  (bid == 0) {	/* QM pools */
+		for (line = 0; line < BM_NUM_OF_LINE_QM; line++) {
+			reg_base_address =      bm.sram_b_cache[bid];
+			reg_size   =   bm_reg_size.sram_b_cache[bid];
+			reg_offset = bm_reg_offset.sram_b_cache[bid] * line;
 
-		if  (bid == 0) { /* QM pools */
-			rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
+			rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_cache_b0_data);
 			if (rc != OK)
 				return rc;
-			pool_enable = reg_b0_pool_conf.pool_enable;
-		} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) { /* GP pools */
-			rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+
+			pr_info("\n");
+			rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 			if (rc != OK)
 				return rc;
-			pool_enable = reg_bgp_pool_conf.pool_enable;
-		} else {
-			rc = -BM_INPUT_NOT_IN_RANGE;
-			return rc;
-		}
-
-		if (pool_enable == OFF)
-			continue;	/* pool pid_local_temp is not enabled */
-
-		reg_base_address =      bm.dpr_c_mng_stat[bid];
-		reg_size   =   bm_reg_size.dpr_c_mng_stat[bid];
-		reg_offset = bm_reg_offset.dpr_c_mng_stat[bid] * pid_local_temp;
-
-		rc = bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_c_mng_stat);
-		if (rc != OK)
-			return rc;
-		cache_end_max = MV_MAX(cache_end_max, tab_dpr_c_mng_stat.cache_end * UNIT_OF_64_BYTES);
-	}
+			pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+				reg_base_address + reg_offset, *((u32 *)&reg_cache_b0_data));
 
+			pr_info("\t line %04d: sram_b%d_cache.cache_b0_data_0 = 0x%08X\n",
+						line, bid, reg_cache_b0_data.cache_b0_data_0);
+			pr_info("\t line %04d: sram_b%d_cache.cache_b0_data_1 = 0x%08X\n",
+						line, bid, reg_cache_b0_data.cache_b0_data_1);
+			pr_info("\t line %04d: sram_b%d_cache.cache_b0_data_2 = 0x%08X\n",
+						line, bid, reg_cache_b0_data.cache_b0_data_2);
+			pr_info("\t line %04d: sram_b%d_cache.cache_b0_data_3 = 0x%08X\n",
+						line, bid, reg_cache_b0_data.cache_b0_data_3);
+		}
+	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) {	/* QP pools */
+		pr_info("\n");
 
-	if ((cache_end_max   < BM_CACHE_END_MIN) || (cache_end_max    >      BM_CACHE_END_MAX))
-		return rc;
+		for (line = 0; line < BM_NUM_OF_LINE_GP; line++) {
+			reg_base_address =      bm.sram_b_cache[bid];
+			reg_size   =   bm_reg_size.sram_b_cache[bid];
+			reg_offset = bm_reg_offset.sram_b_cache[bid] * line;
 
-	reg_base_address =      bm.dpr_c_mng_stat[bid];
-	reg_size   =   bm_reg_size.dpr_c_mng_stat[bid];
-	reg_offset = bm_reg_offset.dpr_c_mng_stat[bid] * pid_local;
+			rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_cache_bgp_data);
+			if (rc != OK)
+				return rc;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_c_mng_stat);
-	if (rc != OK)
-		return rc;
-	cache_start  = cache_end_max + 1;
-	cache_end    = cache_start + (cache_num_of_buffers / granularity_of_pe_in_cache) - 1;
+			pr_info("\n");
+			rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+			if (rc != OK)
+				return rc;
+			pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_cache_bgp_data));
 
-	if ((cache_start < BM_CACHE_START_MIN) || (cache_start  > BM_CACHE_START_MAX))
-		return rc;
-	if ((cache_end   <   BM_CACHE_END_MIN) || (cache_end    >   BM_CACHE_END_MAX))
+			pr_info("\t line %04d: sram_b%d_cache.cache_bgp_data = 0x%02X_%08X\n",
+				line, bid, reg_cache_bgp_data.cache_bgp_data_msb,
+							reg_cache_bgp_data.cache_bgp_data_lsb);
+		}
+	} else {
+		rc = -BM_INPUT_NOT_IN_RANGE;
 		return rc;
+	}
 
-	tab_dpr_c_mng_stat.cache_start  = cache_start / UNIT_OF_64_BYTES;
-	tab_dpr_c_mng_stat.cache_end    = cache_end   / UNIT_OF_64_BYTES;
-	tab_dpr_c_mng_stat.cache_si_thr = cache_si_thr;
-	tab_dpr_c_mng_stat.cache_so_thr = cache_so_thr;
-	tab_dpr_c_mng_stat.cache_attr   = cache_attr;
-	tab_dpr_c_mng_stat.cache_vmid   = cache_vmid;
-	rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&tab_dpr_c_mng_stat);
+	rc = OK;
 	return rc;
 }
 
-int bm_pool_disable(u32 pool)
+int bm_idle_debug(void)
 {
 	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local;
-	struct bm_pool_conf_b0  reg_b0_pool_conf;
-	struct bm_pool_conf_bgp reg_bgp_pool_conf;
+	int rc = !OK;
+	u32 bid;
+	struct bm_b_bank_req_fifos_st          reg_b_bank_req_fifos_st;
+	struct bm_b0_past_alc_fifos_st         reg_b0_past_alc_fifos_st;
+	struct bm_bgp_past_alc_fifos_st        reg_bgp_past_alc_fifos_st;
+	struct bm_b0_rls_wrp_ppe_fifos_st      reg_b0_rls_wrp_ppe_fifos_st;
+	struct bm_dm_axi_fifos_st              reg_dm_axi_fifos_st;
+	struct bm_drm_pend_fifo_st             reg_drm_pend_fifo_st;
+	struct bm_dm_axi_wr_pend_fifo_st       reg_dm_axi_wr_pend_fifo_st;
+	char reg_name[50];
 
 	BM_AVAILABLE_CHECK();
 
-	if ((pool  <    BM_POOL_MIN) || (pool  >     BM_POOL_MAX))
-		return rc;
-	if ((pool  > BM_POOL_QM_MAX) && (pool  < BM_POOL_GP_MIN))
-		return rc; /* pools 4, 5, 6, 7 don't exist */
-
-	pid = (int)pool;
-	bid = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
-
-	reg_base_address =      bm.b_pool_n_conf[bid];
-	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
-	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
+	for (bid = 0; bid < BM_NUMBER_OF_BANKS; bid++) {
+		reg_base_address =      bm.b_bank_req_fifos_st;
+		reg_size   =   bm_reg_size.b_bank_req_fifos_st;
+		reg_offset = bm_reg_offset.b_bank_req_fifos_st * bid;
 
-	if  (bid == 0) { /* QM pools */
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
-		if (rc != OK)
-			return rc;
-		reg_b0_pool_conf.pool_enable = OFF;
-		rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
-		if (rc != OK)
-			return rc;
-	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) { /* QP pools */
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_bank_req_fifos_st);
 		if (rc != OK)
 			return rc;
 
-		reg_bgp_pool_conf.pool_enable = OFF;
-		rc = bm_register_write(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
+		pr_info("\n for bank = %d:\n", bid);
+		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 		if (rc != OK)
 			return rc;
-	} else {
-		rc = -BM_INPUT_NOT_IN_RANGE;
-		return rc;
-	}
+		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_b_bank_req_fifos_st));
 
-	rc = OK;
-	return rc;
-}
-/* Get if pool is enabled */
-int bm_pool_enabled_get(u32 pool, u32 *enabled, u32 *quick_init)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = -BM_INPUT_NOT_IN_RANGE;
-	u32 pid, bid, pid_local;
-	struct bm_pool_conf_b0  reg_b0_pool_conf;
-	struct bm_pool_conf_bgp reg_bgp_pool_conf;
+		pr_info("\t b%d_bank_req_fifos_st.b_alc_fifo_fill_st = 0x%08X\n",
+					bid, reg_b_bank_req_fifos_st.b_alc_fifo_fill_st);
+		pr_info("\t b%d_bank_req_fifos_st.b_rls_fifo_fill_st = 0x%08X\n",
+					bid, reg_b_bank_req_fifos_st.b_rls_fifo_fill_st);
+		pr_info("\t b%d_bank_req_fifos_st.b_so_fifo_fill_st  = 0x%08X\n",
+					bid, reg_b_bank_req_fifos_st.b_so_fifo_fill_st);
+		pr_info("\t b%d_bank_req_fifos_st.b_si_fifo_fill_st  = 0x%08X\n",
+					bid, reg_b_bank_req_fifos_st.b_si_fifo_fill_st);
+	}
 
-	BM_AVAILABLE_CHECK();
+	reg_base_address =      bm.b0_past_alc_fifos_st;
+	reg_size   =   bm_reg_size.b0_past_alc_fifos_st;
+	reg_offset = bm_reg_offset.b0_past_alc_fifos_st * 0;
 
-	if ((pool       <       BM_POOL_MIN) || (pool       >       BM_POOL_MAX))
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_past_alc_fifos_st);
+	if (rc != OK)
 		return rc;
-	if ((pool       >    BM_POOL_QM_MAX) && (pool       <    BM_POOL_GP_MIN))
-		return rc; /* pools 4, 5, 6, 7 don't exist */
 
-	pid = (int)pool;
-	bid = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
+	pr_info("\n for bank 0:\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_b0_past_alc_fifos_st));
 
-	reg_base_address =      bm.b_pool_n_conf[bid];
-	reg_size   =   bm_reg_size.b_pool_n_conf[bid];
-	reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
+	pr_info("\t b0_past_alc_fifos_st.b0_past_alc_fifo_fill_st     = 0x%08X\n",
+				reg_b0_past_alc_fifos_st.b0_past_alc_fifo_fill_st);
+	pr_info("\t b0_past_alc_fifos_st.b0_past_alc_ppe_fifo_fill_st = 0x%08X\n",
+				reg_b0_past_alc_fifos_st.b0_past_alc_ppe_fifo_fill_st);
 
-	if  (bid == 0) { /* QM pools */
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_pool_conf);
-		if (rc != OK)
-			return rc;
-		*enabled = reg_b0_pool_conf.pool_enable;
-		*quick_init = reg_b0_pool_conf.pool_quick_init;
-	} else if ((bid == 1) || (bid == 2) || (bid == 3) || (bid == 4)) { /* QP pools */
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
-		if (rc != OK)
-			return rc;
+	reg_base_address =      bm.bgp_past_alc_fifos_st;
+	reg_size   =   bm_reg_size.bgp_past_alc_fifos_st;
+	reg_offset = bm_reg_offset.bgp_past_alc_fifos_st * 0;
 
-		*enabled = reg_bgp_pool_conf.pool_enable;
-		*quick_init = reg_bgp_pool_conf.pool_quick_init;
-	} else {
-		rc = -BM_INPUT_NOT_IN_RANGE;
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_past_alc_fifos_st);
+	if (rc != OK)
 		return rc;
-	}
-
-	rc = OK;
-	return rc;
-}
-/* Get pe_size */
-int bm_pool_pe_size_get(u32 pool, u32 *pe_size)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = OK;
-	u32 pid, bid, pid_local;
-	struct bm_pool_conf_bgp reg_bgp_pool_conf;
-
-	BM_AVAILABLE_CHECK();
-
-	if ((pool            <     BM_POOL_MIN) || (pool            >    BM_POOL_MAX))
-		return -BM_INPUT_NOT_IN_RANGE;
-	if ((pool            >  BM_POOL_QM_MAX) && (pool            < BM_POOL_GP_MIN))
-		return -BM_INPUT_NOT_IN_RANGE; /* pools 4, 5, 6, 7 don't exist */
-
-	pid = (int)pool;
-	bid = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
-
-	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) { /* QM pools */
-		*pe_size = BM_PE_SIZE_IS_32_BITS;
-	} else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) { /* GM pools */
-		reg_base_address =      bm.b_pool_n_conf[bid];
-		reg_size   =   bm_reg_size.b_pool_n_conf[bid];
-		reg_offset = bm_reg_offset.b_pool_n_conf[bid] * pid_local;
 
-		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_bgp_pool_conf);
-		if (rc != OK)
-			return rc;
-
-		*pe_size = reg_bgp_pool_conf.pe_size;
-	} else
+	pr_info("\n for banks 1,2,3,4:\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
 		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_bgp_past_alc_fifos_st));
 
-	return rc;
-}
+	pr_info("\t bgp_past_alc_fifos_st.b1_past_alc_fifo_fill_st = 0x%08X\n",
+				reg_bgp_past_alc_fifos_st.b1_past_alc_fifo_fill_st);
+	pr_info("\t bgp_past_alc_fifos_st.b2_past_alc_fifo_fill_st = 0x%08X\n",
+				reg_bgp_past_alc_fifos_st.b2_past_alc_fifo_fill_st);
+	pr_info("\t bgp_past_alc_fifos_st.b3_past_alc_fifo_fill_st = 0x%08X\n",
+				reg_bgp_past_alc_fifos_st.b3_past_alc_fifo_fill_st);
+	pr_info("\t bgp_past_alc_fifos_st.b4_past_alc_fifo_fill_st = 0x%08X\n",
+				reg_bgp_past_alc_fifos_st.b4_past_alc_fifo_fill_st);
 
-/* Get pool pointers - internal registers */
-int bm_pool_pointer_get(u32 pool, u32 *rd_ptr, u32 *wr_ptr)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = OK;
-	u32 pid, bid, pid_local;
-	u32 pe_size;
-	struct bm_tpr_dro_mng_ball_dyn_data tab_tpr_dro_mng_ball_dyn_data;
+	reg_base_address =      bm.b0_rls_wrp_ppe_fifos_st;
+	reg_size   =   bm_reg_size.b0_rls_wrp_ppe_fifos_st;
+	reg_offset = bm_reg_offset.b0_rls_wrp_ppe_fifos_st * 0;
 
-	BM_AVAILABLE_CHECK();
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b0_rls_wrp_ppe_fifos_st);
+	if (rc != OK)
+		return rc;
 
-	if ((pool            <     BM_POOL_MIN) || (pool            >    BM_POOL_MAX))
-		return -BM_INPUT_NOT_IN_RANGE;
-	if ((pool            >  BM_POOL_QM_MAX) && (pool            < BM_POOL_GP_MIN))
-		return -BM_INPUT_NOT_IN_RANGE; /* pools 4, 5, 6, 7 don't exist */
+	pr_info("\n for bank 0:\n");
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_b0_rls_wrp_ppe_fifos_st));
 
-	pid = (int)pool;
-	bid = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
+	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_0_fill_st = 0x%08X\n",
+					reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_0_fill_st);
+	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_1_fill_st = 0x%08X\n",
+					reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_1_fill_st);
+	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_2_fill_st = 0x%08X\n",
+					reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_2_fill_st);
+	pr_info("\t b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_3_fill_st = 0x%08X\n",
+					reg_b0_rls_wrp_ppe_fifos_st.rls_wrp_ppe_fifo_3_fill_st);
 
-	reg_base_address =      bm.tpr_dro_mng_ball_dyn;
-	reg_size   =   bm_reg_size.tpr_dro_mng_ball_dyn;
-	reg_offset = bm_reg_offset.tpr_dro_mng_ball_dyn * BM_PID_TO_GLOBAL_POOL_IDX(pid);
+	pr_info("\n for all banks:\n");
+	reg_base_address =      bm.dm_axi_fifos_st;
+	reg_size   =   bm_reg_size.dm_axi_fifos_st;
+	reg_offset = bm_reg_offset.dm_axi_fifos_st * 0;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_dro_mng_ball_dyn_data);
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dm_axi_fifos_st);
 	if (rc != OK)
 		return rc;
 
-	/*
-	 * r/w pointer of BM to pool is given in 64 bits unit. starting from 0
-	 * QM PE's are in 32bits so we multiply by 2 to get number of PE's
-	 * GP PE's can either be in 32bits or in 40 bits
-	*/
-	rc = bm_pool_pe_size_get(pool, &pe_size);
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
-	if (pe_size == BM_PE_SIZE_IS_32_BITS) {
-		*rd_ptr = tab_tpr_dro_mng_ball_dyn_data.dram_rd_ptr * 2;
-		*wr_ptr = tab_tpr_dro_mng_ball_dyn_data.dram_wr_ptr * 2;
-	} else if (pe_size == BM_PE_SIZE_IS_40_BITS) {
-		*rd_ptr = tab_tpr_dro_mng_ball_dyn_data.dram_rd_ptr;
-		*wr_ptr = tab_tpr_dro_mng_ball_dyn_data.dram_wr_ptr;
-	} else
-		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_dm_axi_fifos_st));
 
-	return rc;
-}
-/* Get interupt cause for pool capacity*/
-int bm_bank_intr_pool_fill_get(u32 bank, u32 *ne, u32 *ae, u32 *af)
-{
-	u32 reg_base_address, reg_size, reg_offset;
-	int rc = OK;
-	u32 bid;
+	pr_info("\t dm_axi_fifos_st.dwm_waddr_fifo_fill_st = 0x%08X\n",
+						reg_dm_axi_fifos_st.dwm_waddr_fifo_fill_st);
+	pr_info("\t dm_axi_fifos_st.dwm_wdata_fifo_fill_st = 0x%08X\n",
+						reg_dm_axi_fifos_st.dwm_wdata_fifo_fill_st);
+	pr_info("\t dm_axi_fifos_st.drm_raddr_fifo_fill_st = 0x%08X\n",
+						reg_dm_axi_fifos_st.drm_raddr_fifo_fill_st);
+	pr_info("\t dm_axi_fifos_st.drm_rdata_fifo_fill_st = 0x%08X\n",
+						reg_dm_axi_fifos_st.drm_rdata_fifo_fill_st);
 
-	BM_AVAILABLE_CHECK();
+	reg_base_address =      bm.drm_pend_fifo_st;
+	reg_size   =   bm_reg_size.drm_pend_fifo_st;
+	reg_offset = bm_reg_offset.drm_pend_fifo_st * 0;
 
-	bid = bank;
-	reg_base_address =      bm.pool_nempty_intr_cause[bid];
-	reg_size   =   bm_reg_size.pool_nempty_intr_cause[bid];
-	reg_offset = bm_reg_offset.pool_nempty_intr_cause[bid] * 0;
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_drm_pend_fifo_st);
+	if (rc != OK)
+		return rc;
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, ne);
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_drm_pend_fifo_st));
 
-	reg_base_address =      bm.dpool_ae_intr_cause[bid];
-	reg_size   =   bm_reg_size.dpool_ae_intr_cause[bid];
-	reg_offset = bm_reg_offset.dpool_ae_intr_cause[bid] * 0;
+	pr_info("\t drm_pend_fifo_st.drm_pend_fifo_fill_st = 0x%08X\n",
+					reg_drm_pend_fifo_st.drm_pend_fifo_fill_st);
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, ae);
+	reg_base_address =      bm.dm_axi_wr_pend_fifo_st;
+	reg_size   =   bm_reg_size.dm_axi_wr_pend_fifo_st;
+	reg_offset = bm_reg_offset.dm_axi_wr_pend_fifo_st * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_dm_axi_wr_pend_fifo_st);
 	if (rc != OK)
 		return rc;
 
-	reg_base_address =      bm.dpool_af_intr_cause[bid];
-	reg_size   =   bm_reg_size.dpool_af_intr_cause[bid];
-	reg_offset = bm_reg_offset.dpool_af_intr_cause[bid];
-
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, af);
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
 	if (rc != OK)
 		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_dm_axi_wr_pend_fifo_st));
+
+	pr_info("\t dm_axi_wr_pend_fifo_st.axi_wr_pend_fifo_fill_st = 0x%08X\n",
+			reg_dm_axi_wr_pend_fifo_st.axi_wr_pend_fifo_fill_st);
 
+	rc = OK;
 	return rc;
 }
-/* Get cache fill */
-int bm_pool_cache_fill_get(u32 pool, u32 *rd_ptr, u32 *wr_ptr, u32 *fill_min, u32 *fill_max)
+
+int bm_error_dump(void)
 {
 	u32 reg_base_address, reg_size, reg_offset;
-	int rc = OK;
-	u32 bid, pid, pid_local;
-	struct bm_c_mng_dyn_data            tab_tpr_c_mng_dyn;
+	int rc = !OK;
+	u32 bid;
+	struct bm_b_sys_rec_bank_intr_cause     reg_b_sys_rec_bank_intr_cause;
+	struct bm_sw_debug_rec_intr_cause       reg_sw_debug_rec_intr_cause;
+	struct bm_sys_nrec_common_intr_cause    reg_sys_nrec_common_intr_cause;
+	struct bm_error_intr_cause              reg_error_intr_cause;
+	struct bm_func_intr_cause               reg_func_intr_cause;
+	struct bm_ecc_err_intr_cause            reg_ecc_err_intr_cause;
+	struct bm_b_pool_nempty_intr_cause      reg_b_pool_nempty_intr_cause;
+	struct bm_b_dpool_ae_intr_cause         reg_b_dpool_ae_intr_cause;
+	struct bm_b_dpool_af_intr_cause         reg_b_dpool_af_intr_cause;
+	char reg_name[50];
 
 	BM_AVAILABLE_CHECK();
 
-	if ((pool            <     BM_POOL_MIN) || (pool            >    BM_POOL_MAX))
-		return -BM_INPUT_NOT_IN_RANGE;
-	if ((pool            >  BM_POOL_QM_MAX) && (pool            < BM_POOL_GP_MIN))
-		return -BM_INPUT_NOT_IN_RANGE; /* pools 4, 5, 6, 7 don't exist */
+	for (bid = 0; bid < BM_NUMBER_OF_BANKS; bid++) {
+		reg_base_address =      bm.b_sys_rec_bank_intr_cause[bid];
+		reg_size   =   bm_reg_size.b_sys_rec_bank_intr_cause[bid];
+		reg_offset = bm_reg_offset.b_sys_rec_bank_intr_cause[bid] * 0;
 
-	pid       = (int)pool;
-	bid       = BM_PID_TO_BANK(pid);
-	pid_local = BM_PID_TO_PID_LOCAL(pid);
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_sys_rec_bank_intr_cause);
+		if (rc != OK)
+			return rc;
 
-	reg_base_address =      bm.tpr_c_mng_b_dyn[bid];
-	reg_size   =   bm_reg_size.tpr_c_mng_b_dyn[bid];
-	reg_offset = bm_reg_offset.tpr_c_mng_b_dyn[bid] * pid_local;
+		pr_info("\n for bank = %d:\n", bid);
+		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+		if (rc != OK)
+			return rc;
+		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_b_sys_rec_bank_intr_cause));
 
-	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&tab_tpr_c_mng_dyn);
+		pr_info("\t b%d_sys_rec_bank_intr_cause.sys_rec_bank_intr_cause_sum = %d\n",
+					bid, reg_b_sys_rec_bank_intr_cause.sys_rec_bank_intr_cause_sum);
+		pr_info("\t b%d_sys_rec_bank_intr_cause.alc_vmid_mis_s = 0x%08X\n",
+					bid, reg_b_sys_rec_bank_intr_cause.alc_vmid_mis_s);
+		pr_info("\t b%d_sys_rec_bank_intr_cause.rls_vmid_mis_s = 0x%08X\n",
+					bid, reg_b_sys_rec_bank_intr_cause.rls_vmid_mis_s);
+		pr_info("\t b%d_sys_rec_bank_intr_cause.alc_dis_pool_s = 0x%08X\n",
+					bid, reg_b_sys_rec_bank_intr_cause.alc_dis_pool_s);
+		pr_info("\t b%d_sys_rec_bank_intr_cause.rls_dis_pool_s = 0x%08X\n",
+					bid, reg_b_sys_rec_bank_intr_cause.rls_dis_pool_s);
+	}
+
+	reg_base_address =      bm.sw_debug_rec_intr_cause;
+	reg_size   =   bm_reg_size.sw_debug_rec_intr_cause;
+	reg_offset = bm_reg_offset.sw_debug_rec_intr_cause * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sw_debug_rec_intr_cause);
 	if (rc != OK)
 		return rc;
-	/*
-	 * QM pools in each cache line there are 4 PE's (4 Bytes)
-	 * GP pools in each cache line there is 1 PE's (8 Bytes)
-	 */
-	if ((pool >= BM_POOL_QM_MIN) || (pool <= BM_POOL_QM_MAX)) { /* QM pools */
-		*fill_min = tab_tpr_c_mng_dyn.cache_fill_min * 4;
-		*fill_max = tab_tpr_c_mng_dyn.cache_fill_max * 4;
-		*rd_ptr = tab_tpr_c_mng_dyn.cache_rd_ptr * 4;
-		*wr_ptr = tab_tpr_c_mng_dyn.cache_wr_ptr * 4;
-	} else if ((pool >= BM_POOL_GP_MIN) || (pool <= BM_POOL_GP_MAX)) { /* GM pools */
-		*fill_min = tab_tpr_c_mng_dyn.cache_fill_min;
-		*fill_max = tab_tpr_c_mng_dyn.cache_fill_max;
-		*rd_ptr = tab_tpr_c_mng_dyn.cache_rd_ptr;
-		*wr_ptr = tab_tpr_c_mng_dyn.cache_wr_ptr;
-	} else
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_sw_debug_rec_intr_cause));
+
+	pr_info("\t reg_sw_debug_rec_intr_cause.sw_debug_rec_intr_cause_sum = %d\n",
+				reg_sw_debug_rec_intr_cause.sw_debug_rec_intr_cause_sum);
+	pr_info("\t reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_c_s = %d\n",
+				reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_c_s);
+	pr_info("\t reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_c_dyn_s = %d\n",
+				reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_c_dyn_s);
+	pr_info("\t reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_d_dro_s = %d\n",
+				reg_sw_debug_rec_intr_cause.rams_ctl_sw_wr_d_dro_s);
+	pr_info("\t reg_sw_debug_rec_intr_cause.qm_bm_rf_err_s = %d\n",
+				reg_sw_debug_rec_intr_cause.qm_bm_rf_err_s);
+
+	reg_base_address =      bm.sys_nrec_common_intr_cause;
+	reg_size   =   bm_reg_size.sys_nrec_common_intr_cause;
+	reg_offset = bm_reg_offset.sys_nrec_common_intr_cause * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_sys_nrec_common_intr_cause);
+	if (rc != OK)
 		return rc;
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_sys_nrec_common_intr_cause));
 
+	pr_info("\t reg_sys_nrec_common_intr_cause.sys_nrec_common_intr_cause_sum = %d\n",
+				reg_sys_nrec_common_intr_cause.sys_nrec_common_intr_cause_sum);
+	pr_info("\t reg_sys_nrec_common_intr_cause.qm_alc_pairs_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.qm_alc_pairs_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.qm_rls_pairs_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.qm_rls_pairs_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.ppe_alc_pairs_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.ppe_alc_pairs_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.ppe_rls_pairs_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.ppe_rls_pairs_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.ppe_alc_blen_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.ppe_alc_blen_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.ppe_rls_blen_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.ppe_rls_blen_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.mac_alc_pairs_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.mac_alc_pairs_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.mac_rls_pairs_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.mac_rls_pairs_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.mac_alc_pid_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.mac_alc_pid_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.mac_rls_pid_viol_s = %d\n",
+				reg_sys_nrec_common_intr_cause.mac_rls_pid_viol_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.drm_dram_err_s = %d\n",
+				reg_sys_nrec_common_intr_cause.drm_dram_err_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.dwm_dram_err_s = %d\n",
+				reg_sys_nrec_common_intr_cause.dwm_dram_err_s);
+	pr_info("\t reg_sys_nrec_common_intr_cause.dwm_fail_so_dram_fill_s = %d\n",
+				reg_sys_nrec_common_intr_cause.dwm_fail_so_dram_fill_s);
+
+	reg_base_address =      bm.error_intr_cause;
+	reg_size   =   bm_reg_size.error_intr_cause;
+	reg_offset = bm_reg_offset.error_intr_cause * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_error_intr_cause);
+	if (rc != OK)
+		return rc;
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_error_intr_cause));
+
+	pr_info("\t reg_error_intr_cause.qm_bm_err_intr_sum = %d\n",
+				reg_error_intr_cause.qm_bm_err_intr_sum);
+	pr_info("\t reg_error_intr_cause.ecc_err_intr_s = %d\n",
+				reg_error_intr_cause.ecc_err_intr_s);
+	pr_info("\t reg_error_intr_cause.b0_sys_events_rec_bank_s = %d\n",
+				reg_error_intr_cause.b0_sys_events_rec_bank_s);
+	pr_info("\t reg_error_intr_cause.b0_sys_events_rec_bank_s = %d\n",
+				reg_error_intr_cause.b0_sys_events_rec_bank_s);
+	pr_info("\t reg_error_intr_cause.b2_sys_events_rec_bank_s = %d\n",
+				reg_error_intr_cause.b1_sys_events_rec_bank_s);
+	pr_info("\t reg_error_intr_cause.b3_sys_events_rec_bank_s = %d\n",
+				reg_error_intr_cause.b3_sys_events_rec_bank_s);
+	pr_info("\t reg_error_intr_cause.b4_sys_events_rec_bank_s = %d\n",
+				reg_error_intr_cause.b4_sys_events_rec_bank_s);
+	pr_info("\t reg_error_intr_cause.sw_debug_events_rec_s = %d\n",
+				reg_error_intr_cause.sw_debug_events_rec_s);
+	pr_info("\t reg_error_intr_cause.sys_events_nrec_common_s = %d\n",
+				reg_error_intr_cause.sys_events_nrec_common_s);
+
+	reg_base_address =      bm.func_intr_cause;
+	reg_size   =   bm_reg_size.func_intr_cause;
+	reg_offset = bm_reg_offset.func_intr_cause * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_func_intr_cause);
+	if (rc != OK)
+		return rc;
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_func_intr_cause));
+
+	pr_info("\t reg_func_intr_cause.qm_bm_func_intr_sum = %d\n",
+				reg_func_intr_cause.qm_bm_func_intr_sum);
+	pr_info("\t reg_func_intr_cause.b0_pool_nempty_intr_s = %d\n",
+				reg_func_intr_cause.b0_pool_nempty_intr_s);
+	pr_info("\t reg_func_intr_cause.b0_dpool_ae_intr_s = %d\n",
+				reg_func_intr_cause.b0_dpool_ae_intr_s);
+	pr_info("\t reg_func_intr_cause.b0_dpool_af_intr_s = %d\n",
+				reg_func_intr_cause.b0_dpool_af_intr_s);
+	pr_info("\t reg_func_intr_cause.b1_pool_nempty_intr_s = %d\n",
+				reg_func_intr_cause.b1_pool_nempty_intr_s);
+	pr_info("\t reg_func_intr_cause.b1_dpool_ae_intr_s = %d\n",
+				reg_func_intr_cause.b1_dpool_ae_intr_s);
+	pr_info("\t reg_func_intr_cause.b1_dpool_af_intr_s = %d\n",
+				reg_func_intr_cause.b1_dpool_af_intr_s);
+	pr_info("\t reg_func_intr_cause.b2_pool_nempty_intr_s = %d\n",
+				reg_func_intr_cause.b2_pool_nempty_intr_s);
+	pr_info("\t reg_func_intr_cause.b2_dpool_ae_intr_s = %d\n",
+				reg_func_intr_cause.b2_dpool_ae_intr_s);
+	pr_info("\t reg_func_intr_cause.b2_dpool_af_intr_s = %d\n",
+				reg_func_intr_cause.b2_dpool_af_intr_s);
+	pr_info("\t reg_func_intr_cause.b3_pool_nempty_intr_s = %d\n",
+				reg_func_intr_cause.b3_pool_nempty_intr_s);
+	pr_info("\t reg_func_intr_cause.b3_dpool_ae_intr_s = %d\n",
+				reg_func_intr_cause.b3_dpool_ae_intr_s);
+	pr_info("\t reg_func_intr_cause.b3_dpool_af_intr_s = %d\n",
+				reg_func_intr_cause.b3_dpool_af_intr_s);
+	pr_info("\t reg_func_intr_cause.b4_pool_nempty_intr_s = %d\n",
+				reg_func_intr_cause.b4_pool_nempty_intr_s);
+	pr_info("\t reg_func_intr_cause.b4_dpool_ae_intr_s = %d\n",
+				reg_func_intr_cause.b4_dpool_ae_intr_s);
+	pr_info("\t reg_func_intr_cause.b4_dpool_af_intr_s = %d\n",
+				reg_func_intr_cause.b4_dpool_af_intr_s);
+
+	reg_base_address =      bm.ecc_err_intr_cause;
+	reg_size   =   bm_reg_size.ecc_err_intr_cause;
+	reg_offset = bm_reg_offset.ecc_err_intr_cause * 0;
+
+	rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_ecc_err_intr_cause);
+	if (rc != OK)
+		return rc;
+	rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+	if (rc != OK)
+		return rc;
+	pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+		reg_base_address + reg_offset, *((u32 *)&reg_ecc_err_intr_cause));
+
+	pr_info("\t reg_ecc_err_intr_cause.ecc_err_intr_sum = %d\n",
+				reg_ecc_err_intr_cause.ecc_err_intr_sum);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b0_stat_ser_err_1_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b0_stat_ser_err_1_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b0_stat_ser_err_2_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b0_stat_ser_err_2_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b1_stat_ser_err_1_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b1_stat_ser_err_1_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b1_stat_ser_err_2_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b1_stat_ser_err_2_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b2_stat_ser_err_1_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b2_stat_ser_err_1_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b2_stat_ser_err_2_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b2_stat_ser_err_2_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b3_stat_ser_err_1_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b3_stat_ser_err_1_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b3_stat_ser_err_2_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b3_stat_ser_err_2_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b4_stat_ser_err_1_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b4_stat_ser_err_1_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_c_mng_b4_stat_ser_err_2_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_c_mng_b4_stat_ser_err_2_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_d_mng_ball_stat_ser_err_1_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_d_mng_ball_stat_ser_err_1_s);
+	pr_info("\t reg_ecc_err_intr_cause.dpr_d_mng_ball_stat_ser_err_2_s = %d\n",
+				reg_ecc_err_intr_cause.dpr_d_mng_ball_stat_ser_err_2_s);
+	pr_info("\t reg_ecc_err_intr_cause.sram_b0_cache_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.sram_b0_cache_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.sram_b1_cache_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.sram_b1_cache_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.sram_b2_cache_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.sram_b2_cache_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.sram_b3_cache_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.sram_b3_cache_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.sram_b4_cache_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.sram_b4_cache_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b0_dyn_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.tpr_c_mng_b0_dyn_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b1_dyn_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.tpr_c_mng_b1_dyn_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b2_dyn_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.tpr_c_mng_b2_dyn_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b3_dyn_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.tpr_c_mng_b3_dyn_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.tpr_c_mng_b4_dyn_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.tpr_c_mng_b4_dyn_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.tpr_dro_mng_ball_dyn_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.tpr_dro_mng_ball_dyn_ser_err_s);
+	pr_info("\t reg_ecc_err_intr_cause.tpr_drw_mng_ball_dyn_ser_err_s = %d\n",
+				reg_ecc_err_intr_cause.tpr_drw_mng_ball_dyn_ser_err_s);
+
+	for (bid = 0; bid < BM_NUMBER_OF_BANKS; bid++) {
+		reg_base_address =      bm.pool_nempty_intr_cause[bid];
+		reg_size   =   bm_reg_size.pool_nempty_intr_cause[bid];
+		reg_offset = bm_reg_offset.pool_nempty_intr_cause[bid] * 0;
+
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_pool_nempty_intr_cause);
+		if (rc != OK)
+			return rc;
+		pr_info("\n for bank = %d:\n", bid);
+		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+		if (rc != OK)
+			return rc;
+		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_b_pool_nempty_intr_cause));
+
+		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_nempty_intr_sum = %d\n",
+					bid, reg_b_pool_nempty_intr_cause.b_pool_nempty_intr_sum);
+		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_0_nempty_s = 0x%08X\n",
+					bid, reg_b_pool_nempty_intr_cause.b_pool_0_nempty_s);
+		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_1_nempty_s = 0x%08X\n",
+					bid, reg_b_pool_nempty_intr_cause.b_pool_1_nempty_s);
+		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_2_nempty_s = 0x%08X\n",
+					bid, reg_b_pool_nempty_intr_cause.b_pool_2_nempty_s);
+		pr_info("\t b%d_pool_nempty_intr_cause.b_pool_3_nempty_s = 0x%08X\n",
+					bid, reg_b_pool_nempty_intr_cause.b_pool_3_nempty_s);
+		if (bid != 0) {
+			pr_info("\t b%d_pool_nempty_intr_cause.b_pool_4_nempty_s = 0x%08X\n",
+						bid, reg_b_pool_nempty_intr_cause.b_pool_4_nempty_s);
+			pr_info("\t b%d_pool_nempty_intr_cause.b_pool_5_nempty_s = 0x%08X\n",
+						bid, reg_b_pool_nempty_intr_cause.b_pool_5_nempty_s);
+			pr_info("\t b%d_pool_nempty_intr_cause.b_pool_6_nempty_s = 0x%08X\n",
+						bid, reg_b_pool_nempty_intr_cause.b_pool_6_nempty_s);
+		}
+
+		reg_base_address =      bm.dpool_ae_intr_cause[bid];
+		reg_size   =   bm_reg_size.dpool_ae_intr_cause[bid];
+		reg_offset = bm_reg_offset.dpool_ae_intr_cause[bid] * 0;
+
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_dpool_ae_intr_cause);
+		if (rc != OK)
+			return rc;
+		pr_info("\n for bank = %d:\n", bid);
+		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+		if (rc != OK)
+			return rc;
+		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_b_dpool_ae_intr_cause));
+
+		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_ae_intr_sum = %d\n",
+					bid, reg_b_dpool_ae_intr_cause.b_dpool_ae_intr_sum);
+		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_0_ae_s = 0x%08X\n",
+					bid, reg_b_dpool_ae_intr_cause.b_dpool_0_ae_s);
+		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_1_ae_s = 0x%08X\n",
+					bid, reg_b_dpool_ae_intr_cause.b_dpool_1_ae_s);
+		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_2_ae_s = 0x%08X\n",
+					bid, reg_b_dpool_ae_intr_cause.b_dpool_2_ae_s);
+		pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_3_ae_s = 0x%08X\n",
+					bid, reg_b_dpool_ae_intr_cause.b_dpool_3_ae_s);
+		if (bid != 0) {
+			pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_4_ae_s = 0x%08X\n",
+						bid, reg_b_dpool_ae_intr_cause.b_dpool_4_ae_s);
+			pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_5_ae_s = 0x%08X\n",
+						bid, reg_b_dpool_ae_intr_cause.b_dpool_5_ae_s);
+			pr_info("\t b%d_dpool_ae_intr_cause.b_dpool_6_ae_s = 0x%08X\n",
+						bid, reg_b_dpool_ae_intr_cause.b_dpool_6_ae_s);
+		}
+
+		reg_base_address =      bm.dpool_af_intr_cause[bid];
+		reg_size   =   bm_reg_size.dpool_af_intr_cause[bid];
+		reg_offset = bm_reg_offset.dpool_af_intr_cause[bid];
+
+		rc =  bm_register_read(reg_base_address, reg_offset, reg_size, (u32 *)&reg_b_dpool_af_intr_cause);
+		if (rc != OK)
+			return rc;
+		pr_info("\n for bank = %d:\n", bid);
+		rc =  bm_register_name_get(reg_base_address, reg_offset, reg_name);
+		if (rc != OK)
+			return rc;
+		pr_info("  %-32s: 0x%x = 0x%08x\n", reg_name,
+			reg_base_address + reg_offset, *((u32 *)&reg_b_dpool_af_intr_cause));
+
+		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_af_intr_sum = %d\n",
+					bid, reg_b_dpool_af_intr_cause.b_dpool_af_intr_sum);
+		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_0_af_s = 0x%08X\n",
+					bid, reg_b_dpool_af_intr_cause.b_dpool_0_af_s);
+		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_1_af_s = 0x%08X\n",
+					bid, reg_b_dpool_af_intr_cause.b_dpool_1_af_s);
+		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_2_af_s = 0x%08X\n",
+					bid, reg_b_dpool_af_intr_cause.b_dpool_2_af_s);
+		pr_info("\t b%d_dpool_af_intr_cause.b_dpool_3_af_s = 0x%08X\n",
+					bid, reg_b_dpool_af_intr_cause.b_dpool_3_af_s);
+		if (bid != 0) {
+			pr_info("\t b%d_dpool_af_intr_cause.b_dpool_4_af_s = 0x%08X\n",
+						bid, reg_b_dpool_af_intr_cause.b_dpool_4_af_s);
+			pr_info("\t b%d_dpool_af_intr_cause.b_dpool_5_af_s = 0x%08X\n",
+						bid, reg_b_dpool_af_intr_cause.b_dpool_5_af_s);
+			pr_info("\t b%d_dpool_af_intr_cause.b_dpool_6_af_s = 0x%08X\n",
+						bid, reg_b_dpool_af_intr_cause.b_dpool_6_af_s);
+		}
+	}
+
+	rc = OK;
 	return rc;
 }
 
diff --git a/drivers/net/ethernet/marvell/pp3/bm/mv_bm.h b/drivers/net/ethernet/marvell/pp3/bm/mv_bm.h
index 2a161e3..d13541b 100644
--- a/drivers/net/ethernet/marvell/pp3/bm/mv_bm.h
+++ b/drivers/net/ethernet/marvell/pp3/bm/mv_bm.h
@@ -101,10 +101,19 @@ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 #define GP_PE_SIZE_OF_40_BITS_IN_BYTES_IN_DRAM   8
 #define GP_PE_SIZE_IN_BYTES_IN_CACHE	         8
 
+/*
+ * Size of QM pools buffer is fixed.
+ * 1024B for pool 2
+ * 16B for pool 3
+ */
 #define BM_BUFFER_SIZE_P2				      1024
 #define BM_BUFFER_SIZE_P3				        16
 
 /* Default values */
+/*
+ * size of PE is always 32 bits for QM pools (0 to 3)
+ * but can be either 32bits or 40 bits for GP pools (8 to 35)
+ */
 #define BM_PE_SIZE_IS_32_BITS			         1
 #define BM_PE_SIZE_IS_40_BITS			         0
 #define BM_PE_SIZE_DEF					BM_PE_SIZE_IS_32_BITS	/* 0 - 40 bits, 1 - 32 bits */
@@ -182,6 +191,9 @@ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 #define BM_AQOS_MIN					         0
 #define BM_AQOS_MAX					0x00000003	/*   3 */
 
+/*
+ * DRAM configuration for pools
+ */
 #define BM_NUM_OF_BUFFERS_QM_MIN			0x00000030	/*  48 */
 #define BM_NUM_OF_BUFFERS_QM_GPM_MAX		(0x00001400 - 16)	/* 5120 - 16 for P0 & P1 */
 #define BM_NUM_OF_BUFFERS_QM_DRAM_MAX		(0x00400000 - 16)	/*   4M - 16 for P2 & P3 */
@@ -190,16 +202,14 @@ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 #define BM_NUM_OF_BUFFERS_GP_MIN			0x00000030	/*  48 */
 #define BM_NUM_OF_BUFFERS_GP_MAX			(0x00200000 - 16)	/*  2M - 16 */
 
-/* Cache number of buffer is different for QM pools - bank 0 and GP pools - bank 1..4
-   In bank 0 the cache is distributed between 4 pools (recommended to be equaly)
-   In bank 1..4 there are 7 pools and we recommend to give a big portion to one pool and small
-   portion to the others */
-#define BM_CACHE_NUM_OF_BUFFERS_MIN			0x00000030	/*  48 */
-#define BM_CACHE_NUM_OF_BUFFERS_QM_MIN		BM_CACHE_NUM_OF_BUFFERS_MIN
-#define BM_CACHE_NUM_OF_BUFFERS_QM_MAX		(0x00000800 - (4-1)*BM_CACHE_NUM_OF_BUFFERS_QM_MIN) /*
-	the sum for bank 0 is up to 2048, then for one pool it is 2048-3*48   */
-#define BM_CACHE_NUM_OF_BUFFERS_GP_MIN		BM_CACHE_NUM_OF_BUFFERS_MIN
-#define BM_CACHE_NUM_OF_BUFFERS_GP_MAX		(0x00000400 - 8)	/* 1024-8 */
+#define BM_AE_THR_MIN(_num_of_buffers)		MV_MIN(0x00000010, (_num_of_buffers)) /*
+	16                unless number of buffers is 0 and then it is also 0 */
+#define BM_AE_THR_MAX(_num_of_buffers)			MV_MAX(((_num_of_buffers) - 0x00000020), 0) /*
+	num_of_buffers-32 unless number of buffers is 0 and then it is also 0 */
+#define BM_AF_THR_MIN(_num_of_buffers)		MV_MIN(0x00000020, (_num_of_buffers)) /*
+	32                unless number of buffers is 0 and then it is also 0 */
+#define BM_AF_THR_MAX(_num_of_buffers)		MV_MAX(((_num_of_buffers) - 0x00000010), 0) /*
+	num_of_buffers-16 unless number of buffers is 0 and then it is also 0 */
 
 #define BM_FILL_LEVEL_MIN			         0
 #define BM_FILL_LEVEL_MAX(_num_of_buffers)	(_num_of_buffers)
@@ -209,36 +219,47 @@ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 #define BM_POOL_PAIR_MAX			0x00000001
 #define BM_VMID_MIN					         0
 #define BM_VMID_MAX					0x0000003F	/*  63 */
+
+#define BM_DRAM_ADDRESS_MIN_MSB		         0
+#define BM_DRAM_ADDRESS_MIN_LSB		         0
+#define BM_DRAM_ADDRESS_MAX_MSB		0xFFFFFFFF
+#define BM_DRAM_ADDRESS_MAX_LSB		0xFFFFFFFF
+
+#define BM_DATA_PTR_MIN				         0
+#define BM_DATA_PTR_MAX				0xFFFFFFFF
+
+/*
+ * Cache configuration for pools:
+ * Cache number of buffer is different for QM pools - bank 0 and GP pools - bank 1..4
+ * In bank 0 the cache is distributed between 4 pools (recommended to be equaly)
+ * In bank 1..4 there are 7 pools and we recommend to give a big portion to one pool and small
+ * portion to the others
+ */
+#define BM_CACHE_NUM_OF_BUFFERS_MIN			0x00000030	/*  48 */
+#define BM_CACHE_NUM_OF_BUFFERS_QM_MIN		BM_CACHE_NUM_OF_BUFFERS_MIN
+#define BM_CACHE_NUM_OF_BUFFERS_QM_MAX		(0x00000800 - (4-1)*BM_CACHE_NUM_OF_BUFFERS_QM_MIN) /*
+	the sum for bank 0 is up to 2048, then for one pool it is 2048-3*48   */
+#define BM_CACHE_NUM_OF_BUFFERS_GP_MIN		BM_CACHE_NUM_OF_BUFFERS_MIN
+#define BM_CACHE_NUM_OF_BUFFERS_GP_MAX		(0x00000400 - 8)	/* 1024-8 = 1-1016
+	in case one pool uses all the cache */
+
 #define BM_CACHE_VMID_MIN			         0
 #define BM_CACHE_VMID_MAX			0x0000003F	/*  63 */
 #define BM_CACHE_ATTR_MIN			         0
 #define BM_CACHE_ATTR_MAX			0x000000FF	/* 255 */
-#define BM_AE_THR_MIN(_num_of_buffers)		MV_MIN(0x00000010, (_num_of_buffers)) /*
-	16                unless number of buffers is 0 and then it is also 0 */
-#define BM_AE_THR_MAX(_num_of_buffers)			MV_MAX(((_num_of_buffers) - 0x00000020), 0) /*
-	num_of_buffers-32 unless number of buffers is 0 and then it is also 0 */
-#define BM_AF_THR_MIN(_num_of_buffers)		MV_MIN(0x00000020, (_num_of_buffers)) /*
-	32                unless number of buffers is 0 and then it is also 0 */
-#define BM_AF_THR_MAX(_num_of_buffers)		MV_MAX(((_num_of_buffers) - 0x00000010), 0) /*
-	num_of_buffers-16 unless number of buffers is 0 and then it is also 0 */
 #define BM_CACHE_SI_THR_MIN			0x00000010	/*  16 */
 #define BM_CACHE_SI_THR_MAX(_cache_num_of_buffers)		((_cache_num_of_buffers) - 0x00000010)	/*
 	cache_num_of_buffers - 16 */
-#define BM_CACHE_SO_THR_MIN			0x00000018	/*  24 */
+#define BM_CACHE_SO_THR_MIN			0x00000020	/*  32 */
 #define BM_CACHE_SO_THR_MAX(_cache_num_of_buffers)		((_cache_num_of_buffers) - 0x00000008)	/*
 	cache_num_of_buffers -  8 */
-#define BM_CACHE_START_MIN			         0
-#define BM_CACHE_START_MAX			0xFFFFFFFF
-#define BM_CACHE_END_MIN			0x00000020	/*  32 */
-#define BM_CACHE_END_MAX			0x0000007F	/* 127 */
-
-#define BM_DRAM_ADDRESS_MIN_MSB		         0
-#define BM_DRAM_ADDRESS_MIN_LSB		         0
-#define BM_DRAM_ADDRESS_MAX_MSB		0xFFFFFFFF
-#define BM_DRAM_ADDRESS_MAX_LSB		0xFFFFFFFF
+#define BM_CACHE_START_MIN			        0
+#define BM_CACHE_QM_START_MAX		(BM_CACHE_QM_END_MAX - 1)
+#define BM_CACHE_GP_START_MAX		(BM_CACHE_GP_END_MAX - 1)
+#define BM_CACHE_END_MIN					0	/* cache end is start + NB/granularity - 1 */
+#define BM_CACHE_QM_END_MAX			0x0000001F  /* QM: 512PE's is 32 lines */
+#define BM_CACHE_GP_END_MAX			0x0000007F  /* GP: 1016 PE's is 127 lines*/
 
-#define BM_DATA_PTR_MIN				         0
-#define BM_DATA_PTR_MAX				0xFFFFFFFF
 
 
 /* Register status */
-- 
1.7.5.4

