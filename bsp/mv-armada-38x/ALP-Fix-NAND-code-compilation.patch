From 2e02e100f63c704f92f5d0d7526fa4338a37dd48 Mon Sep 17 00:00:00 2001
From: Kosta Zertsekel <konszert@marvell.com>
Date: Wed, 10 Apr 2013 00:19:24 +0300
Subject: [PATCH 0577/1825] ALP: Fix NAND code compilation

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 20b10a283f75814f33c85b546278688edc8262c6

Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Change-Id: Ia67f50a95eb12c9dd0b504dc19b93dd75b1058c5
Reviewed-on: http://vgitil04.il.marvell.com:8080/1536
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/configs/avanta_lp_defconfig               |    2 +-
 arch/arm/configs/avanta_lp_smp_defconfig           |    2 +-
 arch/arm/mach-avantalp/include/mach/irqs.h         |    2 +-
 .../plat-armada/mv_drivers_lsp/mv_mtd/nand_nfc.c   |    2 ++
 4 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/arch/arm/configs/avanta_lp_defconfig b/arch/arm/configs/avanta_lp_defconfig
index a58e32e..fafad28 100644
--- a/arch/arm/configs/avanta_lp_defconfig
+++ b/arch/arm/configs/avanta_lp_defconfig
@@ -18,8 +18,8 @@ CONFIG_MV_ETH_PORTS_NUM=2
 # CONFIG_MV_ETH_TOOL is not set
 # CONFIG_MV_INCLUDE_PEX is not set
 # CONFIG_MV_INCLUDE_USB is not set
-# CONFIG_MV_INCLUDE_NFC is not set
 # CONFIG_MV_INCLUDE_LEGACY_NAND is not set
+CONFIG_MTD_NAND_NFC_INIT_RESET=y
 CONFIG_MV_ETH_PP2=y
 CONFIG_MV_INCLUDE_ETH_PHY=y
 CONFIG_MV_ETH_SWITCH=y
diff --git a/arch/arm/configs/avanta_lp_smp_defconfig b/arch/arm/configs/avanta_lp_smp_defconfig
index 3c54e8a..eb47e0e 100644
--- a/arch/arm/configs/avanta_lp_smp_defconfig
+++ b/arch/arm/configs/avanta_lp_smp_defconfig
@@ -18,8 +18,8 @@ CONFIG_MV_ETH_PORTS_NUM=2
 # CONFIG_MV_ETH_TOOL is not set
 # CONFIG_MV_INCLUDE_PEX is not set
 # CONFIG_MV_INCLUDE_USB is not set
-# CONFIG_MV_INCLUDE_NFC is not set
 # CONFIG_MV_INCLUDE_LEGACY_NAND is not set
+CONFIG_MTD_NAND_NFC_INIT_RESET=y
 CONFIG_MV_ETH_PP2=y
 CONFIG_MV_INCLUDE_ETH_PHY=y
 CONFIG_MV_ETH_SWITCH=y
diff --git a/arch/arm/mach-avantalp/include/mach/irqs.h b/arch/arm/mach-avantalp/include/mach/irqs.h
index d89d649..59424bc 100644
--- a/arch/arm/mach-avantalp/include/mach/irqs.h
+++ b/arch/arm/mach-avantalp/include/mach/irqs.h
@@ -102,7 +102,7 @@
 
 #define IRQ_GLOBAL_NET_WAKE_UP		112
 
-#define IRQ_GLOBAL_NFC			116
+#define IRQ_GLOBAL_NAND			116
 
 #define IRQ_GLOBAL_SOC_MISC_SUMMARY	117
 
diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_mtd/nand_nfc.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_mtd/nand_nfc.c
index a2d8814..03b7ed4 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_mtd/nand_nfc.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_mtd/nand_nfc.c
@@ -27,6 +27,8 @@
 #include "mvCommon.h"
 #include "mvOs.h"
 
+#define IRQ_AURORA_NFC		IRQ_GLOBAL_NAND
+
 #ifdef CONFIG_MV_INCLUDE_PDMA
 #include <asm/hardware/pxa-dma.h>
 #include "pdma/mvPdma.h"
-- 
1.7.5.4

