From aaf6a6929f909a9275f2df7d74cd48ce2f008020 Mon Sep 17 00:00:00 2001
From: xigu <xigu@marvell.com>
Date: Thu, 13 Mar 2014 11:34:52 +0200
Subject: [PATCH 1461/1825] fix: alp: pon: EPON register issue with A0 board

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 13858bcec8311a5af80c3d61ef29d91c4ffe1759

Change-Id: I7a3aeaa2d2f4fae363db9c2bc46a56a71f2f648a
Signed-off-by: xigu <xigu@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/6385
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Yehuda Yitschak <yehuday@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../mv_drivers_lsp/mv_pon/core/epon/eponOnuMngr.c  |    2 +-
 .../mv_drivers_lsp/mv_pon/plat/epon/eponOnuBoard.c |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_pon/core/epon/eponOnuMngr.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_pon/core/epon/eponOnuMngr.c
index de790c3..15178a6 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_pon/core/epon/eponOnuMngr.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_pon/core/epon/eponOnuMngr.c
@@ -3010,7 +3010,7 @@ MV_STATUS onuEponEoamChannelAdd(MV_U8 rxCpuQueue)
 	}
 
 	/* Get last free entry,  go through the all entires from last to first */
-	tid = mvPp2PrsTcamFirstFree(MV_PP2_PRS_TCAM_SIZE - 1, 0);
+	tid = mvPp2PrsTcamFirstFree(PE_LAST_FREE_TID, 0);
 	if (tid > MV_PP2_PRS_TCAM_SIZE - 1) {
 		printk(KERN_ERR "No free TCAM entry for traffic\n");
 		return MV_ERROR;
diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_pon/plat/epon/eponOnuBoard.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_pon/plat/epon/eponOnuBoard.c
index 923cb9c..cc6e220 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_pon/plat/epon/eponOnuBoard.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_pon/plat/epon/eponOnuBoard.c
@@ -117,7 +117,7 @@ extern MV_STATUS mvEponApiSleepModeCtrl(MV_U32 enable);
 *******************************************************************************/
 MV_STATUS onuEponSerdesInit(void)
 {
-#ifdef PON_A0
+#ifdef PON_FPGA
 	MV_STATUS status = MV_OK;
 	MV_U32 txReady;
 	MV_U32 rxReady;
-- 
1.7.5.4

