From b5ed9786e845484e8bc144e86bdf403385d0955f Mon Sep 17 00:00:00 2001
From: Tawfik Bayouk <tawfik@marvell.com>
Date: Tue, 21 Aug 2012 17:34:28 +0300
Subject: [PATCH 0115/1825] NFP: FIB - remove checking of direct src/dst flag

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 21e57e1b44808c2929490e63d076def0a08c06c5

Change-Id: I06a6c80a6a1c867ec0d69a20f8c8d58757a6568e
Signed-off-by: Tawfik Bayouk <tawfik@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 net/ipv4/route.c |    6 ++----
 1 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/net/ipv4/route.c b/net/ipv4/route.c
index 6c3d5d7..2ce0cb5 100644
--- a/net/ipv4/route.c
+++ b/net/ipv4/route.c
@@ -843,8 +843,7 @@ void nfp_fib_sync(void)
 				continue;
 
 			rt->nfp = false;
-			if (!(rt->rt_flags & (RTCF_DIRECTSRC | RTCF_DIRECTDST |
-						RTCF_MULTICAST | RTCF_BROADCAST | RTCF_LOCAL | RTCF_REJECT))) {
+			if (!(rt->rt_flags & (RTCF_MULTICAST | RTCF_BROADCAST | RTCF_LOCAL | RTCF_REJECT))) {
 				if (!nfp_hook_fib_rule_add(AF_INET, (u8 *)(&rt->rt_src), (u8 *)(&rt->rt_dst),
 					  (u8 *)(&rt->rt_gateway), rt->rt_iif, rt->dst.dev->ifindex))
 					rt->nfp = true;
@@ -2258,8 +2257,7 @@ static int __mkroute_input(struct sk_buff *skb,
 
 #if defined(CONFIG_MV_ETH_NFP_FIB_LEARN)
 	rth->nfp = false;
-	if (!(rth->rt_flags & (RTCF_DIRECTSRC | RTCF_DIRECTDST |
-				RTCF_MULTICAST | RTCF_BROADCAST | RTCF_LOCAL | RTCF_REJECT))) {
+	if (!(rth->rt_flags & (RTCF_MULTICAST | RTCF_BROADCAST | RTCF_LOCAL | RTCF_REJECT))) {
 		if (!nfp_hook_fib_rule_add(AF_INET, (u8 *)(&rth->rt_src), (u8 *)(&rth->rt_dst),
 					(u8 *)(&rth->rt_gateway), rth->rt_iif, rth->dst.dev->ifindex))
 			rth->nfp = true;
-- 
1.7.5.4

