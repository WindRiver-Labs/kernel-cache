From 1022addd9d16f6cc06ee6eae810e896984065b4e Mon Sep 17 00:00:00 2001
From: Eli Nidam <elini@marvell.com>
Date: Thu, 16 May 2013 15:27:41 +0300
Subject: [PATCH 0651/1825] ALP: Fixed mvCtrlModeGet detect device ID instead
 of vendor ID

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 3b1d35847b78c56e7d1fcec9e6ad6e1c23a425e4

Change-Id: I4236c8c6c6f71f7538e513364519bf685f7818d2
Signed-off-by: Eli Nidam <elini@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/1834
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c        |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
index 45008fc..18d16f2 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
@@ -1039,15 +1039,18 @@ MV_U16 mvCtrlModelGet(MV_VOID)
 	ctrlId = MV_88F66X0;
 #else
 	ctrlId = MV_REG_READ(DEV_ID_REG);
-	ctrlId = (ctrlId & (VENDOR_ID_MASK)) >> VENDOR_ID_OFFS;
+	ctrlId = (ctrlId & (DEVICE_ID_MASK)) >> DEVICE_ID_OFFS;
 #endif
 	switch (ctrlId) {
 	case 0x6660:
 		return MV_6660_DEV_ID;
 	case 0x6650:
 		return MV_6650_DEV_ID;
+	case 0x6610:
+		return MV_6610_DEV_ID;
 	default:
-		return MV_6650_DEV_ID;
+		mvOsOutput("mvCtrlModelGet: error read ctrl mode (0x%x)\n",ctrlId);
+		return 0;
 	}
 }
 
-- 
1.7.5.4

