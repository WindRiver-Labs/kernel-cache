From 1b6ef9bfd02c341059fb4899d5d17613e8cdcf36 Mon Sep 17 00:00:00 2001
From: Tawfik Bayouk <tawfik@marvell.com>
Date: Tue, 21 Aug 2012 17:32:50 +0300
Subject: [PATCH 0022/1825] Java crash workaround for V6SMP

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 5d967c1ed46a2c3b599f8b0845fe2537a5daa150

Change-Id: I302bd2e8d25bcffde09d762054823359bc808a42
Signed-off-by: Tawfik Bayouk <tawfik@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/kernel/smp_tlb.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/arm/kernel/smp_tlb.c b/arch/arm/kernel/smp_tlb.c
index 02799fc..2ef2a35 100644
--- a/arch/arm/kernel/smp_tlb.c
+++ b/arch/arm/kernel/smp_tlb.c
@@ -132,9 +132,13 @@ void flush_tlb_kernel_range(unsigned long start, unsigned long end)
 #if ( ( defined( CONFIG_SMP ) && defined( CONFIG_CPU_V6 ) ) || ( defined( CONFIG_SMP ) && defined( CONFIG_CPU_V6K ) ) )
 static inline void ipi_flush_cache_user_range(void *arg)
 {
+#if 0
 	struct tlb_args *ta = (struct tlb_args *)arg;
 	printk("function %s  line %d\n", __func__,__LINE__);
 	local_flush_cache_user_range((struct vm_area_struct *)ta->ta_vma, ta->ta_start, ta->ta_end);
+#else /* To verify that JAVA is working */
+	__cpuc_flush_kern_all();
+#endif
 }
 
 //#if defined(CONFIG_SMP) && defined(CONFIG_CPU_V6)
-- 
1.7.5.4

