From 15bb8e6ca6ebb1b59fd4645d73c859839a6a0a7a Mon Sep 17 00:00:00 2001
From: Eli Nidam <elini@marvell.com>
Date: Wed, 11 Sep 2013 10:37:33 +0200
Subject: [PATCH 0984/1825] msys: hal: support msys counter 25MHz frequency
 enable

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 242838634b9647f57807fd370353e74effc41944

Change-Id: Ib9e0bd71b6f64bef8fa44e29c0912f362ca1deae
Signed-off-by: Eli Nidam <elini@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/3473
Reviewed-by: Lior Amsalem <alior@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/plat-armada/mv_hal/cntmr/mvCntmr.c |    7 ++++---
 1 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/arch/arm/plat-armada/mv_hal/cntmr/mvCntmr.c b/arch/arm/plat-armada/mv_hal/cntmr/mvCntmr.c
index bed496d..956beb8 100755
--- a/arch/arm/plat-armada/mv_hal/cntmr/mvCntmr.c
+++ b/arch/arm/plat-armada/mv_hal/cntmr/mvCntmr.c
@@ -220,7 +220,8 @@ MV_STATUS mvCntmrCtrlSet(MV_U32 countNum, MV_CNTMR_CTRL *pCtrl)
 	else			/* no auto mode */
 		cntmrCtrl &= ~(CTCR_ARM_TIMER_AUTO_EN(countNum));
 		
-	if (cntmrHalData.ctrlFamily==MV_78XX0) {
+	if ((cntmrHalData.ctrlFamily == MV_78XX0) ||
+	    (cntmrHalData.ctrlFamily == MV_BOBCAT2_DEV_ID)) {
 		cntmrCtrl &= ~(CTCR_ARM_TIMER_RATIO_MASK(countNum));
 		cntmrCtrl |= (pCtrl->Ratio & 0x7) << (CTCR_ARM_TIMER_RATIO_OFFS(countNum));
 
@@ -275,8 +276,8 @@ MV_STATUS mvCntmrCtrlGet(MV_U32 countNum, MV_CNTMR_CTRL *pCtrl)
 		pCtrl->autoEnable = MV_TRUE;
 	else
 		pCtrl->autoEnable = MV_FALSE;
-	if (cntmrHalData.ctrlFamily==MV_78XX0) 
-	{
+	if ((cntmrHalData.ctrlFamily == MV_78XX0) ||
+	    (cntmrHalData.ctrlFamily == MV_BOBCAT2_DEV_ID)) {
 		pCtrl->Ratio = (cntmrCtrl & (CTCR_ARM_TIMER_RATIO_MASK(countNum))) / (1 << (CTCR_ARM_TIMER_RATIO_OFFS(countNum)));
 		pCtrl->enable_25Mhz = (cntmrCtrl & CTCR_ARM_TIMER_25MhzFRQ_MASK(countNum)) ? MV_TRUE : MV_FALSE;
 	}
-- 
1.7.5.4

