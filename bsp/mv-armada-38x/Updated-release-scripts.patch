From efb07c44187412368e47937ef2cb76e5a6c4b96a Mon Sep 17 00:00:00 2001
From: Nadav Haklai <nadavh@marvell.com>
Date: Wed, 24 Oct 2012 11:14:27 +0200
Subject: [PATCH 0309/1825] Updated release scripts

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit acb75f31934f9ef32461076d00173f0d29ea7f76

Change-Id: I73930c4d363eee0986f332a69429eadd69eee0ec
Signed-off-by: Nadav Haklai <nadavh@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 release/build_nfp_release.sh |   34 +++++++++++++++++-----------------
 release/build_std_release.sh |   36 ++++++++++++++++++------------------
 release/make_release         |    2 +-
 3 files changed, 36 insertions(+), 36 deletions(-)

diff --git a/release/build_nfp_release.sh b/release/build_nfp_release.sh
index 1a6fb52..8730e96 100644
--- a/release/build_nfp_release.sh
+++ b/release/build_nfp_release.sh
@@ -4,34 +4,34 @@
 #
 
 echo "DSMP LSP - Build NFP release $1 based on kernel $2 - Starting..."
-mkdir ./axp-${1}
+mkdir ./${1}
 echo "DSMP LSP - Prepare kernel and kernel+LSP tar balls"
 cd ../
-git archive --format=tar --prefix=linux-${2}-axp-${1}/ HEAD | gzip > linux-${2}-axp-${1}.tgz
+git archive --format=tar --prefix=linux-${2}-${1}/ HEAD | gzip > linux-${2}-${1}.tgz
 git archive --format=tar --prefix=linux-${2}/ v${2} | gzip > linux-${2}.tgz
 cd release
 echo "DSMP LSP - Extract and copy kernel files"
-tar -xzf ../linux-${2}-axp-${1}.tgz -C ./axp-${1}
-tar -xzf ../linux-${2}.tgz -C ./axp-${1}
-rm ../linux-${2}-axp-${1}.tgz
+tar -xzf ../linux-${2}-${1}.tgz -C ./${1}
+tar -xzf ../linux-${2}.tgz -C ./${1}
+rm ../linux-${2}-${1}.tgz
 rm ../linux-${2}.tgz
-rm -fr ./axp-${1}/linux-${2}-axp-${1}/release
+rm -fr ./${1}/linux-${2}-${1}/release
 echo "DSMP LSP - Separate LSP files" 
-cd axp-${1}
-perl ../get_mv_release.sh ./linux-${2}-axp-${1} ./linux-${2}
-cd linux-${2}-axp-${1}_release
-zip -r -q ../linux-${2}-axp-${1}_release.zip ./linux-${2}-axp-${1}/
+cd ${1}
+perl ../get_mv_release.sh ./linux-${2}-${1} ./linux-${2}
+cd linux-${2}-${1}_release
+zip -r -q ../linux-${2}-${1}_release.zip ./linux-${2}-${1}/
 cd ../../
 echo "DSMP LSP - Copy release config files" 
-cp ./configs/* ./axp-${1}/linux-${2}-axp-${1}/arch/arm/configs
+cp ./configs/* ./${1}/linux-${2}-${1}/arch/arm/configs
 echo "DSMP LSP - Compile internal binaries" 
-source ./make_release axp-${1} $2 binaries_internal nfp internal_perf
+source ./make_release ${1} $2 binaries_internal xp_nfp xp_internal_perf
 echo "DSMP LSP - Remove third party SLIC source code"
-source ./make_export axp-${1} $2 binaries_internal
+source ./make_export ${1} $2 binaries_internal
 echo "DSMP LSP - Cleanup" 
-rm ./axp-${1}/linux-${2}-axp-${1}_release.zip
-rm -fr ./axp-${1}/linux-${2}-axp-${1}_release
-rm -fr ./axp-${1}/linux-${2}-axp-${1}
-rm -fr ./axp-${1}/linux-${2}
+rm ./${1}/linux-${2}-${1}_release.zip
+rm -fr ./${1}/linux-${2}-${1}_release
+rm -fr ./${1}/linux-${2}-${1}
+rm -fr ./${1}/linux-${2}
 echo "DSMP LSP - Done!"
 
diff --git a/release/build_std_release.sh b/release/build_std_release.sh
index 10809cc..2cf6acf 100644
--- a/release/build_std_release.sh
+++ b/release/build_std_release.sh
@@ -1,37 +1,37 @@
 #
-# Build Armada XP release script
+# Build Armada XP/370 release script
 # Usage ./build_release.sh <LSP Ver> <Lernel Ver>
 #
 
 echo "DSMP LSP - Build STD release $1 based on kernel $2 - Starting..."
-mkdir ./axp-${1}
+mkdir ./${1}
 echo "DSMP LSP - Prepare kernel and kernel+LSP tar balls" 
 cd ../
-git archive --format=tar --prefix=linux-${2}-axp-${1}/ HEAD | gzip > linux-${2}-axp-${1}.tgz
+git archive --format=tar --prefix=linux-${2}-${1}/ HEAD | gzip > linux-${2}-${1}.tgz
 git archive --format=tar --prefix=linux-${2}/ v${2} | gzip > linux-${2}.tgz
 cd release
 echo "DSMP LSP - Extract and copy kernel files" 
-tar -xzf ../linux-${2}-axp-${1}.tgz -C ./axp-${1}
-tar -xzf ../linux-${2}.tgz -C ./axp-${1}
-rm ../linux-${2}-axp-${1}.tgz
+tar -xzf ../linux-${2}-${1}.tgz -C ./${1}
+tar -xzf ../linux-${2}.tgz -C ./${1}
+rm ../linux-${2}-${1}.tgz
 rm ../linux-${2}.tgz
-rm -fr ./axp-${1}/linux-${2}-axp-${1}/release
+rm -fr ./${1}/linux-${2}-${1}/release
 echo "DSMP LSP - Separate LSP files"
-cd axp-${1}
-perl ../get_mv_release.sh ./linux-${2}-axp-${1} ./linux-${2}
-cd linux-${2}-axp-${1}_release
-zip -r -q ../linux-${2}-axp-${1}_release.zip ./linux-${2}-axp-${1}/
+cd ${1}
+perl ../get_mv_release.sh ./linux-${2}-${1} ./linux-${2}
+cd linux-${2}-${1}_release
+zip -r -q ../linux-${2}-${1}_release.zip ./linux-${2}-${1}/
 cd ../../
 echo "DSMP LSP - Copy release config files"
-cp ./configs/* ./axp-${1}/linux-${2}-axp-${1}/arch/arm/configs
+cp ./configs/* ./${1}/linux-${2}-${1}/arch/arm/configs
 echo "DSMP LSP - Compile external binaries"
-source ./make_release axp-${1} $2 binaries_external v7smp v7smp_lpae v7smp_perf nas amp_g1 amp_g0 be8
+source ./make_release ${1} $2 binaries_external 370 xp_v7smp xp_v7smp_lpae xp_v7smp_perf xp_nas xp_amp_g1 xp_amp_g0 xp_be8
 echo "DSMP LSP - Remove third party SLIC source code"
-source ./make_export axp-${1} $2 binaries_external
+source ./make_export ${1} $2 binaries_external
 echo "DSMP LSP - Cleanup" 
-rm ./axp-${1}/linux-${2}-axp-${1}_release.zip
-rm -fr ./axp-${1}/linux-${2}-axp-${1}_release
-rm -fr ./axp-${1}/linux-${2}-axp-${1}
-rm -fr ./axp-${1}/linux-${2}
+rm ./${1}/linux-${2}-${1}_release.zip
+rm -fr ./${1}/linux-${2}-${1}_release
+rm -fr ./${1}/linux-${2}-${1}
+rm -fr ./${1}/linux-${2}
 echo "DSMP LSP - Done!"
 
diff --git a/release/make_release b/release/make_release
index 4d7421c..c832522 100644
--- a/release/make_release
+++ b/release/make_release
@@ -15,7 +15,7 @@ cd linux-${2}-${1}
 #
 for i in $4 $5 $6 $7 $8 $9 $(10) $(11) $(12)
 do
-	DEFCONFIG=armada_xp_${i}_defconfig
+	DEFCONFIG=armada_${i}_defconfig
 	echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
 	echo "making $i image  - $DEFCONFIG"
 	echo ">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"
-- 
1.7.5.4

