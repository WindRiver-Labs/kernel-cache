From e379429da7c00bec2a5d89f5320a5194d5a92d31 Mon Sep 17 00:00:00 2001
From: Kosta Zertsekel <konszert@marvell.com>
Date: Thu, 2 May 2013 16:46:14 +0300
Subject: [PATCH 0634/1825] ALP: PPv2: Fix defconfig and add PPv2 driver
 registration

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit c7c286655767dacf8ece71dc8165accae8cc1d6c

Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Change-Id: Iad1b74a725b5aa66ecb9bb0f484b2a58304a0fdc
Reviewed-on: http://vgitil04.il.marvell.com:8080/1746
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/configs/avanta_lp_defconfig |    7 +++++--
 arch/arm/mach-avantalp/core.c        |    5 ++++-
 2 files changed, 9 insertions(+), 3 deletions(-)

diff --git a/arch/arm/configs/avanta_lp_defconfig b/arch/arm/configs/avanta_lp_defconfig
index efab461..e71bdb8 100644
--- a/arch/arm/configs/avanta_lp_defconfig
+++ b/arch/arm/configs/avanta_lp_defconfig
@@ -15,15 +15,18 @@ CONFIG_PARTITION_ADVANCED=y
 CONFIG_ARCH_AVANTA_LP=y
 # CONFIG_MV_INCLUDE_CESA is not set
 # CONFIG_MV_INCLUDE_TDM is not set
+# CONFIG_MV_INCLUDE_SWITCH is not set
+CONFIG_MV_ETH_TXQ=8
 # CONFIG_MV_ETH_TOOL is not set
+# CONFIG_NET_SKB_RECYCLE is not set
 # CONFIG_MV_INCLUDE_USB is not set
 # CONFIG_MV_INCLUDE_LEGACY_NAND is not set
 CONFIG_MTD_NAND_NFC_INIT_RESET=y
 CONFIG_MV_ETH_PP2=y
 CONFIG_MV_INCLUDE_ETH_PHY=y
+CONFIG_MV_ETH_DEBUG_CODE=y
+CONFIG_MV_ETH_STAT_DBG=y
 CONFIG_MV_PON=y
-CONFIG_MV_ETH_SWITCH=y
-# CONFIG_MV_ETH_SWITCH_LINK is not set
 CONFIG_PL310_ERRATA_588369=y
 CONFIG_PL310_ERRATA_727915=y
 CONFIG_PL310_ERRATA_753970=y
diff --git a/arch/arm/mach-avantalp/core.c b/arch/arm/mach-avantalp/core.c
index cf13d4a..511f76e 100644
--- a/arch/arm/mach-avantalp/core.c
+++ b/arch/arm/mach-avantalp/core.c
@@ -1264,16 +1264,19 @@ static void __init alp_board_init(void)
 	mvCpuIfAddDecShow();
 	print_board_info();
 
+	alp_init_eth();
+
+#if 0
 	alp_init_gpio();
 	alp_init_rtc();
 	alp_init_spi();
-	alp_init_eth();
 	alp_init_sata();
 	alp_init_nand_nfc();
 	alp_init_hwmon();
 	alp_init_xor();
 	alp_init_i2c();
 	alp_init_sdio();
+#endif
 }
 
 static void board_restart(char mode, const char *cmd)
-- 
1.7.5.4

