From 55c1a514d157bfb9b11c6c80fc138be84f924da5 Mon Sep 17 00:00:00 2001
From: Omri Itach <omrii@marvell.com>
Date: Mon, 15 Jul 2013 17:15:43 +0300
Subject: [PATCH 0853/1825] alp : Added print for SERDES board configuration

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 07276482a11edf8b0c74631b48cdec064af1c673

- Lane #0 is default to PCIe0, while the rest of lanes are scanned from board config
  (only for for DB-6660)

Change-Id: I9b9e1cf2ad2564b661ffac0d6ccd19577319a30d
Signed-off-by: Omri Itach <omrii@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/2647
Reviewed-by: Kosta Zertsekel <konszert@marvell.com>
Tested-by: Star_Automation <star@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../avanta_lp_family/boardEnv/mvBoardEnvLib.c      |   20 +++++++++++++++-----
 1 files changed, 15 insertions(+), 5 deletions(-)

diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
index 9030ba80..a8a5222 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
@@ -1643,8 +1643,8 @@ MV_U8 mvBoardTdmSpiCsGet(MV_U8 devId)
 MV_VOID mvBoardConfigurationPrint(MV_VOID)
 {
 	MV_U32 ethConfig = mvBoardEthComplexConfigGet();
-
-	mvOsOutput("Board configuration detected:\n");
+	char *lane1[] = {"PCIe1", "SGMII-0", "SATA-1", "Invalid Configuration" };
+	mvOsOutput("Board configuration:\n");
 
 	/* TDM */
 	if (mvBoardTdmDevicesCountGet() > 0)
@@ -1702,13 +1702,23 @@ MV_VOID mvBoardConfigurationPrint(MV_VOID)
 		if (ethConfig & MV_ETHCOMP_SW_P3_2_GE_PHY_P3)
 			mvOsOutput("       GE-PHY-3 Module on Switch port #3\n");
 	}
+
+	/* SERDES Lanes*/
+	mvOsOutput("SERDES configuration:\n");
+	mvOsOutput("       Lane #0: PCIe0\n");
+
+	/* rest of SERDES lanes are relevant only to DB-6660 board */
+	if (mvBoardIdGet() != DB_6660_ID)
+		return;
+
+	mvOsOutput("       Lane #1: %s\n", lane1[mvCtrlSysConfigGet(MV_CONFIG_LANE1)]);
+	mvOsOutput("       Lane #2: %s\n", mvCtrlSysConfigGet(MV_CONFIG_LANE2) ? "SATA-0" : "SGMII-0");
+	mvOsOutput("       Lane #3: %s\n", mvCtrlSysConfigGet(MV_CONFIG_LANE3) ? "SGMII-0" : "USB3");
+
 }
 
 MV_VOID mvBoardOtherModuleTypePrint(MV_VOID)
 {
-	/* Pex Module */
-	if (mvBoardIsPexModuleConnected())
-		mvOsOutput("       PEX module.\n");
 	/* SETM Module */
 	if (mvBoardIsSetmModuleConnected())
 		mvOsOutput("       SETM module.\n");
-- 
1.7.5.4

