From 10a4968d2224509d53113771e28256d858cad07d Mon Sep 17 00:00:00 2001
From: Yoni Farhadian <yonif@marvell.com>
Date: Wed, 3 Jul 2013 16:00:41 +0300
Subject: [PATCH 0755/1825] alp: PPv2: Update PON port SKB's HW header length
 by MH size

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 2deba1bdc40880f8be6ddfb3906cbd7928e69b5d

	Since PON might use MH in TX, there is a need to update skb->hard_header_len

Change-Id: I60c8befddfaeedb1cfc378eda99e06ea84516f3e
Signed-off-by: Yoni Farhadian <yonif@marvell.com>
Reviewed-on: http://vgitil04.il.marvell.com:8080/2411
Reviewed-by: Dmitri Epshtein <dima@marvell.com>
Reviewed-by: Star_Automation <star@marvell.com>
Reviewed-by: Igor Patrik <igorp@marvell.com>
Tested-by: Igor Patrik <igorp@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c      |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c b/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
index 9916143..8bc49ad 100644
--- a/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
+++ b/arch/arm/plat-armada/mv_drivers_lsp/mv_pp2/net_dev/mv_netdev.c
@@ -3277,6 +3277,9 @@ struct net_device *mv_eth_netdev_init(int mtu, u8 *mac, struct platform_device *
 	dev->tx_queue_len = CONFIG_MV_ETH_TXQ_DESC;
 	dev->watchdog_timeo = 5 * HZ;
 
+	if (MV_PON_PORT(dev_priv->port))
+		dev->hard_header_len += MV_ETH_MH_SIZE;
+
 	dev->netdev_ops = &mv_eth_netdev_ops;
 
 	SET_ETHTOOL_OPS(dev, &mv_eth_tool_ops);
-- 
1.7.5.4

