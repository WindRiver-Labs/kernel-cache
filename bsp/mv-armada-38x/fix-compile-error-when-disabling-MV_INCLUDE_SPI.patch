From 418229433b6d77733bd52d1a6a7a132ca6f2011c Mon Sep 17 00:00:00 2001
From: Nadav Haklai <nadavh@marvell.com>
Date: Wed, 14 Nov 2012 17:48:34 +0200
Subject: [PATCH 0325/1825] fix compile error when disabling MV_INCLUDE_SPI

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit 352b0508122649a81c905589cf048b1bae38bf39

Change-Id: Id44c4cb441388e285887481a301c02deb5e4b012
Signed-off-by: Nadav Haklai <nadavh@marvell.com>
Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-armadaxp/core.c   |    6 ++++++
 arch/arm/mach-armadaxp/export.c |    2 ++
 2 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-armadaxp/core.c b/arch/arm/mach-armadaxp/core.c
index f6bb4cc..4d5daf2 100644
--- a/arch/arm/mach-armadaxp/core.c
+++ b/arch/arm/mach-armadaxp/core.c
@@ -1529,9 +1529,11 @@ static void __init axp_db_init(void)
 	if(mvUnitMapIsMine(RTC) == MV_TRUE)
 		rtc_init();
 
+#ifdef CONFIG_MV_INCLUDE_SPI
 	/* SPI */
 	if(mvUnitMapIsMine(SPI) == MV_TRUE)
 		mvSysSpiInit(0, _16M);
+#endif
 
 	/* ETH-PHY */
 	mvSysEthPhyInit();
@@ -1699,8 +1701,10 @@ static void __init axp_gp_init(void)
 	/* RTC */
 	rtc_init();
 
+#ifdef CONFIG_MV_INCLUDE_SPI
 	/* SPI */
 	mvSysSpiInit(0, _16M);
+#endif
 
 	/* ETH-PHY */
 	mvSysEthPhyInit();
@@ -1837,8 +1841,10 @@ static void __init axp_rd_nas_init(void)
 	/* RTC */
 	rtc_init();
 
+#ifdef CONFIG_MV_INCLUDE_SPI
 	/* SPI */
 	mvSysSpiInit(0, _16M);
+#endif
 
 	/* ETH-PHY */
 	mvSysEthPhyInit();
diff --git a/arch/arm/mach-armadaxp/export.c b/arch/arm/mach-armadaxp/export.c
index 92733f0..1d01e61 100644
--- a/arch/arm/mach-armadaxp/export.c
+++ b/arch/arm/mach-armadaxp/export.c
@@ -62,11 +62,13 @@ EXPORT_SYMBOL(mvBoardTdmSpiModeGet);
 EXPORT_SYMBOL(mvBoardTdmSpiCsGet);
 EXPORT_SYMBOL(mvBoardTdmDevicesCountGet);
 
+#ifdef CONFIG_MV_INCLUDE_SPI
 #include "spi/mvSpiCmnd.h"
 EXPORT_SYMBOL(mvSpiWriteThenWrite);
 EXPORT_SYMBOL(mvSpiWriteThenRead);
 #include "spi/mvSpi.h"
 EXPORT_SYMBOL(mvSpiParamsSet);
+#endif
 #include "gpp/mvGpp.h"
 EXPORT_SYMBOL(mvGppValueSet);
 
-- 
1.7.5.4

