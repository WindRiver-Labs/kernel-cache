From 685653ad4ce7c3012896182c3dbec762b599e1c6 Mon Sep 17 00:00:00 2001
From: Omri Itach <omrii@marvell.com>
Date: Sun, 10 Mar 2013 14:44:03 +0200
Subject: [PATCH 0479/1825] fixed FPGA compilation error, caused by enabling
 the MV_INCLUDE_GIG_ETH define

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit f8ebab64fe3f7d690de3eaadc960aab2a7567a2f

Change-Id: Ie1850249ddb9651ab719fa221ba0a75d69f00c7b
Reviewed-on: http://vgitil04.il.marvell.com:8080/1220
Reviewed-by: Kosta Zertsekel <konszert@marvell.com>
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c        |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
index 2893e97..a879c25 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
@@ -1476,9 +1476,9 @@ MV_BOOL mvCtrlPwrClckGet(MV_UNIT_ID unitId, MV_U32 index)
 	if (mvCtrlModelGet() == MV_FPGA_DEV_ID)
 		return MV_TRUE;
 
+	MV_U32 reg = MV_REG_READ(POWER_MNG_CTRL_REG);
 	switch (unitId) {
 #if defined(MV_INCLUDE_PEX)
-		MV_U32 reg = MV_REG_READ(POWER_MNG_CTRL_REG);
 	case PEX_UNIT_ID:
 		if ((reg & PMC_PEXSTOPCLOCK_MASK(index)) == PMC_PEXSTOPCLOCK_STOP(index))
 			state = MV_FALSE;
@@ -1649,8 +1649,8 @@ MV_BOOL mvCtrlPwrMemGet(MV_UNIT_ID unitId, MV_U32 index)
 	MV_BOOL state = MV_TRUE;
 
 	switch (unitId) {
+	MV_U32 reg;
 #if defined(MV_INCLUDE_PEX)
-		MV_U32 reg;
 	case PEX_UNIT_ID:
 		reg = MV_REG_READ(POWER_MNG_MEM_CTRL_REG(PMC_MCR_NUM_PEX));
 		if ((reg & PMC_PEXSTOPMEM_MASK(index)) == PMC_PEXSTOPMEM_STOP(index))
-- 
1.7.5.4

