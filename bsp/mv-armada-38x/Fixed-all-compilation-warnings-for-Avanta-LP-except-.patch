From e17f3920a2b7586b4e13a965495e64d9109b936d Mon Sep 17 00:00:00 2001
From: Omri Itach <omrii@marvell.com>
Date: Mon, 18 Mar 2013 17:26:07 +0200
Subject: [PATCH 0517/1825] Fixed all compilation warnings for Avanta LP
 (except PP2 warnings)

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit f311d5ed7b487ecfbdd0fe7755e54c2b2880a7e5

- Cleaned AXP/A370 legacy code

Change-Id: I3f70d49ca0106e4ea23213f1385ce0e7dac803dd
Reviewed-on: http://vgitil04.il.marvell.com:8080/1330
Reviewed-by: Omri Itach <omrii@marvell.com>
Tested-by: Omri Itach <omrii@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 .../avanta_lp_family/boardEnv/mvBoardEnvLib.c      |  101 ++-------
 .../avanta_lp_family/boardEnv/mvBoardEnvLib.h      |   67 +-----
 .../avanta_lp_family/boardEnv/mvBoardEnvSpec.c     |   20 +-
 .../avanta_lp_family/boardEnv/mvBoardEnvSpec.h     |   19 +-
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c        |   95 ++------
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvLib.h        |    7 +-
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h       |  122 +++--------
 .../avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h       |  239 +++++++++-----------
 8 files changed, 207 insertions(+), 463 deletions(-)

diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
index 6960325..ab22250 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.c
@@ -739,12 +739,12 @@ MV_32 mvBoardMppGet(MV_U32 mppGroupNum)
 
 MV_32 mvBoardMppTypeGet(MV_U32 mppGroupNum)
 {
-	return (MV_U32)board->pBoardMppGroupValue[mppGroupNum];
+	return (MV_U32)board->pBoardMppGroupValue[0].mppGroupType[mppGroupNum];
 }
 
 MV_VOID mvBoardMppTypeSet(MV_U32 mppGroupNum, MV_U32 groupType)
 {
-	board->pBoardMppGroupValue[mppGroupNum] = groupType;
+	board->pBoardMppGroupValue[0].mppGroupType[mppGroupNum] = groupType;
 }
 
 /*******************************************************************************
@@ -829,11 +829,11 @@ MV_VOID mvBoardConfigInit(void)
 		/* omriii: what scenario leads to enable PON_CLK_OUT insted of PON_TX_FAULT?? */
 		mvBoardMppTypeSet(5, GE0_UNIT_PON_TX_FAULT);
 		mvBoardMppTypeSet(6, GE0_UNIT);
-		mvBoardMppTypeSet(7, GE0_UNIT_LED_MATRIX);  /* omriii :when to use GE0_UNIT_UA1_PTP */
-	}else if (mac1con == 0x2) { /* 10  MAC1 connected to Switch P4 */
+		mvBoardMppTypeSet(7, GE0_UNIT_LED_MATRIX);      /* omriii :when to use GE0_UNIT_UA1_PTP */
+	}else if (mac1con == 0x2) {
 		mvBoardMppTypeSet(5, SWITCH_P4_PON_TX_FAULT);
 		mvBoardMppTypeSet(6, SWITCH_P4);
-		mvBoardMppTypeSet(7, SWITCH_P4_LED_MATRIX); /* omriii :when to use SWITCH_P4_UA1_PTP */
+		mvBoardMppTypeSet(7, SWITCH_P4_LED_MATRIX); /* omriii : when to use SWITCH_P4_UA1_PTP */
 	}
 }
 
@@ -858,7 +858,7 @@ MV_BOARD_BOOT_SRC mvBoardBootDeviceGroupSet(MV_U32 sarBootDeviceValue)
 {
 	MV_U32 groupType;
 	MV_BOOL SW_SMI;
-	MV_BOARD_BOOT_SRC bootSrc= mvBoardBootDeviceGet(sarBootDeviceValue);
+	MV_BOARD_BOOT_SRC bootSrc = mvBoardBootDeviceGet(sarBootDeviceValue);
 
 	switch (bootSrc) {
 	case MSAR_0_BOOT_NAND_NEW:
@@ -869,7 +869,7 @@ MV_BOARD_BOOT_SRC mvBoardBootDeviceGroupSet(MV_U32 sarBootDeviceValue)
 		groupType = ((mvCtrlConfigGet(MV_CONFIG_DEVICE_BUS_MODULE) == 0x2) ? SPI0_BOOT_SPDIF_AUDIO : SPI0_BOOT);
 		mvBoardMppTypeSet(0, groupType);
 		mvBoardMppTypeSet(1, groupType);
-	case MSAR_0_BOOT_SPI1_FLASH:	/* MSAR_0_SPI1 - update Groups 3-4 */
+	case MSAR_0_BOOT_SPI1_FLASH:    /* MSAR_0_SPI1 - update Groups 3-4 */
 		mvBoardMppTypeSet(3, SDIO_SPI1_UNIT);
 		SW_SMI = MV_TRUE;       // test if SW or CPU SMI control (omriii : how to decide ?)
 		if (mvCtrlIsLantiqTDM())
@@ -916,12 +916,15 @@ MV_BOARD_BOOT_SRC mvBoardBootDeviceGet(MV_U32 sarBootDeviceValue)
 {
 	MV_SAR_BOOT_TABLE sarTable[] = MV_SAR_TABLE_VAL;
 	MV_SAR_BOOT_TABLE sarBootEntry = sarTable[sarBootDeviceValue];
-	if (sarBootEntry.bootSrc!=MSAR_0_BOOT_SPI_FLASH)
+
+	if (sarBootEntry.bootSrc != MSAR_0_BOOT_SPI_FLASH)
 		return sarBootEntry.bootSrc;
-	else /* if boot source is SPI ,verify which CS (0/1) */
-		if (mvBoardBootAttrGet(sarBootDeviceValue,1) == MSAR_0_SPI0)
-			return MSAR_0_BOOT_SPI_FLASH;
-		else return MSAR_0_BOOT_SPI1_FLASH;
+
+	/* if boot source is SPI ,verify which CS (0/1) */
+	if (mvBoardBootAttrGet(sarBootDeviceValue, 1) == MSAR_0_SPI0)
+		return MSAR_0_BOOT_SPI_FLASH;
+	else
+		return MSAR_0_BOOT_SPI1_FLASH;
 }
 
 /*******************************************************************************
@@ -931,7 +934,7 @@ MV_BOARD_BOOT_SRC mvBoardBootDeviceGet(MV_U32 sarBootDeviceValue)
 *   read board BOOT configuration and return attributes accordingly
 *
 * INPUT:  sarBootDevice - BOOT_DEVICE value from S@R.*
-* 	  attrNum - attribute number [1/2/3]
+*         attrNum - attribute number [1/2/3]
 * OUTPUT:  None.
 *
 * RETURN:
@@ -942,6 +945,7 @@ MV_U32 mvBoardBootAttrGet(MV_U32 sarBootDeviceValue, MV_U8 attrNum)
 {
 	MV_SAR_BOOT_TABLE sarTable[] = MV_SAR_TABLE_VAL;
 	MV_SAR_BOOT_TABLE sarBootEntry = sarTable[sarBootDeviceValue];
+
 	switch (attrNum) {
 	case 1:
 		return sarBootEntry.attr1;
@@ -1117,7 +1121,7 @@ MV_U32 mvBoardGppConfigGet(void)
 *******************************************************************************/
 MV_32 mvBoardTdmSpiModeGet(MV_VOID)
 {
-	return DUAL_CHIP_SELECT_MODE;
+	return 0;
 }
 
 /*******************************************************************************
@@ -1625,9 +1629,8 @@ MV_32 mvBoardNandWidthGet(void)
 *******************************************************************************/
 MV_VOID mvBoardIdSet(MV_U32 boardId)
 {
-	if (boardId >= MV_MAX_BOARD_ID) {
+	if (boardId >= MV_MAX_BOARD_ID)
 		mvOsPrintf("%s: Error: wrong boardId (%d)\n", __func__, boardId);
-	}
 
 	board = boardInfoTbl[gBoardId];
 }
@@ -2011,7 +2014,7 @@ MV_32 mvBoardSmiScanModeGet(MV_U32 switchIdx)
 * mvBoardSwitchCpuPortGet - Get the the Ethernet Switch CPU port
 *
 * DESCRIPTION:
-*       This routine returns the Switch CPU port.
+*       This routine returns the Switch CPU port if connected , -1 else.
 *
 * INPUT:
 *       switchIdx - index of the switch. Only 0 is supported.
@@ -2029,70 +2032,6 @@ MV_32 mvBoardSwitchCpuPortGet(MV_U32 switchIdx)
 }
 
 /*******************************************************************************
-* mvBoardIsSerdesConfigurationEnabled
-*
-* DESCRIPTION:
-*       Check if Serdes configuration is enabled on this board.
-*
-* INPUT:
-*       None.
-*
-* OUTPUT:
-*       None.
-*
-* RETURN:
-*       MV_STATUS - MV_OK, MV_ERROR.
-*
-*******************************************************************************/
-MV_BOOL mvBoardIsSerdesConfigurationEnabled(void)
-{
-	if (board->pBoardSerdesConfigValue)
-		return board->pBoardSerdesConfigValue->enableSerdesConfiguration;
-	else
-		return MV_FALSE;
-}
-
-/*******************************************************************************
-* mvBoardSerdesConfigurationEnableSet
-*
-* DESCRIPTION:
-*	Check if Serdes configuration is enabled on this board.
-*
-* INPUT:
-*       None.
-*
-* OUTPUT:
-*       None.
-*
-* RETURN:
-*       MV_STATUS - MV_OK, MV_ERROR.
-*
-*******************************************************************************/
-MV_STATUS mvBoardSerdesConfigurationEnableSet(MV_BOOL enableSerdesConfiguration)
-{
-	return MV_ERROR;
-}
-
-/*******************************************************************************
-* mvBoardSerdesCfgGet
-*
-* DESCRIPTION:
-*
-* INPUT:
-*
-* OUTPUT:
-*       None.
-*
-* RETURN:
-*       SERDES configuration structure or NULL on error
-*
-*******************************************************************************/
-MV_SERDES_CFG *mvBoardSerdesCfgGet(void)
-{
-	return NULL;
-}
-
-/*******************************************************************************
 * mvBoardPexInfoGet - Get board PEX Info
 *
 * DESCRIPTION:
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.h b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.h
index baaa8a2..34169cd 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvLib.h
@@ -77,64 +77,12 @@ extern "C" {
 #include "boardEnv/mvBoardEnvSpec.h"
 #include "twsi/mvTwsi.h"
 
-/* DUART stuff for Tclk detection only */
-#define DUART_BAUD_RATE                 115200
-#define MAX_CLOCK_MARGINE               5000000 /* Maximum detected clock margin */
-
-/* Voice devices assembly modes */
-#define DAISY_CHAIN_MODE                1
-#define DUAL_CHIP_SELECT_MODE           0
-#define INTERRUPT_TO_MPP                1
-#define INTERRUPT_TO_TDM                0
-
-#define BOARD_ETH_PORT_NUM  MV_ETH_MAX_PORTS
 #define BOARD_ETH_SWITCH_PORT_NUM       8
 #define BOARD_ETH_QD_SWITCH_PORT_NUM    5
-#define BOARD_ETH_SWITCH_CPUPORT_NUM    2
-#define MV_BOARD_MAX_USB_IF             3
 #define MV_BOARD_MAX_MPP                9       /* number of MPP conf registers */
 #define MV_BOARD_MAX_MPP_GROUPS         9
 #define MV_BOARD_NAME_LEN               0x20
 
-/* EPPROM Modules detection information */
-
-#define MV_BOARD_EEPROM_MODULE_ADDR             0x50
-#define MV_BOARD_EEPROM_MODULE_ADDR_TYPE        ADDR7_BIT
-
-#define MV_BOARD_PEX_MODULE_ADDR                0x23
-#define MV_BOARD_PEX_MODULE_ADDR_TYPE           ADDR7_BIT
-#define MV_BOARD_PEX_MODULE_ID                  0
-
-#define MV_BOARD_LVDS_MODULE_ADDR               0x21
-#define MV_BOARD_LVDS_MODULE_ADDR_TYPE          ADDR7_BIT
-#define MV_BOARD_LVDS_MODULE_ID                 0
-
-#define MV_BOARD_SETM_MODULE_ADDR               0x23
-#define MV_BOARD_SETM_MODULE_ADDR_TYPE          ADDR7_BIT
-#define MV_BOARD_SETM_MODULE_ID                 1
-
-#define MV_BOARD_MPP_MODULE_ADDR                0x20
-#define MV_BOARD_MPP_MODULE_ADDR_TYPE           ADDR7_BIT
-#define MV_BOARD_LCD_DVI_MODULE_ID              0
-#define MV_BOARD_TDM_MODULE_ID                  1
-#define MV_BOARD_MII_GMII_MODULE_ID             4
-
-typedef struct _boardData {
-	MV_U32 magic;
-	MV_U16 boardId;
-	MV_U8 boardVer;
-	MV_U8 boardRev;
-	MV_U32 reserved1;
-	MV_U32 reserved2;
-} BOARD_DATA;
-
-typedef enum _devBoardMppGroupClass {
-	MV_BOARD_MPP_GROUP_1,
-	MV_BOARD_MPP_GROUP_2,
-	MV_BOARD_MPP_GROUP_3,
-	MV_BOARD_MAX_MPP_GROUP
-} MV_BOARD_MPP_GROUP_CLASS;
-
 typedef enum _devBoardMppTypeClass {
 	MV_BOARD_AUTO,
 	MV_BOARD_TDM_2CH,
@@ -350,7 +298,7 @@ typedef struct _boardInfo {
 	MV_U8 numBoardMppConfigValue;
 	MV_BOARD_MPP_INFO *pBoardMppConfigValue;
 	MV_U8 numBoardMppGroupValue;
-	MV_BOARD_MPP_GROUP_INFO **pBoardMppGroupValue;
+	MV_BOARD_MPP_GROUP_INFO *pBoardMppGroupValue;
 	MV_U8 numBoardSerdesConfigValue;
 	MV_SERDES_CFG *pBoardSerdesConfigValue;
 	MV_U32 intsGppMaskLow;
@@ -413,7 +361,7 @@ typedef struct _boardInfo {
 	MV_U32 nandFlashWriteParams;
 	MV_U32 nandFlashControl;
 	MV_BOARD_TDM_SPI_INFO *pBoardTdmSpiInfo;
-	MV_BOARD_PEX_INFO	boardPexInfo;	/* filled in runtime */
+	MV_BOARD_PEX_INFO boardPexInfo;         /* filled in runtime */
 	MV_U32 norFlashReadParams;
 	MV_U32 norFlashWriteParams;
 
@@ -450,8 +398,8 @@ typedef struct _boardInfo {
 #define MSAR_0_SPI1                             1
 
 /* For backward compatability with Legacy mode */
-#define mvBoardSwitchConnectedPortGet(port)	(-1)
-#define mvBoardIsSwitchConnected(port)  	(mvBoardSwitchConnectedPortGet(port) != -1)
+#define mvBoardSwitchConnectedPortGet(port)     (-1)
+#define mvBoardIsSwitchConnected(port)          (mvBoardSwitchConnectedPortGet(port) != -1)
 /*#define mvBoardLinkStatusIrqGet(port)		mvBoardSwitchIrqGet()*/
 
 MV_VOID mvBoardEnvInit(MV_VOID);
@@ -528,9 +476,8 @@ MV_BOOL mvBoardIsGMIIModuleConnected(void);
 MV_STATUS mvBoardTwsiMuxChannelSet(MV_U8 muxChNum);
 MV_STATUS mvBoardTwsiReadByteThruMux(MV_U8 muxChNum, MV_U8 chNum, MV_TWSI_SLAVE *pTwsiSlave, MV_U8 *data);
 MV_BOARD_MAC_SPEED mvBoardMacSpeedGet(MV_U32 ethPortNum);
-MV_BOOL mvBoardIsSerdesConfigurationEnabled(void);
-MV_STATUS  mvBoardSerdesConfigurationEnableSet(MV_BOOL enableSerdesconfig);
-MV_SERDES_CFG *mvBoardSerdesCfgGet(void);
+MV_32 mvBoardSwitchCpuPortGet(MV_U32 switchIdx);
+MV_32 mvBoardSmiScanModeGet(MV_U32 switchIdx);
 MV_BOARD_PEX_INFO *mvBoardPexInfoGet(void);
 MV_STATUS mvBoardConfIdSet(MV_U16 conf);
 MV_U16 mvBoardPexModeGet(MV_VOID);
@@ -540,4 +487,4 @@ MV_STATUS mvBoardPexModeSet(MV_U16 conf);
 }
 #endif  /* __cplusplus */
 
-#endif  /* __INCmvBoardEnvLibh */
+#endif  /* __INCmvBoardEnvLibh */
\ No newline at end of file
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.c b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.c
index 29faa14..09b44cd 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.c
@@ -168,18 +168,18 @@ MV_BOARD_INFO avanta_lp_fpga_board_info = {
 
 MV_BOARD_TWSI_INFO db88f6600InfoBoardTwsiDev[] = {
 	/* {{MV_BOARD_DEV_CLASS devClass, MV_U8 twsiDevAddr, MV_U8 twsiDevAddrType}} */
-	{ BOARD_DEV_TWSI_SATR,	      0x4C,	   ADDR7_BIT			     },
-	{ BOARD_DEV_TWSI_SATR,	      0x4D,	   ADDR7_BIT			     },
-	{ BOARD_DEV_TWSI_EEPROM,      0x54,	   ADDR7_BIT			     },
-	{ BOARD_DEV_TWSI_IO_EXPANDER, 0x21,	   ADDR7_BIT			     },
-	{ BOARD_DEV_TWSI_IO_EXPANDER, 0x22,	   ADDR7_BIT			     }, /*omriii : re-verify that 0x22 is also IO_EXPANDER for 6600 board */
-	{ BOARD_DEV_TWSI_IO_EXPANDER, 0x24,	   ADDR7_BIT			     }, /*omriii : re-verify that 0x22 is also IO_EXPANDER for 6600 board */
+	{ BOARD_DEV_TWSI_SATR,	      0x4C,	   ADDR7_BIT				    },
+	{ BOARD_DEV_TWSI_SATR,	      0x4D,	   ADDR7_BIT				    },
+	{ BOARD_DEV_TWSI_EEPROM,      0x54,	   ADDR7_BIT				    },
+	{ BOARD_DEV_TWSI_IO_EXPANDER, 0x21,	   ADDR7_BIT				    },
+	{ BOARD_DEV_TWSI_IO_EXPANDER, 0x22,	   ADDR7_BIT				    },  /*omriii : re-verify that 0x22 is also IO_EXPANDER for 6600 board */
+	{ BOARD_DEV_TWSI_IO_EXPANDER, 0x24,	   ADDR7_BIT				    },  /*omriii : re-verify that 0x22 is also IO_EXPANDER for 6600 board */
 };
 MV_BOARD_MAC_INFO db88f6600InfoBoardMacInfo[] = {
 	/* {{MV_BOARD_MAC_SPEED boardMacSpeed, MV_U8 boardEthSmiAddr}} */
-	{ BOARD_MAC_SPEED_AUTO, 0x8						       },
-	{ BOARD_MAC_SPEED_AUTO, 0x9						       },
-	{ N_A,			N_A						       }
+	{ BOARD_MAC_SPEED_AUTO, 0x8									},
+	{ BOARD_MAC_SPEED_AUTO, 0x9									},
+	{ N_A,			N_A									}
 };
 MV_BOARD_MPP_TYPE_INFO db88f6600InfoBoardModTypeInfo[] = {
 	{
@@ -398,4 +398,4 @@ MV_BOARD_INFO avanta_lp_customer_board_info = {
 MV_BOARD_INFO *boardInfoTbl[] = {
 	&db88f6600_board_info,
 	&avanta_lp_fpga_board_info,
-};
+};
\ No newline at end of file
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.h b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.h
index 1a94e05..ba1ff7a 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/boardEnv/mvBoardEnvSpec.h
@@ -80,16 +80,15 @@
 /* New board ID numbers */
 
 /* boards ID numbers */
-#define BOARD_ID_BASE			0x0
-
-#define DB_6660_ID			(BOARD_ID_BASE)
-#define RD_6660_ID			(DB_6660_ID + 1)
-#define DB_6650_ID			(RD_6660_ID + 1)
-#define RD_6650_ID			(DB_6650_ID + 1)
-#define MV_BOARD_ID_AVANTA_LP_FPGA	(RD_6650_ID + 1)
-#define MV_MAX_BOARD_ID			(MV_BOARD_ID_AVANTA_LP_FPGA + 1)
-#define MV_INVALID_BOARD_ID		0xFFFFFFFF
+#define BOARD_ID_BASE                   0x0
 
+#define DB_6660_ID                      (BOARD_ID_BASE)
+#define RD_6660_ID                      (DB_6660_ID + 1)
+#define DB_6650_ID                      (RD_6660_ID + 1)
+#define RD_6650_ID                      (DB_6650_ID + 1)
+#define MV_BOARD_ID_AVANTA_LP_FPGA      (RD_6650_ID + 1)
+#define MV_MAX_BOARD_ID                 (MV_BOARD_ID_AVANTA_LP_FPGA + 1)
+#define MV_INVALID_BOARD_ID             0xFFFFFFFF
 
 /*******************************************************************************
  * AvantaLP DB-88F6600 board */
@@ -158,4 +157,4 @@
 
 #endif  /* MV_ASMLANGUAGE */
 
-#endif  /* __INCmvBoardEnvSpech */
+#endif  /* __INCmvBoardEnvSpech */
\ No newline at end of file
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
index 2650dab..8c2d8e7 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.c
@@ -229,37 +229,37 @@ MV_STATUS mvCtrlEnvInit(MV_VOID)
 *       else if write failed - returns MV_ERROR
 *
 *******************************************************************************/
-MV_STATUS mvCtrlSatRWrite(MV_SATR_TYPE_ID satrWriteField,MV_SATR_TYPE_ID satrReadField, MV_U8 val)
+MV_STATUS mvCtrlSatRWrite(MV_SATR_TYPE_ID satrWriteField, MV_SATR_TYPE_ID satrReadField, MV_U8 val)
 {
 	MV_BOARD_SAR_INFO sarInfo;
 	MV_U32 readVal, tmpVal;
+
 	if ((satrReadField < MV_SATR_READ_MAX_OPTION) && (satrWriteField < MV_SATR_WRITE_MAX_OPTION)) {
-		if ( mvBoardSarInfoGet(satrWriteField, &sarInfo) && sarInfo.isActiveForBoard[mvBoardIdGet()])
-		{
+		if ( mvBoardSarInfoGet(satrWriteField, &sarInfo) && sarInfo.isActiveForBoard[mvBoardIdGet()]) {
+
 			/* read */
-			readVal = mvBoardTwsiGet(BOARD_DEV_TWSI_SATR, sarInfo.regNum , 0);
+			readVal = mvBoardTwsiGet(BOARD_DEV_TWSI_SATR, sarInfo.regNum, 0);
 			if ((MV_U8)readVal == (MV_U8)MV_ERROR)
 				return MV_ERROR;
 
 			/* modify */
-			readVal &= !(sarInfo.mask);  		/* clean old value */
-			readVal &= (val <<  sarInfo.offset);	/* save new value */
+			readVal &= !(sarInfo.mask);             /* clean old value */
+			readVal &= (val <<  sarInfo.offset);    /* save new value */
 
 			/* write */
-			tmpVal = mvBoardTwsiSet(BOARD_DEV_TWSI_SATR, sarInfo.regNum, 0,readVal);
+			tmpVal = mvBoardTwsiSet(BOARD_DEV_TWSI_SATR, sarInfo.regNum, 0, readVal);
 			if ((MV_U8)tmpVal == (MV_U8)MV_ERROR)
 				return MV_ERROR;
 
 			/* verify */
-			tmpVal = mvBoardTwsiGet(BOARD_DEV_TWSI_SATR, sarInfo.regNum , 0);
-			if (tmpVal!=readVal)
+			tmpVal = mvBoardTwsiGet(BOARD_DEV_TWSI_SATR, sarInfo.regNum, 0);
+			if (tmpVal != readVal)
 				return MV_ERROR;
 
 			/*else save written value in global array */
 			satrOptionsConfig[satrReadField] = readVal;
 			return MV_OK;
-		}
-		else
+		}else
 			printf("\n%s: Error: Requested S@R config is not relevant for the current board\n, __func__");
 	}
 	return MV_ERROR;
@@ -305,8 +305,7 @@ MV_STATUS mvCtrlCpuDdrL2FreqGet(MV_FREQ_MODE *freqMode)
 {
 	MV_FREQ_MODE freqTable[] = MV_SAR_FREQ_MODES;
 	MV_U32 freqModeSatRValue = mvCtrlSatRRead(MV_SATR_CPU_FREQ);
-	if (MV_ERROR !=freqModeSatRValue )
-	{
+	if (MV_ERROR != freqModeSatRValue) {
 		*freqMode = freqTable[freqModeSatRValue];
 		return MV_OK;
 	}
@@ -359,7 +358,7 @@ void mvCtrlSatrInit(void)
 	int i = 0;
 
 	/* initialize all S@R & Board configuration fields to -1 (MV_ERROR) */
-	memset(&satrOptionsConfig, 0xff, (sizeof(MV_U32)*MV_SATR_READ_MAX_OPTION) );
+	memset(&satrOptionsConfig, 0xff, (sizeof(MV_U32) * MV_SATR_READ_MAX_OPTION) );
 
 	for (i = 0; i < MV_CONFIG_TYPE_MAX_OPTION; i++)
 		boardOptionsConfig[i] = MV_ERROR;
@@ -378,14 +377,14 @@ void mvCtrlSatrInit(void)
 	/*Read rest of Board Configuration, EEPROM / Deep Switch access read : */
 	tempVal[0] = mvBoardTwsiGet(BOARD_DEV_TWSI_EEPROM, 0, 0);               /* EEPROM Reg#0 */
 	tempVal[1] = mvBoardTwsiGet(BOARD_DEV_TWSI_EEPROM, 0, 1);               /* EEPROM Reg#1 */
-	if (((MV_8)MV_ERROR == (MV_8)tempVal[0]) || ((MV_8)MV_ERROR == (MV_8)tempVal[1]) ) { 
+	if (((MV_8)MV_ERROR == (MV_8)tempVal[0]) || ((MV_8)MV_ERROR == (MV_8)tempVal[1]) ) {
 		/* EEPROM is not valid , data is jumpered to deep switch- read from there */
 		tempVal[0] = mvBoardTwsiGet(BOARD_DEV_TWSI_IO_EXPANDER, 0, 0);  /* Deep Switch Reg#0 */
 		tempVal[1] = mvBoardTwsiGet(BOARD_DEV_TWSI_IO_EXPANDER, 0, 1);  /* Deep Switch Reg#1 */
 		/* omriii : verify reads from BOARD_DEV_TWSI_IO_EXPANDER are correct */
 	}
 
-	if (((MV_8)MV_ERROR == (MV_8)tempVal[0]) || ((MV_8)MV_ERROR == (MV_8)tempVal[1]))       
+	if (((MV_8)MV_ERROR == (MV_8)tempVal[0]) || ((MV_8)MV_ERROR == (MV_8)tempVal[1]))
 		/* Deep Switch reading failed - omriii : use defaults (which iszeros for all fields) ??? */
 		tempVal[0] = tempVal[1] = 0x0;
 
@@ -394,6 +393,7 @@ void mvCtrlSatrInit(void)
 		if ( mvBoardConfigTypeGet(i, &confInfo) && confInfo.isActiveForBoard[mvBoardIdGet()])
 			boardOptionsConfig[confInfo.configid] = ((tempVal[confInfo.regNum] & (confInfo.mask)) >> confInfo.offset);
 }
+
 /*******************************************************************************
 * mvCtrlDevFamilyIdGet - Get Device ID
 *
@@ -917,14 +917,8 @@ MV_U32 mvCtrlModelRevGet(MV_VOID)
 *******************************************************************************/
 MV_STATUS mvCtrlModelRevNameGet(char *pNameBuff)
 {
-	switch (mvCtrlModelRevGet()) {
-	case MV_78130_Z1_ID:
-		mvOsSPrintf(pNameBuff, "%s", MV_78130_Z1_NAME);
-		break;
-	default:
-		mvCtrlNameGet(pNameBuff);
-	}
-
+	/* mvCtrlModelRevGet(); */
+	mvCtrlNameGet(pNameBuff);
 	return MV_OK;
 }
 
@@ -1063,11 +1057,11 @@ MV_VOID mvCtrlAddrDecShow(MV_VOID)
 #if defined(MV_ETH_LEGACY)
 	mvUnitAddrDecShow(mvCtrlEthMaxPortGet(), ETH_GIG_UNIT_ID, "ETH", mvEthWinRead);
 #elif defined(CONFIG_MV_ETH_NETA)
- 	mvUnitAddrDecShow(mvCtrlEthMaxPortGet(), ETH_GIG_UNIT_ID, "ETH", mvNetaWinRead);
+	mvUnitAddrDecShow(mvCtrlEthMaxPortGet(), ETH_GIG_UNIT_ID, "ETH", mvNetaWinRead);
 #else
 	mvUnitAddrDecShow(mvCtrlEthMaxPortGet(), ETH_GIG_UNIT_ID, "ETH", mvPp2WinRead);
-#endif
-#endif
+#endif  /* MV_ETH_LEGACY  or NETA pr PP2 */
+#endif  /* MV_INCLUDE_GIG_ETH */
 
 #if defined(MV_INCLUDE_XOR)
 	mvUnitAddrDecShow(mvCtrlXorMaxChanGet(), XOR_UNIT_ID, "XOR", mvXorTargetWinRead);
@@ -1666,7 +1660,7 @@ MV_BOOL mvCtrlPwrMemGet(MV_UNIT_ID unitId, MV_U32 index)
 	MV_BOOL state = MV_TRUE;
 
 	switch (unitId) {
-	MV_U32 reg;
+		MV_U32 reg;
 #if defined(MV_INCLUDE_PEX)
 	case PEX_UNIT_ID:
 		reg = MV_REG_READ(POWER_MNG_MEM_CTRL_REG(PMC_MCR_NUM_PEX));
@@ -1760,28 +1754,6 @@ MV_BOOL mvCtrlPwrClckGet(MV_UNIT_ID unitId, MV_U32 index)
 
 #endif /* #if defined(MV_INCLUDE_CLK_PWR_CNTRL) */
 
-/*******************************************************************************
-* mvCtrlSerdesMaxLinesGet - Get Marvell controller number of SERDES lines.
-*
-* DESCRIPTION:
-*       This function returns Marvell controller number of SERDES lines.
-*
-* INPUT:
-*       None.
-*
-* OUTPUT:
-*       None.
-*
-* RETURN:
-*       Marvell controller number of PEX units. If controller
-*		ID is undefined the function returns '0'.
-*
-*******************************************************************************/
-MV_U32 mvCtrlSerdesMaxLinesGet(MV_VOID)
-{
-	return 0;
-}
-
 MV_U32 mvCtrlDDRBudWidth(MV_VOID)
 {
 	MV_U32 reg;
@@ -1808,26 +1780,3 @@ MV_BOOL mvCtrlDDRECC(MV_VOID)
 
 	return (reg & (0x1 << REG_SDRAM_CONFIG_ECC_OFFS)) ? MV_TRUE : MV_FALSE;
 }
-
-static const MV_U8 serdesCfg[][8] = SERDES_CFG;
-
-/*******************************************************************************
-* mvCtrlSerdesPhyConfig
-*
-* DESCRIPTION:
-*	Configure Serdes MUX and init PHYs connected to SERDES lines.
-*
-* INPUT:
-*       None.
-*
-* OUTPUT:
-*       None.
-*
-* RETURN:
-*       Status
-*
-*******************************************************************************/
-MV_STATUS mvCtrlSerdesPhyConfig(MV_VOID)
-{
-	return MV_ERROR;
-}
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.h b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.h
index 845a4b5..c7c3062 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvLib.h
@@ -229,7 +229,7 @@ typedef struct _boardSerdesConf {
 #define SAR_CPU_FAB_GET(cpu, fab)       (((cpu & 0x7) << 21) | ((fab & 0xF) << 24))
 
 /* mcspLib.h API list */
-MV_STATUS mvCtrlSatRWrite(MV_SATR_TYPE_ID satrWriteField,MV_SATR_TYPE_ID satrReadField, MV_U8 val);
+MV_STATUS mvCtrlSatRWrite(MV_SATR_TYPE_ID satrWriteField, MV_SATR_TYPE_ID satrReadField, MV_U8 val);
 MV_U32 mvCtrlSatRRead(MV_SATR_TYPE_ID satrField);
 MV_STATUS mvCtrlCpuDdrL2FreqGet(MV_FREQ_MODE *freqMode);
 void mvCtrlSatrInit(MV_VOID);
@@ -275,7 +275,7 @@ MV_BOOL mvCtrlIsZarlinkTDM(MV_VOID);
 MV_BOOL mvCtrlIsExternalTDM(MV_VOID);
 MV_BOOL mvCtrlIsSiliconLabsTDM(MV_VOID);
 MV_U32 mvCtrlTdmUnitIrqGet(MV_VOID);
-
+MV_U32 mvCtrlDevFamilyIdGet(MV_U16 ctrlModel);
 MV_U16 mvCtrlModelGet(MV_VOID);
 MV_U8 mvCtrlRevGet(MV_VOID);
 MV_STATUS mvCtrlNameGet(char *pNameBuff);
@@ -297,9 +297,6 @@ MV_BOOL mvCtrlIsBootFromNOR(MV_VOID);
 MV_BOOL mvCtrlIsBootFromSPI(MV_VOID);
 MV_BOOL mvCtrlIsBootFromNAND(MV_VOID);
 MV_BOOL   mvCtrlPwrMemGet(MV_UNIT_ID unitId, MV_U32 index);
-
-MV_U32 mvCtrlSerdesMaxLinesGet(MV_VOID);
-MV_STATUS mvCtrlSerdesPhyConfig(MV_VOID);
 MV_U32 mvCtrlDDRBudWidth(MV_VOID);
 MV_BOOL mvCtrlDDRThruXbar(MV_VOID);
 MV_BOOL mvCtrlDDRECC(MV_VOID);
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h
index 31aa595..a86db95 100644
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvRegs.h
@@ -401,7 +401,6 @@ extern "C" {
 #define MV_CPU_CLK_TBL { 1000, 1066, 1200, 1333, 1500, 1666, 1800, 2000, \
 			 600,  667,  800, 1600, 2133, 2200, 2400, 0 }
 
-
 typedef enum {
 	MSAR_0_BOOT_NOR_FLASH,
 	MSAR_0_BOOT_NAND_NEW,
@@ -488,37 +487,37 @@ typedef struct {
 	char *l2Freq;
 } MV_FREQ_MODE;
 
-#define MV_SAR_FREQ_MODES {\
-	{0,  "266",  "266", "133" },\
-	{1,  "333",  "167", "167" },\
-	{2,  "333",  "222", "167" },\
-	{3,  "333",  "333", "167" },\
-	{4,  "400",  "200", "200" },\
-	{5,  "400",  "267", "200" },\
-	{6,  "400",  "400", "200" },\
-	{7,  "500",  "250", "250" },\
-	{8,  "500",  "334", "250" },\
-	{9,  "500",  "400", "250" },\
-	{10,  "533", "267", "267" },\
-	{11, "533",  "356", "267" },\
-	{12, "533",  "533", "267" },\
-	{13, "600",  "300", "300" },\
-	{14, "600",  "400", "300" },\
-	{15, "600",  "600", "300" },\
-	{16, "666",  "333", "333" },\
-	{17, "666",  "444", "333" },\
-	{18, "666",  "666", "333" },\
-	{19, "800",  "267", "400" },\
-	{20, "800",  "400", "400" },\
-	{21, "800",  "534", "400" },\
-	{22, "900",  "300", "450" },\
-	{23, "900",  "450", "450" },\
-	{24, "900",  "600", "450" },\
-	{25, "1000", "500", "500" },\
-	{26, "1000", "667", "500" },\
-	{27, "1000", "500", "333" },\
-	{28, "400",  "400", "400" },\
-	{29, "1100", "550", "550" }\
+#define MV_SAR_FREQ_MODES { \
+		{ 0,  "266",  "266", "133" }, \
+		{ 1,  "333",  "167", "167" }, \
+		{ 2,  "333",  "222", "167" }, \
+		{ 3,  "333",  "333", "167" }, \
+		{ 4,  "400",  "200", "200" }, \
+		{ 5,  "400",  "267", "200" }, \
+		{ 6,  "400",  "400", "200" }, \
+		{ 7,  "500",  "250", "250" }, \
+		{ 8,  "500",  "334", "250" }, \
+		{ 9,  "500",  "400", "250" }, \
+		{ 10,  "533", "267", "267" }, \
+		{ 11, "533",  "356", "267" }, \
+		{ 12, "533",  "533", "267" }, \
+		{ 13, "600",  "300", "300" }, \
+		{ 14, "600",  "400", "300" }, \
+		{ 15, "600",  "600", "300" }, \
+		{ 16, "666",  "333", "333" }, \
+		{ 17, "666",  "444", "333" }, \
+		{ 18, "666",  "666", "333" }, \
+		{ 19, "800",  "267", "400" }, \
+		{ 20, "800",  "400", "400" }, \
+		{ 21, "800",  "534", "400" }, \
+		{ 22, "900",  "300", "450" }, \
+		{ 23, "900",  "450", "450" }, \
+		{ 24, "900",  "600", "450" }, \
+		{ 25, "1000", "500", "500" }, \
+		{ 26, "1000", "667", "500" }, \
+		{ 27, "1000", "500", "333" }, \
+		{ 28, "400",  "400", "400" }, \
+		{ 29, "1100", "550", "550" } \
 };
 
 /* These macros help units to identify a target Mport Arbiter group */
@@ -593,65 +592,6 @@ typedef enum _mvTargetId {
 } MV_TARGET_ID;
 
 /*
-   typedef enum {
-        SERDES_UNIT_UNCONNECTED	= 0x0,
-        SERDES_UNIT_PEX		= 0x1,
-        SERDES_UNIT_SATA	= 0x2,
-        SERDES_UNIT_SGMII0	= 0x3,
-        SERDES_UNIT_SGMII1	= 0x4,
-        SERDES_UNIT_SGMII2	= 0x5,
-        SERDES_UNIT_SGMII3	= 0x6,
-        SERDES_UNIT_QSGMII	= 0x7
-   } MV_SERDES_UNIT_INDX;
- */
-
-/*
-        This structure refrect registers:
-        Serdes 0-7 selectors		0x18270
-        and Serdes 8-15 selectors       0x18274
- */
-#ifndef MV88F78X60_Z1
-#define SERDES_CFG {	\
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 0 */   \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 1 */   \
-		{ 0, 1, -1,  2, -1, -1, -1, -1 },       /* Lane 2 */   \
-		{ 0, 1, -1, -1,  2, -1, -1,  3 },       /* Lane 3 */   \
-		{ 0, 1,  2, -1, -1,  3, -1, -1 },       /* Lane 4 */   \
-		{ 0, 1,  2, -1,  3, -1, -1,  4 },       /* Lane 5 */   \
-		{ 0, 1,  2,  4, -1,  3, -1, -1 },       /* Lane 6 */   \
-		{ 0, 1, -1,  2, -1, -1,  3, -1 },       /* Lane 7*/    \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 8 */   \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 9 */   \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 10 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 11 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 12 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 13 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 14 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 } /* Lane 15 */	\
-}
-
-#else
-#define SERDES_CFG {	\
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 0 */   \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 1 */   \
-		{ 0, 1, -1,  2, -1, -1, -1, -1 },       /* Lane 2 */   \
-		{ 0, 1, -1, -1,  2, -1, -1, -1 },       /* Lane 3 */   \
-		{ 0, 1,  2, -1, -1,  3, -1, -1 },       /* Lane 4 */   \
-		{ 0, 1,  2, -1,  3, -1, -1,  4 },       /* Lane 5 */   \
-		{ 0, 1, -1, -1, -1,  2,  3, -1 },       /* Lane 6 */   \
-		{ 0, 1, -1,  2, -1, -1,  3, -1 },       /* Lane 7*/    \
-		{ 0, 1,  2, -1, -1, -1,  3,  4 },       /* Lane 8 */   \
-		{ 0, 1,  2,  3, -1, -1, -1, -1 },       /* Lane 9 */   \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 10 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 11 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 12 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 13 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 },       /* Lane 14 */  \
-		{ 0, 1, -1, -1, -1, -1, -1, -1 } /* Lane 15 */	\
-}
-#endif
-
-/*
         This enum should reflect the units numbers in register
         space which we will need when accessing the HW
  */
diff --git a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h
index de0c942..b4dac4d 100755
--- a/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h
+++ b/arch/arm/mach-avantalp/avanta_lp_family/ctrlEnv/mvCtrlEnvSpec.h
@@ -67,6 +67,7 @@
 
 #include "mvDeviceId.h"
 #include "mvSysHwConfig.h"
+
 #include "ctrlEnv/sys/mvCpuIfRegs.h"
 
 #ifdef __cplusplus
@@ -74,7 +75,7 @@ extern "C" {
 #endif /* __cplusplus */
 
 #define MV_ARM_SOC
-#define SOC_NAME_PREFIX				"MV88F"
+#define SOC_NAME_PREFIX                         "MV88F"
 
 /*
  * Avanta-LP Units Address decoding
@@ -83,179 +84,154 @@ extern "C" {
 #define MV_AURORA_L2_REGS_OFFSET                (0x8000)
 #define MV_RTC_REGS_OFFSET                      (0x10300)
 #define MV_DEV_BUS_REGS_OFFSET                  (0x10400)
-#define MV_SPI_REGS_OFFSET(unit)		(0x10600 + (unit * 0x80))
-#define MV_TWSI_SLAVE_REGS_OFFSET(chanNum)	(0x11000 + (chanNum * 0x100))
-#define MV_UART_REGS_OFFSET(chanNum)		(0x12000 + (chanNum * 0x100))
-#define MV_RUNIT_PMU_REGS_OFFSET		(0x1C000)
-#define MV_MPP_REGS_OFFSET			(0x18000)
-#define MV_GPP_REGS_OFFSET(unit)		(0x18100 + ((unit) * 0x40))
-#define MV_MISC_REGS_OFFSET			(0x18200)
-#define MV_CLK_CMPLX_REGS_OFFSET		(0x18700)
-#define MV_MBUS_REGS_OFFSET			(0x20000)
-#define CPU_GLOBAL_BASE				(MV_MBUS_REGS_OFFSET)
-#define MV_COHERENCY_FABRIC_OFFSET		(0x20200)
-#define MV_CIB_CTRL_STATUS_OFFSET		(0x20280)
-#define MV_CNTMR_REGS_OFFSET			(0x20300)
-#define MV_CPUIF_LOCAL_REGS_OFFSET		(0x21000)
-#define MV_CPUIF_REGS_OFFSET(cpu)		(0x21800 + (cpu) * 0x100)
-#define MV_PMU_NFABRIC_UNIT_SERV_OFFSET		(0x22000)
-#define MV_CPU_PMU_UNIT_SERV_OFFSET(cpu)	(0x22100 + (cpu) * 0x100)
-#define MV_CPU_HW_SEM_OFFSET			(0x20500)
-
-#if defined(CONFIG_MV_ETH_PP2)
-#define MV_PP2_REG_BASE				(0x80000)
-#define MV_ETH_BASE_ADDR			(0x50000)
-#define LMS_REG_BASE				(MV_ETH_BASE_ADDR)
-#define MIB_COUNTERS_REG_BASE			(MV_ETH_BASE_ADDR + 0x1000)
-#define GOP_MNG_REG_BASE			(MV_ETH_BASE_ADDR + 0x3000)
-#define GOP_REG_BASE(port)			(MV_ETH_BASE_ADDR + 0x4000 + ((port) / 2) * 0x3000 + ((port) % 2) * 0x1000)
-#define MV_PON_REGS_OFFSET			(MV_ETH_BASE_ADDR + 0x8000)
-
-#define MV_ETH_MAX_TCONT			16
-#define MV_PON_PORT_ID				7
-#define MV_ETH_RXQ_TOTAL_NUM			32
-#define MV_VLAN_1_TYPE				0x88A8
+#define MV_SPI_REGS_OFFSET(unit)                (0x10600 + (unit * 0x80))
+#define MV_TWSI_SLAVE_REGS_OFFSET(chanNum)      (0x11000 + (chanNum * 0x100))
+#define MV_UART_REGS_OFFSET(chanNum)            (0x12000 + (chanNum * 0x100))
+#define MV_RUNIT_PMU_REGS_OFFSET                (0x1C000)
+#define MV_MPP_REGS_OFFSET                      (0x18000)
+#define MV_GPP_REGS_OFFSET(unit)                (0x18100 + ((unit) * 0x40))
+#define MV_MISC_REGS_OFFSET                     (0x18200)
+#define MV_CLK_CMPLX_REGS_OFFSET        		(0x18700)
+#define MV_MBUS_REGS_OFFSET                     (0x20000)
+#define CPU_GLOBAL_BASE                         (MV_MBUS_REGS_OFFSET)
+#define MV_COHERENCY_FABRIC_OFFSET              (0x20200)
+#define MV_CIB_CTRL_STATUS_OFFSET               (0x20280)
+#define MV_CNTMR_REGS_OFFSET                    (0x20300)
+#define MV_CPUIF_LOCAL_REGS_OFFSET              (0x21000)
+#define MV_CPUIF_REGS_OFFSET(cpu)               (0x21800 + (cpu) * 0x100)
+#define MV_PMU_NFABRIC_UNIT_SERV_OFFSET         (0x22000)
+#define MV_CPU_PMU_UNIT_SERV_OFFSET(cpu)        (0x22100 + (cpu) * 0x100)
+#define MV_CPU_HW_SEM_OFFSET                    (0x20500)
+
+#if defined(MV_ETH_PP2)
+
+#define MV_PP2_REG_BASE                         (0x80000)
+#define MV_ETH_BASE_ADDR                        (0x50000)
+#define LMS_REG_BASE                            (MV_ETH_BASE_ADDR)
+#define MIB_COUNTERS_REG_BASE                   (MV_ETH_BASE_ADDR + 0x1000)
+#define GOP_MNG_REG_BASE                        (MV_ETH_BASE_ADDR + 0x3000)
+#define GOP_REG_BASE(port)                      (MV_ETH_BASE_ADDR + 0x4000 + ((port) / 2) * 0x3000 + ((port) % 2) * 0x1000)
+#define MV_PON_REGS_OFFSET                      (MV_ETH_BASE_ADDR + 0x8000)
+
+#define MV_ETH_MAX_TCONT                        16
+#define MV_PON_PORT_ID                          7
+#define MV_ETH_RXQ_TOTAL_NUM                    32
+#define MV_VLAN_1_TYPE                          0x88A8
 
 #elif defined(MV_ETH_LEGACY)
-	#define MV_ETH_BASE_ADDR		(0x72000)
-#else
-	#define MV_ETH_BASE_ADDR		(0x70000)
-#endif
-#define MV_ETH_REGS_OFFSET(port)		(MV_ETH_BASE_ADDR - ((port) / 2) * 0x40000 + ((port) % 2) * 0x4000)
-
-#define MV_PEX_IF_REGS_OFFSET(pexIf)		(pexIf < 8 ? (0x40000 + ((pexIf) / 4) * 0x40000 + ((pexIf) % 4) * 0x4000) \
-											 : (0x42000 + ((pexIf) % 8) * 0x40000))
-#define MV_USB_REGS_OFFSET(dev)       		(0x50000 + (dev * 0x1000))
-#define MV_XOR_REGS_OFFSET(unit)		(unit ? 0xF0900 : 0x60900)
-#define MV_CESA_TDMA_REGS_OFFSET(chanNum)	(0x90000 + (chanNum * 0x2000))
-#define MV_CESA_REGS_OFFSET(chanNum)		(0x9D000 + (chanNum * 0x2000))
-#define MV_SATA_REGS_OFFSET			(0xA0000)
-#define MV_COMM_UNIT_REGS_OFFSET		(0xB0000)
-#define MV_NFC_REGS_OFFSET			(0xD0000)
-#define MV_BM_REGS_OFFSET			(0xC0000)
-#define MV_PNC_REGS_OFFSET			(0xC8000)
-#define MV_SDMMC_REGS_OFFSET			(0xD4000)
-
-
-#ifdef CONFIG_ARMADA_XP_ERRATA_SMI_1
-	#define MV_ETH_SMI_PORT   1
+	#define MV_ETH_BASE_ADDR                (0x72000)
 #else
-	#define MV_ETH_SMI_PORT   0
+	#define MV_ETH_BASE_ADDR                (0x70000)
 #endif
-
-#define MV_SERDES_NUM_TO_PEX_NUM(sernum)	((sernum < 8) ? (sernum) : (8 + (sernum/12)))
+#define MV_ETH_REGS_OFFSET(port)                (MV_ETH_BASE_ADDR - ((port) / 2) * 0x40000 + ((port) % 2) * 0x4000)
+
+#define MV_PEX_IF_REGS_OFFSET(pexIf)            (pexIf < 8 ? (0x40000 + ((pexIf) / 4) * 0x40000 + ((pexIf) % 4) * 0x4000) \
+						 : (0x42000 + ((pexIf) % 8) * 0x40000))
+#define MV_USB_REGS_OFFSET(dev)                 (0x50000 + (dev * 0x1000))
+#define MV_XOR_REGS_OFFSET(unit)                (unit ? 0xF0900 : 0x60900)
+#define MV_CESA_TDMA_REGS_OFFSET(chanNum)       (0x90000 + (chanNum * 0x2000))
+#define MV_CESA_REGS_OFFSET(chanNum)            (0x9D000 + (chanNum * 0x2000))
+#define MV_SATA_REGS_OFFSET                     (0xA0000)
+#define MV_COMM_UNIT_REGS_OFFSET                (0xB0000)
+#define MV_NFC_REGS_OFFSET                      (0xD0000)
+#define MV_BM_REGS_OFFSET                       (0xC0000)
+#define MV_PNC_REGS_OFFSET                      (0xC8000)
+#define MV_SDMMC_REGS_OFFSET                    (0xD4000)
+
+#define MV_ETH_SMI_PORT   0
+
+#define MV_SERDES_NUM_TO_PEX_NUM(sernum)        ((sernum < 8) ? (sernum) : (8 + (sernum / 12)))
 /*
  * Miscellanuous Controller Configurations
  */
 
-#define AVS_CONTROL2_REG			0x20868
-#define AVS_LOW_VDD_LIMIT			0x20860
+#define AVS_CONTROL2_REG                        0x20868
+#define AVS_LOW_VDD_LIMIT                       0x20860
 
-#define INTER_REGS_SIZE				_1M
+#define INTER_REGS_SIZE                         _1M
 
 /* This define describes the TWSI interrupt bit and location */
-#define TWSI_CPU_MAIN_INT_CAUSE_REG(cpu)	CPU_MAIN_INT_CAUSE_REG(1, (cpu))
-#define TWSI0_CPU_MAIN_INT_BIT(ch)		((ch) + 3)
-#define TWSI_SPEED				100000
-
-#define MV_GPP_MAX_PINS				68
-#define MV_GPP_MAX_GROUP    			3 /* group == configuration register? */
-#ifndef MV88F78X60_Z1
-#define MV_CNTMR_MAX_COUNTER 		8 /* 4 global + 1 global WD + 2 current private CPU + 1 private CPU WD*/
-#else
-#define MV_CNTMR_MAX_COUNTER 		17/* 4 global + 1 global WD + 2 per CPU + 4 CPU WD*/
-#endif
-/*
-	MV88F78X60_Z1								MV88F78X60_A0
-	-------------------------------             -------------------------------
-	Global Counters 0-3  : 0-3         		    Global Counters 0-3  		: 0-3
-	Global WD            : 4                    Global WD            		: 4
+#define TWSI_CPU_MAIN_INT_CAUSE_REG(cpu)        CPU_MAIN_INT_CAUSE_REG(1, (cpu))
+#define TWSI0_CPU_MAIN_INT_BIT(ch)              ((ch) + 3)
+#define TWSI_SPEED                              100000
 
-	CPU 0 Counter 0-1    : 5-6					Private CPU Counter 0-1    : 5-6
-	CPU 0 WD             : 7                    Private CPU WD             : 7
-	CPU 1 Counter 0-1    : 8-9
-	CPU 1 WD             : 10
-	CPU 2 Counter 0-1    : 11-12
-	CPU 2 WD             : 13
-	CPU 3 Counter 0-1    : 14-15
-	CPU 3 WD             : 16
-*/
+#define MV_GPP_MAX_PINS                         68
+#define MV_GPP_MAX_GROUP                        3       /* group == configuration register? */
+#define MV_CNTMR_MAX_COUNTER            17              /* 4 global + 1 global WD + 2 per CPU + 4 CPU WD*/
 
-#define MV_UART_MAX_CHAN			4
+#define MV_UART_MAX_CHAN                        4
 
-#define MV_XOR_MAX_UNIT				2 /* XOR unit == XOR engine */
-#define MV_XOR_MAX_CHAN         		4 /* total channels for all units together*/
-#define MV_XOR_MAX_CHAN_PER_UNIT		2 /* channels for units */
+#define MV_XOR_MAX_UNIT                         2       /* XOR unit == XOR engine */
+#define MV_XOR_MAX_CHAN                         4       /* total channels for all units together*/
+#define MV_XOR_MAX_CHAN_PER_UNIT                2       /* channels for units */
 
-#define MV_SATA_MAX_CHAN			2
+#define MV_SATA_MAX_CHAN                        2
 
-#define MV_MPP_MAX_GROUP			9
+#define MV_MPP_MAX_GROUP                        9
 
-#define MV_DRAM_MAX_CS				4
-#define MV_SPI_MAX_CS				8
+#define MV_DRAM_MAX_CS                          4
+#define MV_SPI_MAX_CS                           8
 /* This define describes the maximum number of supported PCI\PCIX Interfaces */
 #ifdef MV_INCLUDE_PCI
-	#define MV_PCI_MAX_IF			1
-	#define MV_PCI_START_IF			0
-	#define PCI_HOST_BUS_NUM(pciIf)		(pciIf)
-	#define PCI_HOST_DEV_NUM(pciIf)		0
+	#define MV_PCI_MAX_IF                   1
+	#define MV_PCI_START_IF                 0
+	#define PCI_HOST_BUS_NUM(pciIf)         (pciIf)
+	#define PCI_HOST_DEV_NUM(pciIf)         0
 #else
-	#define MV_PCI_MAX_IF			0
-	#define MV_PCI_START_IF			0
+	#define MV_PCI_MAX_IF                   0
+	#define MV_PCI_START_IF                 0
 #endif
 
 /* This define describes the maximum number of supported PEX Interfaces */
-#define MV_PEX_MAX_IF				10
-#define MV_PEX_MAX_UNIT				4
+#define MV_PEX_MAX_IF                           10
+#define MV_PEX_MAX_UNIT                         4
 #ifdef MV_INCLUDE_PEX
 #define MV_INCLUDE_PEX0
 #define MV_DISABLE_PEX_DEVICE_BAR
 
-#define MV_PEX_START_IF				MV_PCI_MAX_IF
+#define MV_PEX_START_IF                         MV_PCI_MAX_IF
  #define PEX_HOST_BUS_NUM(pciIf)               (pciIf)
  #define PEX_HOST_DEV_NUM(pciIf)               0
 #else
  #undef MV_INCLUDE_PEX0
 #endif
 
-#define PCI_IO(pciIf)				(PEX0_IO + 2 * (pciIf))
-#define PCI_MEM(pciIf, memNum)			(PEX0_MEM0 + 2 * (pciIf))
-/* This define describes the maximum number of supported PCI Interfaces 	*/
-#define MV_IDMA_MAX_CHAN			4
-#define MV_DEVICE_MAX_CS      			4
+#define PCI_IO(pciIf)                           (PEX0_IO + 2 * (pciIf))
+#define PCI_MEM(pciIf, memNum)                  (PEX0_MEM0 + 2 * (pciIf))
+/* This define describes the maximum number of supported PCI Interfaces         */
+#define MV_IDMA_MAX_CHAN                        4
+#define MV_DEVICE_MAX_CS                        4
 
 #ifndef MV_USB_MAX_PORTS
 #define MV_USB_MAX_PORTS 3
 #endif
 
-
 /* CESA version #3: One channel, 2KB SRAM, TDMA, CHAIN Mode support */
-#define MV_CESA_VERSION				3 /*TODO verify */
-#define MV_CESA_SRAM_SIZE               	(2 * 1024)
-
+#define MV_CESA_VERSION                         3 /*TODO verify */
+#define MV_CESA_SRAM_SIZE                       (2 * 1024)
 
 /* This define describes the maximum number of supported Ethernet ports */
 /* TODO - verify all these numbers */
 
 #if defined(CONFIG_MV_ETH_PP2)
-#define MV_PON_PORT_ID                  	7
+#define MV_PON_PORT_ID                          7
 #define MV_ETH_MAX_PORTS                        4
-#define MV_ETH_MAX_RXQ                          16 /* Maximum number of RXQs can be mapped to each port */
+#define MV_ETH_MAX_RXQ                          16      /* Maximum number of RXQs can be mapped to each port */
 #define MV_ETH_MAX_TXQ                          8
-#define MV_ETH_RXQ_TOTAL_NUM           		32 /* Total number of RXQs for usage by all ports */
-#define MV_ETH_MAX_TCONT 			16 /* Maximum number of TCONTs supported by PON port */
+#define MV_ETH_RXQ_TOTAL_NUM                    32      /* Total number of RXQs for usage by all ports */
+#define MV_ETH_MAX_TCONT                        16      /* Maximum number of TCONTs supported by PON port */
 #define MV_ETH_TX_CSUM_MAX_SIZE                 9800
 #else
-#define MV_ETH_VERSION 				4 /* for Legacy mode */
-#define MV_NETA_VERSION				1 /* for NETA mode */
-#define MV_ETH_MAX_PORTS			4
-#define MV_ETH_MAX_RXQ              		8
-#define MV_ETH_MAX_TXQ              		8
-#define MV_ETH_TX_CSUM_MAX_SIZE 		9800
-#define MV_PNC_TCAM_LINES			1024	/* TCAM num of entries */
-#endif
+#define MV_ETH_VERSION                          4       /* for Legacy mode */
+#define MV_NETA_VERSION                         1       /* for NETA mode */
+#define MV_ETH_MAX_PORTS                        4
+#define MV_ETH_MAX_RXQ                          8
+#define MV_ETH_MAX_TXQ                          8
+#define MV_ETH_TX_CSUM_MAX_SIZE                 9800
+#define MV_PNC_TCAM_LINES                       1024    /* TCAM num of entries */
+
+#endif /* CONFIG_MV_ETH_PP2 */
 
-#if defined(MV88F78X60) && !defined(MV88F78X60_Z1)
 /* New GMAC module is used */
 #define MV_ETH_GMAC_NEW
 /* New WRR/EJP module is used */
@@ -266,16 +242,13 @@ extern "C" {
 #define MV_ETH_PNC_NEW
 /* PNC Load Balancing support */
 #define MV_ETH_PNC_LB
-#endif /* MV88F78X60_A0/B0 */
 
-#define MV_78130_ETH_MAX_PORT			3
-#define MV_78460_ETH_MAX_PORT			4
-#define MV_FPGA_ETH_MAX_PORT			4
+#define MV_FPGA_ETH_MAX_PORT                    4
 
 /* This define describes the the support of USB */
-#define MV_USB_VERSION  			1
+#define MV_USB_VERSION                          1
 
-#define MV_SPI_VERSION				2
+#define MV_SPI_VERSION                          2
 
 #define MV_INCLUDE_SDRAM_CS0
 #undef  MV_INCLUDE_SDRAM_CS1
@@ -290,7 +263,7 @@ extern "C" {
 #ifndef MV_ASMLANGUAGE
 
 #define TBL_UNUSED      0       /* Used to mark unused entry */
-#define FREQ_MODES_NUM		29
+#define FREQ_MODES_NUM          29
 
 #define MPP_GROUP_0_TYPE { \
 		0x11111111,     /* NAND_V2_BOOT_DEVICE  */ \
@@ -640,4 +613,4 @@ typedef enum _mvTarget {
 }
 #endif  /* __cplusplus */
 
-#endif  /* __INCmvCtrlEnvSpech */
+#endif  /* __INCmvCtrlEnvSpech */
\ No newline at end of file
-- 
1.7.5.4

