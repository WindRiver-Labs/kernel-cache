From fe8969ba1394efc01784bf4b4ca33bb3660ebd9d Mon Sep 17 00:00:00 2001
From: Kosta Zertsekel <konszert@marvell.com>
Date: Sun, 14 Jul 2013 17:15:34 +0300
Subject: [PATCH 0821/1825] alp: iocc: Replace IOCC Sync Barrier with 1 usec
 delay

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit b0b7dcf34033131e46f490a5c8468efbf98f1a2a

Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Change-Id: I45ed0a7c1a6ec5c074ae3d2ed60f94b66111565e
Reviewed-on: http://vgitil04.il.marvell.com:8080/2616
Tested-by: Star_Automation <star@marvell.com>
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-avantalp/core.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-avantalp/core.c b/arch/arm/mach-avantalp/core.c
index 1dcd64a..bd474ea 100644
--- a/arch/arm/mach-avantalp/core.c
+++ b/arch/arm/mach-avantalp/core.c
@@ -1275,6 +1275,9 @@ void *io_sync_virt_addr_for_write;
 
 void dma_io_sync(void)
 {
+#if 1
+	udelay(1);
+#else
 	unsigned long flags;
 	u32 val = 0;
 	u32 *virt_uncached = (u32 *)(SZ_1K + CRYPT_ENG_VIRT_BASE(0));
@@ -1302,6 +1305,7 @@ void dma_io_sync(void)
 	} while (val != 1);
 
 	spin_unlock_irqrestore(&alp_io_sync_barrier_lock, flags);
+#endif
 }
 EXPORT_SYMBOL(dma_io_sync);
 
-- 
1.7.5.4

