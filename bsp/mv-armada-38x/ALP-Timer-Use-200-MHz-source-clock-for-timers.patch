From 412ffcad821a08256fe638ccd943c4c814ba0aa5 Mon Sep 17 00:00:00 2001
From: Kosta Zertsekel <konszert@marvell.com>
Date: Sun, 5 May 2013 08:54:49 +0300
Subject: [PATCH 0638/1825] ALP: Timer: Use 200 MHz source clock for timers

https://github.com/MISL-EBU-System-SW/misl-windriver.git linux-3.4.69-14t2-read
commit e6b4a0cfc4ea01eabc3f2de0351f8f6615289e7a

Signed-off-by: Kosta Zertsekel <konszert@marvell.com>
Change-Id: I8250032d97ae6ada7a413f7e460efc8f334a7cba
Reviewed-on: http://vgitil04.il.marvell.com:8080/1751
Reviewed-by: Eran Ben-Avi <benavi@marvell.com>
Tested-by: Eran Ben-Avi <benavi@marvell.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/mach-avantalp/time.c |   10 +++-------
 1 files changed, 3 insertions(+), 7 deletions(-)

diff --git a/arch/arm/mach-avantalp/time.c b/arch/arm/mach-avantalp/time.c
index 23c8605..4f5c04a 100644
--- a/arch/arm/mach-avantalp/time.c
+++ b/arch/arm/mach-avantalp/time.c
@@ -106,7 +106,7 @@ static void alp_clkevt_mode(enum clock_event_mode mode, struct clock_event_devic
 
 		/* Enable timer */
 		u = MV_REG_READ(TIMER_CTRL);
-		u |= TIMER_EN(t) | TIMER_RELOAD_EN(t) | TIMER_TURN_25MHZ(t);
+		u |= TIMER_EN(t) | TIMER_RELOAD_EN(t);
 		MV_REG_WRITE(TIMER_CTRL, u);
 	} else {
 		/* Disable timer */
@@ -211,11 +211,7 @@ static void alp_setup_clocksource(int timer, long rate)
 
 	/* Config clock source for timer */
 	u = MV_REG_READ(TIMER_CTRL);
-#if !defined(CONFIG_MACH_AVANTA_LP_FPGA)
-	u |= (TIMER_EN(i) | TIMER_RELOAD_EN(i) | TIMER_TURN_25MHZ(i));
-#else
-	u |= (TIMER_EN(i) | TIMER_RELOAD_EN(i));
-#endif
+	u |= TIMER_EN(i) | TIMER_RELOAD_EN(i);
 	MV_REG_WRITE(TIMER_CTRL, u);
 
 	clocksource_mmio_init(base, "alp_clk_source",
@@ -260,7 +256,7 @@ static void __init alp_timer_init(void)
 #ifdef CONFIG_MACH_AVANTA_LP_FPGA
 	rate = 12500000;
 #else
-	rate = 12500000;
+	rate = 200000000;
 #endif
 
 	printk("Initializing AvantaLP SoC Timers\n");
-- 
1.7.5.4

