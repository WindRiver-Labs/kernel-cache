From bc7918cd490868078319b2d8efca864914338c1a Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Thu, 30 Oct 2008 17:39:48 +0800
Subject: [PATCH] emer_atcaf101 dts updates for flash protection

This modifies the flash portions of the dts to protect vulnerable
blocks. Other changes include additional flash support and a
bootargs template.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/boot/dts/prpmc2800.dts |   21 +++++++++++++++------
 1 files changed, 15 insertions(+), 6 deletions(-)

diff --git a/arch/powerpc/boot/dts/prpmc2800.dts b/arch/powerpc/boot/dts/prpmc2800.dts
index 1ee6ff4..5383a1d 100644
--- a/arch/powerpc/boot/dts/prpmc2800.dts
+++ b/arch/powerpc/boot/dts/prpmc2800.dts
@@ -62,11 +62,11 @@
 			reg = <0xa0000000 0x4000000>; /* Default (64MB) */
 			probe-type = "CFI";
 			bank-width = <4>;
-			partitions = <0x00000000 0x00100000 /* RO */
-				      0x00100000 0x00040001 /* RW */
-				      0x00140000 0x00400000 /* RO */
-				      0x00540000 0x039c0000 /* RO */
-				      0x03f00000 0x00100000>; /* RO */
+			partitions = <0x00000000 0x00100001 /* RO */
+				      0x00100000 0x00040001 /* RO */
+				      0x00140000 0x00400000 /* RW */
+				      0x00540000 0x039c0000 /* RW */
+				      0x03f00000 0x00100001>; /* RO */
 			partition-names = "FW Image A", "FW Config Data", "Kernel Image", "Filesystem", "FW Image B";
 		};
 
@@ -295,8 +295,17 @@
 		};
 	};
 
+	boot-flash@fff00000 {
+		compatible = "jedec-flash";
+		reg = <0xfff00000 0x100001>; /* 1MB */
+		probe-type = "JEDEC";
+		bank-width = <2>;
+		partitions = <0x00000000 0x00100001>; /* RO */
+		partition-names = "Boot-Flash ";
+	};
+
 	chosen {
-		bootargs = "ip=on";
+		bootargs = "root=/dev/nfs rw nfsroot=<server IP>:/<rootfs path> ip=<target IP>:<server IP>:<gateway IP>:<netmask IP>:atcaf101:eth2:off console=ttyMM0,9600";
 		linux,stdout-path = &MPSC0;
 	};
 };
-- 
1.6.0.90.g436ed

