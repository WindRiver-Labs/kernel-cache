From be5def48e5e03948428bcbd5a20d43d2b20cf11f Mon Sep 17 00:00:00 2001
From: Wally Gleemer <Wally.Gleemer@windriver.com>
Date: Thu, 13 Mar 2008 20:53:46 -0700
Subject: [PATCH] cavium: Treat hardware writes differently for cache

Enable cache mode 7 for Cavium -- this allows the hardware writes
to be treated independently from user writes.

Signed-off-by: Wally Gleemer <Wally.Gleemer@windriver.com>
---
 include/asm-mips/pgtable-bits.h |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/include/asm-mips/pgtable-bits.h b/include/asm-mips/pgtable-bits.h
index 0da0c7a..f63d43e 100644
--- a/include/asm-mips/pgtable-bits.h
+++ b/include/asm-mips/pgtable-bits.h
@@ -136,6 +136,12 @@
 #define PAGE_CACHABLE_DEFAULT	_CACHE_CACHABLE_NONCOHERENT
 #elif defined(CONFIG_CPU_RM9000)
 #define PAGE_CACHABLE_DEFAULT	_CACHE_CWB
+#elif defined(CONFIG_CPU_CAVIUM_OCTEON)
+/* Use cache mode 7 on Octeon. This cache region is marked special and can be
+ * write flushed seperately from other memory addresses. This allows us to
+ * flush hardware writes without flushing user writes
+ */
+#define PAGE_CACHABLE_DEFAULT	_CACHE_UNCACHED_ACCELERATED
 #else
 #define PAGE_CACHABLE_DEFAULT	_CACHE_CACHABLE_COW
 #endif
-- 
1.5.5.1

