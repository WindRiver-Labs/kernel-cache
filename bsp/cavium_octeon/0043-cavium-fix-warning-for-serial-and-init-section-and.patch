From ddd7e8b21fb1aa0a666b13fd295cedbbddcec82e Mon Sep 17 00:00:00 2001
From: Wally Gleemer <Wally.Gleemer@windriver.com>
Date: Tue, 25 Mar 2008 16:21:37 -0700
Subject: [PATCH] cavium: fix warning for serial and init section and request_irq.

Include the serial header for 8250 so that we don't get the compile
warning about implicit declarations.  Also mark one of the prom fcns
as __init and stash away the request_irq return value so gcc doesn't
nag nag nag.

Signed-off-by: Wally Gleemer <Wally.Gleemer@windriver.com>
---
 arch/mips/cavium-octeon/setup.c |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/arch/mips/cavium-octeon/setup.c b/arch/mips/cavium-octeon/setup.c
index 85795cf..4e819f6 100644
--- a/arch/mips/cavium-octeon/setup.c
+++ b/arch/mips/cavium-octeon/setup.c
@@ -17,6 +17,7 @@
 #include <linux/tty.h>
 #include <asm/time.h>
 #include <linux/serial_core.h>
+#include <linux/serial_8250.h>
 #include <linux/string.h>
 
 #include <asm/reboot.h>
@@ -987,10 +988,12 @@ void __init plat_mem_setup(void)
 }
 
 
-void prom_free_prom_memory(void)
+void __init prom_free_prom_memory(void)
 {
+	int r;
+
 	/* Add an interrupt handler for general failures. */
-	request_irq(OCTEON_IRQ_RML, octeon_rlm_interrupt, SA_SHIRQ, "RML Error",
+	r = request_irq(OCTEON_IRQ_RML, octeon_rlm_interrupt, IRQF_SHARED, "RML Error",
 		    octeon_rlm_interrupt);
 
 	/* Enable interrupt on IOB port SOP and EOP errors */
-- 
1.5.5.1

