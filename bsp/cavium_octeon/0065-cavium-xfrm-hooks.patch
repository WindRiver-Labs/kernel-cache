From 51c49f4dcf1e7beefb5ab7288fecd453d9b78e88 Mon Sep 17 00:00:00 2001
From: Wally Gleemer <Wally.Gleemer@windriver.com>
Date: Thu, 13 Mar 2008 21:13:22 -0700
Subject: [PATCH] cavium: xfrm hooks

Hook in the cavium specific xfrm optimizations, if they have been
enabled in the kernel config.

Signed-off-by: Wally Gleemer <Wally.Gleemer@windriver.com>
---
 include/net/xfrm.h |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/include/net/xfrm.h b/include/net/xfrm.h
index 0d255ae..92dd039 100644
--- a/include/net/xfrm.h
+++ b/include/net/xfrm.h
@@ -213,6 +213,10 @@ struct xfrm_state
 	/* Private data of this transformer, format is opaque,
 	 * interpreted by xfrm_type methods. */
 	void			*data;
+#if defined(CONFIG_CAVIUM_OCTEON_IPSEC) && defined(CONFIG_NET_KEY)
+	void			*sa_handle;
+	struct xfrm_policy	*pol;
+#endif  /* defined(CONFIG_CAVIUM_OCTEON_IPSEC) && defined(CONFIG_NET_KEY) */
 };
 
 /* xflags - make enum if more show up */
@@ -469,6 +473,9 @@ struct xfrm_policy
 	/* XXX 1 byte hole, try to pack */
 	struct xfrm_sec_ctx	*security;
 	struct xfrm_tmpl       	xfrm_vec[XFRM_MAX_DEPTH];
+#if defined(CONFIG_CAVIUM_OCTEON_IPSEC) && defined(CONFIG_NET_KEY)
+	struct xfrm_state      *x;
+#endif /* defined(CONFIG_CAVIUM_OCTEON_IPSEC) && defined(CONFIG_NET_KEY) */
 };
 
 struct xfrm_migrate {
-- 
1.5.5.1

