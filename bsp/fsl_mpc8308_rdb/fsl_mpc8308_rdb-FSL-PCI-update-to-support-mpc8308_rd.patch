From 167e19cdc08854633888282f6d394f3e17242132 Mon Sep 17 00:00:00 2001
From: Tonyliu <Bo.Liu@windriver.com>
Date: Mon, 9 Aug 2010 16:18:39 +0800
Subject: [PATCH 2/5] fsl_mpc8308_rdb: FSL PCI update to support mpc8308_rdb

mpc8308 and mpc8314 have same PCIe controller, both mpc8308_rdb
and mpc8314_rdb can share same init routine.
The mpc8308 specific PCIe routines in vendor drop ltib-mpc8308erdb-20100413
have already been merged into common FSL mpc83xx PCIe implementation on mainline,
so only needs to add mpc8308 pcie case in the init path.

Signed-off-by: Tonyliu <Bo.Liu@windriver.com>
---
 arch/powerpc/sysdev/fsl_pci.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/sysdev/fsl_pci.c b/arch/powerpc/sysdev/fsl_pci.c
index bd63dd7..a5fe79f 100644
--- a/arch/powerpc/sysdev/fsl_pci.c
+++ b/arch/powerpc/sysdev/fsl_pci.c
@@ -669,7 +669,8 @@ int __init mpc83xx_add_bridge(struct device_node *dev)
 	hose->first_busno = bus_range ? bus_range[0] : 0;
 	hose->last_busno = bus_range ? bus_range[1] : 0xff;
 
-	if (of_device_is_compatible(dev, "fsl,mpc8314-pcie")) {
+	if (of_device_is_compatible(dev, "fsl,mpc8314-pcie") ||
+			of_device_is_compatible(dev, "fsl,mpc8308-pcie")) {
 		ret = mpc83xx_pcie_setup(hose, &rsrc_reg);
 		if (ret)
 			goto err0;
-- 
1.6.5.2

