From 53293608ac73df42f2cd8e182129997623673477 Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Tue, 4 Nov 2008 14:45:49 +0800
Subject: [PATCH] Add kgdboe support on FEC driver

The net poll function definition already exists in
the FEC driver. Add the hook to the net device struct
so that netconsole and KGDBoE can make use of it.

Signed-off-by: Andrew Liu <shengping.liu@windriver.com>
---
 drivers/net/fs_enet/fs_enet-main.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/net/fs_enet/fs_enet-main.c b/drivers/net/fs_enet/fs_enet-main.c
index b75d27e..4c08c8c 100644
--- a/drivers/net/fs_enet/fs_enet-main.c
+++ b/drivers/net/fs_enet/fs_enet-main.c
@@ -1123,6 +1123,10 @@ static int __devinit fs_enet_probe(struct of_device *ofdev,
 	ndev->ethtool_ops = &fs_ethtool_ops;
 	ndev->do_ioctl = fs_ioctl;
 
+#ifdef CONFIG_NET_POLL_CONTROLLER
+	ndev->poll_controller = fs_enet_netpoll;
+#endif
+
 	init_timer(&fep->phy_timer_list);
 
 	netif_carrier_off(ndev);
-- 
1.6.0.90.g436ed

