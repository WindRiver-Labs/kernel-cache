From 913f570a76dffd076b5549569e136bfbca64cfcf Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Thu, 27 Nov 2008 16:56:48 +0800
Subject: [PATCH] Enabling RTC as wakeup source.

Enabling MPC5121 onchip RTC as wakeup source.

Add device_init_wakeup(&op->dev, 1) in probe
so wakealarm sysfs file will work.

Signed-off-by: Andrei Dolnikov <adolnikov@embeddedalley.com>
Signed-off-by: Andrew Liu <shengping.liu@windriver.com>
---
 drivers/rtc/rtc-mpc5121.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/rtc/rtc-mpc5121.c b/drivers/rtc/rtc-mpc5121.c
index 58a43b5..2568dfb 100644
--- a/drivers/rtc/rtc-mpc5121.c
+++ b/drivers/rtc/rtc-mpc5121.c
@@ -295,6 +295,8 @@ static int __devinit mpc5121_rtc_probe(struct of_device *op,
 	struct mpc5121_rtc_data *rtc;
 	int err = 0;
 
+	device_init_wakeup(&op->dev, 1);
+
 	rtc = kzalloc(sizeof(*rtc), GFP_KERNEL);
 	if (!rtc) {
 		err = -ENOMEM;
-- 
1.6.0.2.GIT

