From b7b4010a86454fc1d8ac0d53d44a0fd97896aeba Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Tue, 4 Nov 2008 14:45:54 +0800
Subject: [PATCH] Enable external(on board) RTC

There is a STM, M41t62 on board RTC chip on
MPC5121e ADS Rev 3 or higher version board.

Signed-off-by: Andrew Liu <shengping.liu@windriver.com>
---
 arch/powerpc/boot/dts/mpc5121ads.dts |    4 ++++
 drivers/rtc/Kconfig                  |    4 ++--
 drivers/rtc/rtc-m41t80.c             |    1 +
 3 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/boot/dts/mpc5121ads.dts b/arch/powerpc/boot/dts/mpc5121ads.dts
index 3dee690..082996c 100644
--- a/arch/powerpc/boot/dts/mpc5121ads.dts
+++ b/arch/powerpc/boot/dts/mpc5121ads.dts
@@ -217,6 +217,10 @@
 			interrupts = <9 0x8>;
 			interrupt-parent = < &ipic >;
 			fsl5200-clocking;
+			rtc@68 {
+				compatible = "stm,m41t62";
+				reg = <0x68>;
+			};
 		};
 
 		i2c@1720 {
diff --git a/drivers/rtc/Kconfig b/drivers/rtc/Kconfig
index 7c2dcf0..436e6a8 100644
--- a/drivers/rtc/Kconfig
+++ b/drivers/rtc/Kconfig
@@ -220,11 +220,11 @@ config RTC_DRV_PCF8583
 	  will be called rtc-pcf8583.
 
 config RTC_DRV_M41T80
-	tristate "ST M41T80/81/82/83/84/85/87"
+	tristate "ST M41T62/80/81/82/83/84/85/87"
 	help
 	  If you say Y here you will get support for the
 	  ST M41T80 RTC chips series. Currently following chips are
-	  supported: M41T80, M41T81, M41T82, M41T83, M41ST84, M41ST85
+	  supported: M41T62, M41T80, M41T81, M41T82, M41T83, M41ST84, M41ST85
 	  and M41ST87.
 
 	  This driver can also be built as a module. If so, the module
diff --git a/drivers/rtc/rtc-m41t80.c b/drivers/rtc/rtc-m41t80.c
index aa025eb..f70b22c 100644
--- a/drivers/rtc/rtc-m41t80.c
+++ b/drivers/rtc/rtc-m41t80.c
@@ -65,6 +65,7 @@
 #define DRV_VERSION "0.06"
 
 static const struct i2c_device_id m41t80_id[] = {
+	{ "m41t62", 0 },
 	{ "m41t80", 0 },
 	{ "m41t81", M41T80_FEATURE_HT },
 	{ "m41t81s", M41T80_FEATURE_HT | M41T80_FEATURE_BL },
-- 
1.6.0.90.g436ed

