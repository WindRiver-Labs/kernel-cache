From 5f6b63905b1ec5a61b51741c331a7f2669d75197 Mon Sep 17 00:00:00 2001
From: Jacek Danecki <Jacek.Danecki@intel.com>
Date: Tue, 14 Jan 2014 07:15:22 +0800
Subject: [PATCH 01/14] drm/i915: Add OCL mmio and L3 TLB registers to the
 parser whitelist

[Original patch was taken from Intel MediaSDK]

Signed-off-by: Zhipeng Gong <zhipeng.gong@intel.com>
Signed-off-by: Jacek Danecki <Jacek.Danecki@intel.com>
Signed-off-by: Pengyu Ma <pengyu.ma@windriver.com>
---
 drivers/gpu/drm/i915/i915_cmd_parser.c |    2 ++
 drivers/gpu/drm/i915/i915_reg.h        |    3 +++
 2 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_cmd_parser.c b/drivers/gpu/drm/i915/i915_cmd_parser.c
index 1e673a4..3c512c2 100644
--- a/drivers/gpu/drm/i915/i915_cmd_parser.c
+++ b/drivers/gpu/drm/i915/i915_cmd_parser.c
@@ -414,6 +414,8 @@ static const u32 gen7_render_regs[] = {
 	GEN7_3DPRIM_INSTANCE_COUNT,
 	GEN7_3DPRIM_START_INSTANCE,
 	GEN7_3DPRIM_BASE_VERTEX,
+	OCL_MMIO_REG1,
+	L3_TLB_REG_ADDRESS_OFFSET,
 	REG64(GEN7_SO_NUM_PRIMS_WRITTEN(0)),
 	REG64(GEN7_SO_NUM_PRIMS_WRITTEN(1)),
 	REG64(GEN7_SO_NUM_PRIMS_WRITTEN(2)),
diff --git a/drivers/gpu/drm/i915/i915_reg.h b/drivers/gpu/drm/i915/i915_reg.h
index d9780e2..be1522f 100644
--- a/drivers/gpu/drm/i915/i915_reg.h
+++ b/drivers/gpu/drm/i915/i915_reg.h
@@ -4825,11 +4825,14 @@ enum punit_power_well {
 #define GEN7_L3SQCREG1				0xB010
 #define  VLV_B0_WA_L3SQCREG1_VALUE		0x00D30000
 
+#define OCL_MMIO_REG1				0x2678
+
 #define GEN7_L3CNTLREG1				0xB01C
 #define  GEN7_WA_FOR_GEN7_L3_CONTROL			0x3C47FF8C
 #define  GEN7_L3AGDIS				(1<<19)
 #define GEN7_L3CNTLREG2				0xB020
 #define GEN7_L3CNTLREG3				0xB024
+#define L3_TLB_REG_ADDRESS_OFFSET		0x4040
 
 #define GEN7_L3_CHICKEN_MODE_REGISTER		0xB030
 #define  GEN7_WA_L3_CHICKEN_MODE				0x20000000
-- 
1.7.5.4

