From 067b8dfecce3924383e7492d349ab57f0c8600e8 Mon Sep 17 00:00:00 2001
From: Zhipeng Gong <zhipeng.gong@intel.com>
Date: Fri, 18 Jul 2014 09:40:00 +0800
Subject: [PATCH 09/14] drm/i915: Remove NON_SECURE bit for batch buffer
 validated by cmd parser

[Original patch was taken from Intel MediaSDK]

Signed-off-by: Zhipeng Gong <zhipeng.gong@intel.com>
Signed-off-by: Pengyu Ma <pengyu.ma@windriver.com>
---
 drivers/gpu/drm/i915/i915_gem_execbuffer.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_gem_execbuffer.c b/drivers/gpu/drm/i915/i915_gem_execbuffer.c
index 1a0611b..f51e988 100644
--- a/drivers/gpu/drm/i915/i915_gem_execbuffer.c
+++ b/drivers/gpu/drm/i915/i915_gem_execbuffer.c
@@ -1370,6 +1370,8 @@ i915_gem_do_execbuffer(struct drm_device *dev, void *data,
 				      file->is_master);
 		if (ret)
 			goto err;
+		else
+			flags |= I915_DISPATCH_SECURE;
 
 		/*
 		 * XXX: Actually do this when enabling batch copy...
-- 
1.7.5.4

