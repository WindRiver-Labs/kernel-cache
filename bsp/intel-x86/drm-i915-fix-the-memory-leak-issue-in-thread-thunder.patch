From 3e62c91fe1c1bf41c5edb4ea15357f1ddf8ad777 Mon Sep 17 00:00:00 2001
From: Zhipeng Gong <zhipeng.gong@intel.com>
Date: Tue, 24 Nov 2015 03:30:49 -0500
Subject: [PATCH 14/14] drm/i915: fix the memory leak issue in thread
 thundering patch

Call kfree for the allocated node

[Original patch was taken from Intel MediaSDK]

Signed-off-by: Zhipeng Gong <zhipeng.gong@intel.com>
Signed-off-by: Pengyu Ma <pengyu.ma@windriver.com>
---
 drivers/gpu/drm/i915/i915_gem.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_gem.c b/drivers/gpu/drm/i915/i915_gem.c
index e53d4f4..07a60bb 100644
--- a/drivers/gpu/drm/i915/i915_gem.c
+++ b/drivers/gpu/drm/i915/i915_gem.c
@@ -1291,6 +1291,8 @@ static int __wait_seqno(struct intel_engine_cs *ring, u32 seqno,
 			set_normalized_timespec(timeout, 0, 0);
 	}
 
+	kfree(node);
+
 	return ret;
 }
 
-- 
1.7.5.4

