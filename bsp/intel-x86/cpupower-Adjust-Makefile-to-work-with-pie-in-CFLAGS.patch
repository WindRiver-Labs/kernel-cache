From 45628ecd4aaaff7a0cc5ef7157754f647af07ccb Mon Sep 17 00:00:00 2001
From: Yuanjie Huang <yuanjie.huang@windriver.com>
Date: Tue, 28 Mar 2017 03:42:11 +0000
Subject: [PATCH] cpupower: Adjust Makefile to work with -pie in CFLAGS

In the link command of libcpupower.so -shared comes before CFLAGS,
which could confuse the compiler and result in link failure when
-pie is specified via CFLAGS. Address the issue by moving the option
after CFLAGS.

Signed-off-by: Yuanjie Huang <yuanjie.huang@windriver.com>
---
 tools/power/cpupower/Makefile |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/tools/power/cpupower/Makefile b/tools/power/cpupower/Makefile
index 2e2ba2e..2374ace 100644
--- a/tools/power/cpupower/Makefile
+++ b/tools/power/cpupower/Makefile
@@ -192,7 +192,7 @@ $(OUTPUT)lib/%.o: $(LIB_SRC) $(LIB_HEADERS)
 
 $(OUTPUT)libcpupower.so.$(LIB_MAJ): $(LIB_OBJS)
 	$(ECHO) "  LD      " $@
-	$(QUIET) $(CC) -shared $(CFLAGS) $(LDFLAGS) -o $@ \
+	$(QUIET) $(CC) $(CFLAGS) $(LDFLAGS) -shared -o $@ \
 		-Wl,-soname,libcpupower.so.$(LIB_MIN) $(LIB_OBJS)
 	@ln -sf $(@F) $(OUTPUT)libcpupower.so
 	@ln -sf $(@F) $(OUTPUT)libcpupower.so.$(LIB_MIN)
-- 
1.7.5.4

