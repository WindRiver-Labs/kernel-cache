From c86ba95e9d943007e9b934dbc53a8813cf8b27db Mon Sep 17 00:00:00 2001
From: Jacek Danecki <Jacek.Danecki@intel.com>
Date: Tue, 14 Jan 2014 07:15:20 +0800
Subject: [PATCH 04/14] drm/i915: Add MFC registers for Haswell

They are needed by mfx_transcoder_drm.

MFC_BITSTREAM_BYTECOUNT_FRAME - Reported Bitstream Output Byte Count per Frame Register
MFC_BITSTREAM_SE_BITCOUNT_FRAME - Reported Bitstream Output Bit Count for Syntax Elements Only Register
MFC_IMAGE_STATUS_MASK - MFC Image Status Mask
MFC_IMAGE_STATUS_CONTROL - MFC Image Status Control

[Original patch was taken from Intel MediaSDK]

Signed-off-by: Jacek Danecki <Jacek.Danecki@intel.com>
Signed-off-by: Pengyu Ma <pengyu.ma@windriver.com>
---
 drivers/gpu/drm/i915/i915_cmd_parser.c |    4 ++++
 drivers/gpu/drm/i915/i915_reg.h        |    4 ++++
 2 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_cmd_parser.c b/drivers/gpu/drm/i915/i915_cmd_parser.c
index 0124f96..163ecbc 100644
--- a/drivers/gpu/drm/i915/i915_cmd_parser.c
+++ b/drivers/gpu/drm/i915/i915_cmd_parser.c
@@ -454,6 +454,10 @@ static const u32 hsw_master_regs[] = {
 #undef REG64
 static const u32 gen7_vcs_regs[] = {
 	MFD_ERROR_STATUS,
+	MFC_BITSTREAM_BYTECOUNT_FRAME,
+	MFC_BITSTREAM_SE_BITCOUNT_FRAME,
+	MFC_IMAGE_STATUS_MASK,
+	MFC_IMAGE_STATUS_CONTROL,
 };
 
 static u32 gen7_render_get_cmd_length_mask(u32 cmd_header)
diff --git a/drivers/gpu/drm/i915/i915_reg.h b/drivers/gpu/drm/i915/i915_reg.h
index cfe1146..df5780c 100644
--- a/drivers/gpu/drm/i915/i915_reg.h
+++ b/drivers/gpu/drm/i915/i915_reg.h
@@ -6673,4 +6673,8 @@ enum punit_power_well {
 #define _PALETTE_B (dev_priv->info.display_mmio_offset + 0xa800)
 
 #define MFD_ERROR_STATUS 0x12400
+#define MFC_BITSTREAM_BYTECOUNT_FRAME 0x124A0
+#define MFC_BITSTREAM_SE_BITCOUNT_FRAME 0x124A4
+#define MFC_IMAGE_STATUS_MASK 0x124B4
+#define MFC_IMAGE_STATUS_CONTROL 0x124B8
 #endif /* _I915_REG_H_ */
-- 
1.7.5.4

