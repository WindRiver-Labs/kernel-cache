From c5138ef722793c5399f43dc18849f1e0d094cfb9 Mon Sep 17 00:00:00 2001
From: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Date: Thu, 27 Aug 2015 15:44:02 +0200
Subject: [PATCH 144/435] drm/i915: Set csc coefficients in update_pipe_size.

commit '44522d852f1979ec0e6807eb4dc58bd7ecc8af08' upstream

This might not have been set during boot, and when we preserve
the initial mode this can result in a black screen.

Cc: Daniel Stone <daniels@collabora.com>
Signed-off-by: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Reviewed-by: Jesse Barnes <jbarnes@virtuousgeek.org>
Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
Signed-off-by: Hu <yadi.hu@windriver.com>
---
 drivers/gpu/drm/i915/intel_display.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/i915/intel_display.c b/drivers/gpu/drm/i915/intel_display.c
index 15d434d..9fdf54e 100644
--- a/drivers/gpu/drm/i915/intel_display.c
+++ b/drivers/gpu/drm/i915/intel_display.c
@@ -3285,6 +3285,9 @@ static void intel_update_pipe_size(struct intel_crtc *crtc)
 	if (!i915.fastboot)
 		return;
 
+	if (HAS_DDI(dev))
+		intel_set_pipe_csc(&crtc->base);
+
 	/*
 	 * Update pipe size and adjust fitter if needed: the reason for this is
 	 * that in compute_mode_changes we check the native mode (not the pfit
-- 
1.7.5.4

