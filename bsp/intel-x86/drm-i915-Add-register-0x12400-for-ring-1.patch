From f951576aa185ca1be7095cb279621bf4a5cb229f Mon Sep 17 00:00:00 2001
From: Jacek Danecki <Jacek.Danecki@intel.com>
Date: Tue, 14 Jan 2014 07:15:20 +0800
Subject: [PATCH 03/14] drm/i915: Add register 0x12400 for ring 1

It is needed in media tests.

[Original patch was taken from Intel MediaSDK]

Signed-off-by: Jacek Danecki <Jacek.Danecki@intel.com>
Signed-off-by: Pengyu Ma <pengyu.ma@windriver.com>
---
 drivers/gpu/drm/i915/i915_cmd_parser.c |    5 +++++
 drivers/gpu/drm/i915/i915_reg.h        |    1 +
 2 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_cmd_parser.c b/drivers/gpu/drm/i915/i915_cmd_parser.c
index 74f1391..0124f96 100644
--- a/drivers/gpu/drm/i915/i915_cmd_parser.c
+++ b/drivers/gpu/drm/i915/i915_cmd_parser.c
@@ -452,6 +452,9 @@ static const u32 hsw_master_regs[] = {
 };
 
 #undef REG64
+static const u32 gen7_vcs_regs[] = {
+	MFD_ERROR_STATUS,
+};
 
 static u32 gen7_render_get_cmd_length_mask(u32 cmd_header)
 {
@@ -674,6 +677,8 @@ int i915_cmd_parser_init_ring(struct intel_engine_cs *ring)
 		cmd_tables = gen7_video_cmds;
 		cmd_table_count = ARRAY_SIZE(gen7_video_cmds);
 		ring->get_cmd_length_mask = gen7_bsd_get_cmd_length_mask;
+		ring->reg_table = gen7_vcs_regs;
+		ring->reg_count = ARRAY_SIZE(gen7_vcs_regs);
 		break;
 	case BCS:
 		if (IS_HASWELL(ring->dev)) {
diff --git a/drivers/gpu/drm/i915/i915_reg.h b/drivers/gpu/drm/i915/i915_reg.h
index be1522f..cfe1146 100644
--- a/drivers/gpu/drm/i915/i915_reg.h
+++ b/drivers/gpu/drm/i915/i915_reg.h
@@ -6672,4 +6672,5 @@ enum punit_power_well {
 #define _PALETTE_A (dev_priv->info.display_mmio_offset + 0xa000)
 #define _PALETTE_B (dev_priv->info.display_mmio_offset + 0xa800)
 
+#define MFD_ERROR_STATUS 0x12400
 #endif /* _I915_REG_H_ */
-- 
1.7.5.4

