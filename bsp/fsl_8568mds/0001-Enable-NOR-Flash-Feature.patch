From 7087e7d4a6ed0ebb06cabc867549761ff47b12d4 Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Thu, 2 Apr 2009 19:17:39 +0800
Subject: [PATCH] Enable NOR Flash Feature

Add NOR Flash device node in dts file

Signed-off-by: Andrew Liu <shengping.liu@windriver.com>
---
 arch/powerpc/boot/dts/mpc8568mds.dts |   44 ++++++++++++++++++++++++++++++++++
 1 files changed, 44 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/boot/dts/mpc8568mds.dts b/arch/powerpc/boot/dts/mpc8568mds.dts
index a15f103..bff481f 100644
--- a/arch/powerpc/boot/dts/mpc8568mds.dts
+++ b/arch/powerpc/boot/dts/mpc8568mds.dts
@@ -56,6 +56,50 @@
 		reg = <0xf8000000 0x8000>;
 	};
 
+	localbus@e0000000 {
+		#address-cells = <2>;
+		#size-cells = <1>;
+		compatible = "simple-bus";
+		ranges = <0x0 0x0 0xfe000000 0x2000000>;
+
+		flash@0,0 {
+			compatible = "cfi-flash";
+			reg = <0 0x0 0x2000000>;
+			#address-cells = <1>;
+			#size-cells = <1>;
+			bank-width = <0x2>;
+			reserved@0 {
+				label = "reserved";
+				reg = <0x00000000 0x00100000>;  /* reserved */
+			};
+			jffs2@100000 {
+				label = "jffs2";
+				reg = <0x00100000 0x00800000>;  /* jffs2 8M */
+			};
+			reserved2@900000 {
+				label = "reserved2";
+				reg = <0x00900000 0x00f00000>;  /* reserved 15M */
+			};
+			kernel@1800000 {
+				label = "Kernel";
+				reg = <0x01800000 0x00200000>;  /* kernel 2M */
+			};
+			ramdisk@1a00000 {
+				label = "ramdisk";
+				reg = <0x01a00000 0x00500000>;  /* ramdisk 5M */
+			};
+			dtb@1f00000 {
+				label = "dtb";
+				reg = <0x01f00000 0x00080000>;  /* dtb 512K */
+			};
+			u-boot@1f80000 {
+				label = "u-boot";
+				reg = <0x01f80000 0x00080000>;  /* u-boot 512K */
+				read-only;
+			};
+		};
+	};
+
 	soc8568@e0000000 {
 		#address-cells = <1>;
 		#size-cells = <1>;
-- 
1.6.0.4

