From 503142a020099b1925d562a92435e467958230c1 Mon Sep 17 00:00:00 2001
From: Yang Wei <Wei.Yang@windriver.com>
Date: Wed, 24 Apr 2013 19:10:26 +0800
Subject: [PATCH 10/21] dts/p1023rdb: add a device node to support NAND FLash

Add a device node to support NAND FLASH for P1023RDB after
refer to P1021MDS's dts and P1023RDB's u-boot configuration
info.

Signed-off-by: Yang Wei <Wei.Yang@windriver.com>
---
 arch/powerpc/boot/dts/p1023rdb.dts |   42 +++++++++++++++++++++++++++++++++++-
 1 files changed, 41 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/boot/dts/p1023rdb.dts b/arch/powerpc/boot/dts/p1023rdb.dts
index 24e71f8..0052c33 100644
--- a/arch/powerpc/boot/dts/p1023rdb.dts
+++ b/arch/powerpc/boot/dts/p1023rdb.dts
@@ -105,7 +105,8 @@
 		reg = <0 0xff605000 0 0x1000>;
 
 		/* NOR Flash */
-		ranges = <0x0 0x0 0x0 0xec000000 0x04000000>;
+		ranges = <0x0 0x0 0x0 0xec000000 0x04000000
+			  0x1 0x0 0x0 0xffa00000 0x00008000>;
 
 		nor@0,0 {
 			#address-cells = <1>;
@@ -138,6 +139,45 @@
 				read-only;
 			};
 		};
+		nand@1,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
+			compatible = "fsl,elbc-fcm-nand";
+			reg = <0x1 0x0 0x8000>;
+
+			partition@0 {
+				reg = <0x0 0x100000>;
+				label = "u-boot-nand";
+				read-only;
+			};
+
+			partition@100000 {
+				reg = <0x0100000 0x100000>;
+				label = "NAND DTB Image";
+			};
+
+			partition@200000 {
+				reg = <0x200000 0x1d00000>;
+				label = "NAND Linux Kernel Image";
+			};
+
+			partition@1f00000 {
+				reg = <0x1f00000 0x100000>;
+				label = "NAND FMAN ucode";
+			};
+
+			partition@2000000 {
+				reg = <0x2000000 0x04000000>;
+				label = "NAND JFFS2 FS";
+			};
+
+			partition@6000000 {
+				reg = <0x6000000 0x02000000>;
+				label = "NAND USER DATA";
+			};
+
+		};
+
 	};
 
 	pci0: pcie@ff60a000 {
-- 
1.7.5.4

