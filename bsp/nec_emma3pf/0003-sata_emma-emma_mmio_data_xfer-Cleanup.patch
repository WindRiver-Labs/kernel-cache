From 10c176915efc190638a16eb0ade3ad9828ef1ad1 Mon Sep 17 00:00:00 2001
From: Shinya Kuribayashi <shinya.kuribayashi@necel.com>
Date: Tue, 28 Apr 2009 14:30:54 +0900
Subject: [PATCH] sata_emma: emma_mmio_data_xfer: Cleanup

* Remove unnecessary (void __iomem *) cast
* Consolidate 'mmio + EMMA_SATA_TF_DATA_OFFSET'

Signed-off-by: Shinya Kuribayashi <shinya.kuribayashi@necel.com>
---
 drivers/ata/sata_emma.c |   14 +++++---------
 1 files changed, 5 insertions(+), 9 deletions(-)

diff --git a/drivers/ata/sata_emma.c b/drivers/ata/sata_emma.c
index 9a362d1..8e843af 100644
--- a/drivers/ata/sata_emma.c
+++ b/drivers/ata/sata_emma.c
@@ -322,19 +322,17 @@ static unsigned int emma_mmio_data_xfer(struct ata_device *adev,
 	unsigned int i;
 	unsigned int words = buflen >> 1;
 	u16 *buf16 = (u16 *) buf;
-	void __iomem *mmio = (void __iomem *)ap->ioaddr.bmdma_addr;
+	void __iomem *mmio = ap->ioaddr.bmdma_addr + EMMA_SATA_TF_DATA_OFFSET;
 
 	DPRINTK("ENTER\n");
 
 	/* Transfer multiple of 2 bytes */
 	if (write_data) {
 		for (i = 0; i < words; i++)
-			writew(le16_to_cpu(buf16[i]),
-			       mmio + EMMA_SATA_TF_DATA_OFFSET);
+			writew(le16_to_cpu(buf16[i]), mmio);
 	} else {
 		for (i = 0; i < words; i++)
-			buf16[i] = cpu_to_le16(readw(mmio +
-						     EMMA_SATA_TF_DATA_OFFSET));
+			buf16[i] = cpu_to_le16(readw(mmio));
 	}
 
 	/* Transfer trailing 1 byte, if any. */
@@ -344,11 +342,9 @@ static unsigned int emma_mmio_data_xfer(struct ata_device *adev,
 
 		if (write_data) {
 			memcpy(align_buf, trailing_buf, 1);
-			writew(le16_to_cpu(align_buf[0]),
-			       mmio + EMMA_SATA_TF_DATA_OFFSET);
+			writew(le16_to_cpu(align_buf[0]), mmio);
 		} else {
-			align_buf[0] = cpu_to_le16(readw(mmio +
-							 EMMA_SATA_TF_DATA_OFFSET));
+			align_buf[0] = cpu_to_le16(readw(mmio));
 			memcpy(trailing_buf, align_buf, 1);
 		}
 		words++;
-- 
1.6.0.4

