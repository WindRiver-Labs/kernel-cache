From 598b4293e54d099b8515bb9037f4b8098b6b99d2 Mon Sep 17 00:00:00 2001
From: Shaohui Xie <Shaohui.Xie@freescale.com>
Date: Wed, 17 Jun 2015 06:36:49 +0800
Subject: [PATCH 237/451] dts/ls1043ardb: fix dspi flash

Signed-off-by: Shaohui Xie <Shaohui.Xie@freescale.com>
Signed-off-by: Mingkai Hu <Mingkai.Hu@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts |   27 +++++++++++++++++----
 1 files changed, 22 insertions(+), 5 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts b/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts
index c6020e5..befec63 100644
--- a/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts
@@ -32,14 +32,31 @@
 	bus-num = <0>;
 	status = "okay";
 
-	dspiflash: at45db021d@0 {
-		compatible = "atmel,at45db021d", "atmel,at45", "atmel,dataflash";
+	flash@0 {
 		#address-cells = <1>;
 		#size-cells = <1>;
-		spi-max-frequency = <3000000>;
-		spi-cpol;
-		spi-cpha;
+		compatible = "micron,n25q128a13";  /* 16MB */
 		reg = <0>;
+		spi-max-frequency = <10000000>; /* input clock */
+		partition@u-boot {
+			label = "u-boot";
+			reg = <0x00000000 0x00100000>;
+			read-only;
+		};
+		partition@kernel {
+			label = "kernel";
+			reg = <0x00100000 0x00500000>;
+			read-only;
+		};
+		partition@dtb {
+			label = "dtb";
+			reg = <0x00600000 0x00100000>;
+			read-only;
+		};
+		partition@fs {
+			label = "file system";
+			reg = <0x00700000 0x00900000>;
+		};
 	};
 };
 
-- 
1.7.5.4

