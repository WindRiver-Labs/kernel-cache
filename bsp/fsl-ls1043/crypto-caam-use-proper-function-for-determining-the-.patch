From dde95feb268f7eb42b2e097e1bdcaa205dad2ee7 Mon Sep 17 00:00:00 2001
From: Alex Porosanu <alexandru.porosanu@freescale.com>
Date: Fri, 17 Jul 2015 15:02:01 +0300
Subject: [PATCH 321/451] crypto/caam: use proper function for determining the
 number of bits set

__builtin_popcountll is not available on all architectures. Use the
generic interface provided by the kernel.

Change-Id: I8d817dcd54890edab65798b72098c92df2a0e4c8
Signed-off-by: Alex Porosanu <alexandru.porosanu@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 drivers/crypto/caam/qi.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/crypto/caam/qi.c b/drivers/crypto/caam/qi.c
index ea75389..4a9064b 100644
--- a/drivers/crypto/caam/qi.c
+++ b/drivers/crypto/caam/qi.c
@@ -685,7 +685,7 @@ static int alloc_cgrs(struct device *qidev)
 	struct qm_mcc_initcgr opts;
 	int ret;
 	const u64 cpus = *(u64 *)qman_affine_cpus();
-	const int num_cpus = __builtin_popcountll(cpus);
+	const int num_cpus = hweight64(cpus);
 	u64 val;
 
 	/*Allocate response CGR*/
-- 
1.7.5.4

