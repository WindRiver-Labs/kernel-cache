From 2aa22a20f3f83c23d81b1e5463badb5e75a1ca08 Mon Sep 17 00:00:00 2001
From: Marian-Cristian Rotariu <marian.rotariu@freescale.com>
Date: Thu, 9 Jul 2015 17:18:39 +0300
Subject: [PATCH 293/451] dpaa_eth: guard phy call for emulator

Signed-off-by: Marian-Cristian Rotariu <marian.rotariu@freescale.com>
Change-Id: Ib7c8ad6445bdadd46bc254aeff60e910a1fc28bf
Reviewed-on: http://git.am.freescale.net:8181/39538
Reviewed-by: Madalin-Cristian Bucur <madalin.bucur@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/mac.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/mac.c b/drivers/net/ethernet/freescale/dpa/mac.c
index f6e4b3d..cc9ee5b 100644
--- a/drivers/net/ethernet/freescale/dpa/mac.c
+++ b/drivers/net/ethernet/freescale/dpa/mac.c
@@ -355,6 +355,7 @@ static int __cold mac_probe(struct platform_device *_of_dev)
 	if (strstr(char_prop, "xgmii"))
 		mac_dev->if_support = SUPPORTED_10000baseT_Full;
 
+#ifndef CONFIG_FSL_DPAA_DBG_EMULATOR
 	/* Get the rest of the PHY information */
 	mac_dev->phy_node = of_parse_phandle(mac_node, "phy-handle", 0);
 	if (mac_dev->phy_node == NULL) {
@@ -370,6 +371,7 @@ static int __cold mac_probe(struct platform_device *_of_dev)
 		sprintf(mac_dev->fixed_bus_id, PHY_ID_FMT, "fixed-0",
 			phy_id);
 	}
+#endif
 
 	_errno = mac_dev->init(mac_dev);
 	if (unlikely(_errno < 0)) {
-- 
1.7.5.4

