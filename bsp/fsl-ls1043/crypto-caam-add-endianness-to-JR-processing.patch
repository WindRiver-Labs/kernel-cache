From d347f77dfdb24df81867395aa437c9bcfa733161 Mon Sep 17 00:00:00 2001
From: Alex Porosanu <alexandru.porosanu@freescale.com>
Date: Wed, 22 Apr 2015 13:30:48 +0300
Subject: [PATCH 268/451] crypto: caam - add endianness to JR processing

This patch changes the necessary code to enable the JRs
of the CAAM to be used in systems where the endianness
of the core is not the same as CAAM's endianness.

Change-Id: I5a74d2ba04bbf415d99ad203f37f907e345fd0da
Signed-off-by: Alex Porosanu <alexandru.porosanu@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 drivers/crypto/caam/sg_sw_sec4.h |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/drivers/crypto/caam/sg_sw_sec4.h b/drivers/crypto/caam/sg_sw_sec4.h
index 752134c..893f107 100644
--- a/drivers/crypto/caam/sg_sw_sec4.h
+++ b/drivers/crypto/caam/sg_sw_sec4.h
@@ -4,6 +4,7 @@
  * Copyright 2008-2011 Freescale Semiconductor, Inc.
  *
  */
+#include "regs.h"
 
 struct sec4_sg_entry;
 
@@ -13,8 +14,8 @@ struct sec4_sg_entry;
 static inline void dma_to_sec4_sg_one(struct sec4_sg_entry *sec4_sg_ptr,
 				      dma_addr_t dma, u32 len, u16 offset)
 {
-	sec4_sg_ptr->ptr = dma;
-	sec4_sg_ptr->len = len;
+	sec4_sg_ptr->ptr = wr_en_dma(dma);
+	sec4_sg_ptr->len = wr_en_val32(len);
 	sec4_sg_ptr->reserved = 0;
 	sec4_sg_ptr->buf_pool_id = 0;
 	sec4_sg_ptr->offset = offset & SEC4_SG_OFFSET_MASK;
-- 
1.7.5.4

