From 57c8731377c82ccb34c7de3b77c4c29bfb9bbd8e Mon Sep 17 00:00:00 2001
From: "Junxian.Xiao" <Junxian.Xiao@windriver.com>
Date: Fri, 21 Oct 2016 13:42:38 +0800
Subject: [PATCH] uart: set the interrupt trigger type to edge in dts

In the original dst settings, the uart0/1 are sharing the
same interrupt pin and both trigger by is high level.
When ttyS0 as console, and also try to use ttyS1, there is
the folowing call trace:

    irq 18: nobody cared (try booting with the "irqpoll" option)
    ...
    handlers:
    [<ffff8000000ed258>] irq_default_primary_handler threaded
    [<ffff8000004d8730>] serial8250_interrupt
    Disabling IRQ #18

This only happens in preempt-rt kernel, which using the thread
as the irq bottom part, more possible that the handler cannot
the sharing interrupt at the same ttime. Just set the trigger
type to edge to avoid timing conflict.

Signed-off-by: Junxian.Xiao <Junxian.Xiao@windriver.com>
---
 arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi b/arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi
index a696297..037320c 100644
--- a/arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi
@@ -726,14 +726,14 @@
 		duart0: serial@21c0500 {
 			compatible = "fsl,ns16550", "ns16550a";
 			reg = <0x00 0x21c0500 0x0 0x100>;
-			interrupts = <0 54 0x4>;
+			interrupts = <0 54 0x1>;
 			clocks = <&clockgen 4 0>;
 		};
 
 		duart1: serial@21c0600 {
 			compatible = "fsl,ns16550", "ns16550a";
 			reg = <0x00 0x21c0600 0x0 0x100>;
-			interrupts = <0 54 0x4>;
+			interrupts = <0 54 0x1>;
 			clocks = <&clockgen 4 0>;
 		};
 
-- 
1.7.5.4

