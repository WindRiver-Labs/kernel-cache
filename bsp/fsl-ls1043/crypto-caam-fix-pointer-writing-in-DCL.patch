From 99579a7ea098f104d4f1c321290aca92358e5b7f Mon Sep 17 00:00:00 2001
From: Alex Porosanu <alexandru.porosanu@freescale.com>
Date: Fri, 7 Aug 2015 18:11:27 +0300
Subject: [PATCH 441/451] crypto/caam: fix pointer writing in DCL

When writing a pointer in the descriptor, the size
of the physical address of the host CPU must be taken
into account. Thus, the *_dma functions need to be used.

Signed-off-by: Alex Porosanu <alexandru.porosanu@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 drivers/crypto/caam/desc_constr.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/crypto/caam/desc_constr.h b/drivers/crypto/caam/desc_constr.h
index ef199e5..38ee34e 100644
--- a/drivers/crypto/caam/desc_constr.h
+++ b/drivers/crypto/caam/desc_constr.h
@@ -81,7 +81,7 @@ static inline void append_ptr(u32 *desc, dma_addr_t ptr)
 {
 	dma_addr_t *offset = (dma_addr_t *)desc_end(desc);
 
-	*offset = wr_en_val64(ptr);
+	*offset = wr_en_dma(ptr);
 
 	(*desc) = wr_en_val32(rd_en_val32(*desc) +
 			       CAAM_PTR_SZ / CAAM_CMD_SZ);
-- 
1.7.5.4

