From bbc649c27329026216c811309b7e75536b45e3aa Mon Sep 17 00:00:00 2001
From: Mingkai Hu <Mingkai.Hu@freescale.com>
Date: Fri, 29 May 2015 22:08:59 +0800
Subject: [PATCH 171/451] arm64/ls1043a: add minimal defconfig and dts file

for silicon bringup

Signed-off-by: Mingkai Hu <Mingkai.Hu@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 arch/arm64/Kconfig                                 |    7 ++
 arch/arm64/boot/dts/freescale/Makefile             |    1 +
 .../boot/dts/freescale/fsl-ls1043a-minimal.dtsi    |   94 ++++++++++++++++++++
 .../boot/dts/freescale/fsl-ls1043a-qds-minimal.dts |   19 ++++
 .../boot/dts/freescale/fsl-ls1043a-rdb-minimal.dts |   19 ++++
 5 files changed, 140 insertions(+), 0 deletions(-)
 create mode 100644 arch/arm64/boot/dts/freescale/fsl-ls1043a-minimal.dtsi
 create mode 100644 arch/arm64/boot/dts/freescale/fsl-ls1043a-qds-minimal.dts
 create mode 100644 arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb-minimal.dts

diff --git a/arch/arm64/Kconfig b/arch/arm64/Kconfig
index 27a81d6..594a498 100644
--- a/arch/arm64/Kconfig
+++ b/arch/arm64/Kconfig
@@ -156,6 +156,13 @@ config ARCH_FSL_LS1043A
 	help
 	  This enables support for Freescale LS1043A SOC.
 
+config ARCH_FSL_LS1043A_MINIMAL
+	bool "Freescale LS1043A SOC Minimal Support"
+	help
+	  This enables a minimal set of support for Freescale LS1043A SOC
+	  - intended mainly for bringup work (single core and IPs required
+	  mainly to achieve linux boot-to-prompt).
+
 config ARCH_THUNDER
 	bool "Cavium Inc. Thunder SoC Family"
 	select ARM_GIC_V3
diff --git a/arch/arm64/boot/dts/freescale/Makefile b/arch/arm64/boot/dts/freescale/Makefile
index af5b9bc..5a39d99 100644
--- a/arch/arm64/boot/dts/freescale/Makefile
+++ b/arch/arm64/boot/dts/freescale/Makefile
@@ -1,5 +1,6 @@
 dtb-$(CONFIG_ARCH_FSL_LS2085A) += fsl-ls2085a-simu.dtb fsl-ls2085a-qds.dtb fsl-ls2085a-rdb.dtb
 dtb-$(CONFIG_ARCH_FSL_LS1043A) += fsl-ls1043a-simu.dtb fsl-ls1043a-emu.dtb fsl-ls1043a-qds.dtb fsl-ls1043a-rdb.dtb
+dtb-$(CONFIG_ARCH_FSL_LS1043A_MINIMAL) += fsl-ls1043a-qds-minimal.dtb fsl-ls1043a-rdb-minimal.dtb
  
 always		:= $(dtb-y)
 subdir-y	:= $(dts-dirs)
diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1043a-minimal.dtsi b/arch/arm64/boot/dts/freescale/fsl-ls1043a-minimal.dtsi
new file mode 100644
index 0000000..c6bde7c
--- /dev/null
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1043a-minimal.dtsi
@@ -0,0 +1,94 @@
+/*
+ * Device Tree Include file for Freescale Layerscape-1043A family SoC.
+ *
+ * Copyright (C) 2014-2015, Freescale Semiconductor
+ *
+ * Mingkai Hu <Mingkai.hu@freescale.com>
+ *
+ * This file is licensed under the terms of the GNU General Public
+ * License version 2.  This program is licensed "as is" without any
+ * warranty of any kind, whether express or implied.
+ */
+
+/memreserve/ 0x80000000 0x00010000;
+
+/ {
+	compatible = "fsl,ls1043a";
+	interrupt-parent = <&gic>;
+	#address-cells = <2>;
+	#size-cells = <2>;
+
+	cpus {
+		#address-cells = <2>;
+		#size-cells = <0>;
+
+		cpu@0 {
+			device_type = "cpu";
+			compatible = "arm,cortex-a53";
+			reg = <0x0 0x0>;
+			clocks = <1500000000>;
+		};
+
+		cpu@1 {
+			device_type = "cpu";
+			compatible = "arm,cortex-a53";
+			reg = <0x0 0x1>;
+			clocks = <1500000000>;
+		};
+
+		cpu@2 {
+			device_type = "cpu";
+			compatible = "arm,cortex-a53";
+			reg = <0x0 0x2>;
+			clocks = <1500000000>;
+		};
+
+		cpu@3 {
+			device_type = "cpu";
+			compatible = "arm,cortex-a53";
+			reg = <0x0 0x3>;
+			clocks = <1500000000>;
+		};
+	};
+
+	timer {
+		compatible = "arm,armv8-timer";
+		interrupts = <1 13 0x1>, /* Physical Secure PPI */
+			     <1 14 0x1>, /* Physical Non-Secure PPI */
+			     <1 11 0x1>, /* Virtual PPI */
+			     <1 10 0x1>; /* Hypervisor PPI */
+	};
+
+	gic: interrupt-controller@1400000 {
+		compatible = "arm,gic-400";
+		#interrupt-cells = <3>;
+		interrupt-controller;
+		reg = <0x0 0x1401000 0 0x1000>, /* GICD */
+		      <0x0 0x1402000 0 0x1000>, /* GICC */
+		      <0x0 0x1404000 0 0x2000>, /* GICH */
+		      <0x0 0x1406000 0 0x2000>; /* GICV */
+		interrupts = <1 9 0xf08>;
+	};
+
+	duart0: serial@21c0500 {
+		device_type = "serial";
+		compatible = "fsl,ns16550", "ns16550";
+		reg = <0x00 0x21c0500 0x0 0x100>;
+		interrupts = <0 54 0x4>;
+		clock-frequency = <400000000>;
+	};
+
+	duart1: serial@21c0600 {
+		device_type = "serial";
+		compatible = "fsl,ns16550", "ns16550";
+		reg = <0x00 0x21c0600 0x0 0x100>;
+		interrupts = <0 54 0x4>;
+		clock-frequency = <400000000>;
+	};
+
+	memory@80000000 {
+		device_type = "memory";
+		reg = <0x0 0x80000000 0 0x80000000>;
+		      /* DRAM space 1 - 2 GB DRAM */
+	};
+};
diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1043a-qds-minimal.dts b/arch/arm64/boot/dts/freescale/fsl-ls1043a-qds-minimal.dts
new file mode 100644
index 0000000..aea006c
--- /dev/null
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1043a-qds-minimal.dts
@@ -0,0 +1,19 @@
+/*
+ * Device Tree Include file for Freescale Layerscape-1043A family SoC.
+ *
+ * Copyright (C) 2015, Freescale Semiconductor
+ *
+ * Mingkai Hu <Mingkai.hu@freescale.com>
+ *
+ * This file is licensed under the terms of the GNU General Public
+ * License version 2.  This program is licensed "as is" without any
+ * warranty of any kind, whether express or implied.
+ */
+
+/dts-v1/;
+#include "fsl-ls1043a-minimal.dtsi"
+
+/ {
+	model = "LS1043A QDS Board";
+	compatible = "fsl,ls1043a-qds", "fsl,ls1043a";
+};
diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb-minimal.dts b/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb-minimal.dts
new file mode 100644
index 0000000..81e1b18
--- /dev/null
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb-minimal.dts
@@ -0,0 +1,19 @@
+/*
+ * Device Tree Include file for Freescale Layerscape-1043A family SoC.
+ *
+ * Copyright (C) 2015, Freescale Semiconductor
+ *
+ * Mingkai Hu <Mingkai.hu@freescale.com>
+ *
+ * This file is licensed under the terms of the GNU General Public
+ * License version 2.  This program is licensed "as is" without any
+ * warranty of any kind, whether express or implied.
+ */
+
+/dts-v1/;
+#include "fsl-ls1043a-minimal.dtsi"
+
+/ {
+	model = "LS1043A RDB Board";
+	compatible = "fsl,ls1043a-rdb", "fsl,ls1043a";
+};
-- 
1.7.5.4

