From 8e0ade94dfb02ab6c4e398a449897a88657ee6f0 Mon Sep 17 00:00:00 2001
From: Mandy Lavi <mandy.lavi@freescale.com>
Date: Mon, 13 Jul 2015 10:54:21 +0300
Subject: [PATCH 276/451] fmd: revert workaround for fman coherency with cache

Signed-off-by: Mandy Lavi <mandy.lavi@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 .../freescale/fman/src/wrapper/lnxwrp_fm_port.c    |    6 ------
 1 files changed, 0 insertions(+), 6 deletions(-)

diff --git a/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm_port.c b/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm_port.c
index 7dfe2c7..e1a0074 100644
--- a/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm_port.c
+++ b/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm_port.c
@@ -217,10 +217,6 @@ static void FqFree(struct qman_fq *fq)
 	XX_Free((t_FmTestFq *) fq);
 }
 
-#warning this is a temporary workaround
-/* should eventually be removed after coherency issue is fixed */
-#include "../../../../../../arch/arm64/include/asm/cacheflush.h"
-
 static t_Error QmEnqueueCB(t_Handle h_Arg, void *p_Fd)
 {
 	t_LnxWrpFmDev *p_LnxWrpFmDev = (t_LnxWrpFmDev *) h_Arg;
@@ -258,8 +254,6 @@ static t_Error QmEnqueueCB(t_Handle h_Arg, void *p_Fd)
 }
 #endif
 
-	flush_cache_all();
-
 	_errno = qman_enqueue(p_LnxWrpFmDev->hc_tx_fq, (struct qm_fd *) p_Fd,
 			      0);
 	if (_errno)
-- 
1.7.5.4

