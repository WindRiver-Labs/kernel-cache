From 65234c4ce0da9d2001ea410a0e1a477f24fbc252 Mon Sep 17 00:00:00 2001
From: Shaohui Xie <Shaohui.Xie@freescale.com>
Date: Fri, 19 Jun 2015 05:12:21 +0800
Subject: [PATCH 252/451] armv8/ls1043a: enable gpio support

Signed-off-by: Shaohui Xie <Shaohui.Xie@freescale.com>
Signed-off-by: songwenbin <Wenbin.Song@freescale.com>
Signed-off-by: Mingkai Hu <Mingkai.Hu@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 arch/arm64/boot/dts/freescale/fsl-ls1043a-qds.dts |    6 ++++++
 drivers/gpio/Kconfig                              |    9 +++++----
 2 files changed, 11 insertions(+), 4 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1043a-qds.dts b/arch/arm64/boot/dts/freescale/fsl-ls1043a-qds.dts
index 1b2df51..d4588c0 100644
--- a/arch/arm64/boot/dts/freescale/fsl-ls1043a-qds.dts
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1043a-qds.dts
@@ -23,6 +23,12 @@
 		serial3 = &lpuart3;
 		serial4 = &lpuart4;
 		serial5 = &lpuart5;
+
+		gpio0 = &gpio1;
+		gpio1 = &gpio2;
+		gpio2 = &gpio3;
+		gpio3 = &gpio4;
+
 		sgmii_riser_s1_p1 = &sgmii_phy_s1_p1;
 		sgmii_riser_s2_p1 = &sgmii_phy_s2_p1;
 		sgmii_riser_s3_p1 = &sgmii_phy_s3_p1;
diff --git a/drivers/gpio/Kconfig b/drivers/gpio/Kconfig
index 012a77a..b031bce 100644
--- a/drivers/gpio/Kconfig
+++ b/drivers/gpio/Kconfig
@@ -188,10 +188,11 @@ config GPIO_MPC5200
 config GPIO_MPC8XXX
 	bool "MPC512x/MPC8xxx/Layerscape GPIO support"
 	depends on PPC_MPC512x || PPC_MPC831x || PPC_MPC834x || PPC_MPC837x || \
-		   FSL_SOC_BOOKE || PPC_86xx || SOC_LS1021A || ARCH_FSL_LS2085A
+		   FSL_SOC_BOOKE || PPC_86xx || SOC_LS1021A || \
+		   ARCH_FSL_LS2085A || ARCH_FSL_LS1043A
 	help
 	  Say Y here if you're going to use hardware that connects to the
-	  MPC512x/831x/834x/837x/8572/8610/LS1021A/LS2085A GPIOs.
+	  MPC512x/831x/834x/837x/8572/8610/LS1021A/LS1043A/LS2085A GPIOs.
 
 config GPIO_MSM_V1
 	tristate "Qualcomm MSM GPIO v1"
@@ -218,8 +219,8 @@ config GPIO_MVEBU
 
 config GPIO_MXC
 	def_bool y
-	depends on ARCH_MXC
-	select GPIO_GENERIC
+	depends on ARCH_MXC && !SOC_LS1021A && !ARCH_FSL_LS1043A	
+	selectGPIO_GENERIC
 	select GENERIC_IRQ_CHIP
 
 config GPIO_MXS
-- 
1.7.5.4

