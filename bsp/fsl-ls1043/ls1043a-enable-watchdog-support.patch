From a4a660fea5fbc3588173c7a8681fd708cca2be37 Mon Sep 17 00:00:00 2001
From: Shaohui Xie <Shaohui.Xie@freescale.com>
Date: Tue, 16 Jun 2015 10:48:34 +0800
Subject: [PATCH 236/451] ls1043a: enable watchdog support

Signed-off-by: Shaohui Xie <Shaohui.Xie@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi |    2 +-
 drivers/watchdog/Kconfig                       |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi b/arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi
index 8b46730..8d0618e 100644
--- a/arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1043a.dtsi
@@ -787,7 +787,7 @@
 		compatible = "fsl,imx21-wdt";
 		reg = <0x0 0x2ad0000 0x0 0x10000>;
 		interrupts = <0 83 0x4>;
-		clocks = <400000000>;
+		clocks = <&platform_clk 1>;
 		clock-names = "wdog";
 		big-endian;
 	};
diff --git a/drivers/watchdog/Kconfig b/drivers/watchdog/Kconfig
index 3c49330..7bc5af3 100644
--- a/drivers/watchdog/Kconfig
+++ b/drivers/watchdog/Kconfig
@@ -368,7 +368,7 @@ config MAX63XX_WATCHDOG
 
 config IMX2_WDT
 	tristate "IMX2+ Watchdog"
-	depends on ARCH_MXC
+	depends on ARCH_MXC || ARCH_FSL_LS1043A
 	help
 	  This is the driver for the hardware watchdog
 	  on the Freescale IMX2 and later processors.
-- 
1.7.5.4

