From f61859bb9a68f1f6c2c4474611a915b882015124 Mon Sep 17 00:00:00 2001
From: Mingkai Hu <Mingkai.Hu@freescale.com>
Date: Fri, 29 May 2015 19:33:19 +0800
Subject: [PATCH 167/451] arm64/ls1043ardb: add IFC, UART DTS node

Signed-off-by: Mingkai Hu <Mingkai.Hu@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts |  163 ++++++++++++++++++++-
 1 files changed, 161 insertions(+), 2 deletions(-)

diff --git a/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts b/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts
index c6d1732..f1fbec1 100644
--- a/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts
+++ b/arch/arm64/boot/dts/freescale/fsl-ls1043a-rdb.dts
@@ -18,6 +18,165 @@
 
 };
 
+&dspi0 {
+	bus-num = <0>;
+	status = "okay";
+
+	dspiflash: at45db021d@0 {
+		compatible = "atmel,at45db021d", "atmel,at45", "atmel,dataflash";
+		#address-cells = <1>;
+		#size-cells = <1>;
+		spi-max-frequency = <3000000>;
+		spi-cpol;
+		spi-cpha;
+		reg = <0>;
+	};
+};
+
+&i2c0 {
+	status = "okay";
+	ina220@40 {
+		compatible = "ti,ina220";
+		reg = <0x40>;
+		shunt-resistor = <1000>;
+	};
+	adt7461a@4c {
+		compatible = "adt7461a";
+		reg = <0x4c>;
+	};
+	eeprom@56 {
+		compatible = "at24,24c512";
+		reg = <0x52>;
+	};
+
+	eeprom@57 {
+		compatible = "at24,24c512";
+		reg = <0x53>;
+	};
+};
+
+&ifc {
+	status = "okay";
+	#address-cells = <2>;
+	#size-cells = <1>;
+	/* NOR, NAND Flashes and FPGA on board */
+	ranges = <0x0 0x0 0x0 0x60000000 0x08000000
+		  0x2 0x0 0x0 0x7e800000 0x00010000
+		  0x3 0x0 0x0 0x7fb00000 0x00000100>;
+
+		nor@0,0 {
+			compatible = "cfi-flash";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			reg = <0x0 0x0 0x8000000>;
+			bank-width = <2>;
+			device-width = <1>;
+
+			partition@0 {
+				/* 128KB for rcw */
+				reg = <0x00000000 0x0020000>;
+				label = "NOR bank0 RCW Image";
+			};
+
+			partition@20000 {
+				/* 1MB for DTB */
+				reg = <0x00020000 0x00100000>;
+				label = "NOR DTB Image";
+			};
+
+			partition@120000 {
+				/* 8 MB for Linux Kernel Image */
+				reg = <0x00120000 0x00800000>;
+				label = "NOR Linux Kernel Image";
+			};
+
+			partition@920000 {
+				/* 56MB for Ramdisk Root File System */
+				reg = <0x00920000 0x03600000>;
+				label = "NOR Ramdisk Root File System Image";
+			};
+
+			partition@3f80000 {
+				/* 512KB for bank4 u-boot Image */
+				reg = <0x03f80000 0x80000>;
+				label = "NOR bank4 u-boot Image";
+			};
+
+			partition@4000000 {
+				/* 128KB for bank4 RCW Image */
+				reg = <0x04000000 0x20000>;
+				label = "NOR bank4 RCW Image";
+			};
+
+			partition@4020000 {
+				/* 63MB JFFS2 ROOT File System Image */
+				reg = <0x04020000 0x3f00000>;
+				label = "NOR JFFS2 ROOT File System Image";
+			};
+
+			partition@7f80000 {
+				/* 512KB for bank0 u-boot Image */
+				reg = <0x07f80000 0x80000>;
+				label = "NOR bank0 u-boot Image";
+			};
+		};
+
+		nand@1,0 {
+			compatible = "fsl,ifc-nand";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			reg = <0x2 0x0 0x10000>;
+
+			partition@0 {
+				/* This location must not be altered  */
+				/* 1MB for u-boot Bootloader Image */
+				reg = <0x0 0x00100000>;
+				label = "NAND U-Boot Image";
+				read-only;
+			};
+
+			partition@100000 {
+				/* 1MB for DTB Image */
+				reg = <0x00100000 0x00100000>;
+				label = "NAND DTB Image";
+			};
+
+			partition@200000 {
+				/* 10MB for Linux Kernel Image */
+				reg = <0x00200000 0x00a00000>;
+				label = "NAND Linux Kernel Image";
+			};
+
+			partition@c00000 {
+				/* 500MB for Root file System Image */
+				reg = <0x00c00000 0x1f400000>;
+				label = "NAND Compressed RFS Image";
+			};
+		};
+
+		cpld: board-control@2,0 {
+			compatible = "fsl,ls1043ardb-cpld", "simple-bus";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			reg = <0x2 0x0 0x0000100>;
+			bank-width = <1>;
+			device-width = <1>;
+			ranges = <0 2 0 0x100>;
+		};
+};
+
+&ftm0 {
+	status = "okay";
+};
+
+&duart0 {
+	status = "okay";
+};
+
+&duart1 {
+	status = "okay";
+};
+
 &fman0 {
 	ethernet@e0000 {
 		phy-handle = <&qsgmii_phy1>;
@@ -30,12 +189,12 @@
 	};
 
 	ethernet@e4000 {
-		phy-handle = <&qsgmii_phy3>;
+		phy-handle = <&rgmii_phy1>;
 		phy-connection-type = "rgmii";
 	};
 
 	ethernet@e6000 {
-		phy-handle = <&qsgmii_phy4>;
+		phy-handle = <&rgmii_phy2>;
 		phy-connection-type = "rgmii";
 	};
 
-- 
1.7.5.4

