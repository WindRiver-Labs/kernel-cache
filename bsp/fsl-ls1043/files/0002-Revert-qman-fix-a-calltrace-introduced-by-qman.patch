From d03a354b50c70f92b94bb46bd35c3416c12283f7 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 25 Jul 2016 18:59:07 -0700
Subject: [PATCH 2/5] Revert "qman:fix a calltrace introduced by qman"

This fix is only for PPC currently because of get_hard_smp_processor_id.
And so far any calltrace was/is not seen. If this happen I have to find
out the right way to avoid this one for arm64 .

This reverts commit 72fccd8d6d7cf55aa4315a2bace757436e5aced9.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/staging/fsl_qbman/qman_driver.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/drivers/staging/fsl_qbman/qman_driver.c b/drivers/staging/fsl_qbman/qman_driver.c
index b53c6c95..a4e8c58 100644
--- a/drivers/staging/fsl_qbman/qman_driver.c
+++ b/drivers/staging/fsl_qbman/qman_driver.c
@@ -603,8 +603,7 @@ struct qm_portal_config *qm_get_unused_portal_idx(u32 idx)
 	 * opening the device file, and if that isn't the cpu they subsequently
 	 * bind to and do their polling on, tough. */
 	if (ret)
-		portal_set_cpu(ret,
-			get_hard_smp_processor_id(raw_smp_processor_id()));
+		portal_set_cpu(ret, hard_smp_processor_id());
 	return ret;
 }
 
-- 
2.7.4

