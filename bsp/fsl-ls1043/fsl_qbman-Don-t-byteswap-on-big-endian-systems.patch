From bd967e76415d0e397512eed43bb525d36921a545 Mon Sep 17 00:00:00 2001
From: Roy Pledge <Roy.Pledge@freescale.com>
Date: Thu, 2 Jul 2015 09:04:38 -0400
Subject: [PATCH 259/451] fsl_qbman: Don't byteswap on big endian systems

make sure macros that deal with byteswapping are no ops on BE systems

Signed-off-by: Roy Pledge <Roy.Pledge@freescale.com>
[Xulin: Original patch taken from
Linux-LS1043A-SDK-V0.4-SOURCE-20150826-yocto.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 drivers/staging/fsl_qbman/qman_high.c |   16 ++++++++++++++++
 1 files changed, 16 insertions(+), 0 deletions(-)

diff --git a/drivers/staging/fsl_qbman/qman_high.c b/drivers/staging/fsl_qbman/qman_high.c
index ae46505..6d32c2e 100644
--- a/drivers/staging/fsl_qbman/qman_high.c
+++ b/drivers/staging/fsl_qbman/qman_high.c
@@ -304,6 +304,9 @@ static inline void hw_fqd_to_cpu(struct qm_fqd *fqd)
 /* Swap a 40 bit address */
 static inline u64 cpu_to_be40(u64 in)
 {
+#if __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__
+	return in;
+#else
 	u64 out = 0;
 	u8 *p = (u8 *) &out;
 	p[0] = in >> 32;
@@ -312,9 +315,13 @@ static inline u64 cpu_to_be40(u64 in)
 	p[3] = in >> 8;
 	p[4] = in >> 0;
 	return out;
+#endif
 }
 static inline u64 be40_to_cpu(u64 in)
 {
+#if __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__
+	return in;
+#else
 	u64 out = 0;
 	u8 *pout = (u8 *) &out;
 	u8 *pin = (u8 *) &in;
@@ -324,21 +331,29 @@ static inline u64 be40_to_cpu(u64 in)
 	pout[3] = pin[1];
 	pout[4] = pin[0];
 	return out;
+#endif
 }
 
 /* Swap a 24 bit value */
 static inline u32 cpu_to_be24(u32 in)
 {
+#if __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__
+	return in;
+#else
 	u32 out = 0;
 	u8 *p = (u8 *) &out;
 	p[0] = in >> 16;
 	p[1] = in >> 8;
 	p[2] = in >> 0;
 	return out;
+#endif
 }
 
 static inline u32 be24_to_cpu(u32 in)
 {
+#if __BYTE_ORDER__ == __ORDER_BIG_ENDIAN__
+	return in;
+#else
 	u32 out = 0;
 	u8 *pout = (u8 *) &out;
 	u8 *pin = (u8 *) &in;
@@ -346,6 +361,7 @@ static inline u32 be24_to_cpu(u32 in)
 	pout[1] = pin[1];
 	pout[2] = pin[0];
 	return out;
+#endif
 }
 
 static inline void cpu_to_hw_fd(struct qm_fd *fd)
-- 
1.7.5.4

