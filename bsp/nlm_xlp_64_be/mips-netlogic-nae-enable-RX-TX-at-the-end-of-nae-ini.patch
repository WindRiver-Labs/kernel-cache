From 414d02c4bf4e9d004048d26f0e57971888f20856 Mon Sep 17 00:00:00 2001
From: Shan Hai <shan.hai@windriver.com>
Date: Thu, 25 Jul 2013 05:55:28 -0400
Subject: [PATCH] mips/netlogic/nae: enable RX/TX at the end of nae initialization

Sending packets to the interfaces during initialization causes failure
of networking, the reason is that the RX/TX are enabled before the
interface initialization process complete.

Signed-off-by: Shan Hai <shan.hai@windriver.com>
---
 arch/mips/netlogic/common/nlm_hal_nae.c |    4 +---
 1 files changed, 1 insertions(+), 3 deletions(-)

diff --git a/arch/mips/netlogic/common/nlm_hal_nae.c b/arch/mips/netlogic/common/nlm_hal_nae.c
index 3ad6fd1..ba773ea 100644
--- a/arch/mips/netlogic/common/nlm_hal_nae.c
+++ b/arch/mips/netlogic/common/nlm_hal_nae.c
@@ -5439,9 +5439,7 @@ int nlm_hal_open_if(int node, int intf_type, int block)
 
 			// Reset GMAC 
 			mac_cfg1 = read_gmac_reg(node, block, MAC_CONF1);
-		        write_gmac_reg(node, block , MAC_CONF1, mac_cfg1 | INF_SOFTRESET(1) |
-					           INF_RX_ENABLE(1) |
-						   INF_TX_ENABLE(1));
+			write_gmac_reg(node, block , MAC_CONF1, mac_cfg1 | INF_SOFTRESET(1));
 
 			// Default 1G
 		        write_gmac_reg(node, block , MAC_CONF2,  INF_PREMBL_LEN(0x7) |
-- 
1.7.0

