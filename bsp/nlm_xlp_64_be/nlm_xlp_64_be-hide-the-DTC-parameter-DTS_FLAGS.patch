From 79bb16a5a459e5c7d3e8a254d668bbbeef67b56b Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Mon, 16 Jul 2012 20:17:20 +0800
Subject: [PATCH 41/47] nlm_xlp_64_be: hide the DTC parameter 'DTS_FLAGS'

Workaround: Hide the DTC parameter 'DTS_FLAGS'.

The problem:
If we build a DTB with this flag, the system will print "Freeing unused
kernel memory: 272k freed", and then stop at executing "/sbin/init".

The building system automatically set DTS_FLAGS as '-p 1024'. This behavior
was introduced on the commit 9d4ae9fc92f347b93b42c9c0ccde7138c1202e36 by
Kumar Gala. It added 1K of padding for most bootloaders.
But the system still ran normally without this flag, so hide it to avoid
this issue.

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/boot/Makefile |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/mips/boot/Makefile b/arch/mips/boot/Makefile
index 9cfadad..50d3b75 100644
--- a/arch/mips/boot/Makefile
+++ b/arch/mips/boot/Makefile
@@ -40,7 +40,9 @@ vmlinux.srec: $(VMLINUX)
 	$(OBJCOPY) -S -O srec $(strip-flags) $(VMLINUX) $(obj)/vmlinux.srec
 
 # Rule to build device tree blobs
+ifndef CONFIG_CPU_XLP
 DTS_FLAGS ?= -p 1024
+endif
 dtstree := $(srctree)/$(src)/dts
 DTC = $(objtree)/scripts/dtc/dtc
 
-- 
1.7.0

