From 1e9af1c4185b8b6b596126c7107e9a36e45ea333 Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Fri, 13 Jul 2012 11:13:33 +0800
Subject: [PATCH 37/46] nlm_xlp_64_be: update dts

To support the new boards XLP832 B1 and XLP316 B0, SDK updated dts
files, agree with it.

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/boot/dts/xlp316.dts |  932 +++++++++++++++++++++++++++++++++++++----
 arch/mips/boot/dts/xlp832.dts |  123 ++++---
 2 files changed, 915 insertions(+), 140 deletions(-)

diff --git a/arch/mips/boot/dts/xlp316.dts b/arch/mips/boot/dts/xlp316.dts
index e817c0d..e9aaddd 100644
--- a/arch/mips/boot/dts/xlp316.dts
+++ b/arch/mips/boot/dts/xlp316.dts
@@ -3,60 +3,791 @@
  */
 
 /dts-v1/;
-
 / {
 	model = "MIPS,XLP3XX";
 	compatible = "NETL,XLP3XX_A0";
-	#address-cells = <0x1>;
-	#size-cells = <0x1>;
+
+	#address-cells = <1>;
+	#size-cells = <1>;
 
 	hypervisor {
 		hypervisor-name = "Xen";
-		alloc_dom0_memory = <0x0>;
-		bootargs = "ncores=4 dom0_loadaddr=0x72000000 dom0_size=0x1c000000 dom0_cpumask=0xffff-- ";
+		alloc_dom0_memory = <0>;
+		bootargs = "ncores=4 dom0_loadaddr=0x72000000 dom0_size=0x1c000000 dom0_cpumask=0xffff -- ";
 		domain_heap = <0x80000000 0x20000000>;
 	};
-
 	doms {
-		#address-cells = <0x1>;
-		#size-cells = <0x1>;
-
+		#address-cells = <1>;
+		#size-cells = <1>;
 		dom@0 {
 			device_type = "domain";
 			os = "linux";
-			#address-cells = <0x1>;
-			#size-cells = <0x1>;
+
+			#address-cells = <1>;
+			#size-cells = <1>;
 
 			cpu {
 				onlinemask = <0xffff>;
-				nae-rx-vc = <0x0>;
-				nae-fb-vc = <0x1>;
-				napi-vc-mask = <0x3>;
-				sae-rx-vc = <0x0>;
-				sae-rx-sync-vc = <0x3>;
-				ipsec-async-vc = <0x0>;
-				ipsec-sync-vc = <0x2>;
-			};
+                                nae-rx-vc = <0>;
+                                nae-fb-vc = <1>;
+				napi-vc-mask = <0xb>;
+				sae-rx-vc = <0>; /*  */
+				sae-rx-sync-vc  = <3>; /* should be exclusive */
+				ipsec-async-vc  = <3>;
+				ipsec-sync-vc   = <2>; /* should be exclusive either
+							  ipsec-sync-vc  or soc/srio@node-0  */
+fmn@node-0 {
+        default-credits = <50>;
+        default-queue-size = <16384>;
+        fmn-spill-mem-base = <0x00000000 0x10000000>; /*0 - dynamic allocation, only for 64 bit linux */
+        fmn-spill-mem-size = <0x00000000 0x02000000>;
+	q-config {
+		/* credits from station
+		   "cpu popq pcie0 pcie1 pcie2 pcie3 gdx rsa crypto cmp poe nae regx srio"
+		   The order and number of station should be matching with the list given above
+		   Here, credits 0 means the default credits.
+		   Right now there is no way to configure credit of zero */
+
+                cpu {
+                        queue-size = <32768>; /* queue size for all the cpu vcs */
+                        credits-from {
+                                node-0 = <0 0 0 0 0 0 0 0 0 0 500 0 0 150>;
+                        };
+                };
+
+                nae {
+                        credits-from {
+                                node-0 = <100 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                        };
+                };
+               srio {
+                       credits-from {
+                                node-0 = <150 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                        };
+               };
+	};
+};
+fmn@node-1{
+        default-credits = <50>;
+        default-queue-size = <16384>;
+        fmn-spill-mem-base = <0x00000000 0x00000000>; /*0 - dynamic allocation */
+        fmn-spill-mem-size = <0x00000000 0x02000000>;
+	q-config{
+
+	};
+};
+fmn@node-2{
+
+};
+fmn@node-3{
+
+};
+  nae@node-0 {
+	model = "MIPS,XLP8XX NAE CFG";
+	compatible = "NETL,XLP8XX_A0";
+	#address-cells = <1>;
+	#size-cells = <1>;
+	frequency = <500>;
+
+	/include/ "ucore-3xx.dts"
+
+        freein-fifo-config {
+                /*
+                        1. Ucore is going to use upto max queues(16 for XLP, 8 for storm) for buffer mgmt
+                        2. Onnchip desc size per queue will be configured from arry below
+                   If spill descs per queue is specified,
+                        1. spill will be enabled for all the queues(except mgmt) using the spill memory specified in the OS config file.
+                */
+		freein-fifo-spill-mem-range = <0x00000000 0x00000000 0x00000000 0x00100000>; // spill address is allocated dynamically
+                freein-fifo-onchip-num-descs = <56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56>;
+                freein-fifo-spill-num-descs = <1200>;
+        };
+
+	// VFBID MAP: Upto 127 entries
+	// (each entry is a pair of (vfbid , dest-vc)
+	// Legal range: (vfbid (0 - 126), dest-vc (0 - 4095))
+	vfbid-config {
+	};
+
+	// Packet Ordering Engine (POE)
+	poe {
+		mode = "bypass";
+
+                distribution-enable = <1>;
+                // 16 bit mask
+                dist-drop-enable = <0>;
+                // 8 bit mask
+                class-drop-enable = <0>;
+                drop-timer = <0>;
+                dest-threshold = <0xa>;
+                dist-threshold = <0xa 0xa 0xa 0xa>;
+                statistics-enable = <0>;
+
+		// Each vector is 512 bit with masb indicating vc 512 and lsb indicating vc 0
+		// Format : 512-bit-vector is specified as 16 32-bit words
+		// Left most word has the vc range 511-479 right most word has vc range 31 - 0
+		// Each word has the MSB select higer vc number and LSB select lower vc num
+                distribution_vectors {
+                                     dv0  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0x1>;
+                                     dv1  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv2  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv3  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv4  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv5  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv6  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv7  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv8  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv9  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv10 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv11 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv12 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv13 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv14 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv15 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                };
+	};
+
+	complex@0 {
+		device_type = "nae-complex";
+		mode = "xaui";
+		xaui {
+			loopback = <0>;
+			// Max ingress fifo size 256 units (size of one unit is 64 byte)
+			iface-fifo-size = <55>;
+
+			// Max parser sequence fifo size 1024 packets
+			// (if 1588 Timestamp is not required, then max size increases to 2048)
+			parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+			num-channels = <1>;
+			rx-buffer-size = <944>;
+
+			// Max available descriptors are 1024  (across all complexes).
+			// Per port num_free_descriptors must be even number
+			num-free-descs = <150>;
+			free-desc-size = <2048>;
+			// In xlp3xx number of ucores available is 8. so, ucore_mask for xlp3xx is (ucore-mask & 0xFF)
+			ucore-mask = <0xffff>;
+		};
+		sgmii {
+	                loopback = <0 0 0 0>;
+			mgmt-port = <0 0 0 0>;
+        	        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                	iface-fifo-size = <13 13 13 13>;
+
+	                ext-phy-addr = <4 7 6 5>;
+        	        ext-phy-bus = <1 1 1 1>;
+
+	                // Max parser sequence fifo size 1024 packets
+        	        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                	num-channels = <1 1 1 1>;
+	                parser-sequence-fifo-size = <62 62 62 62>;
+
+        	        rx-buffer-size = <128 128 128 128>;
+
+                	// Max available descriptors are 1024 (across all complexes).
+	                // Per port num_free_descriptors must be even number
+        	        num-free-descs = <52 52 52 52>;
+                	free-desc-size = <2048 2048 2048 2048>;
+	                ucore-mask = <0xffff 0xffff 0xffff 0xffff>;
+		};
+                interlaken {
+                        //select daughter board : cortina or loopback
+                        db = "cortina";
+
+                        loopback = <0>;
+
+                        // Maximum number of lanes per interface = 8 (from 2 complexes)
+                        num-lanes = <4>;
+                        // lanerate 0 = 3.125Gbps , 1 = 6.25Gbps
+                        lane-rate = <0>;
+
+                        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                        iface-fifo-size = <110>;
+
+                        // Max parser sequence fifo size 1024 packets
+                        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                        parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+                        num-channels = <4>;
+                        rx-buffer-size = <1840>;
+
+                        // Max available descriptors are 1024  (across all complexes).
+                        // Per port num_free_descriptors must be even number
+                        num-free-descs = <300>;
+                        free-desc-size = <2048>;
+                        ucore-mask = <0xffff>;
+                };
+
+	};
+	complex@1 {
+		device_type = "nae-complex";
+		mode = "xaui";
+		xaui {
+			loopback = <0>;
+			// Max ingress fifo size 256 units (size of one unit is 64 byte)
+			iface-fifo-size = <55>;
+
+			// Max parser sequence fifo size 1024 packets
+			// (if 1588 Timestamp is not required, then max size increases to 2048)
+			parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+			num-channels = <1>;
+			rx-buffer-size = <944>;
+
+			// Max available descriptors are 1024  (across all complexes).
+			// Per port num_free_descriptors must be even number
+			num-free-descs = <150>;
+			free-desc-size = <2048>;
+			ucore-mask = <0xffff>;
+		};
+		sgmii {
+	                loopback = <0 0 0 0>;
+
+	                // Max ingress fifo size 256 units (size of one unit is 64 byte)
+        	        iface-fifo-size = <13 13 13 13>;
+
+                	ext-phy-addr = <8 11 10 9>;
+	                ext-phy-bus = <1 1 1 1>;
+
+        	        // Max parser sequence fifo size 1024 packets
+                	// (if 1588 Timestamp is not required, then max size increases to 2048)
+	                num-channels = <1 1 1 1>;
+        	        parser-sequence-fifo-size = <62 62 62 62>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+        	        rx-buffer-size = <128 128 128 128>;
+
+
+                	// Max available descriptors are 1024 (across all complexes).
+	                // Per port num_free_descriptors must be even number
+        	        num-free-descs = <52 52 52 52>;
+                	free-desc-size = <2048 2048 2048 2048>;
+	                ucore-mask = <0xffff 0xffff 0xffff 0xffff>;
+		};
+
+	};
+	complex@2 {
+		device_type = "nae-complex";
+		mode = "xaui";
+
+                xaui {
+                        loopback = <0>;
+
+                        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                        iface-fifo-size = <55>;
+
+                        // Max parser sequence fifo size 1024 packets
+                        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                        parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+                        num-channels = <1>;
+                        rx-buffer-size = <944>;
+
+                        // Max available descriptors are 1024  (across all complexes).
+                        // Per port num_free_descriptors must be even number
+                        num-free-descs = <150>;
+                        free-desc-size = <2048>;
+                        ucore-mask = <0xffff>;
+                };
+
+		interlaken {
+	                //select daughter board : cortina or loopback
+        	        db = "cortina";
+
+                	loopback = <0>;
+
+	                // Maximum number of lanes per interface = 8 (from 2 complexes)
+        	        num-lanes = <4>;
+                	// lanerate 0 = 3.125Gbps , 1 = 6.25Gbps
+	                lane-rate = <0>;
+
+        	        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                	iface-fifo-size = <110>;
+
+	                // Max parser sequence fifo size 1024 packets
+        	        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                	parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+                	num-channels = <4>;
+	                rx-buffer-size = <1840>;
+
+	                // Max available descriptors are 1024  (across all complexes).
+        	        // Per port num_free_descriptors must be even number
+                	num-free-descs = <300>;
+	                free-desc-size = <2048>;
+        	        ucore-mask = <0xffff>;
+		};
+		sgmii {
+        	        loopback = <0 0 0 0>;
+
+                	// Max ingress fifo size 256 units (size of one unit is 64 byte)
+	                iface-fifo-size = <13 13 13 13>;
+
+        	        ext-phy-addr = <0 3 2 1>;
+                	ext-phy-bus = <1 1 1 1>;
+
+	                // Max parser sequence fifo size 1024 packets
+        	        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                	num-channels = <1 1 1 1>;
+	                parser-sequence-fifo-size = <62 62 62 62>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+	                rx-buffer-size = <128 128 128 128>;
+
+
+        	        // Max available descriptors are 1024 (across all complexes).
+                	// Per port num_free_descriptors must be even number
+	                num-free-descs = <52 52 52 52>;
+        	        free-desc-size = <2048 2048 2048 2048>;
+                	ucore-mask = <0xffff 0xffff 0xffff 0xffff>;
+		};
+	};
+	complex@3 {
+		device_type = "nae-complex";
+		mode = "xaui";
+		xaui {
+			loopback = <0>;
+
+			// Max ingress fifo size 256 units (size of one unit is 64 byte)
+			iface-fifo-size = <55>;
+
+			// Max parser sequence fifo size 1024 packets
+			// (if 1588 Timestamp is not required, then max size increases to 2048)
+			parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+			num-channels = <1>;
+			rx-buffer-size = <944>;
+
+			// Max available descriptors are 1024  (across all complexes).
+			// Per port num_free_descriptors must be even number
+			num-free-descs = <150>;
+			free-desc-size = <2048>;
+			ucore-mask = <0xffff>;
+		};
+                sgmii {
+                        loopback = <0 0 0 0>;
+
+                        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                        iface-fifo-size = <13 13 13 13>;
+
+                        ext-phy-addr = <12 15 14 13>;
+                        ext-phy-bus = <1 1 1 1>;
+
+                        // Max parser sequence fifo size 1024 packets
+                        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                        num-channels = <1 1 1 1>;
+                        parser-sequence-fifo-size = <62 62 62 62>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+                        rx-buffer-size = <128 128 128 128>;
+
+
+                        // Max available descriptors are 1024 (across all complexes).
+                        // Per port num_free_descriptors must be even number
+                        num-free-descs = <52 52 52 52>;
+                        free-desc-size = <2048 2048 2048 2048>;
+                        ucore-mask = <0xffff 0xffff 0xffff 0xffff>;
+                };
+	};
+	complex@4 {
+		device_type = "nae-complex";
+		mode = "sgmii";
+
+		sgmii {
+			loopback = <0 0>;
+
+			mgmt-port = <1 0>;
+
+			// Max ingress fifo size 256 units (size of one unit is 64 byte)
+			iface-fifo-size = <13 13>;
+
+			ext-phy-addr = <16 17>;
+        	        ext-phy-bus = <0 0>;
+
+			// Max parser sequence fifo size 1024 packets
+			// (if 1588 Timestamp is not required, then max size increases to 2048)
+			num-channels = <1 1>;
+			parser-sequence-fifo-size = <62 62>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+			rx-buffer-size = <128 128>;
+
 
+			// Max available descriptors are 1024 (across all complexes).
+			// Per port num_free_descriptors must be even number
+			num-free-descs = <52 52>;
+			free-desc-size = <2048 2048>;
+			ucore-mask = <0xffff 0xffff>;
+		};
+	};
+};
+   nae@node-1 {
+	model = "MIPS,XLP8XX NAE CFG";
+	compatible = "NETL,XLP8XX_A0";
+	#address-cells = <1>;
+	#size-cells = <1>;
+	frequency = <500>;
+
+	/include/ "ucore-3xx.dts"
+
+        freein-fifo-config {
+                /*
+                        1. Ucore is going to use upto max queues(16 for XLP, 8 for storm) for buffer mgmt
+                        2. Onnchip desc size per queue will be configured from arry below
+                   If spill descs per queue is specified,
+                        1. spill will be enabled for all the queues(except mgmt) using the spill memory specified in the OS config file.
+                */
+		freein-fifo-spill-mem-range = <0x00000000 0x00000000 0x00000000 0x00100000>; // Spill address will be allocated dynamically
+                freein-fifo-onchip-num-descs = <56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56>;
+                freein-fifo-spill-num-descs = <1200>;
+        };
+
+	// VFBID MAP: Upto 127 entries
+	// (each entry is a pair of (vfbid , dest-vc)
+	// Legal range: (vfbid (0 - 126), dest-vc (0 - 4095))
+	vfbid-config {
+	};
+
+	// Packet Ordering Engine (POE)
+	poe {
+
+		mode = "bypass";
+
+		// Each vector is 512 bit with masb indicating vc 512 and lsb indicating vc 0
+		// Format : 512-bit-vector is specified as 16 32-bit words
+		// Left most word has the vc range 511-479 right most word has vc range 31 - 0
+		// Each word has the MSB select higer vc number and LSB select lower vc num
+
+		distribution-enable = <1>;
+		// 16 bit mask
+		dist-drop-enable = <0>;
+		// 8 bit mask
+		class-drop-enable = <0>;
+		drop-timer = <0>;
+		dest-threshold = <0xa>;
+		dist-threshold = <0xa 0xa 0xa 0xa>;
+		statistics-enable = <0>;
+
+                distribution_vectors {
+                                     dv0  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0x1>;
+                                     dv1  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv2  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv3  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv4  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv5  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv6  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv7  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv8  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv9  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv10 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv11 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv12 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv13 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv14 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                                     dv15 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                };
+	};
+
+	complex@0 {
+		device_type = "nae-complex";
+		mode = "xaui";
+		xaui {
+			loopback = <0>;
+			// Max ingress fifo size 256 units (size of one unit is 64 byte)
+			iface-fifo-size = <55>;
+
+			// Max parser sequence fifo size 1024 packets
+			// (if 1588 Timestamp is not required, then max size increases to 2048)
+			parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+			num-channels = <1>;
+			rx-buffer-size = <944>;
+
+			// Max available descriptors are 1024  (across all complexes).
+			// Per port num_free_descriptors must be even number
+			num-free-descs = <150>;
+			free-desc-size = <2048>;
+			ucore-mask = <0xffff>;
+		};
+		sgmii {
+	                loopback = <0 0 0 0>;
+
+        	        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                	iface-fifo-size = <13 13 13 13>;
+
+	                ext-phy-addr = <4 7 6 5>;
+        	        ext-phy-bus = <1 1 1 1>;
+
+	                // Max parser sequence fifo size 1024 packets
+        	        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                	num-channels = <1 1 1 1>;
+	                parser-sequence-fifo-size = <62 62 62 62>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+        	        rx-buffer-size = <128 128 128 128>;
+
+
+                	// Max available descriptors are 1024 (across all complexes).
+	                // Per port num_free_descriptors must be even number
+        	        num-free-descs = <52 52 52 52>;
+                	free-desc-size = <2048 2048 2048 2048>;
+	                ucore-mask = <0xffff 0xffff 0xffff 0xffff>;
+		};
+                interlaken {
+                        //select daughter board : cortina or loopback
+                        db = "cortina";
+
+                        loopback = <0>;
+
+                        // Maximum number of lanes per interface = 8 (from 2 complexes)
+                        num-lanes = <4>;
+                        // lanerate 0 = 3.125Gbps , 1 = 6.25Gbps
+                        lane-rate = <0>;
+
+                        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                        iface-fifo-size = <110>;
+
+                        // Max parser sequence fifo size 1024 packets
+                        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                        parser-sequence-fifo-size = <225>;
+
+                        // Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+                        num-channels = <4>;
+                        rx-buffer-size = <1840>;
+
+                        // Max available descriptors are 1024  (across all complexes).
+                        // Per port num_free_descriptors must be even number
+                        num-free-descs = <300>;
+                        free-desc-size = <2048>;
+                        ucore-mask = <0xffff>;
+                };
+	};
+	complex@1 {
+		device_type = "nae-complex";
+		mode = "xaui";
+		xaui {
+			loopback = <0>;
+			// Max ingress fifo size 256 units (size of one unit is 64 byte)
+			iface-fifo-size = <55>;
+
+			// Max parser sequence fifo size 1024 packets
+			// (if 1588 Timestamp is not required, then max size increases to 2048)
+			parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+			num-channels = <1>;
+			rx-buffer-size = <944>;
+
+			// Max available descriptors are 1024  (across all complexes).
+			// Per port num_free_descriptors must be even number
+			num-free-descs = <150>;
+			free-desc-size = <2048>;
+			ucore-mask = <0xffff>;
+		};
+		sgmii {
+	                loopback = <0 0 0 0>;
+
+	                // Max ingress fifo size 256 units (size of one unit is 64 byte)
+        	        iface-fifo-size = <13 13 13 13>;
+
+                	ext-phy-addr = <8 11 10 9>;
+	                ext-phy-bus = <1 1 1 1>;
+
+        	        // Max parser sequence fifo size 1024 packets
+                	// (if 1588 Timestamp is not required, then max size increases to 2048)
+	                num-channels = <1 1 1 1>;
+        	        parser-sequence-fifo-size = <62 62 62 62>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+        	        rx-buffer-size = <128 128 128 128>;
+
+
+                	// Max available descriptors are 1024 (across all complexes).
+	                // Per port num_free_descriptors must be even number
+        	        num-free-descs = <52 52 52 52>;
+                	free-desc-size = <2048 2048 2048 2048>;
+	                ucore-mask = <0xffff 0xffff 0xffff 0xffff>;
+		};
+
+	};
+	complex@2 {
+		device_type = "nae-complex";
+		mode = "xaui";
+
+                xaui {
+                        loopback = <0>;
+
+                        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                        iface-fifo-size = <55>;
+
+                        // Max parser sequence fifo size 1024 packets
+                        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                        parser-sequence-fifo-size = <225>;
+
+                        num-channels = <1>;
+                        rx-buffer-size = <944>;
+
+                        // Max available descriptors are 1024  (across all complexes).
+                        // Per port num_free_descriptors must be even number
+                        num-free-descs = <150>;
+                        free-desc-size = <2048>;
+                        ucore-mask = <0xffff>;
+                };
+
+		interlaken {
+	                //select daughter board : cortina or loopback
+        	        db = "cortina";
+
+                	loopback = <0>;
+
+	                // Maximum number of lanes per interface = 8 (from 2 complexes)
+        	        num-lanes = <4>;
+                	// lanerate 0 = 3.125Gbps , 1 = 6.25Gbps
+	                lane-rate = <0>;
+
+        	        // Max ingress fifo size 256 units (size of one unit is 64 byte)
+                	iface-fifo-size = <110>;
+
+	                // Max parser sequence fifo size 1024 packets
+        	        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                	parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+                	num-channels = <4>;
+	                rx-buffer-size = <1840>;
+
+	                // Max available descriptors are 1024  (across all complexes).
+        	        // Per port num_free_descriptors must be even number
+                	num-free-descs = <300>;
+	                free-desc-size = <2048>;
+        	        ucore-mask = <0xffff>;
+		};
+		sgmii {
+        	        loopback = <0 0 0 0>;
+
+                	// Max ingress fifo size 256 units (size of one unit is 64 byte)
+	                iface-fifo-size = <13 13 13 13>;
+
+        	        ext-phy-addr = <0 3 2 1>;
+                	ext-phy-bus = <1 1 1 1>;
+
+	                // Max parser sequence fifo size 1024 packets
+        	        // (if 1588 Timestamp is not required, then max size increases to 2048)
+                	num-channels = <1 1 1 1>;
+	                parser-sequence-fifo-size = <62 62 62 62>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+	                rx-buffer-size = <128 128 128 128>;
+
+
+        	        // Max available descriptors are 1024 (across all complexes).
+                	// Per port num_free_descriptors must be even number
+	                num-free-descs = <52 52 52 52>;
+        	        free-desc-size = <2048 2048 2048 2048>;
+                	ucore-mask = <0xffff 0xffff 0xffff 0xffff>;
+		};
+	};
+	complex@3 {
+		device_type = "nae-complex";
+		mode = "xaui";
+		xaui {
+			loopback = <0>;
+
+			// Max ingress fifo size 256 units (size of one unit is 64 byte)
+			iface-fifo-size = <55>;
+
+			// Max parser sequence fifo size 1024 packets
+			// (if 1588 Timestamp is not required, then max size increases to 2048)
+			parser-sequence-fifo-size = <225>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+			num-channels = <1>;
+			rx-buffer-size = <944>;
+
+			// Max available descriptors are 1024  (across all complexes).
+			// Per port num_free_descriptors must be even number
+			num-free-descs = <150>;
+			free-desc-size = <2048>;
+			ucore-mask = <0xffff>;
+		};
+	};
+	complex@4 {
+		device_type = "nae-complex";
+		mode = "sgmii";
+
+		sgmii {
+			loopback = <0 0>;
+			mgmt-port = <1 0>;
+			// Max ingress fifo size 256 units (size of one unit is 64 byte)
+			iface-fifo-size = <13 13>;
+
+			ext-phy-addr = <16 17>;
+        	        ext-phy-bus = <0 0>;
+
+			// Max parser sequence fifo size 1024 packets
+			// (if 1588 Timestamp is not required, then max size increases to 2048)
+			num-channels = <1 1>;
+			parser-sequence-fifo-size = <62 62>;
+
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
+			rx-buffer-size = <128 128>;
+
+
+			// Max available descriptors are 1024 (across all complexes).
+			// Per port num_free_descriptors must be even number
+			num-free-descs = <52 52>;
+			free-desc-size = <2048 2048>;
+			ucore-mask = <0xffff 0xffff>;
+		};
+	};
+};
+nae@node-2 {
+
+};
+nae@node-3 {
+
+};
+
+			};
 			uart {
-				id = <0x0>;
-				owner = <0x1>;
+				id = <0>;
+				owner = <1>;
 				sharedcfg = <0x1f000000>;
 			};
-
 			memory {
 				/* <Start Size>, Unit: M */
 				reg = <0x01000000 0x0B000000	// 176M at 16M
 					0x20000000 0xa0000000>;  // 2586M at 512M
 			};
                         fmn {
-                                node_0_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_1_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_2_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_3_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                       };
+				/* make the node mask to 0xffffffff for SRIO */
+                                node_0_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_1_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_2_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_3_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                        };
 			pic {
 			};
+			nae {
+				owner = <1 0 0 0>;
+				freein-fifo-mask = <0xff 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <32 32 32 32>;
+				/* hw entries */
+				vfbtbl-hw-offset = <32 32 32 32>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+			};
+
+
 		};
 	};
 
@@ -96,20 +827,41 @@
 	};
 
 	soc {
-num-nodes = <1>;
-fmn@node-0{
+fmn@node-0 {
         default-credits = <50>;
         default-queue-size = <16384>;
-        fmn-spill-mem-base = <0x00000000 0x10000000>; /*0 - dynamic allocation */
+        fmn-spill-mem-base = <0x00000000 0x10000000>; /*0 - dynamic allocation, only for 64 bit linux */
         fmn-spill-mem-size = <0x00000000 0x02000000>;
-	q-config{
+	q-config {
+		/* credits from station
+		   "cpu popq pcie0 pcie1 pcie2 pcie3 gdx rsa crypto cmp poe nae regx srio"
+		   The order and number of station should be matching with the list given above
+		   Here, credits 0 means the default credits.
+		   Right now there is no way to configure credit of zero */
+
+                cpu {
+                        queue-size = <32768>; /* queue size for all the cpu vcs */
+                        credits-from {
+                                node-0 = <0 0 0 0 0 0 0 0 0 0 500 0 0 150>;
+                        };
+                };
 
+                nae {
+                        credits-from {
+                                node-0 = <100 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                        };
+                };
+               srio {
+                       credits-from {
+                                node-0 = <150 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                        };
+               };
 	};
 };
 fmn@node-1{
         default-credits = <50>;
         default-queue-size = <16384>;
-        fmn-spill-mem-base = <0 0>; /*0 - dynamic allocation */
+        fmn-spill-mem-base = <0x00000000 0x00000000>; /*0 - dynamic allocation */
         fmn-spill-mem-size = <0x00000000 0x02000000>;
 	q-config{
 
@@ -131,17 +883,14 @@ fmn@node-3{
 	/include/ "ucore-3xx.dts"
 
         freein-fifo-config {
-                /* If shared is true,
+                /*
                         1. Ucore is going to use upto max queues(16 for XLP, 8 for storm) for buffer mgmt
-                        2. Onnchip desc size per queue, same value will be configured for all the queues.
-                   If shared is false,
-                        1. Onchip desc size per queue will be configured using num_free_desc specified at the port level.
+                        2. Onnchip desc size per queue will be configured from arry below
                    If spill descs per queue is specified,
                         1. spill will be enabled for all the queues(except mgmt) using the spill memory specified in the OS config file.
                 */
-		freein-fifo-spill-mem-range = <0x00000000 0x0fe00000 0x00000000 0x00100000>; // 1MB @ 254MB
-                freein-fifo-shared = <0>;
-                freein-fifo-onchip-num-descs = <56>; 
+		freein-fifo-spill-mem-range = <0x00000000 0x00000000 0x00000000 0x00100000>; // spill address is allocated dynamically
+                freein-fifo-onchip-num-descs = <56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56>;
                 freein-fifo-spill-num-descs = <1200>;
         };
 
@@ -149,21 +898,11 @@ fmn@node-3{
 	// (each entry is a pair of (vfbid , dest-vc)
 	// Legal range: (vfbid (0 - 126), dest-vc (0 - 4095))
 	vfbid-config {
-		vfbid-map = <
-		      0    1    1    5    2   9    3    13
-                      4    17   5    21   6   25   7    29
-                      8    33   9    37   10  41   11   45
-                      12   49   13   53   14  57   15   61
-                      16   65   17   69   18  73   19   77
-                      20   81   21   85   22  89   23   93
-                      24   97   25  101   26 105   27  109
-                      28  113   29  117   30 121   31  125
-                >;
 	};
 
 	// Packet Ordering Engine (POE)
-	poe {	
-	
+	poe {
+
 		mode = "bypass";
 
                 distribution-enable = <1>;
@@ -208,11 +947,11 @@ fmn@node-3{
 			// Max ingress fifo size 256 units (size of one unit is 64 byte)
 			iface-fifo-size = <55>;
 
-			// Max parser sequence fifo size 1024 packets 
+			// Max parser sequence fifo size 1024 packets
 			// (if 1588 Timestamp is not required, then max size increases to 2048)
 			parser-sequence-fifo-size = <225>;
 
-			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels 
+			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
 			num-channels = <1>;
 			rx-buffer-size = <944>;
 
@@ -283,14 +1022,14 @@ fmn@node-3{
 			// Max ingress fifo size 256 units (size of one unit is 64 byte)
 			iface-fifo-size = <55>;
 
-			// Max parser sequence fifo size 1024 packets 
+			// Max parser sequence fifo size 1024 packets
 			// (if 1588 Timestamp is not required, then max size increases to 2048)
 			parser-sequence-fifo-size = <225>;
-			
+
 			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
 			num-channels = <1>;
 			rx-buffer-size = <944>;
-	
+
 			// Max available descriptors are 1024  (across all complexes).
 			// Per port num_free_descriptors must be even number
 			num-free-descs = <150>;
@@ -336,7 +1075,7 @@ fmn@node-3{
                         // Max parser sequence fifo size 1024 packets
                         // (if 1588 Timestamp is not required, then max size increases to 2048)
                         parser-sequence-fifo-size = <225>;
-			
+
 			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
                         num-channels = <1>;
                         rx-buffer-size = <944>;
@@ -358,14 +1097,14 @@ fmn@node-3{
         	        num-lanes = <4>;
                 	// lanerate 0 = 3.125Gbps , 1 = 6.25Gbps
 	                lane-rate = <0>;
-	
+
         	        // Max ingress fifo size 256 units (size of one unit is 64 byte)
                 	iface-fifo-size = <110>;
 
 	                // Max parser sequence fifo size 1024 packets
         	        // (if 1588 Timestamp is not required, then max size increases to 2048)
                 	parser-sequence-fifo-size = <225>;
-			
+
 			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
                 	num-channels = <4>;
 	                rx-buffer-size = <1840>;
@@ -410,10 +1149,10 @@ fmn@node-3{
 			// Max ingress fifo size 256 units (size of one unit is 64 byte)
 			iface-fifo-size = <55>;
 
-			// Max parser sequence fifo size 1024 packets 
+			// Max parser sequence fifo size 1024 packets
 			// (if 1588 Timestamp is not required, then max size increases to 2048)
 			parser-sequence-fifo-size = <225>;
-	
+
 			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
 			num-channels = <1>;
 			rx-buffer-size = <944>;
@@ -455,23 +1194,23 @@ fmn@node-3{
 
 		sgmii {
 			loopback = <0 0>;
-	
+
 			mgmt-port = <1 0>;
 
 			// Max ingress fifo size 256 units (size of one unit is 64 byte)
 			iface-fifo-size = <13 13>;
-                
+
 			ext-phy-addr = <16 17>;
         	        ext-phy-bus = <0 0>;
 
-			// Max parser sequence fifo size 1024 packets 
+			// Max parser sequence fifo size 1024 packets
 			// (if 1588 Timestamp is not required, then max size increases to 2048)
 			num-channels = <1 1>;
 			parser-sequence-fifo-size = <62 62>;
 
 			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
 			rx-buffer-size = <128 128>;
-				   
+
 
 			// Max available descriptors are 1024 (across all complexes).
 			// Per port num_free_descriptors must be even number
@@ -491,47 +1230,43 @@ fmn@node-3{
 	/include/ "ucore-3xx.dts"
 
         freein-fifo-config {
-                /* If shared is true,
+                /*
                         1. Ucore is going to use upto max queues(16 for XLP, 8 for storm) for buffer mgmt
-                        2. Onnchip desc size per queue, same value will be configured for all the queues.
-                   If shared is false,
-                        1. Onchip desc size per queue will be configured using num_free_desc specified at the port level.
+                        2. Onnchip desc size per queue will be configured from arry below
                    If spill descs per queue is specified,
                         1. spill will be enabled for all the queues(except mgmt) using the spill memory specified in the OS config file.
                 */
-
-                freein-fifo-shared = <0>;
-                freein-fifo-onchip-num-descs = <0>;
-                freein-fifo-spill-num-descs = <0>;
+		freein-fifo-spill-mem-range = <0x00000000 0x00000000 0x00000000 0x00100000>; // Spill address will be allocated dynamically
+                freein-fifo-onchip-num-descs = <56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56>;
+                freein-fifo-spill-num-descs = <1200>;
         };
 
 	// VFBID MAP: Upto 127 entries
 	// (each entry is a pair of (vfbid , dest-vc)
 	// Legal range: (vfbid (0 - 126), dest-vc (0 - 4095))
 	vfbid-config {
-		hw-replenish = <0>;
 	};
 
 	// Packet Ordering Engine (POE)
-	poe {	
-	
+	poe {
+
 		mode = "bypass";
 
 		// Each vector is 512 bit with masb indicating vc 512 and lsb indicating vc 0
 		// Format : 512-bit-vector is specified as 16 32-bit words
 		// Left most word has the vc range 511-479 right most word has vc range 31 - 0
 		// Each word has the MSB select higer vc number and LSB select lower vc num
-		
+
 		distribution-enable = <1>;
 		// 16 bit mask
-		dist-drop-enable = <0>;	 
+		dist-drop-enable = <0>;
 		// 8 bit mask
 		class-drop-enable = <0>;
 		drop-timer = <0>;
 		dest-threshold = <0xa>;
 		dist-threshold = <0xa 0xa 0xa 0xa>;
 		statistics-enable = <0>;
- 
+
                 distribution_vectors {
                                      dv0  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0x1>;
                                      dv1  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
@@ -560,7 +1295,7 @@ fmn@node-3{
 			// Max ingress fifo size 256 units (size of one unit is 64 byte)
 			iface-fifo-size = <55>;
 
-			// Max parser sequence fifo size 1024 packets 
+			// Max parser sequence fifo size 1024 packets
 			// (if 1588 Timestamp is not required, then max size increases to 2048)
 			parser-sequence-fifo-size = <225>;
 
@@ -576,7 +1311,7 @@ fmn@node-3{
 		};
 		sgmii {
 	                loopback = <0 0 0 0>;
-	
+
         	        // Max ingress fifo size 256 units (size of one unit is 64 byte)
                 	iface-fifo-size = <13 13 13 13>;
 
@@ -635,14 +1370,14 @@ fmn@node-3{
 			// Max ingress fifo size 256 units (size of one unit is 64 byte)
 			iface-fifo-size = <55>;
 
-			// Max parser sequence fifo size 1024 packets 
+			// Max parser sequence fifo size 1024 packets
 			// (if 1588 Timestamp is not required, then max size increases to 2048)
 			parser-sequence-fifo-size = <225>;
 
 			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
 			num-channels = <1>;
 			rx-buffer-size = <944>;
-	
+
 			// Max available descriptors are 1024  (across all complexes).
 			// Per port num_free_descriptors must be even number
 			num-free-descs = <150>;
@@ -709,7 +1444,7 @@ fmn@node-3{
         	        num-lanes = <4>;
                 	// lanerate 0 = 3.125Gbps , 1 = 6.25Gbps
 	                lane-rate = <0>;
-	
+
         	        // Max ingress fifo size 256 units (size of one unit is 64 byte)
                 	iface-fifo-size = <110>;
 
@@ -761,7 +1496,7 @@ fmn@node-3{
 			// Max ingress fifo size 256 units (size of one unit is 64 byte)
 			iface-fifo-size = <55>;
 
-			// Max parser sequence fifo size 1024 packets 
+			// Max parser sequence fifo size 1024 packets
 			// (if 1588 Timestamp is not required, then max size increases to 2048)
 			parser-sequence-fifo-size = <225>;
 
@@ -785,18 +1520,18 @@ fmn@node-3{
 			mgmt-port = <1 0>;
 			// Max ingress fifo size 256 units (size of one unit is 64 byte)
 			iface-fifo-size = <13 13>;
- 		               
+
 			ext-phy-addr = <16 17>;
         	        ext-phy-bus = <0 0>;
 
-			// Max parser sequence fifo size 1024 packets 
+			// Max parser sequence fifo size 1024 packets
 			// (if 1588 Timestamp is not required, then max size increases to 2048)
 			num-channels = <1 1>;
 			parser-sequence-fifo-size = <62 62>;
-	
+
 			// Since rx_buffer is per context, the buffer size given here will be divided by num-channels
 			rx-buffer-size = <128 128>;
-				   
+
 
 			// Max available descriptors are 1024 (across all complexes).
 			// Per port num_free_descriptors must be even number
@@ -812,6 +1547,25 @@ nae@node-2 {
 nae@node-3 {
 
 };
+		nodes {
+			num-nodes = <1>;
+		};
+		srio@node-0{
+                       /* type = "master" or "device". master is responsible for enumeration*/
+                       type = "master";
+                       /* SRIO_MODE_x1 = 1(not supported), SRIO_MODE_x4 = 2 */
+                       mode = <2>;
+                       /* BAUD_1250M = 1 (1.25G)
+                          BAUD_2500M = 2 (25.G)
+                          BAUD_3125M = 3 (3.125G)
+                          BAUD_5000M = 4 (5G)
+                          BAUD_6250M = 5 (6.25G) */
+                       baud-rate = <5>;
+                       rxvc = <2>;
+                       msgdstid = <2>;
+                       /* sys-size = 1 for 16bit device id, 0 for 8 bit device id */
+                       sys-size = <1>;
+               };
 
 	};
 };
diff --git a/arch/mips/boot/dts/xlp832.dts b/arch/mips/boot/dts/xlp832.dts
index eaf927e..d3836d2 100644
--- a/arch/mips/boot/dts/xlp832.dts
+++ b/arch/mips/boot/dts/xlp832.dts
@@ -3,60 +3,70 @@
  */
 
 /dts-v1/;
-
 / {
 	model = "MIPS,XLP8XX";
 	compatible = "NETL,XLP8XX_A0";
-	#address-cells = <0x1>;
-	#size-cells = <0x1>;
+
+	#address-cells = <1>;
+	#size-cells = <1>;
 
 	hypervisor {
 		hypervisor-name = "Xen";
-		alloc_dom0_memory = <0x0>;
-		bootargs = "ncores=8 dom0_loadaddr=0x72000000 dom0_size=0x1c000000 dom0_cpumask=0xffffffff-- ";
+		alloc_dom0_memory = <0>;
+		bootargs = "ncores=8 dom0_loadaddr=0x72000000 dom0_size=0x1c000000 dom0_cpumask=0xffffffff -- ";
 		domain_heap = <0x80000000 0x20000000>;
 	};
-
 	doms {
-		#address-cells = <0x1>;
-		#size-cells = <0x1>;
-
+		#address-cells = <1>;
+		#size-cells = <1>;
 		dom@0 {
 			device_type = "domain";
 			os = "linux";
-			#address-cells = <0x1>;
-			#size-cells = <0x1>;
+
+			#address-cells = <1>;
+			#size-cells = <1>;
 
 			cpu {
 				onlinemask = <0xffffffff>;
-				nae-rx-vc = <0x0>;
-				nae-fb-vc = <0x1>;
-				napi-vc-mask = <0x3>;
-				sae-rx-vc = <0x0>;
-				sae-rx-sync-vc = <0x3>;
-				ipsec-async-vc = <0x0>;
-				ipsec-sync-vc = <0x2>;
-			};
+				nae-rx-vc = <0>;
+				nae-fb-vc = <1>;
+				napi-vc-mask = <0xb>;
+				sae-rx-vc = <0>; /* sharing with nae */
+				sae-rx-sync-vc  = <3>; /* should be exclusive */
+				ipsec-async-vc  = <3>;
+				ipsec-sync-vc   = <2>;
 
+			};
 			uart {
-				id = <0x0>;
-				owner = <0x1>;
+				id = <0>;
+				owner = <1>;
 				sharedcfg = <0x1f000000>;
 			};
-
 			memory {
 				/* <Start Size>, Unit: M */
 				reg = <0x01000000 0x0B000000	// 176M at 16M
 					0x20000000 0xa0000000>;  // 2586M at 512M
 			};
                         fmn {
-                                node_0_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_1_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_2_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_3_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                       };
+                                node_0_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_1_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_2_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_3_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                        };
 			pic {
 			};
+			nae {
+				owner = <1 0 0 0>;
+				freein-fifo-mask = <0xffff 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <32 32 32 32>;
+				/* hw entries */
+				vfbtbl-hw-offset = <32 32 32 32>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
+			};
+
 		};
 	};
 
@@ -95,20 +105,41 @@
 	};
 
 	soc {
-num-nodes = <1>;
-fmn@node-0{
+fmn@node-0 {
         default-credits = <50>;
         default-queue-size = <16384>;
-        fmn-spill-mem-base = <0x00000000 0x10000000>; /*0 - dynamic allocation */
+        fmn-spill-mem-base = <0x00000000 0x10000000>; /*0 - dynamic allocation, only for 64 bit linux */
         fmn-spill-mem-size = <0x00000000 0x02000000>;
-	q-config{
+	q-config {
+		/* credits from station
+		   "cpu popq pcie0 pcie1 pcie2 pcie3 gdx rsa crypto cmp poe nae regx srio"
+		   The order and number of station should be matching with the list given above
+		   Here, credits 0 means the default credits.
+		   Right now there is no way to configure credit of zero */
+
+                cpu {
+                        queue-size = <32768>; /* queue size for all the cpu vcs */
+                        credits-from {
+                                node-0 = <0 0 0 0 0 0 0 0 0 0 500 0 0 150>;
+                        };
+                };
 
+                nae {
+                        credits-from {
+                                node-0 = <100 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                        };
+                };
+               srio {
+                       credits-from {
+                                node-0 = <150 0 0 0 0 0 0 0 0 0 0 0 0 0>;
+                        };
+               };
 	};
 };
 fmn@node-1{
         default-credits = <50>;
         default-queue-size = <16384>;
-        fmn-spill-mem-base = <0 0>; /*0 - dynamic allocation */
+        fmn-spill-mem-base = <0x00000000 0x00000000>; /*0 - dynamic allocation */
         fmn-spill-mem-size = <0x00000000 0x02000000>;
 	q-config{
 
@@ -138,26 +169,15 @@ fmn@node-3{
                    If spill descs per queue is specified,
                         1. spill will be enabled for all the queues(except mgmt) using the spill memory specified in the OS config file.
                 */
-		freein-fifo-spill-mem-range = <0x00000000 0x0fe00000 0x00000000 0x00100000>; // 1MB @ 254MB
-                freein-fifo-shared = <0>;
-                freein-fifo-onchip-num-descs = <56>; 
-                freein-fifo-spill-num-descs = <1200>;
+		freein-fifo-spill-mem-range = <0x00000000 0x00000000 0x00000000 0x00100000>; // spill address is allocated dynamically
+		freein-fifo-onchip-num-descs = <56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56>;
+		freein-fifo-spill-num-descs = <1200>;
         };
 
 	// VFBID MAP: Upto 127 entries
 	// (each entry is a pair of (vfbid , dest-vc)
 	// Legal range: (vfbid (0 - 126), dest-vc (0 - 4095))
 	vfbid-config {
-		vfbid-map = <
-		      0    1    1    5    2   9    3    13
-                      4    17   5    21   6   25   7    29
-                      8    33   9    37   10  41   11   45
-                      12   49   13   53   14  57   15   61
-                      16   65   17   69   18  73   19   77
-                      20   81   21   85   22  89   23   93
-                      24   97   25  101   26 105   27  109
-                      28  113   29  117   30 121   31  125
-                >;
 	};
 
 	// Packet Ordering Engine (POE)
@@ -498,17 +518,15 @@ fmn@node-3{
                    If spill descs per queue is specified,
                         1. spill will be enabled for all the queues(except mgmt) using the spill memory specified in the OS config file.
                 */
-
-                freein-fifo-shared = <0>;
-                freein-fifo-onchip-num-descs = <0>;
-                freein-fifo-spill-num-descs = <0>;
+		freein-fifo-spill-mem-range = <0x00000000 0x00000000 0x00000000 0x00100000>; // Spill address will be allocated dynamically
+		freein-fifo-onchip-num-descs = <56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56 56>;
+		freein-fifo-spill-num-descs = <1200>;
         };
 
 	// VFBID MAP: Upto 127 entries
 	// (each entry is a pair of (vfbid , dest-vc)
 	// Legal range: (vfbid (0 - 126), dest-vc (0 - 4095))
 	vfbid-config {
-		hw-replenish = <0>;
 	};
 
 	// Packet Ordering Engine (POE)
@@ -811,6 +829,9 @@ nae@node-2 {
 nae@node-3 {
 
 };
+		nodes {
+			num-nodes = <1>;
+		};
 
 	};
 };
-- 
1.7.0

