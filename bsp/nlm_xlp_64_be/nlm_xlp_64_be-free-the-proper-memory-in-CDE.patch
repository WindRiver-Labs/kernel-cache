From 08bb5cebf430fca3aac77bfeb9c71d0f1c516712 Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Fri, 20 Apr 2012 16:30:05 +0800
Subject: [PATCH 23/47] nlm_xlp_64_be: free the proper memory in CDE

The problem: The system would print the CallTrace
when removing nlm_cde module.

The reason: Free the improper memory in the rmmod process
of this module.

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/misc/nlm-cde/nlm_cde.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/misc/nlm-cde/nlm_cde.c b/drivers/misc/nlm-cde/nlm_cde.c
index aecfd3b..0ce3cc9 100644
--- a/drivers/misc/nlm-cde/nlm_cde.c
+++ b/drivers/misc/nlm-cde/nlm_cde.c
@@ -654,7 +654,7 @@ void nlm_cde_cleanup(cmp_data_t *cmp_data)
 
   for (i = 0; i < NUM_FREE_DESCRIPTORS; i++) {
     if (page_array[i].data_array)	{
-	free_cache_aligned_mem((void*)page_array_tmp_data_array[i]);
+	free_cache_aligned_mem((void*)page_array[i].data_array);
 	page_array[i].data_array = NULL;
     }	
   }
-- 
1.7.0

