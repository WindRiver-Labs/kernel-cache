From de02290a97dd5ea3aa87eb6ee62740b8acdba963 Mon Sep 17 00:00:00 2001
From: Yashpal Dutta <yashpal.dutta@freescale.com>
Date: Wed, 13 Jun 2012 18:35:17 +0000
Subject: [PATCH 1/7] usdpaa: Change buffer size to 1728

BSM in all the FMAN ports have been increased to 128 bytes by default. Thus
there is a possibility of SG frames for MTU sized frames in USDPAA which would
impact the performance. Keeping buffer size to odd cacheline sized multiple of
size sufficient to keep new annotation and MTU frames

Signed-off-by: Yashpal Dutta <yashpal.dutta@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2.1-20120824-yocto.tar.gz tarball. Just remove the parts
for p2041, p3041, p3060 and p4080.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/boot/dts/p5020ds-usdpaa.dts |    2 +-
 arch/powerpc/boot/dts/p5040ds-usdpaa.dts |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/boot/dts/p5020ds-usdpaa.dts b/arch/powerpc/boot/dts/p5020ds-usdpaa.dts
index 78952f1..12afe8b 100644
--- a/arch/powerpc/boot/dts/p5020ds-usdpaa.dts
+++ b/arch/powerpc/boot/dts/p5020ds-usdpaa.dts
@@ -59,7 +59,7 @@
 	bp9: buffer-pool@9 {
 		compatible = "fsl,p5020-bpool", "fsl,bpool";
 		fsl,bpid = <9>;
-		fsl,bpool-ethernet-cfg = <0 0 0 1600 0 0xfeedabba>;
+		fsl,bpool-ethernet-cfg = <0 0 0 1728 0 0xfeedabba>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp10: buffer-pool@10 {
diff --git a/arch/powerpc/boot/dts/p5040ds-usdpaa.dts b/arch/powerpc/boot/dts/p5040ds-usdpaa.dts
index 685175c..da24437 100644
--- a/arch/powerpc/boot/dts/p5040ds-usdpaa.dts
+++ b/arch/powerpc/boot/dts/p5040ds-usdpaa.dts
@@ -58,7 +58,7 @@
 	bp9: buffer-pool@9 {
 		compatible = "fsl,p5040-bpool", "fsl,bpool";
 		fsl,bpid = <9>;
-		fsl,bpool-ethernet-cfg = <0 0 0 1600 0 0xfeedabba>;
+		fsl,bpool-ethernet-cfg = <0 0 0 1728 0 0xfeedabba>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 
-- 
1.7.0.5

