From 7121053e464b8ff7ccf1caec1954b045f0bf4293 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Sat, 18 Jul 2015 10:53:20 +0800
Subject: [PATCH] powerpc: Fix a wrong sys_call_table declaration to enable
 syscall tracing

The commit 155e149e included a very new mainline commit 1028ccf5 to fix a
wrong sys_call_table declaration without considerations on the dependency
between patches and arch difference. This patch is try to fix it because of
the following reason:

sys_call_table referred in C level is defined as a pointer to a pointer array
in assembler level for powerpc64, and it has been defined as an array, so fix
it to avoid syscall perf error.

Signed-off-by:Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/powerpc/include/asm/syscall.h |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/include/asm/syscall.h b/arch/powerpc/include/asm/syscall.h
index 528ba9d..974a0ff 100644
--- a/arch/powerpc/include/asm/syscall.h
+++ b/arch/powerpc/include/asm/syscall.h
@@ -17,7 +17,11 @@
 
 /* ftrace syscalls requires exporting the sys_call_table */
 #ifdef CONFIG_FTRACE_SYSCALLS
+#ifdef CONFIG_PPC64
+extern const unsigned long * sys_call_table;
+#else
 extern const unsigned long sys_call_table[];
+#endif /* CONFIG_PPC64 */
 #endif /* CONFIG_FTRACE_SYSCALLS */
 
 static inline long syscall_get_nr(struct task_struct *task,
-- 
1.7.5.4

