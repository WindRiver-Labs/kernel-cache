From dee54f012f5ef0be884f6c6565af4969ce08fd0c Mon Sep 17 00:00:00 2001
From: ShengLiang Song <shengliang.song@broadcom.com>
Date: Mon, 17 Dec 2012 10:35:12 -0800
Subject: [PATCH 646/762] EPID: use new PID api

Based on Broadcom SDK 2.3.

Signed-off-by: ShengLiang Song <shengliang.song@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/mm/cerr-nlm.c |   13 ++++++-------
 1 files changed, 6 insertions(+), 7 deletions(-)

diff --git a/arch/mips/mm/cerr-nlm.c b/arch/mips/mm/cerr-nlm.c
index b577a41..e347f5b 100644
--- a/arch/mips/mm/cerr-nlm.c
+++ b/arch/mips/mm/cerr-nlm.c
@@ -220,12 +220,11 @@ static void dump_cerr_info(void)
 	cerr_printk("     NBU: reg0 = 0x%08x, reg1 = 0x%08x, reg2 = 0x%08x\n",
 				nbu_reg0, nbu_reg1, nbu_reg2);
 
-	num_controllers = 4;	//8xx has 4 controller
-	ret=is_nlm_xlp(300, XLP_REVISION_ANY, CPU_EXTPID_XLP_3XX_ANY);
+	num_controllers = 4;	/* 8xx has 4 controller */
+	ret=is_nlm_xlp3xx_rev(XLP_REVISION_ANY);
 	if( ret ) num_controllers = 2;
-	else
-	{
-		ret=is_nlm_xlp(200, XLP_REVISION_ANY, 0 );
+	else {
+		ret=is_nlm_xlp2xx();
 		if( ret ) num_controllers = 1;
 	}
 
@@ -456,11 +455,11 @@ static int check_DRAM_error(void)
 	uint64_t mmio = nlm_hal_get_dev_base(node, 0, NLH_BRIDGE, 0);
 
 	int num_controllers = 4;	//8xx has 4 controller
-	int ret=is_nlm_xlp(300, XLP_REVISION_ANY, CPU_EXTPID_XLP_3XX_ANY);
+	int ret=is_nlm_xlp3xx_rev(XLP_REVISION_ANY);
 	if( ret ) num_controllers = 2;
 	else
 	{
-		ret=is_nlm_xlp(200, XLP_REVISION_ANY, 0 );
+		ret=is_nlm_xlp2xx();
 		if( ret ) num_controllers = 1;
 	}
 
-- 
1.7.0.4

