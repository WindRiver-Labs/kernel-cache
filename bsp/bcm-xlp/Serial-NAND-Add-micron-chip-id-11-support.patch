From 585ddb8ea987221409899976227e478ea76432d6 Mon Sep 17 00:00:00 2001
From: henry shao <hshao@netlogicmicro.com>
Date: Fri, 3 Jun 2011 10:02:46 -0700
Subject: [PATCH 289/761] Serial NAND: Add micron chip id 11 support.

Based on Broadcom SDK 2.3.

Signed-off-by: henry shao <hshao@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/mtd/devices/mt29f_spi.c |   13 +++++++++++--
 1 file changed, 11 insertions(+), 2 deletions(-)

diff --git a/drivers/mtd/devices/mt29f_spi.c b/drivers/mtd/devices/mt29f_spi.c
index aa5a9ff..7de0684 100644
--- a/drivers/mtd/devices/mt29f_spi.c
+++ b/drivers/mtd/devices/mt29f_spi.c
@@ -71,6 +71,7 @@ THE POSSIBILITY OF SUCH DAMAGE.
 #define MT29F_REG_STATUS		0xC0
 
 #define MICRON_ID_MT29F1G01ZAC		0x12
+#define MICRON_ID_MT29F1G01ZAC1		0x11
 #define MICRON_SR_WIP         		(1 << 0)  /* Write-in-Progress */
 #define SPINAND_TIMEOUT			0x7fffffff
 
@@ -95,6 +96,13 @@ static const struct mt29f_snand_params mt29f_snand_table[] = {
                 .nr_blocks               = 1024,
                 .name                    = "MT29F1G01ZAC",
         },
+        {
+                .idcode1                 = MICRON_ID_MT29F1G01ZAC1,
+                .page_size               = 2048,
+                .pages_per_block	 = 64,
+                .nr_blocks               = 1024,
+                .name                    = "MT29F1G01ZAC",
+        },
 };
 /****************************************************************************/
 
@@ -648,9 +656,10 @@ static int __devinit mt29f_probe(struct spi_device *spi)
 		params++;
         }
 	
-	if (!params)
+	if (!params || i == ARRAY_SIZE(mt29f_snand_table)) {
+		printk("The Chip ID does not match device in driver device table\n");
 		return -ENODEV;
-	
+	}
 	memcpy(&snand->params, params, sizeof(struct mt29f_snand_params));
 
 	snand->mtd.name = dev_name(&spi->dev);
-- 
1.7.10.4

