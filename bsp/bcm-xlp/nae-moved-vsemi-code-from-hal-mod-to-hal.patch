From 611f7c23160c2de69ef576d9a865128f7bf54b14 Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Tue, 23 Apr 2013 16:01:12 +0800
Subject: [PATCH 688/761] nae: moved vsemi code from hal/mod to hal.

This is required for xlp2xx, in order to support SGMII and XAUI.

Based on Broadcom SDK 2.3.

Signed-off-by: Sreenidhi B R <sreenira@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 .../include/asm/netlogic/hal/nlm_hal_vsemi_data.h  |    9 +++--
 arch/mips/netlogic/common/nlm_hal_nae.c            |    1 -
 arch/mips/netlogic/common/nlm_hal_vsemi_config.c   |   38 ++++++++++++++++++--
 3 files changed, 43 insertions(+), 5 deletions(-)

diff --git a/arch/mips/include/asm/netlogic/hal/nlm_hal_vsemi_data.h b/arch/mips/include/asm/netlogic/hal/nlm_hal_vsemi_data.h
index 332b56b..abc0b07 100644
--- a/arch/mips/include/asm/netlogic/hal/nlm_hal_vsemi_data.h
+++ b/arch/mips/include/asm/netlogic/hal/nlm_hal_vsemi_data.h
@@ -2,6 +2,12 @@
  * Copyright (c) 2003-2012 Broadcom Corporation
  * All Rights Reserved
  *
+ * This software is available to you under a choice of one of two
+ * licenses.  You may choose to be licensed under the terms of the GNU
+ * General Public License (GPL) Version 2, available from the file
+ * http://www.gnu.org/licenses/gpl-2.0.txt
+ * or the Broadcom license below:
+
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
  * are met:
@@ -25,8 +31,7 @@
  * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
  * IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *
- * #BRCM_2# */
-
+ * #BRCM_4# */
 #ifndef _NLM_HAL_VESMI_DATA_H_
 #define _NLM_HAL_VSEMI_DATA_H_
 
diff --git a/arch/mips/netlogic/common/nlm_hal_nae.c b/arch/mips/netlogic/common/nlm_hal_nae.c
index d65f870..82e245c 100644
--- a/arch/mips/netlogic/common/nlm_hal_nae.c
+++ b/arch/mips/netlogic/common/nlm_hal_nae.c
@@ -3014,7 +3014,6 @@ static void reset_nae(int node)
 	nlm_mdelay(1);
 	rx_config = nlm_hal_read_nae_reg(node, RX_CONFIG);
 	nae_reset_done[node] = 1;
-	printf(" nae reset done with rx_config = %d\n", rx_config);
 }
 
 #if defined(__MIPSEL__)
diff --git a/arch/mips/netlogic/common/nlm_hal_vsemi_config.c b/arch/mips/netlogic/common/nlm_hal_vsemi_config.c
index d1d885f..892b3bc 100644
--- a/arch/mips/netlogic/common/nlm_hal_vsemi_config.c
+++ b/arch/mips/netlogic/common/nlm_hal_vsemi_config.c
@@ -2,6 +2,12 @@
  * Copyright (c) 2003-2012 Broadcom Corporation
  * All Rights Reserved
  *
+ * This software is available to you under a choice of one of two
+ * licenses.  You may choose to be licensed under the terms of the GNU
+ * General Public License (GPL) Version 2, available from the file
+ * http://www.gnu.org/licenses/gpl-2.0.txt
+ * or the Broadcom license below:
+
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions
  * are met:
@@ -25,8 +31,7 @@
  * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
  * IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  *
- * #BRCM_2# */
-
+ * #BRCM_4# */
 #include "nlm_hal_vsemi_data.h"
 
 unsigned char vsemi_mem_sgmii_4page [256];
@@ -722,3 +727,32 @@ void nlm_hal_config_vsemi_mem_sgmii_4page_125Mhz(void)
 	vsemi_mem_sgmii_4page[109] = 0x11;
 	vsemi_mem_sgmii_4page[110] = 0xF;
 }
+
+#ifdef NLM_HAL_LINUX_KERNEL
+#include <linux/types.h>
+#include <linux/module.h>
+EXPORT_SYMBOL(vsemi_mem_sgmii_4page);
+EXPORT_SYMBOL(vsemi_mem_sgmii);
+EXPORT_SYMBOL(vsemi_mem_xaui_4page);
+EXPORT_SYMBOL(vsemi_mem_xaui);
+EXPORT_SYMBOL(vsemi_mem_12G_4page);
+EXPORT_SYMBOL(vsemi_mem_12G);
+EXPORT_SYMBOL(vsemi_mem_16G_4page);
+EXPORT_SYMBOL(vsemi_mem_16G);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_16G_4page);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_16G_4page_125);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_16G);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_16G_125);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_12G_4page);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_12G_4page_125);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_12G);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_12G_125);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_xaui);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_xaui_125);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_xaui_4page);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_xaui_4page_125);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_sgmii);
+EXPORT_SYMBOL(vsemi_mem_init_sgmii_125Mhzrefclk);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_sgmii_4page);
+EXPORT_SYMBOL(nlm_hal_config_vsemi_mem_sgmii_4page_125Mhz);
+#endif
-- 
1.7.10.4

