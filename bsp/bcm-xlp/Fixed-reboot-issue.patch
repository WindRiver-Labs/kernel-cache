From ee0dacf143ba8d7e8e55d7e3646d4b93329bdb5b Mon Sep 17 00:00:00 2001
From: "P. Sadik" <psadik@netlogicmicro.com>
Date: Thu, 17 Feb 2011 09:14:24 +0530
Subject: [PATCH 238/761] Fixed reboot issue

Based on Broadcom SDK 2.3.

Signed-off-by: P. Sadik <psadik@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/setup.c |    6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/mips/netlogic/xlp/setup.c b/arch/mips/netlogic/xlp/setup.c
index 5c771dd..cac8f3c 100644
--- a/arch/mips/netlogic/xlp/setup.c
+++ b/arch/mips/netlogic/xlp/setup.c
@@ -217,9 +217,9 @@ const char *get_system_type(void)
 static void ptr_linux_exit(void)
 {
 	// trigger a chip reset
-	write_32bit_cfg_reg((uint32_t *)xlp_sys_base, 0x40 | CHIP_RESET, 1);
-	for ( ; ; )
-		cpu_wait();
+	 nlm_hal_write_sys_reg(CHIP_RESET, 1);
+	 for ( ; ; )
+		  cpu_wait();
 }
 
 void __init bus_error_init(void)
-- 
1.7.10.4

