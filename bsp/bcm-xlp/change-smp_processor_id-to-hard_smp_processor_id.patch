From 889485a530eb797109ed8819f94b80668ea29fab Mon Sep 17 00:00:00 2001
From: henry shao <hshao@netlogicmicro.com>
Date: Wed, 9 Jun 2010 15:25:31 -0700
Subject: [PATCH 060/761] change smp_processor_id to hard_smp_processor_id

Based on Broadcom SDK 2.3.

Signed-off-by: henry shao <hshao@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/on_chip.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/arch/mips/netlogic/xlp/on_chip.c b/arch/mips/netlogic/xlp/on_chip.c
index 031b275..3261753 100644
--- a/arch/mips/netlogic/xlp/on_chip.c
+++ b/arch/mips/netlogic/xlp/on_chip.c
@@ -334,7 +334,8 @@ void nlm_xlp_msgring_int_handler(unsigned int irq, struct pt_regs *regs)
 
 	cycles = read_c0_count();
 
-	core = cpu_logical_map(smp_processor_id()) >> 2;
+//	core = cpu_logical_map(smp_processor_id()) >> 2;
+	core = cpu_logical_map(hard_smp_processor_id()) >> 2;
 //	msgring_process_rx_msgs(pop_bucket_start[core], pop_bucket_end[core], pop_bucket_mask[core]);
         msgrng_access_enable(mflags);
 	for( vc = 0; vc < 4; vc++){
-- 
1.7.10.4

