From 9034a34209cc407a50a61f8994664b3cfa5c9167 Mon Sep 17 00:00:00 2001
From: Nam Ninh <nam.ninh@windriver.com>
Date: Tue, 25 Nov 2014 18:00:10 -0500
Subject: [PATCH] bcm-xlp: enable netlogic drivers optionally.

Introduce a new config option to allow enabling the netlogic
drivers optionally so that we can turn off the drivers that don't work
on the guest.

Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/drivers/Makefile b/drivers/Makefile
index 6eeed95..0c18f79 100644
--- a/drivers/Makefile
+++ b/drivers/Makefile
@@ -152,4 +152,4 @@ obj-$(CONFIG_IIO)		+= iio/
 obj-$(CONFIG_VME_BUS)		+= vme/
 obj-$(CONFIG_IPACK_BUS)		+= ipack/
 obj-$(CONFIG_NTB)		+= ntb/
-obj-$(CONFIG_NLM_XLP_BOARD)	+= netlogic/
+obj-$(CONFIG_NETLOGIC_DRIVERS)	+= netlogic/
diff --git a/drivers/netlogic/Kconfig b/drivers/netlogic/Kconfig
index 6ad7b30..44058a4 100644
--- a/drivers/netlogic/Kconfig
+++ b/drivers/netlogic/Kconfig
@@ -1,3 +1,15 @@
+menuconfig NETLOGIC_DRIVERS
+	bool "Netlogic drivers"
+	---help---
+	  Say Y here to see options for device drivers that support Network
+	  Acceleration engine (NAE), compression/decompression Engine (CDE),
+	  Security Acceleration Engine (SAE), fmn data path, Manage Packet Pool
+	  (PPM) and so on.
+
+	  If you say N, all options in this submenu will be skipped and disabled.
+
+if NETLOGIC_DRIVERS
+
 config XLP_NAE_SUPPORT
 	bool "Enable XLP NAE support"
 	depends on NLM_XLP_BOARD
@@ -81,3 +93,5 @@ config NLM_XLP_CRYPTO
 	tristate "NLM XLP Crypto"
 	depends on NLM_XLP_BOARD
 	default n
+
+endif
-- 
1.9.1

