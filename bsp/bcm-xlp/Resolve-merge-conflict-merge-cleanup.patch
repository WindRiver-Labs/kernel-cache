From ddfcac1c086d39daac56cd2a973ad0002383319b Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Thu, 29 Sep 2011 16:17:13 -0700
Subject: [PATCH 399/761] Resolve merge conflict: merge, cleanup

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 init/main.c |   11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/init/main.c b/init/main.c
index 256e284..8dedf56 100644
--- a/init/main.c
+++ b/init/main.c
@@ -130,7 +130,6 @@ extern void softirq_init(void);
 char __initdata boot_command_line[COMMAND_LINE_SIZE];
 /* Untouched saved command line (eg. for /proc) */
 char *saved_command_line;
-EXPORT_SYMBOL(saved_command_line);
 /* Command line for parameter parsing */
 static char *static_command_line;
 
@@ -805,14 +804,11 @@ static void run_init_process(const char *init_filename)
 	kernel_execve(init_filename, argv_init, envp_init);
 }
 
-#include <asm/netlogic/cpumask.h>
 /* This is a non __init function. Force it to be noinline otherwise gcc
  * makes it inline to init() and it becomes part of init.text section
  */
 static noinline int init_post(void)
 {
-	struct cpumask cpumask;
-
 	/* need to finish all async __init code before freeing the memory */
 	async_synchronize_full();
 	free_initmem();
@@ -846,8 +842,15 @@ static noinline int init_post(void)
 	      "See Linux Documentation/init.txt for guidance.");
 }
 
+#ifdef CONFIG_NLM_XLP
+#include <asm/netlogic/cpumask.h>
+#endif
+
 static int __init kernel_init(void * unused)
 {
+#ifdef CONFIG_NLM_XLP
+	struct cpumask cpumask;
+#endif
 	struct stat console_stat;
 	/*
 	 * Wait until kthreadd is all set-up.
-- 
1.7.10.4

