From d05624d700c3a851220b04afc1ef06b42cb9495e Mon Sep 17 00:00:00 2001
From: Ashok Kumar <ashoks@broadcom.com>
Date: Tue, 16 Jul 2013 07:11:06 +0530
Subject: poe: correct Din Max line config.

Din spill base address is the whole physical address whereas
Din Max line is the number of cachelines for the corresponding class
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/netlogic/lib/netlib/include/netsoc_poe.h b/arch/mips/netlogic/lib/netlib/include/netsoc_poe.h
index 88c729e..f193f46 100644
--- a/arch/mips/netlogic/lib/netlib/include/netsoc_poe.h
+++ b/arch/mips/netlogic/lib/netlib/include/netsoc_poe.h
@@ -163,7 +163,6 @@ static inline void __netsoc_v1_config_poedin_spill(poe_t *poe, uint32_t class_nu
 	uint64_t poebase = poe->pcie_base;
 	uint32_t  spillbase_lo, spillbase_hi;
 
-        //spillbase >>= 6;
 	spillbase_lo = spillbase & 0xFFFFFFFF;
 	spillbase_hi = (spillbase >> 32) & 0xFF;
 
@@ -171,8 +170,7 @@ static inline void __netsoc_v1_config_poedin_spill(poe_t *poe, uint32_t class_nu
 	netsoc_write_poe_pcie_reg(poebase, (POE_DIN_SPILL_BASELO_C0 + (class_num * 2)), spillbase_lo);
         netsoc_write_poe_pcie_reg(poebase, (POE_DIN_SPILL_BASEHI_C0 + (class_num * 2)), spillbase_hi);
 
-	netsoc_write_poe_pcie_reg(poebase, POE_DIN_SPILL_MAXLINE_C0 + class_num, 0x2);
-	//netsoc_write_poe_pcie_reg(poebase, POE_DIN_SPILL_MAXLINE_C0 + class_num, (spillsz >> 6));
+	netsoc_write_poe_pcie_reg(poebase, POE_DIN_SPILL_MAXLINE_C0 + class_num, (spillsz >> 6));
 	
 } 
 
-- 
1.7.1

