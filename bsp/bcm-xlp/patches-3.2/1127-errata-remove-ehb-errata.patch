From e04f628b6c70881a7a2ababe258d668c5a7be3ea Mon Sep 17 00:00:00 2001
From: Yonghong Song <ysong@broadcom.com>
Date: Mon, 29 Oct 2012 09:09:43 -0700
Subject: errata: remove ehb errata

  o The errata is fixed in xlp8xx rev B2, xlp3xx rev B1 and xlp2xx/xlp1xx rev A1.
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/drivers/misc/netlogic/linux-loader/xlr_lib_launch.c b/drivers/misc/netlogic/linux-loader/xlr_lib_launch.c
index fa18008..78d5bfb 100644
--- a/drivers/misc/netlogic/linux-loader/xlr_lib_launch.c
+++ b/drivers/misc/netlogic/linux-loader/xlr_lib_launch.c
@@ -82,7 +82,6 @@ static __inline__ void lib_sync(void)
 		".set noreorder\n"
 		".set mips64r2\n"
 		"sync\n"
-		"ehb\n"
 		".set pop\n"
 	);
 
diff --git a/drivers/misc/netlogic/linux-loader/xlr_lib_platform.h b/drivers/misc/netlogic/linux-loader/xlr_lib_platform.h
index 8ee6b2c..ffdb842 100644
--- a/drivers/misc/netlogic/linux-loader/xlr_lib_platform.h
+++ b/drivers/misc/netlogic/linux-loader/xlr_lib_platform.h
@@ -76,7 +76,6 @@ static __inline__ void lib_spin_lock(lib_spinlock_t *lock)
 	    "sc\t%1, %0\n\t"
 	    "beqz\t%1, 1b\n\t"
 	    " nop\n\t"
-	    " ehb\n\t"
 	    ".set\treorder"
 	    : "=m" (lock->lock), "=&r" (tmp)
 	    : "m" (lock->lock)
@@ -88,7 +87,6 @@ static __inline__ void lib_spin_unlock(lib_spinlock_t *lock)
 	__asm__ __volatile__(
 	    ".set\tnoreorder\t\t\t# spin_unlock\n\t"
 	    "sync\n\t"
-	    "ehb\n\t"
 	    "sw\t$0, %0\n\t"
 	    ".set\treorder"
 	    : "=m" (lock->lock)
-- 
1.7.1

