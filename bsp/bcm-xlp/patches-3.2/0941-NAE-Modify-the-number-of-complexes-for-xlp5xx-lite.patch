From 0311486bd60f57fd0c647b1423523cda1f2d6e5e Mon Sep 17 00:00:00 2001
From: ajesh <ajesh@broadcom.com>
Date: Tue, 20 May 2014 16:00:22 +0530
Subject: NAE: Modify the number of complexes for xlp5xx lite

There are no sgmii mgmt ports on XLP5xx Lite.
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/netlogic/lib/netlib/src/netsoc_config.c b/arch/mips/netlogic/lib/netlib/src/netsoc_config.c
index 0d02bb3..56b941d 100644
--- a/arch/mips/netlogic/lib/netlib/src/netsoc_config.c
+++ b/arch/mips/netlogic/lib/netlib/src/netsoc_config.c
@@ -238,6 +238,11 @@ void update_netsoc_info(void)
 	if (IS_NLM_XLP9XX_FAMILY) {
 		socnet_version_v0 = 0;
 		current_netsoc = &xlp9xx_netsoc;
+		if(is_nlm_xlp5xx_lite())
+		{
+			/* xlp5xx lite does not have sgmii mgmt port */
+			current_netsoc->max_blocks = 2;
+		}
 		netsoc_api_print(NETSOC_APIDBG_DEFAULT,"BRCM HAL net confgured for xlp9xx\n");
 	}
 	else if (is_nlm_xlp2xx()) {
diff --git a/arch/mips/netlogic/lib/syslib/include/nlm_hal_xlp_dev.h b/arch/mips/netlogic/lib/syslib/include/nlm_hal_xlp_dev.h
index c716742..7f4d212 100644
--- a/arch/mips/netlogic/lib/syslib/include/nlm_hal_xlp_dev.h
+++ b/arch/mips/netlogic/lib/syslib/include/nlm_hal_xlp_dev.h
@@ -229,6 +229,8 @@ extern int is_nlm_xlp(unsigned int chipid, unsigned int rev,  unsigned int ext);
 #define is_nlm_xlp516() is_nlm_xlp516_rev(XLP_REVISION_ANY)
 #define is_nlm_xlp5xx()	     is_nlm_xlp5xx_rev(XLP_REVISION_ANY)
 
+#define is_nlm_xlp5xx_lite() is_nlm_xlp5xx_L(XLP_REVISION_ANY)
+
 #define IS_NLM_XLP9XX_FAMILY   (is_nlm_xlp9xx() || is_nlm_xlp5xx())
 
 #endif /*__XLP_CHIPID_MACROS__ */
-- 
1.7.1

