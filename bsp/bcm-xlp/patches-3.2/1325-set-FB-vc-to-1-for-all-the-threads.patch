From b3e1f4abe263c9958c08c6884721cfdd71486a4a Mon Sep 17 00:00:00 2001
From: Jayanthi Annadurai <jayanthia@netlogicmicro.com>
Date: Wed, 30 Mar 2011 10:37:27 -0700
Subject: set FB vc to 1 for all the threads

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/drivers/net/ethernet/broadcom/nae/net_common.h b/drivers/net/ethernet/broadcom/nae/net_common.h
index 2850556..0d0e8e8 100644
--- a/drivers/net/ethernet/broadcom/nae/net_common.h
+++ b/drivers/net/ethernet/broadcom/nae/net_common.h
@@ -11,7 +11,7 @@
 #define FAIL                    -1
 #define CPU0_VC                 0
 
-#define CPU_Q_ID(cpu, vid) ((cpu & 0xfc) | (vid) )
+#define CPU_Q_ID(cpu, vid) (cpu)
 
 #define MAX_DEST_QID            50
 
diff --git a/drivers/net/ethernet/broadcom/nae/xlp_nae.c b/drivers/net/ethernet/broadcom/nae/xlp_nae.c
index 0063e13..e14ae73 100755
--- a/drivers/net/ethernet/broadcom/nae/xlp_nae.c
+++ b/drivers/net/ethernet/broadcom/nae/xlp_nae.c
@@ -611,7 +611,7 @@ static int nlm_xlp_nae_start_xmit(struct sk_buff *skb, struct net_device *dev)
 		return -1;
 	}
 
-	msg.entry[0] = nae_tx_desc(P2D_NEOP, 0, CPU_Q_ID(cpu, nae_fb_vc), 0, virt_to_bus(skb));
+	msg.entry[0] = nae_tx_desc(P2D_NEOP, 0, cpu, 0, virt_to_bus(skb));
 	msg.entry[1] = nae_tx_desc(P2D_EOP,
 				   0,
 				   NULL_VFBID,
-- 
1.7.1

