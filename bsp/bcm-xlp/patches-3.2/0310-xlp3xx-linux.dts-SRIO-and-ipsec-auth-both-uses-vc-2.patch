From 5b6bdcd242063772f02c7b425f99d791238f93ac Mon Sep 17 00:00:00 2001
From: reshmic <reshmic@broadcom.com>
Date: Tue, 15 May 2012 16:06:19 +0530
Subject: xlp3xx-linux.dts : SRIO and ipsec auth both uses vc 2

SRIO and ipsec auth cannot coexist. ipsec auth is enabled by
default. Change node_X_vc_mask to 0xffffffff for SRIO.

for srio 0xbbbbbbbb
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/boot/dts/xlp3xx-linux.dts b/arch/mips/boot/dts/xlp3xx-linux.dts
index 10dc30c..3033cff 100644
--- a/arch/mips/boot/dts/xlp3xx-linux.dts
+++ b/arch/mips/boot/dts/xlp3xx-linux.dts
@@ -34,7 +34,8 @@
 				sae-rx-vc = <0>; /*  */
 				sae-rx-sync-vc  = <3>; /* should be exclusive */
 				ipsec-async-vc  = <3>;
-                                ipsec-sync-vc   = <2>;
+				ipsec-sync-vc   = <2>; /* should be exclusive either  
+							  ipsec-sync-vc  or soc/srio@node-0  */
 
 			};
 			uart {
@@ -47,10 +48,11 @@
 					0x20000000 0xa0000000>;  // 2586M at 512M
 			};
                         fmn {
-                                node_0_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_1_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_2_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_3_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
+				/* make the node mask to 0xffffffff for SRIO */  
+                                node_0_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_1_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_2_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                node_3_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
                         };
 			pic {
 			};
-- 
1.7.1

