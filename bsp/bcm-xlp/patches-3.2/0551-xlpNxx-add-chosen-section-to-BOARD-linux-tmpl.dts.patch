From 6a2b2f76ea2962b86fe18e0eae0ae8d2ae5a0308 Mon Sep 17 00:00:00 2001
From: Tanmay Jagdale <tanmayj@broadcom.com>
Date: Thu, 26 Jun 2014 14:14:01 +0530
Subject: xlpNxx: add chosen section to BOARD-linux-tmpl.dts

Added chosen section to BOARD-linux-tmpl.dts so that linux can be
brought up with this dtb.
The chosen section contains parameters to reserve memory for pktmem
and freein-fifo.
The memory section from this file has been removed since its not used.
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/boot/dts/xlp2xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp2xx-linux-tmpl.dts
index 32cd234..a67c027 100644
--- a/arch/mips/boot/dts/xlp2xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp2xx-linux-tmpl.dts
@@ -9,12 +9,6 @@
 	#address-cells = <2>;
 	#size-cells = <2>;
 
-	memory {
-		device_type = "memory";
-		reg =  <0 0x00100000 0 0x0FF00000	// 255M at 1M
-			0 0x20000000 0 0xa0000000>;	// 2560M at 512M
-	};
-
 	soc {
 		#address-cells = <2>;
 		#size-cells = <1>;
@@ -246,4 +240,10 @@
 			smsc,irq-push-pull;
 		};
 	};
+
+	chosen {
+		bootargs = "console=ttyS0,115200 rdinit=/sbin/init";
+		netlogic,cpumask = <0xff>;
+		netlogic,reserve-mem = <256>;
+	};
 };
diff --git a/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
index b3509b4..6a158f7 100644
--- a/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
@@ -9,13 +9,6 @@
 	#address-cells = <2>;
 	#size-cells = <2>;
 
-	memory {
-		device_type = "memory";
-		reg =  <0 0x00100000 0 0x0FF00000	// 255M at 1M
-			0 0x20000000 0 0xa0000000	// 2560M at 512M
-			0 0xe0000000 0 0x40000000>;
-	};
-
 	soc {
 		#address-cells = <2>;
 		#size-cells = <1>;
@@ -252,4 +245,10 @@
 			compatible = "netlogic,xlp-rio";
 		};
 	};
+
+	chosen {
+		bootargs = "console=ttyS0,115200 rdinit=/sbin/init";
+		netlogic,cpumask = <0xffff>;
+		netlogic,reserve-mem = <256>;
+	};
 };
diff --git a/arch/mips/boot/dts/xlp5xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp5xx-linux-tmpl.dts
index f77ce99..7e52685 100644
--- a/arch/mips/boot/dts/xlp5xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp5xx-linux-tmpl.dts
@@ -9,12 +9,6 @@
 	#address-cells = <2>;
 	#size-cells = <2>;
 
-	memory {
-		device_type = "memory";
-		reg =  <0 0x00100000 0 0x0FF00000	// 255M at 1M
-			0 0x20000000 0 0xa0000000>;	// 2560M at 512M
-	};
-
 	soc {
 		#address-cells = <2>;
 		#size-cells = <1>;
@@ -246,5 +240,8 @@
 
 	chosen {
 		bootargs = "console=ttyS0,115200 rdinit=/sbin/init";
+		netlogic,cpumask = <0xffffffff>;
+		netlogic,reserve-mem = <256>;
+		netlogic,frfifo-mem = <128>;
 	};
 };
diff --git a/arch/mips/boot/dts/xlp8xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp8xx-linux-tmpl.dts
index 58f2bed..c97df91 100644
--- a/arch/mips/boot/dts/xlp8xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp8xx-linux-tmpl.dts
@@ -9,13 +9,6 @@
 	#address-cells = <2>;
 	#size-cells = <2>;
 
-	memory {
-		device_type = "memory";
-		reg =  <0 0x00100000 0 0x0FF00000	// 255M at 1M
-			0 0x20000000 0 0xa0000000	// 2560M at 512M
-			0 0xe0000000 1 0x00000000>;
-	};
-
 	soc {
 		#address-cells = <2>;
 		#size-cells = <1>;
@@ -76,9 +69,9 @@
 			};
 
  			eeprom@57 {
-                                compatible = "xlpge_eeprom";
-                                reg = <0x57>;
-                        };
+				    compatible = "xlpge_eeprom";
+				    reg = <0x57>;
+			   };
 		};
 		pic: pic@4000 {
 			interrupt-controller;
@@ -234,4 +227,11 @@
 			};
 		};
 	};
+
+	chosen {
+		bootargs = "console=ttyS0,115200 rdinit=/sbin/init";
+		netlogic,cpumask = <0xffffffff>;
+		netlogic,reserve-mem = <256>;
+		netlogic,frfifo-mem = <128>;
+	};
 };
diff --git a/arch/mips/boot/dts/xlp9xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp9xx-linux-tmpl.dts
index 996bbb9..c219946 100644
--- a/arch/mips/boot/dts/xlp9xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp9xx-linux-tmpl.dts
@@ -9,12 +9,6 @@
 	#address-cells = <2>;
 	#size-cells = <2>;
 
-	memory {
-		device_type = "memory";
-		reg =  <0 0x00100000 0 0x0FF00000	// 255M at 1M
-			0 0x20000000 0 0xa0000000>;	// 2560M at 512M
-	};
-
 	soc {
 		#address-cells = <2>;
 		#size-cells = <1>;
@@ -233,4 +227,11 @@
 			interrupt-controller;
 		};
 	};
+
+	chosen {
+		bootargs = "console=ttyS0,115200 rdinit=/sbin/init";
+		netlogic,cpumask = <0xffffffff 0xffffffff>;
+		netlogic,reserve-mem = <256>;
+		netlogic,frfifo-mem = <128>;
+	};
 };
-- 
1.7.1

