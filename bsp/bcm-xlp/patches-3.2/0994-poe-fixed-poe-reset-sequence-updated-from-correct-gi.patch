From c79ac2add09cbc04ee6794a7074fd41398c6b992 Mon Sep 17 00:00:00 2001
From: Sreenidhi B R <sreenira@broadcom.com>
Date: Thu, 24 Jul 2014 12:22:55 +0530
Subject: poe: fixed poe reset sequence, updated from correct git branch.

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/netlogic/lib/netlib/include/netsoc_poe.h b/arch/mips/netlogic/lib/netlib/include/netsoc_poe.h
index 7d001b8..2226516 100644
--- a/arch/mips/netlogic/lib/netlib/include/netsoc_poe.h
+++ b/arch/mips/netlogic/lib/netlib/include/netsoc_poe.h
@@ -307,20 +307,20 @@ static inline void __netsoc_reset_poe(poe_t *poe)
         else
                 reset_bit = 10;
 
-	netsoc_api_print(NETSOC_APIDBG_DEFAULT, "%s %d\n",__func__, __LINE__);
 
         /* POE reset in the SYS_RESET register */
         nlm_hal_write_sys_reg(poe->node, SYS_RESET, (1 << reset_bit));
         nlm_mdelay(1);
 
-	netsoc_api_print(NETSOC_APIDBG_DEFAULT, "%s %d\n",__func__, __LINE__);
         nlm_hal_write_sys_reg(poe->node, SYS_RESET, (0 << reset_bit));
         nlm_mdelay(1);
 
 	if (is_nlm_xlp9xx_ax())
 	{
-		netsoc_api_print(NETSOC_APIDBG_DEFAULT, "%s %d\n",__func__, __LINE__);
 		netsoc_write_poe_pcie_reg(poe_pcie_base, POE_RESET, 0x1);
+		nlm_mdelay(1);
+		netsoc_write_poe_pcie_reg(poe_pcie_base, POE_RESET, 0x0);
+		nlm_mdelay(1);
 	}
 
         return;
-- 
1.7.1

