From ba0b3e2d2c5596f79f11b95ab8c9ed55a9c77975 Mon Sep 17 00:00:00 2001
From: Anusha Nelluri <anushan@broadcom.com>
Date: Wed, 9 Jul 2014 17:24:56 +0530
Subject: halx: xlp9xx/5xx adding support for hybrid nae app guest mode

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/boot/dts/xlp5xx-helinux-guest.dts b/arch/mips/boot/dts/xlp5xx-helinux-guest.dts
index 3644d87..4c2d41d 100644
--- a/arch/mips/boot/dts/xlp5xx-helinux-guest.dts
+++ b/arch/mips/boot/dts/xlp5xx-helinux-guest.dts
@@ -44,6 +44,18 @@
 				node_2_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
 				node_3_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
                         };
+            resource-allocation {
+                net@0 {
+                         port-mask = <0x4 0 0 0>;
+                         frinlifo-mask = <0xffff 0 0 0>;
+                         frinlifo-shared-mode = <0 0 0 0>;
+                         vfbid-sw-offset = <0 0 0 0>;
+                         vfbid-sw-entries = <0 0 0 0>;
+                         ucore-mask = <0x1 0 0 0>;
+                         sram-off = <0 0 0 0>;
+                      };
+                };
+
 			dtre {
 				dtre_init_only = <0>;
 			};
@@ -55,18 +67,29 @@
 		dom@1 {
 			device_type = "domain";
 			os = "linux";
-
 			cpu {
 				dtre-rx-vc = <2>;
 			};
 			app-param {
-				onlinemask = <0x1>;
+				onlinemask = <0xffff>;
 			};
+            resource-allocation {
+                 net@0 {
+                          port-mask = <0x3 0 0 0>;
+                          frinlifo-mask = <0xff 0 0 0>;
+                          frinlifo-shared-mode = <0 0 0 0>;
+                          vfbid-sw-offset = <0 0 0 0>;
+                          vfbid-sw-entries = <0 0 0 0>;
+                          ucore-mask = <0x2 0 0 0>;
+                          sram-off = <0 0 0 0>;
+                       };
+               };
+
 		};
 	};
 
 	chosen {
-		netlogic,cpumask = <0x1>;
+		netlogic,cpumask = <0xffff>;
 		bootargs = " console=ttyS0,115200  rhash_entries=1048576";
 		linux,initrd-start=<0x0>;
 		linux,initrd-end=<0x0>;
diff --git a/arch/mips/boot/dts/xlp9xx-helinux-guest.dts b/arch/mips/boot/dts/xlp9xx-helinux-guest.dts
index d9bb2fc..ce170e8 100644
--- a/arch/mips/boot/dts/xlp9xx-helinux-guest.dts
+++ b/arch/mips/boot/dts/xlp9xx-helinux-guest.dts
@@ -50,6 +50,26 @@
 			owner-config {
 				fmn = <0x1>;
 			};
+            resource-allocation {
+                net@0 {
+                          port-mask = <0x4 0 0 0>;
+                          frinlifo-mask = <0xffff 0 0 0>;
+                          frinlifo-shared-mode = <0 0 0 0>;
+                          vfbid-sw-offset = <0 0 0 0>;
+                          vfbid-sw-entries = <0 0 0 0>;
+                          ucore-mask = <0x1 0 0 0>;
+                          sram-off = <0 0 0 0>;
+                      };
+                net@1 {
+                          port-mask = <0x4 0 0 0>;
+                          frinlifo-mask = <0xffff 0 0 0>;
+                          frinlifo-shared-mode = <0 0 0 0>;
+                          vfbid-sw-offset = <0 0 0 0>;
+                          vfbid-sw-entries = <0 0 0 0>;
+                          ucore-mask = <0x1 0 0 0>;
+                          sram-off = <0 0 0 0>;
+                      };
+               };
 		};
 
 		dom@1 {
@@ -63,6 +83,27 @@
 			app-param {
 				onlinemask = <0xffff>;
 			};
+		    resource-allocation {
+		          net@0 {
+		                    port-mask = <0x3 0 0 0>;
+				            frinlifo-mask = <0xff 0 0 0>;
+				            frinlifo-shared-mode = <0 0 0 0>;
+				            vfbid-sw-offset = <0 0 0 0>;
+				            vfbid-sw-entries = <0 0 0 0>;
+				            ucore-mask = <0x2 0 0 0>;
+				            sram-off = <0 0 0 0>;
+				        };
+				 net@1 {
+				            port-mask = <0x3 0 0 0>;
+						    frinlifo-mask = <0xff 0 0 0>;
+					        frinlifo-shared-mode = <0 0 0 0>;
+					        vfbid-sw-offset = <0 0 0 0>;
+					        vfbid-sw-entries = <0 0 0 0>;
+					        ucore-mask = <0x2 0 0 0>;
+					        sram-off = <0 0 0 0>;
+				        };
+			 };
+
 		};
 	};
 
-- 
1.7.1

