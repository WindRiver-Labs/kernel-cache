From 2bd726190682775ce3f0aa81029747210a4693b8 Mon Sep 17 00:00:00 2001
From: Vikas Gupta <vikas.gupta@broadcom.com>
Date: Tue, 14 Oct 2014 12:20:41 +0530
Subject: xlp9xx/5xx: Removed redundant check for XFI in XGMAC block for flow control.

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c b/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
index 3e2f4d8..ab12f6a 100644
--- a/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
+++ b/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
@@ -3000,6 +3000,7 @@ int __netsoc_flow_control_status(nae_t *nae, uint32_t port)
 				return 1;
 			break;
 
+		case XFI_IF:
 		case XAUI_IF:
                 case RXAUI_IF:
                         mac_base = __netsoc_get_xgmac_base(netport);
@@ -3188,11 +3189,9 @@ int __netsoc_config_flow_control(net_port_t *netport, uint32_t enable)
 			}
 
 			if (enable) {
-                                if (netport->iftype != XFI_IF) {
-                                   val = netsoc_read_mac_reg(mac_base, XAUI_CONFIG_1);
-                                   val |= (1<<31) | (1<<29);
-                                   netsoc_write_mac_reg(mac_base, XAUI_CONFIG_1, val);
-                                }
+				val = netsoc_read_mac_reg(mac_base, XAUI_CONFIG_1);
+				val |= (1<<31) | (1<<29);
+				netsoc_write_mac_reg(mac_base, XAUI_CONFIG_1, val);
 
 				val = netsoc_read_mac_reg(mac_base, NETIOR_XGMAC_CTRL1);
 				mask = (1 << NETIOR_XGMAC_TX_PFC_EN_POS) | (1<<NETIOR_XGMAC_RX_PFC_EN_POS) | (1 << NETIOR_XGMAC_TX_PAUSE_POS);
@@ -3214,11 +3213,9 @@ int __netsoc_config_flow_control(net_port_t *netport, uint32_t enable)
 				}
                         }
                         else {
-			        if (netport->iftype != XFI_IF) {
-                                   val = netsoc_read_mac_reg(mac_base, XAUI_CONFIG_1);
-                                   val &= ~((1<<31) | (1<<29));
-                                   netsoc_write_mac_reg(mac_base, XAUI_CONFIG_1, val);
-                                }
+				val = netsoc_read_mac_reg(mac_base, XAUI_CONFIG_1);
+				val &= ~((1<<31) | (1<<29));
+				netsoc_write_mac_reg(mac_base, XAUI_CONFIG_1, val);
 
 				val = netsoc_read_mac_reg(mac_base, NETIOR_XGMAC_CTRL1);
                                 mask = (1 << NETIOR_XGMAC_TX_PFC_EN_POS) | (1<<NETIOR_XGMAC_RX_PFC_EN_POS) | (1 << NETIOR_XGMAC_TX_PAUSE_POS);
-- 
1.7.1

