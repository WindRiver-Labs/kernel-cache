From 87abf84409905e0e247e076c3633d774b56802ab Mon Sep 17 00:00:00 2001
From: Venu Vadapalli <vvadapalli@netlogicmicro.com>
Date: Tue, 3 Aug 2010 23:52:20 -0700
Subject: First attempt at global sysconfig

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/dts/sysconfig.dts b/dts/sysconfig.dts
new file mode 100644
index 0000000..29b4fc5
--- /dev/null
+++ b/dts/sysconfig.dts
@@ -0,0 +1,200 @@
+/* XLP8XX Device Tree Source 
+ *
+ */
+
+/dts-v1/;
+/ {
+	model = "MIPS,XLP8XX";
+	compatible = "NETL,XLP8XX_A0";
+
+	#address-cells = <1>;
+	#size-cells = <1>;
+
+	hypervisor {
+		hypervisor-name = "Xen";
+		cpu_possible_map = <0xff>;
+		is_dom0_hvm = <1>;
+		bootargs = "dom0_loadaddr=0x09000000 dom0_cpumask=0x0f -- ";
+
+		uart {
+			/* Shared ports, not owner */
+			port@0 {};
+		};
+	};
+
+	doms {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		dom@0 {
+			device_type = "domain";
+			os = "linux";
+
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			cpu {
+				onlinemask = <0xf>;
+			};
+
+			uart {
+				/* owner, could be shared - read sharedcfg in sysconfig */
+				port@0 { owner; };
+				port@1 { owner; };
+			};
+
+			memory {
+				reg = <0x04000000 0x0C000000	// 192M at 64M
+					0x20000000 0x20000000>;  // 512M at 512M
+			};
+
+			pic { };
+
+			nae@mode0 {
+				/* Shared ports, not owner */
+				port@0 {};
+				port@1 {};
+				port@2 {};
+				port@3 {};
+			};
+			nae@mode1 {
+				/* owner, could be shared - read sharedcfg in sysconfig */
+				port@0 { owner;	};
+				port@1 { owner;	};
+			};
+		};
+		dom@1 {
+			device_type = "domain";
+			os = "netos";
+
+			heap-size = <0x0 0x4000000>;
+			shared-mem = <0x0 0x80000000 0x0 0x20000000>;
+
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			cpu {
+				onlinemask = <0x10>;
+			};
+			uart {
+				/* Shared ports, not owner */
+				port@0 {};
+				port@1 {};
+			};
+			memory {
+				reg = <0x30000000 0x10000000>;  // 256M @ 768M
+			};
+			nae@mode0 {
+				/* owner, could be shared - read sharedcfg in sysconfig */
+				port@0 { owner;	};
+				port@1 { owner;	};
+				port@2 { owner;	};
+				port@3 { owner;	};
+			};
+			nae@mode1 {
+				/* Shared ports, not owner */
+				port@0 {};
+				port@1 {};
+			};
+		};
+	};
+
+	chosen {
+		bootargs = " xlp_noi2c console=ttyS0,115200 rdinit=/sbin/init";
+	};
+
+	sysconfig {
+
+		uart {
+			port@0 {
+				baud-rate = <115200>;
+				sharedcfg {
+					memory = <0x1F000000 0x00400000>;  // 4M @ 496M
+				};
+			};
+			port@1 {
+				baud-rate = <115200>;
+				sharedcfg {
+					memory = <0x1F400000 0x00400000>;  // 4M @ 500M
+				};
+			};
+		};
+
+		nae@mode0 {
+			#index-cells = <1>;
+			#value-cells = <1>;
+
+                        num-ports = <4>;
+                        start-port-id = <0>;
+                        num-port-regs = <4>;
+			port@0 {
+				sharedcfg { };
+
+	                        regs = <
+        	                        0x35 0xd
+                	                0x1f 0xd
+                        	        0x8a 0xd
+                                	0x8a 0xd
+	                        >;
+			};
+                        port@1 {
+				sharedcfg { };
+
+				regs = <
+	                                0x35 0x35
+        	                        0x1f 0x35
+                	                0x8a 0x35
+                        	        0x8a 0x1f
+	                        >;
+			};
+                        port@2 {
+				sharedcfg { };
+
+				regs = <
+	                                0x35 0x8a
+        	                        0x1f 0x8a
+                	                0x8a 0x8
+                        	        0x8a 0x8
+	                        >;
+			};
+                        port@3 {
+				sharedcfg { };
+
+				regs = <
+	                                0x35 0x14
+        	                        0x1f 0x14
+                	                0x8a 0x14
+                        	        0x8a 0x14
+	                        >;
+			};
+		};
+		nae@mode1 {
+			#index-cells = <1>;
+			#value-cells = <1>;
+
+                        num-ports = <2>;
+                        start-port-id = <0>;
+                        num-port-regs = <2>;
+			port@0 {
+				sharedcfg { };
+
+	                        regs = <
+        	                        0x35 0xd
+                	                0x1f 0xd
+                        	        0x8a 0xd
+                                	0x8a 0xd
+	                        >;
+			};
+                        port@1 {
+				sharedcfg { };
+
+				regs = <
+	                                0x35 0x35
+        	                        0x1f 0x35
+                	                0x8a 0x35
+                        	        0x8a 0x1f
+	                        >;
+			};
+		};
+
+	};
+};
-- 
1.7.1

