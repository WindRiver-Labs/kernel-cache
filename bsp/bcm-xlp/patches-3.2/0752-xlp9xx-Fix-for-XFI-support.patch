From 3d287bbd392b5f4c41feaea9abc659692436099f Mon Sep 17 00:00:00 2001
From: Vikas Gupta <vikas.gupta@broadcom.com>
Date: Wed, 24 Jul 2013 14:36:09 +0530
Subject: xlp9xx: Fix for XFI support.

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c b/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
index 20f4692..215d14c 100644
--- a/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
+++ b/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
@@ -2617,6 +2617,7 @@ void __netsoc_mac_disable(net_port_t *netport)
 			netsoc_api_print(NETSOC_APIDBG_PORT,"%s: GMAC disable NETWK_INF_CTRL_REG 0x%x\n",__func__, netsoc_read_mac_reg(mac_base, NETWK_INF_CTRL_REG));
 			break;
 		case XAUI_IF:
+		case XFI_IF:
 		case RXAUI_IF:
 			mac_base = __netsoc_get_xgmac_base(netport);
 			if(netport->iftype==RXAUI_IF){
@@ -2721,6 +2722,7 @@ void __netsoc_mac_enable(net_port_t *netport)
 			netsoc_api_print(NETSOC_APIDBG_PORT,"%s: GMAC enable NETWK_INF_CTRL_REG 0x%x\n",__func__, netsoc_read_mac_reg(mac_base, NETWK_INF_CTRL_REG));
                         break;
                 case XAUI_IF:
+                case XFI_IF:
                 case RXAUI_IF:
 			//mac_base = netsoc_get_macreg_base_for_xgmac0(nae->mac_base, netport->hw_port_id);
 			mac_base = __netsoc_get_xgmac_base(netport);
@@ -2778,6 +2780,7 @@ int __netsoc_config_frame_size(net_port_t *netport, uint32_t size)
 		        netsoc_write_mac_reg(mac_base, SGMII_MAX_FRAME_LEN, size);
 			break;
 		case XAUI_IF:
+		case XFI_IF:
                 case RXAUI_IF:
 			mac_base = __netsoc_get_xgmac_base(netport);
 			netsoc_write_mac_reg(mac_base, XAUI_MAX_FRAME_LEN , ((size/4) << 16) | size);
@@ -2819,6 +2822,7 @@ int __netsoc_config_flow_control(net_port_t *netport, uint32_t enable)
 			netsoc_api_print(NETSOC_APIDBG_PORT,"%s: GMAC enable %d NETIOR_GMAC_CTRL1 0x%x\n",__func__, enable, netsoc_read_mac_reg(mac_base, NETIOR_GMAC_CTRL1));
 			break;
 		case XAUI_IF:
+		case XFI_IF:
 		case RXAUI_IF:		
 			mac_base = __netsoc_get_xgmac_base(netport);
 			if(netport->iftype==RXAUI_IF){
diff --git a/arch/mips/netlogic/lib/netlib/src/netsoc_pcs.c b/arch/mips/netlogic/lib/netlib/src/netsoc_pcs.c
index 4f0c4ca..0059c98 100644
--- a/arch/mips/netlogic/lib/netlib/src/netsoc_pcs.c
+++ b/arch/mips/netlogic/lib/netlib/src/netsoc_pcs.c
@@ -681,7 +681,7 @@ void xlp9xx_nae_write_pma2p0_mem(uint64_t mac_base, int block, int xgmii_speed,
                 vsemi_cmd &= ~(1<<3);
                 __netsoc_write_vsemi_reg(mac_base, lane_no, 86, vsemi_cmd);
         }
-	// For 40G - Got it from Amar after lab experiment - 6/25/2013
+	
 	if((phy_mode == PHYMODE_XLAUI) || (phy_mode == PHYMODE_XFI)){ 
 		for (lane_no=0; lane_no<max_lanes; lane_no++) {
 			__netsoc_write_vsemi_reg(mac_base, lane_no, 0x15, 0xd9);
-- 
1.7.1

