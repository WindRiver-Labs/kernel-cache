From b3375c03e8480e5af74e8d54f7de11834f88697a Mon Sep 17 00:00:00 2001
From: Virendra Pathak <vpathak@broadcom.com>
Date: Tue, 5 Aug 2014 14:08:10 +0530
Subject: DeviceManager: added device manager(dm) module

 - Also added dm libraries
 - ethtool integration
 - template app to demo the DM APIs
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/drivers/net/ethernet/broadcom/nae/xlpge_init.h b/drivers/net/ethernet/broadcom/nae/xlpge_init.h
index 342f853..5d9dd95 100644
--- a/drivers/net/ethernet/broadcom/nae/xlpge_init.h
+++ b/drivers/net/ethernet/broadcom/nae/xlpge_init.h
@@ -48,5 +48,5 @@ extern int xlpge_eeprom_init(void);
 extern int nlm_per_port_nae_init(nae_t* nae_cfg, int port, int maxnae, char * const,int port_index);
 extern int initialize_nae_per_node(nae_t * nae_cfg, uint32_t *phys_cpu_map,
                                 int mode, int *jumbo_enabled);
-
+extern int xlpge_get_dev_name_by_port_num (int port_num, char *dev_name);
 #endif
diff --git a/drivers/net/ethernet/broadcom/nae/xlpge_nae.c b/drivers/net/ethernet/broadcom/nae/xlpge_nae.c
index 0ba1e28..b1207dc 100644
--- a/drivers/net/ethernet/broadcom/nae/xlpge_nae.c
+++ b/drivers/net/ethernet/broadcom/nae/xlpge_nae.c
@@ -1553,6 +1553,25 @@ int nlm_per_port_nae_init(nae_t* nae_cfg, int port, int num_nae, char * const ma
 	return 0;
 }
 
+/*get the device name corresponding to port_num*/
+int xlpge_get_dev_name_by_port_num (int port_num, char *dev_name)
+{
+
+	struct net_device *dev;
+	struct dev_data *net_dev_info;
+
+	dev = first_net_device (&init_net);
+	while (dev) {	
+		net_dev_info = netdev_priv(dev);
+		if (net_dev_info->port_index == port_num) {
+			memcpy (dev_name, dev->name, IFNAMSIZ);
+			return 0;
+		}
+		dev = next_net_device (dev);
+	}
+	return -1;
+}
+
 int get_num_cpus_per_node(void)
 {
 
@@ -1696,4 +1715,4 @@ void nlm_xlp_nae_init(void)
 	if(IS_NLM_XLP9XX_FAMILY)
 		nae_family_9xx = 1;
 }
-
+EXPORT_SYMBOL (xlpge_get_dev_name_by_port_num);
-- 
1.7.1

