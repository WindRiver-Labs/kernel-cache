From e9d1aed41afb1602855c768b5c119b782b988e85 Mon Sep 17 00:00:00 2001
From: Vikas Gupta <vikas.gupta@broadcom.com>
Date: Fri, 24 May 2013 20:21:14 +0530
Subject: xlp9xx: added nae section is tiny.dts

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/boot/dts/xlp9xx-tiny.dts b/arch/mips/boot/dts/xlp9xx-tiny.dts
index db728e1..6927731 100644
--- a/arch/mips/boot/dts/xlp9xx-tiny.dts
+++ b/arch/mips/boot/dts/xlp9xx-tiny.dts
@@ -45,84 +45,124 @@
 	};
 
 	soc {
-            nae@node-0 {
-                model = "netlogic,XLP-GVP NAE CFG";
-                compatible = "netlogic,xlp";
-                #address-cells = <1>;
-                #size-cells = <1>;
-                frequency = <250>;
-
-                /include/ "ucore.dts"
-
-                // VFBID MAP: Upto 127 entries
-                // (each entry is a pair of (vfbid , dest-vc)
-                // Legal range: (vfbid (0 - 126), dest-vc (0 - 4095))
-                vfbid-config {
-                        vfbid-map = <
-                             0    0    1   1   2   2   3   3
-                        >;
-                };
-
-                // Packet Ordering Engine (POE)
-                poe {
-
-                        mode = "bypass";
-
-                        // Each vector is 512 bit with masb indicating vc 512 and lsb indicating vc 0
-                        // Format : 512-bit-vector is specified as 16 32-bit words
-                        // Left most word has the vc range 511-479 right most word has vc range 31 - 0
-                        // Each word has the MSB select higer vc number and LSB select lower vc num
-                        distribution_vectors {
-                                     dv0  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0x1>;
-                                     dv1  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv2  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv3  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv4  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv5  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv6  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv7  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv8  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv9  = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv10 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv11 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv12 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv13 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv14 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                                     dv15 = <0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0>;
-                        };
-                };
-                complex@4 {
-                        device_type = "nae-complex";
-                        mode = "sgmii";
-
-                        sgmii {
-                                loopback = <0 0>;
-
-                                mgmt-port = <1 0>;
-
-                                // Max ingress fifo size 256 units (size of one unit is 64 byte)
-                                iface-fifo-size = <13 13>;
-
-                                ext-phy-addr = <16 17>;
-                                ext-phy-bus = <0 0>;
-
-                                // Max parser sequence fifo size 1024 packets
-                                // (if 1588 Timestamp is not required, then max size increases to 2048)
-                                num-channels = <1 1>;
-                                parser-sequence-fifo-size = <62 62>;
-
-                                // Since rx_buffer is per context, we can have a few different ways
-                                //  to populate the operand
-                                rx-buffer-size = <128 128>;
-
-
-                                // Max available descriptors are 1024 (across all complexes).
-                                // Per port num_free_descriptors must be even number
-                                num-free-descs = <52 52>;
-                                free-desc-size = <2048 2048>;
-                                ucore-mask = <0xffff 0xffff>;
-                    };
-                };
-            };
+		net@node-0 {
+			compatible = "XLP9XX";
+			version = <1>;
+
+			ale-0 {
+				enable = <0>;
+				cpu-threshold = <32>;
+				nae-threshold = <80>;
+				data-base {
+
+				};
+			};
+
+			nae-0 {
+				frequency = <667>;
+				ale-bypass = <1>;         /* 0 = enable ALE, 1 = bypass ALE */
+
+				/include/ "ucore.dts"
+
+					complex@0 {
+
+						mode = "sgmii"; /* xaui, rxaui, xfi, xlaui , sgmii, interlaken */
+
+						xgmac {                          /* valid when mode = xaui, rxaui or xfi */
+
+							loopback = <0>;             /* loopback = 0 or 1 */
+							num-channels = <1>;         /* num-channels = 1 to 8 */
+							num-free-descs = <150>;     /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
+							free-desc-size = <2048>;    /* descriptor size */
+							higig-mode = <0>;           /* 0=NO_HIGIG, 1=HIGIG, 2=HIGIG2 */
+							xgmii-speed = <10>;         /* 10=10G , 12=12G, 16=16G */
+							vlan-pri-en = <0x0>;        /* VLAN priority enable = 0 or 1 */
+
+							/* rxaui specific params*/                       
+							submode  = <2>;             /* 0:xaui 1:rxaui.xaui 2:rxaui.broadcom 3:rxaui.marvell */
+							scrambler  = <0>;           /* scrambler disable = 0, enable = 1 */
+
+						};
+
+						sgmii {                                      /* valid when mode = sgmii */
+							loopback = <0 0 0 0>;                   /* loopback = 0 or 1 */
+							mgmt-port = <0 0 0 0>;                  /* num-channels = 1 to 8 */
+							ext-phy-addr = <4 7 6 5>;               /* phy address for each port */
+							ext-phy-bus = <1 1 1 1>;                /* phy bus numbers */
+							num-channels = <1 1 1 1>;               /* num-channels = 1 to 8 */
+							num-free-descs = <52 52 52 52>;         /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
+							free-desc-size = <2048 2048 2048 2048>; /* descriptor size */
+						};
+
+						complex@1 {
+
+							mode = "sgmii"; /* xaui, rxaui, xfi, xlaui , sgmii, interlaken */
+
+							xgmac {                          /* valid when mode = xaui, rxaui or xfi */
+								loopback = <0>;             /* loopback = 0 or 1 */
+								num-channels = <1>;         /* num-channels = 1 to 8 */
+								num-free-descs = <150>;     /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
+								free-desc-size = <2048>;    /* descriptor size */
+								higig-mode = <0>;           /* 0=NO_HIGIG, 1=HIGIG, 2=HIGIG2 */
+								xgmii-speed = <10>;         /* 10=10G , 12=12G, 16=16G */
+								vlan-pri-en = <0x0>;        /* VLAN priority enable = 0 or 1 */
+
+								/* rxaui specific params*/
+								submode  = <2>;             /* 0:xaui 1:rxaui.xaui 2:rxaui.broadcom 3:rxaui.marvell */
+								scrambler  = <0>;           /* scrambler disable = 0, enable = 1 */
+
+							};
+
+
+							sgmii {                          /* valid when mode = sgmii */
+								loopback = <0 0 0 0>;                   /* loopback = 0 or 1 */
+								mgmt-port = <0 0 0 0>;                  /* num-channels = 1 to 8 */
+								ext-phy-addr = <4 7 6 5>;               /* phy address for each port */
+								ext-phy-bus = <1 1 1 1>;                /* phy bus numbers */
+								num-channels = <1 1 1 1>;               /* num-channels = 1 to 8 */
+								num-free-descs = <52 52 52 52>;         /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
+								free-desc-size = <2048 2048 2048 2048>; /* descriptor size */
+							};
+
+						};
+
+						complex@2 {
+							mode = "sgmii"; /* sgmii only */
+							sgmii {
+								loopback = <0>;                   /* loopback = 0 or 1 */
+								mgmt-port = <1>;                  /* num-channels = 1 to 8 */
+								ext-phy-addr = <4>;               /* phy address for each port */
+								ext-phy-bus = <1>;                /* phy bus numbers */
+								num-channels = <1>;               /* num-channels = 1 to 8 */
+								num-free-descs = <52>;            /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
+								free-desc-size = <2048>;          /* descriptor size */
+							};
+						};
+					};
+
+				poe-0{
+					distribution-enable = <1>;
+					dist-drop-enable = <0>;                     /* 16 bit mask */
+					class-map-mode = <0>;                       /* 0:All NAE, 1:Class 7-4 reserved for CPU, 2:Class 7-5 reserved for CPU, 3:Class 7-6 reserved for CPU, 4:Class 7 reserved for CPU */
+					class-drop-enable = <0>;                    /* 8 bit mask */
+					drop-timer = <0>;                           /* Drop timer */
+					dest-threshold = <0xa>;                     
+					dist-threshold = <0xa 0xa 0xa 0xa>;         /* Dist threshold group 0..3 */
+					statistics-enable = <0>;                    
+
+					poe-spill-address = <0 0>;  /*  <0xec00000>  */ 
+					poe-spill-length =  <0>;  /*  <0x1000000>  */
+
+					din-spill-address = <0 0>;
+					/*TODO: Need to verify*/
+					din-spill-size = <0x0>;
+
+					distribution {
+						default-thread-sel = <0>;    /* Valid values: Thread Select 0..3 */
+					};
+				};
+
+			};
+		};
 	};
 };
-- 
1.7.1

