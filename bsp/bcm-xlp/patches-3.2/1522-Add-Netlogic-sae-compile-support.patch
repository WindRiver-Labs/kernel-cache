From 29c3bca05de03b55b2331e8643b94a401b60c92f Mon Sep 17 00:00:00 2001
From: Quanyang Wang <quanyang.wang@windriver.com>
Date: Fri, 13 Feb 2015 10:07:16 +0800
Subject: Add Netlogic sae compile support

Add Netlogic sae compile support and the Makefile is picked from
the path "buildroot/output/build/linux-userspace/kmod/sae".

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/drivers/crypto/Kconfig b/drivers/crypto/Kconfig
index dffb855..43d21c9 100644
--- a/drivers/crypto/Kconfig
+++ b/drivers/crypto/Kconfig
@@ -386,4 +386,17 @@ config CRYPTO_DEV_ATMEL_SHA
 	  To compile this driver as a module, choose M here: the module
 	  will be called atmel-sha.
 
+config CRYPTO_DEV_XLP_SAE
+        tristate "Broadcom xlp SAE driver"
+        depends on NLM_XLP_BOARD
+        select CRYPTO_AEAD
+        select CRYPTO_BLKCIPHER
+        select CRYPTO_HASH
+        default m
+        help
+          This driver supports broadcom's Security Acceleration Engine.
+          For more information on xlp SAE driver, please visit
+          <http://support.broadcom.com>
+          To compile this driver as a module, choose M here. The module will be called sae.
+
 endif # CRYPTO_HW
diff --git a/drivers/crypto/Makefile b/drivers/crypto/Makefile
index 38ce13d..5d10c90 100644
--- a/drivers/crypto/Makefile
+++ b/drivers/crypto/Makefile
@@ -21,3 +21,4 @@ obj-$(CONFIG_CRYPTO_DEV_NX) += nx/
 obj-$(CONFIG_CRYPTO_DEV_ATMEL_AES) += atmel-aes.o
 obj-$(CONFIG_CRYPTO_DEV_ATMEL_TDES) += atmel-tdes.o
 obj-$(CONFIG_CRYPTO_DEV_ATMEL_SHA) += atmel-sha.o
+obj-$(CONFIG_CRYPTO_DEV_XLP_SAE)   += sae/
diff --git a/drivers/crypto/sae/Makefile b/drivers/crypto/sae/Makefile
new file mode 100644
index 0000000..c54bc41
--- /dev/null
+++ b/drivers/crypto/sae/Makefile
@@ -0,0 +1,17 @@
+#-I$(SDK_ROOT)/linux-userspace/kmod/sae/
+ccflags-y := -DCONFIG_XLP_FMN_SUPPORT -DNLM_HAL_LINUX_KERNEL -Wno-maybe-uninitialized
+ccflags-y += -Wno-parentheses -Wno-uninitialized
+ccflags-y += -Iarch/mips/netlogic/lib/fdt/libfdt
+ccflags-y += -Iarch/mips/netlogic/lib/fdt/libfdt/contrib
+ccflags-y += -Iarch/mips/netlogic/lib/netlib/include
+ccflags-y += -Iarch/mips/netlogic/lib/fmnlib
+ccflags-y += -Iarch/mips/netlogic/lib/syslib/include
+ccflags-y += -Iarch/mips/netlogic/lib/seclib
+ccflags-y += -Idrivers/netlogic/sae
+
+obj-$(CONFIG_CRYPTO_DEV_XLP_SAE) 	+= sae.o
+sae-objs	= ../../../arch/mips/netlogic/lib/seclib/cryptosoc_lib.o
+sae-objs	+= nlm_enc.o
+sae-objs	+= nlm_crypto.o
+sae-objs	+= nlm_auth.o
+sae-objs	+= nlm_aead.o
-- 
1.7.1

