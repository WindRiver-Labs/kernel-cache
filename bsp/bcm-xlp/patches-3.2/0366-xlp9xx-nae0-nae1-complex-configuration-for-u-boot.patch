From f2e9c337810ecfe2afe39f1888093185fc11da66 Mon Sep 17 00:00:00 2001
From: Vikas Gupta <vikas.gupta@broadcom.com>
Date: Sat, 1 Jun 2013 18:25:36 -0700
Subject: xlp9xx: nae0/nae1 complex configuration for u-boot

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/boot/dts/xlp9xx-tiny.dts b/arch/mips/boot/dts/xlp9xx-tiny.dts
index 6927731..ed3e6ba 100644
--- a/arch/mips/boot/dts/xlp9xx-tiny.dts
+++ b/arch/mips/boot/dts/xlp9xx-tiny.dts
@@ -64,105 +64,104 @@
 
 				/include/ "ucore.dts"
 
-					complex@0 {
-
-						mode = "sgmii"; /* xaui, rxaui, xfi, xlaui , sgmii, interlaken */
-
-						xgmac {                          /* valid when mode = xaui, rxaui or xfi */
-
-							loopback = <0>;             /* loopback = 0 or 1 */
-							num-channels = <1>;         /* num-channels = 1 to 8 */
-							num-free-descs = <150>;     /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
-							free-desc-size = <2048>;    /* descriptor size */
-							higig-mode = <0>;           /* 0=NO_HIGIG, 1=HIGIG, 2=HIGIG2 */
-							xgmii-speed = <10>;         /* 10=10G , 12=12G, 16=16G */
-							vlan-pri-en = <0x0>;        /* VLAN priority enable = 0 or 1 */
-
-							/* rxaui specific params*/                       
-							submode  = <2>;             /* 0:xaui 1:rxaui.xaui 2:rxaui.broadcom 3:rxaui.marvell */
-							scrambler  = <0>;           /* scrambler disable = 0, enable = 1 */
-
-						};
-
-						sgmii {                                      /* valid when mode = sgmii */
-							loopback = <0 0 0 0>;                   /* loopback = 0 or 1 */
-							mgmt-port = <0 0 0 0>;                  /* num-channels = 1 to 8 */
-							ext-phy-addr = <4 7 6 5>;               /* phy address for each port */
-							ext-phy-bus = <1 1 1 1>;                /* phy bus numbers */
-							num-channels = <1 1 1 1>;               /* num-channels = 1 to 8 */
-							num-free-descs = <52 52 52 52>;         /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
-							free-desc-size = <2048 2048 2048 2048>; /* descriptor size */
-						};
-
-						complex@1 {
-
-							mode = "sgmii"; /* xaui, rxaui, xfi, xlaui , sgmii, interlaken */
-
-							xgmac {                          /* valid when mode = xaui, rxaui or xfi */
-								loopback = <0>;             /* loopback = 0 or 1 */
-								num-channels = <1>;         /* num-channels = 1 to 8 */
-								num-free-descs = <150>;     /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
-								free-desc-size = <2048>;    /* descriptor size */
-								higig-mode = <0>;           /* 0=NO_HIGIG, 1=HIGIG, 2=HIGIG2 */
-								xgmii-speed = <10>;         /* 10=10G , 12=12G, 16=16G */
-								vlan-pri-en = <0x0>;        /* VLAN priority enable = 0 or 1 */
-
-								/* rxaui specific params*/
-								submode  = <2>;             /* 0:xaui 1:rxaui.xaui 2:rxaui.broadcom 3:rxaui.marvell */
-								scrambler  = <0>;           /* scrambler disable = 0, enable = 1 */
-
-							};
-
-
-							sgmii {                          /* valid when mode = sgmii */
-								loopback = <0 0 0 0>;                   /* loopback = 0 or 1 */
-								mgmt-port = <0 0 0 0>;                  /* num-channels = 1 to 8 */
-								ext-phy-addr = <4 7 6 5>;               /* phy address for each port */
-								ext-phy-bus = <1 1 1 1>;                /* phy bus numbers */
-								num-channels = <1 1 1 1>;               /* num-channels = 1 to 8 */
-								num-free-descs = <52 52 52 52>;         /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
-								free-desc-size = <2048 2048 2048 2048>; /* descriptor size */
-							};
-
-						};
-
-						complex@2 {
-							mode = "sgmii"; /* sgmii only */
-							sgmii {
-								loopback = <0>;                   /* loopback = 0 or 1 */
-								mgmt-port = <1>;                  /* num-channels = 1 to 8 */
-								ext-phy-addr = <4>;               /* phy address for each port */
-								ext-phy-bus = <1>;                /* phy bus numbers */
-								num-channels = <1>;               /* num-channels = 1 to 8 */
-								num-free-descs = <52>;            /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
-								free-desc-size = <2048>;          /* descriptor size */
-							};
-						};
+		vfbid-config {
+                	vfbid-map = <
+	                     0    0    1   1   2   2   3   3
+        	        >;
+	        };
+
+
+			complex@2 {
+					mode = "sgmii"; /* sgmii only */
+					sgmii {
+						loopback = <0>;                   /* loopback = 0 or 1 */
+						mgmt-port = <1>;                  /* num-channels = 1 to 8 */
+						ext-phy-addr = <0>;               /* phy address for each port */
+						ext-phy-bus = <0>;                /* phy bus numbers */
+						num-channels = <1>;               /* num-channels = 1 to 8 */
+						num-free-descs = <52>;            /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
+						free-desc-size = <2048>;          /* descriptor size */
 					};
+				};
 
-				poe-0{
-					distribution-enable = <1>;
-					dist-drop-enable = <0>;                     /* 16 bit mask */
-					class-map-mode = <0>;                       /* 0:All NAE, 1:Class 7-4 reserved for CPU, 2:Class 7-5 reserved for CPU, 3:Class 7-6 reserved for CPU, 4:Class 7 reserved for CPU */
-					class-drop-enable = <0>;                    /* 8 bit mask */
-					drop-timer = <0>;                           /* Drop timer */
-					dest-threshold = <0xa>;                     
-					dist-threshold = <0xa 0xa 0xa 0xa>;         /* Dist threshold group 0..3 */
-					statistics-enable = <0>;                    
-
-					poe-spill-address = <0 0>;  /*  <0xec00000>  */ 
-					poe-spill-length =  <0>;  /*  <0x1000000>  */
-
-					din-spill-address = <0 0>;
-					/*TODO: Need to verify*/
-					din-spill-size = <0x0>;
-
-					distribution {
-						default-thread-sel = <0>;    /* Valid values: Thread Select 0..3 */
-					};
+
+			};	
+
+
+
+
+	poe-0{
+		distribution-enable = <0>;
+		dist-drop-enable = <0>;                     /* 16 bit mask */
+		class-map-mode = <0>;                       /* 0:All NAE, 1:Class 7-4 reserved for CPU, 2:Class 7-5 reserved for CPU, 3:Class 7-6 reserved for CPU, 4:Class 7 reserved for CPU */
+		class-drop-enable = <0>;                    /* 8 bit mask */
+		drop-timer = <0>;                           /* Drop timer */
+		dest-threshold = <0xa>;                     
+		dist-threshold = <0xa 0xa 0xa 0xa>;         /* Dist threshold group 0..3 */
+		statistics-enable = <0>;                    
+
+		poe-spill-address = <0 0>;  /*  <0xec00000>  */ 
+		poe-spill-length =  <0>;  /*  <0x1000000>  */
+
+		din-spill-address = <0 0>;
+		/*TODO: Need to verify*/
+		din-spill-size = <0x0>;
+
+		distribution {
+			default-thread-sel = <0>;    /* Valid values: Thread Select 0..3 */
+		};
+	};
+	nae-1 {
+		frequency = <667>;
+		ale-bypass = <1>;         /* 0 = enable ALE, 1 = bypass ALE */
+
+		/include/ "ucore.dts"
+		vfbid-config {
+                	vfbid-map = <
+	                     0    0    1   1   2   2   3   3
+        	        >;
+	        };
+
+			complex@0 {
+				mode = "sgmii"; /* sgmii only */
+
+				sgmii {                                      /* valid when mode = sgmii */
+					loopback = <0 0 0 0>;                   /* loopback = 0 or 1 */
+					mgmt-port = <0 0 0 0>;                  /* num-channels = 1 to 8 */
+					ext-phy-addr = <8 9 10 11>;               /* phy address for each port */
+					ext-phy-bus = <0 0 0 0>;                /* phy bus numbers */
+					num-channels = <1 1 1 1>;               /* num-channels = 1 to 8 */
+					num-free-descs = <52 52 52 52>;         /* Number of free descriptors, per port, if free in lifo is not in shared mode*/
+					free-desc-size = <2048 2048 2048 2048>; /* descriptor size */
 				};
 
 			};
+	};	
+
+	poe-1{
+		distribution-enable = <0>;
+		dist-drop-enable = <0>;                     /* 16 bit mask */
+		class-map-mode = <0>;                       /* 0:All NAE, 1:Class 7-4 reserved for CPU, 2:Class 7-5 reserved for CPU, 3:Class 7-6 reserved for CPU, 4:Class 7 reserved for CPU */
+		class-drop-enable = <0>;                    /* 8 bit mask */
+		drop-timer = <0>;                           /* Drop timer */
+		dest-threshold = <0xa>;                     
+		dist-threshold = <0xa 0xa 0xa 0xa>;         /* Dist threshold group 0..3 */
+		statistics-enable = <0>;                    
+
+		poe-spill-address = <0 0>;  /*  <0xec00000>  */ 
+		poe-spill-length =  <0>;  /*  <0x1000000>  */
+
+		din-spill-address = <0 0>;
+		/*TODO: Need to verify*/
+		din-spill-size = <0x0>;
+
+		distribution {
+			default-thread-sel = <0>;    /* Valid values: Thread Select 0..3 */
+		};
+	};
+
+
 		};
 	};
 };
+
-- 
1.7.1

