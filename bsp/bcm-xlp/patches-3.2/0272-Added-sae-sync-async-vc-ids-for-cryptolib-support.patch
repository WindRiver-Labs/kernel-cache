From 6761ce05960c6a0f7a2e1b1b0754b84916edc167 Mon Sep 17 00:00:00 2001
From: Hareesh R <hareesh@netlogicmicro.com>
Date: Wed, 7 Dec 2011 12:06:54 +0530
Subject: Added sae sync/async vc ids for cryptolib support

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/boot/dts/helinux.dts b/arch/mips/boot/dts/helinux.dts
index 1a8380e..e775a5e 100644
--- a/arch/mips/boot/dts/helinux.dts
+++ b/arch/mips/boot/dts/helinux.dts
@@ -83,7 +83,9 @@
                                 nae-rx-vc = <0>;
                                 nae-fb-vc = <3>;
 				sae-rx-vc = <0>; /* sharing with nae */
-				sae-rx-sync-vc = <0xffffffff>; /* -1 nothing left out as kernel using 2 vcs */
+				sae-rx-sync-vc = <0>;  /* sharing with nae */
+				/* helinux, as only 1 thread per cpu, it should poll for both nae and sae 
+				   responses. Also there is no other vc as linux is using other 2 vcs */
                                 /* Setting this to '1' makes NAE driver to skip buf alloction and initial
                                    sending of packet buffers*/
                                 nae-buf-alloc-by-app = <1>; 
diff --git a/arch/mips/boot/dts/linux.dts b/arch/mips/boot/dts/linux.dts
index 1070835..8a98592 100644
--- a/arch/mips/boot/dts/linux.dts
+++ b/arch/mips/boot/dts/linux.dts
@@ -44,10 +44,10 @@
 					0x20000000 0xa0000000>;  // 2586M at 512M
 			};
                         fmn {
-                                node_0_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_1_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_2_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_3_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
+                                node_0_vc_mask = <0x77777777 0x77777777 0x77777777 0x77777777>;
+                                node_1_vc_mask = <0x77777777 0x77777777 0x77777777 0x77777777>;
+                                node_2_vc_mask = <0x77777777 0x77777777 0x77777777 0x77777777>;
+                                node_3_vc_mask = <0x77777777 0x77777777 0x77777777 0x77777777>;
                         };
 			pic {
 			};
diff --git a/arch/mips/boot/dts/storm-linux.dts b/arch/mips/boot/dts/storm-linux.dts
index 8516568..f1e94a7 100644
--- a/arch/mips/boot/dts/storm-linux.dts
+++ b/arch/mips/boot/dts/storm-linux.dts
@@ -31,6 +31,8 @@
                                 nae-rx-vc = <0>;
                                 nae-fb-vc = <1>;
 				napi-vc-mask = <0x3>;
+				sae-rx-vc = <2>; /*  */
+				sae-rx-sync-vc  = <3>; /* should be exclusive */
 			};
 			uart {
 				id = <0>;
@@ -42,11 +44,11 @@
 					0x20000000 0xa0000000>;  // 2586M at 512M
 			};
                         fmn {
-                                node_0_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_1_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_2_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_3_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                        };
+                                node_0_vc_mask = <0x77777777 0x77777777 0x77777777 0x77777777>;
+                                node_1_vc_mask = <0x77777777 0x77777777 0x77777777 0x77777777>;
+                                node_2_vc_mask = <0x77777777 0x77777777 0x77777777 0x77777777>;
+                                node_3_vc_mask = <0x77777777 0x77777777 0x77777777 0x77777777>;
+                       };
 			pic {
 			};
 		};
diff --git a/arch/mips/boot/dts/storm-netos.dts b/arch/mips/boot/dts/storm-netos.dts
index 8354196..3f2652c 100644
--- a/arch/mips/boot/dts/storm-netos.dts
+++ b/arch/mips/boot/dts/storm-netos.dts
@@ -48,6 +48,9 @@
 				onlinemask = <0x1>;
                                 nae-rx-vc = <0>;
                                 nae-fb-vc = <3>;
+				sae-rx-vc = <0>; /* sharing with nae */
+				sae-rx-sync-vc = <2>; /* should be exclusive */
+
 
                                 /* Setting this to '1' makes NAE driver to skip buf alloction and initial
                                    sending of packet buffers*/
-- 
1.7.1

