From adf9a2bc2c57a6686970616f721ef02cf7da6032 Mon Sep 17 00:00:00 2001
From: Abhishek Joshi <abjoshi@broadcom.com>
Date: Fri, 17 Oct 2014 11:12:54 +0530
Subject: nae: fixed port number to device name mapping logic

skip loopback device while looping through device list
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/drivers/net/ethernet/broadcom/nae/xlpge_nae.c b/drivers/net/ethernet/broadcom/nae/xlpge_nae.c
index a2b3904..4dc376e 100644
--- a/drivers/net/ethernet/broadcom/nae/xlpge_nae.c
+++ b/drivers/net/ethernet/broadcom/nae/xlpge_nae.c
@@ -1565,9 +1565,11 @@ int xlpge_get_dev_name_by_port_num (int port_num, char *dev_name)
 	dev = first_net_device (&init_net);
 	while (dev) {	
 		net_dev_info = netdev_priv(dev);
-		if (net_dev_info->port_index == port_num) {
-			memcpy (dev_name, dev->name, IFNAMSIZ);
-			return 0;
+		if (net_dev_info && (dev->flags != IFF_LOOPBACK)) {
+			if (net_dev_info->port_index == port_num) {
+				memcpy (dev_name, dev->name, IFNAMSIZ);
+				return 0;
+			}
 		}
 		dev = next_net_device (dev);
 	}
-- 
1.7.1

