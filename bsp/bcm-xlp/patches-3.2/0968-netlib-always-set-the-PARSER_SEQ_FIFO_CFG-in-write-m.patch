From 56c092c55e9e1de6d031a1ba88982cfc8bb18a27 Mon Sep 17 00:00:00 2001
From: Subhendu Sekhar Behera <sbehera@broadcom.com>
Date: Sun, 11 May 2014 16:25:36 +0530
Subject: netlib: always set the PARSER_SEQ_FIFO_CFG in write mode.

It causes incorrect stats for port 0 on XLP3XX. Probably an
errata.
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c b/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
index a5e2c1d..5a6a908 100644
--- a/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
+++ b/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
@@ -1389,6 +1389,8 @@ void __netsoc_config_parserfifo(nae_t *nae, int hw_port_id, uint32_t start, uint
 	val = netsoc_read_nae_reg(nae->nae_base, PARSER_SEQ_FIFOTH_CFG);
 	netsoc_api_print(NETSOC_APIDBG_CONFIG,"PARSER_SEQ_FIFOTH_CFG xoff %d xon %d \n",
 			((val >> 12) & 0xfff), (val & 0xfff));
+	val = ~(1<<31) | (hw_port_id & 0x1f);
+	netsoc_write_nae_reg(nae->nae_base, PARSER_SEQ_FIFO_CFG, val);
 }
 
 void __netsoc_config_ingress_fifo(nae_t *nae)
-- 
1.7.1

