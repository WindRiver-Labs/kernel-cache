From 0a57d9181ac62edfc55ad0a2143ae0ffff095626 Mon Sep 17 00:00:00 2001
From: Jayanthi A <jayanthi.annadurai@broadcom.com>
Date: Wed, 9 Oct 2013 01:36:34 -0700
Subject: fmnlib: Added api to configure xlp9xx fmn rxq depth

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn.h b/arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn.h
index 3463973..f8987cd 100644
--- a/arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn.h
+++ b/arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn.h
@@ -257,13 +257,42 @@ static __inline__ int fmn_level_int_val(uint64_t outq_config)
 	return xlp_get_field_dw(outq_config, 56, 3);
 }
 
+
+static __inline__ int nlm_hal_enable_rxqdepth(int node, int qid)
+{
+        uint64_t val = 0;
+        if (is_nlm_xlp9xx()) {
+                //*(uint64_t *)(xlp_fmn_base[node] + (1 << 13) + (vc << 3)) = 0x0;
+                val = nlh_read_cfg_reg64(xlp_fmn_base[node] + (qid << 3));
+                val |= (1<<51);
+                nlh_write_cfg_reg64(xlp_fmn_base[node] + (qid << 3), val);
+                return 0;
+        }
+        else
+                return -1;
+}
+
+
+static __inline__ int nlm_hal_disable_rxqdepth(int node, int qid)
+{
+        uint64_t val = 0;
+        if (is_nlm_xlp9xx()) {
+                //*(uint64_t *)(xlp_fmn_base[node] + (1 << 13) + (vc << 3)) = 0x0;
+                val = nlh_read_cfg_reg64(xlp_fmn_base[node] + (qid << 3));
+                val &= ~(1<<51);
+                nlh_write_cfg_reg64(xlp_fmn_base[node] + (qid << 3), val);
+                return 0;
+        }
+        else
+                return -1;
+}
+
 extern int get_dom_fmn_node_ownership(void *fdt, int dom_id);
 extern void nlm_hal_fmn_init(void *fdt, int node);
 extern void nlm_hal_set_fmn_interrupt(int irq);
 
 extern void nlm_hal_disable_vc_intr(int node, int vc);
 extern void nlm_hal_enable_vc_intr(int node, int vc);
-
 #endif /* #ifndef _NLH_FMN_H */
 
 	
-- 
1.7.1

