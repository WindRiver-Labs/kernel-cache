From f5a3dc42df596005361aeebd49f682825e3a1dd8 Mon Sep 17 00:00:00 2001
From: Virendra Pathak <vpathak@broadcom.com>
Date: Wed, 18 Dec 2013 11:19:06 +0530
Subject: guest: added dom@0 & dom@1 for xlp9xx linux guest dts

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/boot/dts/xlp9xx-linux-guest.dts b/arch/mips/boot/dts/xlp9xx-linux-guest.dts
index 5bbc84a..2311695 100644
--- a/arch/mips/boot/dts/xlp9xx-linux-guest.dts
+++ b/arch/mips/boot/dts/xlp9xx-linux-guest.dts
@@ -21,12 +21,66 @@
                 device_type = "pktmem";
 
                 /* format: node number, 64-bit addr, 64-bit size */
-                reg = <0 0x0 0x30000000 0x0 0x0000000
+                reg = <0 0x0 0x30000000 0x0 0x1000000
                        1 0x0 0x0 0x0 0x0
                        2 0x0 0x0 0x0 0x0
                        3 0x0 0x0 0x0 0x0>;
         };
 
+	doms {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		dom@0 {
+			device_type = "domain";
+			os = "linux";
+
+			fmn {
+				node_0_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_1_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_2_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_3_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+                        };
+			dtre {
+				dtre_init_only = <0>;
+			};
+			owner-config {
+				fmn = <0x1>;
+			};
+		};
+		dom@1 {
+			device_type = "domain";
+
+			cpu {   
+                                onlinemask = <0xffff>; 
+                                nae-rx-vc = <2>;
+			};
+
+			resource-allocation {
+				net@0 {
+					port-mask = <0x3 0 0 0>;
+					frinlifo-mask = <0xff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x2 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+				net@1 {
+                                        port-mask = <0 0 0 0>;
+                                        frinlifo-mask = <0 0 0 0>;
+                                        frinlifo-shared-mode = <0 0 0 0>;
+                                        vfbid-sw-offset = <0 0 0 0>;
+                                        vfbid-sw-entries = <0 0 0 0>;
+                                        ucore-mask = <0 0 0 0>;
+                                        sram-off = <0 0 0 0>;
+                                };
+			};
+			app-param{
+                                onlinemask = <0x1>;
+			};
+		};
+	};
+
 	chosen {
 		netlogic,cpumask = <0x1>;
 		bootargs = " console=ttyS0,115200  rhash_entries=1048576";
diff --git a/arch/mips/boot/dts/xlp9xx-linux.dts b/arch/mips/boot/dts/xlp9xx-linux.dts
index d2b2eff..0931a4d 100644
--- a/arch/mips/boot/dts/xlp9xx-linux.dts
+++ b/arch/mips/boot/dts/xlp9xx-linux.dts
@@ -123,7 +123,7 @@
 			device_type = "domain";
 
 			cpu {   
-                                onlinemask = <0xffff>; 
+                                onlinemask = <0x01>; 
                                 nae-rx-vc = <2>;
 			};
 
-- 
1.7.1

