From de88cc9583fef0043061dbc38f8a64c322a5e4c5 Mon Sep 17 00:00:00 2001
From: Manoj Vellala <manojv@broadcom.com>
Date: Sun, 1 Sep 2013 22:39:33 -0700
Subject: seclib: designer freeback encoding for gen1 is no_of_desgnfb -1

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/arch/mips/netlogic/lib/seclib/saesoc_gen1_hal_defs.h b/arch/mips/netlogic/lib/seclib/saesoc_gen1_hal_defs.h
index 933962b..d100a59 100644
--- a/arch/mips/netlogic/lib/seclib/saesoc_gen1_hal_defs.h
+++ b/arch/mips/netlogic/lib/seclib/saesoc_gen1_hal_defs.h
@@ -297,7 +297,7 @@ static inline void saesoc_gen1_dump_fmnentry(_uint64_t entry0, _uint64_t entry1)
 	cryptosoc_print("  %-16lld %-16lld %-16lld %-16lld %-16llx\n",
 			SAESOC_GEN1_GET_BITS(entry0, REG_FB_DEST_ID),
 			SAESOC_GEN1_GET_BITS(entry0, DESIGN_FB_EN),
-			SAESOC_GEN1_GET_BITS(entry0, DESIGN_FB_LEN),
+			SAESOC_GEN1_GET_BITS(entry0, DESIGN_FB_LEN) + 1,
 			SAESOC_GEN1_GET_BITS(entry0, CIPHER_KEY_LEN),
 			(SAESOC_GEN1_GET_BITS(entry0, CTRL_DESC_ADDR) << 
 			 		CRYPTOSOC_CACHELINE_SHIFT));
@@ -903,7 +903,7 @@ static inline _uint64_t  saesoc_gen1_form_fmn_entry0(
 		unsigned int cipher_key_len_in_dw, _uint64_t ctrl_desc_addr)
 {
 	return( SAESOC_GEN1_SET_BITS(reg_fb_dst_id, REG_FB_DEST_ID) |
-		SAESOC_GEN1_SET_BITS(des_fb_len, DESIGN_FB_LEN) | 
+		SAESOC_GEN1_SET_BITS(des_fb_len - 1, DESIGN_FB_LEN) | 
 		SAESOC_GEN1_SET_BITS(des_fb_en, DESIGN_FB_EN) |
 		SAESOC_GEN1_SET_BITS(cipher_key_len_in_dw, CIPHER_KEY_LEN) | 
 		SAESOC_GEN1_SET_BITS(ctrl_desc_addr, CTRL_DESC_ADDR));
-- 
1.7.1

