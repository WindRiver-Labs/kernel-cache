From cbb8f5be2d27daff1eb6c47c8132158b26f29eca Mon Sep 17 00:00:00 2001
From: Pavani Reddy <pavani@broadcom.com>
Date: Tue, 29 Jul 2014 17:57:32 +0530
Subject: soc_interface : Fix node calculation in nlm_enable_vc_intr_9xx

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/drivers/misc/netlogic/soc_interface/on_chip.c b/drivers/misc/netlogic/soc_interface/on_chip.c
index 86341da..6ab44d0 100644
--- a/drivers/misc/netlogic/soc_interface/on_chip.c
+++ b/drivers/misc/netlogic/soc_interface/on_chip.c
@@ -1128,7 +1128,7 @@ void nlm_enable_vc_intr_9xx(void)
         for(cpu=0; cpu < NR_CPUS; cpu++){
                 if(!cpumask_test_cpu(cpu, &phys_cpu_present_map))
                         continue;
-                node = nlm_nodeid();
+		node = cpu_to_node(cpu_number_map(cpu));
                 for(i = 0; i < NLM_MAX_VC_PER_THREAD_9XX; i++) {
 			vc_index = (i + (cpu % NLM_MAX_CPU_PER_NODE_9XX)*NLM_MAX_VC_PER_THREAD_9XX);
                         if(nlm_cpu_vc_mask[cpu] & (1<<i)){
-- 
1.7.1

