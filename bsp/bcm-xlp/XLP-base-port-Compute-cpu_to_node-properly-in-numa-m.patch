From 84a5726e1cc8c7ac10959167468e6e91d66f2fd4 Mon Sep 17 00:00:00 2001
From: Jayanthi A <jayanthi.annadurai@broadcom.com>
Date: Thu, 19 Jul 2012 13:59:27 +0530
Subject: [PATCH 550/761] XLP base port: Compute cpu_to_node properly in numa
 mode

Based on Broadcom SDK 2.3.

Signed-off-by: Jayanthi A <jayanthi.annadurai@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/include/asm/mach-netlogic/topology.h |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/mips/include/asm/mach-netlogic/topology.h b/arch/mips/include/asm/mach-netlogic/topology.h
index 56e66ab..7f4930e 100644
--- a/arch/mips/include/asm/mach-netlogic/topology.h
+++ b/arch/mips/include/asm/mach-netlogic/topology.h
@@ -6,7 +6,7 @@
 #include <asm/mmzone.h>
 
 /* FIXME_XLP: only works for all cpus up */
-#define cpu_to_node(cpu)	(cpu >> 5)
+#define cpu_to_node(cpu)	(__cpu_logical_map[cpu] >> 5)
 #define hardcpu_to_node(cpu)	(cpu >> 5)
 
 #define cpumask_of_node(node)	(NODE_CPU_MASK(node))
-- 
1.7.10.4

