From 347413a393253cf36dd7ccfafb7a4466b85ad684 Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Thu, 14 Oct 2010 20:26:58 -0700
Subject: [PATCH 200/761] Configure LSU (L2HPE)

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/cpu_control.c     |    2 +-
 arch/mips/netlogic/xlp/cpu_control_asm.S |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/mips/netlogic/xlp/cpu_control.c b/arch/mips/netlogic/xlp/cpu_control.c
index 1962f73..942adaf 100644
--- a/arch/mips/netlogic/xlp/cpu_control.c
+++ b/arch/mips/netlogic/xlp/cpu_control.c
@@ -88,7 +88,7 @@ static inline void config_lsu(void)
 		".set noreorder\n"
 		"li      %0, "STR(LSU_DEFEATURE)"\n"
 		"mfcr    %1, %0\n"
-		"lui     %2, 0x4000\n"
+		"lui     %2, 0x4080\n"
 		"or      %1, %1, %2\n"
 		"li	 %2, ~0xe\n"
 		"and	 %1, %1, %2\n"
diff --git a/arch/mips/netlogic/xlp/cpu_control_asm.S b/arch/mips/netlogic/xlp/cpu_control_asm.S
index c7a0bc2..7927fca3 100644
--- a/arch/mips/netlogic/xlp/cpu_control_asm.S
+++ b/arch/mips/netlogic/xlp/cpu_control_asm.S
@@ -73,7 +73,7 @@
 	li      t0, LSU_DEFEATURE
 	mfcr    t1, t0
 
-	lui     t2, 0x4000  # Enable Unaligned Access
+	lui     t2, 0x4080  # Enable Unaligned Access, L2HPE
 	or      t1, t1, t2
 
 	li	t2, ~0xe    # S1RCM
-- 
1.7.10.4

