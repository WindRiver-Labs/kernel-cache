From 6ce349b19fa2b820c3b9700ba1c1d83c5fe9459e Mon Sep 17 00:00:00 2001
From: kopal <kopal@broadcom.com>
Date: Wed, 3 Apr 2013 10:46:56 +0530
Subject: [PATCH 717/762] XMC: i2c fix

XMC uses a different i2c bus.

Based on Broadcom SDK 2.3.

Signed-off-by: kopal <kopal@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/board.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/arch/mips/netlogic/xlp/board.c b/arch/mips/netlogic/xlp/board.c
index 1dc2956..a9fde7b 100644
--- a/arch/mips/netlogic/xlp/board.c
+++ b/arch/mips/netlogic/xlp/board.c
@@ -41,7 +41,12 @@ static struct i2c_board_info xlp_i2c_device_info[] __initdata = {
 
 static int __init xlp_i2c_device_init(void)
 {
+#ifdef CONFIG_NLM_XMC_SUPPORT
+        // XMC uses bus 0 for common devices
+        return i2c_register_board_info(0, xlp_i2c_device_info, ARRAY_SIZE(xlp_i2c_device_info));
+#else
 	return i2c_register_board_info(1, xlp_i2c_device_info, ARRAY_SIZE(xlp_i2c_device_info));
+#endif
 }
 
 arch_initcall(xlp_i2c_device_init);
-- 
1.7.0.4

