From fc62a2f0a0eda7c33cb43ec7c387f610d40df1d5 Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Thu, 29 Sep 2011 15:14:39 -0700
Subject: [PATCH 364/762] Resolve merge conflict: merge, cosmetic cleanup

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/kernel/traps.c |   14 ++++++++------
 1 files changed, 8 insertions(+), 6 deletions(-)

diff --git a/arch/mips/kernel/traps.c b/arch/mips/kernel/traps.c
index 8e6ed97..7ec163e 100644
--- a/arch/mips/kernel/traps.c
+++ b/arch/mips/kernel/traps.c
@@ -262,6 +262,7 @@ static void __show_regs(const struct pt_regs *regs)
 	const int field = 2 * sizeof(unsigned long);
 	unsigned int cause = regs->cp0_cause;
 	int i;
+
 	printk("Cpu %d\n", smp_processor_id());
 
 	/*
@@ -1598,10 +1599,10 @@ void __cpuinit per_cpu_trap_init(void)
 {
 	unsigned int cpu = smp_processor_id();
 	unsigned int status_set = ST0_CU0;
+	unsigned int hwrena = cpu_hwrena_impl_bits;
 #if defined(CONFIG_NLM_XLP) && (CONFIG_64BIT)
         unsigned int pagegrain;
 #endif
-	unsigned int hwrena = cpu_hwrena_impl_bits;
 #ifdef CONFIG_MIPS_MT_SMTC
 	int secondaryTC = 0;
 	int bootTC = (cpu == 0);
@@ -1638,8 +1639,8 @@ void __cpuinit per_cpu_trap_init(void)
 		status_set |= ST0_MX;
 
 #ifdef CONFIG_NLM_ENABLE_COP2
-    /*Enable Cop2 Access*/
-    status_set |= ST0_CU2;
+	/* Enable Cop2 Access */
+	status_set |= ST0_CU2;
 #endif
 
 	change_c0_status(ST0_CU|ST0_MX|ST0_RE|ST0_FR|ST0_BEV|ST0_TS|ST0_KX|ST0_SX|ST0_UX,
@@ -1650,6 +1651,7 @@ void __cpuinit per_cpu_trap_init(void)
 	pagegrain |= PG_ELPA;
 	write_c0_pagegrain(pagegrain);
 #endif
+
 	if (cpu_has_mips_r2)
 		hwrena |= 0x0000000f;
 
@@ -1716,9 +1718,9 @@ void __cpuinit per_cpu_trap_init(void)
 	if (bootTC) {
 #endif /* CONFIG_MIPS_MT_SMTC */
 
-	cpu_cache_init();
-	mmu_init();
-	tlb_init();
+		cpu_cache_init();
+		mmu_init();
+		tlb_init();
 #ifdef CONFIG_MIPS_MT_SMTC
 	} else if (!secondaryTC) {
 		/*
-- 
1.7.0.4

