From ecfd5b82dd6133a64ab532730cbd67e774a238a0 Mon Sep 17 00:00:00 2001
From: Jack Tan <jack.tan@windriver.com>
Date: Fri, 14 Feb 2014 17:26:57 +0800
Subject: [PATCH 26/58] bcm-xlp2: virtualization instruction 'hypcall' fixup

Our toolchain do not support the 'hypcall'. We need to replace it with
the code of the instruction.

Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 arch/mips/include/asm/netlogic/kvm_para.h |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/mips/include/asm/netlogic/kvm_para.h b/arch/mips/include/asm/netlogic/kvm_para.h
index 233615d..38643b5 100644
--- a/arch/mips/include/asm/netlogic/kvm_para.h
+++ b/arch/mips/include/asm/netlogic/kvm_para.h
@@ -47,7 +47,7 @@ static inline int do_hypcall_p1r1(int num, uint64_t param0, uint64_t *ret0)
 	__asm__ __volatile__(
 		"move $2, %2\n"
 		"move $3, %3\n"
-		"hypcall\n"
+		".word 0x42000028\n"		/* hypcall */
 		"move %0, $2\n"
 		"move %1, $3\n"
 		: "=r"(ret), "=r"(result)
-- 
1.7.9.5

