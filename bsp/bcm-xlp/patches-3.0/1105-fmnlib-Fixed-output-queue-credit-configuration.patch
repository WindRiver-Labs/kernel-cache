From c652efb7eeae298f7ea18c48c4d777c8d341e151 Mon Sep 17 00:00:00 2001
From: Jayanthi A <jayanthi.annadurai@broadcom.com>
Date: Thu, 26 Dec 2013 10:32:06 -0800
Subject: [PATCH 105/160] fmnlib: Fixed output queue credit configuration

Signed-off-by: Jack Tan <jack.tan@windriver.com>
Signed-off-by: Jack Tan <jiankemeng@gmail.com>
---
 arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn_config.c |   11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn_config.c b/arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn_config.c
index 340d062..c4f61ad 100644
--- a/arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn_config.c
+++ b/arch/mips/netlogic/lib/fmnlib/nlm_hal_fmn_config.c
@@ -979,11 +979,12 @@ static void nlm_hal_write_fmn_credit(int node, int max_nodes)
 							if ((credits+1) != nlm_node_cfg.fmn_cfg[node]->fmn_default_credits)
 								nlm_print("Overriding credis from source %d qid %d credits %d \n", base_vc, qid, credits);
 #endif
-							nlh_write_cfg_reg64(xlp_fmn_base[node] + (1 << 14),
-								(0ULL << 42) /* type, credit value + 1 */
-								| (credits << 26) /* credit count */
-								| ((qid | (dst_node << 10)) << 13) /* destination */
-								| (base_vc) ); /* source */
+                                                        nlh_write_cfg_reg64(xlp_fmn_base[node] + (1ULL << 14),
+                                                                (0ULL << 42) /* type, credit value + 1 */
+                                                                | ((uint64_t)credits << 26) /* credit count */
+                                                                | ((uint64_t)(qid | (dst_node << 10)) << 13) /* destination */
+                                                                | ((uint64_t)base_vc) ); /* source */
+
 					}
 				}
 			}
-- 
1.7.9.5

