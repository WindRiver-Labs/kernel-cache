From 1bfa9db026487084cba0c32916ca27e0601f55a2 Mon Sep 17 00:00:00 2001
From: Yonghong Song <ysong@broadcom.com>
Date: Mon, 11 Nov 2013 10:18:07 -0800
Subject: [PATCH 076/160] pci: remove virtualization workaround due to qemu
 emulate pcie link as device

  o The issue has been corrected in the latest qemu 1.6.0 porting.

Signed-off-by: Jack Tan <jack.tan@windriver.com>
Signed-off-by: Jack Tan <jiankemeng@gmail.com>
---
 arch/mips/pci/pci-xlp.c |    8 --------
 1 file changed, 8 deletions(-)

diff --git a/arch/mips/pci/pci-xlp.c b/arch/mips/pci/pci-xlp.c
index 00d8690..fdf55ad 100644
--- a/arch/mips/pci/pci-xlp.c
+++ b/arch/mips/pci/pci-xlp.c
@@ -184,14 +184,6 @@ const struct pci_dev *xlp_get_pcie_link(const struct pci_dev *dev)
 	bus = dev->bus;
 
 	if (cpu_is_xlp9xx()) {
-		/* FIXME: currently at qemu we did not enumerate bus yet.
-		 * Rather, we directly assign a device to links.
-		 * The following change should be removed once QEMU
-		 * enumerates bus structure properly.
-		 */
-		if (is_nlm_guest_os && bus->number == 1)
-			return dev;
-
 		/* find bus with grand parent number == 0 */
 		for (p = bus->parent; p && p->parent && p->parent->number != 0;
 				p = p->parent)
-- 
1.7.9.5

