From c94614b40f7378fa13d0eeaade180d536d72f76c Mon Sep 17 00:00:00 2001
From: henry shao <hshao@netlogicmicro.com>
Date: Fri, 28 May 2010 14:48:55 -0700
Subject: [PATCH 048/762] remove xlr_hybrid_setup(), multiple cleanup unused xlr legacy code

Based on Broadcom SDK 2.3.

Signed-off-by: henry shao <hshao@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/setup.c |   20 ++++----------------
 1 files changed, 4 insertions(+), 16 deletions(-)

diff --git a/arch/mips/netlogic/xlp/setup.c b/arch/mips/netlogic/xlp/setup.c
index 89e6c8e..8ea634e 100644
--- a/arch/mips/netlogic/xlp/setup.c
+++ b/arch/mips/netlogic/xlp/setup.c
@@ -162,8 +162,8 @@ EXPORT_SYMBOL(chip_is_xls_b0);
 EXPORT_SYMBOL(chip_is_xls6xx_b0);
 EXPORT_SYMBOL(chip_is_xls4xx_b0);
 
-int xlp_with_mac_driver = 0;
-EXPORT_SYMBOL(xlp_with_mac_driver);
+int xlp_sgmii_ports = 0;
+EXPORT_SYMBOL(xlp_sgmii_ports);
 
 /* Environment Variables
  */
@@ -279,17 +279,8 @@ atomic_t cpus_rebooted = ATOMIC_INIT(0);
 
 static void ptr_linux_exit(void)
 {
-#ifdef CONFIG_NLM_XLP
+	// trigger a chip reset 
 	write_32bit_cfg_reg((uint32_t *)xlp_sys_base, 0x40 | CHIP_RESET, 1);
-#else
-	nlm_reg_t *mmio;
-
-	/* 
-	 * trigger a chip reset 
-	 */	
-	mmio = netlogic_io_mmio(NETLOGIC_IO_GPIO_OFFSET);
-	netlogic_write_reg(mmio, GPIO_SWRESET_REG, 1);
-#endif
 	for ( ; ; ) 
 		cpu_wait();
 }
@@ -629,10 +620,7 @@ void prom_free_prom_memory(void)
 #ifdef CONFIG_EARLY_PRINTK
 static void NS16550_putc(char c)
 {
-	nlm_reg_t *mmio = 
-		netlogic_io_mmio(NETLOGIC_IO_UART_0_OFFSET);
-
-	while (netlogic_read_reg(mmio, 0x5) == 0);
+        nlm_hal_write_32bit_reg(xlp_uart_0_base, 0x0, c);
 	netlogic_write_reg(mmio, 0x0, c);
 }
 
-- 
1.7.0.4

