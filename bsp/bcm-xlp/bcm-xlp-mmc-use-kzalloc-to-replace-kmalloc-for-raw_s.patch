From 6fce5a28328d908fe6ccc9ae6ef45ff4ac9cbf63 Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Thu, 12 Dec 2013 17:52:24 +0800
Subject: [PATCH 3/3] bcm-xlp: mmc: use kzalloc to replace kmalloc for raw_scr

Set memory to zero during allocating raw card SCR data of mmc card.
Else sometimes we got the below error:

	mmc0: unrecognised SCR structure version 12

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/mmc/core/sd_ops.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/mmc/core/sd_ops.c b/drivers/mmc/core/sd_ops.c
index 274ef00..82adbf1 100644
--- a/drivers/mmc/core/sd_ops.c
+++ b/drivers/mmc/core/sd_ops.c
@@ -264,7 +264,7 @@ int mmc_app_send_scr(struct mmc_card *card, u32 *scr)
 	/* dma onto stack is unsafe/nonportable, but callers to this
 	 * routine normally provide temporary on-stack buffers ...
 	 */
-	data_buf = kmalloc(sizeof(card->raw_scr), GFP_KERNEL);
+	data_buf = kzalloc(sizeof(card->raw_scr), GFP_KERNEL);
 	if (data_buf == NULL)
 		return -ENOMEM;
 
-- 
1.7.5.4

