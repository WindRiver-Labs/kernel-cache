From 937e4b1da4d3f93c686c7b0c0862d4b12f489b16 Mon Sep 17 00:00:00 2001
From: reshmic <reshmic@broadcom.com>
Date: Tue, 4 Dec 2012 10:17:48 +0530
Subject: [PATCH 733/761] bcm_xlp: SAE: cyrpto-api: support for CBC-MAC auth
 mode.

Based on Broadcom SDK 2.3.

Signed-off-by: reshmic <reshmic@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/crypto/sae/nlmcrypto.h |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/crypto/sae/nlmcrypto.h b/drivers/crypto/sae/nlmcrypto.h
index f0e50c5..3c204db 100755
--- a/drivers/crypto/sae/nlmcrypto.h
+++ b/drivers/crypto/sae/nlmcrypto.h
@@ -449,6 +449,8 @@ static inline int nlm_crypto_get_taglen(enum nlm_hash_algo hashalg, enum nlm_has
 		return 128;
 	else if (hashmode == NLM_HASH_MODE_CMAC)
 		return 128;
+	else if (hashmode == NLM_HASH_MODE_CBC_MAC)
+		return 128;
 	else if (hashalg ==  NLM_HASH_ZUC)
 		return 32;
 	else if(hashalg == NLM_HASH_BYPASS)
-- 
1.7.10.4

