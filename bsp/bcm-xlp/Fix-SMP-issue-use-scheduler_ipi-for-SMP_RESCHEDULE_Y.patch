From 767b3a47896ec502676de12005308c7d76beecd2 Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Mon, 24 Oct 2011 17:07:01 -0700
Subject: [PATCH 460/761] Fix SMP issue: use scheduler_ipi for
 SMP_RESCHEDULE_YOURSELF

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/common/smp.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/mips/netlogic/common/smp.c b/arch/mips/netlogic/common/smp.c
index 4cae09a..a156871 100644
--- a/arch/mips/netlogic/common/smp.c
+++ b/arch/mips/netlogic/common/smp.c
@@ -157,7 +157,7 @@ void nlm_common_ipi_handler(int irq, struct pt_regs *regs)
 #endif	/* CONFIG_NLMCOMMON_IP_FLOW_AFFINITY */
 	else {
 		/* Announce that we are for reschduling */
-		set_need_resched();
+		scheduler_ipi();
 	}
 	nlm_common_ipi_stats[smp_processor_id()]--;
 }
-- 
1.7.10.4

