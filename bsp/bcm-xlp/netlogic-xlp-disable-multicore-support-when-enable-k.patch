From 6fcc57670ed12732790c9ff09390b4db5c573251 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Thu, 7 Aug 2014 16:27:33 +0800
Subject: [PATCH 3/5] netlogic:xlp:disable multicore support when enable kexec

Disable multicore support when enabled kexec feature on xlp.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 arch/mips/netlogic/common/smp.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/mips/netlogic/common/smp.c b/arch/mips/netlogic/common/smp.c
index 72fda20..6daa617 100644
--- a/arch/mips/netlogic/common/smp.c
+++ b/arch/mips/netlogic/common/smp.c
@@ -455,7 +455,9 @@ int __cpuinit nlm_wakeup_secondary_cpus(void)
 	*reset_data = threadmode;
 
 #ifdef CONFIG_CPU_XLP
+#ifndef CONFIG_KEXEC
 	xlp_wakeup_secondary_cpus();
+#endif
 #else
 	xlr_wakeup_secondary_cpus();
 #endif
-- 
1.7.5.4

