From c38d71d68193c923c929dafe64fb3ab0b4f88670 Mon Sep 17 00:00:00 2001
From: Yongjun Zhang <yongjunz@broadcom.com>
Date: Mon, 14 Jan 2013 16:19:20 -0800
Subject: [PATCH 680/762] fsim: conditionally disable code not supported by fsim

Based on Broadcom SDK 2.3.

Signed-off-by: Yongjun Zhang <yongjunz@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/common/nlm_hal_nae.c           |    6 ++++++
 arch/mips/netlogic/common/nlm_hal_nae_interface.c |    2 ++
 2 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/arch/mips/netlogic/common/nlm_hal_nae.c b/arch/mips/netlogic/common/nlm_hal_nae.c
index 90b3eed..64ac3c2 100644
--- a/arch/mips/netlogic/common/nlm_hal_nae.c
+++ b/arch/mips/netlogic/common/nlm_hal_nae.c
@@ -193,6 +193,7 @@ void set_bit2_pm_fifo (int node, int block, int lane_ctrl)
 
 void xlp2xx_nae_lane_reset_txpll(int node, int block, int lane_ctrl, int mode)
 {
+#if !defined(XLP_SIM) || defined(NLM_BOARD)
 	uint32_t val = 0;
 	NAE_DEBUG("%s: block %d lane_ctrl %x \n",__func__,block,lane_ctrl);
 
@@ -224,6 +225,7 @@ void xlp2xx_nae_lane_reset_txpll(int node, int block, int lane_ctrl, int mode)
 
 
 	NAE_DEBUG("Before register reset de-assertion PMA value=0x%x\n", nlm_hal_read_mac_reg( node, block, PHY, lane_ctrl));
+#endif /* !defined(XLP_SIM) || defined(NLM_BOARD) */
 }
 
 /**
@@ -242,6 +244,7 @@ void xlp2xx_nae_lane_reset_txpll(int node, int block, int lane_ctrl, int mode)
 */
 int xlp3xx_8xxb0_nae_lane_reset_txpll(int node, int block, int lane_ctrl, int mode)
 {
+#if !defined(XLP_SIM) || defined(NLM_BOARD)
 	uint32_t val = 0;
 	int rext_sel = 0;
 	int count=0;
@@ -344,6 +347,7 @@ int xlp3xx_8xxb0_nae_lane_reset_txpll(int node, int block, int lane_ctrl, int mo
 	NAE_DEBUG("Reset PMA for node %d complex %d and lane %d was successful!! \n", node, block, (lane_ctrl-4));
 
 	nlm_print("Reset PLL done @node:%d block:%d lane:%d mode:%d\n", node, block, lane_ctrl, mode);
+#endif /* !defined(XLP_SIM) || defined(NLM_BOARD) */
     return 0;
 }
 
@@ -364,6 +368,7 @@ int xlp3xx_8xxb0_nae_lane_reset_txpll(int node, int block, int lane_ctrl, int mo
 */
 void xlp8xx_ax_nae_lane_reset_txpll(int node, int block, int lane_ctrl, int mode)
 {
+#if !defined(XLP_SIM) || defined(NLM_BOARD)
         uint32_t val = 0, saved_data;
         int rext_sel = 0;
 
@@ -456,6 +461,7 @@ void xlp8xx_ax_nae_lane_reset_txpll(int node, int block, int lane_ctrl, int mode
 	val = nlm_hal_read_mac_reg(node, block, PHY, lane_ctrl);
 	val &= ~( (1 << 29) | (0x7ffff));
 	nlm_hal_write_mac_reg(node, block, PHY, lane_ctrl, (rext_sel | val));
+#endif /* !defined(XLP_SIM) || defined(NLM_BOARD) */
 }
 
 
diff --git a/arch/mips/netlogic/common/nlm_hal_nae_interface.c b/arch/mips/netlogic/common/nlm_hal_nae_interface.c
index 4411e82..5a0466e 100644
--- a/arch/mips/netlogic/common/nlm_hal_nae_interface.c
+++ b/arch/mips/netlogic/common/nlm_hal_nae_interface.c
@@ -679,6 +679,7 @@ void nlm_hal_rxaui_nlp1042c2_init(int port, int rxaui_mode)
 */
 void nlm_hal_xaui_pcs_init(int node, nlm_nae_config_ptr nae_cfg)
 {
+#if !defined(XLP_SIM) || defined(NLM_BOARD)
 	/*TODO: include vsemi programming here for HIGIG */
 	int block, lane_ctrl, lane_status, vsemi_config=0;
 	int cplx_lane_enable = LM_XAUI | (LM_XAUI << 4) | (LM_XAUI << 8) | (LM_XAUI << 12);
@@ -851,6 +852,7 @@ void nlm_hal_xaui_pcs_init(int node, nlm_nae_config_ptr nae_cfg)
         nlm_xaui_phy_scan();
 #endif /*CONFIG_N511*/
 
+#endif /* !defined(XLP_SIM) || defined(NLM_BOARD) */
 }
 /*XAUI port initialization */
 /**
-- 
1.7.0.4

