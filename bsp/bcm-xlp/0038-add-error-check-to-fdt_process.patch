From 2986201e1357aa97f85476d50b00b39b3cd15c51 Mon Sep 17 00:00:00 2001
From: henry shao <hshao@netlogicmicro.com>
Date: Mon, 31 May 2010 10:44:45 -0700
Subject: [PATCH 038/762] add error check to fdt_process

Based on Broadcom SDK 2.3.

Signed-off-by: henry shao <hshao@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/setup.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/mips/netlogic/xlp/setup.c b/arch/mips/netlogic/xlp/setup.c
index 80f83d3..83483a2 100644
--- a/arch/mips/netlogic/xlp/setup.c
+++ b/arch/mips/netlogic/xlp/setup.c
@@ -502,6 +502,8 @@ static int fdt_process(void)
 	void *blob = (void *)fw_arg0;
 	void *node;
 
+	if(!blob)
+		return -1;
 	/* Create a region starting from
 	 * (_end + 64K) of size 8MB for
 	 * the FDT structures. The 64K is
@@ -513,6 +515,8 @@ static int fdt_process(void)
 	/* Create a local copy of the FDT 
 	 */
 	fdt = fdt_init(blob);
+	if(!fdt)
+		return -1;
 
 	/* extract cmdline params
 	 */
-- 
1.7.0.4

