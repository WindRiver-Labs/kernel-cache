From e6df245122d16031158e7cde60878b7a17a40ffc Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Mon, 9 Jan 2012 18:25:43 -0800
Subject: [PATCH 323/565] XLR: cleanup, purge redundant code

XLR: cleanup, purge redundant code

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/include/asm/netlogic/interrupt.h | 87 ++++++++++++++----------------
 arch/mips/include/asm/netlogic/iomap.h     | 12 +----
 arch/mips/include/asm/netlogic/pic.h       | 12 +----
 3 files changed, 42 insertions(+), 69 deletions(-)

diff --git a/arch/mips/include/asm/netlogic/interrupt.h b/arch/mips/include/asm/netlogic/interrupt.h
index 5fa0d53..1bc085d 100644
--- a/arch/mips/include/asm/netlogic/interrupt.h
+++ b/arch/mips/include/asm/netlogic/interrupt.h
@@ -1,60 +1,51 @@
-/***********************************************************************
-Copyright 2003-2010 Netlogic Microsystems (“Netlogic”). All rights
-reserved.
-Redistribution and use in source and binary forms, with or without
-modification, are permitted provided that the following conditions are
-met:
-1. Redistributions of source code must retain the above copyright
-notice, this list of conditions and the following disclaimer.
-2. Redistributions in binary form must reproduce the above copyright
-notice, this list of conditions and the following disclaimer in
-the documentation and/or other materials provided with the
-distribution.
-THIS SOFTWARE IS PROVIDED BY Netlogic Microsystems ``AS IS'' AND
-ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
-IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
-PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL NETLOGIC OR CONTRIBUTORS BE LIABLE
-FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
-CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
-SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
-INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
-CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
-ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
-THE POSSIBILITY OF SUCH DAMAGE.
-*****************************#NETL_2#********************************/
+/*
+ * Copyright 2003-2011 NetLogic Microsystems, Inc. (NetLogic). All rights
+ * reserved.
+ *
+ * This software is available to you under a choice of one of two
+ * licenses.  You may choose to be licensed under the terms of the GNU
+ * General Public License (GPL) Version 2, available from the file
+ * COPYING in the main directory of this source tree, or the NetLogic
+ * license below:
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ *
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in
+ *    the documentation and/or other materials provided with the
+ *    distribution.
+ *
+ * THIS SOFTWARE IS PROVIDED BY NETLOGIC ``AS IS'' AND ANY EXPRESS OR
+ * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED. IN NO EVENT SHALL NETLOGIC OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
+ * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
+ * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
+ * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
+ * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN
+ * IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ */
 
 #ifndef _ASM_NLM_INTERRUPT_H
 #define _ASM_NLM_INTERRUPT_H
 
 #ifdef CONFIG_NLM_XLP
 #include <asm/netlogic/xlp_irq.h>
-#else
-#include <asm/netlogic/pic.h>
+#else /* CONFIG_NLM_XLP */
 
 /* Defines for the IRQ numbers */
-#define NR_IRQS			256
-#define IRQ_DUMMY_UART           2
-#define IRQ_IPI_SMP_FUNCTION     3
-#define IRQ_IPI_SMP_RESCHEDULE   4
-#define IRQ_REMOTE_DEBUG         5
-#define IRQ_MSGRING              6
-#define IRQ_TIMER                7
-#define IRQ_IPI_SMP_KGDB   		50
-#define IRQ_IPI_OPROFILE        51
 
-#define IRQ_IPI_CRF_MGMT_IPI	NLM_MANAGEMENT_IPI /* */
-#define IRQ_IPI_CRF_EVENTQ_IPI  NLM_EVENTQ_IPI
+#define IRQ_IPI_SMP_FUNCTION	3
+#define IRQ_IPI_SMP_RESCHEDULE	4
+#define IRQ_MSGRING		6
+#define IRQ_TIMER		7
 
-#ifdef CONFIG_NLMCOMMON_IP_FLOW_AFFINITY
-
-#define IRQ_IPI_NETRX           49
-#define SMP_NETRX_IPI           32
-
-#endif /* CONFIG_NLMCOMMON_IP_FLOW_AFFINITY */
-
-
-#define SMP_CALL_KGDB_HOOK 	8
-#define SMP_OPROFILE_IPI        16
-#endif		// CONFIG_NLM_XLP
+#endif /* CONFIG_NLM_XLP */
 
 #endif
diff --git a/arch/mips/include/asm/netlogic/iomap.h b/arch/mips/include/asm/netlogic/iomap.h
index 8cb2610..772dac1 100644
--- a/arch/mips/include/asm/netlogic/iomap.h
+++ b/arch/mips/include/asm/netlogic/iomap.h
@@ -26,17 +26,7 @@ THE POSSIBILITY OF SUCH DAMAGE.
 #ifndef _ASM_RFI_IO_H
 #define _ASM_RFI_IO_H
 
-#if defined(CONFIG_NLM_XLR)
-#define DEFAULT_NETLOGIC_IO_BASE 0xffffffffbef00000ULL
-#define NETLOGIC_IO_DDR2_CHN0_OFFSET       0x01000
-#define NETLOGIC_IO_DDR2_CHN1_OFFSET       0x02000
-#define NETLOGIC_IO_DDR2_CHN2_OFFSET       0x03000
-#define NETLOGIC_IO_DDR2_CHN3_OFFSET       0x04000
-#define NETLOGIC_IO_PIC_OFFSET             0x08000
-#define NETLOGIC_IO_UART_0_OFFSET          0x14000
-#define NETLOGIC_IO_UART_1_OFFSET          0x15100
-
-#else
+#ifdef CONFIG_NLM_XLP
 #define DEFAULT_NETLOGIC_IO_BASE 0xffffffffb8000000ULL
 #define NETLOGIC_IO_DDR2_CHN0_OFFSET       0x14000
 #define NETLOGIC_IO_DDR2_CHN1_OFFSET       0x15000
diff --git a/arch/mips/include/asm/netlogic/pic.h b/arch/mips/include/asm/netlogic/pic.h
index 177ec80..76a42f3 100644
--- a/arch/mips/include/asm/netlogic/pic.h
+++ b/arch/mips/include/asm/netlogic/pic.h
@@ -26,6 +26,8 @@ THE POSSIBILITY OF SUCH DAMAGE.
 #ifndef _ASM_NLM_PIC_H
 #define _ASM_NLM_PIC_H
 
+#if defined(CONFIG_NLM_XLP)
+
 #include <asm/netlogic/iomap.h>
 
 #ifndef __ASSEMBLY__
@@ -41,21 +43,11 @@ struct pic_tmask {
 
 #endif
 
-#if defined(CONFIG_NLM_XLP)
-
 // can't do floating in the kernel, so use 64 as an approximation 
 #define PIC_CLKS_PER_SEC 133333333ULL
 #define PIC_CLKS_PER_USEC 133	//(PIC_CLKS_PER_SEC / 1000000)
 #define PIC_CLKS_PER_TIMER_TICK (PIC_CLKS_PER_SEC / HZ)
 
-#else
-// can't do floating in the kernel, so use 64 as an approximation 
-#define PIC_CLKS_PER_SEC 66666666ULL
-#define PIC_CLKS_PER_USEC 66	//(PIC_CLKS_PER_SEC / 1000000)
-#define PIC_CLKS_PER_TIMER_TICK (PIC_CLKS_PER_SEC / HZ)
-
-#include <asm/netlogic/xlr_pic.h>
-#include <asm/netlogic/hal/nlm_hal_pic.h>
 #endif /* CONFIG_NLM_XLP */
 
 #endif /* #ifndef _ASM_NLM_PIC_H */
-- 
1.8.4.93.g57e4c17

