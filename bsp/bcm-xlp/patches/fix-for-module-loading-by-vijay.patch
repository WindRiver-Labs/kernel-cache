From bd1cf82d981ae59d75fd7cdbfa4fc681c0234dfe Mon Sep 17 00:00:00 2001
From: henry shao <hshao@netlogicmicro.com>
Date: Wed, 30 Jun 2010 16:43:18 -0700
Subject: [PATCH 057/565] fix for module loading by vijay

Fix for module loading by vijay.

Based on Broadcom SDK 2.3.

Signed-off-by: henry shao <hshao@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/mmu.c | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/arch/mips/netlogic/xlp/mmu.c b/arch/mips/netlogic/xlp/mmu.c
index 98a1b9f..9312ca1 100644
--- a/arch/mips/netlogic/xlp/mmu.c
+++ b/arch/mips/netlogic/xlp/mmu.c
@@ -152,10 +152,9 @@ void pgwalker_init(void)
 
 		get_cpu_var(pgd_bases)[VMALLOC_SEG] = (unsigned long) swapper_pg_dir;
 
-#ifdef XLP_MERGE_TODO
 #ifdef MODULE_START
-		__get_cpu_var(pgd_bases)[MODULE_SEG] = (unsigned long) module_pg_dir;
-#endif
+		__get_cpu_var(pgd_bases)[MODULE_SEG] = (unsigned long)
+                    swapper_pg_dir;
 #endif
 		put_cpu_var(pgd_bases);
 
-- 
1.8.4.93.g57e4c17

