From 4d17bffcd6523befc13cfad53c768267b96521fa Mon Sep 17 00:00:00 2001
From: reshmic <reshmic@broadcom.com>
Date: Mon, 3 Dec 2012 15:20:08 +0530
Subject: [PATCH 525/565] bcm_xlp: SAE: drivers/crypto/sae :

program the frequency of sae with the value given in fdt.

Based on Broadcom SDK 2.3.

Signed-off-by: reshmic <reshmic@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/crypto/sae/nlm_crypto.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/drivers/crypto/sae/nlm_crypto.c b/drivers/crypto/sae/nlm_crypto.c
index ff659a8..afb8ff6 100644
--- a/drivers/crypto/sae/nlm_crypto.c
+++ b/drivers/crypto/sae/nlm_crypto.c
@@ -708,10 +708,23 @@ nlm_crypto_init(void)
 
 static void  init_sae(void)
 {
+	extern void *fdt;
+	int freq;
+	int node;
+
+	freq = nlm_hal_get_fdt_freq(fdt, NLM_SAE);
+
+	for_each_node(node) {
+
+		nlm_hal_set_sae_freq(node, freq);
+		nlm_hal_set_sae_engine_sel(node);
+	}
+
 	if( is_nlm_xlp2xx())
 		chip_feature = (ZUC | DES3_KEY_SWAP); 
 	else
 		chip_feature = 0x0;
+
 }
 
     static int __init
-- 
1.8.4.93.g57e4c17

