From ff7477f7300563c58d05c37c2d4cf54ee32004f9 Mon Sep 17 00:00:00 2001
From: Om Narasimhan <onarasimhan@netlogicmicro.com>
Date: Tue, 12 Oct 2010 17:29:54 -0700
Subject: [PATCH 171/565] XLP PCI bringup fixes

XLP PCI bringup fixes

Based on Broadcom SDK 2.3.

Signed-off-by: Om Narasimhan <onarasimhan@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/pci/pci-xlp.c | 2 +-
 include/linux/pci_ids.h | 2 ++
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/arch/mips/pci/pci-xlp.c b/arch/mips/pci/pci-xlp.c
index 89d53eb..e21387c 100644
--- a/arch/mips/pci/pci-xlp.c
+++ b/arch/mips/pci/pci-xlp.c
@@ -164,7 +164,7 @@ struct pci_controller xlp_controller = {
 
 int __init pcibios_map_irq(const struct pci_dev *dev, u8 slot, u8 pin)
 {
-	return 0;
+	return slot + 43;
 }
 
 /* Do platform specific device initialization at pci_enable_device() time */
diff --git a/include/linux/pci_ids.h b/include/linux/pci_ids.h
index c129162..a85fba5 100644
--- a/include/linux/pci_ids.h
+++ b/include/linux/pci_ids.h
@@ -2358,6 +2358,8 @@
 #define PCI_VENDOR_ID_SITECOM		0x182d
 #define PCI_DEVICE_ID_SITECOM_DC105V2	0x3069
 
+#define PCI_VENDOR_ID_NETLOGIC		0x184E
+
 #define PCI_VENDOR_ID_TOPSPIN		0x1867
 
 #define PCI_VENDOR_ID_COMMTECH		0x18f7
-- 
1.8.4.93.g57e4c17

