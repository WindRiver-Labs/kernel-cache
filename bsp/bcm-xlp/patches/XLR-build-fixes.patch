From 1868a737fd27b84eb0c76335a58616f892ae1114 Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Tue, 19 Oct 2010 21:40:01 -0700
Subject: [PATCH 166/565] XLR build fixes

XLR build fixes.

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/include/asm/netlogic/mips-exts.h | 5 +++++
 arch/mips/mm/cerr-nlm.c                    | 2 +-
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/arch/mips/include/asm/netlogic/mips-exts.h b/arch/mips/include/asm/netlogic/mips-exts.h
index 247d6dd..e618ee1 100644
--- a/arch/mips/include/asm/netlogic/mips-exts.h
+++ b/arch/mips/include/asm/netlogic/mips-exts.h
@@ -266,6 +266,11 @@ static __inline__ int hard_smp_processor_id(void)
 	return cpu;
 }
 
+static __inline__ int netlogic_cpu_id(void)
+{
+	return hard_smp_processor_id() >> 2;
+}
+
 static __inline__ int netlogic_thr_id(void)
 {
 	return hard_smp_processor_id() & 0x03;
diff --git a/arch/mips/mm/cerr-nlm.c b/arch/mips/mm/cerr-nlm.c
index 744fda5..9ee643d 100644
--- a/arch/mips/mm/cerr-nlm.c
+++ b/arch/mips/mm/cerr-nlm.c
@@ -127,7 +127,7 @@ static void print_cerr_info(void)
 	cerr_printk("Bridge: The devices reporting AERR are:\n");
 	tmp = netlogic_read_reg(mmio, 41);
 	for(i = 0; i < 16; i++) {
-		if (tmp & (1<<i)) xlr_cerr_printk("\t%s\n", bridge_aerr_intr_devstat[i]);
+		if (tmp & (1<<i)) cerr_printk("\t%s\n", bridge_aerr_intr_devstat[i]);
 	}
 
 	cerr_cpu_log = read_64bit_nlm_ctrl_reg(CPU_BLOCKID_LSU, LSU_CERRLOG_REGID);
-- 
1.8.4.93.g57e4c17

