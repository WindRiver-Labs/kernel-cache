From 4fadb05af441ce92e14b4d0711abaab27816af18 Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Thu, 29 Sep 2011 15:06:02 -0700
Subject: [PATCH 357/762] Resolve merge conflict: pick linux-3.0-stable

deprecate CONFIG_PERFCTR

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/kernel/process.c |   21 +--------------------
 1 files changed, 1 insertions(+), 20 deletions(-)

diff --git a/arch/mips/kernel/process.c b/arch/mips/kernel/process.c
index 029b4d3..d8ad904 100644
--- a/arch/mips/kernel/process.c
+++ b/arch/mips/kernel/process.c
@@ -1,10 +1,3 @@
-/***********************************************************************
-Copyright 2003-2010 Netlogic Microsystems Inc. (“Netlogic”).
-This is a derived work from software originally provided by the external
-entity identified below. The licensing terms and warranties specified in
-the header of the original work apply to this derived work.
-
-*****************************#NETL_1#********************************/
 /*
  * This file is subject to the terms and conditions of the GNU General Public
  * License.  See the file "COPYING" in the main directory of this archive
@@ -30,7 +23,6 @@ the header of the original work apply to this derived work.
 #include <linux/user.h>
 #include <linux/init.h>
 #include <linux/completion.h>
-#include <linux/perfctr.h>
 #include <linux/kallsyms.h>
 #include <linux/random.h>
 #include <trace/sched.h>
@@ -115,11 +107,6 @@ void start_thread(struct pt_regs * regs, unsigned long pc, unsigned long sp)
 
 void exit_thread(void)
 {
-	#ifdef CONFIG_PERFCTR
-	struct task_struct *tsk = current;
-
-	perfctr_exit_thread(&tsk->thread);
-	#endif
 }
 
 void flush_thread(void)
@@ -132,8 +119,8 @@ int copy_thread(unsigned long clone_flags, unsigned long usp,
 	struct thread_info *ti = task_thread_info(p);
 	struct pt_regs *childregs;
 	unsigned long childksp;
-
 	p->set_child_tid = p->clear_child_tid = NULL;
+
 	childksp = (unsigned long)task_stack_page(p) + THREAD_SIZE - 32;
 
 	preempt_disable();
@@ -189,11 +176,6 @@ int copy_thread(unsigned long clone_flags, unsigned long usp,
 	if (clone_flags & CLONE_SETTLS)
 		ti->tp_value = regs->regs[7];
 
-#ifdef CONFIG_PERFCTR
-	perfctr_copy_task(p, regs);
-#endif
-
-
 	return 0;
 }
 
@@ -222,7 +204,6 @@ void elf_dump_regs(elf_greg_t *gp, struct pt_regs *regs)
 	gp[EF_CP0_BADVADDR] = regs->cp0_badvaddr;
 	gp[EF_CP0_STATUS] = regs->cp0_status;
 	gp[EF_CP0_CAUSE] = regs->cp0_cause;
-
 #ifdef EF_UNUSED0
 	gp[EF_UNUSED0] = 0;
 #endif
-- 
1.7.0.4

