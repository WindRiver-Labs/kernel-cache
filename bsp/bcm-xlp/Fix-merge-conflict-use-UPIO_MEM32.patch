From 7fe1e02a87f5aa55ad13910bfff9e6b4be86fbb5 Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Mon, 10 Oct 2011 13:53:52 -0700
Subject: [PATCH 445/761] Fix merge conflict: use UPIO_MEM32

deprecated custom/legacy UPIO_NLM

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/platform.c |    2 +-
 arch/mips/netlogic/xlp/setup.c    |    2 +-
 arch/mips/netlogic/xlr/setup.c    |    2 +-
 include/linux/serial_core.h       |    1 -
 4 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/arch/mips/netlogic/xlp/platform.c b/arch/mips/netlogic/xlp/platform.c
index 231fc7d..c19e09d 100644
--- a/arch/mips/netlogic/xlp/platform.c
+++ b/arch/mips/netlogic/xlp/platform.c
@@ -98,7 +98,7 @@ static void xlp_init_uart(int port_id)
         xlp_uart_port[port_id].irq           = XLP_UART_IRQ(port_id);
 
         xlp_uart_port[port_id].uartclk       = UART_CLK;
-        xlp_uart_port[port_id].iotype        = UPIO_NLM;
+        xlp_uart_port[port_id].iotype        = UPIO_MEM32;
         xlp_uart_port[port_id].flags         = UPF_SKIP_TEST|UPF_FIXED_TYPE|UPF_BOOT_AUTOCONF;
         xlp_uart_port[port_id].type          = PORT_16550A;
         xlp_uart_port[port_id].regshift      = 2;
diff --git a/arch/mips/netlogic/xlp/setup.c b/arch/mips/netlogic/xlp/setup.c
index bbcb530..f8d786b 100644
--- a/arch/mips/netlogic/xlp/setup.c
+++ b/arch/mips/netlogic/xlp/setup.c
@@ -377,7 +377,7 @@ static void __init nlm_early_serial_setup(int uart_id)
 
 	memset(&s, 0, sizeof(s));
 	s.flags = ASYNC_BOOT_AUTOCONF | ASYNC_SKIP_TEST;
-	s.iotype = UPIO_NLM;
+	s.iotype = UPIO_MEM32;
 	s.regshift = 2; /* registers are 4 bytes wide */
 	/* hardware int 4 - the serial int, is CPU int 6
 	 but poll for now */
diff --git a/arch/mips/netlogic/xlr/setup.c b/arch/mips/netlogic/xlr/setup.c
index e50e3fa..18a74c9 100644
--- a/arch/mips/netlogic/xlr/setup.c
+++ b/arch/mips/netlogic/xlr/setup.c
@@ -915,7 +915,7 @@ static void nlm_early_serial_setup(void)
 
 	s.flags = ASYNC_BOOT_AUTOCONF | ASYNC_SKIP_TEST;
 	/* XLP_MERGE_TODO */
-	s.iotype = UPIO_NLM;
+	s.iotype = UPIO_MEM32;
 	/* registers are 4 bytes wide */
 	s.regshift = 2;
 	/* hardware int 4 - the serial int, is CPU int 6
diff --git a/include/linux/serial_core.h b/include/linux/serial_core.h
index 9d2bd01..d16d300 100644
--- a/include/linux/serial_core.h
+++ b/include/linux/serial_core.h
@@ -286,7 +286,6 @@ struct uart_port {
 #define UPIO_DWAPB		(6)			/* DesignWare APB UART */
 #define UPIO_RM9000		(7)			/* RM9000 type IO */
 #define UPIO_DWAPB32		(8)			/* DesignWare APB UART (32 bit accesses) */
-#define UPIO_NLM		(9)			/* Netlogic XLR(S)/XLP */
 
 	unsigned int		read_status_mask;	/* driver specific */
 	unsigned int		ignore_status_mask;	/* driver specific */
-- 
1.7.10.4

