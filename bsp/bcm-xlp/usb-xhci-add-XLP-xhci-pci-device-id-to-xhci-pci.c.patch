From ebf6045f3c1066524f1913375e6da7b200df36b3 Mon Sep 17 00:00:00 2001
From: Shan Hai <shan.hai@windriver.com>
Date: Thu, 22 May 2014 14:20:18 +0800
Subject: [PATCH 3/4] usb/xhci: add XLP xhci pci device id to xhci-pci.c

The default PCI_CLASS_SERIAL_USB_XHCI in xhci-pci.c could not match
XLP2XX xhci controller because the latter lacks class register,
the mismatching causes failure of interrupt handler registration for
the controller subject to the below upstream commit:

commit 00eed9c814 upstream
(USB: xhci: correctly enable interrupts)

So in order to get an interrupt handler to be registered for the
controller add the pci device id to xhci-pci.c.

Signed-off-by: Shan Hai <shan.hai@windriver.com>
---
 drivers/usb/host/xhci-pci.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/usb/host/xhci-pci.c b/drivers/usb/host/xhci-pci.c
index 1419ad9..cd41fa4 100644
--- a/drivers/usb/host/xhci-pci.c
+++ b/drivers/usb/host/xhci-pci.c
@@ -337,6 +337,10 @@ static const struct pci_device_id pci_ids[] = { {
 	/* handle any USB 3.0 xHCI controller */
 	PCI_DEVICE_CLASS(PCI_CLASS_SERIAL_USB_XHCI, ~0),
 	.driver_data =	(unsigned long) &xhci_pci_hc_driver,
+	}, {
+	/* Netlogic XLP2xx processor has no class reg defined */
+	PCI_VDEVICE(NETLOGIC, PCI_DEVICE_ID_NLM_XHCI),
+	.driver_data =  (unsigned long) &xhci_pci_hc_driver,
 	},
 	{ /* end: all zeroes */ }
 };
-- 
1.7.5.4

