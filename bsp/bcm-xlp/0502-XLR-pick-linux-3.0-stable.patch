From 03b863bb1b6667181ec42c8408ced02b2f286a39 Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Mon, 9 Jan 2012 18:06:48 -0800
Subject: [PATCH 502/762] XLR: pick linux-3.0-stable

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 include/linux/mtd/map.h |   34 ----------------------------------
 1 files changed, 0 insertions(+), 34 deletions(-)

diff --git a/include/linux/mtd/map.h b/include/linux/mtd/map.h
index 32b2ea4..3595a02 100644
--- a/include/linux/mtd/map.h
+++ b/include/linux/mtd/map.h
@@ -392,12 +392,6 @@ static inline map_word map_word_ff(struct map_info *map)
 static inline map_word inline_map_read(struct map_info *map, unsigned long ofs)
 {
 	map_word r;
-#ifdef CONFIG_NLM_COMMON
-	unsigned int flags=0;
-	
-	flags = nlm_br_read_lock();
-
-#endif
 
 	if (map_bankwidth_is_1(map))
 		r.x[0] = __raw_readb(map->virt + ofs);
@@ -414,20 +408,11 @@ static inline map_word inline_map_read(struct map_info *map, unsigned long ofs)
 	else
 		BUG();
 
-#ifdef CONFIG_NLM_COMMON
-	nlm_br_read_unlock(flags);
-#endif
 	return r;
 }
 
 static inline void inline_map_write(struct map_info *map, const map_word datum, unsigned long ofs)
 {
-#ifdef CONFIG_NLM_COMMON
-	unsigned int flags=0;
-	
-	flags = nlm_br_write_lock();
-
-#endif
 	if (map_bankwidth_is_1(map))
 		__raw_writeb(datum.x[0], map->virt + ofs);
 	else if (map_bankwidth_is_2(map))
@@ -441,38 +426,19 @@ static inline void inline_map_write(struct map_info *map, const map_word datum,
 	else if (map_bankwidth_is_large(map))
 		memcpy_toio(map->virt+ofs, datum.x, map->bankwidth);
 	mb();
-#ifdef CONFIG_NLM_COMMON
-	nlm_br_write_unlock(flags);
-#endif
 }
 
 static inline void inline_map_copy_from(struct map_info *map, void *to, unsigned long from, ssize_t len)
 {
-#ifdef CONFIG_NLM_COMMON
-	unsigned int flags=0;
-	
-	flags = nlm_br_write_lock();
-#endif
 	if (map->cached)
 		memcpy(to, (char *)map->cached + from, len);
 	else
 		memcpy_fromio(to, map->virt + from, len);
-#ifdef CONFIG_NLM_COMMON
-	nlm_br_write_unlock(flags);
-#endif
 }
 
 static inline void inline_map_copy_to(struct map_info *map, unsigned long to, const void *from, ssize_t len)
 {
-#ifdef CONFIG_NLM_COMMON
-	unsigned int flags=0;
-	
-	flags = nlm_br_write_lock();
-#endif
 	memcpy_toio(map->virt + to, from, len);
-#ifdef CONFIG_NLM_COMMON
-	nlm_br_write_unlock(flags);
-#endif
 }
 
 #ifdef CONFIG_MTD_COMPLEX_MAPPINGS
-- 
1.7.0.4

