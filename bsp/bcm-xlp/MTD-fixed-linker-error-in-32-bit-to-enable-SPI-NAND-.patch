From 3410194730468c99546f38a1ccfcd26a5fa60e9c Mon Sep 17 00:00:00 2001
From: kopal <kopal@broadcom.com>
Date: Thu, 11 Oct 2012 17:06:34 +0530
Subject: [PATCH 610/761] MTD: fixed linker error in 32-bit, to enable SPI
 NAND/NOR

	after enabling SPI NAND/NOR, under mtd devices,for 32-bit
a linker error was observed,fixed by using a macro do_div().

Based on Broadcom SDK 2.3.

Signed-off-by: kopal <kopal@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/mtd/devices/mt29f_spi.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/mtd/devices/mt29f_spi.c b/drivers/mtd/devices/mt29f_spi.c
index 4f476d2..02f019c 100644
--- a/drivers/mtd/devices/mt29f_spi.c
+++ b/drivers/mtd/devices/mt29f_spi.c
@@ -442,7 +442,7 @@ static int mt29f_write(struct mtd_info *mtd, loff_t to, size_t len, size_t *retl
 	ret = 0;
 
 	page_size= snand->params.page_size;
-	col_addr = to % page_size;
+	col_addr = do_div(to,(uint64_t)page_size);
 
 	DEBUG(MTD_DEBUG_LEVEL2,"[%s] to:0x%x len:%d row:0x%x col_addr:0x%x\n", 
 			__func__, (unsigned int)to, (int)len, (unsigned int)(to >> ROW_SHIFT)&0xFFFF, col_addr);
-- 
1.7.10.4

