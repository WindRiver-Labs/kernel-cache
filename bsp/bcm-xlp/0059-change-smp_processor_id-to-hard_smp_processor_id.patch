From af70b58fe3f2f0924c823dd5cc03885a2d2a626b Mon Sep 17 00:00:00 2001
From: henry shao <hshao@netlogicmicro.com>
Date: Wed, 9 Jun 2010 15:22:10 -0700
Subject: [PATCH 059/762] change smp_processor_id to hard_smp_processor_id

Based on Broadcom SDK 2.3.

Signed-off-by: henry shao <hshao@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/time.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/arch/mips/netlogic/xlp/time.c b/arch/mips/netlogic/xlp/time.c
index d4eb942..3253e74 100644
--- a/arch/mips/netlogic/xlp/time.c
+++ b/arch/mips/netlogic/xlp/time.c
@@ -73,7 +73,8 @@ extern void nlm_common_oprofile_int_handler(int irq, void *dev_id,
 #endif
 void nlm_common_timer_interrupt(struct pt_regs *regs, int irq)
 {
-	int cpu = smp_processor_id();
+//	int cpu = smp_processor_id();
+	int cpu = hard_smp_processor_id();
 
 #ifdef CONFIG_NLM_WATCHDOG
         pic_reg_t *mmio = (pic_reg_t *) XLP_IO_PIC_OFFSET;
@@ -181,7 +182,8 @@ static int nlm_timer_proc_read(char *page, char **start, off_t off, int count,
 
 	preempt_disable();
 	len += sprintf(page + len, "cpu = %d, eimr = 0x%016llx, status = 0x%x\n", 
-				   smp_processor_id(), 
+				   /*smp_processor_id(), */
+				   hard_smp_processor_id(), 
                    (unsigned long long)read_64bit_cp0_eimr(), read_c0_status());
 	preempt_enable();
 	*eof = 1;
-- 
1.7.0.4

