From 2ccdf59ff74cd031e58e77b8561a4ba558d2047a Mon Sep 17 00:00:00 2001
From: Shan Hai <shan.hai@windriver.com>
Date: Thu, 22 May 2014 14:09:00 +0800
Subject: [PATCH 1/4] mips/netlogic: follow pci specific coding style

Move PCI specific definitions from architecture specific iomap.h to
include/linux/pci_ids.h.

Modify PCI_VENDOR_NETLOGIC to PCI_VENDOR_ID_NETLOGIC to follow pci
naming rules.

The arch specific iomap.h must be included in the arch agnostic pci code
for referring device ids in the original code, this ends up with kernel
compilation failure on other arches, this patch fixes it.

Signed-off-by: Shan Hai <shan.hai@windriver.com>
---
 arch/mips/include/asm/netlogic/xlp-hal/iomap.h |   28 ------------------------
 arch/mips/netlogic/xlp/ahci_init.c             |    2 +-
 arch/mips/netlogic/xlp/usb-init-xlp2.c         |    2 +-
 arch/mips/netlogic/xlp/usb-init.c              |    8 +++---
 arch/mips/pci/pci-xlp.c                        |    2 +-
 drivers/mmc/host/sdhci-xlp.c                   |    2 +-
 include/linux/pci_ids.h                        |   27 +++++++++++++++++++++++
 7 files changed, 35 insertions(+), 36 deletions(-)

diff --git a/arch/mips/include/asm/netlogic/xlp-hal/iomap.h b/arch/mips/include/asm/netlogic/xlp-hal/iomap.h
index f4bd816..17d7f1c 100644
--- a/arch/mips/include/asm/netlogic/xlp-hal/iomap.h
+++ b/arch/mips/include/asm/netlogic/xlp-hal/iomap.h
@@ -176,34 +176,6 @@
 #define XLP_PCI_UCODEINFO_REG		0x3e
 #define XLP_PCI_SBB_WT_REG		0x3f
 
-/* PCI IDs for SoC device */
-#define	PCI_VENDOR_NETLOGIC		0x184e
-
-#define	PCI_DEVICE_ID_NLM_ROOT		0x1001
-#define	PCI_DEVICE_ID_NLM_ICI		0x1002
-#define	PCI_DEVICE_ID_NLM_PIC		0x1003
-#define	PCI_DEVICE_ID_NLM_PCIE		0x1004
-#define	PCI_DEVICE_ID_NLM_EHCI		0x1007
-#define	PCI_DEVICE_ID_NLM_OHCI		0x1008
-#define	PCI_DEVICE_ID_NLM_NAE		0x1009
-#define	PCI_DEVICE_ID_NLM_POE		0x100A
-#define	PCI_DEVICE_ID_NLM_FMN		0x100B
-#define	PCI_DEVICE_ID_NLM_RAID		0x100D
-#define	PCI_DEVICE_ID_NLM_SAE		0x100D
-#define	PCI_DEVICE_ID_NLM_RSA		0x100E
-#define	PCI_DEVICE_ID_NLM_CMP		0x100F
-#define	PCI_DEVICE_ID_NLM_UART		0x1010
-#define	PCI_DEVICE_ID_NLM_I2C		0x1011
-#define	PCI_DEVICE_ID_NLM_NOR		0x1015
-#define	PCI_DEVICE_ID_NLM_NAND		0x1016
-#define	PCI_DEVICE_ID_NLM_MMC		0x1018
-#define	PCI_DEVICE_ID_NLM_SATA		0x101A
-#define PCI_DEVICE_ID_NLM_XHCI		0x101D
-
-#define	PCI_DEVICE_ID_XLP9XX_MMC	0x9018
-#define	PCI_DEVICE_ID_XLP9XX_SATA	0x901A
-#define	PCI_DEVICE_ID_XLP9XX_XHCI	0x901D
-
 #ifndef __ASSEMBLY__
 
 #define nlm_read_pci_reg(b, r)		nlm_read_reg(b, r)
diff --git a/arch/mips/netlogic/xlp/ahci_init.c b/arch/mips/netlogic/xlp/ahci_init.c
index a271f4d..22ced3f 100644
--- a/arch/mips/netlogic/xlp/ahci_init.c
+++ b/arch/mips/netlogic/xlp/ahci_init.c
@@ -192,5 +192,5 @@ static void nlm_sata_fixup_final(struct pci_dev *dev)
 
 arch_initcall(nlm_ahci_init);
 
-DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_NETLOGIC, PCI_DEVICE_ID_NLM_SATA,
+DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_ID_NETLOGIC, PCI_DEVICE_ID_NLM_SATA,
 		nlm_sata_fixup_final);
diff --git a/arch/mips/netlogic/xlp/usb-init-xlp2.c b/arch/mips/netlogic/xlp/usb-init-xlp2.c
index 447e703..bc8c33e 100644
--- a/arch/mips/netlogic/xlp/usb-init-xlp2.c
+++ b/arch/mips/netlogic/xlp/usb-init-xlp2.c
@@ -276,5 +276,5 @@ static void nlm_xlp2xx_usb_fixup_final(struct pci_dev *dev)
 
 DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_ID_BROADCOM, PCI_DEVICE_ID_XLP9XX_XHCI,
 		nlm_xlp9xx_usb_fixup_final);
-DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_NETLOGIC, PCI_DEVICE_ID_NLM_XHCI,
+DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_ID_NETLOGIC, PCI_DEVICE_ID_NLM_XHCI,
 		nlm_xlp2xx_usb_fixup_final);
diff --git a/arch/mips/netlogic/xlp/usb-init.c b/arch/mips/netlogic/xlp/usb-init.c
index 91368f5..376cc6d 100644
--- a/arch/mips/netlogic/xlp/usb-init.c
+++ b/arch/mips/netlogic/xlp/usb-init.c
@@ -166,9 +166,9 @@ static void nlm_usb_fixup_final(struct pci_dev *dev)
 		dev->irq = nlm_irq_to_xirq(node, irq);
 }
 
-DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_NETLOGIC, PCI_DEVICE_ID_NLM_EHCI,
+DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_ID_NETLOGIC, PCI_DEVICE_ID_NLM_EHCI,
 		nlm_usb_fixup_final);
-DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_NETLOGIC, PCI_DEVICE_ID_NLM_OHCI,
+DECLARE_PCI_FIXUP_FINAL(PCI_VENDOR_ID_NETLOGIC, PCI_DEVICE_ID_NLM_OHCI,
 		nlm_usb_fixup_final);
 
 static void nlm_usb_fixup_early(struct pci_dev *dev)
@@ -177,7 +177,7 @@ static void nlm_usb_fixup_early(struct pci_dev *dev)
 	if (disable_usb)
 		dev->hdr_type = 0x7f;
 }
-DECLARE_PCI_FIXUP_EARLY(PCI_VENDOR_NETLOGIC, PCI_DEVICE_ID_NLM_EHCI,
+DECLARE_PCI_FIXUP_EARLY(PCI_VENDOR_ID_NETLOGIC, PCI_DEVICE_ID_NLM_EHCI,
 		nlm_usb_fixup_early);
-DECLARE_PCI_FIXUP_EARLY(PCI_VENDOR_NETLOGIC, PCI_DEVICE_ID_NLM_OHCI,
+DECLARE_PCI_FIXUP_EARLY(PCI_VENDOR_ID_NETLOGIC, PCI_DEVICE_ID_NLM_OHCI,
 		nlm_usb_fixup_early);
diff --git a/arch/mips/pci/pci-xlp.c b/arch/mips/pci/pci-xlp.c
index 755b310..00d8690 100644
--- a/arch/mips/pci/pci-xlp.c
+++ b/arch/mips/pci/pci-xlp.c
@@ -245,7 +245,7 @@ int pcibios_plat_dev_init(struct pci_dev *dev)
 			break;
 		}
 		break;
-	case PCI_VENDOR_NETLOGIC:
+	case PCI_VENDOR_ID_NETLOGIC:
 		switch (dev->device) {
 		case PCI_DEVICE_ID_NLM_MMC:
 		case PCI_DEVICE_ID_NLM_EHCI:
diff --git a/drivers/mmc/host/sdhci-xlp.c b/drivers/mmc/host/sdhci-xlp.c
index 21644e0..966714a 100644
--- a/drivers/mmc/host/sdhci-xlp.c
+++ b/drivers/mmc/host/sdhci-xlp.c
@@ -55,7 +55,7 @@ struct sdhci_xlp_chip {
 /* Setting XLP device and Vendor IDs */
 static const struct pci_device_id xlp_pci_ids[] = {
 	{
-		.vendor         = PCI_VENDOR_NETLOGIC,
+		.vendor         = PCI_VENDOR_ID_NETLOGIC,
 		.device         = PCI_DEVICE_ID_NLM_MMC,
 		.subvendor      = PCI_ANY_ID,
 		.subdevice      = PCI_ANY_ID,
diff --git a/include/linux/pci_ids.h b/include/linux/pci_ids.h
index cb45b70..054b27e 100644
--- a/include/linux/pci_ids.h
+++ b/include/linux/pci_ids.h
@@ -2964,3 +2964,30 @@
 #define PCI_DEVICE_ID_XEN_PLATFORM	0x0001
 
 #define PCI_VENDOR_ID_OCZ		0x1b85
+
+#define PCI_VENDOR_ID_NETLOGIC		0x184e
+
+#define PCI_DEVICE_ID_NLM_ROOT		0x1001
+#define PCI_DEVICE_ID_NLM_ICI		0x1002
+#define PCI_DEVICE_ID_NLM_PIC		0x1003
+#define PCI_DEVICE_ID_NLM_PCIE		0x1004
+#define PCI_DEVICE_ID_NLM_EHCI		0x1007
+#define PCI_DEVICE_ID_NLM_OHCI		0x1008
+#define PCI_DEVICE_ID_NLM_NAE		0x1009
+#define PCI_DEVICE_ID_NLM_POE		0x100A
+#define PCI_DEVICE_ID_NLM_FMN		0x100B
+#define PCI_DEVICE_ID_NLM_RAID		0x100D
+#define PCI_DEVICE_ID_NLM_SAE		0x100D
+#define PCI_DEVICE_ID_NLM_RSA		0x100E
+#define PCI_DEVICE_ID_NLM_CMP		0x100F
+#define PCI_DEVICE_ID_NLM_UART		0x1010
+#define PCI_DEVICE_ID_NLM_I2C		0x1011
+#define PCI_DEVICE_ID_NLM_NOR		0x1015
+#define PCI_DEVICE_ID_NLM_NAND		0x1016
+#define PCI_DEVICE_ID_NLM_MMC		0x1018
+#define PCI_DEVICE_ID_NLM_SATA		0x101A
+#define PCI_DEVICE_ID_NLM_XHCI		0x101D
+
+#define PCI_DEVICE_ID_XLP9XX_MMC	0x9018
+#define PCI_DEVICE_ID_XLP9XX_SATA	0x901A
+#define PCI_DEVICE_ID_XLP9XX_XHCI	0x901D
-- 
1.7.5.4

