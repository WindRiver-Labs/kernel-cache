From 14309bed43bc075a69a7080bd674b9e8b00bb35c Mon Sep 17 00:00:00 2001
From: Zi Shen Lim <zlim@netlogicmicro.com>
Date: Thu, 29 Sep 2011 15:18:01 -0700
Subject: [PATCH 366/762] Resolve merge conflict: pick linux-3.0-stable

use latest implementation in mainline.

Based on Broadcom SDK 2.3.

Signed-off-by: Zi Shen Lim <zlim@netlogicmicro.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/mm/dma-default.c |    9 ---------
 1 files changed, 0 insertions(+), 9 deletions(-)

diff --git a/arch/mips/mm/dma-default.c b/arch/mips/mm/dma-default.c
index 4c575f4..3fab204 100644
--- a/arch/mips/mm/dma-default.c
+++ b/arch/mips/mm/dma-default.c
@@ -86,11 +86,6 @@ void *dma_alloc_noncoherent(struct device *dev, size_t size,
 
 	gfp = massage_gfp_flags(dev, gfp);
 
-
-#if defined (CONFIG_NLM_COMMON) && defined (CONFIG_64BIT)
-	/* force allocations to happen in DMA zone */
-	gfp |= __GFP_DMA;
-#endif
 	ret = (void *) __get_free_pages(gfp, get_order(size));
 
 	if (ret != NULL) {
@@ -112,10 +107,6 @@ static void *mips_dma_alloc_coherent(struct device *dev, size_t size,
 
 	gfp = massage_gfp_flags(dev, gfp);
 
-#if defined (CONFIG_NLM_COMMON) && defined (CONFIG_64BIT)
-	/* force allocations to happen in DMA zone */
-	gfp |= __GFP_DMA;
-#endif
 	ret = (void *) __get_free_pages(gfp, get_order(size));
 
 	if (ret) {
-- 
1.7.0.4

