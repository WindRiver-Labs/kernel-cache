From cafb9cf808641292f7a015b0ec2a3d704fa57e39 Mon Sep 17 00:00:00 2001
From: Ashok Kumar <ashoks@broadcom.com>
Date: Mon, 4 Mar 2013 14:51:02 +0530
Subject: [PATCH 709/762] time: Disabling SYNC_R4K to aid hrtimer_handler to finish quickly

hrtimer_handler is taking long time when compared to linux-2.6. This
is because in 3.0 the timer tick is happening synchronously(maybe
because synchronise counters is more accurate in 3.0 than on 2.6)
in all cpus and until the time keeping cpu(usually cpu0) is done with
update_wall_time(after taking write_seqlock) all the other cpus are also
waiting in ktime_get->read_seqbegin for it to be over.

This leads to the nae_app performance hit.

Disabling SYNC_R4K to prevent the timer handler getting called
synchronously.

Looks like this issue will be solved in linux-3.8
(http://lwn.net/Articles/539546/)

Based on Broadcom SDK 2.3.

Signed-off-by: Ashok Kumar <ashoks@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/Kconfig |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/mips/Kconfig b/arch/mips/Kconfig
index e6d0ff8..8f40ec3 100644
--- a/arch/mips/Kconfig
+++ b/arch/mips/Kconfig
@@ -780,7 +780,7 @@ config NLM_XLP_EVP_BOARD
         select CSRC_R4K
         select IRQ_CPU
         select ZONE_DMA if 64BIT
-        select SYNC_R4K
+        #select SYNC_R4K
         select SYS_HAS_EARLY_PRINTK
 	select SYS_SUPPORTS_NUMA
 	select SYS_SUPPORTS_ZBOOT
-- 
1.7.0.4

