From 8a4381568b5cd539b9e3d58eaf99f02f200178be Mon Sep 17 00:00:00 2001
From: Om Narasimhan <omn@broadcom.com>
Date: Fri, 19 Oct 2012 15:21:25 -0700
Subject: [PATCH 615/761] PCIe : fix for wrong MSI vector number in the device

Instead of vector number, base_msi was beinig written. Corrected to write
base_msi + bit, which is the vector number.

Based on Broadcom SDK 2.3.

Signed-off-by: Om Narasimhan <omn@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/msi.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/mips/netlogic/xlp/msi.c b/arch/mips/netlogic/xlp/msi.c
index b50574f..b995858 100644
--- a/arch/mips/netlogic/xlp/msi.c
+++ b/arch/mips/netlogic/xlp/msi.c
@@ -157,7 +157,7 @@ int xlp_setup_msi_irq(struct pci_dev *dev, int nvec)
 		if (ret < 0) {
 			goto setup_fail;
 		}
-		write_msi_msg(base_msi, &msg);
+		write_msi_msg(base_msi + bit, &msg);
 		idx++;
 	}
 	ret = xlp_set_ctrl_intmode(nfn.node, nfn.fn, XLP_INTMODE_MSI);
-- 
1.7.10.4

