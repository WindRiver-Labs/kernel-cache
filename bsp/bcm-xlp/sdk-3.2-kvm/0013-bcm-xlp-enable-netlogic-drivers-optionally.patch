From b8ee832567fa64d57178ad7312482f723a707949 Mon Sep 17 00:00:00 2001
From: Nam Ninh <nam.ninh@windriver.com>
Date: Tue, 25 Nov 2014 18:00:10 -0500
Subject: bcm-xlp: enable netlogic drivers optionally.

Introduce a new config option to allow enabling the netlogic
drivers optionally so that we can turn off the drivers that don't work
on the guest.

Signed-off-by: Nam Ninh <nam.ninh@windriver.com>

diff --git a/drivers/misc/Makefile b/drivers/misc/Makefile
index c7388a7..10a08de 100644
--- a/drivers/misc/Makefile
+++ b/drivers/misc/Makefile
@@ -54,4 +54,4 @@ obj-$(CONFIG_VMWARE_VMCI)	+= vmw_vmci/
 obj-$(CONFIG_LATTICE_ECP3_CONFIG)	+= lattice-ecp3-config.o
 obj-$(CONFIG_SRAM)		+= sram.o
 obj-$(CONFIG_HWLAT_DETECTOR)	+= hwlat_detector.o
-obj-$(CONFIG_NLM_XLP_BOARD)     += netlogic/
+obj-$(CONFIG_NETLOGIC_DRIVERS)  += netlogic/
diff --git a/drivers/misc/netlogic/Kconfig b/drivers/misc/netlogic/Kconfig
index aa3913b..add3a63 100644
--- a/drivers/misc/netlogic/Kconfig
+++ b/drivers/misc/netlogic/Kconfig
@@ -1,7 +1,17 @@
 #
 # Netlogic specific driver configuration
 #
-menu "Netlogic specific driver"
+menuconfig NETLOGIC_DRIVERS
+	bool "Netlogic specific driver"
+	---help---
+	  Say Y here to see options for device drivers that support Network
+	  Acceleration engine (NAE), compression/decompression Engine (CDE),
+	  Security Acceleration Engine (SAE), fmn data path, Manage Packet Pool
+	  (PPM) and so on.
+
+	  If you say N, all options in this submenu will be skipped and disabled.
+
+if NETLOGIC_DRIVERS
 
 config XLP_CDE
 	tristate "broadcom xlp CDE driver"
@@ -65,4 +75,4 @@ config NLM_XLP_CRYPTO
 	depends on NLM_XLP_BOARD
 	default n
 
-endmenu
+endif
-- 
1.7.1

