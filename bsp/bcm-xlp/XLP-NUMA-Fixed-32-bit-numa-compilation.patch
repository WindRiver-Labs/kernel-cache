From 4c167534e27773f898370a46c6a97d618dd0ae2a Mon Sep 17 00:00:00 2001
From: Jayanthi A <jayanthi.annadurai@broadcom.com>
Date: Mon, 13 Aug 2012 17:00:19 +0530
Subject: [PATCH 591/761] XLP NUMA: Fixed 32 bit numa compilation

Based on Broadcom SDK 2.3.

Signed-off-by: Jayanthi A <jayanthi.annadurai@broadcom.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/netlogic/xlp/numa.c |    6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/arch/mips/netlogic/xlp/numa.c b/arch/mips/netlogic/xlp/numa.c
index e03ee31..89121e3 100644
--- a/arch/mips/netlogic/xlp/numa.c
+++ b/arch/mips/netlogic/xlp/numa.c
@@ -36,8 +36,12 @@ extern struct xlp_dram_mapping	dram_map[NLM_NODES_MAX_DRAM_REGION];
 extern void nlm_get_dram_mapping(void);
 extern int hcpu_to_lcpu[];
 
-#if defined (CONFIG_64BIT) && defined (CONFIG_MAPPED_KERNEL)
+#ifdef CONFIG_MAPPED_KERNEL
+#ifdef CONFIG_64BIT
 #define _low_virt_to_phys(addr) ((unsigned long)(addr) & ~CKSSEG)
+#else
+#define _low_virt_to_phys(addr) ((unsigned long)(addr) & ~KSEG2)
+#endif
 #endif
 
 static uint8_t _node_map_mem[MAX_NUMNODES][PAGE_SIZE];
-- 
1.7.10.4

