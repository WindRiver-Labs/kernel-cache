From 7ab18e51775f9032d2bc3c3a4170f13678f3fd59 Mon Sep 17 00:00:00 2001
From: Yael Samet <yael.samet@intel.com>
Date: Wed, 25 Jan 2017 07:43:58 +0200
Subject: [PATCH 4677/4706] mei: dal: kdi_create_session should not use
 to_kdi_err

commit f96b6905f8d2dfbde98e945d50b7c906b677ce2b from
git://git.yoctoproject.org/linux-yocto-4.1

kdi_crete_session is not an API function and should not return kdi
errors. The caller function 'dal_create_session' didn't expect
that and translate all kdi_create_session errors to an
'internal error' instead of correct error codes.

Change-Id: I34d0577894eaa1b1a2c553ba4b1228487e13b981
Signed-off-by: Yael Samet <yael.samet@intel.com>
Signed-off-by: Tomas Winkler <tomas.winkler@intel.com>
---
 drivers/misc/mei/dal/dal_kdi.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/misc/mei/dal/dal_kdi.c b/drivers/misc/mei/dal/dal_kdi.c
index e2c2319..8069ffd 100644
--- a/drivers/misc/mei/dal/dal_kdi.c
+++ b/drivers/misc/mei/dal/dal_kdi.c
@@ -262,7 +262,7 @@ static int kdi_create_session(u64 *handle, const char *jta_id,
 	ret = acp_pload_ins_jta(buffer, buffer_length, &pack);
 	if (ret) {
 		pr_err("acp_pload_ins_jta() return %d", ret);
-		return to_kdi_err(ret);
+		return ret;
 	}
 
 	ta_pkg = pack.ta_pack;
@@ -279,7 +279,7 @@ static int kdi_create_session(u64 *handle, const char *jta_id,
 	ret = bhp_open_ta_session(handle, jta_id, ta_pkg, ta_pkg_size,
 				     init_param, init_param_length);
 
-	return to_kdi_err(ret);
+	return ret;
 }
 
 int dal_create_session(u64 *session_handle,  const char *app_id,
-- 
1.7.5.4

