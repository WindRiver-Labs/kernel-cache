From bdc881310c50e69ad1c8402432dd95d5273ceeb8 Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Tue, 29 Mar 2016 18:48:07 +0200
Subject: [PATCH 2082/2508] ALSA: hda - Fix yet another i915 pointer leftover
 in error path

commit 839ea7953407cf1f918e446a080853964ae614fd from
https://github.com/01org/linux-apollolake-i

The hdac_acomp object in hdac_i915.c is left as assigned even after
binding with i915 actually fails, and this leads to the WARN_ON() at
the next load of the module.

Change-Id: I6146a718066d5a23931fa3b832a236b45f445542
Bugzilla: https://bugs.freedesktop.org/show_bug.cgi?id=94736
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/10044
Reviewed-by: Jayanti, Satya Charitardha <satya.charitardha.jayanti@intel.com>
Tested-by: Jayanti, Satya Charitardha <satya.charitardha.jayanti@intel.com>
---
 sound/hda/hdac_i915.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/sound/hda/hdac_i915.c b/sound/hda/hdac_i915.c
index 77548e3..d0da250 100644
--- a/sound/hda/hdac_i915.c
+++ b/sound/hda/hdac_i915.c
@@ -339,7 +339,8 @@ out_master_del:
 out_err:
 	kfree(acomp);
 	bus->audio_component = NULL;
-	dev_err(dev, "failed to add i915 component master (%d)\n", ret);
+	hdac_acomp = NULL;
+	dev_info(dev, "failed to add i915 component master (%d)\n", ret);
 
 	return ret;
 }
-- 
1.7.5.4

