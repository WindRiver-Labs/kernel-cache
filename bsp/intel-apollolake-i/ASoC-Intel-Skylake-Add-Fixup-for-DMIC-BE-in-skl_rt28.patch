From 5b6d48ca97c79f963660b721cc502966b91ee8ac Mon Sep 17 00:00:00 2001
From: "Dharageswari.R" <dharageswari.r@intel.com>
Date: Thu, 27 Aug 2015 21:18:09 +0530
Subject: [PATCH 1710/2508] ASoC: Intel: Skylake: Add Fixup for DMIC BE in
 skl_rt286 machine

commit 3216497579f6055cbcb5866dc7e49d6104edca8c from
https://github.com/01org/linux-apollolake-i

This patch adds fixup for dmic be, set the
channel to stereo.

Signed-off-by: Dharageswari.R <dharageswari.r@intel.com>
Signed-off-by: Jeeja KP <jeeja.kp@intel.com>
---
 sound/soc/intel/boards/skl_rt286.c |   11 +++++++++++
 1 files changed, 11 insertions(+), 0 deletions(-)

diff --git a/sound/soc/intel/boards/skl_rt286.c b/sound/soc/intel/boards/skl_rt286.c
index 6ac0480..b856d12 100644
--- a/sound/soc/intel/boards/skl_rt286.c
+++ b/sound/soc/intel/boards/skl_rt286.c
@@ -141,6 +141,16 @@ static int skylake_rt286_hw_params(struct snd_pcm_substream *substream,
 	return ret;
 }
 
+static int skylake_dmic_fixup(struct snd_soc_pcm_runtime *rtd,
+				struct snd_pcm_hw_params *params)
+{
+	struct snd_interval *channels = hw_param_interval(params,
+						SNDRV_PCM_HW_PARAM_CHANNELS);
+	channels->min = channels->max = 2;
+
+	return 0;
+}
+
 static struct snd_soc_ops skylake_rt286_ops = {
 	.hw_params = skylake_rt286_hw_params,
 };
@@ -236,6 +246,7 @@ static struct snd_soc_dai_link skylake_rt286_dais[] = {
 		.ignore_suspend = 1,
 		.dpcm_capture = 1,
 		.no_pcm = 1,
+		.be_hw_params_fixup = skylake_dmic_fixup,
 	},
 	{
 		.name = "iDisp",
-- 
1.7.5.4

