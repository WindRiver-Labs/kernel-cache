From f46f0c53373ba40f6801c6316b1e0b7ed207d5ac Mon Sep 17 00:00:00 2001
From: "Panwar, Ashish" <ashish.panwar@intel.com>
Date: Fri, 18 Mar 2016 16:02:19 +0530
Subject: [PATCH 1927/2508] ASoC: Intel: Skylake: Add trace buffer dais for
 CNL

commit 2d9424a44348645c4e70034b0dc879c264d97ca1 from
https://github.com/01org/linux-apollolake-i

CNL needs 4 dais for logging, one for each core. Added 2
more dais here. It depends on the machine driver to make
use of appropriate dais based on the hardware platform.

Change-Id: If9df857895b8261cfebd61617542365187499ea1
Signed-off-by: Panwar, Ashish <ashish.panwar@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/8587
Reviewed-by: Shah, Hardik T <hardik.t.shah@intel.com>
Tested-by: Shah, Hardik T <hardik.t.shah@intel.com>
---
 sound/soc/intel/skylake/skl-pcm.c |   26 +++++++++++++++++++++++++-
 1 files changed, 25 insertions(+), 1 deletions(-)

diff --git a/sound/soc/intel/skylake/skl-pcm.c b/sound/soc/intel/skylake/skl-pcm.c
index 80f74ae..45d8a0c0 100644
--- a/sound/soc/intel/skylake/skl-pcm.c
+++ b/sound/soc/intel/skylake/skl-pcm.c
@@ -583,6 +583,10 @@ static int skl_get_compr_core(struct snd_compr_stream *stream)
 		return 0;
 	else if (!strcmp(dai->name, "TraceBuffer1 Pin"))
 		return 1;
+	else if (!strcmp(dai->name, "TraceBuffer2 Pin"))
+		return 2;
+	else if (!strcmp(dai->name, "TraceBuffer3 Pin"))
+		return 3;
 	else
 		return INT_MIN;
 }
@@ -736,7 +740,7 @@ static struct snd_soc_dai_driver skl_platform_dai[] = {
 	.compress_dai = 1,
 	.cops = &skl_trace_compr_ops,
 	.capture = {
-		.stream_name = "TraceBuffer Capture",
+		.stream_name = "TraceBuffer0 Capture",
 		.channels_min = HDA_MONO,
 		.channels_max = HDA_MONO,
 	},
@@ -752,6 +756,26 @@ static struct snd_soc_dai_driver skl_platform_dai[] = {
 	},
 },
 {
+	.name = "TraceBuffer2 Pin",
+	.compress_dai = 1,
+	.cops = &skl_trace_compr_ops,
+	.capture = {
+		.stream_name = "TraceBuffer2 Capture",
+		.channels_min = HDA_MONO,
+		.channels_max = HDA_MONO,
+	},
+},
+{
+	.name = "TraceBuffer3 Pin",
+	.compress_dai = 1,
+	.cops = &skl_trace_compr_ops,
+	.capture = {
+		.stream_name = "TraceBuffer3 Capture",
+		.channels_min = HDA_MONO,
+		.channels_max = HDA_MONO,
+	},
+},
+{
 	.name = "System Pin",
 	.ops = &skl_pcm_dai_ops,
 	.playback = {
-- 
1.7.5.4

