From 721ca0e02316c2cbb496b3d7815bc386e5d8d86a Mon Sep 17 00:00:00 2001
From: Ramesh Babu <ramesh.babu@intel.com>
Date: Mon, 23 Nov 2015 03:12:34 +0530
Subject: [PATCH 1784/2508] ASoC: hda: ext: ops for marking buffers as
 non-cache

commit 7f7a0388137b2502cf6de7b12585fc4331ee8f09 from
https://github.com/01org/linux-apollolake-i

Drivers could choose to mark their pcm buffers as
non-cacheble. Add a callback utility in hdac.

Change-Id: I944af0777521c9f82001b8d2fe81bc72593d0648
Signed-off-by: Ramesh Babu <ramesh.babu@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/7556
---
 include/sound/hdaudio.h      |    2 ++
 sound/hda/ext/hdac_ext_bus.c |    1 +
 2 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/include/sound/hdaudio.h b/include/sound/hdaudio.h
index 4bd92ac..f1f6660 100644
--- a/include/sound/hdaudio.h
+++ b/include/sound/hdaudio.h
@@ -214,6 +214,8 @@ struct hdac_io_ops {
 			       struct snd_dma_buffer *buf);
 	void (*dma_free_pages)(struct hdac_bus *bus,
 			       struct snd_dma_buffer *buf);
+	/* mark memory region as non-cache */
+	void (*mark_pages_uc)(struct snd_dma_buffer *buf, bool enable);
 };
 
 #define HDA_UNSOL_QUEUE_SIZE	64
diff --git a/sound/hda/ext/hdac_ext_bus.c b/sound/hda/ext/hdac_ext_bus.c
index 89a0c3e..122c1b5 100644
--- a/sound/hda/ext/hdac_ext_bus.c
+++ b/sound/hda/ext/hdac_ext_bus.c
@@ -108,6 +108,7 @@ static const struct hdac_io_ops hdac_ext_default_io = {
 	.reg_readb = hdac_ext_readb,
 	.dma_alloc_pages = hdac_ext_dma_alloc_pages,
 	.dma_free_pages = hdac_ext_dma_free_pages,
+	.mark_pages_uc = hdac_ext_mark_pages_uc,
 };
 
 /**
-- 
1.7.5.4

