From b39146a992551ca65cef36391e3c18708ced0dcf Mon Sep 17 00:00:00 2001
From: Matt Roper <matthew.d.roper@intel.com>
Date: Fri, 11 Nov 2016 15:39:07 -0800
Subject: [PATCH 4387/4706] drm/i915/profile: Add profile time storage for HuC
 load

commit 63e4c437d986c8817dcbb9e8a23887e5690a530f from
git://git.yoctoproject.org/linux-yocto-4.1

Signed-off-by: Matt Roper <matthew.d.roper@intel.com>
---
 drivers/gpu/drm/i915/i915_debugfs.c     |    6 ++++--
 drivers/gpu/drm/i915/i915_drv.h         |    3 ++-
 drivers/gpu/drm/i915/intel_guc_loader.c |    2 +-
 3 files changed, 7 insertions(+), 4 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_debugfs.c b/drivers/gpu/drm/i915/i915_debugfs.c
index 9374fb9..4beed9b 100644
--- a/drivers/gpu/drm/i915/i915_debugfs.c
+++ b/drivers/gpu/drm/i915/i915_debugfs.c
@@ -2404,10 +2404,12 @@ static int i915_timing_info(struct seq_file *m, void *data)
 		   (dev_priv->profile.gmbus_init / 1000000));
 	seq_printf(m, "        Modeset init time:                  %4lldms\n",
 		   (dev_priv->profile.modeset_init_2 / 1000000));
+	seq_printf(m, "        HUC firmware init time:             %4lldms\n",
+		   (dev_priv->profile.huc_init / 1000000));
 	seq_printf(m, "        GUC firmware init time:             %4lldms\n",
 		   (dev_priv->profile.guc_init / 1000000));
-	seq_printf(m, "        GUC firmware load time:             %4lldms\n",
-		   (dev_priv->profile.guc_load / 1000000));
+	seq_printf(m, "        GUC/HUC firmware load time:         %4lldms\n",
+		   (dev_priv->profile.guc_huc_load / 1000000));
 	seq_printf(m, "        Global GTT init time:               %4lldms\n",
 		   (dev_priv->profile.gtt_init / 1000000));
 	seq_printf(m, "        Modeset GEM init time:              %4lldms\n",
diff --git a/drivers/gpu/drm/i915/i915_drv.h b/drivers/gpu/drm/i915/i915_drv.h
index 64008a6..6563ef6 100644
--- a/drivers/gpu/drm/i915/i915_drv.h
+++ b/drivers/gpu/drm/i915/i915_drv.h
@@ -1711,8 +1711,9 @@ struct intel_load_profiles {
 	unsigned long long modeset_gem_init;
 	unsigned long long driver_register;
 	unsigned long long fbdev_load;
+	unsigned long long huc_init;
 	unsigned long long guc_init;
-	unsigned long long guc_load;
+	unsigned long long guc_huc_load;
 	unsigned long long csr_load;
 };
 
diff --git a/drivers/gpu/drm/i915/intel_guc_loader.c b/drivers/gpu/drm/i915/intel_guc_loader.c
index 7db1816..6cb5320 100644
--- a/drivers/gpu/drm/i915/intel_guc_loader.c
+++ b/drivers/gpu/drm/i915/intel_guc_loader.c
@@ -535,7 +535,7 @@ int intel_guc_setup(struct drm_device *dev)
 		guc_interrupts_capture(dev_priv);
 	}
 
-	dev_priv->profile.guc_load = sched_clock() - start;
+	dev_priv->profile.guc_huc_load = sched_clock() - start;
 	return 0;
 
 fail:
-- 
1.7.5.4

