From 282dee2290c0f6869617245f7716ecfdb94ee371 Mon Sep 17 00:00:00 2001
From: Jeeja KP <jeeja.kp@intel.com>
Date: Fri, 7 Aug 2015 08:11:47 +0530
Subject: [PATCH 1752/2508] ALSA: HDA : Add API to get hdac_stream by stream
 tag and direction

commit 6e1af45584cb687a0cab4f65ca7fbf688b683cc1 from
https://github.com/01org/linux-apollolake-i

Adds new API snd_hdac_get_hdac_stream() return hdac_stream
based on stream_tag and direction

Change-Id: I6436dfe6708d8b05a04cd8d56e2b9ee0f5c0899c
Signed-off-by: Jeeja KP <jeeja.kp@intel.com>
---
 include/sound/hdaudio.h |    2 ++
 sound/hda/hdac_stream.c |   20 ++++++++++++++++++++
 2 files changed, 22 insertions(+), 0 deletions(-)

diff --git a/include/sound/hdaudio.h b/include/sound/hdaudio.h
index b93a416..4bd92ac 100644
--- a/include/sound/hdaudio.h
+++ b/include/sound/hdaudio.h
@@ -430,6 +430,8 @@ void snd_hdac_stream_init(struct hdac_bus *bus, struct hdac_stream *azx_dev,
 			  int idx, int direction, int tag);
 struct hdac_stream *snd_hdac_stream_assign(struct hdac_bus *bus,
 					   struct snd_pcm_substream *substream);
+struct hdac_stream *snd_hdac_get_hdac_stream(struct hdac_bus *bus,
+						int dir, int stream_tag);
 void snd_hdac_stream_release(struct hdac_stream *azx_dev);
 struct hdac_stream *snd_hdac_get_stream(struct hdac_bus *bus,
 					int dir, int stream_tag);
diff --git a/sound/hda/hdac_stream.c b/sound/hda/hdac_stream.c
index 8981159..503266f 100644
--- a/sound/hda/hdac_stream.c
+++ b/sound/hda/hdac_stream.c
@@ -308,6 +308,26 @@ struct hdac_stream *snd_hdac_get_stream(struct hdac_bus *bus,
 }
 EXPORT_SYMBOL_GPL(snd_hdac_get_stream);
 
+/**
+ * snd_hdac_get_hdac_stream - return hdac_stream based on stream_tag and
+ * direction
+ *
+ * @bus: HD-audio core bus
+ */
+struct hdac_stream *snd_hdac_get_hdac_stream(struct hdac_bus *bus,
+						int dir, int stream_tag)
+{
+	struct hdac_stream *s;
+
+	list_for_each_entry(s, &bus->stream_list, list) {
+		if (s->direction == dir && s->stream_tag == stream_tag)
+			return s;
+	}
+
+	return NULL;
+}
+EXPORT_SYMBOL_GPL(snd_hdac_get_hdac_stream);
+
 /*
  * set up a BDL entry
  */
-- 
1.7.5.4

