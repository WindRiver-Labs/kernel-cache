From df25469153e6f0901f5955c3fc257ecba02604ec Mon Sep 17 00:00:00 2001
From: Matt Roper <matthew.d.roper@intel.com>
Date: Thu, 19 Jan 2017 14:57:46 -0800
Subject: [PATCH 4487/4706] drm/i915: Add IOTG build identifier

commit 7e8b71bc4f6c9594a33b40a5793d304bd859d9d1 from
git://git.yoctoproject.org/linux-yocto-4.1

A small printout at startup will help us recognize what driver is
actually running in bug reports so we can make sure the proper code was
integrated into the OS image.

Signed-off-by: Matt Roper <matthew.d.roper@intel.com>
(cherry picked from commit ec631a96269b9ccdc0ab52a68de35f6c95ae5883)
Signed-off-by: Matt Roper <matthew.d.roper@intel.com>

[Kevin: Just some minor context mods in order to port to wrlinux]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/gpu/drm/i915/i915_drv.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_drv.c b/drivers/gpu/drm/i915/i915_drv.c
index c1dfbd82..f145969 100644
--- a/drivers/gpu/drm/i915/i915_drv.c
+++ b/drivers/gpu/drm/i915/i915_drv.c
@@ -52,6 +52,8 @@
 
 #include "i915_ext_ioctl.h"
 
+#include "iotg_build.h"
+
 static struct drm_driver driver;
 
 static unsigned int i915_load_fail_count;
@@ -1274,7 +1276,11 @@ int i915_driver_load(struct pci_dev *pdev, const struct pci_device_id *ent)
 	/* Initialize all the resources for perf monitoring */
 	i915_perfmon_setup(dev_priv);
 
+#ifndef IOTG_BUILD_ID
+#define IOTG_BUILD_ID "unknown"
+#endif
 	printk(KERN_INFO "IOTG i915 forklift 2016-12-15\n");
+	printk(KERN_INFO "IOTG i915 build " IOTG_BUILD_ID "\n");
 
 	return 0;
 
-- 
1.7.5.4

