From 7256489887112d10ceea2f2934c28b66176b34e3 Mon Sep 17 00:00:00 2001
From: Ander Conselvan de Oliveira <ander.conselvan.de.oliveira@intel.com>
Date: Tue, 21 Apr 2015 17:13:10 +0300
Subject: [PATCH 0273/4706] drm/i915: Delete fb, x and y parameters from mode
 set functions

commit cf6d0d76cf797494b95e4971f662c6311ff92320 upstream

We don't need to pass it down the call chain anymore now that the plane
state is set up properly.

Signed-off-by: Ander Conselvan de Oliveira <ander.conselvan.de.oliveira@intel.com>
Reviewed-by: Maarten Lankhorst <maarten.lankhorst@linux.intel.com>
Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
---
 drivers/gpu/drm/i915/intel_display.c |   16 +++++-----------
 1 files changed, 5 insertions(+), 11 deletions(-)

diff --git a/drivers/gpu/drm/i915/intel_display.c b/drivers/gpu/drm/i915/intel_display.c
index a379bae..8af8c00 100644
--- a/drivers/gpu/drm/i915/intel_display.c
+++ b/drivers/gpu/drm/i915/intel_display.c
@@ -83,7 +83,6 @@ static void ironlake_pch_clock_get(struct intel_crtc *crtc,
 				   struct intel_crtc_state *pipe_config);
 
 static int intel_set_mode(struct drm_crtc *crtc, struct drm_display_mode *mode,
-			  int x, int y, struct drm_framebuffer *old_fb,
 			  struct drm_atomic_state *state);
 static int intel_framebuffer_init(struct drm_device *dev,
 				  struct intel_framebuffer *ifb,
@@ -9891,7 +9890,7 @@ retry:
 	if (ret)
 		goto fail;
 
-	if (intel_set_mode(crtc, mode, 0, 0, fb, state)) {
+	if (intel_set_mode(crtc, mode, state)) {
 		DRM_DEBUG_KMS("failed to set mode on load-detect pipe\n");
 		if (old->release_fb)
 			old->release_fb->funcs->destroy(old->release_fb);
@@ -9965,7 +9964,7 @@ void intel_release_load_detect_pipe(struct drm_connector *connector,
 		if (ret)
 			goto fail;
 
-		intel_set_mode(crtc, NULL, 0, 0, NULL, state);
+		intel_set_mode(crtc, NULL, state);
 
 		drm_atomic_state_free(state);
 
@@ -12305,7 +12304,6 @@ static int __intel_set_mode_checks(struct drm_atomic_state *state)
 
 static int __intel_set_mode(struct drm_crtc *modeset_crtc,
 			    struct drm_display_mode *mode,
-			    int x, int y, struct drm_framebuffer *fb,
 			    struct intel_crtc_state *pipe_config)
 {
 	struct drm_device *dev = modeset_crtc->dev;
@@ -12415,12 +12413,11 @@ static int __intel_set_mode(struct drm_crtc *modeset_crtc,
 
 static int intel_set_mode_with_config(struct drm_crtc *crtc,
 				      struct drm_display_mode *mode,
-				      int x, int y, struct drm_framebuffer *fb,
 				      struct intel_crtc_state *pipe_config)
 {
 	int ret;
 
-	ret = __intel_set_mode(crtc, mode, x, y, fb, pipe_config);
+	ret = __intel_set_mode(crtc, mode, pipe_config);
 
 	if (ret == 0)
 		intel_modeset_check_state(crtc->dev);
@@ -12430,7 +12427,6 @@ static int intel_set_mode_with_config(struct drm_crtc *crtc,
 
 static int intel_set_mode(struct drm_crtc *crtc,
 			  struct drm_display_mode *mode,
-			  int x, int y, struct drm_framebuffer *fb,
 			  struct drm_atomic_state *state)
 {
 	struct intel_crtc_state *pipe_config;
@@ -12442,7 +12438,7 @@ static int intel_set_mode(struct drm_crtc *crtc,
 		goto out;
 	}
 
-	ret = intel_set_mode_with_config(crtc, mode, x, y, fb, pipe_config);
+	ret = intel_set_mode_with_config(crtc, mode, pipe_config);
 	if (ret)
 		goto out;
 
@@ -12514,8 +12510,7 @@ void intel_crtc_restore_mode(struct drm_crtc *crtc)
 	intel_modeset_setup_plane_state(state, crtc, &crtc->mode,
 					crtc->primary->fb, crtc->x, crtc->y);
 
-	intel_set_mode(crtc, &crtc->mode, crtc->x, crtc->y, crtc->primary->fb,
-		       state);
+	intel_set_mode(crtc, &crtc->mode, state);
 
 	drm_atomic_state_free(state);
 }
@@ -12921,7 +12916,6 @@ static int intel_crtc_set_config(struct drm_mode_set *set)
 
 	if (config->mode_changed) {
 		ret = intel_set_mode_with_config(set->crtc, set->mode,
-						 set->x, set->y, set->fb,
 						 pipe_config);
 	} else if (config->fb_changed) {
 		struct intel_crtc *intel_crtc = to_intel_crtc(set->crtc);
-- 
1.7.5.4

