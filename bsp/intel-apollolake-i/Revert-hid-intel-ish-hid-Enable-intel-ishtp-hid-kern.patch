From 31f08720d5ab55c9921c6e0423393882a9095b22 Mon Sep 17 00:00:00 2001
From: "Ooi, Joyce" <joyce.ooi@intel.com>
Date: Fri, 2 Dec 2016 10:58:57 +0800
Subject: [PATCH 4564/4706] Revert "hid: intel-ish-hid: Enable intel-ishtp-hid
 kernel module auto-loading"

commit 5c4e2edd0cffd82ee56efa1c23b89edf97bcdb7f from
git://git.yoctoproject.org/linux-yocto-4.1

This reverts commit 3510e1059d9f ("hid: intel-ish-hid: Enable
intel-ishtp-hid kernel module auto-loading through uevent").
The changes of this patch are already included in upstream ISH drivers.

Signed-off-by: Ooi, Joyce <joyce.ooi@intel.com>
---
 drivers/hid/intel-ish-hid/ishtp-hid-client.c |    1 -
 drivers/hid/intel-ish-hid/ishtp/bus.c        |   21 ---------------------
 2 files changed, 0 insertions(+), 22 deletions(-)

diff --git a/drivers/hid/intel-ish-hid/ishtp-hid-client.c b/drivers/hid/intel-ish-hid/ishtp-hid-client.c
index 05ebb01..aa8f330 100644
--- a/drivers/hid/intel-ish-hid/ishtp-hid-client.c
+++ b/drivers/hid/intel-ish-hid/ishtp-hid-client.c
@@ -933,4 +933,3 @@ MODULE_AUTHOR("Daniel Drubin <daniel.drubin@intel.com>");
 MODULE_AUTHOR("Srinivas Pandruvada <srinivas.pandruvada@linux.intel.com>");
 
 MODULE_LICENSE("GPL");
-MODULE_ALIAS("ishtp:*");
diff --git a/drivers/hid/intel-ish-hid/ishtp/bus.c b/drivers/hid/intel-ish-hid/ishtp/bus.c
index a8a46c4..0cb3d37 100644
--- a/drivers/hid/intel-ish-hid/ishtp/bus.c
+++ b/drivers/hid/intel-ish-hid/ishtp/bus.c
@@ -303,34 +303,13 @@ static int ishtp_cl_device_reset(struct ishtp_cl_device *device)
 	return ret;
 }
 
-static ssize_t modalias_show(struct device *dev, struct device_attribute *a,
-	char *buf)
-{
-	int len;
-	len = snprintf(buf, PAGE_SIZE, "ishtp:%s\n", dev_name(dev));
-	return (len >= PAGE_SIZE) ? (PAGE_SIZE - 1) : len;
-}
-
-static struct device_attribute ishtp_cl_dev_attrs[] = {
-	__ATTR_RO(modalias),
-	__ATTR_NULL,
-};
-
-static int ishtp_cl_uevent(struct device *dev, struct kobj_uevent_env *env)
-{
-	if (add_uevent_var(env, "MODALIAS=ishtp:%s", dev_name(dev)))
-		return -ENOMEM;
-	return 0;
-}
 
 static struct bus_type ishtp_cl_bus_type = {
 	.name		= "ishtp",
-	.dev_attrs	= ishtp_cl_dev_attrs,
 	.probe		= ishtp_cl_device_probe,
 	.remove		= ishtp_cl_device_remove,
 	.suspend	= ishtp_cl_device_suspend,
 	.resume		= ishtp_cl_device_resume,
-	.uevent		= ishtp_cl_uevent,
 };
 
 static void ishtp_cl_dev_release(struct device *dev)
-- 
1.7.5.4

