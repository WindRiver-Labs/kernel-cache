From f51b6f4e43cd49e39048d0c1c78650427c948a66 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Wed, 12 Apr 2017 15:48:37 +0800
Subject: [PATCH] drm/i915: use the div_u64() to fix the build error on 32bit
 kernel

Use the div_u64() for the u64 divide to fix the following build error
on 32bit kernel:
  drivers/gpu/drm/i915/i915_debugfs.c:2673: undefined reference to `__udivdi3'

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/gpu/drm/i915/i915_debugfs.c |   26 +++++++++++++-------------
 1 files changed, 13 insertions(+), 13 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_debugfs.c b/drivers/gpu/drm/i915/i915_debugfs.c
index 78783b7..750e4d4 100644
--- a/drivers/gpu/drm/i915/i915_debugfs.c
+++ b/drivers/gpu/drm/i915/i915_debugfs.c
@@ -2597,31 +2597,31 @@ static int i915_timing_info(struct seq_file *m, void *data)
 
 	seq_printf(m, "Timing info\n");
 	seq_printf(m, "  Total driver load time:      %lldms\n",
-		   (dev_priv->profile.driver_load / 1000000));
+		   div_u64(dev_priv->profile.driver_load, 1000000));
 	seq_printf(m, "    Hardware init time:                 %4lldms\n",
-		   (dev_priv->profile.hardware_init / 1000000));
+		   div_u64(dev_priv->profile.hardware_init, 1000000));
 	seq_printf(m, "    Modeset init time:                  %4lldms\n",
-		   (dev_priv->profile.modeset_init / 1000000));
+		   div_u64(dev_priv->profile.modeset_init, 1000000));
 	seq_printf(m, "        GMBUS init time:                    %4lldms\n",
-		   (dev_priv->profile.gmbus_init / 1000000));
+		   div_u64(dev_priv->profile.gmbus_init, 1000000));
 	seq_printf(m, "        Modeset init time:                  %4lldms\n",
-		   (dev_priv->profile.modeset_init_2 / 1000000));
+		   div_u64(dev_priv->profile.modeset_init_2, 1000000));
 	seq_printf(m, "        HUC firmware init time:             %4lldms\n",
-		   (dev_priv->profile.huc_init / 1000000));
+		   div_u64(dev_priv->profile.huc_init, 1000000));
 	seq_printf(m, "        GUC firmware init time:             %4lldms\n",
-		   (dev_priv->profile.guc_init / 1000000));
+		   div_u64(dev_priv->profile.guc_init, 1000000));
 	seq_printf(m, "        GUC/HUC firmware load time:         %4lldms\n",
-		   (dev_priv->profile.guc_huc_load / 1000000));
+		   div_u64(dev_priv->profile.guc_huc_load, 1000000));
 	seq_printf(m, "        Global GTT init time:               %4lldms\n",
-		   (dev_priv->profile.gtt_init / 1000000));
+		   div_u64(dev_priv->profile.gtt_init, 1000000));
 	seq_printf(m, "        Modeset GEM init time:              %4lldms\n",
-		   (dev_priv->profile.modeset_gem_init / 1000000));
+		   div_u64(dev_priv->profile.modeset_gem_init, 1000000));
 	seq_printf(m, "    Register driver time:               %4lldms\n",
-		   (dev_priv->profile.driver_register / 1000000));
+		   div_u64(dev_priv->profile.driver_register, 1000000));
 	seq_printf(m, "  Frambuffer device load time: %4lldms\n",
-		   (dev_priv->profile.fbdev_load / 1000000));
+		   div_u64(dev_priv->profile.fbdev_load, 1000000));
 	seq_printf(m, "  CSR firmware load time:      %4lldms\n",
-		   (dev_priv->profile.csr_load / 1000000));
+		   div_u64(dev_priv->profile.csr_load, 1000000));
 
 	return 0;
 }
-- 
1.7.5.4

