From c64684cfa16cdc8bc8c3348c937880847d3d15b9 Mon Sep 17 00:00:00 2001
From: Vinod Koul <vinod.koul@intel.com>
Date: Wed, 26 Aug 2015 13:13:56 +0530
Subject: [PATCH 1738/2508] ASoC: Intel: Skylake: Invoke debugfs init and
 cleanup

commit 4a32074362426a4ef86c1f204e6ed4c252a7e84f from
https://github.com/01org/linux-apollolake-i

When SKL driver probe complete we need to initialize the debugs
and also clean it up at driver remove. Add the routines

Signed-off-by: Vinod Koul <vinod.koul@intel.com>
---
 sound/soc/intel/skylake/skl.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/sound/soc/intel/skylake/skl.c b/sound/soc/intel/skylake/skl.c
index fd05804..612f0d2 100644
--- a/sound/soc/intel/skylake/skl.c
+++ b/sound/soc/intel/skylake/skl.c
@@ -608,6 +608,9 @@ static int skl_probe(struct pci_dev *pci,
 	if (err < 0)
 		goto out_unregister;
 
+	/* init debugfs */
+	skl->debugfs = skl_debugfs_init(skl);
+
 	/*configure PM */
 	pm_runtime_set_autosuspend_delay(bus->dev, SKL_SUSPEND_DELAY);
 	pm_runtime_use_autosuspend(bus->dev);
@@ -641,6 +644,9 @@ static void skl_remove(struct pci_dev *pci)
 	if (pci_dev_run_wake(pci))
 		pm_runtime_get_noresume(&pci->dev);
 	pci_dev_put(pci);
+	
+	skl_debugfs_exit(skl->debugfs);
+	skl->debugfs = NULL;
 	skl_platform_unregister(&pci->dev);
 	skl_free_dsp(skl);
 	skl_machine_device_unregister(skl);
-- 
1.7.5.4

