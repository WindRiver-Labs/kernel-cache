From 8dff499a12b8ee147120a106cf36947b3f57e1fb Mon Sep 17 00:00:00 2001
From: Tomas Winkler <tomas.winkler@intel.com>
Date: Tue, 4 Aug 2015 14:30:11 +0300
Subject: [PATCH 2379/2508] mei: remove check on pm_runtime_active in
 __mei_cl_disconnect

commit eead035a35b59df9f956139cb2c73141751a246e upstream

Remove bogus check on pm_runtime_active that prevented
disconnection from a client in case the device was resuming
from power gating but not yet active.

Fix regression introduced by
18901357e70ae29e3fd1c58712a6847c2ae52eae
mei: disconnect on connection request timeout

Signed-off-by: Tomas Winkler <tomas.winkler@intel.com>
Signed-off-by: Alexander Usyskin <alexander.usyskin@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
---
 drivers/misc/mei/client.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

diff --git a/drivers/misc/mei/client.c b/drivers/misc/mei/client.c
index 5fcd70b..a6c87c7 100644
--- a/drivers/misc/mei/client.c
+++ b/drivers/misc/mei/client.c
@@ -853,9 +853,6 @@ static int __mei_cl_disconnect(struct mei_cl *cl)
 
 	dev = cl->dev;
 
-	if (WARN_ON(!pm_runtime_active(dev->dev)))
-		return -EFAULT;
-
 	cl->state = MEI_FILE_DISCONNECTING;
 
 	cb = mei_io_cb_init(cl, MEI_FOP_DISCONNECT, NULL);
-- 
1.7.5.4

