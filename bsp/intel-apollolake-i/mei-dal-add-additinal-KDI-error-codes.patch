From 80328c0914663f57abf3ce2640252d0509cf55f7 Mon Sep 17 00:00:00 2001
From: Yael Samet <yael.samet@intel.com>
Date: Thu, 29 Sep 2016 13:41:10 +0300
Subject: [PATCH 4629/4706] mei: dal: add additinal KDI error codes

commit 4b240c5a175d51d114d0a849c18f96025d5bb962 from
git://git.yoctoproject.org/linux-yocto-4.1

Add 3 more error codes from BH VM:
   uncaught exception, timeout, and applet crashed.

Change-Id: I0b1636f323ff6c135f53420dbed91e9f6df0d766
Signed-off-by: Yael Samet <yael.samet@intel.com>
Signed-off-by: Tomas Winkler <tomas.winkler@intel.com>
---
 drivers/misc/mei/dal/dal_kdi.c |    6 ++++++
 include/linux/dal.h            |    3 +++
 2 files changed, 9 insertions(+), 0 deletions(-)

diff --git a/drivers/misc/mei/dal/dal_kdi.c b/drivers/misc/mei/dal/dal_kdi.c
index 7ebd94c..78556af 100644
--- a/drivers/misc/mei/dal/dal_kdi.c
+++ b/drivers/misc/mei/dal/dal_kdi.c
@@ -103,6 +103,12 @@ static int bh_err_to_kdi_err(int bh_err)
 		return DAL_KDI_STATUS_OUT_OF_RESOURCE;
 	case BHE_SESSION_NUM_EXCEED:
 		return DAL_KDI_STATUS_MAX_SESSIONS_REACHED;
+	case BHE_UNCAUGHT_EXCEPTION:
+		return DAL_KDI_STATUS_UNCAUGHT_EXCEPTION;
+	case BHE_WD_TIMEOUT:
+		return DAL_KDI_STATUS_WD_TIMEOUT;
+	case BHE_APPLET_CRASHED:
+		return DAL_KDI_STATUS_APPLET_CRASHED;
 	default:
 		return DAL_KDI_STATUS_INTERNAL_ERROR;
 	}
diff --git a/include/linux/dal.h b/include/linux/dal.h
index 52ccb27..7c8140d 100644
--- a/include/linux/dal.h
+++ b/include/linux/dal.h
@@ -88,6 +88,9 @@ struct dal_version_info {
 #define DAL_KDI_STATUS_OUT_OF_RESOURCE          0xA08
 #define DAL_KDI_STATUS_NOT_READY                0xA09
 #define DAL_KDI_STATUS_MAX_SESSIONS_REACHED     0xA0A
+#define DAL_KDI_STATUS_UNCAUGHT_EXCEPTION       0xA0B
+#define DAL_KDI_STATUS_WD_TIMEOUT               0xA0C
+#define DAL_KDI_STATUS_APPLET_CRASHED           0xA0D
 
 #define DAL_KDI_INVALID_HANDLE    0
 
-- 
1.7.5.4

