From 13e02d601056af4767538443b513f7e8175e4301 Mon Sep 17 00:00:00 2001
From: Kranthi G <gudishax.kranthikumar@intel.com>
Date: Wed, 6 Jan 2016 08:19:26 +0530
Subject: [PATCH 1824/2508] ASoC: Intel: Skylake: Use Stream tag for fw load

commit bbb4fb6d0e4d3ae67c85ca96daf48f4da295a93c from
https://github.com/01org/linux-apollolake-i

Need to query the available stream tag while
downloading the FW.
Remove the redundant variable stream_tag, instead
one available in existing context.

Change-Id: I34f53e851c261b205b71ec0a1cc83a5ccd9f40db
Signed-off-by: Kranthi G <gudishax.kranthikumar@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/7913
Reviewed-by: Babu, Ramesh <ramesh.babu@intel.com>
Tested-by: Babu, Ramesh <ramesh.babu@intel.com>
---
 sound/soc/intel/skylake/bxt-sst.c |    6 ++----
 1 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/sound/soc/intel/skylake/bxt-sst.c b/sound/soc/intel/skylake/bxt-sst.c
index 82e2376..72dfa54 100644
--- a/sound/soc/intel/skylake/bxt-sst.c
+++ b/sound/soc/intel/skylake/bxt-sst.c
@@ -273,9 +273,7 @@ base_fw_load_failed:
 static int sst_transfer_fw_host_dma(struct sst_dsp *ctx)
 {
 	int ret = 0;
-	int stream_tag;
 
-	stream_tag = ctx->dsp_ops.stream_tag;
 
 	ctx->dsp_ops.trigger(ctx->dev, true, ctx->dsp_ops.stream_tag);
 	ret = sst_dsp_register_poll(ctx, BXT_ADSP_REG_FW_STATUS, SKL_FW_STS_MASK,
@@ -283,8 +281,8 @@ static int sst_transfer_fw_host_dma(struct sst_dsp *ctx)
 			BXT_FW_ROM_BASEFW_ENTERED_TIMEOUT,
 			"Firmware boot");
 
-	ctx->dsp_ops.trigger(ctx->dev, false, stream_tag);
-	ctx->dsp_ops.cleanup(ctx->dev, &ctx->dmab, stream_tag);
+	ctx->dsp_ops.trigger(ctx->dev, false, ctx->dsp_ops.stream_tag);
+	ctx->dsp_ops.cleanup(ctx->dev, &ctx->dmab, ctx->dsp_ops.stream_tag);
 	return ret;
 }
 
-- 
1.7.5.4

