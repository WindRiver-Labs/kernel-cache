From b175c5e912d1fc60e2e0f23472b6ee4e7653d9b1 Mon Sep 17 00:00:00 2001
From: Guneshwor Singh <guneshwor.o.singh@intel.com>
Date: Tue, 15 Dec 2015 17:53:26 +0530
Subject: [PATCH 1831/2508] ASoC: Intel: CNL: Fix for channel map during
 channel fixup

commit 02ac0a69e71728a9f0a5bacb6ac077840eab8c12 from
https://github.com/01org/linux-apollolake-i

ITT currently does not take care channel map if
channel fixup is applied. For mono, it shoud be
fffffff0 and for stereo, ffffff10.

Change-Id: I563d07ec3632f598dbdcbd4df5ddc89c1132b8d8
Signed-off-by: Guneshwor Singh <guneshwor.o.singh@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/7838
Reviewed-by: Shah, Hardik T <hardik.t.shah@intel.com>
Tested-by: Shah, Hardik T <hardik.t.shah@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/8041
---
 sound/soc/intel/skylake/skl-topology.c |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/sound/soc/intel/skylake/skl-topology.c b/sound/soc/intel/skylake/skl-topology.c
index fb9452a..4aa00ce 100644
--- a/sound/soc/intel/skylake/skl-topology.c
+++ b/sound/soc/intel/skylake/skl-topology.c
@@ -147,10 +147,13 @@ static void skl_tplg_update_params(struct skl_module_fmt *fmt,
 		fmt->s_freq = params->s_freq;
 	if (fixup & SKL_CH_FIXUP_MASK) {
 		fmt->channels = params->ch;
-		if(fmt->channels == 1)
+		if (fmt->channels == 1) {
 			fmt->ch_cfg = SKL_CH_CFG_MONO;
-		if(fmt->channels == 2)
+			fmt->ch_map = 0xfffffff0;
+		} else if (fmt->channels == 2) {
 			fmt->ch_cfg = SKL_CH_CFG_STEREO;
+			fmt->ch_map = 0xffffff10;
+		}
 	}
 	if (fixup & SKL_FMT_FIXUP_MASK) {
 		fmt->valid_bit_depth = skl_get_bit_depth(params->s_fmt);
-- 
1.7.5.4

