From 64fe6782b5d97d0f51216c32b7066abf1bbe1d34 Mon Sep 17 00:00:00 2001
From: "Pawse, GuruprasadX" <guruprasadx.pawse@intel.com>
Date: Mon, 22 Aug 2016 19:11:50 +0530
Subject: [PATCH 4703/4706] ASoC: Intel: Skylake: Probe : Return success on
 redundant control set

commit d6201069c8f9eaf45b150f220f1f259b803f04e1 from
git://git.yoctoproject.org/linux-yocto-4.1

Current code returned error on redundant control set.
This can cause issues with user space that may set redundant controls
Eg. setting a disconnect when the probe point is not connected.

This patch returns success if nothing needs to be done with the control set.

Change-Id: I6131502a3b15e439c1fc818a19d882b93b0df3a2
Signed-off-by: Pawse, GuruprasadX <guruprasadx.pawse@intel.com>
---
 sound/soc/intel/skylake/skl-topology.c |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/sound/soc/intel/skylake/skl-topology.c b/sound/soc/intel/skylake/skl-topology.c
index 1f56b1d..c8e830d 100644
--- a/sound/soc/intel/skylake/skl-topology.c
+++ b/sound/soc/intel/skylake/skl-topology.c
@@ -1782,7 +1782,8 @@ static int skl_probe_set_tlv_ext(struct snd_kcontrol *kcontrol)
 		pconfig->eprobe[index].state = SKL_PROBE_STATE_EXT_NONE;
 		dev_dbg(dapm->dev, "eprobe[%d].state %d\n", index, pconfig->eprobe[index].state);
 	} else
-		ret = -EINVAL;
+		/* Redundant control set, so nothing to be done in driver */
+		dev_warn(dapm->dev, "Extractor control discarded by driver\n");
 
 	return ret;
 }
@@ -1832,7 +1833,8 @@ static int skl_probe_set_tlv_inj(struct snd_kcontrol *kcontrol)
 		pconfig->iprobe[index].state = SKL_PROBE_STATE_INJ_DISCONNECTED;
 		dev_dbg(dapm->dev, "iprobe[%d].state %d\n", index, pconfig->iprobe[index].state);
 	} else
-		ret = -EINVAL;
+		/* Redundant control set, so nothing to be done in driver */
+		dev_warn(dapm->dev, "Injector control discarded by driver\n");
 
 	return ret;
 }
-- 
1.7.5.4

