From 58b75f2576025967745a47c6197fc7ca4f51dda0 Mon Sep 17 00:00:00 2001
From: Guneshwor Singh <guneshwor.o.singh@intel.com>
Date: Wed, 18 Nov 2015 03:08:24 +0530
Subject: [PATCH 1835/2508] ASoC: Intel: Cannonlake: Add dsp ops for
 Cannonlake

commit a3b66c25ca82f3a0df4913e22cf12d1b85e441b0 from
https://github.com/01org/linux-apollolake-i

Change-Id: I933664d0d2ce7de6010670f2ee6d391478441d95
Signed-off-by: Guneshwor Singh <guneshwor.o.singh@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/7497
Reviewed-by: Shah, Hardik T <hardik.t.shah@intel.com>
Tested-by: Shah, Hardik T <hardik.t.shah@intel.com>
---
 sound/soc/intel/skylake/skl-messages.c |    2 ++
 sound/soc/intel/skylake/skl.c          |    2 +-
 2 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/sound/soc/intel/skylake/skl-messages.c b/sound/soc/intel/skylake/skl-messages.c
index 5ad9f76..2668bcb 100644
--- a/sound/soc/intel/skylake/skl-messages.c
+++ b/sound/soc/intel/skylake/skl-messages.c
@@ -23,6 +23,7 @@
 #include <sound/pcm.h>
 #include <sound/soc.h>
 #include "skl-sst-dsp.h"
+#include "cnl-sst-dsp.h"
 #include "skl-sst-ipc.h"
 #include "skl.h"
 #include "../common/sst-dsp.h"
@@ -197,6 +198,7 @@ static const struct skl_dsp_ops dsp_ops[] = {
 {.id = 0x9d70, .loader_ops = skl_get_loader_ops, .init = skl_sst_dsp_init, .cleanup = skl_sst_dsp_cleanup},
 {.id = 0x0a98, .loader_ops = bxt_get_loader_ops, .init = bxt_sst_dsp_init, .cleanup = bxt_sst_dsp_cleanup},
 {.id = 0x5a98, .loader_ops = bxt_get_loader_ops, .init = bxt_sst_dsp_init, .cleanup = bxt_sst_dsp_cleanup},
+{.id = 0x9df0, .loader_ops = bxt_get_loader_ops, .init = cnl_sst_dsp_init, .cleanup = cnl_sst_dsp_cleanup},
 {}
 };
 
diff --git a/sound/soc/intel/skylake/skl.c b/sound/soc/intel/skylake/skl.c
index 51c4408..2da4dc1 100644
--- a/sound/soc/intel/skylake/skl.c
+++ b/sound/soc/intel/skylake/skl.c
@@ -315,8 +315,8 @@ static int skl_machine_device_register(struct skl *skl, void *driver_data)
 				mach = sst_cnl_devdata;
 				goto cnl_continue;
 			}
+			return -ENODEV;
 		}
-		return -ENODEV;
 	}
 cnl_continue:
 	dev_dbg(bus->dev, "Machine driver found:%s\n", mach->machine);
-- 
1.7.5.4

