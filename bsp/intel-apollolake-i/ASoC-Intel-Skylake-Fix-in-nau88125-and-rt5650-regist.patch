From a6748970e925ccd76df29a3e9f482f9e766e4b1d Mon Sep 17 00:00:00 2001
From: Jeeja KP <jeeja.kp@intel.com>
Date: Mon, 19 Oct 2015 21:01:01 +0530
Subject: [PATCH 1718/2508] ASoC: Intel: Skylake: Fix in nau88125 and rt5650
 register jack Signed-off-by: Jeeja KP
 <jeeja.kp@intel.com>

commit 6ce510467a7b6db23778b9c518c60ae519391521 from
https://github.com/01org/linux-apollolake-i
---
 sound/soc/intel/boards/skl_nau88l25_ssm4567.c |   13 -------------
 sound/soc/intel/boards/skl_rt5650.c           |   16 +---------------
 2 files changed, 1 insertions(+), 28 deletions(-)

diff --git a/sound/soc/intel/boards/skl_nau88l25_ssm4567.c b/sound/soc/intel/boards/skl_nau88l25_ssm4567.c
index a3758d3..15ecd33 100644
--- a/sound/soc/intel/boards/skl_nau88l25_ssm4567.c
+++ b/sound/soc/intel/boards/skl_nau88l25_ssm4567.c
@@ -205,18 +205,6 @@ static struct snd_soc_ops skylake_nau8825_ops = {
 	.hw_params = skylake_nau8825_hw_params,
 };
 
-static int skylake_rtd_init(struct snd_soc_pcm_runtime *rtd)
-{
-	struct snd_soc_codec *codec = rtd->codec;
-	struct snd_soc_dapm_context *dapm = &codec->dapm;
-
-	/* always connected - check HP for jack detect */
-	snd_soc_dapm_enable_pin(dapm, "Headphone Jack");
-	snd_soc_dapm_enable_pin(dapm, "Mic Jack");
-
-	return 0;
-}
-
 /* skylake digital audio interface glue - connects codec <--> CPU */
 static struct snd_soc_dai_link skylake_dais[] = {
 	/* Front End DAI links */
@@ -228,7 +216,6 @@ static struct snd_soc_dai_link skylake_dais[] = {
 		.dynamic = 1,
 		.codec_name = "snd-soc-dummy",
 		.codec_dai_name = "snd-soc-dummy-dai",
-		.init = skylake_rtd_init,
 		.nonatomic = 1,
 		.trigger = {
 			SND_SOC_DPCM_TRIGGER_POST, SND_SOC_DPCM_TRIGGER_POST},
diff --git a/sound/soc/intel/boards/skl_rt5650.c b/sound/soc/intel/boards/skl_rt5650.c
index 6d3a88f..d3077c8 100644
--- a/sound/soc/intel/boards/skl_rt5650.c
+++ b/sound/soc/intel/boards/skl_rt5650.c
@@ -161,7 +161,7 @@ static int skylake_rt5650_codec_init(struct snd_soc_pcm_runtime *runtime)
 			SND_JACK_BTN_0 | SND_JACK_BTN_1 |
 			SND_JACK_BTN_2 | SND_JACK_BTN_3;
 
-	ret = snd_soc_card_jack_new(&skylake_rt5650, "Headset Jack",
+	ret = snd_soc_card_jack_new(runtime->card, "Headset Jack",
 		jack_type, &skylake_headset, skylake_headset_pins,
 		ARRAY_SIZE(skylake_headset_pins));
 
@@ -224,19 +224,6 @@ static struct snd_soc_ops skylake_be_rt5650_ops = {
 	.hw_params = skylake_rt5650_hw_params,
 };
 
-static int skylake_rtd_init(struct snd_soc_pcm_runtime *rtd)
-{
-	struct snd_soc_codec *codec = rtd->codec;
-	struct snd_soc_dapm_context *dapm = &codec->dapm;
-
-	/* always connected - check HP for jack detect */
-	snd_soc_dapm_enable_pin(dapm, "Headphone Jack");
-	snd_soc_dapm_enable_pin(dapm, "Ext Spk");
-	snd_soc_dapm_enable_pin(dapm, "Mic Jack");
-
-	return 0;
-}
-
 /* skylake digital audio interface glue - connects codec <--> CPU */
 static struct snd_soc_dai_link skylake_rt5650_dais[] = {
 	/* Front End DAI links */
@@ -248,7 +235,6 @@ static struct snd_soc_dai_link skylake_rt5650_dais[] = {
 		.dynamic = 1,
 		.codec_name = "snd-soc-dummy",
 		.codec_dai_name = "snd-soc-dummy-dai",
-		.init = skylake_rtd_init,
 		.trigger = {SND_SOC_DPCM_TRIGGER_POST, SND_SOC_DPCM_TRIGGER_POST},
 		.dpcm_playback = 1,
 		.nonatomic = 1,
-- 
1.7.5.4

