From fd29837c211f9ded1a1b4f5485b7fe2f575521d1 Mon Sep 17 00:00:00 2001
From: "Xiong, James" <james.xiong@intel.com>
Date: Wed, 8 Jun 2016 15:32:02 -0700
Subject: [PATCH 4431/4706] drm/i915: Ensure splash image requests work in any
 display order

commit ea82a5b98fe7c70fe1d5f53f5f07524a15f45fef from
git://git.yoctoproject.org/linux-yocto-4.1

When a splash screen image is shared by multiple displays, it is
loaded only once for the first splash entry, an gem obj is then
created and shared with other entries.
In this case, eDP is the 2nd entry in the boot parameter, but gets
initialized first. Because eDP->fw is NULL, it failed to create
fb for the eDP.

The fix is to remove the unnecessary check in create_splash_fb.

Signed-off-by: Xiong, James <james.xiong@intel.com>
Reviewed-by: Bob Paauwe <bob.j.paauwe@intel.com>
[mattrope: Cleaned up commit message/headline]
Signed-off-by: Matt Roper <matthew.d.roper@intel.com>
---
 drivers/gpu/drm/i915/intel_initial_modeset.c |    8 +++-----
 1 files changed, 3 insertions(+), 5 deletions(-)

diff --git a/drivers/gpu/drm/i915/intel_initial_modeset.c b/drivers/gpu/drm/i915/intel_initial_modeset.c
index 5186ccf..347c066 100644
--- a/drivers/gpu/drm/i915/intel_initial_modeset.c
+++ b/drivers/gpu/drm/i915/intel_initial_modeset.c
@@ -440,11 +440,9 @@ static void create_splash_fb(struct drm_device *dev,
 	struct splash_screen_info *splash_info;
 	struct drm_i915_private *dev_priv = dev->dev_private;
 
-	if (splash->fw) {
-		splash->fb = intel_splash_screen_fb(dev, splash);
-		if (IS_ERR(splash->fb))
-			splash->fb = NULL;
-	}
+	splash->fb = intel_splash_screen_fb(dev, splash);
+	if (IS_ERR(splash->fb))
+		splash->fb = NULL;
 
 	if (splash->fb)
 		list_for_each_entry(splash_info, &dev_priv->splash_list, link)
-- 
1.7.5.4

