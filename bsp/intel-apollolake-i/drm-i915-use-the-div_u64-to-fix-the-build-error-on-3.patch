From cb4ee7aa46a5a562671806279c94b23b2e475dad Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Fri, 30 Sep 2016 10:40:09 +0800
Subject: [PATCH 2508/2508] drm/i915: use the div_u64() to fix the build error
 on 32bit kernel

Use the div_u64() for the u64 divide to fix the following build error
on 32bit kernel:
  drivers/gpu/drm/i915/i915_debugfs.c:2673: undefined reference to `__udivdi3'

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/gpu/drm/i915/i915_debugfs.c |   30 +++++++++++++++---------------
 1 files changed, 15 insertions(+), 15 deletions(-)

diff --git a/drivers/gpu/drm/i915/i915_debugfs.c b/drivers/gpu/drm/i915/i915_debugfs.c
index b773336..5d8992a 100644
--- a/drivers/gpu/drm/i915/i915_debugfs.c
+++ b/drivers/gpu/drm/i915/i915_debugfs.c
@@ -2669,35 +2669,35 @@ static int i915_timing_info(struct seq_file *m, void *data)
 
 	seq_printf(m, "Timing info\n");
 	seq_printf(m, "  Total driver load time:      %lldms\n",
-		   (dev_priv->profile.driver_load / 1000000));
+		   div_u64(dev_priv->profile.driver_load, 1000000));
 	seq_printf(m, "    Hardware init time:                 %4lldms\n",
-		   (dev_priv->profile.hardware_init / 1000000));
+		   div_u64(dev_priv->profile.hardware_init, 1000000));
 	seq_printf(m, "    Modeset init time:                  %4lldms\n",
-		   (dev_priv->profile.modeset_init / 1000000));
+		   div_u64(dev_priv->profile.modeset_init, 1000000));
 	seq_printf(m, "        GMBUS init time:                    %4lldms\n",
-		   (dev_priv->profile.gmbus_init / 1000000));
+		   div_u64(dev_priv->profile.gmbus_init, 1000000));
 	seq_printf(m, "        Modeset init time:                  %4lldms\n",
-		   (dev_priv->profile.modeset_init_2 / 1000000));
+		   div_u64(dev_priv->profile.modeset_init_2, 1000000));
 	seq_printf(m, "        GUC firmware init time:             %4lldms\n",
-		   (dev_priv->profile.guc_init / 1000000));
+		   div_u64(dev_priv->profile.guc_init, 1000000));
 	seq_printf(m, "        GUC firmware load time:             %4lldms\n",
-		   (dev_priv->profile.guc_load / 1000000));
+		   div_u64(dev_priv->profile.guc_load, 1000000));
 	seq_printf(m, "        Global GTT init time:               %4lldms\n",
-		   (dev_priv->profile.gtt_init / 1000000));
+		   div_u64(dev_priv->profile.gtt_init, 1000000));
 	seq_printf(m, "        Modeset GEM init time:              %4lldms\n",
-		   (dev_priv->profile.modeset_gem_init / 1000000));
+		   div_u64(dev_priv->profile.modeset_gem_init, 1000000));
 	seq_printf(m, "    Register driver time:               %4lldms\n",
-		   (dev_priv->profile.driver_register / 1000000));
+		   div_u64(dev_priv->profile.driver_register, 1000000));
 	seq_printf(m, "  Frambuffer device load time: %4lldms\n",
-		   (dev_priv->profile.fbdev_load / 1000000));
+		   div_u64(dev_priv->profile.fbdev_load, 1000000));
 	seq_printf(m, "  CSR firmware load time:      %4lldms\n",
-		   (dev_priv->profile.csr_load / 1000000));
+		   div_u64(dev_priv->profile.csr_load, 1000000));
 	seq_printf(m, "  Initial mode run time:       %4lldms\n",
-		   (dev_priv->profile.initial_mode_run / 1000000));
+		   div_u64(dev_priv->profile.initial_mode_run, 1000000));
 	seq_printf(m, "  Initial mode splash init time:        %4lldms\n",
-		   (dev_priv->profile.initial_mode_init_splash / 1000000));
+		   div_u64(dev_priv->profile.initial_mode_init_splash, 1000000));
 	seq_printf(m, "  Initial mode get config time:         %4lldms\n",
-		   (dev_priv->profile.initial_mode_get_config / 1000000));
+		   div_u64(dev_priv->profile.initial_mode_get_config, 1000000));
 
 	return 0;
 }
-- 
1.7.5.4

