From 37281e14186cb54dea02c58605e5b5d8b366adb5 Mon Sep 17 00:00:00 2001
From: "Pawse, GuruprasadX" <guruprasadx.pawse@intel.com>
Date: Mon, 18 Apr 2016 18:09:41 +0530
Subject: [PATCH 1940/2508] ASoC: Intel: Skylake: Fix length in TLV get()

commit c66f29271665067aa317b8ba728ecbf7a5f1797e from
https://github.com/01org/linux-apollolake-i

The length passed to TLV get() includes 8 byte TLV header.
Ideally this length should be the actual TLV data size passed
from the kernel without the header size.

Change-Id: I84988f361068febb48a001203b02c91add2efd7e
Signed-off-by: Pawse, GuruprasadX <guruprasadx.pawse@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/8893
Reviewed-by: Babu, Ramesh <ramesh.babu@intel.com>
Tested-by: Babu, Ramesh <ramesh.babu@intel.com>
---
 sound/soc/intel/skylake/skl-topology.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/sound/soc/intel/skylake/skl-topology.c b/sound/soc/intel/skylake/skl-topology.c
index 50da959..6e37470 100644
--- a/sound/soc/intel/skylake/skl-topology.c
+++ b/sound/soc/intel/skylake/skl-topology.c
@@ -1298,7 +1298,7 @@ static int skl_tplg_tlv_control_get(struct snd_kcontrol *kcontrol,
 	if (bc->params) {
 		int ret;
 		ret = copy_to_user(data, &bc->param_id, sizeof(u32));
-		ret = copy_to_user(((unsigned char *)data) + sizeof(u32), &size, sizeof(u32));
+		ret = copy_to_user(((unsigned char *)data) + sizeof(u32), &bc->max, sizeof(u32));
 		ret = copy_to_user(((unsigned char *)data) + 2*sizeof(u32), bc->params, size - 2*sizeof(u32));
 
 		return  ret;
-- 
1.7.5.4

