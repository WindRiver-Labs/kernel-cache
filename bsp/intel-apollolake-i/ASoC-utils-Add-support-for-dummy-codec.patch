From d340a39a8f0c763a27d3fe3453f703685ea53a33 Mon Sep 17 00:00:00 2001
From: Pardha Saradhi K <pardha.saradhi.kesapragada@intel.com>
Date: Sat, 7 Nov 2015 14:18:24 +0530
Subject: [PATCH 1791/2508] ASoC: utils - Add support for dummy codec

commit 58e79d953098fe9b685cb39008051b7f347dc9af from
https://github.com/01org/linux-apollolake-i

New DAIs are added to the existing dummy codec interface to facilitate
routing of streams. This is beneficial when there are more than
one SSPs intended to be used in any platform

Change-Id: I0fb1ec9b7be6cd7a76fce9487cb5f392bf7afaa9
Signed-off-by: Pardha Saradhi K <pardha.saradhi.kesapragada@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/7583
Reviewed-by: Babu, Ramesh <ramesh.babu@intel.com>
Tested-by: Babu, Ramesh <ramesh.babu@intel.com>
---
 sound/soc/soc-utils.c |   91 +++++++++++++++++++++++++++++++++++++++---------
 1 files changed, 74 insertions(+), 17 deletions(-)

diff --git a/sound/soc/soc-utils.c b/sound/soc/soc-utils.c
index 475fe9e..0110299 100644
--- a/sound/soc/soc-utils.c
+++ b/sound/soc/soc-utils.c
@@ -124,24 +124,78 @@ static struct snd_soc_codec_driver dummy_codec = {
 			SNDRV_PCM_FMTBIT_U32_LE | \
 			SNDRV_PCM_FMTBIT_IEC958_SUBFRAME_LE)
 
-static struct snd_soc_dai_driver dummy_dai = {
-	.name = "snd-soc-dummy-dai",
-	.playback = {
-		.stream_name	= "Dummy Playback",
-		.channels_min	= 1,
-		.channels_max	= 384,
-		.rates		= STUB_RATES,
-		.formats	= STUB_FORMATS,
+static struct snd_soc_dai_driver dummy_dai[] = {
+	{
+		.name = "snd-soc-dummy-dai",
+		.playback = {
+			.stream_name	= "Dummy Playback",
+			.channels_min	= 1,
+			.channels_max	= 384,
+			.rates		= STUB_RATES,
+			.formats	= STUB_FORMATS,
+		},
+		.capture = {
+			.stream_name	= "Dummy Capture",
+			.channels_min	= 1,
+			.channels_max	= 384,
+			.rates = STUB_RATES,
+			.formats = STUB_FORMATS,
+	 	},
 	},
-	.capture = {
-		.stream_name	= "Dummy Capture",
-		.channels_min	= 1,
-		.channels_max	= 384,
-		.rates = STUB_RATES,
-		.formats = STUB_FORMATS,
-	 },
-};
+	{
+		.name = "snd-soc-dummy-dai1",
+		.playback = {
+			.stream_name	= "Dummy Playback1",
+			.channels_min	= 1,
+			.channels_max	= 384,
+			.rates		= STUB_RATES,
+			.formats	= STUB_FORMATS,
+		},
+		.capture = {
+			.stream_name	= "Dummy Capture1",
+			.channels_min	= 1,
+			.channels_max	= 384,
+			.rates = STUB_RATES,
+			.formats = STUB_FORMATS,
+		},
+	},
+        {
+                .name = "snd-soc-dummy-dai2",
+                .playback = {
+                        .stream_name    = "Dummy Playback2",
+                        .channels_min   = 1,
+                        .channels_max   = 384,
+                        .rates          = STUB_RATES,
+                        .formats        = STUB_FORMATS,
+                },
+                .capture = {
+                        .stream_name    = "Dummy Capture2",
+                        .channels_min   = 1,
+                        .channels_max   = 384,
+                        .rates = STUB_RATES,
+                        .formats = STUB_FORMATS,
+                },
+        },
+        {
+                .name = "snd-soc-dummy-dai3",
+                .playback = {
+                        .stream_name    = "Dummy Playback3",
+                        .channels_min   = 1,
+                        .channels_max   = 384,
+                        .rates          = STUB_RATES,
+                        .formats        = STUB_FORMATS,
+                },
+                .capture = {
+                        .stream_name    = "Dummy Capture3",
+                        .channels_min   = 1,
+                        .channels_max   = 384,
+                        .rates = STUB_RATES,
+                        .formats = STUB_FORMATS,
+                },
+        },
 
+
+};
 int snd_soc_dai_is_dummy(struct snd_soc_dai *dai)
 {
 	if (dai->driver == &dummy_dai)
@@ -153,7 +207,10 @@ static int snd_soc_dummy_probe(struct platform_device *pdev)
 {
 	int ret;
 
-	ret = snd_soc_register_codec(&pdev->dev, &dummy_codec, &dummy_dai, 1);
+	ret = snd_soc_register_codec(&pdev->dev,
+				&dummy_codec,
+				dummy_dai,
+				ARRAY_SIZE(dummy_dai));
 	if (ret < 0)
 		return ret;
 
-- 
1.7.5.4

