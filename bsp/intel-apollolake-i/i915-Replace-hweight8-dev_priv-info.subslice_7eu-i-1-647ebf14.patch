From b592f5b2d32509c55cf4614a83dda6f0a882c77b Mon Sep 17 00:00:00 2001
From: Zeng Zhaoxiu <zhaoxiu.zeng@gmail.com>
Date: Mon, 8 Feb 2016 15:24:21 -0800
Subject: [PATCH 1965/4706] i915: Replace
 "hweight8(dev_priv->info.subslice_7eu[i]) != 1"
 with
 "!is_power_of_2(dev_priv->info.subslice_7eu[i])"

commit d2db0bb40639e2989fc2637559e694cd7548f1a5 from
git://git.yoctoproject.org/linux-yocto-4.1

Signed-off-by: Zeng Zhaoxiu <zhaoxiu.zeng@gmail.com>
Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>
Link: http://patchwork.freedesktop.org/patch/msgid/1449397590-14292-1-git-send-email-zhaoxiu.zeng@gmail.com
(cherry picked from commit a4d8a0fe4500b87817eebdb363c116922de87453)
Signed-off-by: Matt Roper <matthew.d.roper@intel.com>
---
 drivers/gpu/drm/i915/intel_ringbuffer.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/drivers/gpu/drm/i915/intel_ringbuffer.c b/drivers/gpu/drm/i915/intel_ringbuffer.c
index 57d78f2..e5359eb 100644
--- a/drivers/gpu/drm/i915/intel_ringbuffer.c
+++ b/drivers/gpu/drm/i915/intel_ringbuffer.c
@@ -27,6 +27,7 @@
  *
  */
 
+#include <linux/log2.h>
 #include <drm/drmP.h>
 #include "i915_drv.h"
 #include <drm/i915_drm.h>
@@ -995,7 +996,7 @@ static int skl_tune_iz_hashing(struct intel_engine_cs *ring)
 		 * Only consider slices where one, and only one, subslice has 7
 		 * EUs
 		 */
-		if (hweight8(dev_priv->info.subslice_7eu[i]) != 1)
+		if (!is_power_of_2(dev_priv->info.subslice_7eu[i]))
 			continue;
 
 		/*
-- 
1.7.5.4

