From 4afa24d12f9cf627937ccda5fd2aaeff56d4c1dc Mon Sep 17 00:00:00 2001
From: Kranthi G <gudishax.kranthikumar@intel.com>
Date: Mon, 16 Nov 2015 15:33:51 +0530
Subject: [PATCH 1800/2508] ASoC: Intel: Skylake: BT Loop Changes

commit 59996b5cfc4f15b78176a64b2421019c1f2f2df6 from
https://github.com/01org/linux-apollolake-i

Change-Id: I63b91d8adc5ecac2f4248e2535a92a35fdc1ec71
Signed-off-by: Kranthi G <gudishax.kranthikumar@intel.com>
Reviewed-on: https://git-gar-1.devtools.intel.com/gerrit/7532
Reviewed-by: Babu, Ramesh <ramesh.babu@intel.com>
Tested-by: Babu, Ramesh <ramesh.babu@intel.com>
---
 sound/soc/intel/boards/mrgfld_dpcm_florida.c |   51 +++++++++++++++++++++++---
 1 files changed, 45 insertions(+), 6 deletions(-)

diff --git a/sound/soc/intel/boards/mrgfld_dpcm_florida.c b/sound/soc/intel/boards/mrgfld_dpcm_florida.c
index 986c54d..b9dfa1e 100644
--- a/sound/soc/intel/boards/mrgfld_dpcm_florida.c
+++ b/sound/soc/intel/boards/mrgfld_dpcm_florida.c
@@ -83,12 +83,31 @@ static const struct snd_soc_pcm_stream bxtn_florida_dai_params_modem = {
 	.channels_min = 1,
 	.channels_max = 1,
 };
-static const struct snd_soc_pcm_stream bxtn_florida_dai_params_bt = {
-	.formats = SNDRV_PCM_FMTBIT_S16_LE,
-	.rate_min = 48000,
-	.rate_max = 48000,
-	.channels_min = 2,
-	.channels_max = 2,
+static const struct snd_soc_pcm_stream bxtn_florida_dai_params_bt[] = {
+	{
+		.stream_name = "A2DP",
+		.formats = SNDRV_PCM_FMTBIT_S16_LE,
+		.rate_min = 48000,
+		.rate_max = 48000,
+		.channels_min = 2,
+		.channels_max = 2,
+	},
+	{
+		.stream_name = "Wide Band",
+		.formats = SNDRV_PCM_FMTBIT_S16_LE,
+		.rate_min = 16000,
+		.rate_max = 16000,
+		.channels_min = 1,
+		.channels_max = 1,
+	},
+	{
+		.stream_name = "Narrow Band",
+		.formats = SNDRV_PCM_FMTBIT_S16_LE,
+		.rate_min = 8000,
+		.rate_max = 8000,
+		.channels_min = 1,
+		.channels_max = 1,
+	},
 };
 
 /* set_osc_clk0-	enable/disables the osc clock0
@@ -315,6 +334,13 @@ static const struct snd_soc_dapm_route mrgfld_wm5110_map[] = {
 	{ "modem0_in", NULL, "ssp3 Rx" },
 	{ "ssp3 Rx", NULL, "Dummy Capture" },
 
+	/* Bt Path */
+	{ "Dummy Playback", NULL, "ssp1 Tx"},
+	{ "ssp1 Tx", NULL, "bt_out"},
+
+	{ "bt_in", NULL, "ssp1 Rx" },
+	{ "ssp1 Rx", NULL, "Dummy Capture" },
+
 	{"Headphones", NULL, "Platform Clock"},
 	{"AMIC", NULL, "Platform Clock"},
 	{"DMIC", NULL, "Platform Clock"},
@@ -590,6 +616,19 @@ struct snd_soc_dai_link mrgfld_florida_msic_dailink[] = {
 		.ops = &mrgfld_florida_ops,
 	},
 
+	{
+		.name = "Bxtn BTFM-Loop Port",
+		.stream_name = "Bxtn BTFM-Loop",
+		.cpu_dai_name = "SSP1 Pin",
+		.platform_name = "0000:00:0e.0",
+		.codec_dai_name = "snd-soc-dummy-dai",
+		.codec_name = "snd-soc-dummy",
+		.params = &bxtn_florida_dai_params_bt,
+		.num_params = ARRAY_SIZE(bxtn_florida_dai_params_bt),
+		.dsp_loopback = true,
+	},
+
+
 	/* back ends */
 	{
 		.name = "SSP0-Codec",
-- 
1.7.5.4

