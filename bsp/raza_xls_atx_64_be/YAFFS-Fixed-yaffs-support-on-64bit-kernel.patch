From b07e764a3c45ed258694d400face0fd567b078c3 Mon Sep 17 00:00:00 2001
From: Liu Changhui <changhui.liu@windriver.com>
Date: Fri, 29 Jan 2010 13:28:12 +0800
Subject: [PATCH] YAFFS: Fixed yaffs support on 64bit kernel

Yaffs file system could not be mounted on rmi XLS 64bit kernel, because the
function yaffs_CheckStruct will return a error value while yaffs_Tnode's width
is not equal to 32. in fact, the yaffs file system could work well on rmi XLS
 64 bit kernel without this function.

Signed-off-by: shuo.kang <shuo.kang@windriver.com>
---
 fs/yaffs2/yaffs_guts.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/fs/yaffs2/yaffs_guts.c b/fs/yaffs2/yaffs_guts.c
index 223f2c1..4fd746d 100644
--- a/fs/yaffs2/yaffs_guts.c
+++ b/fs/yaffs2/yaffs_guts.c
@@ -7549,8 +7549,12 @@ static int yaffs_CheckStructures(void)
 /*      yaffs_CheckStruct(yaffs_TagsUnion,8,"yaffs_TagsUnion"); */
 /*      yaffs_CheckStruct(yaffs_Spare,16,"yaffs_Spare"); */
 #ifndef CONFIG_YAFFS_TNODE_LIST_DEBUG
+#if defined(CONFIG_RMI_PHOENIX) && defined(CONFIG_64BIT)
+	
+#else
 	yaffs_CheckStruct(yaffs_Tnode, 2 * YAFFS_NTNODES_LEVEL0, "yaffs_Tnode");
 #endif
+#endif
 #ifndef CONFIG_YAFFS_WINCE
 		yaffs_CheckStruct(yaffs_ObjectHeader, 512, "yaffs_ObjectHeader");
 #endif
-- 
1.6.0.4

