From a494ef9a77485c0fd0f5229eb534a46e601cd8de Mon Sep 17 00:00:00 2001
From: Thomas Tai <thomas.tai@windriver.com>
Date: Wed, 29 Apr 2009 10:30:21 -0400
Subject: [PATCH] mpc8536ds: Add NOR flash and NAND flash to device tree

mpc8536ds have 128M NOR and 4G NAND flash. Add to device tree
so that MTD driver can make use of those flash. NOR flash is
mapped to (0xe8000000 - 0xefffffff). NAND flash is mapped to
(0xffa00000 - 0xffafffff).

Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 arch/powerpc/boot/dts/mpc8536ds.dts |   38 +++++++++++++++++++++++++++++++++++
 1 files changed, 38 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/boot/dts/mpc8536ds.dts b/arch/powerpc/boot/dts/mpc8536ds.dts
index a405c66..2e8d890 100644
--- a/arch/powerpc/boot/dts/mpc8536ds.dts
+++ b/arch/powerpc/boot/dts/mpc8536ds.dts
@@ -45,6 +45,44 @@
 		reg = <00000000 00000000>;	// Filled by U-Boot
 	};
 
+	localbus@ffe05000{
+		#address-cells = <2>;
+		#size-cells = <1>;
+		compatible = "simple-bus", "fsl,elbc";
+		reg = <0xffe05000 0x1000>;
+		interrupts = <19 8>;
+		interrupt-parent = <&mpic>;
+
+		ranges = <0 0x0 0xe8000000 0x8000000
+			  1 0x0 0xffa00000 0x100000>;
+
+		norflash@0,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
+			compatible = "amd", "cfi-flash";
+			reg = <0 0x0 0x8000000>;
+			bank-width = <2>;
+			partition@0x0 {
+				label = "NOR flash boot rom";
+				reg = <0x0 0x8000000>;
+				read-only;
+			};
+		};
+
+		nandflash@1,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
+			compatible = "fsl,elbc-fcm-nand";
+			reg = <1 0x0 0x100000>;
+
+			partition@0{
+				label = "NAND flash boot rom";
+				reg = <0x0 0x100000>;
+				read-only;
+			};
+		};
+	};
+
 	soc@ffe00000 {
 		#address-cells = <1>;
 		#size-cells = <1>;
-- 
1.6.0.4

