From e017ad93d0b9bc229af81dd38ffca81183c8a9c0 Mon Sep 17 00:00:00 2001
From: Thomas Tai <thomas.tai@windriver.com>
Date: Thu, 4 Jun 2009 09:48:29 -0400
Subject: [PATCH 14/15] mpc8536ds: correct epsi baud rate generator frequency

epsi baud rate generator was incorrectly set to 1x system
clock frequency. The correct frequency should have been 1/2
of the system clock frequency. This value is documented in
"MPC8536E PowerQUICC III Integrated Processor Reference
Manual" and is also found in the latest freescale BSP release.

Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 drivers/spi/fsl_espi.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/spi/fsl_espi.c b/drivers/spi/fsl_espi.c
index 1c1874d..178f757 100644
--- a/drivers/spi/fsl_espi.c
+++ b/drivers/spi/fsl_espi.c
@@ -484,7 +484,7 @@ static int __init fsl_espi_probe(struct platform_device *dev)
 	fsl_espi->deactivate_cs = pdata->deactivate_cs;
 	fsl_espi->get_rx = fsl_espi_rx_buf_u32;
 	fsl_espi->get_tx = fsl_espi_tx_buf_u32;
-	fsl_espi->spibrg = pdata->sysclk;
+	fsl_espi->spibrg = pdata->sysclk/2;
 
 	fsl_espi->rx_shift = 0;
 	fsl_espi->tx_shift = 0;
-- 
1.6.3.1

