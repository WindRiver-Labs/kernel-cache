From 96dfb25440e5f3175c2e002ce7b77d920d9b1926 Mon Sep 17 00:00:00 2001
From: czou <cao.zou@windriver.com>
Date: Wed, 18 Nov 2015 18:38:47 +0800
Subject: [PATCH 70/70] ls1021-iot: workaround multiple interrupts when
 pluging hdmi

there are multiple interrupts of hdmi dectect when pluging hdmi,
when sii902x receive the second interrupt of pluging, it will
poweroff the hdmi, it is wrong, here add a workaroud to ignore
this error interrupt

Signed-off-by: czou <cao.zou@windriver.com>
---
 drivers/video/fsl-sii902x.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/video/fsl-sii902x.c b/drivers/video/fsl-sii902x.c
index 5adf608..9770b12 100644
--- a/drivers/video/fsl-sii902x.c
+++ b/drivers/video/fsl-sii902x.c
@@ -282,6 +282,10 @@ static void det_worker(struct work_struct *work)
 	if (!(val & 0x1) && !g_enable_hdmi)
 		goto err;
 
+	/* workaround multiple interrupts when pluging hdmi */
+	if (sii902x->cable_plugin)
+		goto err;
+
 	/* cable connection changes */
 	if (val & SII902X_TPI_INT_PLUG_IN || g_enable_hdmi) {
 		sii902x->cable_plugin = 1;
-- 
1.7.5.4

