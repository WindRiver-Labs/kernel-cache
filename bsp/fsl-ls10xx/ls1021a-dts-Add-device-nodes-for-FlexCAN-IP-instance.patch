From 6b65333fed9aaf317e1d5ed6207f8d8a542d0045 Mon Sep 17 00:00:00 2001
From: Bhupesh Sharma <bhupesh.sharma@freescale.com>
Date: Thu, 15 May 2014 13:17:11 +0530
Subject: [PATCH 105/255] ls1021a/dts: Add device nodes for FlexCAN IP
 instances

This patch adds the device nodes for 4 FlexCAN IP instances
available on LS1021A SoC in the ls1021a.dtsi file and enables
only the first two instances which are supported on the QDS
board in ls1021a-qds.dts file.

Signed-off-by: Bhupesh Sharma <bhupesh.sharma@freescale.com>
[Kevin: Original patch taken from
LS1021A-SDK-V1.1-ARM-SOURCE-20140815-yocto.iso]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/arm/boot/dts/ls1021a-qds.dts |  8 ++++++++
 arch/arm/boot/dts/ls1021a.dtsi    | 40 +++++++++++++++++++++++++++++++++++++++
 2 files changed, 48 insertions(+)

diff --git a/arch/arm/boot/dts/ls1021a-qds.dts b/arch/arm/boot/dts/ls1021a-qds.dts
index 47395a7..1b213ac 100644
--- a/arch/arm/boot/dts/ls1021a-qds.dts
+++ b/arch/arm/boot/dts/ls1021a-qds.dts
@@ -349,3 +349,11 @@
 &sai2 {
 	status = "okay";
 };
+
+&can0 {
+	status = "okay";
+};
+
+&can1 {
+	status = "okay";
+};
diff --git a/arch/arm/boot/dts/ls1021a.dtsi b/arch/arm/boot/dts/ls1021a.dtsi
index 219a18c..789d053 100644
--- a/arch/arm/boot/dts/ls1021a.dtsi
+++ b/arch/arm/boot/dts/ls1021a.dtsi
@@ -623,5 +623,45 @@
 			dr_mode = "host";
 			maximum-speed = "high-speed";
 		};
+
+		can0: can@2a70000 {
+			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
+			reg = <0x2a70000 0x1000>;
+			interrupts = <0 126 0x04>;
+			clocks = <&platform_clk 1>;
+			clock-names = "ipg";
+			big-endian;
+			status = "disabled";
+		};
+
+		can1: can@2a80000 {
+			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
+			reg = <0x2a80000 0x1000>;
+			interrupts = <0 127 0x04>;
+			clocks = <&platform_clk 1>;
+			clock-names = "ipg";
+			big-endian;
+			status = "disabled";
+		};
+
+		can2: can@2a90000 {
+			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
+			reg = <0x2a90000 0x1000>;
+			interrupts = <0 128 0x04>;
+			clocks = <&platform_clk 1>;
+			clock-names = "ipg";
+			big-endian;
+			status = "disabled";
+		};
+
+		can3: can@2aa0000 {
+			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
+			reg = <0x2aa0000 0x1000>;
+			interrupts = <0 129 0x04>;
+			clocks = <&platform_clk 1>;
+			clock-names = "ipg";
+			big-endian;
+			status = "disabled";
+		};
 	};
 };
-- 
2.0.2

