From 730733e8d32e67b5c96ffd02df01c955b1246da9 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Sun, 28 Sep 2014 15:36:16 +0800
Subject: [PATCH 2/2] crypto: caam: fix the build warning when overriding
 set/clrbits32 macros

The macro set/clrbits32 macros are used different in caam driver
compare to other drivers in the kernel. So we need to override
the definitions of them in the header file of caam driver. Unset
them first before overriding to fix the following build warnings:

In file included from drivers/crypto/caam/jr.c:12:0:
drivers/crypto/caam/regs.h:88:0: warning: "setbits32" redefined
 #define setbits32(_addr, _v) writel((readl(_addr) | (_v)), (_addr))
 ^
In file included from include/linux/scatterlist.h:10:0,
                 from include/linux/dma-mapping.h:9,
                 from drivers/crypto/caam/compat.h:19,
                 from drivers/crypto/caam/jr.c:11:
arch/arm/include/asm/io.h:369:0: note: this is the location of the previous definition
 #define setbits32(_addr, _v) iowrite32be(ioread32be(_addr) |  (_v), (_addr))

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/crypto/caam/regs.h | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/crypto/caam/regs.h b/drivers/crypto/caam/regs.h
index 24cfcdc..d04e1f2 100644
--- a/drivers/crypto/caam/regs.h
+++ b/drivers/crypto/caam/regs.h
@@ -85,6 +85,8 @@
 
 #ifdef __LITTLE_ENDIAN
 /* These are common macros for Power, put here for ARMs */
+#undef setbits32
+#undef clrbits32
 #define setbits32(_addr, _v) writel((readl(_addr) | (_v)), (_addr))
 #define clrbits32(_addr, _v) writel((readl(_addr) & ~(_v)), (_addr))
 #endif
-- 
2.0.2

