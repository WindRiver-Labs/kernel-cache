From c6a31f85a4c5a392200239fe1e76290900d2feae Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Thu, 13 Nov 2014 17:19:39 +0800
Subject: [PATCH] PCI: layerscape: set IRQF_NO_THREAD for the msi irq handler

The irq handler for the cascaded irqchip can't be threaded.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/pci/host/pcie-layerscape.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/pci/host/pcie-layerscape.c b/drivers/pci/host/pcie-layerscape.c
index 7e3f1f4..b6a4a2e 100644
--- a/drivers/pci/host/pcie-layerscape.c
+++ b/drivers/pci/host/pcie-layerscape.c
@@ -450,7 +450,7 @@ static int ls_pcie_enable_msi(struct ls_pcie *pcie)
 		return -ENOMEM;
 	}
 
-	err = request_irq(msi->chip_irq, ls_pcie_msi_irq, 0,
+	err = request_irq(msi->chip_irq, ls_pcie_msi_irq, IRQF_NO_THREAD,
 			  msi->name, pcie);
 	if (err < 0) {
 		dev_err(&pdev->dev, "failed to request IRQ: %d\n", err);
-- 
1.7.5.4

