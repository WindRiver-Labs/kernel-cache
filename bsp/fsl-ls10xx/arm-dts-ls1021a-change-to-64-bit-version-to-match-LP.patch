From e03bc031d6ed20511f06b99def9493b68a6e7de3 Mon Sep 17 00:00:00 2001
From: Jingchang Lu <jingchang.lu@freescale.com>
Date: Thu, 29 May 2014 14:42:43 +0800
Subject: [PATCH 130/255] arm: dts: ls1021a: change to 64-bit version to match
 LPAE address space

This also uses the GIC type macro and IRQ_TYPE_LEVEL_HIGH/IRQ_TYPE_NONE
to replace the hardcode value.

Signed-off-by: Jingchang Lu <jingchang.lu@freescale.com>
[Kevin: Original patch taken from
LS1021A-SDK-V1.1-ARM-SOURCE-20140815-yocto.iso]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/arm/boot/dts/ls1021a.dtsi | 320 ++++++++++++++++++++++++-----------------
 1 file changed, 187 insertions(+), 133 deletions(-)

diff --git a/arch/arm/boot/dts/ls1021a.dtsi b/arch/arm/boot/dts/ls1021a.dtsi
index 1f46079..04c7458 100644
--- a/arch/arm/boot/dts/ls1021a.dtsi
+++ b/arch/arm/boot/dts/ls1021a.dtsi
@@ -7,12 +7,14 @@
  * (at your option) any later version.
  */
 
-#include "skeleton.dtsi"
+#include "skeleton64.dtsi"
 #include <dt-bindings/interrupt-controller/arm-gic.h>
 
 / {
 	compatible = "fsl,ls1021a";
 	interrupt-parent = <&gic>;
+	#address-cells = <2>;
+	#size-cells = <2>;
 
 	aliases {
 		serial0 = &lpuart0;
@@ -31,7 +33,7 @@
 	};
 
 	memory {
-		reg = <0x80000000 0x20000000>;
+		reg = <0x0 0x80000000 0x0 0x20000000>;
 	};
 
 	cpus {
@@ -53,20 +55,22 @@
 
 	timer {
 		compatible = "arm,armv7-timer";
-		interrupts = 	<GIC_PPI 13 0xf08>,
-				<GIC_PPI 14 0xf08>,
-				<GIC_PPI 11 0xf08>,
-				<GIC_PPI 10 0xf08>;
+		interrupts = 	<GIC_PPI 13 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_LOW)>,
+				<GIC_PPI 14 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_LOW)>,
+				<GIC_PPI 11 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_LOW)>,
+				<GIC_PPI 10 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_LOW)>;
+
 	};
 
 	pmu {
 		compatible = "arm,cortex-a7-pmu";
-		interrupts = <0 138 0x04>, <0 139 0x04>;
+		interrupts = <GIC_SPI 138 IRQ_TYPE_LEVEL_HIGH>,
+				<GIC_SPI 139 IRQ_TYPE_LEVEL_HIGH>;
 	};
 
 	soc {
-		#address-cells = <1>;
-		#size-cells = <1>;
+		#address-cells = <2>;
+		#size-cells = <2>;
 		compatible = "simple-bus";
 		interrupt-parent = <&gic>;
 		ranges;
@@ -75,44 +79,45 @@
 			compatible = "arm,cortex-a15-gic";
 			#interrupt-cells = <3>;
 			interrupt-controller;
-			reg = <0x1401000 0x1000>,
-				<0x1402000 0x1000>,
-				<0x1404000 0x2000>,
-				<0x1406000 0x2000>;
-			interrupts = <GIC_PPI 9 0x304>;
+			reg = <0x0 0x1401000 0x0 0x1000>,
+				<0x0 0x1402000 0x0 0x1000>,
+				<0x0 0x1404000 0x0 0x2000>,
+				<0x0 0x1406000 0x0 0x2000>;
+			interrupts = <GIC_PPI 9 (GIC_CPU_MASK_SIMPLE(2) | IRQ_TYPE_LEVEL_HIGH)>;
+
 		};
 
 		tzasc: tzasc@1500000 {
-			reg = <0x1500000 0x10000>;
-			interrupts = <0 125 0x04>;
+			reg = <0x0 0x1500000 0x0 0x10000>;
+			interrupts = <GIC_SPI 125 IRQ_TYPE_LEVEL_HIGH>;
 			status = "disabled";
 		};
 
 		ifc: ifc@1530000 {
 			compatible = "fsl,ls1021a-ifc", "fsl,ifc", "simple-bus";
-			reg = <0x1530000 0x10000>;
-			interrupts = <0 75 0x04>;
+			reg = <0x0 0x1530000 0x0 0x10000>;
+			interrupts = <GIC_SPI 75 IRQ_TYPE_LEVEL_HIGH>;
 		};
 
 		dcfg: dcfg@1ee0000 {
 			compatible = "fsl,ls1021a-dcfg";
-			reg = <0x1ee0000 0x10000>;
+			reg = <0x0 0x1ee0000 0x0 0x10000>;
 		};
 
 		qspi: quadspi@1550000 {
 			#address-cells = <1>;
 			#size-cells = <0>;
 			compatible = "fsl,vf610-qspi";
-			reg = <0x1550000 0x10000>;
-			interrupts = <0 131 0x04>;
+			reg = <0x0 0x1550000 0x0 0x10000>;
+			interrupts = <GIC_SPI 131 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "qspi_en", "qspi";
 			status = "disabled";
 		};
 
 		esdhc: esdhc@1560000 {
 			compatible = "fsl,ls1021a-esdhc", "fsl,esdhc";
-			reg = <0x1560000 0x10000>;
-			interrupts = <0 94 0x04>;
+			reg = <0x0 0x1560000 0x0 0x10000>;
+			interrupts = <GIC_SPI 94 IRQ_TYPE_LEVEL_HIGH>;
 			clock-frequency = <0>;
 			voltage-ranges = <1800 1800 3300 3300>;
 			sdhci,auto-cmd12;
@@ -123,7 +128,7 @@
 
 		scfg: scfg@1570000 {
 			compatible = "fsl,ls1021a-scfg";
-			reg = <0x1570000 0x10000>;
+			reg = <0x0 0x1570000 0x0 0x10000>;
 		};
 
 		crypto: crypto@1700000 {
@@ -131,16 +136,16 @@
 			fsl,sec-era = <4>;
 			#address-cells = <1>;
 			#size-cells = <1>;
-			reg		 = <0x1700000 0x100000>;
-			ranges		 = <0 0x1700000 0x100000>;
-			interrupts	 = <0 107 0x04>;
+			reg		 = <0x0 0x1700000 0x0 0x100000>;
+			ranges		 = <0x0 0x0 0x1700000 0x100000>;
+			interrupts	 = <GIC_SPI 107 IRQ_TYPE_LEVEL_HIGH>;
 
 			sec_jr0: jr@10000 {
 				compatible = "fsl,sec-v5.3-job-ring",
 				     "fsl,sec-v5.0-job-ring",
 				     "fsl,sec-v4.0-job-ring";
 				reg = <0x10000 0x10000>;
-				interrupts = <0 103 0x04>;
+				interrupts = <GIC_SPI 103 IRQ_TYPE_LEVEL_HIGH>;
 			};
 
 			sec_jr1: jr@20000 {
@@ -148,7 +153,7 @@
 				     "fsl,sec-v5.0-job-ring",
 				     "fsl,sec-v4.0-job-ring";
 				reg = <0x20000 0x10000>;
-				interrupts = <0 104 0x04>;
+				interrupts = <GIC_SPI 104 IRQ_TYPE_LEVEL_HIGH>;
 			};
 
 			sec_jr2: jr@30000 {
@@ -156,7 +161,7 @@
 				     "fsl,sec-v5.0-job-ring",
 				     "fsl,sec-v4.0-job-ring";
 				reg = <0x30000 0x10000>;
-				interrupts = <0 105 0x04>;
+				interrupts = <GIC_SPI 105 IRQ_TYPE_LEVEL_HIGH>;
 			};
 
 			sec_jr3: jr@40000 {
@@ -164,29 +169,29 @@
 				     "fsl,sec-v5.0-job-ring",
 				     "fsl,sec-v4.0-job-ring";
 				reg = <0x40000 0x10000>;
-				interrupts = <0 106 0x04>;
+				interrupts = <GIC_SPI 106 IRQ_TYPE_LEVEL_HIGH>;
 			};
 
 		};
 
 		sfp: sfp@1e80000 {
-			reg = <0x1e80000 0x10000>;
+			reg = <0x0 0x1e80000 0x0 0x10000>;
 			status = "disabled";
 		};
 
 		snvs: snvs@1e90000 {
-			reg = <0x1e90000 0x10000>;
+			reg = <0x0 0x1e90000 0x0 0x10000>;
 			status = "disabled";
 		};
 
 		serdes1: serdes1@1ea0000 {
-			reg = <0x1ea0000 0x10000>;
+			reg = <0x0 0x1ea0000 0x0 0x10000>;
 			status = "disabled";
 		};
 
 		clockgen: clocking@1ee1000 {
 			compatible = "fsl,ls1021a-clockgen";
-			reg = <0x1ee1000 0x10000>;
+			reg = <0x0 0x1ee1000 0x0 0x10000>;
 			#address-cells = <1>;
 			#size-cells = <0>;
 			sysclk: sysclk {
@@ -236,7 +241,7 @@
 		};
 
 		rcpm: rcpm@1ee2000 {
-			reg = <0x1ee2000 0x10000>;
+			reg = <0x0 0x1ee2000 0x0 0x10000>;
 			status = "disabled";
 		};
 
@@ -244,8 +249,8 @@
 			#address-cells = <1>;
 			#size-cells = <0>;
 			compatible = "fsl,vf610-dspi";
-			reg = <0x2100000 0x10000>;
-			interrupts = <0 96 0x04>;
+			reg = <0x0 0x2100000 0x0 0x10000>;
+			interrupts = <GIC_SPI 96 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "dspi";
 			clocks = <&platform_clk 1>;
 			spi-num-chipselects = <5>;
@@ -257,8 +262,8 @@
 			#address-cells = <1>;
 			#size-cells = <0>;
 			compatible = "fsl,vf610-dspi";
-			reg = <0x2110000 0x10000>;
-			interrupts = <0 97 0x04>;
+			reg = <0x0 0x2110000 0x0 0x10000>;
+			interrupts = <GIC_SPI 97 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "dspi";
 			clocks = <&platform_clk 1>;
 			spi-num-chipselects = <5>;
@@ -270,8 +275,8 @@
 			#address-cells = <1>;
 			#size-cells = <0>;
 			compatible = "fsl,vf610-i2c";
-			reg = <0x2180000 0x10000>;
-			interrupts =<0 88 0x04>;
+			reg = <0x0 0x2180000 0x0 0x10000>;
+			interrupts = <GIC_SPI 88 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "i2c";
 			clocks = <&platform_clk 1>;
 			dmas = <&edma0 1 39>,
@@ -284,8 +289,8 @@
 			#address-cells = <1>;
 			#size-cells = <0>;
 			compatible = "fsl,vf610-i2c";
-			reg = <0x2190000 0x10000>;
-			interrupts = <0 89 0x04>;
+			reg = <0x0 0x2190000 0x0 0x10000>;
+			interrupts = <GIC_SPI 89 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "i2c";
 			clocks = <&platform_clk 1>;
 			status = "disabled";
@@ -295,8 +300,8 @@
 			#address-cells = <1>;
 			#size-cells = <0>;
 			compatible = "fsl,vf610-i2c";
-			reg = <0x21a0000 0x10000>;
-			interrupts = <0 90 0x04>;
+			reg = <0x0 0x21a0000 0x0 0x10000>;
+			interrupts = <GIC_SPI 90 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "i2c";
 			clocks = <&platform_clk 1>;
 			status = "disabled";
@@ -304,40 +309,40 @@
 
 		duart0: serial@21c0500 {
 			compatible = "ns16550";
-			reg = <0x21c0500 0x100>;
-			interrupts = <0 86 0x04>;
+			reg = <0x0 0x21c0500 0x0 0x100>;
+			interrupts = <GIC_SPI 86 IRQ_TYPE_LEVEL_HIGH>;
 			clock-frequency = <0>;
 			status = "disabled";
 		};
 
 		duart1: serial@21c0600 {
 			compatible = "ns16550";
-			reg = <0x21c0600 0x100>;
-			interrupts = <0 86 0x04>;
+			reg = <0x0 0x21c0600 0x0 0x100>;
+			interrupts = <GIC_SPI 86 IRQ_TYPE_LEVEL_HIGH>;
 			clock-frequency = <0>;
 			status = "disabled";
 		};
 
 		duart2: serial@21d0500 {
 			compatible = "ns16550";
-			reg = <0x21d0500 0x100>;
-			interrupts = <0 87 0x04>;
+			reg = <0x0 0x21d0500 0x0 0x100>;
+			interrupts = <GIC_SPI 87 IRQ_TYPE_LEVEL_HIGH>;
 			clock-frequency = <0>;
 			status = "disabled";
 		};
 
 		duart3: serial@21d0600 {
 			compatible = "ns16550";
-			reg = <0x21d0600 0x100>;
-			interrupts = <0 87 0x04>;
+			reg = <0x0 0x21d0600 0x0 0x100>;
+			interrupts = <GIC_SPI 87 IRQ_TYPE_LEVEL_HIGH>;
 			clock-frequency = <0>;
 			status = "disabled";
 		};
 
 		gpio1: gpio@2300000 {
 			compatible = "fsl,ls1021a-gpio";
-			reg = <0x2300000 0x10000>;
-			interrupts = <0 98 0x04>;
+			reg = <0x0 0x2300000 0x0 0x10000>;
+			interrupts = <GIC_SPI 98 IRQ_TYPE_LEVEL_HIGH>;
 			gpio-controller;
 			#gpio-cells = <2>;
 			interrupt-controller;
@@ -346,8 +351,8 @@
 
 		gpio2: gpio@2310000 {
 			compatible = "fsl,ls1021a-gpio";
-			reg = <0x2310000 0x10000>;
-			interrupts = <0 99 0x04>;
+			reg = <0x0 0x2310000 0x0 0x10000>;
+			interrupts = <GIC_SPI 99 IRQ_TYPE_LEVEL_HIGH>;
 			gpio-controller;
 			#gpio-cells = <2>;
 			interrupt-controller;
@@ -356,8 +361,8 @@
 
 		gpio3: gpio@2320000 {
 			compatible = "fsl,ls1021a-gpio";
-			reg = <0x2320000 0x10000>;
-			interrupts = <0 100 0x04>;
+			reg = <0x0 0x2320000 0x0 0x10000>;
+			interrupts = <GIC_SPI 100 IRQ_TYPE_LEVEL_HIGH>;
 			gpio-controller;
 			#gpio-cells = <2>;
 			interrupt-controller;
@@ -366,8 +371,8 @@
 
 		gpio4: gpio@2330000 {
 			compatible = "fsl,ls1021a-gpio";
-			reg = <0x2330000 0x10000>;
-			interrupts = <0 166 0x04>;
+			reg = <0x0 0x2330000 0x0 0x10000>;
+			interrupts = <GIC_SPI 166 IRQ_TYPE_LEVEL_HIGH>;
 			gpio-controller;
 			#gpio-cells = <2>;
 			interrupt-controller;
@@ -388,7 +393,8 @@
 				#address-cells = <0>;
 				interrupt-controller;
 				#interrupt-cells = <1>;
-				interrupts = <0 109 0x04 0 109 0x04>;
+				interrupts = <GIC_SPI 109 IRQ_TYPE_LEVEL_HIGH>,
+						< GIC_SPI 109 IRQ_TYPE_LEVEL_HIGH>;
 			};
 
 			ucc@2000 {
@@ -421,8 +427,8 @@
 
 		lpuart0: serial@2950000 {
 			compatible = "fsl,vf610-lpuart";
-			reg = <0x2950000 0x1000>;
-			interrupts = <0 80 0x04>;
+			reg = <0x0 0x2950000 0x0 0x1000>;
+			interrupts = <GIC_SPI 80 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&sysclk>;
 			clock-names = "ipg";
 			fsl,lpuart32;
@@ -431,8 +437,8 @@
 
 		lpuart1: serial@2960000 {
 			compatible = "fsl,vf610-lpuart";
-			reg = <0x2960000 0x1000>;
-			interrupts = <0 81 0x04>;
+			reg = <0x0 0x2960000 0x0 0x1000>;
+			interrupts = <GIC_SPI 81 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			fsl,lpuart32;
@@ -441,8 +447,8 @@
 
 		lpuart2: serial@2970000 {
 			compatible = "fsl,vf610-lpuart";
-			reg = <0x2970000 0x1000>;
-			interrupts = <0 82 0x04>;
+			reg = <0x0 0x2970000 0x0 0x1000>;
+			interrupts = <GIC_SPI 82 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			fsl,lpuart32;
@@ -451,8 +457,8 @@
 
 		lpuart3: serial@2980000 {
 			compatible = "fsl,vf610-lpuart";
-			reg = <0x2980000 0x1000>;
-			interrupts = <0 83 0x04>;
+			reg = <0x0 0x2980000 0x0 0x1000>;
+			interrupts = <GIC_SPI 83 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			fsl,lpuart32;
@@ -461,8 +467,8 @@
 
 		lpuart4: serial@2990000 {
 			compatible = "fsl,vf610-lpuart";
-			reg = <0x2990000 0x1000>;
-			interrupts = <0 84 0x04>;
+			reg = <0x0 0x2990000 0x0 0x1000>;
+			interrupts = <GIC_SPI 84 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			fsl,lpuart32;
@@ -471,8 +477,8 @@
 
 		lpuart5: serial@29a0000 {
 			compatible = "fsl,vf610-lpuart";
-			reg = <0x29a0000 0x1000>;
-			interrupts = <0 85 0x04>;
+			reg = <0x0 0x29a0000 0x0 0x1000>;
+			interrupts = <GIC_SPI 85 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			fsl,lpuart32;
@@ -481,8 +487,9 @@
 
 		ftm0_1: ftm0_1@29d0000 {
 			compatible = "fsl,ftm-timer";
-			reg = <0x29d0000 0x10000 0x29e0000 0x10000>;
-			interrupts = <0 118 0x04>;
+			reg = <0x0 0x29d0000 0x0 0x10000>,
+				<0x0 0x29e0000 0x0 0x10000>;
+			interrupts = <GIC_SPI 118 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "ftm-evt", "ftm-src",
 			        "ftm-evt-counter-en", "ftm-src-counter-en";
 			clocks = <&platform_clk 1>, <&platform_clk 1>,
@@ -492,34 +499,34 @@
 		};
 
 		ftm2: ftm@29f0000 {
-			reg = <0x29f0000 0x10000>;
-			interrupts = <0 120 0x04>;
+			reg = <0x0 0x29f0000 0x0 0x10000>;
+			interrupts = <GIC_SPI 120 IRQ_TYPE_LEVEL_HIGH>;
 			status = "disabled";
 		};
 
 		ftm3: ftm@2a00000 {
-			reg = <0x2a00000 0x10000>;
-			interrupts = <0 121 0x04>;
+			reg = <0x0 0x2a00000 0x0 0x10000>;
+			interrupts = <GIC_SPI 121 IRQ_TYPE_LEVEL_HIGH>;
 			status = "disabled";
 		};
 
 		ftm4: ftm@2a10000 {
-			reg = <0x2a10000 0x10000>;
-			interrupts = <0 32 0x04>;
+			reg = <0x0 0x2a10000 0x0 0x10000>;
+			interrupts = <GIC_SPI 32 IRQ_TYPE_LEVEL_HIGH>;
 			status = "disabled";
 		};
 
 		ftm5: ftm@2a20000 {
-			reg = <0x2a20000 0x10000>;
-			interrupts = <0 33 0x04>;
+			reg = <0x0 0x2a20000 0x0 0x10000>;
+			interrupts = <GIC_SPI 33 IRQ_TYPE_LEVEL_HIGH>;
 			status = "disabled";
 		};
 
 		pwm6: ftm@2a30000 {
 			compatible = "fsl,vf610-ftm-pwm";
 			#pwm-cells = <3>;
-			reg = <0x2a30000 0x10000>;
-			interrupts = <0 123 0x04>;
+			reg = <0x0 0x2a30000 0x0 0x10000>;
+			interrupts = <GIC_SPI 123 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "ftm_sys", "ftm_ext",
 				"ftm_fix", "ftm_cnt_clk_en";
 			clocks = <&platform_clk 1>, <&platform_clk 1>,
@@ -531,8 +538,8 @@
 		pwm7: ftm@2a40000 {
 			compatible = "fsl,vf610-ftm-pwm";
 			#pwm-cells = <3>;
-			reg = <0x2a40000 0x10000>;
-			interrupts = <0 124 0x04>;
+			reg = <0x0 0x2a40000 0x0 0x10000>;
+			interrupts = <GIC_SPI 124 IRQ_TYPE_LEVEL_HIGH>;
 			clock-names = "ftm_sys", "ftm_ext",
 				"ftm_fix", "ftm_cnt_clk_en";
 			clocks = <&platform_clk 1>, <&platform_clk 1>,
@@ -543,16 +550,16 @@
 
 		wdog0: wdog@2ad0000 {
 			compatible = "fsl,ls1021a-wdt", "fsl,imx21-wdt";
-			reg = <0x2ad0000 0x10000>;
-			interrupts = <0 115 0x04>;
+			reg = <0x0 0x2ad0000 0x0 0x10000>;
+			interrupts = <GIC_SPI 115 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "wdog";
 		};
 
 		sai2: sai@2b60000 {
 			compatible = "fsl,vf610-sai";
-			reg = <0x2b60000 0x10000>;
-			interrupts = <0 133 0x04>;
+			reg = <0x0 0x2b60000 0x0 0x10000>;
+			interrupts = <GIC_SPI 133 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "sai";
 			dma-names = "tx", "rx";
@@ -565,11 +572,11 @@
 		edma0: edma@2c00000 {
 			#dma-cells = <2>;
 			compatible = "fsl,vf610-edma";
-			reg = <0x2c00000 0x10000>,
-				<0x2c10000 0x10000>,
-				<0x2c20000 0x10000>;
-			interrupts = <0 135 0x04>,
-					<0 135 0x04>;
+			reg = <0x0 0x2c00000 0x0 0x10000>,
+				<0x0 0x2c10000 0x0 0x10000>,
+				<0x0 0x2c20000 0x0 0x10000>;
+			interrupts = <GIC_SPI 135 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 135 IRQ_TYPE_LEVEL_HIGH>;
 			interrupt-names = "edma-tx", "edma-err";
 			dma-channels = <32>;
 			big-endian;
@@ -580,8 +587,8 @@
 
 		dcu0: dcu@2ce0000 {
 			compatible = "fsl,vf610-dcu";
-			reg = <0x2ce000 0x10000>;
-			interrupts = <0 172 0x04>;
+			reg = <0x0 0x2ce000 0x0 0x10000>;
+			interrupts = <GIC_SPI 172 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "dcu";
 			big-endian;
@@ -593,7 +600,7 @@
 			#size-cells = <0>;
 			device_type = "mdio";
 			compatible = "gianfar";
-			reg = <0x2d24000 0x4000>;
+			reg = <0x0 0x2d24000 0x0 0x4000>;
 			tbi0: tbi-phy@8 {
 				reg = <0x8>;
 				device_type = "tbi-phy";
@@ -601,8 +608,8 @@
 		};
 
 		enet0: ethernet@2d10000 {
-			#address-cells = <1>;
-			#size-cells = <1>;
+			#address-cells = <2>;
+			#size-cells = <2>;
 			interrupt-parent = <&gic>;
 			device_type = "network";
 			model = "eTSEC";
@@ -615,19 +622,19 @@
 			queue-group@0 {
 				#address-cells = <1>;
 				#size-cells = <1>;
-				reg = <0x2d10000 0x8000>;
+				reg = <0x0 0x2d10000 0x0 0x8000>;
 				fsl,rx-bit-map = <0xff>;
 				fsl,tx-bit-map = <0xff>;
-				interrupts = <0 144 0x04>,
-					<0 145 0x04>,
-					<0 146 0x04>;
+				interrupts = <GIC_SPI 144 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 145 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 146 IRQ_TYPE_LEVEL_HIGH>;
 			};
 
 		};
 
 		enet1: ethernet@2d50000 {
-			#address-cells = <1>;
-			#size-cells = <1>;
+			#address-cells = <2>;
+			#size-cells = <2>;
 			interrupt-parent = <&gic>;
 			device_type = "network";
 			model = "eTSEC";
@@ -640,19 +647,19 @@
 			queue-group@0 {
 				#address-cells = <1>;
 				#size-cells = <1>;
-				reg = <0x2d50000 0x8000>;
+				reg = <0x0 0x2d50000 0x0 0x8000>;
 				fsl,rx-bit-map = <0xff>;
 				fsl,tx-bit-map = <0xff>;
-				interrupts = <0 150 0x04>,
-					<0 152 0x04>,
-					<0 153 0x04>;
+				interrupts = <GIC_SPI 150 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 152 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 153 IRQ_TYPE_LEVEL_HIGH>;
 			};
 
 		};
 
 		enet2: ethernet@2d90000 {
-			#address-cells = <1>;
-			#size-cells = <1>;
+			#address-cells = <2>;
+			#size-cells = <2>;
 			interrupt-parent = <&gic>;
 			device_type = "network";
 			model = "eTSEC";
@@ -665,32 +672,32 @@
 			queue-group@0 {
 				#address-cells = <1>;
 				#size-cells = <1>;
-				reg = <0x2d90000 0x8000>;
+				reg = <0x0 0x2d90000 0x0 0x8000>;
 				fsl,rx-bit-map = <0xff>;
 				fsl,tx-bit-map = <0xff>;
-				interrupts = <0 157 0x04>,
-					<0 158 0x04>,
-					<0 159 0x04>;
+				interrupts = <GIC_SPI 157 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 158 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 159 IRQ_TYPE_LEVEL_HIGH>;
 			};
 		};
 
 		usb@8600000 {
 			compatible = "fsl-usb2-dr-v1.6", "fsl-usb2-dr";
-			reg = <0x8600000 0x1000>;
+			reg = <0x0 0x8600000 0x0 0x1000>;
 			#address-cells = <1>;
 			#size-cells = <0>;
-			interrupts = <0 171 0x04>;
+			interrupts = <GIC_SPI 171 IRQ_TYPE_LEVEL_HIGH>;
 			dr_mode = "host";
 			phy_type = "utmi";
 		};
 
 		usb@3100000 {
 			compatible = "fsl,fsl_usb3";
-			#address-cells = <1>;
-			#size-cells = <1>;
+			#address-cells = <2>;
+			#size-cells = <2>;
 			ranges;
 
-			reg = <0x3100000 0x10000>;
+			reg = <0x0 0x3100000 0x0 0x10000>;
 			interrupts = <GIC_SPI 93 IRQ_TYPE_LEVEL_HIGH>;
 
 			dr_mode = "host";
@@ -699,8 +706,8 @@
 
 		can0: can@2a70000 {
 			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
-			reg = <0x2a70000 0x1000>;
-			interrupts = <0 126 0x04>;
+			reg = <0x0 0x2a70000 0x0 0x1000>;
+			interrupts = <GIC_SPI 126 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			big-endian;
@@ -709,8 +716,8 @@
 
 		can1: can@2a80000 {
 			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
-			reg = <0x2a80000 0x1000>;
-			interrupts = <0 127 0x04>;
+			reg = <0x0 0x2a80000 0x0 0x1000>;
+			interrupts = <GIC_SPI 127 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			big-endian;
@@ -719,8 +726,8 @@
 
 		can2: can@2a90000 {
 			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
-			reg = <0x2a90000 0x1000>;
-			interrupts = <0 128 0x04>;
+			reg = <0x0 0x2a90000 0x0 0x1000>;
+			interrupts = <GIC_SPI 128 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			big-endian;
@@ -729,13 +736,60 @@
 
 		can3: can@2aa0000 {
 			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
-			reg = <0x2aa0000 0x1000>;
-			interrupts = <0 129 0x04>;
+			reg = <0x0 0x2aa0000 0x0 0x1000>;
+			interrupts = <GIC_SPI 129 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
 			clock-names = "ipg";
 			big-endian;
 			status = "disabled";
 		};
+
+		pcie@3400000 {
+			compatible = "fsl,pcie", "snps,dw-pcie", "fsl,ls1021a-pcie";
+			reg = <0x0 0x3400000 0x0 0x10000>;
+			interrupts = <GIC_SPI 177 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 179 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 181 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 183 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 91 IRQ_TYPE_LEVEL_HIGH>;
+			interrupt-names = "intr", "msi", "pme", "cfg-err", "inta";
+			#address-cells = <3>;
+			#size-cells = <2>;
+			device_type = "pci";
+			num-lanes = <4>;
+			bus-range = <0x0 0xff>;
+			ranges = <0x00000800 0x0 0x00000000 0x40 0x00000000 0x0 0x00080000 /* configuration space */
+				  0x81000000 0x0 0x00000000 0x40 0x10000000 0x0 0x00010000 /* downstream I/O */
+				  0x82000000 0x0 0x00000000 0x41 0x00000000 0x1 0x00000000>; /* non-prefetchable memory */
+			interrupt-map-mask = <0 0 0 7>;
+			interrupt-map = <0000 0 0 1 &gic GIC_SPI 91  IRQ_TYPE_LEVEL_HIGH>,
+					<0000 0 0 2 &gic GIC_SPI 188 IRQ_TYPE_LEVEL_HIGH>,
+					<0000 0 0 3 &gic GIC_SPI 190 IRQ_TYPE_LEVEL_HIGH>,
+					<0000 0 0 4 &gic GIC_SPI 192 IRQ_TYPE_LEVEL_HIGH>;
+			};
+
+		pcie@3500000 {
+			compatible = "fsl,pcie", "snps,dw-pcie", "fsl,ls1021a-pcie";
+			reg = <0x0 0x3500000 0x0 0x10000>;
+			interrupts = <GIC_SPI 178 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 180 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 182 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 184 IRQ_TYPE_LEVEL_HIGH>;
+			interrupt-names = "intr", "msi", "pme", "cfg-err";
+			#address-cells = <3>;
+			#size-cells = <2>;
+			device_type = "pci";
+			num-lanes = <2>;
+			bus-range = <0x0 0xff>;
+			ranges = <0x00000800 0x0 0x00000000 0x48 0x00000000 0x0 0x10000000 /* configuration space */
+				  0x81000000 0x0 0x00000000 0x48 0x10000000 0x0 0x00010000 /* downstream I/O */
+				  0x82000000 0x0 0x00000000 0x49 0x00000000 0x1 0x00000000>; /* non-prefetchable memory */
+			interrupt-map-mask = <0 0 0 7>;
+			interrupt-map = <0000 0 0 1 &gic GIC_SPI 91  IRQ_TYPE_LEVEL_HIGH>,
+					<0000 0 0 2 &gic GIC_SPI 189 IRQ_TYPE_LEVEL_HIGH>,
+					<0000 0 0 3 &gic GIC_SPI 191 IRQ_TYPE_LEVEL_HIGH>,
+					<0000 0 0 4 &gic GIC_SPI 193 IRQ_TYPE_LEVEL_HIGH>;
+		};
 	};
 
 	dcsr@20000000 {
@@ -743,7 +797,7 @@
 		#size-cells = <1>;
 		compatible = "fsl,ls1021a-dcsr", "simple-bus";
 
-		ranges = <0x0 0x20000000 0x1000000>;
+		ranges = <0x0 0x0 0x20000000 0x1000000>;
 
 		dcsr-epu@0 {
 			compatible = "fsl,ls1021a-dcsr-epu";
-- 
2.0.2

