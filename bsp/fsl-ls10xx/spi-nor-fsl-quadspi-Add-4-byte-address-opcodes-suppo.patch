From 9fcafa271bde01049926071b18da68fbfc473f36 Mon Sep 17 00:00:00 2001
From: Quanyang Wang <quanyang.wang@windriver.com>
Date: Thu, 5 May 2016 16:36:27 +0800
Subject: [PATCH 8/8] spi-nor:fsl-quadspi:Add 4-byte address opcodes support

The spi-nor flash(S25FL512S) on ls1021a-iot board has totally 64MB size.
So the program_opcode is set to SPINOR_OP_PP_4B and the erase_opcode is
set to SPINOR_OP_SE_4B. But in ls1021a's spi-nor driver, the routine
"fsl_qspi_get_seqid" has no corresponding seqid, so add this or it will
occurr error as below when do erase or write operations on flash:

Unsupported cmd 0xdc
Unsupported cmd 0x02

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/mtd/spi-nor/fsl-quadspi.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/mtd/spi-nor/fsl-quadspi.c b/drivers/mtd/spi-nor/fsl-quadspi.c
index 634ac8e..cdf8005 100644
--- a/drivers/mtd/spi-nor/fsl-quadspi.c
+++ b/drivers/mtd/spi-nor/fsl-quadspi.c
@@ -456,10 +456,12 @@ static int fsl_qspi_get_seqid(struct fsl_qspi *q, u8 cmd)
 		return SEQID_RDSR;
 	case SPINOR_OP_BE_4K:
 	case SPINOR_OP_SE:
+	case SPINOR_OP_SE_4B:
 		return SEQID_SE;
 	case SPINOR_OP_CHIP_ERASE:
 		return SEQID_CHIP_ERASE;
 	case SPINOR_OP_PP:
+	case SPINOR_OP_PP_4B:
 		return SEQID_PP;
 	case SPINOR_OP_RDID:
 		return SEQID_RDID;
-- 
1.7.5.4

