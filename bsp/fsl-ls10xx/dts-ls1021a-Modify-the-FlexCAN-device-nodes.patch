From 91e9389f042a8eaaf4e8a75017dad26a80fbfa4d Mon Sep 17 00:00:00 2001
From: Bhupesh Sharma <bhupesh.sharma@freescale.com>
Date: Tue, 3 Jun 2014 15:22:14 +0530
Subject: [PATCH 168/255] dts/ls1021a: Modify the FlexCAN device nodes

This patch modifies the FlexCAN device nodes in the LS1021A DTS
to ensure that the correct clock source (peripheral clock) format
is selected.

While at it, this patch also ensures that the correct compatible
string is selected and removes the redundant BE entries from the nodes.

Signed-off-by: Bhupesh Sharma <bhupesh.sharma@freescale.com>
[Kevin: Original patch taken from
LS1021A-SDK-V1.1-ARM-SOURCE-20140815-yocto.iso]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/arm/boot/dts/ls1021a.dtsi | 20 ++++++++------------
 1 file changed, 8 insertions(+), 12 deletions(-)

diff --git a/arch/arm/boot/dts/ls1021a.dtsi b/arch/arm/boot/dts/ls1021a.dtsi
index 06564d6..86eca7c 100644
--- a/arch/arm/boot/dts/ls1021a.dtsi
+++ b/arch/arm/boot/dts/ls1021a.dtsi
@@ -708,42 +708,38 @@
 		};
 
 		can0: can@2a70000 {
-			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
+			compatible = "fsl,ls1021a-flexcan";
 			reg = <0x0 0x2a70000 0x0 0x1000>;
 			interrupts = <GIC_SPI 126 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
-			clock-names = "ipg";
-			big-endian;
+			clock-names = "per";
 			status = "disabled";
 		};
 
 		can1: can@2a80000 {
-			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
+			compatible = "fsl,ls1021a-flexcan";
 			reg = <0x0 0x2a80000 0x0 0x1000>;
 			interrupts = <GIC_SPI 127 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
-			clock-names = "ipg";
-			big-endian;
+			clock-names = "per";
 			status = "disabled";
 		};
 
 		can2: can@2a90000 {
-			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
+			compatible = "fsl,ls1021a-flexcan";
 			reg = <0x0 0x2a90000 0x0 0x1000>;
 			interrupts = <GIC_SPI 128 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
-			clock-names = "ipg";
-			big-endian;
+			clock-names = "per";
 			status = "disabled";
 		};
 
 		can3: can@2aa0000 {
-			compatible = "fsl,imx28-flexcan", "fsl,p1010-flexcan";
+			compatible = "fsl,ls1021a-flexcan";
 			reg = <0x0 0x2aa0000 0x0 0x1000>;
 			interrupts = <GIC_SPI 129 IRQ_TYPE_LEVEL_HIGH>;
 			clocks = <&platform_clk 1>;
-			clock-names = "ipg";
-			big-endian;
+			clock-names = "per";
 			status = "disabled";
 		};
 
-- 
2.0.2

