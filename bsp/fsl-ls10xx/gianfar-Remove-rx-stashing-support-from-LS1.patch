From 519c14167b33fd16835eaf3b55be76778355a4cb Mon Sep 17 00:00:00 2001
From: Claudiu Manoil <claudiu.manoil@freescale.com>
Date: Mon, 23 Jun 2014 12:04:19 +0300
Subject: [PATCH 202/255] gianfar: Remove rx stashing support from LS1

LS1 does not support rx stashing.  The DT fields
configuring stashing are set by uboot.

Signed-off-by: Claudiu Manoil <claudiu.manoil@freescale.com>
[Kevin: Original patch taken from
LS1021A-SDK-V1.1-ARM-SOURCE-20140815-yocto.iso]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/gianfar.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/drivers/net/ethernet/freescale/gianfar.c b/drivers/net/ethernet/freescale/gianfar.c
index b98180b..ca0c93b 100644
--- a/drivers/net/ethernet/freescale/gianfar.c
+++ b/drivers/net/ethernet/freescale/gianfar.c
@@ -741,9 +741,11 @@ static int gfar_of_init(struct platform_device *ofdev, struct net_device **pdev)
 	struct gfar_private *priv = NULL;
 	struct device_node *np = ofdev->dev.of_node;
 	struct device_node *child = NULL;
+#ifndef CONFIG_ARCH_LAYERSCAPE
 	struct property *stash;
 	u32 stash_len;
 	u32 stash_idx;
+#endif
 	unsigned int num_tx_qs, num_rx_qs;
 	unsigned short mode, poll_mode;
 
@@ -850,6 +852,7 @@ static int gfar_of_init(struct platform_device *ofdev, struct net_device **pdev)
 			goto err_grp_init;
 	}
 
+#ifndef CONFIG_ARCH_LAYERSCAPE
 	stash = of_find_property(np, "bd-stash", NULL);
 
 	if (stash) {
@@ -869,6 +872,7 @@ static int gfar_of_init(struct platform_device *ofdev, struct net_device **pdev)
 
 	if (stash_len || stash_idx)
 		priv->device_flags |= FSL_GIANFAR_DEV_HAS_BUF_STASHING;
+#endif
 
 	mac_addr = of_get_mac_address(np);
 
-- 
2.0.2

