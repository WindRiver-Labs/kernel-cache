From 1cc91837e49c364d4a0195dbc8b1a0d2767ef46a Mon Sep 17 00:00:00 2001
From: Jingchang Lu <jingchang.lu@freescale.com>
Date: Mon, 21 Jul 2014 17:40:21 +0800
Subject: [PATCH 222/255] arm: dts: ls1021a-qds: add tbi node and aliases for
 enet phy

This move the tbi node to boards level device tree source.
And add aliases for enet phy to make it be found easily
by u-boot on dynamically change the enet "phy-handle" and
"phy-connection-type" property.

Signed-off-by: Jingchang Lu <jingchang.lu@freescale.com>
[Kevin: Original patch taken from
LS1021A-SDK-V1.1-ARM-SOURCE-20140815-yocto.iso]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/arm/boot/dts/ls1021a-qds.dts | 33 ++++++++++++++++++++++++---------
 1 file changed, 24 insertions(+), 9 deletions(-)

diff --git a/arch/arm/boot/dts/ls1021a-qds.dts b/arch/arm/boot/dts/ls1021a-qds.dts
index 2384bd4..a4b66c0 100644
--- a/arch/arm/boot/dts/ls1021a-qds.dts
+++ b/arch/arm/boot/dts/ls1021a-qds.dts
@@ -13,6 +13,14 @@
 / {
 	model = "LS1021A QDS Board";
 
+	aliases {
+		enet0_rgmii_phy = &rgmii_phy1;
+		enet1_rgmii_phy = &rgmii_phy2;
+		enet2_rgmii_phy = &rgmii_phy3;
+		enet0_sgmii_phy = &sgmii_phy1c;
+		enet1_sgmii_phy = &sgmii_phy1d;
+	};
+
 	regulators {
 		compatible = "simple-bus";
 		#address-cells = <1>;
@@ -141,21 +149,21 @@
 
 &enet0 {
 	tbi-handle = <&tbi0>;
-	phy-handle = <&physgmii1c>;
+	phy-handle = <&sgmii_phy1c>;
 	phy-connection-type = "sgmii";
 	status = "okay";
 };
 
 &enet1 {
 	tbi-handle = <&tbi0>;
-	phy-handle = <&physgmii1d>;
+	phy-handle = <&sgmii_phy1d>;
 	phy-connection-type = "sgmii";
 	status = "okay";
 };
 
 &enet2 {
-	phy-handle = <&phyrgmii3>;
-	phy-connection-type = "rgmii";
+	phy-handle = <&rgmii_phy3>;
+	phy-connection-type = "rgmii-id";
 	status = "okay";
 };
 
@@ -306,7 +314,7 @@
 					reg = <0>;
 					#address-cells = <1>;
 					#size-cells = <0>;
-					phyrgmii1: ethernet-phy@1 {
+					rgmii_phy1: ethernet-phy@1 {
 						reg = <0x1>;
 					};
 				};
@@ -314,7 +322,7 @@
 					reg = <0x20>;
 					#address-cells = <1>;
 					#size-cells = <0>;
-					phyrgmii2: ethernet-phy@2 {
+					rgmii_phy2: ethernet-phy@2 {
 						reg = <0x2>;
 					};
 				};
@@ -322,7 +330,7 @@
 					reg = <0x40>;
 					#address-cells = <1>;
 					#size-cells = <0>;
-					phyrgmii3: ethernet-phy@3 {
+					rgmii_phy3: ethernet-phy@3 {
 						reg = <0x3>;
 					};
 				};
@@ -330,7 +338,7 @@
 					reg = <0x60>;
 					#address-cells = <1>;
 					#size-cells = <0>;
-					physgmii1c: ethernet-phy@1c {
+					sgmii_phy1c: ethernet-phy@1c {
 						reg = <0x1c>;
 					};
 				};
@@ -338,7 +346,7 @@
 					reg = <0x80>;
 					#address-cells = <1>;
 					#size-cells = <0>;
-					physgmii1d: ethernet-phy@1d {
+					sgmii_phy1d: ethernet-phy@1d {
 						reg = <0x1d>;
 					};
 				};
@@ -353,6 +361,13 @@
 	status = "okay";
 };
 
+&mdio0 {
+	tbi0: tbi-phy@8 {
+		reg = <0x8>;
+		device_type = "tbi-phy";
+	};
+};
+
 &uqe {
 	ranges = <0x0 0x0 0x2400000 0x40000>;
 	reg = <0x0 0x2400000 0x0 0x480>;
-- 
2.0.2

