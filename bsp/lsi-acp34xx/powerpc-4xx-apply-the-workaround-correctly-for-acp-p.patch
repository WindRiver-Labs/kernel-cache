From 28168b7f7e2cf18007347c15f1e6e9fcecae5722 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Tue, 29 May 2012 11:12:02 +0800
Subject: [PATCH 5/9] powerpc/4xx: apply the workaround correctly for acp pcie

There is a typo in the check whether we should apply the
workaround for acp pcie, and it will cause the PIO malfunction
due to the tpage not setting up correctly.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/sysdev/ppc4xx_pci.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/powerpc/sysdev/ppc4xx_pci.c b/arch/powerpc/sysdev/ppc4xx_pci.c
index a4e1c46..278144e 100644
--- a/arch/powerpc/sysdev/ppc4xx_pci.c
+++ b/arch/powerpc/sysdev/ppc4xx_pci.c
@@ -2373,7 +2373,7 @@ ppc4xx_configure_acp_pciex_PIMs(struct ppc4xx_pciex_port *port,
 		 * For the address field we simply program an incrementing value
 		 * to map consecutive pages
 		 */
-		if (0 == acp_plx) {
+		if (acp_plx) {
 			int i;
 
 			for (i = 0; i < 8; i++) {
-- 
1.7.9.7

