From 781936c3468eaeae9e57bc6274801b62098036db Mon Sep 17 00:00:00 2001
From: Benjamin Walsh <benjamin.walsh@windriver.com>
Date: Sat, 11 Jul 2009 16:08:19 -0400
Subject: [PATCH] RMI: Add interrupt stat tracking for msg ring handler.

The /proc/interrupts information was always displaying 0 for
both the msg ring interrupt and the msg ring timeout interrupt.

Signed-off-by: Benjamin Walsh <benjamin.walsh@windriver.com>
---
 arch/mips/rmi/phoenix/on_chip.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/mips/rmi/phoenix/on_chip.c b/arch/mips/rmi/phoenix/on_chip.c
index 236ba59..4910caa 100644
--- a/arch/mips/rmi/phoenix/on_chip.c
+++ b/arch/mips/rmi/phoenix/on_chip.c
@@ -32,6 +32,7 @@
 #include <linux/smp.h>
 #include <linux/interrupt.h>
 #include <linux/spinlock.h>
+#include <linux/kernel_stat.h>
 
 #include <asm/rmi/msgring.h>
 #include <asm/rmi/iomap.h>
@@ -419,6 +420,7 @@ void phnx_msgring_int_handler(unsigned int irq)
 	unsigned long mflags;
 	__u32 cycles = 0;
 
+	kstat_this_cpu.irqs[irq]++;
 	if (irq == PIC_TIMER_0_IRQ) {
 		phoenix_reg_t *mmio = phoenix_io_mmio(PHOENIX_IO_PIC_OFFSET);
 
-- 
1.6.0.4

