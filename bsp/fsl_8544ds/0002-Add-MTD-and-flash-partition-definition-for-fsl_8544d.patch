From 8f3c53914a334f2e0a93b98a34b1efbce790cd27 Mon Sep 17 00:00:00 2001
From: Liang Li <Liang.Li@windriver.com>
Date: Fri, 24 Oct 2008 13:23:11 +0800
Subject: [PATCH] Add MTD and flash partition definition for fsl_8544ds BSP

Add MTD device definition and flash partition definition in dts file to
support MTD device as well as example of how to define flash partition
in dts file.

Signed-off-by: Liang Li <Liang.Li@windriver.com>
---
 arch/powerpc/boot/dts/mpc8544ds.dts |   37 +++++++++++++++++++++++++++++++++++
 1 files changed, 37 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/boot/dts/mpc8544ds.dts b/arch/powerpc/boot/dts/mpc8544ds.dts
index 47f43f4..1772acf 100644
--- a/arch/powerpc/boot/dts/mpc8544ds.dts
+++ b/arch/powerpc/boot/dts/mpc8544ds.dts
@@ -248,6 +248,43 @@
 		};
 	};
 
+	localbus@e0005000 {
+		#address-cells = <2>;
+		#size-cells = <1>;
+		compatible = "fsl,mpc8544-localbus", "simple-bus";
+		reg = <0xe0005000 0x1000>;
+		interrupt-parent = <&mpic>;
+
+		ranges = <0x0 0x0 0xff800000 0x00800000>;
+
+		flash@0,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
+			compatible = "cfi-flash";
+			reg = <0x0 0x0 0x800000>;
+			bank-width = <2>;
+			device-width = <2>;
+
+			partition@0 {
+				label = "DINK";
+				reg = <0x00000000 0x00400000>;
+				read-only;
+			};
+
+			partition@400000 {
+				label = "fs";
+				reg = <0x00400000 0x00300000>;
+			};
+
+			partition@700000 {
+				label = "u-boot";
+				reg = <0x00700000 0x00100000>;
+				read-only;
+			};
+
+		};
+	};
+
 	pci0: pci@e0008000 {
 		cell-index = <0>;
 		compatible = "fsl,mpc8540-pci";
-- 
1.6.0.90.g436ed

