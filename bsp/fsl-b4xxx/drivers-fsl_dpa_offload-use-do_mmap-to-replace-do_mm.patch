From 4d8ad6565118ebfbb7e6fda337f2ebb1048979e1 Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Tue, 2 Apr 2013 12:30:56 +0800
Subject: [PATCH 513/518] drivers/fsl_dpa_offload: use do_mmap to replace
 do_mmap_pgoff

We can use that similar do_mmap() in stead of do_mmap_pgoff()
to avoid exporting do_mmap_pgoff().

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/staging/fsl_qbman/fsl_usdpaa.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/staging/fsl_qbman/fsl_usdpaa.c b/drivers/staging/fsl_qbman/fsl_usdpaa.c
index a48efa7..ececf21 100644
--- a/drivers/staging/fsl_qbman/fsl_usdpaa.c
+++ b/drivers/staging/fsl_qbman/fsl_usdpaa.c
@@ -882,7 +882,7 @@ out:
 	if (!ret) {
 		unsigned long longret;
 		down_write(&current->mm->mmap_sem);
-		longret = do_mmap_pgoff(fp, 0, map->frag->len, PROT_READ |
+		longret = do_mmap(fp, 0, map->frag->len, PROT_READ |
 			(i.flags & USDPAA_DMA_FLAG_RDONLY ? 0 : PROT_WRITE),
 			MAP_SHARED, map->frag->pfn_base);
 		up_write(&current->mm->mmap_sem);
@@ -1026,7 +1026,7 @@ static int portal_mmap(struct file *fp, struct resource *res, compat_uptr_t *ptr
 
 	down_write(&current->mm->mmap_sem);
 	do {
-		longret = do_mmap_pgoff(fp, 0, resource_size(res),
+		longret = do_mmap(fp, 0, resource_size(res),
 					PROT_READ | PROT_WRITE, MAP_SHARED,
 					res->start >> PAGE_SHIFT);
 	} while (longret == 0);
-- 
1.7.5.4

