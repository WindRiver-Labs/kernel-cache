From 542150c0a9d94f0ba1032c4c21fd3be6e96096cc Mon Sep 17 00:00:00 2001
From: Andrei Varvara <andrei.varvara@freescale.com>
Date: Wed, 16 May 2012 19:32:19 +0000
Subject: [PATCH 075/518] CAAM: fix SEQ IN PTR command when RTO bit is set

SEQ IN PTR command does not require pointer if RTO bit is set
Updated desc_constr.h accordingly.

Signed-off-by: Andrei Varvara <andrei.varvara@freescale.com>
Acked-by: Mihai Serb <mihai.serb@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/crypto/caam/desc_constr.h |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/crypto/caam/desc_constr.h b/drivers/crypto/caam/desc_constr.h
index cd31d49..58416d8 100644
--- a/drivers/crypto/caam/desc_constr.h
+++ b/drivers/crypto/caam/desc_constr.h
@@ -235,6 +235,10 @@ static inline void append_seq_##cmd##_ptr_intlen(u32 *desc, dma_addr_t ptr, \
 						 u32 options) \
 { \
 	PRINT_POS; \
+	if (options & SQIN_RTO || options & SQOUT_RTO) { \
+		append_cmd(desc, CMD_SEQ_##op##_PTR | options | len); \
+		return; \
+	} \
 	append_cmd_ptr(desc, ptr, len, CMD_SEQ_##op##_PTR | options); \
 }
 APPEND_SEQ_PTR_INTLEN(in, IN)
-- 
1.7.5.4

