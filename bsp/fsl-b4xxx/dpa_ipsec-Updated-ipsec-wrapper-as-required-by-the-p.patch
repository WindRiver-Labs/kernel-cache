From 0dd634ccba965ecdd872724b1d7399fb36ea14da Mon Sep 17 00:00:00 2001
From: andrei varvara <andrei.varvara@freescale.com>
Date: Fri, 9 Nov 2012 14:52:34 +0000
Subject: [PATCH 394/518] dpa_ipsec: Updated ipsec wrapper as required by the
 preallocation of IPSec special manip

Added "max_sa_manip_ops" also into the dpa_ipsec_ioctl.h and
wrp_dpa_ipsec.c to match latest API changes.

Signed-off-by: Andrei Varvara <andrei.varvara@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/staging/fsl_dpa_offload/dpa_ipsec_ioctl.h |    1 +
 drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c   |    1 +
 2 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/dpa_ipsec_ioctl.h b/drivers/staging/fsl_dpa_offload/dpa_ipsec_ioctl.h
index 74aa34a..2dbe01c 100644
--- a/drivers/staging/fsl_dpa_offload/dpa_ipsec_ioctl.h
+++ b/drivers/staging/fsl_dpa_offload/dpa_ipsec_ioctl.h
@@ -57,6 +57,7 @@ struct ioc_compat_ipsec_init_params {
 	compat_uptr_t fm_pcd;
 	uint16_t qm_sec_ch;
 	uint16_t max_sa_pairs;
+	uint32_t max_sa_manip_ops;
 	compat_uptr_t fqid_range;
 	uint8_t ipf_bpid;
 };
diff --git a/drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c b/drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c
index 02c3b03..70ed191 100644
--- a/drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c
+++ b/drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c
@@ -86,6 +86,7 @@ static void compat_copy_dpa_ipsec_init(struct ioc_dpa_ipsec_params *prm,
 		init_prm->max_sa_pairs = init_compat_prm->max_sa_pairs;
 		init_prm->post_sec_in_params =
 					init_compat_prm->post_sec_in_params;
+		init_prm->max_sa_manip_ops = init_compat_prm->max_sa_manip_ops;
 		init_prm->post_sec_out_params =
 					init_compat_prm->post_sec_out_params;
 		init_prm->pre_sec_in_params =
-- 
1.7.5.4

