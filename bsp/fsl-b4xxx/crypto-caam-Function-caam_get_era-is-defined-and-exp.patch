From d384a8621562a579c1d0812f3a27f51620aaa1ea Mon Sep 17 00:00:00 2001
From: Marian Chereji <marian.chereji@freescale.com>
Date: Wed, 14 Nov 2012 17:52:08 +0200
Subject: [PATCH 084/518] crypto:caam - Function "caam_get_era" is defined and
 exported only when DPA Offload module is configured

Exporting the "caam_get_era" function only when DPA Offload driver is
enabled. This way the use of this function is not publicly advertised.

Signed-off-by: Andrei Varvara <andrei.varvara@freescale.com>
Signed-off-by: Marian Chereji <marian.chereji@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/crypto/caam/ctrl.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/crypto/caam/ctrl.c b/drivers/crypto/caam/ctrl.c
index c535bba..19387f8 100644
--- a/drivers/crypto/caam/ctrl.c
+++ b/drivers/crypto/caam/ctrl.c
@@ -157,6 +157,7 @@ static void kick_trng(struct platform_device *pdev)
 	clrbits32(&r4tst->rtmctl, RTMCTL_PRGM);
 }
 
+#if defined(CONFIG_FSL_DPA_OFFLOAD_MODULE) || defined(CONFIG_FSL_DPA_OFFLOAD)
 /**
  * caam_get_era() - Return the ERA of the SEC on SoC, based
  * on the SEC_VID register.
@@ -171,6 +172,7 @@ int caam_get_era(struct platform_device *pdev)
 	return ctrlpriv->era;
 }
 EXPORT_SYMBOL(caam_get_era);
+#endif
 
 /**
  * get_rng_vid() - Return the version of the (T)RNG  block of the SEC.
-- 
1.7.5.4

