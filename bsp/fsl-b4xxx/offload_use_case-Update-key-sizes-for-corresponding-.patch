From 6db3701e7562631b389f7af8c557628e10ee6971 Mon Sep 17 00:00:00 2001
From: Radu-Andrei BULIE <radu.bulie@freescale.com>
Date: Fri, 17 Aug 2012 17:32:27 +0000
Subject: [PATCH 286/518] offload_use_case: Update key sizes for corresponding
 protocols in order to accomodate with MURAM size
 for P5020

Replaced the four protocol tables for UDP and TCP (IPv4/IPv6) with  only two
tables of type ANY(IPv4/IPv6) for IPSEC outbound pre encryption.
The key sizes for protocol type ANY were updated accordingly.

Signed-off-by: Radu-Andrei BULIE <radu.bulie@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 .../staging/fsl_dpa_offload/usecases/ipsec_init.c  |   27 +++++++++-----------
 1 files changed, 12 insertions(+), 15 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/usecases/ipsec_init.c b/drivers/staging/fsl_dpa_offload/usecases/ipsec_init.c
index 06d4272..de80d9e 100644
--- a/drivers/staging/fsl_dpa_offload/usecases/ipsec_init.c
+++ b/drivers/staging/fsl_dpa_offload/usecases/ipsec_init.c
@@ -42,8 +42,8 @@
 #include "dbgfs_ctl.h"
 
 #define IN_SA_PCD_HASH_OFF      0
-#define IN_SA_PCD_HASH_SETS     8
-#define CCNODE_MAX_NUM_OF_WAYS  4
+#define IN_SA_PCD_HASH_SETS	2
+#define CCNODE_MAX_NUM_OF_WAYS  8
 #define IPSEC_START_IN_FLOW_ID  0
 #define CCNODE_OUT_PRE_ENC_NUM_PROTOS 2
 #define IPSEC_PRE_DEC_TBL_KEY_SIZE \
@@ -65,23 +65,20 @@
 
 #define IPSEC_OUT_PRE_ENC_TBL_KEY_SIZE \
 	{ \
-		(2 * DPA_OFFLD_IPv4_ADDR_LEN_BYTES + \
-		 IP_PROTO_FIELD_LEN + \
-		 2 * PORT_FIELD_LEN), \
-		(2 * DPA_OFFLD_IPv6_ADDR_LEN_BYTES + \
-		 IP_PROTO_FIELD_LEN + \
-		 2 * PORT_FIELD_LEN), \
-		(2 * DPA_OFFLD_IPv4_ADDR_LEN_BYTES + \
-		 IP_PROTO_FIELD_LEN + \
-		 2 * PORT_FIELD_LEN), \
-		(2 * DPA_OFFLD_IPv6_ADDR_LEN_BYTES + \
-		 IP_PROTO_FIELD_LEN + \
-		 2 * PORT_FIELD_LEN), \
 		 0,	\
 		 0,	\
 		 0,	\
 		 0,	\
-		 0	\
+		 0,	\
+		 0,	\
+		 0,	\
+		 0,	\
+		 (2 * DPA_OFFLD_IPv4_ADDR_LEN_BYTES + \
+		 IP_PROTO_FIELD_LEN + \
+		 2 * PORT_FIELD_LEN), \
+		(2 * DPA_OFFLD_IPv6_ADDR_LEN_BYTES + \
+		 IP_PROTO_FIELD_LEN + \
+		 2 * PORT_FIELD_LEN) \
 	}
 
 #define IPSEC_OUT_POL_KEY_FIELDS	(DPA_IPSEC_KEY_FIELD_SIP |	\
-- 
1.7.5.4

