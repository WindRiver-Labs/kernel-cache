From f5ecc508083500cb750eb4bcd70101bb9114f770 Mon Sep 17 00:00:00 2001
From: Marian Chereji <marian.chereji@freescale.com>
Date: Tue, 7 Aug 2012 18:24:24 +0000
Subject: [PATCH 085/518] FMD: Bug fix. Replace the FMD export symbol guard

The FMan driver low level API is exported (EXPORT_SYMBOL)
especially for the dpa_offload driver. If this driver is not
enabled, there is no reason for these exports. However, the
symbol exports for dpa_offload were guarded with the wrong
kernel build configuration option. It is
CONFIG_FSL_DPA_OFFLOAD_MODULE which is defined when the dpa_offload
is selected as a module. CONFIG_FSL_DPA_OFFLOAD is only defined
when the dpa_offload is selected to be built-in.

Signed-off-by: Marian Chereji <marian.chereji@freescale.com>
Signed-off-by: Stefan Szabo <szbs001@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 .../dpa/NetCommSw/src/wrapper/lnxwrp_fm.c          |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
index 33c0f2f..dd739f9 100644
--- a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
@@ -77,7 +77,10 @@
 #include "lnxwrp_sysfs_fm.h"
 #include "lnxwrp_sysfs_fm_port.h"
 
+/* export LLD API to DPAA offload kernel module */
+#if defined(CONFIG_FSL_DPA_OFFLOAD_MODULE)
 #include "lnxwrp_exp_sym.h"
+#endif
 
 extern struct device_node *GetFmPortAdvArgsDevTreeNode (struct device_node *fm_node,
                                                          e_FmPortType       portType,
-- 
1.7.5.4

