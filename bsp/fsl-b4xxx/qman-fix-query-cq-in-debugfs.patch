From 2296783092cb22ff5bac7738f36c919cb6bdc801 Mon Sep 17 00:00:00 2001
From: Hai-Ying Wang <Haiying.Wang@freescale.com>
Date: Mon, 25 Feb 2013 20:29:16 +0000
Subject: [PATCH 493/518] qman: fix query cq in debugfs

Signed-off-by: Haiying Wang <Haiying.Wang@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/staging/fsl_qbman/qman_debugfs.c |    9 ++++-----
 drivers/staging/fsl_qbman/qman_private.h |    2 +-
 2 files changed, 5 insertions(+), 6 deletions(-)

diff --git a/drivers/staging/fsl_qbman/qman_debugfs.c b/drivers/staging/fsl_qbman/qman_debugfs.c
index 1e96820..5b81f54 100644
--- a/drivers/staging/fsl_qbman/qman_debugfs.c
+++ b/drivers/staging/fsl_qbman/qman_debugfs.c
@@ -1184,14 +1184,13 @@ static int query_cq_fields_show(struct seq_file *file, void *offset)
 {
 	int ret;
 	struct qm_mcr_ceetm_cq_query query_result;
-	struct qm_ceetm_cq cq;
+	unsigned int cqid;
 
-	cq.idx = query_cq_fields_data.cqid;
-	ret = qman_ceetm_query_cq(&cq, 0,  &query_result);
+	cqid = query_cq_fields_data.cqid;
+	ret = qman_ceetm_query_cq(cqid, 0,  &query_result);
 	if (ret)
 		return ret;
-	seq_printf(file, "Query CQ Fields Result cqid 0x%x\n",
-			cq.idx);
+	seq_printf(file, "Query CQ Fields Result cqid 0x%x\n", cqid);
 	seq_printf(file, " ccgid: %u\n", query_result.ccgid);
 	seq_printf(file, " state: %u\n", query_result.state);
 	seq_printf(file, " pfdr_hptr: %u\n", query_result.pfdr_hptr);
diff --git a/drivers/staging/fsl_qbman/qman_private.h b/drivers/staging/fsl_qbman/qman_private.h
index c0030ad..e43a41a 100644
--- a/drivers/staging/fsl_qbman/qman_private.h
+++ b/drivers/staging/fsl_qbman/qman_private.h
@@ -296,5 +296,5 @@ int qman_sp_enable_ceetm_mode(enum qm_dc_portal portal, u16 sub_portal);
 int qman_sp_disable_ceetm_mode(enum qm_dc_portal portal, u16 sub_portal);
 int qman_ceetm_set_prescaler(enum qm_dc_portal portal);
 int qman_ceetm_get_prescaler(u16 *pres);
-int qman_ceetm_query_cq(struct qm_ceetm_cq *cq, u32 dcp_idx,
+int qman_ceetm_query_cq(unsigned int cqid, unsigned int dcpid,
                                 struct qm_mcr_ceetm_cq_query *cq_query);
-- 
1.7.5.4

