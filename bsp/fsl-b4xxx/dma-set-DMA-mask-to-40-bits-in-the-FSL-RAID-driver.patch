From fa98316c8cae1ada1eba6a5aaa3997529441a214 Mon Sep 17 00:00:00 2001
From: Andy Fleming <afleming@freescale.com>
Date: Mon, 11 Feb 2013 15:58:38 +0000
Subject: [PATCH 031/518] dma: set DMA mask to 40-bits in the FSL RAID driver

Set the dma mask to 40bit for RaidEngine which enables it to access
all 8G of DDR directly, instead of using dma bounce buffer.

Signed-off-by: Forrest Shi <b29237@freescale.com>
Signed-off-by: Andy Fleming <afleming@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/dma/fsl_raid.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/dma/fsl_raid.c b/drivers/dma/fsl_raid.c
index 477ba1d..aa10159 100644
--- a/drivers/dma/fsl_raid.c
+++ b/drivers/dma/fsl_raid.c
@@ -935,6 +935,7 @@ static int __devinit raide_probe(struct platform_device *ofdev)
 	dma_dev = &repriv->dma_dev;
 	dma_dev->dev = dev;
 	INIT_LIST_HEAD(&dma_dev->channels);
+	dma_set_mask(dev, DMA_BIT_MASK(40));
 
 	dma_dev->device_alloc_chan_resources = re_jr_alloc_chan_resources;
 	dma_dev->device_tx_status = re_jr_tx_status;
-- 
1.7.5.4

