From 451669a0467b7ba5607f130e12301e6a40e587ca Mon Sep 17 00:00:00 2001
From: Radu Bulie <radu.bulie@freescale.com>
Date: Fri, 7 Dec 2012 23:11:29 +0000
Subject: [PATCH 440/518] dpa_classifier: Fix FMAN version 3 build issue for
 multicast entry type

Multicast entries are available only on FMAN v3. This patch
adds the DPAA_VERSION flag for classifier multicast entries.

Signed-off-by: Radu Bulie <radu.bulie@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/staging/fsl_dpa_offload/dpa_classifier.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/dpa_classifier.c b/drivers/staging/fsl_dpa_offload/dpa_classifier.c
index f04e230..5cacb08 100644
--- a/drivers/staging/fsl_dpa_offload/dpa_classifier.c
+++ b/drivers/staging/fsl_dpa_offload/dpa_classifier.c
@@ -2895,7 +2895,9 @@ static int action_to_next_engine_params(const struct dpa_cls_tbl_action *action,
 				t_Handle distribution)
 {
 	struct dpa_cls_table *next_table;
+#if (DPAA_VERSION >= 11)
 	struct dpa_cls_mcast_group *pgroup;
+#endif
 
 	dpa_cls_dbg(("DEBUG: dpa_classifier %s (%d) -->\n", __func__,
 		__LINE__));
@@ -2994,6 +2996,7 @@ static int action_to_next_engine_params(const struct dpa_cls_tbl_action *action,
 			(t_Handle)next_table->params.cc_node;
 
 		break;
+#if (DPAA_VERSION >= 11)
 	case DPA_CLS_TBL_ACTION_MCAST:
 		if (action->mcast_params.hmd != DPA_OFFLD_DESC_NONE) {
 			if (!hmd) {
@@ -3028,6 +3031,7 @@ static int action_to_next_engine_params(const struct dpa_cls_tbl_action *action,
 
 		next_engine_params->params.frParams.h_FrmReplic = pgroup->group;
 		break;
+#endif
 	default:
 		pr_err("ERROR: %s, %s (%d): Unsupported DPA Classifier action "
 			"type (%d).\n", __FILE__, __func__, __LINE__,
-- 
1.7.5.4

