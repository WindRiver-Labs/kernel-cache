From 409c49ddf67a2ec971287d33d24b3e8382684a27 Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Fri, 19 Apr 2013 13:17:18 +0800
Subject: [PATCH 15/36] bridging: fix rx_handlers return code

commit 3bc1b1add7a8484cc4a261c3e128dbe1528ce01f upstream

The frames for which rx_handlers return RX_HANDLER_CONSUMED are no longer
counted as dropped. They are counted as successfully received by
'netif_receive_skb'.

This allows network interface drivers to correctly update their RX-OK and
RX-DRP counters based on the result of 'netif_receive_skb'.

Signed-off-by: Cristian Bercaru <B43982@freescale.com>
Signed-off-by: Eric Dumazet <edumazet@google.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 net/core/dev.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/net/core/dev.c b/net/core/dev.c
index 373de32..f31775b 100644
--- a/net/core/dev.c
+++ b/net/core/dev.c
@@ -3244,6 +3244,7 @@ ncls:
 		}
 		switch (rx_handler(&skb)) {
 		case RX_HANDLER_CONSUMED:
+			ret = NET_RX_SUCCESS;
 			goto out;
 		case RX_HANDLER_ANOTHER:
 			goto another_round;
-- 
1.7.5.4

