From 1cdf26eb8843cc2ec1d55e65bf0161a116b3684d Mon Sep 17 00:00:00 2001
From: Radu-Andrei BULIE <radu.bulie@freescale.com>
Date: Wed, 31 Oct 2012 22:38:26 +0000
Subject: [PATCH 366/518] offload_use_case: Remove warning about calculated
 values never used

The return value rc was never used. When a negative value is returned by
generic netlink function, the resources are freed and
get_ipsec_offld_data_frompol can exit with returned value.

Signed-off-by: Radu-Andrei BULIE <radu.bulie@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 .../staging/fsl_dpa_offload/usecases/genl_ctl.c    |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/usecases/genl_ctl.c b/drivers/staging/fsl_dpa_offload/usecases/genl_ctl.c
index e645d8e..40ac510 100644
--- a/drivers/staging/fsl_dpa_offload/usecases/genl_ctl.c
+++ b/drivers/staging/fsl_dpa_offload/usecases/genl_ctl.c
@@ -329,6 +329,8 @@ static int get_ipsec_offld_data_frompol(struct sk_buff *skb_2,
 		sa_info.id.proto = state->id.proto;
 		sa_info.family = state->props.family;
 		rc = nla_put(skb, XFRMA_SA, sizeof(sa_info), &sa_info);
+		if (rc < 0)
+			goto out;
 	}
 	genlmsg_end(skb, msg_head);
 	rc = genlmsg_unicast(&init_net, skb, info->snd_pid);
-- 
1.7.5.4

