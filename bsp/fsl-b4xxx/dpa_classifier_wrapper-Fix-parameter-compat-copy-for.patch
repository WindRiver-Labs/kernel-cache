From f23452145d0a49dadc78914d3f0a16dfa864a980 Mon Sep 17 00:00:00 2001
From: Radu Bulie <radu.bulie@freescale.com>
Date: Tue, 11 Dec 2012 19:17:56 +0000
Subject: [PATCH 444/518] dpa_classifier_wrapper: Fix parameter compat copy
 for NAT type header manipulation

Source port and destination port parameters were not transmitted from userspace
to kernel space in classifier wrapper function dpa_cls_hm_nat_params_compatcpy
for 64 bit COMPAT mode

Signed-off-by: Radu Bulie <radu.bulie@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 .../staging/fsl_dpa_offload/wrp_dpa_classifier.c   |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/wrp_dpa_classifier.c b/drivers/staging/fsl_dpa_offload/wrp_dpa_classifier.c
index bd14909..ed8195c 100644
--- a/drivers/staging/fsl_dpa_offload/wrp_dpa_classifier.c
+++ b/drivers/staging/fsl_dpa_offload/wrp_dpa_classifier.c
@@ -2689,6 +2689,8 @@ int dpa_cls_hm_nat_params_compatcpy(
 		sizeof(kparam->nat_params.nat_pt));
 
 	kparam->nat_params.fm_pcd = compat_ptr(uparam->nat_params.fm_pcd);
+	kparam->nat_params.sport = uparam->nat_params.sport;
+	kparam->nat_params.dport = uparam->nat_params.dport;
 	kparam->next_hmd	= uparam->next_hmd;
 	kparam->hmd		= uparam->hmd;
 
-- 
1.7.5.4

