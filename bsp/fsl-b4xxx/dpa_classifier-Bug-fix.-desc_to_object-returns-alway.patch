From a41d386a4043c9029d6e7cadf561d8aab92994b4 Mon Sep 17 00:00:00 2001
From: Marian Chereji <marian.chereji@freescale.com>
Date: Tue, 4 Dec 2012 16:25:45 +0200
Subject: [PATCH 436/518] dpa_classifier: Bug fix. "desc_to_object" returns
 always a pointer in the "table_array"

The function "desc_to_object" would always return a pointer in the
"table_array" descriptor array. This problem was not reproduced while
this function was used only to recover pointers to tables. It was
discovered when the function was also used on multicast group descriptor
tables.

Signed-off-by: Marian Chereji <marian.chereji@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/staging/fsl_dpa_offload/dpa_classifier.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/dpa_classifier.c b/drivers/staging/fsl_dpa_offload/dpa_classifier.c
index da2aad0..a78e5ec 100644
--- a/drivers/staging/fsl_dpa_offload/dpa_classifier.c
+++ b/drivers/staging/fsl_dpa_offload/dpa_classifier.c
@@ -3253,7 +3253,7 @@ static void	*desc_to_object(struct dpa_cls_descriptor_table *desc_table,
 	BUG_ON(!desc_table);
 
 	if ((desc >= 0) && (desc < desc_table->num_descriptors))
-		return table_array.object[desc];
+		return desc_table->object[desc];
 	else
 		return NULL;
 }
-- 
1.7.5.4

