From fb92d61344d98a0629d95a4cec8885be3346a54b Mon Sep 17 00:00:00 2001
From: Ioana Radulescu <ruxandra.radulescu@freescale.com>
Date: Thu, 31 Jan 2013 23:56:08 +0000
Subject: [PATCH 050/518] dpaa_eth: Fix error in sysfs

Trying to dump the MAC registers for MACless interfaces resulted
in a segmentation fault. Just print a message for the user instead
of accessing non-existent regs.

Signed-off-by: Ioana Radulescu <ruxandra.radulescu@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 .../net/ethernet/freescale/dpa/dpaa_eth_sysfs.c    |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_sysfs.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_sysfs.c
index 413f27f..1a75354 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_sysfs.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_sysfs.c
@@ -143,7 +143,10 @@ static ssize_t dpaa_eth_show_mac_regs(struct device *dev,
 	struct dpa_priv_s *priv = netdev_priv(to_net_dev(dev));
 	struct mac_device *mac_dev = priv->mac_dev;
 
-	fm_mac_dump_regs(mac_dev);
+	if (mac_dev)
+		fm_mac_dump_regs(mac_dev);
+	else
+		return sprintf(buf, "no mac registers\n");
 
 	return 0;
 }
-- 
1.7.5.4

