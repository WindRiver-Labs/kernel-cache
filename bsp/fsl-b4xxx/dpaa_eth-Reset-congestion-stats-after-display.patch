From ec311c3804438242cc8d58ffd2ce5cc990883164 Mon Sep 17 00:00:00 2001
From: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
Date: Sun, 28 Oct 2012 00:17:27 +0300
Subject: [PATCH 001/518] dpaa_eth: Reset congestion stats after display

Be consistent with the QMan CGR API and reset the per-netdev congestion
stats that we display, after each user read from debugfs.

Signed-off-by: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
[Grabbed from the branch, LINUX_IR5.2.0, of
https://git.freescale.com/git-private/cgit.cgi/ppc/alu-b4860/linux.git.]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index fd87f14..0375dac 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -2996,6 +2996,9 @@ static int __cold dpa_debugfs_show(struct seq_file *file, void *offset)
 		"Current congestion state is: %s.\n",
 		priv->cgr_data.cgr_congested_count,
 		query_cgr.cgr.cs ? "congested" : "not congested");
+	/* Reset congestion stats (like QMan CGR API does) */
+	priv->cgr_data.congested_jiffies = 0;
+	priv->cgr_data.cgr_congested_count = 0;
 
 	/* Rx Errors demultiplexing */
 	seq_printf(file, "\nDPA RX Errors:\nCPU        dma err  phys err" \
-- 
1.7.5.4

