From bd491ec5ee365950b51f15edee76b6603c229a79 Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Wed, 11 Jan 2012 11:24:33 +0800
Subject: [PATCH 2/3] preempt_rt/powerpc: enable interrupt while do_signal_pending

Extracted from patch-2.6.33.9-rt31

Fully-preemptible kernel does not need interrupts disabled.

Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Integrated-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/kernel/signal.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/kernel/signal.c b/arch/powerpc/kernel/signal.c
index bdb52b7..d493c1a 100644
--- a/arch/powerpc/kernel/signal.c
+++ b/arch/powerpc/kernel/signal.c
@@ -122,6 +122,10 @@ static int do_signal_pending(sigset_t *oldset, struct pt_regs *regs)
 
 #ifdef CONFIG_PREEMPT_RT
 	/*
+	 * Fully-preemptible kernel does not need interrupts disabled.
+	 */
+	local_irq_enable();
+	/*
 	 * Add a preempt sched port
 	 */
 	preempt_check_resched();
-- 
1.7.0

