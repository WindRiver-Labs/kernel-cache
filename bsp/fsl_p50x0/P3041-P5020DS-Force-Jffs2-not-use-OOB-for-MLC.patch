From 54938fd86a75a3151fe8c6d13df27f987d6146ff Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Fri, 2 Dec 2011 14:47:37 +0800
Subject: [PATCH 03/25] P3041/P5020DS:Force Jffs2 not use OOB for MLC

commit "ENGR00068619 JFFS2 community fix with not use OOB"  add a fix with
not use OOB at MLC NAND, which need NAND driver indicated by cleaning
MTD_OOB_WRITEABLE bit mtd->flags.

In fsl_elbc_nand driver, if driver indicates the flash type is MLC, the
MTD_OOB_WRITEABLE bit will clean automatically.

Since P3041DS & P5020DS board implements an MLC 1G Byte NAND flash,we can
force the type explicitly.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/mtd/nand/fsl_elbc_nand.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/drivers/mtd/nand/fsl_elbc_nand.c b/drivers/mtd/nand/fsl_elbc_nand.c
index bb52415..1639e08 100644
--- a/drivers/mtd/nand/fsl_elbc_nand.c
+++ b/drivers/mtd/nand/fsl_elbc_nand.c
@@ -831,7 +831,8 @@ static int fsl_elbc_chip_remove(struct fsl_elbc_mtd *priv)
 
 static int boardflash_is_mlc(void)
 {
-#ifdef CONFIG_P1022_DS
+#if (defined(CONFIG_P1022_DS) ||\
+	defined(CONFIG_P3041_DS) || defined(CONFIG_P5020_DS))
 	return 1;
 #else
 	return 0;
-- 
1.7.9.7

