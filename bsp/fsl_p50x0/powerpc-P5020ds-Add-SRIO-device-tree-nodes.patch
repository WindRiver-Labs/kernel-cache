From bb7fe76847b057c8a90bce44a2f9617193fb7d34 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Wed, 28 Dec 2011 11:01:46 +0800
Subject: [PATCH 15/25] powerpc/P5020ds: Add SRIO device tree nodes

Update P5020ds.dts files to add SRIO device tree nodes.

Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
[Extract from QorIQ-DPAA-SDK-v1.1-20111026-systembuilder.iso
Fixed context to apply to Wind River kernel tree.]

Integrated-by: Jiang Lu <lu.jiang@windriver.com>
---
 arch/powerpc/boot/dts/p5020ds.dts |   56 +++++++++++++++++++++++++++++++++++--
 1 file changed, 53 insertions(+), 3 deletions(-)

diff --git a/arch/powerpc/boot/dts/p5020ds.dts b/arch/powerpc/boot/dts/p5020ds.dts
index 5e41a00..8c82a6a 100644
--- a/arch/powerpc/boot/dts/p5020ds.dts
+++ b/arch/powerpc/boot/dts/p5020ds.dts
@@ -792,6 +792,37 @@
 			gpio-controller;
 		};
 
+		rman: rman@1e0000 {
+			compatible = "fsl,rman";
+			#address-cells = <1>;
+			#size-cells = <1>;
+			ranges = <0x0 0x1e0000 0x20000>;
+			reg = <0x1e0000 0x20000>;
+			interrupts = <16 2 1 11>; /* err_irq */
+			fsl,qman-channels-id = <0x62 0x63>;
+
+			inbound-block@0 {
+				compatible = "fsl,rman-inbound-block";
+				reg = <0x0 0x800>;
+			};
+			global-cfg@b00 {
+				compatible = "fsl,rman-global-cfg";
+				reg = <0xb00 0x500>;
+			};
+			inbound-block@1000 {
+				compatible = "fsl,rman-inbound-block";
+				reg = <0x1000 0x800>;
+			};
+			inbound-block@2000 {
+				compatible = "fsl,rman-inbound-block";
+				reg = <0x2000 0x800>;
+			};
+			inbound-block@3000 {
+				compatible = "fsl,rman-inbound-block";
+				reg = <0x3000 0x800>;
+			};
+		};
+
 		usb0: usb@210000 {
 			compatible = "fsl,p5020-usb2-mph",
 					"fsl,mpc85xx-usb2-mph", "fsl-usb2-mph";
@@ -1302,9 +1333,28 @@
 		};
 	};
 
-/*
-	rapidio0: rapidio@ffe0c0000
-*/
+	rapidio@ffe0c0000 {
+		compatible = "fsl,srio";
+		interrupts = <16 2 1 11>;
+		#address-cells = <2>;
+		#size-cells = <2>;
+		ranges;
+		reg = <0xf 0xfe0c0000 0 0x11000>;
+
+		port1 {
+			#address-cells = <2>;
+			#size-cells = <2>;
+			cell-index = <1>;
+			ranges = <0 0 0xc 0x20000000 0 0x10000000>;
+		};
+
+		port2 {
+			#address-cells = <2>;
+			#size-cells = <2>;
+			cell-index = <2>;
+			ranges = <0 0 0xc 0x30000000 0 0x10000000>;
+		};
+	};
 
 	localbus@ffe124000 {
 		compatible = "fsl,p3041-rev1.0-elbc", "simple-bus";
-- 
1.7.9.7

