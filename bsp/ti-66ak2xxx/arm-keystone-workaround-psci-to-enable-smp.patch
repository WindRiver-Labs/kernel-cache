From 1f0a1b8fd24987f0da6665a19751047999925b91 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Thu, 7 May 2015 13:11:21 +0800
Subject: [PATCH 251/256] arm: keystone: workaround psci to enable smp

This patch is to enable SMP by skipping psci_ops set.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/kernel/psci_smp.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/arch/arm/kernel/psci_smp.c b/arch/arm/kernel/psci_smp.c
index 570a48c..2de0a26 100644
--- a/arch/arm/kernel/psci_smp.c
+++ b/arch/arm/kernel/psci_smp.c
@@ -70,6 +70,13 @@ void __ref psci_cpu_die(unsigned int cpu)
 
 bool __init psci_smp_available(void)
 {
+#ifdef CONFIG_ARCH_KEYSTONE
+	/*
+	 * Keystone use own smp_ops, but keep psci_ops as SDK since it will
+	 * be used in non-boottime when cpu on/off line.
+	 */
+	return 0;
+#endif
 	/* is cpu_on available at least? */
 	return (psci_ops.cpu_on != NULL);
 }
-- 
1.7.5.4

