From fec6eb06d91eda2e28afba903a310f1284b0ec3b Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Fri, 17 Apr 2015 09:55:25 +0800
Subject: [PATCH 136/257] gpio/davinci: add interrupt support for GPIOs 16-31

This patch comes from:
  git://git.ti.com/keystone-linux/linux.git

Interrupts for GPIOs 16 through 31 are enabled by bit 1 in the
"binten" register (offset 8). Previous versions of GPIO only
used bit 0, which enables GPIO 0-15 interrupts.

Signed-off-by: Reece Pollack <x0183204@ti.com>
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/gpio/gpio-davinci.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/gpio/gpio-davinci.c b/drivers/gpio/gpio-davinci.c
index 7629b4f..877d966 100644
--- a/drivers/gpio/gpio-davinci.c
+++ b/drivers/gpio/gpio-davinci.c
@@ -497,6 +497,9 @@ static int davinci_gpio_irq_setup(struct platform_device *pdev)
 		chips[0].gpio_unbanked = pdata->gpio_unbanked;
 		binten = BIT(0);
 
+		if (soc_info->gpio_unbanked > 16)
+			binten |= BIT(1);
+
 		/* AINTC handles mask/unmask; GPIO handles triggering */
 		irq = bank_irq;
 		gpio_unbanked = *container_of(irq_get_chip(irq),
-- 
2.7.4

