From 1e4def52954c183fce066534f3267b597be9a29c Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Fri, 10 Apr 2015 11:00:37 +0800
Subject: [PATCH 012/257] net: keystone: add Kconfig and Makefile

Adjust Kconfig and Makefile for keystone matching 3.14.x driver network

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/net/ethernet/ti/Kconfig  | 63 ++++++++++++++++++++++++++++++++++++++--
 drivers/net/ethernet/ti/Makefile | 14 +++++++++
 2 files changed, 74 insertions(+), 3 deletions(-)

diff --git a/drivers/net/ethernet/ti/Kconfig b/drivers/net/ethernet/ti/Kconfig
index 53150c2..05b3eb5 100644
--- a/drivers/net/ethernet/ti/Kconfig
+++ b/drivers/net/ethernet/ti/Kconfig
@@ -5,7 +5,7 @@
 config NET_VENDOR_TI
 	bool "Texas Instruments (TI) devices"
 	default y
-	depends on PCI || EISA || AR7 || (ARM && (ARCH_DAVINCI || ARCH_OMAP3 || SOC_AM33XX))
+	depends on PCI || EISA || AR7 || (ARM && (ARCH_DAVINCI || ARCH_OMAP3 || SOC_AM33XX || ARCH_KEYSTONE))
 	---help---
 	  If you have a network (Ethernet) card belonging to this class, say Y
 	  and read the Ethernet-HOWTO, available from
@@ -32,7 +32,7 @@ config TI_DAVINCI_EMAC
 
 config TI_DAVINCI_MDIO
 	tristate "TI DaVinci MDIO Support"
-	depends on ARM && ( ARCH_DAVINCI || ARCH_OMAP3 || SOC_AM33XX )
+	depends on ARM && ( ARCH_DAVINCI || ARCH_OMAP3 || SOC_AM33XX || ARCH_KEYSTONE )
 	select PHYLIB
 	---help---
 	  This driver supports TI's DaVinci MDIO module.
@@ -70,13 +70,51 @@ config TI_CPSW
 
 config TI_CPTS
 	boolean "TI Common Platform Time Sync (CPTS) Support"
-	depends on TI_CPSW
+	depends on TI_CPSW || TI_KEYSTONE_NET
 	select PTP_1588_CLOCK
 	---help---
 	  This driver supports the Common Platform Time Sync unit of
 	  the CPSW Ethernet Switch. The unit can time stamp PTP UDP/IPv4
 	  and Layer 2 packets, and the driver offers a PTP Hardware Clock.
 
+config TI_KEYSTONE_NET
+	tristate "TI Keystone Ethernet Support"
+	depends on TI_KEYSTONE
+	default y if TI_KEYSTONE
+	---help---
+	  This driver supports TI's Keystone Ethernet.
+
+	  To compile this driver as a module, choose M here: the module
+	  will be called keystone_net.
+
+config TI_KEYSTONE_PA
+	tristate "TI Keystone Packet Accelerator Support"
+	depends on TI_KEYSTONE
+	default y if TI_KEYSTONE
+	---help---
+	  This driver supports TI's Keystone Packet Accelerator.
+
+	  To compile this driver as a module, choose M here: the module
+	  will be called keystone_pa.
+
+config TI_KEYSTONE_QOS
+	tristate "TI Keystone Quality of Service Support"
+	depends on TI_KEYSTONE
+	default y if TI_KEYSTONE
+	---help---
+	  This driver supports TI's Keystone Quality of Service support.
+
+	  To compile this driver as a module, choose M here: the module
+	  will be called keystone_qos.
+
+config TI_KEYSTONE_NET_SA
+	tristate "TI Keystone inflow Security Accelerator mode Support"
+	depends on TI_KEYSTONE
+	default y if TI_KEYSTONE
+	---help---
+	  This driver supports TI's Keystone inflow Security Accelerator
+          mode.
+
 config TLAN
 	tristate "TI ThunderLAN support"
 	depends on (PCI || EISA)
@@ -102,4 +140,23 @@ config CPMAC
 	---help---
 	  TI AR7 CPMAC Ethernet support
 
+config TI_KEYSTONE_XGE
+	tristate "TI Keystone 10Gig Ethernet Support"
+	depends on TI_KEYSTONE && TI_KEYSTONE_NET
+	---help---
+	  This driver supports TI's Keystone 10Gig Ethernet.
+
+	  To compile this driver as a module, choose M here: the module
+	  will be called keystone_xge.
+
+config TI_KEYSTONE_XGE_MDIO
+	tristate "TI Keystone 10GE MDIO Support"
+	depends on ARM && ARCH_KEYSTONE
+	select PHYLIB
+	---help---
+	  This driver supports TI's Keystone 10GE MDIO module.
+
+	  To compile this driver as a module, choose M here: the module
+	  will be called keystone_xgemdio.  This is recommended.
+
 endif # NET_VENDOR_TI
diff --git a/drivers/net/ethernet/ti/Makefile b/drivers/net/ethernet/ti/Makefile
index 9cfaab8..6593fa9 100644
--- a/drivers/net/ethernet/ti/Makefile
+++ b/drivers/net/ethernet/ti/Makefile
@@ -10,3 +10,17 @@ obj-$(CONFIG_TI_DAVINCI_CPDMA) += davinci_cpdma.o
 obj-$(CONFIG_TI_CPSW_PHY_SEL) += cpsw-phy-sel.o
 obj-$(CONFIG_TI_CPSW) += ti_cpsw.o
 ti_cpsw-y := cpsw_ale.o cpsw.o cpts.o
+obj-$(CONFIG_TI_KEYSTONE_NET) += keystone_net.o
+obj-$(CONFIG_TI_KEYSTONE_PA) += keystone_pa.o keystone_pa2.o
+obj-$(CONFIG_TI_KEYSTONE_QOS) += keystone_qos.o
+obj-$(CONFIG_TI_KEYSTONE_NET_SA) += keystone_net_sa.o
+keystone_net-y += cpsw_ale.o cpts.o	\
+		  keystone_ethss.o	\
+		  keystone_sgmii.o	\
+		  keystone_net_core.o	\
+		  keystone_serdes.o	\
+		  keystone_ethss2.o
+obj-$(CONFIG_TI_KEYSTONE_XGE) += keystone_xge.o
+obj-$(CONFIG_TI_KEYSTONE_XGE_MDIO) += keystone_xgemdio.o
+keystone_xge-y += keystone_xgess.o	\
+		  keystone_xgepcsr.o
-- 
2.7.4

