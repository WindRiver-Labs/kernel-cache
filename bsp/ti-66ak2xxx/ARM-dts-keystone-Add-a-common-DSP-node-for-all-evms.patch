From dfd7e59de81eb78d71747d92125774582a2eb3e4 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Sat, 8 Apr 2017 20:16:30 +0800
Subject: [PATCH 107/347] ARM: dts: keystone: Add a common DSP node for all
 evms

This patch comes from:
  git://git.ti.com/processor-sdk/processor-sdk-linux.git

This commit comes from 60b5dc6e to 31e191fe

A common CMA memory pool reserved memory node is added, and
is attached to all the DSP nodes through the 'memory-region'
property. This area will be used for allocation virtio rings
and buffers. The common node allows the DSP Memory Protection
and Address Extension (MPAX) module to be configured across
all DSP processors uniformly.

Signed-off-by: Sam Nelson <sam.nelson@ti.com>
Signed-off-by: Suman Anna <s-anna@ti.com>
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/boot/dts/keystone-k2e-evm.dts     |   17 +-
 arch/arm/boot/dts/keystone-k2e-netcp.dtsi  |  324 +---------------------------
 arch/arm/boot/dts/keystone-k2e.dtsi        |   32 ++--
 arch/arm/boot/dts/keystone-k2g-evm.dts     |   62 +-----
 arch/arm/boot/dts/keystone-k2g-netcp.dtsi  |   28 ++-
 arch/arm/boot/dts/keystone-k2g.dtsi        |   52 ++----
 arch/arm/boot/dts/keystone-k2hk-evm.dts    |   49 ++++-
 arch/arm/boot/dts/keystone-k2hk-netcp.dtsi |  278 +-----------------------
 arch/arm/boot/dts/keystone-k2l-evm.dts     |    9 +-
 arch/arm/boot/dts/keystone-k2l-netcp.dtsi  |  192 +----------------
 arch/arm/boot/dts/keystone-k2l.dtsi        |  149 -------------
 arch/arm/boot/dts/keystone.dtsi            |   28 +---
 12 files changed, 141 insertions(+), 1079 deletions(-)

diff --git a/arch/arm/boot/dts/keystone-k2e-evm.dts b/arch/arm/boot/dts/keystone-k2e-evm.dts
index b935fe8..2dd119e 100644
--- a/arch/arm/boot/dts/keystone-k2e-evm.dts
+++ b/arch/arm/boot/dts/keystone-k2e-evm.dts
@@ -40,6 +40,11 @@
 				clock-output-names = "refclk-ddr3a";
 			};
 		};
+
+		mpm_mem: dspmem {
+			compatible = "ti,keystone-dsp-mem";
+			reg = <0x0c000000 0x00200000>;
+		};
 	};
 };
 
@@ -152,15 +157,3 @@
 		reg = <1>;
 	};
 };
-
-&gbe_serdes0 {
-	status = "okay";
-};
-
-&pcie1_phy {
-	status = "okay";
-};
-
-&pcie1 {
-	status = "okay";
-};
diff --git a/arch/arm/boot/dts/keystone-k2e-netcp.dtsi b/arch/arm/boot/dts/keystone-k2e-netcp.dtsi
index a7acb0d..ac990f6 100644
--- a/arch/arm/boot/dts/keystone-k2e-netcp.dtsi
+++ b/arch/arm/boot/dts/keystone-k2e-netcp.dtsi
@@ -46,7 +46,7 @@ qmss: qmss@2a40000 {
 			qpend-1 {
 				qrange = <528 16>;
 				interrupts = <0 48 0xf04 0 49 0xf04 0 50 0xf04
-					      0 51 0xf04 0 52 0x104 0 53 0x204
+					      0 51 0xf04 0 52 0xf04 0 53 0xf04
 					      0 54 0xf04 0 55 0xf04 0 56 0xf04
 					      0 57 0xf04 0 58 0xf04 0 59 0xf04
 					      0 60 0xf04 0 61 0xf04 0 62 0xf04
@@ -71,10 +71,6 @@ qmss: qmss@2a40000 {
 				qrange = <896 128>;
 				qalloc-by-id;
 			};
-			netcpx-tx {
-				qrange = <692 8>;
-				qalloc-by-id;
-			};
 		};
 		accumulator {
 			acc-low-0 {
@@ -93,7 +89,7 @@ qmss: qmss@2a40000 {
 		ranges;
 		region-12 {
 			id = <12>;
-			region-spec = <10240 128>;	/* num_desc desc_size */
+			region-spec = <8192 128>;	/* num_desc desc_size */
 			link-index = <0x4000>;
 		};
 	};
@@ -130,85 +126,6 @@ knav_dmas: knav_dmas@0 {
 		reg-names = "global", "txchan", "rxchan",
 				"txsched", "rxflow";
 	};
-
-	dma_xgbe: dma_xgbe@0 {
-		reg = <0x2fa1000 0x100>,
-			<0x2fa1400 0x200>,
-			<0x2fa1800 0x200>,
-			<0x2fa1c00 0x200>,
-			<0x2fa2000 0x400>;
-		reg-names = "global", "txchan", "rxchan",
-				"txsched", "rxflow";
-	};
-};
-
-gbe_subsys: subsys@24200000 {
-	compatible = "syscon";
-	reg = <0x24200000 0x100>;
-};
-
-gbe_serdes0: phy@232a000 {
-	status			= "disabled";
-	#phy-cells		= <0>;
-	compatible		= "ti,keystone-serdes-gbe";
-	reg			= <0x0232a000 0x2000>;
-	link-rate-kbps		= <1250000>;
-	num-lanes		= <4>;
-	/*rx-force-enable;*/
-	lanes {
-		#address-cells = <1>;
-		#size-cells = <0>;
-		lane@0 {
-			/*loopback;*/
-			reg		= <0>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-		lane@1 {
-			/*loopback;*/
-			reg		= <1>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-	};
-};
-
-gbe_serdes1: phy@2324000 {
-	status			= "disabled";
-	#phy-cells		= <0>;
-	compatible		= "ti,keystone-serdes-gbe";
-	reg			= <0x02324000 0x2000>;
-	link-rate-kbps		= <1250000>;
-	num-lanes		= <4>;
-	/*rx-force-enable;*/
-	lanes {
-		#address-cells = <1>;
-		#size-cells = <0>;
-		lane@0 {
-			/*loopback;*/
-			reg		= <0>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-		lane@1 {
-			/*loopback;*/
-			reg		= <1>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-	};
 };
 
 netcp: netcp@24000000 {
@@ -221,49 +138,13 @@ netcp: netcp@24000000 {
 	/* NetCP address range */
 	ranges = <0 0x24000000 0x1000000>;
 
-	clocks = <&clkpa>, <&clkcpgmac>, <&chipclk12>;
-	clock-names = "pa_clk", "ethss_clk", "cpts_rft_clk";
+	clocks = <&papllclk>, <&clkcpgmac>, <&chipclk12>;
 	dma-coherent;
 
-	ti,navigator-dmas =	<&dma_gbe 0>,
-				<&dma_gbe 8>,
-				<&dma_gbe 0>,
-				<&dma_gbe 22>,
-				<&dma_gbe 23>,
-				<&dma_gbe 24>,
-				<&dma_gbe 25>,
-				<&dma_gbe 27>,
-				<&dma_gbe 28>,
-				<&dma_gbe 29>,
-				<&dma_gbe 30>,
-				<&dma_gbe 8>,
-				<&dma_gbe 9>,
-				<&dma_gbe 10>,
-				<&dma_gbe 11>,
-				<&dma_gbe 12>,
-				<&dma_gbe 13>,
-				<&dma_gbe 14>, /* for egress cluster */
-				<&dma_gbe 31>;
-
-	ti,navigator-dma-names = "netrx0",
-				 "netrx1",
-				 "nettx",
-				 "netrx0-pa",
-				 "netrx1-pa",
-				 "netrx2-pa",
-				 "netrx3-pa",
-				 "netrx4-pa",
-				 "netrx5-pa",
-				 "netrx6-pa",
-				 "netrx7-pa",
-				 "pa-cl0",
-				 "pa-cl1",
-				 "pa-cl2",
-				 "pa-cl3",
-				 "pa-cl4",
-				 "pa-cl5",
-				 "pa-cl6",
-				 "pa-cmd-rsp";
+	ti,navigator-dmas = <&dma_gbe 0>,
+			<&dma_gbe 8>,
+			<&dma_gbe 0>;
+	ti,navigator-dma-names = "netrx0", "netrx1", "nettx";
 
 	netcp-devices {
 		#address-cells = <1>;
@@ -272,12 +153,10 @@ netcp: netcp@24000000 {
 		gbe@200000 { /* ETHSS */
 			label = "netcp-gbe";
 			compatible = "ti,netcp-gbe-9";
-			syscon-subsys = <&gbe_subsys>;
-			reg = <0x200100 0x800>, <0x220000 0x20000>;
+			reg = <0x200000 0x900>, <0x220000 0x20000>;
 			/* enable-ale; */
 			tx-queue = <896>;
 			tx-channel = "nettx";
-			phys = <&gbe_serdes0>, <&gbe_serdes1>;
 
 			interfaces {
 				gbe0: interface-0 {
@@ -319,73 +198,6 @@ netcp: netcp@24000000 {
 				};
 			};
 		};
-
-		pa@0 {
-			#address-cells = <1>;
-			#size-cells = <1>;
-			label = "netcp-pa2";
-			compatible = "ti,netcp-pa2";
-
-			reg = <0 0x100>,		/* Mailbox */
-				<0x400 0x40>,		/* RA bridge */
-				<0x500 0x80>,		/* thread mapper */
-				<0x800 0x1000>,		/* RA */
-				<0x6000 0x100>,		/* Statistics regs */
-				<0x8000 0x100>,		/* Statistics block */
-				<0x400000 0x900000>;	/* cluster memory */
-
-			mac-lut-ranges		= <0 43 56 63>;
-			/* Static reservation in LUT-1 (outer IP)
-			 * used by driver to add IP rules for Rx checksum
-			 * offload.
-			 */
-			rx-route		= <528 22>;
-			tx-cmd-pool		= <256 12>;
-			/* rx command pool */
-			rx-cmd-rsp-pool		= <256 12>;
-			/* rx channel name for command response */
-			rx-cmd-rsp-chan		= "pa-cmd-rsp";
-			rx-cmd-rsp-queue-depth	= <128 32 0 0>;
-			rx-cmd-rsp-buffer-size	= <128 512 0 0>;
-
-			/* rx channels get overridden for the interface
-			 * when PA is enabled
-			 */
-			interfaces {
-				pa0: interface-0 {
-					slave-port	= <0>;
-					rx-channel	= "netrx0-pa";
-				};
-
-				pa1: interface-1 {
-					slave-port	= <1>;
-					rx-channel	= "netrx1-pa";
-				};
-			};
-
-			/* PA clusters that does packet processing */
-			clusters {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cluster@0 {
-					reg = <0>;
-					tx-queue = <904>;
-					tx-channel = "pa-cl0";
-				};
-
-				cluster@1 {
-					reg = <1>;
-					tx-queue = <905>;
-					tx-channel = "pa-cl1";
-				};
-
-				cluster@6 {
-					reg = <6>;
-					tx-queue = <910>;
-					tx-channel = "pa-cl6";
-				};
-			};
-		};
 	};
 
 	netcp-interfaces {
@@ -399,7 +211,6 @@ netcp: netcp@24000000 {
 			tx-completion-queue = <530>;
 			efuse-mac = <1>;
 			netcp-gbe = <&gbe0>;
-			netcp-pa2 = <&pa0>;
 
 		};
 		interface-1 {
@@ -413,125 +224,6 @@ netcp: netcp@24000000 {
 			efuse-mac = <0>;
 			local-mac-address = [02 18 31 7e 3e 00];
 			netcp-gbe = <&gbe1>;
-			netcp-pa2 = <&pa1>;
-		};
-	};
-};
-
-xgbe_subsys: subsys@2f00000 {
-	status		= "disabled";
-	compatible	= "syscon";
-	reg		= <0x02f00000 0x100>;
-};
-
-xgbe_pcsr: pcsr@2f00600 {
-	status		= "disabled";
-	compatible	= "syscon";
-	reg		= <0x02f00600 0x100>;
-};
-
-xgbe_serdes: phy@231e000 {
-	status			= "disabled";
-	#phy-cells		= <0>;
-	compatible		= "ti,keystone-serdes-xgbe";
-	reg			= <0x0231e000 0x2000>;
-	link-rate-kbps		= <10312500>;
-	num-lanes		= <2>;
-	syscon-peripheral	= <&xgbe_subsys>;
-	syscon-link		= <&xgbe_pcsr>;
-	/*rx-force-enable;*/
-	lanes {
-		#address-cells = <1>;
-		#size-cells = <0>;
-		lane@0 {
-			/*loopback;*/
-			reg		= <0>;
-			control-rate	= <0>; /* full */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <2 0 0 12 4>;
-				/* c1 c2 cm att vreg */
-		};
-		lane@1 {
-			/*loopback;*/
-			reg		= <1>;
-			control-rate	= <0>; /* full */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <2 0 0 12 4>;
-				/* c1 c2 cm att vreg */
-		};
-	};
-};
-
-netcpx: netcpx@2f00000 {
-	status		= "disabled";
-	compatible	= "ti,netcp-1.0";
-	#address-cells	= <1>;
-	#size-cells	= <1>;
-	ranges;
-
-	clocks		= <&clkxge>;
-	clock-names	= "xge_clk";
-	dma-coherent;
-	/* big-endian; */
-
-	ti,navigator-dmas = <&dma_xgbe 0>,
-			<&dma_xgbe 8>,
-			<&dma_xgbe 0>;
-	ti,navigator-dma-names = "xnetrx0", "xnetrx1", "xnettx";
-
-	netcp-devices {
-		#address-cells = <1>;
-		#size-cells = <1>;
-		ranges;
-		xgbe@2f00000 {
-			label = "netcp-xgbe";
-			compatible = "ti,netcp-xgbe";
-			syscon-subsys = <&xgbe_subsys>;
-			syscon-pcsr = <&xgbe_pcsr>;
-			reg = <0x02f00100 0x200>, <0x02f01000 0xb00>;
-			/* enable-ale; */
-			tx-queue = <692>;
-			tx-channel = "xnettx";
-			phys = <&xgbe_serdes>;
-
-			interfaces {
-				xgbe0: interface-0 {
-					slave-port = <0>;
-					link-interface	= <11>; /* MAC_MAC */
-				};
-				xgbe1: interface-1 {
-					slave-port = <1>;
-					link-interface	= <11>;
-				};
-			};
-		};
-	};
-
-	netcp-interfaces {
-		interface-0 {
-			rx-channel = "xnetrx0";
-			rx-pool = <2048 12>; /* num_desc region-id */
-			tx-pool = <1024 12>; /* num_desc region-id */
-			rx-queue-depth = <1024 1024 0 0>;
-			rx-buffer-size = <1536 4096 0 0>;
-			rx-queue = <532>;
-			tx-completion-queue = <534>;
-			efuse-mac = <0>;
-			netcp-xgbe = <&xgbe0>;
-
-		};
-		interface-1 {
-			rx-channel = "xnetrx1";
-			rx-pool = <2048 12>; /* num_desc region-id */
-			tx-pool = <1024 12>; /* num_desc region-id */
-			rx-queue-depth = <1024 1024 0 0>;
-			rx-buffer-size = <1536 4096 0 0>;
-			rx-queue = <533>;
-			tx-completion-queue = <535>;
-			efuse-mac = <0>;
-			netcp-xgbe = <&xgbe1>;
 		};
 	};
 };
diff --git a/arch/arm/boot/dts/keystone-k2e.dtsi b/arch/arm/boot/dts/keystone-k2e.dtsi
index 9c7eb5c..8574a66 100644
--- a/arch/arm/boot/dts/keystone-k2e.dtsi
+++ b/arch/arm/boot/dts/keystone-k2e.dtsi
@@ -43,6 +43,10 @@
 		};
 	};
 
+	aliases {
+		rproc0 = &dsp0;
+	};
+
 	soc {
 		/include/ "keystone-k2e-clocks.dtsi"
 
@@ -99,13 +103,19 @@
 			gpio,syscon-dev = <&devctrl 0x240>;
 		};
 
-		pcie1_phy: phy@2326000 {
-			#phy-cells = <0>;
-			compatible = "ti,keystone-serdes-pcie";
-			reg = <0x02326000 0x4000>;
-			link-rate-kbps = <5000000>;
-			num-lanes = <2>;
-			status = "disabled";
+		dsp0: dsp0 {
+			compatible = "ti,k2e-dsp";
+			reg = <0x10800000 0x00080000>,
+			      <0x10e00000 0x00008000>,
+			      <0x10f00000 0x00008000>;
+			reg-names = "l2sram", "l1pram", "l1dram";
+			clocks = <&clkgem0>;
+			ti,syscon-dev = <&devctrl 0x844>;
+			resets = <&pscrst 0>;
+			interrupt-parent = <&kirq0>;
+			interrupts = <0 8>;
+			interrupt-names = "vring", "exception";
+			kick-gpio = <&dspgpio0 27 0>;
 		};
 
 		pcie1: pcie@21020000 {
@@ -115,17 +125,13 @@
 			#address-cells = <3>;
 			#size-cells = <2>;
 			reg =  <0x21021000 0x2000>, <0x21020000 0x1000>, <0x02620128 4>;
-			ranges = <0x82000000 0 0x60000000 0x60000000
-				  0 0x10000000>;
+			ranges = <0x81000000 0 0 0x23260000 0x4000 0x4000
+				0x82000000 0 0x60000000 0x60000000 0 0x10000000>;
 
 			status = "disabled";
 			device_type = "pci";
 			num-lanes = <2>;
-			phys = <&pcie1_phy>;
-			bus-range = <0x00 0xff>;
 
-			/* error interrupt */
-			interrupts = <GIC_SPI 385 IRQ_TYPE_EDGE_RISING>;
 			#interrupt-cells = <1>;
 			interrupt-map-mask = <0 0 0 7>;
 			interrupt-map = <0 0 0 1 &pcie_intc1 0>, /* INT A */
diff --git a/arch/arm/boot/dts/keystone-k2g-evm.dts b/arch/arm/boot/dts/keystone-k2g-evm.dts
index c869508..0eb06b1 100644
--- a/arch/arm/boot/dts/keystone-k2g-evm.dts
+++ b/arch/arm/boot/dts/keystone-k2g-evm.dts
@@ -25,6 +25,12 @@
 		reg = <0x00000008 0x00000000 0x00000000 0x80000000>;
 	};
 
+	soc {
+		mpm_mem: dspmem {
+			compatible = "ti,keystone-dsp-mem";
+			reg = <0x0c000000 0x00100000>;
+		};
+	};
 };
 
 &k2g_pinctrl {
@@ -41,59 +47,3 @@
 	pinctrl-0 = <&uart0_pins>;
 	status = "okay";
 };
-
-&gbe0 {
-	phy-handle = <&ethphy0>;
-};
-
-&mdio {
-	status = "okay";
-	ethphy0: ethernet-phy@0 {
-		reg = <0>;
-		phy-mode = "rgmii-id";
-	};
-};
-
-&qspi {
-	status = "okay";
-
-	flash0: m25p80@0 {
-		compatible = "s25fl512s", "jedec,spi-nor";
-		reg = <0>;
-		spi-tx-bus-width = <1>;
-		spi-rx-bus-width = <4>;
-		spi-max-frequency = <96000000>;
-		#address-cells = <1>;
-		#size-cells = <1>;
-		cdns,read-delay = <5>;
-		cdns,tshsl-ns = <500>;
-		cdns,tsd2d-ns = <500>;
-		cdns,tchsh-ns = <119>;
-		cdns,tslch-ns = <119>;
-
-		partition@0 {
-			label = "QSPI.u-boot-spl-os";
-			reg = <0x00000000 0x00100000>;
-		};
-		partition@1 {
-			label = "QSPI.u-boot-env";
-			reg = <0x00100000 0x00040000>;
-		};
-		partition@2 {
-			label = "QSPI.skern";
-			reg = <0x00140000 0x0040000>;
-		};
-		partition@3 {
-			label = "QSPI.pmmc-firmware";
-			reg = <0x00180000 0x0040000>;
-		};
-		partition@4 {
-			label = "QSPI.kernel";
-			reg = <0x001C0000 0x0800000>;
-		};
-		partition@5 {
-			label = "QSPI.file-system";
-			reg = <0x009C0000 0x3640000>;
-		};
-	};
-};
diff --git a/arch/arm/boot/dts/keystone-k2g-netcp.dtsi b/arch/arm/boot/dts/keystone-k2g-netcp.dtsi
index 8807d5f..8c4dc51 100644
--- a/arch/arm/boot/dts/keystone-k2g-netcp.dtsi
+++ b/arch/arm/boot/dts/keystone-k2g-netcp.dtsi
@@ -1,5 +1,5 @@
 /*
- * Device Tree Source for Keystone 2 Galileo Netcp driver
+ * Device Tree Source for K2G Netcp driver
  *
  * Copyright 2015-2016 Texas Instruments, Inc.
  *
@@ -17,8 +17,8 @@ qmss: qmss@4020000 {
 	clocks = <&k2g_clks K2G_DEV_NSS0 K2G_DEV_NSS_VCLK>;
 	clock-names = "nss_vclk";
 	ranges;
-	queue-range	= <0 0x80>;
-	linkram0	= <0x4020000 0x7ff>;
+	queue-range = <0 0x80>;
+	linkram0 = <0x4020000 0x7ff>;
 
 	qmgrs {
 		#address-cells = <1>;
@@ -39,9 +39,15 @@ qmss: qmss@4020000 {
 		qpend {
 			qpend-0 {
 				qrange = <77 8>;
-				interrupts =<0 308 0xf04 0 309 0xf04 0 310 0xf04
-					     0 311 0xf04 0 312 0xf04 0 313 0xf04
-					     0 314 0xf04 0 315 0xf04>;
+				interrupts =
+					<GIC_SPI 308 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 309 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 310 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 311 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 312 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 313 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 314 IRQ_TYPE_LEVEL_HIGH>,
+					<GIC_SPI 315 IRQ_TYPE_LEVEL_HIGH>;
 				qalloc-by-id;
 			};
 		};
@@ -80,12 +86,12 @@ knav_dmas: knav_dmas@0 {
 
 	dma_gbe: dma_gbe@0 {
 		reg = <0x4010000 0x100>,
-			  <0x4011000 0x2a0>, /* 21 Tx channels */
-			  <0x4012000 0x400>, /* 32 Rx channels */
-			  <0x4010100 0x80>,
-			  <0x4013000 0x400>; /* 32 Rx flows */
+		      <0x4011000 0x2a0>, /* 21 Tx channels */
+		      <0x4012000 0x400>, /* 32 Rx channels */
+		      <0x4010100 0x80>,
+		      <0x4013000 0x400>; /* 32 Rx flows */
 		reg-names = "global", "txchan", "rxchan",
-				"txsched", "rxflow";
+			    "txsched", "rxflow";
 	};
 
 };
diff --git a/arch/arm/boot/dts/keystone-k2g.dtsi b/arch/arm/boot/dts/keystone-k2g.dtsi
index e1727dd..ba4101c 100644
--- a/arch/arm/boot/dts/keystone-k2g.dtsi
+++ b/arch/arm/boot/dts/keystone-k2g.dtsi
@@ -30,6 +30,7 @@
 
 	aliases {
 		serial0 = &uart0;
+		rproc0 = &dsp0;
 	};
 
 	cpus {
@@ -41,31 +42,6 @@
 			device_type = "cpu";
 			reg = <0>;
 		};
-
-	       qspi: qspi@2940000 {
-			compatible = "ti,k2g-qspi", "cdns,qspi-nor";
-			#address-cells = <1>;
-			#size-cells = <0>;
-			reg = <0x02940000 0x1000>,
-			      <0x24000000 0x4000000>;
-			interrupts = <GIC_SPI 198 IRQ_TYPE_EDGE_RISING>;
-			cdns,fifo-depth = <256>;
-			cdns,fifo-width = <4>;
-			cdns,trigger-address = <0x24000000>;
-			power-domains = <&k2g_pds K2G_DEV_QSPI0>;
-			clocks = <&k2g_clks K2G_DEV_QSPI0
-					K2G_DEV_QSPI_QSPI_CLK>,
-				 <&k2g_clks K2G_DEV_QSPI0
-					K2G_DEV_QSPI_DATA_BUS_CLK>,
-				 <&k2g_clks K2G_DEV_QSPI0
-					K2G_DEV_QSPI_CFG_BUS_CLK>,
-				 <&k2g_clks K2G_DEV_QSPI0
-					K2G_DEV_QSPI_QSPI_CLK_O>,
-				 <&k2g_clks K2G_DEV_QSPI0
-					K2G_DEV_QSPI_QSPI_CLK_I>;
-			clock-names = "fck", "datack", "cfgck", "ock", "ick";
-			status = "disabled";
-		};
 	};
 
 	gic: interrupt-controller@02561000 {
@@ -229,18 +205,20 @@
 			gpio,syscon-dev = <&devctrl 0x240>;
 		};
 
-		mdio: mdio@4200f00 {
-			compatible	= "ti,keystone_mdio", "ti,davinci_mdio";
-			#address-cells = <1>;
-			#size-cells = <0>;
-			power-domains = <&k2g_pds K2G_DEV_NSS0>;
-			clocks = <&k2g_clks K2G_DEV_NSS0 K2G_DEV_NSS_ESW_CLK>;
-			clock-names = "fck";
-			reg = <0x04200f00 0x100>;
-			status = "disabled";
-			bus_freq = <2500000>;
+		dsp0: dsp0 {
+			compatible = "ti,k2g-dsp";
+			reg = <0x10800000 0x00100000>,
+			      <0x10e00000 0x00008000>,
+			      <0x10f00000 0x00008000>;
+			reg-names = "l2sram", "l1pram", "l1dram";
+			power-domains = <&k2g_pds K2G_DEV_CGEM0>;
+			clocks = <&k2g_clks K2G_DEV_CGEM0 0>;
+			ti,syscon-dev = <&devctrl 0x844>;
+			resets = <&k2g_reset K2G_DEV_CGEM0 K2G_DEV_CGEM0_DSP0_RESET>;
+			interrupt-parent = <&kirq0>;
+			interrupts = <0 8>;
+			interrupt-names = "vring", "exception";
+			kick-gpio = <&dspgpio0 27 0>;
 		};
-
-		#include "keystone-k2g-netcp.dtsi"
 	};
 };
diff --git a/arch/arm/boot/dts/keystone-k2hk-evm.dts b/arch/arm/boot/dts/keystone-k2hk-evm.dts
index 79280f2..8e647c2 100644
--- a/arch/arm/boot/dts/keystone-k2hk-evm.dts
+++ b/arch/arm/boot/dts/keystone-k2hk-evm.dts
@@ -16,6 +16,18 @@
 	compatible =  "ti,k2hk-evm", "ti,k2hk", "ti,keystone";
 	model = "Texas Instruments Keystone 2 Kepler/Hawking EVM";
 
+	reserved-memory {
+		#address-cells = <2>;
+		#size-cells = <2>;
+		ranges;
+
+		dsp_common_cma_pool: dsp_common_cma_pool {
+			compatible = "shared-dma-pool";
+			reg = <0x00000008 0x1f800000 0x00000000 0x800000>;
+			reusable;
+		};
+	};
+
 	soc {
 		clocks {
 			refclksys: refclksys {
@@ -53,6 +65,11 @@
 				clock-output-names = "refclk-ddr3b";
 			};
 		};
+
+		mpm_mem: dspmem {
+			compatible = "ti,keystone-dsp-mem";
+			reg = <0x0c000000 0x00600000>;
+		};
 	};
 
 	leds {
@@ -181,6 +198,34 @@
 	};
 };
 
-&gbe_serdes {
-	status = "okay";
+&dsp0 {
+	memory-region = <&dsp_common_cma_pool>;
+};
+
+&dsp1 {
+	memory-region = <&dsp_common_cma_pool>;
+};
+
+&dsp2 {
+	memory-region = <&dsp_common_cma_pool>;
+};
+
+&dsp3 {
+	memory-region = <&dsp_common_cma_pool>;
+};
+
+&dsp4 {
+	memory-region = <&dsp_common_cma_pool>;
+};
+
+&dsp5 {
+	memory-region = <&dsp_common_cma_pool>;
+};
+
+&dsp6 {
+	memory-region = <&dsp_common_cma_pool>;
+};
+
+&dsp7 {
+	memory-region = <&dsp_common_cma_pool>;
 };
diff --git a/arch/arm/boot/dts/keystone-k2hk-netcp.dtsi b/arch/arm/boot/dts/keystone-k2hk-netcp.dtsi
index 876d24b..f86d6dd 100644
--- a/arch/arm/boot/dts/keystone-k2hk-netcp.dtsi
+++ b/arch/arm/boot/dts/keystone-k2hk-netcp.dtsi
@@ -59,7 +59,7 @@ qmss: qmss@2a40000 {
 			qpend-1 {
 				qrange = <8704 16>;
 				interrupts = <0 48 0xf04 0 49 0xf04 0 50 0xf04
-					      0 51 0xf04 0 52 0x104 0 53 0x204
+					      0 51 0xf04 0 52 0xf04 0 53 0xf04
 					      0 54 0xf04 0 55 0xf04 0 56 0xf04
 					      0 57 0xf04 0 58 0xf04 0 59 0xf04
 					      0 60 0xf04 0 61 0xf04 0 62 0xf04
@@ -106,7 +106,7 @@ qmss: qmss@2a40000 {
 		ranges;
 		region-12 {
 			id = <12>;
-			region-spec = <10240 128>;	/* num_desc desc_size */
+			region-spec = <8192 128>;	/* num_desc desc_size */
 			link-index = <0x4000>;
 		};
 	};
@@ -143,53 +143,6 @@ knav_dmas: knav_dmas@0 {
 		reg-names = "global", "txchan", "rxchan",
 				"txsched", "rxflow";
 	};
-
-	dma_xgbe: dma_xgbe@0 {
-		reg = <0x2fa1000 0x100>,
-			<0x2fa1400 0x200>,
-			<0x2fa1800 0x200>,
-			<0x2fa1c00 0x200>,
-			<0x2fa2000 0x400>;
-		reg-names = "global", "txchan", "rxchan",
-				"txsched", "rxflow";
-	};
-};
-
-gbe_subsys: subsys@2090000 {
-	compatible = "syscon";
-	reg = <0x02090000 0x100>;
-};
-
-gbe_serdes: phy@232a000 {
-	status			= "disabled";
-	#phy-cells		= <0>;
-	compatible		= "ti,keystone-serdes-gbe";
-	reg			= <0x0232a000 0x2000>;
-	link-rate-kbps		= <1250000>;
-	num-lanes		= <4>;
-	/*rx-force-enable;*/
-	lanes {
-		#address-cells = <1>;
-		#size-cells = <0>;
-		lane@0 {
-			/*loopback;*/
-			reg		= <0>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-		lane@1 {
-			/*loopback;*/
-			reg		= <1>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-	};
 };
 
 netcp: netcp@2000000 {
@@ -202,48 +155,27 @@ netcp: netcp@2000000 {
 	/* NetCP address range */
 	ranges  = <0 0x2000000 0x100000>;
 
-	clocks = <&clkpa>, <&clkcpgmac>, <&chipclk12>;
-	clock-names = "pa_clk", "ethss_clk", "cpts_rft_clk"	;
+	clocks = <&papllclk>, <&clkcpgmac>, <&chipclk12>;
 	dma-coherent;
 
-	ti,navigator-dmas =	<&dma_gbe 22>,	/* rx flow for CPSW port 0 */
-				<&dma_gbe 23>,	/* rx flow for CPSW port 1 */
-				<&dma_gbe 8>,	/* CPSW tx channel */
-				<&dma_gbe 24>,	/* rx flow for CPSW port 2 */
-				<&dma_gbe 25>,	/* rx flow for CPSW port 3 */
-				<&dma_gbe 0>,	/* PA cluster 0 channel */
-				<&dma_gbe 1>,	/* PA cluster 1 channel */
-				<&dma_gbe 2>,	/* PA cluster 2 channel */
-				<&dma_gbe 3>,	/* PA cluster 3 channel */
-				<&dma_gbe 4>,	/* PA cluster 4 channel */
-				<&dma_gbe 5>,	/* PA cluster 5 channel */
-				<&dma_gbe 31>;	/* PA rx flow for cmd rsp */
-	ti,navigator-dma-names = "netrx0",
-				 "netrx1",
-				 "nettx",
-				 "netrx2",
-				 "netrx3",
-				 "pa-cl0",
-				 "pa-cl1",
-				 "pa-cl2",
-				 "pa-cl3",
-				 "pa-cl4",
-				 "pa-cl5",
-				 "pa-cmd-rsp";
+	ti,navigator-dmas = <&dma_gbe 22>,
+			<&dma_gbe 23>,
+			<&dma_gbe 8>;
+	ti,navigator-dma-names = "netrx0", "netrx1", "nettx";
 
 	netcp-devices {
+		ranges;
 		#address-cells = <1>;
 		#size-cells = <1>;
-		ranges;
 		gbe@90000 { /* ETHSS */
+			#address-cells = <1>;
+			#size-cells = <1>;
 			label = "netcp-gbe";
 			compatible = "ti,netcp-gbe";
-			syscon-subsys = <&gbe_subsys>;
-			reg = <0x90100 0x200>, <0x90400 0x200>, <0x90800 0x700>;
+			reg = <0x90000 0x300>, <0x90400 0x400>, <0x90800 0x700>;
 			/* enable-ale; */
 			tx-queue = <648>;
 			tx-channel = "nettx";
-			phys = <&gbe_serdes>;
 
 			interfaces {
 				gbe0: interface-0 {
@@ -269,74 +201,6 @@ netcp: netcp@2000000 {
 				};
 			};
 		};
-
-		pa@0 {
-			#address-cells = <1>;
-			#size-cells = <1>;
-			label = "netcp-pa";
-			compatible = "ti,netcp-pa";
-
-			reg = <0 0x60>,			/* Mailbox */
-				<0x400 0x10>,		/* Packet ID */
-				<0x500 0x40>,		/* LUT2 */
-				<0x604 0x4>,		/* streaming switch */
-				<0x1000 0x600>,		/* Control */
-				<0x3000 0x600>,		/* Timers */
-				<0x6000 0x100>,		/* Statistics */
-				<0x10000 0x30000>,	/* Iram */
-				<0x40000 0x8000>;	/* Sram */
-
-			mac-lut-ranges		= <0 43 56 63>;
-			/* Static reservation in LUT-1 (outer IP)
-			 * used by driver to add IP rules for Rx checksum
-			 * offload.
-			 */
-			ip-lut-ranges		= <61 63>;
-			/* base queue, base flow. Should match with that
-			 * for netrx0
-			 */
-			rx-route		= <8704 22>;
-			tx-cmd-pool		= <256 12>;
-			/* rx command pool */
-			rx-cmd-rsp-pool		= <256 12>;
-			/* rx channel name for command response */
-			rx-cmd-rsp-chan		= "pa-cmd-rsp";
-			rx-cmd-rsp-queue-depth	= <128 32 0 0>;
-			rx-cmd-rsp-buffer-size	= <128 512 0 0>;
-
-			interfaces {
-				pa0: interface-0 {
-					slave-port	= <0>;
-				};
-
-				pa1: interface-1 {
-					slave-port	= <1>;
-				};
-			};
-
-			/* PA clusters that does packet processing */
-			clusters {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cluster@0 {
-					reg = <0>;
-					tx-queue = <640>;
-					tx-channel = "pa-cl0";
-				};
-
-				cluster@1 {
-					reg = <1>;
-					tx-queue = <641>;
-					tx-channel = "pa-cl1";
-				};
-
-				cluster@5 {
-					reg = <5>;
-					tx-queue = <645>;
-					tx-channel = "pa-cl5";
-				};
-			};
-		};
 	};
 
 	netcp-interfaces {
@@ -350,7 +214,6 @@ netcp: netcp@2000000 {
 			tx-completion-queue = <8706>;
 			efuse-mac = <1>;
 			netcp-gbe = <&gbe0>;
-			netcp-pa = <&pa0>;
 
 		};
 		interface-1 {
@@ -364,125 +227,6 @@ netcp: netcp@2000000 {
 			efuse-mac = <0>;
 			local-mac-address = [02 18 31 7e 3e 6f];
 			netcp-gbe = <&gbe1>;
-			netcp-pa = <&pa1>;
-		};
-	};
-};
-
-xgbe_subsys: subsys@2f00000 {
-	status		= "disabled";
-	compatible	= "syscon";
-	reg		= <0x02f00000 0x100>;
-};
-
-xgbe_pcsr: pcsr@2f00600 {
-	status		= "disabled";
-	compatible	= "syscon";
-	reg		= <0x02f00600 0x100>;
-};
-
-xgbe_serdes: phy@231e000 {
-	status			= "disabled";
-	#phy-cells		= <0>;
-	compatible		= "ti,keystone-serdes-xgbe";
-	reg			= <0x0231e000 0x2000>;
-	link-rate-kbps		= <10312500>;
-	num-lanes		= <2>;
-	syscon-peripheral	= <&xgbe_subsys>;
-	syscon-link		= <&xgbe_pcsr>;
-	/*rx-force-enable;*/
-	lanes {
-		#address-cells = <1>;
-		#size-cells = <0>;
-		lane@0 {
-			/*loopback;*/
-			reg		= <0>;
-			control-rate	= <0>; /* full */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <2 0 0 12 4>;
-				/* c1 c2 cm att vreg */
-		};
-		lane@1 {
-			/*loopback;*/
-			reg		= <1>;
-			control-rate	= <0>; /* full */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <2 0 0 12 4>;
-				/* c1 c2 cm att vreg */
-		};
-	};
-};
-
-netcpx: netcp@2f00000 {
-	status		= "disabled";
-	compatible	= "ti,netcp-1.0";
-	#address-cells	= <1>;
-	#size-cells	= <1>;
-	ranges;
-
-	clocks		= <&clkxge>;
-	clock-names	= "xge_clk";
-	dma-coherent;
-	/* big-endian; */
-
-	ti,navigator-dmas = <&dma_xgbe 0>,
-			<&dma_xgbe 8>,
-			<&dma_xgbe 0>;
-	ti,navigator-dma-names = "xnetrx0", "xnetrx1", "xnettx";
-
-	netcp-devices {
-		#address-cells = <1>;
-		#size-cells = <1>;
-		ranges;
-		xgbe@0x2f00000 {
-			label = "netcp-xgbe";
-			compatible = "ti,netcp-xgbe";
-			syscon-subsys = <&xgbe_subsys>;
-			syscon-pcsr = <&xgbe_pcsr>;
-			reg = <0x02f00100 0x200>, <0x02f01000 0xb00>;
-			/* enable-ale; */
-			tx-queue = <8752>;
-			tx-channel = "xnettx";
-			phys = <&xgbe_serdes>;
-
-			interfaces {
-				xgbe0: interface-0 {
-					slave-port = <0>;
-					link-interface	= <11>; /* MAC_MAC */
-				};
-				xgbe1: interface-1 {
-					slave-port = <1>;
-					link-interface	= <11>;
-				};
-			};
-		};
-	};
-
-	netcp-interfaces {
-		interface-0 {
-			rx-channel = "xnetrx0";
-			rx-pool = <2048 12>; /* num_desc region-id */
-			tx-pool = <1024 12>; /* num_desc region-id */
-			rx-queue-depth = <1024 1024 64 0 0>;
-			rx-buffer-size = <1536 4096 0 0>;
-			rx-queue = <8708>;
-			tx-completion-queue = <8710>;
-			efuse-mac = <0>;
-			netcp-xgbe = <&xgbe0>;
-
-		};
-		interface-1 {
-			rx-channel = "xnetrx1";
-			rx-pool = <2048 12>; /* num_desc region-id */
-			tx-pool = <1024 12>; /* num_desc region-id */
-			rx-queue-depth = <1024 1024 0 0>;
-			rx-buffer-size = <1536 4096 0 0>;
-			rx-queue = <8709>;
-			tx-completion-queue = <8711>;
-			efuse-mac = <0>;
-			netcp-xgbe = <&xgbe1>;
 		};
 	};
 };
diff --git a/arch/arm/boot/dts/keystone-k2l-evm.dts b/arch/arm/boot/dts/keystone-k2l-evm.dts
index 3118fb2..adb0362 100644
--- a/arch/arm/boot/dts/keystone-k2l-evm.dts
+++ b/arch/arm/boot/dts/keystone-k2l-evm.dts
@@ -25,6 +25,11 @@
 				clock-output-names = "refclk-sys";
 			};
 		};
+
+		mpm_mem: dspmem {
+			compatible = "ti,keystone-dsp-mem";
+			reg = <0x0c000000 0x00200000>;
+		};
 	};
 };
 
@@ -129,7 +134,3 @@
 		reg = <1>;
 	};
 };
-
-&gbe_serdes0 {
-	status = "okay";
-};
diff --git a/arch/arm/boot/dts/keystone-k2l-netcp.dtsi b/arch/arm/boot/dts/keystone-k2l-netcp.dtsi
index bb57002..5acbd0d 100644
--- a/arch/arm/boot/dts/keystone-k2l-netcp.dtsi
+++ b/arch/arm/boot/dts/keystone-k2l-netcp.dtsi
@@ -127,75 +127,6 @@ knav_dmas: knav_dmas@0 {
 	};
 };
 
-gbe_subsys: subsys@26200000 {
-	compatible = "syscon";
-	reg = <0x26200000 0x100>;
-};
-
-gbe_serdes0: phy@232a000 {
-	status			= "disabled";
-	#phy-cells		= <0>;
-	compatible		= "ti,keystone-serdes-gbe";
-	reg			= <0x0232a000 0x2000>;
-	link-rate-kbps		= <1250000>;
-	num-lanes		= <2>;
-	/*rx-force-enable;*/
-	lanes {
-		#address-cells = <1>;
-		#size-cells = <0>;
-		lane@0 {
-			/*loopback;*/
-			reg		= <0>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-		lane@1 {
-			/*loopback;*/
-			reg		= <1>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-	};
-};
-
-gbe_serdes1: phy@2320000 {
-	status			= "disabled";
-	#phy-cells		= <0>;
-	compatible		= "ti,keystone-serdes-gbe";
-	reg			= <0x02320000 0x2000>;
-	link-rate-kbps		= <1250000>;
-	num-lanes		= <2>;
-	/*rx-force-enable;*/
-	lanes {
-		#address-cells = <1>;
-		#size-cells = <0>;
-		lane@0 {
-			/*loopback;*/
-			reg		= <0>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-		lane@1 {
-			/*loopback;*/
-			reg		= <1>;
-			control-rate	= <2>; /* quart */
-			rx-start	= <7 5>;
-			rx-force	= <1 1>;
-			tx-coeff	= <0 0 0 12 4>;
-			       /* c1 c2 cm att vreg */
-		};
-	};
-};
-
 netcp: netcp@26000000 {
 	reg = <0x2620110 0x8>;
 	reg-names = "efuse";
@@ -206,49 +137,13 @@ netcp: netcp@26000000 {
 	/* NetCP address range */
 	ranges = <0 0x26000000 0x1000000>;
 
-	clocks = <&clkpa>, <&clkcpgmac>, <&chipclk12>, <&clkosr>;
-	clock-names = "pa_clk", "ethss_clk", "cpts_rft_clk", "osr_clk";
+	clocks = <&clkosr>, <&papllclk>, <&clkcpgmac>, <&chipclk12>;
 	dma-coherent;
 
-	ti,navigator-dmas =	<&dma_gbe 0>,
-				<&dma_gbe 8>,
-				<&dma_gbe 0>,
-				<&dma_gbe 22>,
-				<&dma_gbe 23>,
-				<&dma_gbe 24>,
-				<&dma_gbe 25>,
-				<&dma_gbe 27>,
-				<&dma_gbe 28>,
-				<&dma_gbe 29>,
-				<&dma_gbe 30>,
-				<&dma_gbe 8>,
-				<&dma_gbe 9>,
-				<&dma_gbe 10>,
-				<&dma_gbe 11>,
-				<&dma_gbe 12>,
-				<&dma_gbe 13>,
-				<&dma_gbe 14>, /* for egress cluster */
-				<&dma_gbe 31>;
-
-	ti,navigator-dma-names = "netrx0",
-				 "netrx1",
-				 "nettx",
-				 "netrx0-pa",
-				 "netrx1-pa",
-				 "netrx2-pa",
-				 "netrx3-pa",
-				 "netrx4-pa",
-				 "netrx5-pa",
-				 "netrx6-pa",
-				 "netrx7-pa",
-				 "pa-cl0",
-				 "pa-cl1",
-				 "pa-cl2",
-				 "pa-cl3",
-				 "pa-cl4",
-				 "pa-cl5",
-				 "pa-cl6",
-				 "pa-cmd-rsp";
+	ti,navigator-dmas = <&dma_gbe 0>,
+			<&dma_gbe 8>,
+			<&dma_gbe 0>;
+	ti,navigator-dma-names = "netrx0", "netrx1", "nettx";
 
 	netcp-devices {
 		#address-cells = <1>;
@@ -257,12 +152,10 @@ netcp: netcp@26000000 {
 		gbe@200000 { /* ETHSS */
 			label = "netcp-gbe";
 			compatible = "ti,netcp-gbe-5";
-			syscon-subsys = <&gbe_subsys>;
-			reg = <0x200100 0x400>, <0x220000 0x20000>;
+			reg = <0x200000 0x900>, <0x220000 0x20000>;
 			/* enable-ale; */
 			tx-queue = <896>;
 			tx-channel = "nettx";
-			phys = <&gbe_serdes0>, <&gbe_serdes1>;
 
 			interfaces {
 				gbe0: interface-0 {
@@ -288,77 +181,6 @@ netcp: netcp@26000000 {
 				};
 			};
 		};
-
-		pa@0 {
-			#address-cells = <1>;
-			#size-cells = <1>;
-			label = "netcp-pa2";
-			compatible = "ti,netcp-pa2";
-
-			reg = <0 0x100>,		/* Mailbox */
-				<0x400 0x40>,		/* RA bridge */
-				<0x500 0x80>,		/* thread mapper */
-				<0x800 0x1000>,		/* RA */
-				<0x6000 0x100>,		/* Statistics regs */
-				<0x8000 0x100>,		/* Statistics block */
-				<0x400000 0x900000>;	/* cluster memory */
-
-			mac-lut-ranges		= <0 43 56 63>;
-			/* Static reservation in LUT-1 (outer IP)
-			 * used by driver to add IP rules for Rx checksum
-			 * offload.
-			 */
-			ip-lut-ranges		= <61 63>;
-			/* base queue, base flow. Should match with that
-			 * for netrx0
-			 */
-			rx-route		= <528 22>;
-			tx-cmd-pool		= <256 12>;
-			/* rx command pool */
-			rx-cmd-rsp-pool		= <256 12>;
-			/* rx channel name for command response */
-			rx-cmd-rsp-chan		= "pa-cmd-rsp";
-			rx-cmd-rsp-queue-depth	= <128 32 0 0>;
-			rx-cmd-rsp-buffer-size	= <128 512 0 0>;
-
-			/* rx channels get overridden for the interface
-			 * when PA is enabled
-			 */
-			interfaces {
-				pa0: interface-0 {
-					slave-port	= <0>;
-					rx-channel	= "netrx0-pa";
-				};
-
-				pa1: interface-1 {
-					slave-port	= <1>;
-					rx-channel	= "netrx1-pa";
-				};
-			};
-
-			/* PA clusters that does packet processing */
-			clusters {
-				#address-cells = <1>;
-				#size-cells = <0>;
-				cluster@0 {
-					reg = <0>;
-					tx-queue = <904>;
-					tx-channel = "pa-cl0";
-				};
-
-				cluster@1 {
-					reg = <1>;
-					tx-queue = <905>;
-					tx-channel = "pa-cl1";
-				};
-
-				cluster@6 {
-					reg = <6>;
-					tx-queue = <910>;
-					tx-channel = "pa-cl6";
-				};
-			};
-		};
 	};
 
 	netcp-interfaces {
@@ -372,7 +194,6 @@ netcp: netcp@26000000 {
 			tx-completion-queue = <530>;
 			efuse-mac = <1>;
 			netcp-gbe = <&gbe0>;
-			netcp-pa2 = <&pa0>;
 
 		};
 		interface-1 {
@@ -386,7 +207,6 @@ netcp: netcp@26000000 {
 			efuse-mac = <0>;
 			local-mac-address = [02 18 31 7e 3e 7f];
 			netcp-gbe = <&gbe1>;
-			netcp-pa2 = <&pa1>;
 		};
 	};
 };
diff --git a/arch/arm/boot/dts/keystone-k2l.dtsi b/arch/arm/boot/dts/keystone-k2l.dtsi
index 05a8022..a111751 100644
--- a/arch/arm/boot/dts/keystone-k2l.dtsi
+++ b/arch/arm/boot/dts/keystone-k2l.dtsi
@@ -89,155 +89,6 @@
 			};
 		};
 
-		k2l_pmx: pinmux@02620690 {
-			compatible = "pinctrl-single";
-			reg = <0x02620690 0xc>;
-			#address-cells = <1>;
-			#size-cells = <0>;
-			pinctrl-single,bit-per-mux;
-			pinctrl-single,register-width = <32>;
-			pinctrl-single,function-mask = <0x1>;
-			status = "disabled";
-
-			uart3_emifa_pins: pinmux_uart3_emifa_pins {
-				pinctrl-single,bits = <
-					/* UART3_EMIFA_SEL */
-					0x0 0x0  0xc0
-				>;
-			};
-
-			uart2_emifa_pins: pinmux_uart2_emifa_pins {
-			pinctrl-single,bits = <
-					/* UART2_EMIFA_SEL */
-					0x0 0x0  0x30
-				>;
-			};
-
-			uart01_spi2_pins: pinmux_uart01_spi2_pins {
-				pinctrl-single,bits = <
-					/* UART01_SPI2_SEL */
-					0x0 0x0 0x4
-				>;
-			};
-
-			dfesync_rp1_pins: pinmux_dfesync_rp1_pins{
-				pinctrl-single,bits = <
-					/* DFESYNC_RP1_SEL */
-					0x0 0x0 0x2
-				>;
-			};
-
-			avsif_pins: pinmux_avsif_pins {
-				pinctrl-single,bits = <
-					/* AVSIF_SEL */
-					0x0 0x0 0x1
-				>;
-			};
-
-			gpio_emu_pins: pinmux_gpio_emu_pins {
-				pinctrl-single,bits = <
-				/*
-				 * GPIO_EMU_SEL[31]: 0-GPIO31, 1-EMU33
-				 * GPIO_EMU_SEL[30]: 0-GPIO30, 1-EMU32
-				 * GPIO_EMU_SEL[29]: 0-GPIO29, 1-EMU31
-				 * GPIO_EMU_SEL[28]: 0-GPIO28, 1-EMU30
-				 * GPIO_EMU_SEL[27]: 0-GPIO27, 1-EMU29
-				 * GPIO_EMU_SEL[26]: 0-GPIO26, 1-EMU28
-				 * GPIO_EMU_SEL[25]: 0-GPIO25, 1-EMU27
-				 * GPIO_EMU_SEL[24]: 0-GPIO24, 1-EMU26
-				 * GPIO_EMU_SEL[23]: 0-GPIO23, 1-EMU25
-				 * GPIO_EMU_SEL[22]: 0-GPIO22, 1-EMU24
-				 * GPIO_EMU_SEL[21]: 0-GPIO21, 1-EMU23
-				 * GPIO_EMU_SEL[20]: 0-GPIO20, 1-EMU22
-				 * GPIO_EMU_SEL[19]: 0-GPIO19, 1-EMU21
-				 * GPIO_EMU_SEL[18]: 0-GPIO18, 1-EMU20
-				 * GPIO_EMU_SEL[17]: 0-GPIO17, 1-EMU19
-				 */
-					0x4 0x0000 0xFFFE0000
-				>;
-			};
-
-			gpio_timio_pins: pinmux_gpio_timio_pins {
-				pinctrl-single,bits = <
-				/*
-				 * GPIO_TIMIO_SEL[15]: 0-GPIO15, 1-TIMO7
-				 * GPIO_TIMIO_SEL[14]: 0-GPIO14, 1-TIMO6
-				 * GPIO_TIMIO_SEL[13]: 0-GPIO13, 1-TIMO5
-				 * GPIO_TIMIO_SEL[12]: 0-GPIO12, 1-TIMO4
-				 * GPIO_TIMIO_SEL[11]: 0-GPIO11, 1-TIMO3
-				 * GPIO_TIMIO_SEL[10]: 0-GPIO10, 1-TIMO2
-				 * GPIO_TIMIO_SEL[9]: 0-GPIO9, 1-TIMI7
-				 * GPIO_TIMIO_SEL[8]: 0-GPIO8, 1-TIMI6
-				 * GPIO_TIMIO_SEL[7]: 0-GPIO7, 1-TIMI5
-				 * GPIO_TIMIO_SEL[6]: 0-GPIO6, 1-TIMI4
-				 * GPIO_TIMIO_SEL[5]: 0-GPIO5, 1-TIMI3
-				 * GPIO_TIMIO_SEL[4]: 0-GPIO4, 1-TIMI2
-				 */
-					0x4 0x0 0xFFF0
-				>;
-			};
-
-			gpio_spi2cs_pins: pinmux_gpio_spi2cs_pins {
-				pinctrl-single,bits = <
-				/*
-				 * GPIO_SPI2CS_SEL[3]: 0-GPIO3, 1-SPI2CS4
-				 * GPIO_SPI2CS_SEL[2]: 0-GPIO2, 1-SPI2CS3
-				 * GPIO_SPI2CS_SEL[1]: 0-GPIO1, 1-SPI2CS2
-				 * GPIO_SPI2CS_SEL[0]: 0-GPIO0, 1-SPI2CS1
-				 */
-					0x4 0x0 0xF
-				>;
-			};
-
-			gpio_dfeio_pins: pinmux_gpio_dfeio_pins {
-				pinctrl-single,bits = <
-				/*
-				 * GPIO_DFEIO_SEL[31]: 0-DFEIO17, 1-GPIO63
-				 * GPIO_DFEIO_SEL[30]: 0-DFEIO16, 1-GPIO62
-				 * GPIO_DFEIO_SEL[29]: 0-DFEIO15, 1-GPIO61
-				 * GPIO_DFEIO_SEL[28]: 0-DFEIO14, 1-GPIO60
-				 * GPIO_DFEIO_SEL[27]: 0-DFEIO13, 1-GPIO59
-				 * GPIO_DFEIO_SEL[26]: 0-DFEIO12, 1-GPIO58
-				 * GPIO_DFEIO_SEL[25]: 0-DFEIO11, 1-GPIO57
-				 * GPIO_DFEIO_SEL[24]: 0-DFEIO10, 1-GPIO56
-				 * GPIO_DFEIO_SEL[23]: 0-DFEIO9, 1-GPIO55
-				 * GPIO_DFEIO_SEL[22]: 0-DFEIO8, 1-GPIO54
-				 * GPIO_DFEIO_SEL[21]: 0-DFEIO7, 1-GPIO53
-				 * GPIO_DFEIO_SEL[20]: 0-DFEIO6, 1-GPIO52
-				 * GPIO_DFEIO_SEL[19]: 0-DFEIO5, 1-GPIO51
-				 * GPIO_DFEIO_SEL[18]: 0-DFEIO4, 1-GPIO50
-				 * GPIO_DFEIO_SEL[17]: 0-DFEIO3, 1-GPIO49
-				 * GPIO_DFEIO_SEL[16]: 0-DFEIO2, 1-GPIO48
-				 */
-					0x8 0x0 0xFFFF0000
-				>;
-			};
-
-			gpio_emifa_pins: pinmux_gpio_emifa_pins {
-				pinctrl-single,bits = <
-				/*
-				 * GPIO_EMIFA_SEL[15]: 0-EMIFA17, 1-GPIO47
-				 * GPIO_EMIFA_SEL[14]: 0-EMIFA16, 1-GPIO46
-				 * GPIO_EMIFA_SEL[13]: 0-EMIFA15, 1-GPIO45
-				 * GPIO_EMIFA_SEL[12]: 0-EMIFA14, 1-GPIO44
-				 * GPIO_EMIFA_SEL[11]: 0-EMIFA13, 1-GPIO43
-				 * GPIO_EMIFA_SEL[10]: 0-EMIFA10, 1-GPIO42
-				 * GPIO_EMIFA_SEL[9]: 0-EMIFA9, 1-GPIO41
-				 * GPIO_EMIFA_SEL[8]: 0-EMIFA8, 1-GPIO40
-				 * GPIO_EMIFA_SEL[7]: 0-EMIFA7, 1-GPIO39
-				 * GPIO_EMIFA_SEL[6]: 0-EMIFA6, 1-GPIO38
-				 * GPIO_EMIFA_SEL[5]: 0-EMIFA5, 1-GPIO37
-				 * GPIO_EMIFA_SEL[4]: 0-EMIFA4, 1-GPIO36
-				 * GPIO_EMIFA_SEL[3]: 0-EMIFA3, 1-GPIO35
-				 * GPIO_EMIFA_SEL[2]: 0-EMIFA2, 1-GPIO34
-				 * GPIO_EMIFA_SEL[1]: 0-EMIFA1, 1-GPIO33
-				 * GPIO_EMIFA_SEL[0]: 0-EMIFA0, 1-GPIO32
-				 */
-					0x8 0x0 0xFFFF
-				>;
-			};
-		};
-
 		dspgpio0: keystone_dsp_gpio@02620240 {
 			compatible = "ti,keystone-dsp-gpio";
 			gpio-controller;
diff --git a/arch/arm/boot/dts/keystone.dtsi b/arch/arm/boot/dts/keystone.dtsi
index 0408968..ca3d8ce 100644
--- a/arch/arm/boot/dts/keystone.dtsi
+++ b/arch/arm/boot/dts/keystone.dtsi
@@ -21,9 +21,6 @@
 
 	aliases {
 		serial0	= &uart0;
-		spi0 = &spi0;
-		spi1 = &spi1;
-		spi2 = &spi2;
 	};
 
 	memory {
@@ -63,14 +60,6 @@
 			     <GIC_SPI 23 IRQ_TYPE_EDGE_RISING>;
 	};
 
-	psci {
-		compatible	= "arm,psci";
-		method		= "smc";
-		cpu_suspend	= <0x84000001>;
-		cpu_off		= <0x84000002>;
-		cpu_on		= <0x84000003>;
-	};
-
 	soc {
 		#address-cells = <1>;
 		#size-cells = <1>;
@@ -300,15 +289,6 @@
 			ti,syscon-dev = <&devctrl 0x2a0>;
 		};
 
-		pcie0_phy: phy@2320000 {
-			#phy-cells = <0>;
-			compatible = "ti,keystone-serdes-pcie";
-			reg = <0x02320000 0x4000>;
-			link-rate-kbps = <5000000>;
-			num-lanes = <2>;
-			status = "disabled";
-		};
-
 		pcie0: pcie@21800000 {
 			compatible = "ti,keystone-pcie", "snps,dw-pcie";
 			clocks = <&clkpcie>;
@@ -316,17 +296,13 @@
 			#address-cells = <3>;
 			#size-cells = <2>;
 			reg =  <0x21801000 0x2000>, <0x21800000 0x1000>, <0x02620128 4>;
-			ranges = <0x82000000 0 0x50000000 0x50000000
-				  0 0x10000000>;
+			ranges = <0x81000000 0 0 0x23250000 0 0x4000
+				0x82000000 0 0x50000000 0x50000000 0 0x10000000>;
 
 			status = "disabled";
 			device_type = "pci";
 			num-lanes = <2>;
-			phys = <&pcie0_phy>;
-			bus-range = <0x00 0xff>;
 
-			/* error interrupt */
-			interrupts = <GIC_SPI 38 IRQ_TYPE_EDGE_RISING>;
 			#interrupt-cells = <1>;
 			interrupt-map-mask = <0 0 0 7>;
 			interrupt-map = <0 0 0 1 &pcie_intc0 0>, /* INT A */
-- 
1.7.5.4

