From 3be21a59255b0d49a8ecfee75fa4db75dc525d61 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 13 Apr 2015 21:41:21 +0800
Subject: [PATCH 115/256] hwqueue: keystone: fix a wrong call of of_irq

This patch does the similar change of of_irq as what 0c02c800 did:

of/irq: Rename of_irq_map_* functions to of_irq_parse_*

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/hwqueue/keystone_hwqueue.c |   13 ++++++-------
 1 files changed, 6 insertions(+), 7 deletions(-)

diff --git a/drivers/hwqueue/keystone_hwqueue.c b/drivers/hwqueue/keystone_hwqueue.c
index 61a5733..04da1e5 100644
--- a/drivers/hwqueue/keystone_hwqueue.c
+++ b/drivers/hwqueue/keystone_hwqueue.c
@@ -706,13 +706,12 @@ static int khwq_setup_queue_range(struct khwq_device *kdev,
 	}
 
 	for (i = 0; i < RANGE_MAX_IRQS; i++) {
-		struct of_irq oirq;
+		struct of_phandle_args oirq;
 
-		if (of_irq_map_one(node, i, &oirq))
+		if (of_irq_parse_one(node, i, &oirq))
 			break;
 
-		range->irqs[i].irq = irq_create_of_mapping(oirq.controller,
-					oirq.specifier, oirq.size);
+		range->irqs[i].irq = irq_create_of_mapping(&oirq);
 
 		/* Check for a valid IRQ */
 		if (range->irqs[i].irq == IRQ_NONE)
@@ -726,12 +725,12 @@ static int khwq_setup_queue_range(struct khwq_device *kdev,
 		 * For details on encoding of interrupt-cells for ARM GIC,
 		 * refer to Documentation/devicetree/bindings/arm/gic.txt.
 		 */
-		if (oirq.specifier[0])
+		if (oirq.args[0])
 			continue;
 
-		if (oirq.size >= 3)
+		if (oirq.args_count >= 3)
 			range->irqs[i].cpu_map =
-				(oirq.specifier[2] & 0x0000ff00) >> 8;
+				(oirq.args[2] & 0x0000ff00) >> 8;
 	}
 
 	range->num_irqs = min(range->num_irqs, range->num_queues);
-- 
1.7.5.4

