From fdba7fd913d831c5567a0db5ae20c4162b6751d7 Mon Sep 17 00:00:00 2001
From: Murali Karicheri <m-karicheri2@ti.com>
Date: Wed, 9 Oct 2013 13:04:47 -0400
Subject: [PATCH] clocksource: arch_timer: Remove C3_STOP to make tickless work

Taken from:
git://arago-project.org/git/projects/linux-keystone.git
commit 231467d1c854228939657e1cd648ba7a2c65878b

On keystone SOC, we don't support CPUIdle power managements and hence
doesn't need the timers to be marked with C3_STOP. With C3_STOP, the
tickless kernel breaks breaking the kernel timer resolution in absence of
broadcast source.

Lets remove the C3_STOP for now to fix the resolution issue.

Revisit it when CPUIdle functionality comes into equation.

Signed-off-by: Santosh Shilimkar <santosh.shilimkar@ti.com>
Signed-off-by: Murali Karicheri <m-karicheri2@ti.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/clocksource/arm_arch_timer.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/clocksource/arm_arch_timer.c b/drivers/clocksource/arm_arch_timer.c
index a2b2541..dc0ea23 100644
--- a/drivers/clocksource/arm_arch_timer.c
+++ b/drivers/clocksource/arm_arch_timer.c
@@ -125,7 +125,7 @@ static int arch_timer_set_next_event_phys(unsigned long evt,
 
 static int __cpuinit arch_timer_setup(struct clock_event_device *clk)
 {
-	clk->features = CLOCK_EVT_FEAT_ONESHOT | CLOCK_EVT_FEAT_C3STOP;
+	clk->features = CLOCK_EVT_FEAT_ONESHOT;
 	clk->name = "arch_sys_timer";
 	clk->rating = 450;
 	if (arch_timer_use_virtual) {
-- 
1.8.4.93.g57e4c17

