From 59d018d628aaffbe60947e2d01dc2f9d486178a7 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Mon, 29 Nov 2010 19:00:54 +0800
Subject: [PATCH 3/6] p1022ds: DTS: support more features

Extracted from the P1022DS_20100925-ltib.iso vendor drop.

Add nand, i2c sensors, audio, power monitor device nodes in dts file.

Signed-off-by: Jerry Huang <Chang-Ming.Huang@freescale.com>
Signed-off-by: Sandeep Gopalpet <sandeep.kumar@freescale.com>
Signed-off-by: Jiang Yutang <b14898@freescale.com>
Signed-off-by: Tang Yuantian <b29983@freescale.com>
Integrated-by: Jiang Lu <lu.jiang@windriver.com>
---
 arch/powerpc/boot/dts/p1022ds.dts |   90 ++++++++++++++++++++++++++++++++++--
 1 files changed, 85 insertions(+), 5 deletions(-)

diff --git a/arch/powerpc/boot/dts/p1022ds.dts b/arch/powerpc/boot/dts/p1022ds.dts
index da00489..e7f9ca8 100644
--- a/arch/powerpc/boot/dts/p1022ds.dts
+++ b/arch/powerpc/boot/dts/p1022ds.dts
@@ -57,7 +57,8 @@
 
 		ranges = <0x0 0x0 0x0 0xe8000000 0x08000000
 			  0x1 0x0 0x0 0xe0000000 0x08000000
-			  0x2 0x0 0x0 0xffdf0000 0x00008000>;
+			  0x2 0x0 0x0 0xffa00000 0x00040000
+			  0x3 0x0 0x0 0xffdf0000 0x00008000>;
 
 		nor@0,0 {
 			#address-cells = <1>;
@@ -101,6 +102,46 @@
 				read-only;
 			};
 		};
+
+		nand@2,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
+			compatible = "fsl,elbc-fcm-nand";
+			reg = <0x2 0x0 0x40000>;
+
+			partition@0 {
+				reg = <0x0 0x02000000>;
+				label = "u-boot-nand";
+				read-only;
+			};
+
+			partition@2000000 {
+				reg = <0x02000000 0x10000000>;
+				label = "jffs2-nand";
+			};
+
+			partition@12000000 {
+				reg = <0x12000000 0x10000000>;
+				label = "ramdisk-nand";
+				read-only;
+			};
+
+			partition@22000000 {
+				reg = <0x22000000 0x04000000>;
+				label = "kernel-nand";
+			};
+
+			partition@26000000 {
+				reg = <0x26000000 0x01000000>;
+				label = "dtb-nand";
+				read-only;
+			};
+
+			partition@27000000 {
+				reg = <0x27000000 0x19000000>;
+				label = "reserved-nand";
+			};
+		};
 	};
 
 	soc@ffe00000 {
@@ -161,6 +202,31 @@
 				interrupts = <2 0x1>;
 				interrupt-parent = <&mpic>;
 			};
+			adt7461@4c{
+				compatible = "adi,adt7461";
+				reg = <0x4c>;
+			};
+			zl6100@21{
+				compatible = "intersil,zl6100";
+				reg = <0x21>;
+			};
+			zl6100@24{
+				compatible = "intersil,zl6100";
+				reg = <0x24>;
+			};
+			zl6100@26{
+				compatible = "intersil,zl6100";
+				reg = <0x26>;
+			};
+			zl6100@29{
+				compatible = "intersil,zl6100";
+				reg = <0x29>;
+			};
+			wm8776:codec@1a {
+				compatible = "wolfson,wm8776";
+				reg = <0x1a>;
+				clock-frequency = <0xbb8000>;
+			};
 		};
 
 		serial0: serial@4500 {
@@ -223,6 +289,20 @@
 			};
 		};
 
+		ssi@15000 {
+			compatible = "fsl,p1022-ssi";
+			cell-index = <0>;
+			reg = <0x15000 0x100>;
+			interrupt-parent = <&mpic>;
+			interrupts = <75 2>;
+			fsl,mode = "i2s-slave";
+			codec-handle = <&wm8776>;
+			fsl,playback-dma = <&dma00>;
+			fsl,capture-dma = <&dma01>;
+			fsl,fifo-depth = <15>;
+			fsl,ssi-asynchronous = <1>;
+		};
+
 		dma@c300 {
 			#address-cells = <1>;
 			#size-cells = <1>;
@@ -285,15 +365,15 @@
 			reg = <0x21300 0x4>;
 			ranges = <0x0 0x21100 0x200>;
 			cell-index = <0>;
-			dma-channel@0 {
-				compatible = "fsl,eloplus-dma-channel";
+			dma00: dma-channel@0 {
+				compatible = "fsl,ssi-dma-channel";
 				reg = <0x0 0x80>;
 				cell-index = <0>;
 				interrupt-parent = <&mpic>;
 				interrupts = <20 2>;
 			};
-			dma-channel@80 {
-				compatible = "fsl,eloplus-dma-channel";
+			dma01: dma-channel@80 {
+				compatible = "fsl,ssi-dma-channel";
 				reg = <0x80 0x80>;
 				cell-index = <1>;
 				interrupt-parent = <&mpic>;
-- 
1.6.5.2

