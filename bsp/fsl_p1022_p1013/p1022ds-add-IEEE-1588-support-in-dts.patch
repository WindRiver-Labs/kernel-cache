From c8ac406953ea7fead47ffff9de1ba75f7ab8d148 Mon Sep 17 00:00:00 2001
From: Xufeng Zhang <xufeng.zhang@windriver.com>
Date: Tue, 16 Aug 2011 18:04:01 +0800
Subject: [PATCH 05/12] p1022ds: add IEEE 1588 support in dts

Extracted from vendor drop QorIQ-NONDPAA-SDK-V1-20110429_ltib.iso
linux-2.6.35-qoriq-p1022ds-add-IEEE-1588-support-in-dts.patch and
0021-gianfar-1588-Modifying-ptp_timer-node-to-support-158.patch.

Signed-off-by: Jiang Yutang <b14898@freescale.com>
Integrated-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 arch/powerpc/boot/dts/p1022ds.dts       |   13 ++++++++++++-
 arch/powerpc/boot/dts/p1022ds_36bit.dts |   11 +++++++++++
 2 files changed, 23 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/boot/dts/p1022ds.dts b/arch/powerpc/boot/dts/p1022ds.dts
index 1d15a5b..33e4d08 100644
--- a/arch/powerpc/boot/dts/p1022ds.dts
+++ b/arch/powerpc/boot/dts/p1022ds.dts
@@ -1,7 +1,7 @@
 /*
  * P1022 DS Device Tree Source
  *
- * Copyright 2010 Freescale Semiconductor, Inc.
+ * Copyright 2011 Freescale Semiconductor, Inc.
  *
  * This program is free software; you can redistribute  it and/or modify it
  * under  the terms of  the GNU General  Public License as published by the
@@ -441,6 +441,15 @@
 			reg = <0x25000 0x1000 0xb1030 0x4>;
 		};
 
+		ptp_timer: ptimer@b0e00 {
+			compatible = "fsl,gianfar-ptp-timer";
+			reg = <0xb0e00 0xb0>;
+			interrupts = <68 2>;
+			interrupt-parent = <&mpic>;
+			tmr-prsc = <0x2>;
+			cksel = <1>;
+		};
+
 		enet0: ethernet@B0000 {
 			#address-cells = <1>;
 			#size-cells = <1>;
@@ -454,6 +463,7 @@
 			interrupt-parent = <&mpic>;
 			fixed-link = <1 1 1000 0 0>;
 			phy-handle = <&phy0>;
+			ptimer-handle = <&ptp_timer>;
 			phy-connection-type = "rgmii-id";
 			queue-group@0{
 				#address-cells = <1>;
@@ -486,6 +496,7 @@
 			interrupt-parent = <&mpic>;
 			fixed-link = <1 1 1000 0 0>;
 			phy-handle = <&phy1>;
+			ptimer-handle = <&ptp_timer>;
 			phy-connection-type = "rgmii-id";
 			queue-group@0{
 				#address-cells = <1>;
diff --git a/arch/powerpc/boot/dts/p1022ds_36bit.dts b/arch/powerpc/boot/dts/p1022ds_36bit.dts
index dd7c938..82af3a8 100644
--- a/arch/powerpc/boot/dts/p1022ds_36bit.dts
+++ b/arch/powerpc/boot/dts/p1022ds_36bit.dts
@@ -448,6 +448,15 @@
 			reg = <0x25000 0x1000 0xb1030 0x4>;
 		};
 
+		ptp_timer: ptimer@b0e00 {
+			compatible = "fsl,gianfar-ptp-timer";
+			reg = <0xb0e00 0xb0>;
+			interrupts = <68 2>;
+			interrupt-parent = <&mpic>;
+			tmr-prsc = <0x2>;
+			cksel = <1>;
+		};
+
 		enet0: ethernet@B0000 {
 			#address-cells = <1>;
 			#size-cells = <1>;
@@ -463,6 +472,7 @@
 			interrupt-parent = <&mpic>;
 			fixed-link = <1 1 1000 0 0>;
 			phy-handle = <&phy0>;
+			ptimer-handle = <&ptp_timer>;
 			phy-connection-type = "rgmii-id";
 			queue-group@0{
 				#address-cells = <1>;
@@ -493,6 +503,7 @@
 			interrupt-parent = <&mpic>;
 			fixed-link = <1 1 1000 0 0>;
 			phy-handle = <&phy1>;
+			ptimer-handle = <&ptp_timer>;
 			phy-connection-type = "rgmii-id";
 			queue-group@0{
 				#address-cells = <1>;
-- 
1.7.0.4

