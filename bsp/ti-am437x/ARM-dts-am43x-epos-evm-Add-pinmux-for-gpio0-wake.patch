From 825d43c6762205797d4d020b9c84f1ebc45f7f1a Mon Sep 17 00:00:00 2001
From: Dave Gerlach <d-gerlach@ti.com>
Date: Fri, 31 Jan 2014 18:21:53 -0600
Subject: [PATCH 197/285] ARM: dts: am43x-epos-evm: Add pinmux for gpio0 wake

Add pinctrl settings so that gpio0 wake from suspend will be supported
using all buttons on evm. This is accomplished by enabling internal
pull-ups on the row lines of the matrix so that when any button is
depressed the column pins, which are all GPIO0, receive a high signal.

Signed-off-by: Dave Gerlach <d-gerlach@ti.com>
[Kevin: The original patch taken from TI
ti-sdk-am437x-evm-07.01.00.00-Linux-x86-Install.bin]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/arm/boot/dts/am43x-epos-evm.dts |   24 ++++++++++++++++++++++++
 1 files changed, 24 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/am43x-epos-evm.dts b/arch/arm/boot/dts/am43x-epos-evm.dts
index 417b77e..82a45f4 100644
--- a/arch/arm/boot/dts/am43x-epos-evm.dts
+++ b/arch/arm/boot/dts/am43x-epos-evm.dts
@@ -95,6 +95,12 @@
 		debounce-delay-ms = <5>;
 		col-scan-delay-us = <2>;
 
+		pinctrl-names = "default", "sleep";
+		pinctrl-0 = <&matrix_keypad_default>;
+		pinctrl-1 = <&matrix_keypad_sleep>;
+
+		linux,wakeup;
+
 		row-gpios = <&gpio0 12 GPIO_ACTIVE_HIGH	/* Bank0, pin12 */
 				&gpio0 13 GPIO_ACTIVE_HIGH /* Bank0, pin13 */
 				&gpio0 14 GPIO_ACTIVE_HIGH /* Bank0, pin14 */
@@ -432,6 +438,24 @@
 			0x204 (PIN_INPUT_PULLUP | MUX_MODE0)  /* cam1_data7 mode 0*/
 		>;
 	};
+
+	matrix_keypad_default: matrix_keypad_default {
+		pinctrl-single,pins = <
+			0x12c (PIN_OUTPUT | MUX_MODE7)	/* mii1_tx_clk.gpio3_9 */
+			0x130 (PIN_OUTPUT | MUX_MODE7)	/* mii1_rx_clk.gpio3_10 */
+			0x134 (PIN_OUTPUT | MUX_MODE7)	/* mii1_rxd3.gpio2_18 */
+			0x138 (PIN_OUTPUT | MUX_MODE7)	/* mii1_rxd2.gpio2_19 */
+		>;
+	};
+
+	matrix_keypad_sleep: matrix_keypad_sleep {
+		pinctrl-single,pins = <
+			0x12c (PULL_UP | MUX_MODE7)
+			0x130 (PULL_UP | MUX_MODE7)
+			0x134 (PULL_UP | MUX_MODE7)
+			0x138 (PULL_UP | MUX_MODE7)
+		>;
+	};
 };
 
 &gpio0 {
-- 
1.7.5.4

