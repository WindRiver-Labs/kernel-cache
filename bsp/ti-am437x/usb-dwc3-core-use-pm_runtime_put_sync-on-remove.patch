From 96504dcaff2e0e1fe5164fa6bebfecce01376243 Mon Sep 17 00:00:00 2001
From: Felipe Balbi <balbi@ti.com>
Date: Fri, 11 Oct 2013 08:34:28 -0500
Subject: [PATCH 081/285] usb: dwc3: core: use pm_runtime_put_sync() on remove

commit 16b972a592ea2c9a3c2a3c12238de650fd4043a9 upstream

We are going to disable runtime_pm and we're
removing the driver, we must disable the device
now.

Signed-off-by: Felipe Balbi <balbi@ti.com>
---
 drivers/usb/dwc3/core.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/usb/dwc3/core.c b/drivers/usb/dwc3/core.c
index d62d2b3..f88b118 100644
--- a/drivers/usb/dwc3/core.c
+++ b/drivers/usb/dwc3/core.c
@@ -684,7 +684,7 @@ static int dwc3_remove(struct platform_device *pdev)
 	if (dwc->usb3_generic_phy)
 		phy_power_off(dwc->usb3_generic_phy);
 
-	pm_runtime_put(&pdev->dev);
+	pm_runtime_put_sync(&pdev->dev);
 	pm_runtime_disable(&pdev->dev);
 
 	dwc3_debugfs_exit(dwc);
-- 
1.7.5.4

