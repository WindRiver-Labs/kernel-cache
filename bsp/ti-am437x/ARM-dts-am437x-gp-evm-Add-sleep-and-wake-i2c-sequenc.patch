From 7cf0cc2d26f6bfd2f74da2c74040cd83b86ed500 Mon Sep 17 00:00:00 2001
From: Dave Gerlach <d-gerlach@ti.com>
Date: Wed, 5 Feb 2014 14:46:48 -0600
Subject: [PATCH 221/285] ARM: dts: am437x-gp-evm: Add sleep and wake i2c
 sequences

Add proper sequences to i2c0 node to control PMIC during DS0 transition
and scale voltages on CORE and MPU. The sequences are specific to
the am437x-gp-evm layout and PMIC, the TPS65218. The sequences are
written out by the Cortex-M3.

Signed-off-by: Dave Gerlach <d-gerlach@ti.com>
[Kevin: The original patch taken from TI
ti-sdk-am437x-evm-07.01.00.00-Linux-x86-Install.bin]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/arm/boot/dts/am437x-gp-evm.dts |   20 ++++++++++++++++++++
 1 files changed, 20 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/am437x-gp-evm.dts b/arch/arm/boot/dts/am437x-gp-evm.dts
index f7a102e..c11e3f5 100644
--- a/arch/arm/boot/dts/am437x-gp-evm.dts
+++ b/arch/arm/boot/dts/am437x-gp-evm.dts
@@ -431,6 +431,26 @@
         pinctrl-0 = <&i2c0_pins>;
 	clock-frequency = <100000>;
 
+	/* Set OPP50 (0.95V) for VDD MPU and core */
+	sleep-sequence = /bits/ 8 <
+		0x02 0x24 0x10 0x6b /* Password unlock 1 */
+		0x02 0x24 0x16 0x8A /* Set DCDC1 (Core) to 0.95V */
+		0x02 0x24 0x10 0x6A /* Password unlock 2 */
+		0x02 0x24 0x17 0x8A /* Set DCDC2 (MPU) to 0.95V */
+		0x02 0x24 0x10 0x67 /* Password unlock 3 */
+		0x02 0x24 0x1A 0x86 /* Apply DCDC changes */
+	>;
+
+	/* Set OPP100 (1.10V) for VDD core */
+	wake-sequence = /bits/ 8 <
+		0x02 0x24 0x10 0x6B /* Password unlock 2 */
+		0x02 0x24 0x16 0x99 /* Set DCDC1 (Core) to 1.1V */
+		0x02 0x24 0x10 0x6A /* Password unlock 1 */
+		0x02 0x24 0x17 0x99 /* Set DCDC2 (MPU)to 1.1V */
+		0x02 0x24 0x10 0x67 /* Password unlock 3 */
+		0x02 0x24 0x1A 0x86 /* Apply DCDC changes */
+	>;
+
 	tps65218: tps65218@24 {
 		reg = <0x24>;
 		compatible = "ti,tps65218";
-- 
1.7.5.4

