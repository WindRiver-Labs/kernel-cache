From f5b1dcd2f6fb1831502213fa9fd21341dfc55715 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Fri, 7 Mar 2014 10:00:52 +0800
Subject: [PATCH 178/188] arm: dts: am33xx: update the latest updates

back-porting am33xx the latest updates from branch ti-linux-3.12.y
in the following git repo.:

git://git.ti.com/ti-linux-kernel/ti-linux-kernel.git

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/boot/dts/am335x-evm.dts   |  236 +++++++++++++++++++++++++++++-------
 arch/arm/boot/dts/am335x-evmsk.dts |  115 +++++++++++++++---
 arch/arm/boot/dts/am33xx.dtsi      |    2 +-
 3 files changed, 290 insertions(+), 63 deletions(-)

diff --git a/arch/arm/boot/dts/am335x-evm.dts b/arch/arm/boot/dts/am335x-evm.dts
index d1637f0..46bd1a6 100644
--- a/arch/arm/boot/dts/am335x-evm.dts
+++ b/arch/arm/boot/dts/am335x-evm.dts
@@ -26,9 +26,9 @@
 
 	am33xx_pinmux: pinmux@44e10800 {
 		pinctrl-names = "default";
-		pinctrl-0 = <&matrix_keypad_s0 &volume_keys_s0 &clkout2_pin &mmc2_pins &wlan_pins>;
+		pinctrl-0 = <&volume_keys_s0 &clkout2_pin &mmc2_pins &wlan_pins>;
 
-		matrix_keypad_s0: matrix_keypad_s0 {
+		matrix_keypad_default: matrix_keypad_default {
 			pinctrl-single,pins = <
 				0x54 (PIN_OUTPUT_PULLDOWN | MUX_MODE7)	/* gpmc_a5.gpio1_21 */
 				0x58 (PIN_OUTPUT_PULLDOWN | MUX_MODE7)	/* gpmc_a6.gpio1_22 */
@@ -38,6 +38,13 @@
 			>;
 		};
 
+		matrix_keypad_sleep: matrix_keypad_sleep {
+			pinctrl-single,pins = <
+				0x54 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_a5.gpio1_21 */
+				0x58 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_a6.gpio1_22 */
+			>;
+		};
+
 		volume_keys_s0: volume_keys_s0 {
 			pinctrl-single,pins = <
 				0x150 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* spi0_sclk.gpio0_2 */
@@ -66,13 +73,31 @@
 			>;
 		};
 
+		uart1_pins_default: pinmux_uart1_pins_default {
+			pinctrl-single,pins = <
+				0x178 (PIN_INPUT | MUX_MODE0)			/* uart1_ctsn.uart1_ctsn */
+				0x17C (PIN_OUTPUT_PULLDOWN | MUX_MODE0)	/* uart1_rtsn.uart1_rtsn */
+				0x180 (PIN_INPUT_PULLUP | MUX_MODE0)	/* uart1_rxd.uart1_rxd */
+				0x184 (PIN_OUTPUT_PULLDOWN | MUX_MODE0) 	/* uart1_txd.uart1_txd */
+			>;
+		};
+
+		uart1_pins_sleep: pinmux_uart1_pins_sleep {
+			pinctrl-single,pins = <
+				0x178 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x17C (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x180 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x184 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+			>;
+		};
+
 		clkout2_pin: pinmux_clkout2_pin {
 			pinctrl-single,pins = <
 				0x1b4 (PIN_OUTPUT_PULLDOWN | MUX_MODE3)	/* xdma_event_intr1.clkout2 */
 			>;
 		};
 
-		nandflash_pins_s0: nandflash_pins_s0 {
+		nandflash_pins_default: nandflash_pins_default {
 			pinctrl-single,pins = <
 				0x0 (PIN_INPUT_PULLUP | MUX_MODE0)	/* gpmc_ad0.gpmc_ad0 */
 				0x4 (PIN_INPUT_PULLUP | MUX_MODE0)	/* gpmc_ad1.gpmc_ad1 */
@@ -92,12 +117,38 @@
 			>;
 		};
 
-		ecap0_pins: backlight_pins {
+		nandflash_pins_sleep: nandflash_pins_sleep {
+			pinctrl-single,pins = <
+				0x0 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x4 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x8 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0xc (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x10 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x14 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x18 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x1c (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x70 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x74 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x7c (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x90 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x94 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x98 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x9c (PIN_INPUT_PULLDOWN | MUX_MODE7)
+			>;
+		};
+
+		ecap0_pins_default: backlight_pins {
 			pinctrl-single,pins = <
 				0x164 0x0	/* eCAP0_in_PWM0_out.eCAP0_in_PWM0_out MODE0 */
 			>;
 		};
 
+		ecap0_pins_sleep: ecap0_pins_sleep {
+			pinctrl-single,pins = <
+				0x164  (PULL_DISABLE | MUX_MODE7)	/* eCAP0_in_PWM0_out.eCAP0_in_PWM0_out */
+			>;
+		};
+
 		cpsw_default: cpsw_default {
 			pinctrl-single,pins = <
 				/* Slave 1 */
@@ -150,14 +201,33 @@
 			>;
 		};
 
-		mmc1_pins: pinmux_mmc1_pins {
+		mmc1_pins_default: pinmux_mmc1_pins {
 			pinctrl-single,pins = <
-				0x160 (PIN_INPUT | MUX_MODE7) /* spi0_cs1.gpio0_6 */
-				0x1A0 (PIN_INPUT_PULLUP | MUX_MODE7) /* mcasp0_aclkr.gpio3_18 */
+				0x0F0 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_dat3.mmc0_dat3 */
+				0x0F4 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_dat2.mmc0_dat2 */
+				0x0F8 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_dat1.mmc0_dat1 */
+				0x0FC (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_dat0.mmc0_dat0 */
+				0x100 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_clk.mmc0_clk */
+				0x104 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_cmd.mmc0_cmd */
+				0x1A0 (PIN_INPUT_PULLUP | MUX_MODE7)	/* mcasp0_aclkr.gpio3_18 */
+				0x160 (PIN_INPUT | MUX_MODE7)		/* spi0_cs1.gpio0_6 */
 			>;
 		};
 
-		lcd_pins_s0: lcd_pins_s0 {
+		mmc1_pins_sleep: pinmux_mmc1_pins_sleep {
+			pinctrl-single,pins = <
+				0x0F0 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x0F4 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x0F8 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x0FC (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x100 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x104 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x1A0 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x160 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+			>;
+		};
+
+		lcd_pins_default: lcd_pins_default {
 			pinctrl-single,pins = <
 				0x20 0x01	/* gpmc_ad8.lcd_data16, OUTPUT | MODE1 */
 				0x24 0x01	/* gpmc_ad9.lcd_data17, OUTPUT | MODE1 */
@@ -190,15 +260,57 @@
 			>;
 		};
 
-		am335x_evm_audio_pins: am335x_evm_audio_pins {
+		lcd_pins_sleep: lcd_pins_sleep {
 			pinctrl-single,pins = <
-				0x10c (PIN_INPUT_PULLDOWN | MUX_MODE4) /* mii1_rx_dv.mcasp1_aclkx */
-				0x110 (PIN_INPUT_PULLDOWN | MUX_MODE4) /* mii1_txd3.mcasp1_fsx */
+				0x20 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad8.lcd_data16 */
+				0x24 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad9.lcd_data17 */
+				0x28 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad10.lcd_data18 */
+				0x2c (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad11.lcd_data19 */
+				0x30 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad12.lcd_data20 */
+				0x34 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad13.lcd_data21 */
+				0x38 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad14.lcd_data22 */
+				0x3c (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad15.lcd_data23 */
+				0xa0 (PULL_DISABLE | MUX_MODE7)		/* lcd_data0.lcd_data0 */
+				0xa4 (PULL_DISABLE | MUX_MODE7)		/* lcd_data1.lcd_data1 */
+				0xa8 (PULL_DISABLE | MUX_MODE7)		/* lcd_data2.lcd_data2 */
+				0xac (PULL_DISABLE | MUX_MODE7)		/* lcd_data3.lcd_data3 */
+				0xb0 (PULL_DISABLE | MUX_MODE7)		/* lcd_data4.lcd_data4 */
+				0xb4 (PULL_DISABLE | MUX_MODE7)		/* lcd_data5.lcd_data5 */
+				0xb8 (PULL_DISABLE | MUX_MODE7)		/* lcd_data6.lcd_data6 */
+				0xbc (PULL_DISABLE | MUX_MODE7)		/* lcd_data7.lcd_data7 */
+				0xc0 (PULL_DISABLE | MUX_MODE7)		/* lcd_data8.lcd_data8 */
+				0xc4 (PULL_DISABLE | MUX_MODE7)		/* lcd_data9.lcd_data9 */
+				0xc8 (PULL_DISABLE | MUX_MODE7)		/* lcd_data10.lcd_data10 */
+				0xcc (PULL_DISABLE | MUX_MODE7)		/* lcd_data11.lcd_data11 */
+				0xd0 (PULL_DISABLE | MUX_MODE7)		/* lcd_data12.lcd_data12 */
+				0xd4 (PULL_DISABLE | MUX_MODE7)		/* lcd_data13.lcd_data13 */
+				0xd8 (PULL_DISABLE | MUX_MODE7)		/* lcd_data14.lcd_data14 */
+				0xdc (PULL_DISABLE | MUX_MODE7)		/* lcd_data15.lcd_data15 */
+				0xe0 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* lcd_vsync.lcd_vsync, OUTPUT | MODE0 */
+				0xe4 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* lcd_hsync.lcd_hsync */
+				0xe8 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* lcd_pclk.lcd_pclk */
+				0xec (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* lcd_ac_bias_en.lcd_ac_bias_en */
+			>;
+		};
+
+		mcasp1_pins: mcasp1_pins {
+			pinctrl-single,pins = <
+				0x10c (PIN_INPUT_PULLDOWN | MUX_MODE4) /* mii1_crs.mcasp1_aclkx */
+				0x110 (PIN_INPUT_PULLDOWN | MUX_MODE4) /* mii1_rxerr.mcasp1_fsx */
 				0x108 (PIN_OUTPUT_PULLDOWN | MUX_MODE4) /* mii1_col.mcasp1_axr2 */
 				0x144 (PIN_INPUT_PULLDOWN | MUX_MODE4) /* rmii1_ref_clk.mcasp1_axr3 */
 			>;
 		};
 
+		mcasp1_sleep_pins: mcasp1_sleep_pins {
+			pinctrl-single,pins = <
+				0x10c (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x110 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x108 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x144 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+			>;
+		};
+
 		/* wl12xx/wl18xx card on mmc2 */
 		mmc2_pins: pinmux_mmc2_pins {
 			pinctrl-single,pins = <
@@ -211,13 +323,11 @@
 			>;
 		};
 
-		/* wl12xx/wl18xx card enable/irq GPIOs. works with ECO board
-		   for wowlan.*/
+		/* wl12xx/wl18xx card enable/irq GPIOs. */
 		wlan_pins: pinmux_wlan_pins {
 			pinctrl-single,pins = <
-				/* TODO: disable pullup when WLAN is off (saves power?) */
-				0x198 0x17	/* mcasp0_axr0.gpio3_16, OUTPUT_PULLUP | MODE7 */
-				0x1B0 0x27	/* xdma_event_intr0.gpio0_19, INPUT | MODE7 */
+				0x40 0x07	/* gpmc_a0.gpio1_16, OUTPUT | MODE7 */
+				0x19C 0x27	/* mcasp0_ahclkr.gpio3_17, INPUT | MODE7 */
 				0x1AC 0x17	/* mcasp0_ahclkx.gpio3_21, OUTPUT_PULLUP | MODE7 */
 			>;
 		};
@@ -231,6 +341,14 @@
 			status = "okay";
 		};
 
+		uart1: serial@48022000 {
+			pinctrl-names = "default", "sleep";
+			pinctrl-0 = <&uart1_pins_default>;
+			pinctrl-1 = <&uart1_pins_sleep>;
+
+			status = "okay";
+		};
+
 		i2c0: i2c@44e0b000 {
 			pinctrl-names = "default";
 			pinctrl-0 = <&i2c0_pins>;
@@ -348,20 +466,21 @@
 
 			ecap0: ecap@48300100 {
 				status = "okay";
-				pinctrl-names = "default";
-				pinctrl-0 = <&ecap0_pins>;
+				pinctrl-names = "default", "sleep";
+				pinctrl-0 = <&ecap0_pins_default>;
+				pinctrl-1 = <&ecap0_pins_sleep>;
 			};
 		};
 
 		gpmc: gpmc@50000000 {
 			status = "okay";
-			pinctrl-names = "default";
-			pinctrl-0 = <&nandflash_pins_s0>;
+			pinctrl-names = "default", "sleep";
+			pinctrl-0 = <&nandflash_pins_default>;
+			pinctrl-1 = <&nandflash_pins_sleep>;
 			ranges = <0 0 0x08000000 0x10000000>;	/* CS0: NAND */
 			nand@0,0 {
 				reg = <0 0 0>; /* CS0, offset 0 */
 				nand-bus-width = <8>;
-				ti,nand-ecc-opt= "bch8";
 				gpmc,device-width = <1>;
 				gpmc,sync-clk-ps = <0>;
 				gpmc,cs-on-ns = <0>;
@@ -385,56 +504,61 @@
 				gpmc,wait-monitoring-ns = <0>;
 				gpmc,wr-access-ns = <40>;
 				gpmc,wr-data-mux-bus-ns = <0>;
-				#address-cells = <1>;
-				#size-cells = <1>;
+				ti,nand-ecc-opt= "bch8";
 				ti,elm-id = <&elm>;
 				/* MTD partition table */
+		                /* All SPL-* partitions are sized to minimal length
+				 * which can be independently programmable. For
+				 * NAND flash this is equal to size of erase-block */
+				#address-cells = <1>;
+				#size-cells = <1>;
 				partition@0 {
-					label = "SPL";
+					label = "NAND.SPL";
 					reg = <0x00000000 0x000020000>;
 				};
 				partition@1 {
-					label = "SPL.backup1";
+					label = "NAND.SPL.backup1";
 					reg = <0x00020000 0x00020000>;
 				};
 				partition@2 {
-					label = "SPL.backup2";
+					label = "NAND.SPL.backup2";
 					reg = <0x00040000 0x00020000>;
 				};
 				partition@3 {
-					label = "SPL.backup3";
-					reg = <0x00060000 0x000A0000>;
+					label = "NAND.SPL.backup3";
+					reg = <0x00060000 0x00020000>;
 				};
 				partition@4 {
-					label = "u-boot";
-					reg = <0x00100000 0x00100000>;
+					label = "NAND.u-boot-spl-os";
+					reg = <0x00080000 0x00040000>;
 				};
 				partition@5 {
-					label = "u-boot-spl-os";
-					reg = <0x00200000 0x00080000>;
+					label = "NAND.u-boot";
+					reg = <0x000C0000 0x00100000>;
 				};
 				partition@6 {
-					label = "u-boot-env";
-					reg = <0x00280000 0x00040000>;
+					label = "NAND.u-boot-env";
+					reg = <0x001C0000 0x00020000>;
 				};
 				partition@7 {
-					label = "u-boot-env.backup1";
-					reg = <0x002c0000 0x00040000>;
+					label = "NAND.u-boot-env.backup1";
+					reg = <0x001E0000 0x00020000>;
 				};
 				partition@8 {
-					label = "kernel";
-					reg = <0x00300000 0x00500000>;
+					label = "NAND.kernel";
+					reg = <0x00200000 0x00800000>;
 				};
 				partition@9 {
-					label = "file-system";
-					reg = <0x00800000 0x0F800000>;
+					label = "NAND.file-system";
+					reg = <0x00A00000 0x0F600000>;
 				};
 			};
 		};
 
 		lcdc: lcdc@0x4830e000 {		
-			pinctrl-names = "default";
-			pinctrl-0 = <&lcd_pins_s0>;
+			pinctrl-names = "default", "sleep";
+			pinctrl-0 = <&lcd_pins_default>;
+			pinctrl-1 = <&lcd_pins_sleep>;
 			status = "okay";
 			display-timings {
 				800x480p62 {
@@ -500,6 +624,10 @@
 		debounce-delay-ms = <5>;
 		col-scan-delay-us = <2>;
 
+		pinctrl-names = "default", "sleep";
+		pinctrl-0 = <&matrix_keypad_default>;
+		pinctrl-1 = <&matrix_keypad_sleep>;
+
 		row-gpios = <&gpio1 25 GPIO_ACTIVE_HIGH		/* Bank1, pin25 */
 			     &gpio1 26 GPIO_ACTIVE_HIGH		/* Bank1, pin26 */
 			     &gpio1 27 GPIO_ACTIVE_HIGH>;	/* Bank1, pin27 */
@@ -547,7 +675,7 @@
 		compatible = "ti,tilcdc,panel";
 		status = "okay";
 		pinctrl-names = "default";
-		pinctrl-0 = <&lcd_pins_s0>;
+		pinctrl-0 = <&lcd_pins_default>;
 		panel-info {
 			ac-bias           = <255>;
 			ac-bias-intrpt    = <0>;
@@ -593,13 +721,26 @@
 		board-ref-clock = <4>;
 	};
 
+	kim {
+		compatible = "kim";
+		nshutdown_gpio = <117>; /* Bank3, pin21 */
+		dev_name = "/dev/ttyO1";
+		flow_cntrl = <1>;
+		baud_rate = <3000000>;
+	};
+
+	btwilink {
+		compatible = "btwilink";
+	};
+
 };
 
 #include "tps65910.dtsi"
 
 &mcasp1 {
-		pinctrl-names = "default";
-		pinctrl-0 = <&am335x_evm_audio_pins>;
+		pinctrl-names = "default", "sleep";
+		pinctrl-0 = <&mcasp1_pins>;
+		pinctrl-1 = <&mcasp1_sleep_pins>;
 
 		status = "okay";
 
@@ -726,8 +867,9 @@
 	status = "okay";
 	vmmc-supply = <&vmmc_reg>;
 	bus-width = <4>;
-	pinctrl-names = "default";
-	pinctrl-0 = <&mmc1_pins>;
+	pinctrl-names = "default", "sleep";
+	pinctrl-0 = <&mmc1_pins_default>;
+	pinctrl-1 = <&mmc1_pins_sleep>;
 	cd-gpios = <&gpio0 6 GPIO_ACTIVE_HIGH>;
 	wp-gpios = <&gpio3 18 GPIO_ACTIVE_HIGH>;
 };
diff --git a/arch/arm/boot/dts/am335x-evmsk.dts b/arch/arm/boot/dts/am335x-evmsk.dts
index d2f8b96..61b9477 100644
--- a/arch/arm/boot/dts/am335x-evmsk.dts
+++ b/arch/arm/boot/dts/am335x-evmsk.dts
@@ -41,7 +41,7 @@
 			>;
 		};
 
-		lcd_pins_s0: lcd_pins_s0 {
+		lcd_pins_default: lcd_pins_default {
 			pinctrl-single,pins = <
 				0x20 0x01	/* gpmc_ad8.lcd_data16, OUTPUT | MODE1 */
 				0x24 0x01	/* gpmc_ad9.lcd_data17, OUTPUT | MODE1 */
@@ -74,7 +74,40 @@
 			>;
 		};
 
-		user_leds_s0: user_leds_s0 {
+		lcd_pins_sleep: lcd_pins_sleep {
+			pinctrl-single,pins = <
+				0x20 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad8.lcd_data16 */
+				0x24 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad9.lcd_data17 */
+				0x28 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad10.lcd_data18 */
+				0x2c (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad11.lcd_data19 */
+				0x30 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad12.lcd_data20 */
+				0x34 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad13.lcd_data21 */
+				0x38 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad14.lcd_data22 */
+				0x3c (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad15.lcd_data23 */
+				0xa0 (PULL_DISABLE | MUX_MODE7)		/* lcd_data0.lcd_data0 */
+				0xa4 (PULL_DISABLE | MUX_MODE7)		/* lcd_data1.lcd_data1 */
+				0xa8 (PULL_DISABLE | MUX_MODE7)		/* lcd_data2.lcd_data2 */
+				0xac (PULL_DISABLE | MUX_MODE7)		/* lcd_data3.lcd_data3 */
+				0xb0 (PULL_DISABLE | MUX_MODE7)		/* lcd_data4.lcd_data4 */
+				0xb4 (PULL_DISABLE | MUX_MODE7)		/* lcd_data5.lcd_data5 */
+				0xb8 (PULL_DISABLE | MUX_MODE7)		/* lcd_data6.lcd_data6 */
+				0xbc (PULL_DISABLE | MUX_MODE7)		/* lcd_data7.lcd_data7 */
+				0xc0 (PULL_DISABLE | MUX_MODE7)		/* lcd_data8.lcd_data8 */
+				0xc4 (PULL_DISABLE | MUX_MODE7)		/* lcd_data9.lcd_data9 */
+				0xc8 (PULL_DISABLE | MUX_MODE7)		/* lcd_data10.lcd_data10 */
+				0xcc (PULL_DISABLE | MUX_MODE7)		/* lcd_data11.lcd_data11 */
+				0xd0 (PULL_DISABLE | MUX_MODE7)		/* lcd_data12.lcd_data12 */
+				0xd4 (PULL_DISABLE | MUX_MODE7)		/* lcd_data13.lcd_data13 */
+				0xd8 (PULL_DISABLE | MUX_MODE7)		/* lcd_data14.lcd_data14 */
+				0xdc (PULL_DISABLE | MUX_MODE7)		/* lcd_data15.lcd_data15 */
+				0xe0 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* lcd_vsync.lcd_vsync, OUTPUT | MODE0 */
+				0xe4 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* lcd_hsync.lcd_hsync */
+				0xe8 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* lcd_pclk.lcd_pclk */
+				0xec (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* lcd_ac_bias_en.lcd_ac_bias_en */
+			>;
+		};
+
+		user_leds_default: user_leds_default {
 			pinctrl-single,pins = <
 				0x10 (PIN_OUTPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad4.gpio1_4 */
 				0x14 (PIN_OUTPUT_PULLDOWN | MUX_MODE7)	/* gpmc_ad5.gpio1_5 */
@@ -83,6 +116,15 @@
 			>;
 		};
 
+		user_leds_sleep: user_leds_sleep {
+			pinctrl-single,pins = <
+				0x10 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_a5.gpio1_21 */
+				0x14 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_a6.gpio1_22 */
+				0x18 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_a7.gpio1_23 */
+				0x1c (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_a8.gpio1_24 */
+			>;
+		};
+
 		gpio_keys_s0: gpio_keys_s0 {
 			pinctrl-single,pins = <
 				0x94 (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* gpmc_oen_ren.gpio2_3 */
@@ -118,12 +160,18 @@
 			>;
 		};
 
-		ecap2_pins: backlight_pins {
+		ecap2_pins_default: backlight_pins {
 			pinctrl-single,pins = <
 				0x19c 0x4	/* mcasp0_ahclkr.ecap2_in_pwm2_out MODE4 */
 			>;
 		};
 
+		ecap2_pins_sleep: ecap2_pins_sleep {
+			pinctrl-single,pins = <
+				0x19c (PIN_INPUT_PULLDOWN | MUX_MODE7)	/* mcasp0_ahclkr.ecap2_in_pwm2_out */
+			>;
+		};
+
 		cpsw_default: cpsw_default {
 			pinctrl-single,pins = <
 				/* Slave 1 */
@@ -204,9 +252,29 @@
 			>;
 		};
 
-		mmc1_pins: pinmux_mmc1_pins {
+		mmc1_pins_default: pinmux_mmc1_pins {
 			pinctrl-single,pins = <
-				0x160 (PIN_INPUT | MUX_MODE7) /* spi0_cs1.gpio0_6 */
+				0x0F0 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_dat3.mmc0_dat3 */
+				0x0F4 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_dat2.mmc0_dat2 */
+				0x0F8 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_dat1.mmc0_dat1 */
+				0x0FC (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_dat0.mmc0_dat0 */
+				0x100 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_clk.mmc0_clk */
+				0x104 (PIN_INPUT_PULLUP | MUX_MODE0)	/* mmc0_cmd.mmc0_cmd */
+				0x1A0 (PIN_INPUT_PULLUP | MUX_MODE7)	/* mcasp0_aclkr.gpio3_18 */
+				0x160 (PIN_INPUT | MUX_MODE7)		/* spi0_cs1.gpio0_6 */
+			>;
+		};
+
+		mmc1_pins_sleep: pinmux_mmc1_pins_sleep {
+			pinctrl-single,pins = <
+				0x0F0 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x0F4 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x0F8 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x0FC (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x100 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x104 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x1A0 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x160 (PIN_INPUT_PULLDOWN | MUX_MODE7)
 			>;
 		};
 
@@ -218,6 +286,16 @@
 				0x144 (PIN_INPUT_PULLDOWN | MUX_MODE4) /* rmii1_ref_clk.mcasp1_axr3 */
 			>;
 		};
+
+		mcasp1_sleep_pins: mcasp1_sleep_pins {
+			pinctrl-single,pins = <
+				0x10c (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x110 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x108 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+				0x144 (PIN_INPUT_PULLDOWN | MUX_MODE7)
+			>;
+		};
+
 	};
 
 	ocp {
@@ -324,14 +402,16 @@
 
 			ecap2: ecap@48304100 {
 				status = "okay";
-				pinctrl-names = "default";
-				pinctrl-0 = <&ecap2_pins>;
+				pinctrl-names = "default", "sleep";
+				pinctrl-0 = <&ecap2_pins_default>;
+				pinctrl-1 = <&ecap2_pins_sleep>;
 			};
 		};
 
 		lcdc: lcdc@0x4830e000 {
-			pinctrl-names = "default";
-			pinctrl-0 = <&lcd_pins_s0>;
+			pinctrl-names = "default", "sleep";
+			pinctrl-0 = <&lcd_pins_default>;
+			pinctrl-1 = <&lcd_pins_sleep>;
 			status = "okay";
 			display-timings {
 				480x272 {
@@ -377,8 +457,9 @@
 	};
 
 	leds {
-		pinctrl-names = "default";
-		pinctrl-0 = <&user_leds_s0>;
+		pinctrl-names = "default", "sleep";
+		pinctrl-0 = <&user_leds_default>;
+		pinctrl-1 = <&user_leds_sleep>;
 
 		compatible = "gpio-leds";
 
@@ -536,7 +617,7 @@
 	pinctrl-names = "default", "sleep";
 	pinctrl-0 = <&cpsw_default>;
 	pinctrl-1 = <&cpsw_sleep>;
-	dual_emac;
+	dual_emac = <1>;
 };
 
 &davinci_mdio {
@@ -548,11 +629,13 @@
 &cpsw_emac0 {
 	phy_id = <&davinci_mdio>, <0>;
 	phy-mode = "rgmii-txid";
+	dual_emac_res_vlan = <1>;
 };
 
 &cpsw_emac1 {
 	phy_id = <&davinci_mdio>, <1>;
 	phy-mode = "rgmii-txid";
+	dual_emac_res_vlan = <2>;
 };
 
 &tscadc {
@@ -573,14 +656,16 @@
 	status = "okay";
 	vmmc-supply = <&vmmc_reg>;
 	bus-width = <4>;
-	pinctrl-names = "default";
-	pinctrl-0 = <&mmc1_pins>;
+	pinctrl-names = "default", "sleep";
+	pinctrl-0 = <&mmc1_pins_default>;
+	pinctrl-1 = <&mmc1_pins_sleep>;
 	cd-gpios = <&gpio0 6 GPIO_ACTIVE_HIGH>;
 };
 
 &mcasp1 {
-		pinctrl-names = "default";
+		pinctrl-names = "default", "sleep";
 		pinctrl-0 = <&mcasp1_pins>;
+		pinctrl-1 = <&mcasp1_sleep_pins>;
 
 		status = "okay";
 
diff --git a/arch/arm/boot/dts/am33xx.dtsi b/arch/arm/boot/dts/am33xx.dtsi
index 70f4703..2b66e67 100644
--- a/arch/arm/boot/dts/am33xx.dtsi
+++ b/arch/arm/boot/dts/am33xx.dtsi
@@ -941,7 +941,7 @@
 		};
 
 		efuse_sma: efuse@0x44e107fc {
-			compatible = "ti,opp-omap";
+			compatible = "ti,opp-omap-am3352";
 			reg = <0x44e107fc 0x04		/* EFUSE_SMA */
 			       0x44e10600 0x04>;	/* DEVICE_ID */
 
-- 
1.7.5.4

