From b4a1316adf0fa16e947b8768f5c8473c431d43fa Mon Sep 17 00:00:00 2001
From: Tomi Valkeinen <tomi.valkeinen@ti.com>
Date: Wed, 22 Jan 2014 11:14:00 +0200
Subject: [PATCH 179/285] OMAPDSS: SiI9022: remove pdata probe

Only DT boots are supported, so let's remove the platform data based
probe code.

Signed-off-by: Tomi Valkeinen <tomi.valkeinen@ti.com>
Signed-off-by: Darren Etheridge <detheridge@ti.com>
[Kevin: The original patch taken from TI
ti-sdk-am437x-evm-07.01.00.00-Linux-x86-Install.bin]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/video/omap2/displays-new/encoder-sil9022.c |   28 +-------------------
 1 files changed, 1 insertions(+), 27 deletions(-)

diff --git a/drivers/video/omap2/displays-new/encoder-sil9022.c b/drivers/video/omap2/displays-new/encoder-sil9022.c
index 7219558..4579275 100644
--- a/drivers/video/omap2/displays-new/encoder-sil9022.c
+++ b/drivers/video/omap2/displays-new/encoder-sil9022.c
@@ -736,28 +736,6 @@ static int sil9022_probe_of(struct i2c_client *client)
 	return 0;
 
 }
-static int sil9022_probe_pdata(struct i2c_client *client)
-{
-	struct encoder_sil9022_platform_data *pdata;
-	struct panel_drv_data *ddata = dev_get_drvdata(&client->dev);
-	struct omap_dss_device *dssdev, *in;
-	pdata = dev_get_platdata(&client->dev);
-
-	ddata->reset_gpio = pdata->reset_gpio;
-	ddata->data_lines = pdata->data_lines;
-
-	in = omap_dss_find_output(pdata->source);
-	if (in == NULL) {
-		dev_err(&client->dev, "Failed to find video source\n");
-		return -ENODEV;
-	}
-
-	ddata->in = in;
-	dssdev = &ddata->dssdev;
-	dssdev->name = pdata->name;
-
-	return 0;
-}
 
 static int sil9022_probe(struct i2c_client *client,
 		const struct i2c_device_id *id)
@@ -780,11 +758,7 @@ static int sil9022_probe(struct i2c_client *client,
 
 	dev_set_drvdata(&client->dev, ddata);
 
-	if (dev_get_platdata(&client->dev)) {
-		err = sil9022_probe_pdata(client);
-		if (err)
-			return err;
-	} else if (client->dev.of_node) {
+	if (client->dev.of_node) {
 		err = sil9022_probe_of(client);
 		if (err)
 			return err;
-- 
1.7.5.4

