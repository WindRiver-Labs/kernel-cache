From b3b8e1d87ccf9f1028e135d9179dbaf6637918e6 Mon Sep 17 00:00:00 2001
From: Felipe Balbi <balbi@ti.com>
Date: Wed, 8 Jan 2014 18:00:10 -0600
Subject: [PATCH 035/188] usb: musb: Kconfig: let musb_am335x be built as a
 module

This commit comes from branch ti-linux-3.12.y:

git://git.ti.com/ti-linux-kernel/ti-linux-kernel.git

this will make sure we can load/unload musb_dsps/musb_hdrc
and still have working USB.

Signed-off-by: Felipe Balbi <balbi@ti.com>
(cherry picked from commit ff6b611b4797fe47ffb67574b4f644d12d7d8c0d)
---
 drivers/usb/musb/Kconfig |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/drivers/usb/musb/Kconfig b/drivers/usb/musb/Kconfig
index 2a3f92c..d545a34 100644
--- a/drivers/usb/musb/Kconfig
+++ b/drivers/usb/musb/Kconfig
@@ -84,7 +84,6 @@ config USB_MUSB_AM35X
 
 config USB_MUSB_DSPS
 	tristate "TI DSPS platforms"
-	select USB_MUSB_AM335X_CHILD
 	depends on OF_IRQ
 
 config USB_MUSB_BLACKFIN
@@ -97,7 +96,11 @@ config USB_MUSB_UX500
 endchoice
 
 config USB_MUSB_AM335X_CHILD
-	bool
+	tristate "Enable support for AM335x devices"
+	depends on USB_MUSB_DSPS
+	default USB_MUSB_DSPS
+	help
+	  Say 'y' or 'm' here if you have an AM335x device. If unsure, say 'n'.
 
 choice
 	prompt 'MUSB DMA mode'
-- 
1.7.5.4

