From 51cbfc3350458f3133540b8a0fac813c10a244b1 Mon Sep 17 00:00:00 2001
From: Tero Kristo <t-kristo@ti.com>
Date: Mon, 27 Jan 2014 17:28:12 +0200
Subject: [PATCH 165/285] ARM: AM43xx: disable cpuidle for now

AM43xx shares PM code with AM33xx, but the cpuidle does not work on this
SoC yet, thus disable it.

Signed-off-by: Tero Kristo <t-kristo@ti.com>
[Kevin: The original patch taken from TI
ti-sdk-am437x-evm-07.01.00.00-Linux-x86-Install.bin]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/arm/mach-omap2/pm33xx.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-omap2/pm33xx.c b/arch/arm/mach-omap2/pm33xx.c
index 1762905..995f492 100644
--- a/arch/arm/mach-omap2/pm33xx.c
+++ b/arch/arm/mach-omap2/pm33xx.c
@@ -320,7 +320,8 @@ static void am33xx_m3_fw_ready_cb(void)
 					am33xx_pm->ver);
 	}
 
-	am33xx_idle_init(susp_params.wfi_flags & WFI_MEM_TYPE_DDR3);
+	if (soc_is_am33xx())
+		am33xx_idle_init(susp_params.wfi_flags & WFI_MEM_TYPE_DDR3);
 
 #ifdef CONFIG_SUSPEND
 	suspend_set_ops(&am33xx_pm_ops);
-- 
1.7.5.4

