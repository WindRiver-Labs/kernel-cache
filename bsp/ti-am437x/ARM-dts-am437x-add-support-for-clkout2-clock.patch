From 7b33fd7e9ed47876c0e538127435d7a729761960 Mon Sep 17 00:00:00 2001
From: Tero Kristo <t-kristo@ti.com>
Date: Sun, 24 Nov 2013 20:43:06 +0530
Subject: [PATCH 169/285] ARM: dts: am437x: add support for clkout2 clock

Adds four nodes for the clkout2 clock, with following hierarchy:

- clkout2_mux_ck : for selecting the parent for clkout2
  -> clkout2_div_ck : pre-divider for clkout2
    -> clkout2_post_div_ck : post-divider for clkout2
      -> clkout2_ck : gate clock for clkout2

Signed-off-by: Tero Kristo <t-kristo@ti.com>
[nsekhar: add support for clkout 32k mux]
Signed-off-by: Sekhar Nori <nsekhar@ti.com>
[Kevin: The original patch taken from TI
ti-sdk-am437x-evm-07.01.00.00-Linux-x86-Install.bin]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/arm/boot/dts/am43xx-clocks.dtsi |   44 ++++++++++++++++++++++++++++++++++
 1 files changed, 44 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/am43xx-clocks.dtsi b/arch/arm/boot/dts/am43xx-clocks.dtsi
index 412740c..ba7bfc3 100644
--- a/arch/arm/boot/dts/am43xx-clocks.dtsi
+++ b/arch/arm/boot/dts/am43xx-clocks.dtsi
@@ -759,3 +759,47 @@ usb_phy2_always_on_clk32k: usb_phy2_always_on_clk32k {
 	compatible = "fixed-clock";
 	clocks = <&clk_32768_ck>;
 };
+
+clkout_32k_mux_ck: clkout_32k_mux_ck@44df4100 {
+	#clock-cells = <0>;
+	compatible = "mux-clock";
+	clocks = <&clk_32k_tpm_ck>, <&clk_32768_ck>;
+	reg = <0x44df4100 0x4>;
+	bit-mask = <0x1>;
+	bit-shift = <24>;
+};
+
+clkout2_mux_ck: clkout2_mux_ck@44df4108 {
+	#clock-cells = <0>;
+	compatible = "mux-clock";
+	clocks = <&clkout_32k_mux_ck>, <&sysclk_div>, <&dpll_ddr_m2_ck>, <&dpll_per_m2_ck>, <&dpll_disp_m2_ck>, <&dpll_mpu_ck>;
+	reg = <0x44df4108 0x4>;
+	bit-mask = <0x7>;
+};
+
+clkout2_div_ck: clkout2_div_ck@44df4108 {
+	#clock-cells = <0>;
+	compatible = "divider-clock";
+	clocks = <&clkout2_mux_ck>;
+	reg = <0x44df4108 0x4>;
+	bit-mask = <0x7>;
+	bit-shift = <4>;
+};
+
+clkout2_post_div_ck: clkout2_post_div_ck@44df4108 {
+	#clock-cells = <0>;
+	compatible = "divider-clock";
+	clocks = <&clkout2_div_ck>;
+	reg = <0x44df4108 0x4>;
+	bit-mask = <0x7>;
+	bit-shift = <8>;
+	index-power-of-two;
+};
+
+clkout2_ck: clkout2_ck@44df4108 {
+	#clock-cells = <0>;
+	compatible = "gate-clock";
+	clocks = <&clkout2_post_div_ck>;
+	bit-shift = <16>;
+	reg = <0x44df4108 0x4>;
+};
-- 
1.7.5.4

