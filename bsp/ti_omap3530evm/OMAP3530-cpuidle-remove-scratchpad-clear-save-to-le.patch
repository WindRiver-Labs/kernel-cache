From a76d5b4169a9aca1360866b35816d33ffe8c1c6d Mon Sep 17 00:00:00 2001
From: Hui Wang <Hui.Wang@windriver.com>
Date: Sat, 12 Jun 2010 11:26:30 +0800
Subject: [PATCH] OMAP3530/cpuidle: remove scratchpad clear/save to let JTAG work fine

After runing omap3_clear_scratchpad_contents, The debugger can't
connect OMAP3530evm through JTAG port anymore. If don't call clear
function, the JTAG work fine.
This change is safe because of the following reasons:
1) the clear function will set memory region for saving scrachpads
to zero, the immediately following save function will set this mem
region to scratchpad registers's contents. So the clear function
is useless here.
2) we also remove save function here because save function will
be called after omap3_idle_init is called, so this calling is
redudent.
3) The calling these two funcions in omap3_idle_init is introduced
from TI_PSP_2.0, but both upstream and TI_PSP_2.X(3.X) have removed
this calling. Since the upstream didn't introduce this calling from
the begining, i can't provide exactly which commit remove this
calling.

Signed-off-by: Hui Wang <Hui.Wang@windriver.com>
---
 arch/arm/mach-omap2/cpuidle34xx.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

diff --git a/arch/arm/mach-omap2/cpuidle34xx.c b/arch/arm/mach-omap2/cpuidle34xx.c
index c39cba5..0b3247a 100644
--- a/arch/arm/mach-omap2/cpuidle34xx.c
+++ b/arch/arm/mach-omap2/cpuidle34xx.c
@@ -282,9 +282,6 @@ int omap3_idle_init(void)
 	struct cpuidle_state *state;
 	struct cpuidle_device *dev;
 
-	omap3_clear_scratchpad_contents();
-	omap3_save_scratchpad_contents();
-
 	omap_init_power_states();
 	cpuidle_register_driver(&omap3_idle_driver);
 
-- 
1.6.0.4

