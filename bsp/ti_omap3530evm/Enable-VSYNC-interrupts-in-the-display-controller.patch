From 3d16c76c055201fddfde88b081f5d60820d4f53d Mon Sep 17 00:00:00 2001
From: Jim Somerville <Jim.Somerville@windriver.com>
Date: Fri, 17 Apr 2009 15:34:40 -0400
Subject: [PATCH 08/20] Enable VSYNC interrupts in the display controller.

Displaying graphics requires the handling of
vertical sync interrupts in order to have motion.
This affects the ti_omap3530evm only.

Signed-off-by: Jim Somerville <Jim.Somerville@windriver.com>
---
 drivers/video/omap/dispc.c |   11 +++++++++--
 1 files changed, 9 insertions(+), 2 deletions(-)

diff --git a/drivers/video/omap/dispc.c b/drivers/video/omap/dispc.c
index 4f98ab2..8b7eb0b 100644
--- a/drivers/video/omap/dispc.c
+++ b/drivers/video/omap/dispc.c
@@ -42,6 +42,14 @@
 					DISPC_IRQSTATUS_VID2FIFOUNDERFLOW | \
 					DISPC_IRQSTATUS_SYNCLOST)
 
+#ifdef CONFIG_MACH_OMAP3EVM
+#define OMAP_IRQENABLE_FLAGS		(DISPC_IRQENABLE_FRAMEDONE | \
+					DISPC_IRQENABLE_VSYNC | \
+					DISPC_IRQSTATUS_GFXFIFOUNDERFLOW)
+#else
+#define OMAP_IRQENABLE_FLAGS		(DISPC_IRQENABLE_FRAMEDONE | \
+					DISPC_IRQSTATUS_GFXFIFOUNDERFLOW)
+#endif
 
 #define MAX_PALETTE_SIZE		(256 * 16)
 
@@ -1312,8 +1320,7 @@ static int omap_dispc_init(struct omapfb_device *fbdev, int ext_mode,
 
 	/* Enable those that we handle always */
 	if (omap_disp_register_isr((omap_disp_isr_t)omap_dispc_irq_handler,
-					fbdev, DISPC_IRQENABLE_FRAMEDONE |
-					DISPC_IRQSTATUS_GFXFIFOUNDERFLOW)) {
+					fbdev, OMAP_IRQENABLE_FLAGS)) {
 
 		dev_err(dispc.fbdev->dev, "can't get DSS IRQ\n");
 		goto fail1;
-- 
1.6.5.2

