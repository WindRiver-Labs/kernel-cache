From 958ac33de0ef42ad5e965f2239f82499191c05aa Mon Sep 17 00:00:00 2001
From: Richard Zhu <r65037@freescale.com>
Date: Wed, 14 Aug 2013 12:46:57 +0800
Subject: [PATCH 0171/1072] ENGR00275213-3 arm: dts: enable pcie on imx6
 platforms

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit 085fa6af23253017220d29e156dd19060af3d9c1

Both imx6q and imx6dl platforms have the pcie interface,
enable the pcie on those platforms.

Signed-off-by: Richard Zhu <r65037@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 arch/arm/boot/dts/imx6q.dtsi             |   17 +++++++++++++++++
 arch/arm/boot/dts/imx6qdl-sabreauto.dtsi |    4 ++++
 arch/arm/boot/dts/imx6qdl-sabresd.dtsi   |    6 ++++++
 3 files changed, 27 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/imx6q.dtsi b/arch/arm/boot/dts/imx6q.dtsi
index db1bf60..6353b92 100644
--- a/arch/arm/boot/dts/imx6q.dtsi
+++ b/arch/arm/boot/dts/imx6q.dtsi
@@ -132,6 +132,23 @@
 			status = "disabled";
 		};
 
+                pcie: pcie@01000000 {
+			compatible = "fsl,imx-pcie";
+			device_type = "pci";
+			reg = <0x01ffc000 0x4000>;
+			reg-names = "pcie_reg";
+			interrupts = <0 123 0x04>;
+			interrupt-names = "imx_pcie";
+			clocks = <&clks 144>, <&clks 189>, <&clks 211>, <&clks 212>;
+			clock-names = "pcie_axi", "pcie_ref", "pcie_bus_in", "pcie_bus_out";
+			#address-cells = <3>;
+			#size-cells = <2>;
+			ranges = <0x00000800 0 0x01f00000 0x01f00000 0 0x00080000   /* configuration space */
+				  0x81000000 0 0	  0x01f80000 0 0x00010000   /* downstream I/O */
+				  0x82000000 0 0x01000000 0x01000000 0 0x00f00000>; /* non-prefetchable memory */
+			num-lanes = <1>;
+			status = "disabled";
+		};
 
 		aips-bus@02000000 { /* AIPS1 */
 			spba-bus@02000000 {
diff --git a/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi b/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
index 58b999d..5a4d1b6 100644
--- a/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
@@ -279,6 +279,10 @@
 	status = "okay";
 };
 
+&pcie {
+	status = "okay";
+};
+
 &pwm3 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_pwm3_1>;
diff --git a/arch/arm/boot/dts/imx6qdl-sabresd.dtsi b/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
index 1df3a26..7a98d8c 100644
--- a/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
@@ -511,6 +511,12 @@
 	status = "okay";
 };
 
+&pcie {
+	pwr-gpios = <&gpio3 19 0>;
+	rst-gpios = <&gpio7 12 0>;
+	status = "okay";
+};
+
 &pwm1 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_pwm1_1>;
-- 
1.7.5.4

