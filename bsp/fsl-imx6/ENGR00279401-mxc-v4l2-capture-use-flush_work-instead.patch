From 5f4ef37778bb9ab73af398c6f1c697949521b959 Mon Sep 17 00:00:00 2001
From: Liu Ying <Ying.Liu@freescale.com>
Date: Thu, 12 Sep 2013 15:50:13 +0800
Subject: [PATCH 0858/1072] ENGR00279401 mxc v4l2 capture: use flush_work
 instead of flush_work_sync

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit 87cba5a748129aa02f7d930f4262cbc3c90d69bc

Since commit 43829731d (workqueue: deprecate flush[_delayed]_work_sync()),
flush_work() should be used instead of flush_work_sync().

Signed-off-by: Liu Ying <Ying.Liu@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 .../platform/mxc/capture/ipu_bg_overlay_sdc.c      |    2 +-
 .../platform/mxc/capture/ipu_fg_overlay_sdc.c      |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/media/platform/mxc/capture/ipu_bg_overlay_sdc.c b/drivers/media/platform/mxc/capture/ipu_bg_overlay_sdc.c
index fc77525..ad5e1c8 100644
--- a/drivers/media/platform/mxc/capture/ipu_bg_overlay_sdc.c
+++ b/drivers/media/platform/mxc/capture/ipu_bg_overlay_sdc.c
@@ -418,7 +418,7 @@ static int bg_overlay_stop(void *private)
 	}
 #endif
 
-	flush_work_sync(&cam->csi_work_struct);
+	flush_work(&cam->csi_work_struct);
 	cancel_work_sync(&cam->csi_work_struct);
 
 	if (cam->vf_bufs_vaddr[0]) {
diff --git a/drivers/media/platform/mxc/capture/ipu_fg_overlay_sdc.c b/drivers/media/platform/mxc/capture/ipu_fg_overlay_sdc.c
index 43baba2..416b40b 100644
--- a/drivers/media/platform/mxc/capture/ipu_fg_overlay_sdc.c
+++ b/drivers/media/platform/mxc/capture/ipu_fg_overlay_sdc.c
@@ -515,7 +515,7 @@ static int foreground_stop(void *private)
 	}
 #endif
 
-	flush_work_sync(&cam->csi_work_struct);
+	flush_work(&cam->csi_work_struct);
 	cancel_work_sync(&cam->csi_work_struct);
 
 	if (cam->vf_bufs_vaddr[0]) {
-- 
1.7.5.4

