From 9eb4595003f99cef86a3deca06c5c08237ec21bc Mon Sep 17 00:00:00 2001
From: Liang Li <liang.li@windriver.com>
Date: Thu, 25 Jul 2013 17:01:37 +0800
Subject: [PATCH 2/2] build fix #2 for updated i.mx6

When CONFIG_MXC_VPU from 'y' to 'm', we need this fix for build error.
The fix need be squashed into below commit on standard/fsl-imx6:

[
Author: Zhong Hongbo <hongbo.zhong@windriver.com>
Date:   Fri Jul 19 09:40:19 2013 +0800

    fsl_imx6q: Update VPU driver for mx6q

    Source: Extract from vendor-drop package, L3.0.35_4.0.0_130424_source.tar.gz

    Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
]

Signed-off-by: Liang Li <liang.li@windriver.com>
---
 drivers/mxc/vpu/mxc_vpu.c |    2 --
 mm/memblock.c             |    2 ++
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/mxc/vpu/mxc_vpu.c b/drivers/mxc/vpu/mxc_vpu.c
index eea6b2d..1693eb5 100644
--- a/drivers/mxc/vpu/mxc_vpu.c
+++ b/drivers/mxc/vpu/mxc_vpu.c
@@ -1036,8 +1036,6 @@ static int __init vpu_init(void)
 
 	init_waitqueue_head(&vpu_queue);
 
-
-	memblock_allow_resize();
 	top_address_DRAM = memblock_end_of_DRAM_with_reserved();
 
 	return ret;
diff --git a/mm/memblock.c b/mm/memblock.c
index dd13290d..f71c9db 100644
--- a/mm/memblock.c
+++ b/mm/memblock.c
@@ -11,6 +11,7 @@
  */
 
 #include <linux/kernel.h>
+#include <linux/module.h>
 #include <linux/slab.h>
 #include <linux/init.h>
 #include <linux/bitops.h>
@@ -855,6 +856,7 @@ phys_addr_t __init_memblock memblock_end_of_DRAM_with_reserved(void)
 		   memblock.memory.regions[idx].base
 		   + memblock.memory.regions[idx].size);
 }
+EXPORT_SYMBOL(memblock_end_of_DRAM_with_reserved);
 
 void __init memblock_enforce_memory_limit(phys_addr_t limit)
 {
-- 
1.7.5.4

