From ec38e1d14133c283236254b021cdbb7d303d51c7 Mon Sep 17 00:00:00 2001
From: Shengjiu Wang <b02247@freescale.com>
Date: Fri, 9 Aug 2013 14:43:05 +0800
Subject: [PATCH 0111/1072] ENGR00274585-7 dtsi: add device tree for asrc p2p
 and esai.

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit 62aaf497aee83d33a16ebd81b9cc76e493ffee98

add devicetree for asrc p2p and esai.

Signed-off-by: Shengjiu Wang <b02247@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 arch/arm/boot/dts/imx6qdl-sabreauto.dtsi |   44 ++++++++++++++++++++++++++++++
 arch/arm/boot/dts/imx6qdl.dtsi           |   14 +++++++++
 2 files changed, 58 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi b/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
index d031178..4d4c956 100644
--- a/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
@@ -90,6 +90,33 @@
 		default-brightness-level = <7>;
 	};
 
+	regulators {
+		compatible = "simple-bus";
+		reg_audio: cs42888_supply {
+			compatible = "regulator-fixed";
+			regulator-name = "cs42888_supply";
+			regulator-min-microvolt = <3300000>;
+			regulator-max-microvolt = <3300000>;
+			regulator-always-on;
+		};
+	};
+
+	sound-cs42888 {
+		compatible = "fsl,imx6-sabreauto-cs42888",
+				"fsl,imx-audio-cs42888";
+		model = "imx-cs42888";
+		esai-controller = <&esai>;
+		asrc-controller = <&asrc_p2p>;
+		audio-codec = <&codec>;
+	};
+
+	clocks {
+		codec_osc: codec_osc {
+			compatible = "fixed-clock";
+			#clock-cells = <0>;
+			clock-frequency = <24576000>;
+		};
+	};
 };
 
 &ecspi1 {
@@ -128,6 +155,17 @@
 		interrupts = <28 2>;
 		wakeup-gpios = <&gpio2 28 0>;
 	};
+
+	codec: cs42888@048 {
+		compatible = "cirrus,cs42888";
+		reg = <0x048>;
+		clocks = <&codec_osc 0>;
+		clock-names = "codec_osc";
+		VA-supply = <&reg_audio>;
+		VD-supply = <&reg_audio>;
+		VLS-supply = <&reg_audio>;
+		VLC-supply = <&reg_audio>;
+	};
 };
 
 &i2c3 {
@@ -233,3 +271,9 @@
 	pinctrl-0 = <&pinctrl_pwm3_1>;
 	status = "okay";
 };
+
+&esai {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_esai_2>;
+	status = "okay";
+};
diff --git a/arch/arm/boot/dts/imx6qdl.dtsi b/arch/arm/boot/dts/imx6qdl.dtsi
index 48e4b8d..e483c88 100644
--- a/arch/arm/boot/dts/imx6qdl.dtsi
+++ b/arch/arm/boot/dts/imx6qdl.dtsi
@@ -191,8 +191,13 @@
 				};
 
 				esai: esai@02024000 {
+					compatible = "fsl,imx6q-esai";
 					reg = <0x02024000 0x4000>;
 					interrupts = <0 51 0x04>;
+					clocks = <&clks 118>;
+					fsl,esai-dma-events = <24 23>;
+					fsl,flags = <1>;
+					status = "disabled";
 				};
 
 				ssi1: ssi@02028000 {
@@ -243,6 +248,15 @@
 					status = "okay";
 				};
 
+				asrc_p2p: asrc_p2p {
+					compatible = "fsl,imx6q-asrc-p2p";
+					fsl,output-rate  = <48000>;
+					fsl,output-width = <16>;
+					fsl,asrc-dma-rx-events = <17 18 19>;
+					fsl,asrc-dma-tx-events = <20 21 22>;
+					status = "okay";
+				};
+
 				spba@0203c000 {
 					reg = <0x0203c000 0x4000>;
 				};
-- 
1.7.5.4

