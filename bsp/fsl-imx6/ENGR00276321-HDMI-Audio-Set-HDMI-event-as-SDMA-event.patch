From 31d44e3c727346631ba8d2f88256440d76714684 Mon Sep 17 00:00:00 2001
From: Sandor Yu <R01008@freescale.com>
Date: Thu, 22 Aug 2013 17:50:29 +0800
Subject: [PATCH 0559/1072] ENGR00276321 HDMI Audio: Set HDMI event as SDMA
 event2

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit 87caa82b8f2c26f6f4f448ff05bb4344459474a7

- Remove chip revision check code.
- Set HDMI event as SDMA event2 for HDMI audio.

Signed-off-by: Sandor Yu <R01008@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 drivers/mfd/mxc-hdmi-core.c       |   10 ----------
 drivers/video/mxc/mxc_hdmi.c      |   12 ++++--------
 include/linux/mfd/mxc-hdmi-core.h |    1 -
 3 files changed, 4 insertions(+), 19 deletions(-)

diff --git a/drivers/mfd/mxc-hdmi-core.c b/drivers/mfd/mxc-hdmi-core.c
index 7da0bf6..2b0853c 100644
--- a/drivers/mfd/mxc-hdmi-core.c
+++ b/drivers/mfd/mxc-hdmi-core.c
@@ -532,17 +532,7 @@ static int hdmi_core_get_of_property(struct platform_device *pdev)
 
 	return err;
 }
-/*
-unsigned int hdmi_SDMA_check(void)
-{
-
-	return (imx6q_revision() > IMX_CHIP_REVISION_1_1) ||
-			(imx6dl_revision() > IMX_CHIP_REVISION_1_0);
 
-	return 0;
-}
-EXPORT_SYMBOL(hdmi_SDMA_check);
-*/
 /* Need to run this before phy is enabled the first time to prevent
  * overflow condition in HDMI_IH_FC_STAT2 */
 void hdmi_init_clk_regenerator(void)
diff --git a/drivers/video/mxc/mxc_hdmi.c b/drivers/video/mxc/mxc_hdmi.c
index 373dd0b..5a17599 100644
--- a/drivers/video/mxc/mxc_hdmi.c
+++ b/drivers/video/mxc/mxc_hdmi.c
@@ -2412,14 +2412,10 @@ static void hdmi_init_route(struct mxc_hdmi *hdmi)
 
 	writel(reg, hdmi->gpr_hdmi_base);
 
-	/* Set HDMI event as SDMA event2 while Chip version later than TO1.2 */
-/*
-	if (hdmi_SDMA_check()) {
-		reg = readl(hdmi->gpr_sdma_base);
-		reg |= 0x1;
-		writel(reg, hdmi->gpr_sdma_base);
-	}
-*/
+	/* Set HDMI event as SDMA event2 for HDMI audio */
+	reg = readl(hdmi->gpr_sdma_base);
+	reg |= 0x1;
+	writel(reg, hdmi->gpr_sdma_base);
 }
 
 static void hdmi_hdcp_get_property(struct platform_device *pdev)
diff --git a/include/linux/mfd/mxc-hdmi-core.h b/include/linux/mfd/mxc-hdmi-core.h
index f552498..a675c19 100644
--- a/include/linux/mfd/mxc-hdmi-core.h
+++ b/include/linux/mfd/mxc-hdmi-core.h
@@ -54,7 +54,6 @@ extern int mxc_hdmi_disp_id;
 
 void hdmi_set_registered(int registered);
 int hdmi_get_registered(void);
-unsigned int hdmi_SDMA_check(void);
 int mxc_hdmi_abort_stream(void);
 int mxc_hdmi_register_audio(struct snd_pcm_substream *substream);
 void mxc_hdmi_unregister_audio(struct snd_pcm_substream *substream);
-- 
1.7.5.4

