From 91e2bc3e9dc513698dc5e6d8062f0cc4cb8c69ac Mon Sep 17 00:00:00 2001
From: Liang Li <liang.li@windriver.com>
Date: Tue, 23 Apr 2013 17:35:27 +0800
Subject: [PATCH] ARM: imx6: fix OTP driver

We have integrated the OTP driver but did not enable it. Hence here we
add the resource in platform to enable the OTP driver.

Plus one minor correct to a previous typo.

Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
Signed-off-by: Liang Li <liang.li@windriver.com>
---
 arch/arm/mach-mx6/mach-mx6q_sabrelite.c        |    7 +++++++
 arch/arm/plat-mxc/devices/platform-imx-ocotp.c |    2 +-
 2 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-mx6/mach-mx6q_sabrelite.c b/arch/arm/mach-mx6/mach-mx6q_sabrelite.c
index 1d207f6..0f72fe5 100644
--- a/arch/arm/mach-mx6/mach-mx6q_sabrelite.c
+++ b/arch/arm/mach-mx6/mach-mx6q_sabrelite.c
@@ -1104,6 +1104,13 @@ static void __init mx6_sabrelite_board_init(void)
 	imx6q_add_hdmi_soc();
 	imx6q_add_hdmi_soc_dai();
 
+#ifdef CONFIG_FSL_OTP
+	{
+		extern const struct imx_otp_data imx6q_otp_data;
+		imx_add_otp(&imx6q_otp_data);
+	}
+#endif
+
 	imx6q_add_imx2_wdt(0, NULL);
 
 	/* SD/MMC */
diff --git a/arch/arm/plat-mxc/devices/platform-imx-ocotp.c b/arch/arm/plat-mxc/devices/platform-imx-ocotp.c
index 01d0c48..ffb32f0 100644
--- a/arch/arm/plat-mxc/devices/platform-imx-ocotp.c
+++ b/arch/arm/plat-mxc/devices/platform-imx-ocotp.c
@@ -53,7 +53,7 @@ const struct imx_otp_data imx50_otp_data = {
 static const char *bank_reg_desc[BANKS][BANK_ITEMS] = {
 	BANK(LOCK, CFG0, CFG1, CFG2, CFG3, CFG4, CFG5, CFG6),
 	BANK(MEM0, MEM1, MEM2, MEM3, MEM4, ANA0, ANA1, ANA2),
-	BANK(OTPMK0, SOTPMK1, OTPMK2, OTPMK3, OTPMK4, OTPMK5, OTPMK6, OTPMK7),
+	BANK(OTPMK0, OTPMK1, OTPMK2, OTPMK3, OTPMK4, OTPMK5, OTPMK6, OTPMK7),
 	BANK(SRK0, SRK1, SRK2, SRK3, SRK4, SRK5, SRK6, SRK7),
 	BANK(RESP0, HSJC_RESP1, MAC0, MAC1, HDCP_KSV0, HDCP_KSV1, GP1, GP2),
 	BANK(DTCP_KEY0,  DTCP_KEY1,  DTCP_KEY2,  DTCP_KEY3,  DTCP_KEY4,  MISC_CONF,  FIELD_RETURN, SRK_REVOKE),
-- 
1.7.5.4

