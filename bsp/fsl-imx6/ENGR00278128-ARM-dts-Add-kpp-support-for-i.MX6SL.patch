From 7957b2c747f4c8da32700fa038b65e9f25f6c025 Mon Sep 17 00:00:00 2001
From: Anson Huang <b20788@freescale.com>
Date: Wed, 4 Sep 2013 15:30:29 -0400
Subject: [PATCH 0198/1072] ENGR00278128 ARM: dts: Add kpp support for i.MX6SL

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit b129ff68751699c05e0fe08407bf645fd481af84

Add i.MX6SL keyboard feature.
There are 8 keys on i.MX6SL EVK board, enable them.

Signed-off-by: Anson Huang <b20788@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 arch/arm/boot/dts/imx6sl-evk.dts |   16 ++++++++++++++++
 arch/arm/boot/dts/imx6sl.dtsi    |   15 +++++++++++++++
 2 files changed, 31 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/imx6sl-evk.dts b/arch/arm/boot/dts/imx6sl-evk.dts
index 15f9fda..236aee3 100644
--- a/arch/arm/boot/dts/imx6sl-evk.dts
+++ b/arch/arm/boot/dts/imx6sl-evk.dts
@@ -324,6 +324,22 @@
 	};
 };
 
+&kpp {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_kpp_1>;
+	linux,keymap = <
+			0x00000067      /* KEY_UP */
+			0x0001006c      /* KEY_DOWN */
+			0x0002001c      /* KEY_ENTER */
+			0x01000066      /* KEY_HOME */
+			0x0101006a      /* KEY_RIGHT */
+			0x01020069      /* KEY_LEFT */
+			0x02000072      /* KEY_VOLUMEDOWN */
+			0x02010073      /* KEY_VOLUMEUP */
+		>;
+        status = "okay";
+};
+
 &lcdif {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_lcdif_dat_0
diff --git a/arch/arm/boot/dts/imx6sl.dtsi b/arch/arm/boot/dts/imx6sl.dtsi
index 9f2cfbe..2b84330 100644
--- a/arch/arm/boot/dts/imx6sl.dtsi
+++ b/arch/arm/boot/dts/imx6sl.dtsi
@@ -373,8 +373,10 @@
 			};
 
 			kpp: kpp@020b8000 {
+				compatible = "fsl,imx6sl-kpp", "fsl,imx21-kpp";
 				reg = <0x020b8000 0x4000>;
 				interrupts = <0 82 0x04>;
+				clocks = <&clks IMX6SL_CLK_DUMMY>;
 			};
 
 			wdog1: wdog@020bc000 {
@@ -897,6 +899,19 @@
 		};
 	};
 
+	kpp {
+		pinctrl_kpp_1: kpp_grp_1 {
+			fsl,pins = <
+				MX6SL_PAD_KEY_ROW0__KEY_ROW0      0x1b010
+				MX6SL_PAD_KEY_ROW1__KEY_ROW1      0x1b010
+				MX6SL_PAD_KEY_ROW2__KEY_ROW2      0x1b0b0
+				MX6SL_PAD_KEY_COL0__KEY_COL0      0x80000000
+				MX6SL_PAD_KEY_COL1__KEY_COL1      0x80000000
+				MX6SL_PAD_KEY_COL2__KEY_COL2      0x80000000
+			>;
+		};
+	};
+
 	lcdif {
 		pinctrl_lcdif_dat_0: lcdifdatgrp-0 {
 			fsl,pins = <
-- 
1.7.5.4

