From 553c62e6a3c06989051e369f7d90dae5d5b22535 Mon Sep 17 00:00:00 2001
From: Robby Cai <R63905@freescale.com>
Date: Fri, 15 Nov 2013 17:21:16 +0800
Subject: [PATCH 0348/1072] ENGR00288196 ARM: dts: fix epdc and csi conflict
 on imx6sl evk

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit a08c436c12b2cb2478f0afd8978c41d414ad0ccc

There is pinmux conflict for EPDC and I2C3 on imx6sl soc.
While on imx6sl evk board, the camera is attached on I2C3 bus, so the
EPDC function and CSI function can not be used at same time.
This patch removes the conflict in imx6sl-evk.dts file for EPDC function
and adds a new dts file for CSI function.

Signed-off-by: Robby Cai <R63905@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 arch/arm/boot/dts/Makefile           |    1 +
 arch/arm/boot/dts/imx6sl-evk-csi.dts |   27 +++++++++++++++++++++++++++
 arch/arm/boot/dts/imx6sl-evk.dts     |    6 +++---
 3 files changed, 31 insertions(+), 3 deletions(-)
 create mode 100644 arch/arm/boot/dts/imx6sl-evk-csi.dts

diff --git a/arch/arm/boot/dts/Makefile b/arch/arm/boot/dts/Makefile
index af6db26..f43b68b 100644
--- a/arch/arm/boot/dts/Makefile
+++ b/arch/arm/boot/dts/Makefile
@@ -132,6 +132,7 @@ dtb-$(CONFIG_ARCH_MXC) += \
 	imx6q-sabresd-ldo.dtb \
 	imx6q-sbc6x.dtb \
 	imx6sl-evk.dtb \
+	imx6sl-evk-csi.dtb \
 	imx6sl-evk-ldo.dtb \
 	vf610-twr.dtb
 dtb-$(CONFIG_ARCH_MXS) += imx23-evk.dtb \
diff --git a/arch/arm/boot/dts/imx6sl-evk-csi.dts b/arch/arm/boot/dts/imx6sl-evk-csi.dts
new file mode 100644
index 0000000..795be40
--- /dev/null
+++ b/arch/arm/boot/dts/imx6sl-evk-csi.dts
@@ -0,0 +1,27 @@
+/*
+ * Copyright (C) 2013 Freescale Semiconductor, Inc.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include "imx6sl-evk.dts"
+
+/ {
+	csi_v4l2_cap {
+		status = "okay";
+	};
+};
+
+&csi {
+	status = "okay";
+};
+
+&i2c3 {
+	status = "okay";
+};
+
+&epdc {
+	status = "disabled";
+};
diff --git a/arch/arm/boot/dts/imx6sl-evk.dts b/arch/arm/boot/dts/imx6sl-evk.dts
index 9a89087..a055f38 100644
--- a/arch/arm/boot/dts/imx6sl-evk.dts
+++ b/arch/arm/boot/dts/imx6sl-evk.dts
@@ -84,7 +84,7 @@
 
 	csi_v4l2_cap {
 		compatible = "fsl,imx6sl-csi-v4l2";
-		status = "okay";
+		status = "disabled";
 	};
 
 	pxp_v4l2_out {
@@ -134,7 +134,7 @@
 };
 
 &csi {
-	status = "okay";
+	status = "disabled";
 };
 
 &ecspi1 {
@@ -417,7 +417,7 @@
 	clock-frequency = <100000>;
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_i2c3_1>;
-	status = "okay";
+	status = "disabled";
 
 	ov564x: ov564x@3c {
 		compatible = "ovti,ov564x";
-- 
1.7.5.4

