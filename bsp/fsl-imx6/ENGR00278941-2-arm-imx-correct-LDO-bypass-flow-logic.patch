From f56afe3937ace6a0679bf189cc56fffd4b8561d5 Mon Sep 17 00:00:00 2001
From: Anson Huang <b20788@freescale.com>
Date: Tue, 10 Sep 2013 16:23:26 -0400
Subject: [PATCH 0285/1072] ENGR00278941-2: arm: imx: correct LDO bypass flow
 logic

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit 1427e80e62e52579565047a9e9d26da5e90d0b60

The LDO analog bypass switch is necessary before entering DSM when LDO
is working at digital bypass mode, previous coding logic is incorrect,
fix it.

Signed-off-by: Anson Huang <b20788@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 arch/arm/mach-imx/suspend-imx6.S |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/arch/arm/mach-imx/suspend-imx6.S b/arch/arm/mach-imx/suspend-imx6.S
index 4a86446..a620560 100644
--- a/arch/arm/mach-imx/suspend-imx6.S
+++ b/arch/arm/mach-imx/suspend-imx6.S
@@ -619,8 +619,9 @@ rbc_loop:
 	 */
 	ldr	r8, =IMX_IO_P2V(MX6Q_ANATOP_BASE_ADDR)
 	ldr	r7, [r8, #MX6Q_ANATOP_CORE]
-	ands	r7, r7, #0x1f
-	beq	ldo_check_done1
+	and	r7, r7, #0x1f
+	cmp	r7, #0x1f
+	bne	ldo_check_done1
 ldo_analog_bypass:
 	ldr	r7, [r8, #MX6Q_ANATOP_CORE]
 	bic	r7, r7, #0x1f
-- 
1.7.5.4

