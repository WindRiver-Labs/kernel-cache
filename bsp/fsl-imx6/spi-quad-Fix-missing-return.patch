From 414c5cfea7a34d3bd77e563a225675e60ac640fa Mon Sep 17 00:00:00 2001
From: wangyuhang <wangyuhang2014@gmail.com>
Date: Fri, 30 Aug 2013 18:05:10 +0800
Subject: [PATCH 1034/1072] spi: quad: Fix missing return

commit d5ee722ab942451929ccf5bec4fb41f6d044b5c7 upstream

Delete a "return" when commit the patch to a new kernel version
 by mistake. So recover it.

Signed-off-by: wangyuhang <wangyuhang2014@gmail.com>
Signed-off-by: Mark Brown <broonie@linaro.org>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 drivers/spi/spi.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/spi/spi.c b/drivers/spi/spi.c
index a8d0752..baee64c 100644
--- a/drivers/spi/spi.c
+++ b/drivers/spi/spi.c
@@ -1480,6 +1480,7 @@ static int __spi_async(struct spi_device *spi, struct spi_message *message)
 			return -EINVAL;
 		if (xfer->speed_hz && master->max_speed_hz &&
 		    xfer->speed_hz > master->max_speed_hz)
+			return -EINVAL;
 
 		if (xfer->tx_buf && !xfer->tx_nbits)
 			xfer->tx_nbits = SPI_NBITS_SINGLE;
-- 
1.7.5.4

