From df12358b1056793c07149450a3ed275d6234f8f4 Mon Sep 17 00:00:00 2001
From: Anson Huang <b20788@freescale.com>
Date: Mon, 4 Nov 2013 15:23:51 -0500
Subject: [PATCH 0320/1072] ENGR00286041 arm: imx: avoid warning message of
 speed grading check on i.MX6DL

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit 54b376752a509f82d1ae0e1d903ee5b4f32a4667

i.MX6DL did NOT have 1.2GHz setpoint, no need to check speed
grading fuse for 1.2GHz opp, otherwise, there will be always
warning message of "failed to disable 1.2 GHz OPP" when system
boot up on i.MX6DL.

Signed-off-by: Anson Huang <b20788@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 arch/arm/mach-imx/mach-imx6q.c |   10 ++++++----
 1 files changed, 6 insertions(+), 4 deletions(-)

diff --git a/arch/arm/mach-imx/mach-imx6q.c b/arch/arm/mach-imx/mach-imx6q.c
index 8df7de7..4153983 100644
--- a/arch/arm/mach-imx/mach-imx6q.c
+++ b/arch/arm/mach-imx/mach-imx6q.c
@@ -364,7 +364,7 @@ static void __init imx6q_opp_check_speed_grading(struct device *cpu_dev)
 
 	/*
 	 * SPEED_GRADING[1:0] defines the max speed of ARM:
-	 * 2b'11: 1200000000Hz;
+	 * 2b'11: 1200000000Hz; -- i.MX6Q only.
 	 * 2b'10: 1000000000Hz;
 	 * 2b'01: 850000000Hz; -- i.MX6Q Only, exclusive with 1GHz.
 	 * 2b'00: 800000000Hz;
@@ -372,9 +372,11 @@ static void __init imx6q_opp_check_speed_grading(struct device *cpu_dev)
 	 */
 	val = readl_relaxed(base + OCOTP_CFG3);
 	val >>= OCOTP_CFG3_SPEED_SHIFT;
-	if ((val & 0x3) < OCOTP_CFG3_SPEED_1P2GHZ)
-		if (opp_disable(cpu_dev, 1200000000))
-			pr_warn("failed to disable 1.2 GHz OPP\n");
+	if (cpu_is_imx6q()) {
+		if ((val & 0x3) < OCOTP_CFG3_SPEED_1P2GHZ)
+			if (opp_disable(cpu_dev, 1200000000))
+				pr_warn("failed to disable 1.2 GHz OPP\n");
+	}
 	if ((val & 0x3) < OCOTP_CFG3_SPEED_1GHZ)
 		if (opp_disable(cpu_dev, 996000000))
 			pr_warn("failed to disable 1 GHz OPP\n");
-- 
1.7.5.4

