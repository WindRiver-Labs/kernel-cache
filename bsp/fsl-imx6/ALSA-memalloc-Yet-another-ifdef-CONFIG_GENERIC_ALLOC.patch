From a5b198840e4b84d444bceaec76e73e3c7842c704 Mon Sep 17 00:00:00 2001
From: Takashi Iwai <tiwai@suse.de>
Date: Mon, 28 Oct 2013 16:08:27 +0100
Subject: [PATCH 1050/1072] ALSA: memalloc: Yet another ifdef
 CONFIG_GENERIC_ALLOCATOR protection

commit 63437313daaf90b372d5b383a8cc6ec8dce185fa upstream

I obviously forgot to merge the right version...

Reported-by: Stephen Rothwell <sfr@canb.auug.org.au>
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 sound/core/memalloc.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/sound/core/memalloc.c b/sound/core/memalloc.c
index 51a7921..809fd79 100644
--- a/sound/core/memalloc.c
+++ b/sound/core/memalloc.c
@@ -159,6 +159,7 @@ static void snd_free_dev_pages(struct device *dev, size_t size, void *ptr,
 	dma_free_coherent(dev, PAGE_SIZE << pg, ptr, dma);
 }
 
+#ifdef CONFIG_GENERIC_ALLOCATOR
 /**
  * snd_malloc_dev_iram - allocate memory from on-chip internal ram
  * @dmab: buffer allocation record to store the allocated data
@@ -198,6 +199,7 @@ void snd_free_dev_iram(struct snd_dma_buffer *dmab)
 	if (pool && dmab->area)
 		gen_pool_free(pool, (unsigned long)dmab->area, dmab->bytes);
 }
+#endif /* CONFIG_GENERIC_ALLOCATOR */
 #endif /* CONFIG_HAS_DMA */
 
 /*
-- 
1.7.5.4

