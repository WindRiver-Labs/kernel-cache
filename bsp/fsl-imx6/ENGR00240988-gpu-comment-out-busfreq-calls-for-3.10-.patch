From 8f8e72d0c2abbd3c87a3961937348ef9e5038bbb Mon Sep 17 00:00:00 2001
From: Shawn Guo <shawn.guo@freescale.com>
Date: Fri, 26 Jul 2013 17:25:33 +0800
Subject: [PATCH 0460/1072] ENGR00240988: gpu: comment out busfreq calls for
 3.10 kernel

git://git.freescale.com/imx/linux-2.6-imx.git imx_3.10.17_1.0.0_beta
commit 8b71eceb2b84c88fc17fed8b2c11cb5aed7ac078

The busfreq driver is not ready yet on 3.10 kernel.  Let's comment out
the busfreq header inclusion and function calls for now, and revisit it
later when busfreq driver is ready.

Signed-off-by: Shawn Guo <shawn.guo@freescale.com>
Signed-off-by: Hongbo Zhong <hongbo.zhong@windriver.com>
---
 .../hal/os/linux/kernel/gc_hal_kernel_driver.c     |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/drivers/mxc/gpu-viv/hal/os/linux/kernel/gc_hal_kernel_driver.c b/drivers/mxc/gpu-viv/hal/os/linux/kernel/gc_hal_kernel_driver.c
index 9d9dc57..7d47564 100644
--- a/drivers/mxc/gpu-viv/hal/os/linux/kernel/gc_hal_kernel_driver.c
+++ b/drivers/mxc/gpu-viv/hal/os/linux/kernel/gc_hal_kernel_driver.c
@@ -69,8 +69,10 @@ task_notify_func(struct notifier_block *self, unsigned long val, void *data)
 #include <mach/viv_gpu.h>
 #else
 #include <linux/pm_runtime.h>
+#if LINUX_VERSION_CODE < KERNEL_VERSION(3,10,0)
 #include <mach/busfreq.h>
 #endif
+#endif
 /* Zone used for header/footer. */
 #define _GC_OBJ_ZONE    gcvZONE_DRIVER
 
@@ -1254,13 +1256,17 @@ MODULE_DEVICE_TABLE(of, mxs_gpu_dt_ids);
 #ifdef CONFIG_PM
 static int gpu_runtime_suspend(struct device *dev)
 {
+#if LINUX_VERSION_CODE < KERNEL_VERSION(3,10,0)
 	release_bus_freq(BUS_FREQ_HIGH);
+#endif
 	return 0;
 }
 
 static int gpu_runtime_resume(struct device *dev)
 {
+#if LINUX_VERSION_CODE < KERNEL_VERSION(3,10,0)
 	request_bus_freq(BUS_FREQ_HIGH);
+#endif
 	return 0;
 }
 
-- 
1.7.5.4

