From 8fed5632cebd014fbbe34ce959f413141f5ee2ef Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 3 Jun 2013 14:55:20 +0800
Subject: [PATCH 250/254] mmc: dw_mmc: remove not necessary match

platform will take care of_matc_node properly, so we may remove
them at driver level. Meanwhile many compiling warnings will
be fixed by this patch as well as follows:

drivers/mmc/host/dw_mmc-socfpga.c:112:4: warning: initialization discards 'const' qualifier from pointer target type [enabled by default]
drivers/mmc/host/dw_mmc-socfpga.c: In function 'dw_mci_socfpga_probe':
drivers/mmc/host/dw_mmc-socfpga.c:124:2: warning: passing argument 2 of 'dw_mci_pltfm_register' discards 'const' qualifier from pointer target type [enabled by default]
drivers/mmc/host/dw_mmc-pltfm.h:15:12: note: expected 'struct dw_mci_drv_data *' but argument is of type 'const struct dw_mci_drv_data *'

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/mmc/host/dw_mmc-socfpga.c |   16 ++++++----------
 1 files changed, 6 insertions(+), 10 deletions(-)

diff --git a/drivers/mmc/host/dw_mmc-socfpga.c b/drivers/mmc/host/dw_mmc-socfpga.c
index 7eb3163..509e986 100644
--- a/drivers/mmc/host/dw_mmc-socfpga.c
+++ b/drivers/mmc/host/dw_mmc-socfpga.c
@@ -100,28 +100,24 @@ static int dw_mci_socfpga_parse_dt(struct dw_mci *host)
 	return 0;
 }
 
-static const struct dw_mci_drv_data socfpga_drv_data = {
+static struct dw_mci_drv_data socfpga_drv_data = {
 	.init			= dw_mci_socfpga_priv_init,
 	.setup_clock		= dw_mci_socfpga_setup_clock,
 	.prepare_command	= dw_mci_socfpga_prepare_command,
 	.parse_dt		= dw_mci_socfpga_parse_dt,
 };
 
-static const struct of_device_id dw_mci_socfpga_match[] = {
-	{ .compatible = "altr,socfpga-dw-mshc",
-			.data = &socfpga_drv_data, },
+static struct of_device_id dw_mci_socfpga_match[] = {
+	{
+		.compatible = "altr,socfpga-dw-mshc",
+	},
 	{},
 };
 MODULE_DEVICE_TABLE(of, dw_mci_socfpga_match);
 
 int dw_mci_socfpga_probe(struct platform_device *pdev)
 {
-	const struct dw_mci_drv_data *drv_data;
-	const struct of_device_id *match;
-
-	match = of_match_node(dw_mci_socfpga_match, pdev->dev.of_node);
-	drv_data = match->data;
-	return dw_mci_pltfm_register(pdev, drv_data);
+	return dw_mci_pltfm_register(pdev, &socfpga_drv_data);
 }
 
 static struct platform_driver dw_mci_socfpga_pltfm_driver = {
-- 
1.7.5.4

