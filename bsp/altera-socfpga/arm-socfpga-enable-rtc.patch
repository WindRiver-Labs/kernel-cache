From 3685981fc8f300513844625fc7c50c98bbc86990 Mon Sep 17 00:00:00 2001
From: Alan Tull <atull@altera.com>
Date: Tue, 5 Feb 2013 16:32:31 -0600
Subject: [PATCH 235/254] arm: socfpga: enable rtc

Upstream: git://git.rocketboards.org/linux-socfpga.git

Enable ds1339 I2C rtc in defconfig and device tree for socfpga
cyclone5 board.

Signed-off-by: Alan Tull <atull@altera.com>
(cherry picked from commit eaab814572321a3ad2b625f8792f42697b4e8617)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/boot/dts/socfpga_cyclone5.dts |    5 +++++
 arch/arm/configs/socfpga_defconfig     |    6 ++++++
 2 files changed, 11 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/socfpga_cyclone5.dts b/arch/arm/boot/dts/socfpga_cyclone5.dts
index 5e5ef4c..adcd611 100644
--- a/arch/arm/boot/dts/socfpga_cyclone5.dts
+++ b/arch/arm/boot/dts/socfpga_cyclone5.dts
@@ -201,4 +201,9 @@
 		reg = <0x51>;
 		pagesize = <32>;
 	};
+
+	rtc@68 {
+		compatible = "dallas,ds1339";
+		reg = <0x68>;
+	};
 };
diff --git a/arch/arm/configs/socfpga_defconfig b/arch/arm/configs/socfpga_defconfig
index bfed41b..e9241e3 100644
--- a/arch/arm/configs/socfpga_defconfig
+++ b/arch/arm/configs/socfpga_defconfig
@@ -138,3 +138,9 @@ CONFIG_LEDS_TRIGGER_TIMER=y
 CONFIG_LEDS_TRIGGER_CPU=y
 CONFIG_FPGA=y
 CONFIG_FPGA_MGR_ALTERA=y
+CONFIG_RTC_LIB=y
+CONFIG_RTC_CLASS=y
+CONFIG_RTC_INTF_SYSFS=y
+CONFIG_RTC_INTF_PROC=y
+CONFIG_RTC_INTF_DEV=y
+CONFIG_RTC_DRV_DS1307=y
-- 
1.7.5.4

