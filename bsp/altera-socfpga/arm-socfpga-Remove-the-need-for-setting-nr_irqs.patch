From 2f9c65a7925e6132217b3b6235450176bebd1bea Mon Sep 17 00:00:00 2001
From: Dinh Nguyen <dinguyen@altera.com>
Date: Wed, 3 Apr 2013 19:51:59 -0500
Subject: [PATCH 227/254] arm: socfpga: Remove the need for setting nr_irqs

Upstream: git://git.rocketboards.org/linux-socfpga.git

With the usage of SPARSE_IRQ and DT, we no longer need to explicitly
set nr_irqs in DT_MACHINE_START.

Signed-off-by: Dinh Nguyen <dinguyen@altera.com>
(cherry picked from commit 79236acbb84474deb00539cfe3461eb270c824bb)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-socfpga/core.h    |    1 +
 arch/arm/mach-socfpga/socfpga.c |    3 ---
 2 files changed, 1 insertions(+), 3 deletions(-)

diff --git a/arch/arm/mach-socfpga/core.h b/arch/arm/mach-socfpga/core.h
index 20e2a1a..bc97237 100644
--- a/arch/arm/mach-socfpga/core.h
+++ b/arch/arm/mach-socfpga/core.h
@@ -63,5 +63,6 @@ extern struct dw_mci_board sdmmc_platform_data;
 extern unsigned long cpu1start_addr;
 
 #define SOCFPGA_SCU_VIRT_BASE   0xfee00000
+#define SOCFPGA_IRQ_GIC_START	32
 
 #endif /* __CORE_H */
diff --git a/arch/arm/mach-socfpga/socfpga.c b/arch/arm/mach-socfpga/socfpga.c
index 2f1cc9d..874f2ee 100644
--- a/arch/arm/mach-socfpga/socfpga.c
+++ b/arch/arm/mach-socfpga/socfpga.c
@@ -33,8 +33,6 @@
 
 #include "core.h"
 
-#define SOCFPGA_NR_IRQS		512
-
 void __iomem *socfpga_scu_base_addr = ((void __iomem *)(SOCFPGA_SCU_VIRT_BASE));
 void __iomem *sys_manager_base_addr;
 void __iomem *rst_manager_base_addr;
@@ -350,7 +348,6 @@ DT_MACHINE_START(SOCFPGA, "Altera SOCFPGA")
 	.init_irq	= gic_init_irq,
 	.handle_irq     = gic_handle_irq,
 	.timer		= &dw_apb_timer,
-	.nr_irqs		= SOCFPGA_NR_IRQS,
 	.init_machine	= socfpga_cyclone5_init,
 	.restart	= socfpga_cyclone5_restart,
 	.dt_compat	= altera_dt_match,
-- 
1.7.5.4

