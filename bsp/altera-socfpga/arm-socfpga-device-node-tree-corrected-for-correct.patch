From 9ee8c9819ea780fbd73ccf0a5a8e51aec6cef0ab Mon Sep 17 00:00:00 2001
From: Lisa Treweek <ltreweek@altera.com>
Date: Thu, 14 Mar 2013 18:38:32 -0500
Subject: [PATCH 206/254] arm: socfpga: device node tree corrected for correct

Upstream: git://git.rocketboards.org/linux-socfpga.git
 flash part

Added the correct flash part number to the device tree.

Signed-off-by: Lisa Treweek <ltreweek@altera.com>
(cherry picked from commit dd4892bf9701920219f0526c3d0745416145281f)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/boot/dts/socfpga_cyclone5.dts |   24 ++----------------------
 drivers/mtd/devices/m25p80.c           |    1 +
 2 files changed, 3 insertions(+), 22 deletions(-)

diff --git a/arch/arm/boot/dts/socfpga_cyclone5.dts b/arch/arm/boot/dts/socfpga_cyclone5.dts
index 7f5316b..0647e77 100644
--- a/arch/arm/boot/dts/socfpga_cyclone5.dts
+++ b/arch/arm/boot/dts/socfpga_cyclone5.dts
@@ -62,10 +62,10 @@
 				fifo-depth = <128>;
 				bus-num = <2>;
 
-				flash0: n25q128@0 {
+				flash0: n25q00@0 {
 					#address-cells = <1>;
 					#size-cells = <1>;
-					compatible = "n25q128";
+					compatible = "n25q00";
 					reg = <0>;	/* chip select */
 					spi-max-frequency = <100000000>;
 					page-size = <256>;
@@ -88,26 +88,6 @@
 					};
 				};
 
-				flash1: n25q128@1 {
-					#address-cells = <1>;
-					#size-cells = <1>;
-					compatible = "n25q128";
-					reg = <1>;	/* chip select */
-					spi-max-frequency = <100000000>;
-					page-size = <256>;
-					block-size = <16>; /* 2^16, 64KB */
-					quad = <1>;
-					tshsl-ns = <200>;
-					tsd2d-ns = <255>;
-					tchsh-ns = <20>;
-					tslch-ns = <20>;
-
-					partition@0 {
-						/* 16MB for user data. */
-						label = "Flash 1 User Data";
-						reg = <0x0 0x1000000>;
-					};
-				};
 			};
 
 		sysmgr@ffd08000 {
diff --git a/drivers/mtd/devices/m25p80.c b/drivers/mtd/devices/m25p80.c
index dfb98ea..353f6a4 100644
--- a/drivers/mtd/devices/m25p80.c
+++ b/drivers/mtd/devices/m25p80.c
@@ -725,6 +725,7 @@ static const struct spi_device_id m25p_ids[] = {
 	{ "n25q128a11",  INFO(0x20bb18, 0, 64 * 1024, 256, 0) },
 	{ "n25q128a13",  INFO(0x20ba18, 0, 64 * 1024, 256, 0) },
 	{ "n25q256a", INFO(0x20ba19, 0, 64 * 1024, 512, SECT_4K) },
+	{ "n25q00",   INFO(0x20ba21, 0, 64 * 1024, 256, SECT_4K) },
 
 	/* Spansion -- single (large) sector size only, at least
 	 * for the chips listed here (without boot sectors).
-- 
1.7.5.4

