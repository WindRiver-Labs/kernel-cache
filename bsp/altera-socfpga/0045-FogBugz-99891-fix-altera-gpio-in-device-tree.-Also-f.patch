From bfc305f897006e73301d998944ab2412b89949e8 Mon Sep 17 00:00:00 2001
From: Alan Tull <atull@altera.com>
Date: Tue, 12 Feb 2013 09:56:34 -0600
Subject: [PATCH 045/248] FogBugz #99891: fix altera gpio in device tree. Also
 fix docs.

dts fixes for altera fpga so that it won't fail to probe.
also fix documentation, adding some things that were left out
(regs, interrupts) and clean up formatting for readability.

[Original patch taken from
git://git.rocketboards.org/linux-socfpga.git socfpga-3.14]

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
Signed-off-by: Alan Tull <atull@altera.com>
---
 Documentation/devicetree/bindings/gpio/gpio-altera.txt | 4 ++++
 arch/arm/boot/dts/socfpga.dtsi                         | 4 +++-
 2 files changed, 7 insertions(+), 1 deletion(-)

diff --git a/Documentation/devicetree/bindings/gpio/gpio-altera.txt b/Documentation/devicetree/bindings/gpio/gpio-altera.txt
index 39cead5..3bdb8b6 100644
--- a/Documentation/devicetree/bindings/gpio/gpio-altera.txt
+++ b/Documentation/devicetree/bindings/gpio/gpio-altera.txt
@@ -3,11 +3,13 @@ Altera GPIO controller bindings
 Required properties:
 - compatible:
   - "altr,pio-1.0"
+- reg: Physical base address and length of the controller's registers.
 - #gpio-cells : Should be two.
   - first cell is the pin number
   - second cell is used to specify optional parameters (unused)
 - gpio-controller : Marks the device node as a GPIO controller.
 - #interrupt-cells : Should be 1.
+- interrupts: Specify the interrupt.
 - interrupt-controller: Mark the device node as an interrupt controller
   The first cell is the GPIO number.
 
@@ -24,6 +26,8 @@ Example:
 
 gpio_altr: gpio_altr {
     compatible = "altr,pio-1.0";
+    reg = <0xff200000 0x10>;
+    interrupts = <0 45 4>;
     width = <32>;
     level_trigger = <0>;
     #gpio-cells = <2>;
diff --git a/arch/arm/boot/dts/socfpga.dtsi b/arch/arm/boot/dts/socfpga.dtsi
index 89774bc..2c04ede 100644
--- a/arch/arm/boot/dts/socfpga.dtsi
+++ b/arch/arm/boot/dts/socfpga.dtsi
@@ -70,12 +70,14 @@
 			compatible = "altr,pio-1.0";
 			/* Register base 0xff200000 is for a light-weight bridge */
 			reg = <0xff200000 0x10>;
+			width = <32>;
 			/* There are 64 interrupts from the FPGA start at 72, so 45 has to be wrong */
 			interrupts = <0 45 4>;
 			interrupt-controller;
-			#interrupt-cells = <2>;
+			#interrupt-cells = <1>;
 			gpio-controller;
 			#gpio-cells = <2>;
+			level_trigger = <0>;
 		};
 
 
-- 
1.9.1

