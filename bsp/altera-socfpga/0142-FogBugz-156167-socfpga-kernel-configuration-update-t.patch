From eed1998c7d75eecacacf5a8d72f712ee20991240 Mon Sep 17 00:00:00 2001
From: Yves Vandervennet <yvanderv@altera.com>
Date: Tue, 24 Sep 2013 20:43:53 -0500
Subject: [PATCH 142/248] FogBugz #156167: socfpga kernel configuration update
 to support udev

udev is required by Angstrom, which is our target Linux distribution.

The relevant kernel config options, for udev versions later than 141,
are listed on kernel.org:

  CONFIG_DEVTMPFS=y
  CONFIG_HOTPLUG=y
  CONFIG_INOTIFY_USER=y
  CONFIG_NET=y
  CONFIG_PROC_FS=y
  CONFIG_SIGNALFD=y
  CONFIG_SYSFS=y
  CONFIG_SYSFS_DEPRECATED*=n
  CONFIG_UEVENT_HELPER_PATH=""

This patch was tested against the Angstrom and Yocto RFS'es

V2:
   removed CONFIG_SYSFS_DEPRECATED=n

[Original patch taken from
git://git.rocketboards.org/linux-socfpga.git socfpga-3.14]

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
Signed-off-by: Yves Vandervennet <yvanderv@altera.com>
---
 arch/arm/configs/socfpga_defconfig | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/arch/arm/configs/socfpga_defconfig b/arch/arm/configs/socfpga_defconfig
index e7d72b7..f289796 100644
--- a/arch/arm/configs/socfpga_defconfig
+++ b/arch/arm/configs/socfpga_defconfig
@@ -11,6 +11,7 @@ CONFIG_PROFILING=y
 CONFIG_OPROFILE=y
 CONFIG_MODULES=y
 CONFIG_MODULE_UNLOAD=y
+CONFIG_HOTPLUG=y
 # CONFIG_LBDAF is not set
 # CONFIG_BLK_DEV_BSG is not set
 # CONFIG_IOSCHED_DEADLINE is not set
@@ -50,7 +51,7 @@ CONFIG_CAN_CALC_BITTIMING=y
 CONFIG_CAN_C_CAN=y
 CONFIG_CAN_C_CAN_PLATFORM=y
 CONFIG_CAN_DEBUG_DEVICES=y
-CONFIG_UEVENT_HELPER_PATH="/sbin/hotplug"
+CONFIG_UEVENT_HELPER_PATH=""
 CONFIG_DEVTMPFS=y
 CONFIG_DEVTMPFS_MOUNT=y
 CONFIG_MTD=y
@@ -119,7 +120,7 @@ CONFIG_EXT4_FS=y
 # CONFIG_EXT3_FS_POSIX_ACL is not set
 # CONFIG_EXT3_FS_SECURITY is not set
 # CONFIG_DNOTIFY is not set
-# CONFIG_INOTIFY_USER is not set
+CONFIG_INOTIFY_USER=y
 CONFIG_VFAT_FS=y
 CONFIG_NTFS_FS=y
 CONFIG_NTFS_RW=y
@@ -171,3 +172,4 @@ CONFIG_FTRACE_MCOUNT_RECORD=y
 CONFIG_OLD_MCOUNT=y
 CONFIG_FPGA_BRIDGE=y
 CONFIG_ALTERA_SOCFPGA_BRIDGE=y
+CONFIG_SIGNALFD=y
-- 
1.9.1

