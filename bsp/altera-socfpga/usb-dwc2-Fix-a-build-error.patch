From 85a3e4b2af39b6244cc40e826599034db404b3f5 Mon Sep 17 00:00:00 2001
From: Yang Wei <Wei.Yang@windriver.com>
Date: Tue, 22 Apr 2014 14:23:19 +0800
Subject: [PATCH 13/24] usb/dwc2: Fix a build error

drivers/usb/dwc2/platform.c:160:2:
error: implicit declaration of function 'devm_ioremap_resource'
[-Werror=implicit-function-declaration]
drivers/usb/dwc2/platform.c:160:14:
warning: assignment makes pointer from integer without a cast [enabled
by default]
cc1: some warnings being treated as errors

Signed-off-by: Yang Wei <Wei.Yang@windriver.com>
---
 drivers/usb/dwc2/platform.c |    6 +++---
 1 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/usb/dwc2/platform.c b/drivers/usb/dwc2/platform.c
index fa6a090..d434c9d 100644
--- a/drivers/usb/dwc2/platform.c
+++ b/drivers/usb/dwc2/platform.c
@@ -114,9 +114,9 @@ static int dwc2_driver_probe(struct platform_device *dev)
 	}
 
 	res = platform_get_resource(dev, IORESOURCE_MEM, 0);
-	hsotg->regs = devm_ioremap_resource(&dev->dev, res);
-	if (IS_ERR(hsotg->regs))
-		return PTR_ERR(hsotg->regs);
+	hsotg->regs = devm_request_and_ioremap(&dev->dev, res);
+	if (!hsotg->regs)
+		return ERR_PTR(-ENOMEM);
 
 	dev_dbg(&dev->dev, "mapped PA %08lx to VA %p\n",
 		(unsigned long)res->start, hsotg->regs);
-- 
1.7.5.4

