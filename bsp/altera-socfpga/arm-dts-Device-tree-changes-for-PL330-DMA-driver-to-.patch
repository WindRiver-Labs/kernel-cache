From eddb2004f8b804eb7de5af335a311e2a49b251b9 Mon Sep 17 00:00:00 2001
From: Graham Moore <grmoore@altera.com>
Date: Wed, 24 Jul 2013 12:38:12 -0500
Subject: [PATCH 03/10] arm/dts: Device tree changes for PL330 DMA driver to
 support socfpga CycloneV

commit 2ed2469bb79c9634dcd6337e347286d46bebe233
git://git.rocketboards.org/linux-socfpga.git socfpga-3.13
Added multiple interrupts to device tree.
Added copy-align to device tree.
Added clocks and clock-names to device tree.
Updated documentation for pl330 device tree bindings.

Signed-off-by: Graham Moore <grmoore@altera.com>

V2:

Remove documentation for clocks and clock-names from arm-pl330.txt, as
they are documented in primecell.txt.
Signed-off-by: Yang Wei <Wei.Yang@windriver.com>
---
 .../devicetree/bindings/dma/arm-pl330.txt          |    6 +++++-
 arch/arm/boot/dts/socfpga.dtsi                     |   12 +++++++++++-
 2 files changed, 16 insertions(+), 2 deletions(-)

diff --git a/Documentation/devicetree/bindings/dma/arm-pl330.txt b/Documentation/devicetree/bindings/dma/arm-pl330.txt
index 6b8b403..3764c16 100644
--- a/Documentation/devicetree/bindings/dma/arm-pl330.txt
+++ b/Documentation/devicetree/bindings/dma/arm-pl330.txt
@@ -7,7 +7,7 @@ Required properties:
   - compatible: should include both "arm,pl330" and "arm,primecell".
   - reg: physical base address of the controller and length of memory mapped
     region.
-  - interrupts: interrupt number to the cpu.
+  - interrupts: interrupt number(s) to the cpu.  A maximum of eight interrupts can be specified.
 
 Optional properties:
  - dma-coherent      : Present if dma operations are coherent
@@ -15,6 +15,7 @@ Optional properties:
    cells in the dmas property of client device.
  - dma-channels: contains the total number of DMA channels supported by the DMAC
  - dma-requests: contains the total number of DMA requests supported by the DMAC
+ - copy-align: power-of-2 alignment for buffers sent to DMAC
 
 Example:
 
@@ -25,6 +26,9 @@ Example:
         #dma-cells = <1>;
         #dma-channels = <8>;
         #dma-requests = <32>;
+		copy-align = <3>;
+		clocks = <&l4_main_clk>;
+		clock-names = "apb_pclk";
 	};
 
 Client drivers (device nodes requiring dma transfers from dev-to-mem or
diff --git a/arch/arm/boot/dts/socfpga.dtsi b/arch/arm/boot/dts/socfpga.dtsi
index 4f4c1d7..cd4aa79 100644
--- a/arch/arm/boot/dts/socfpga.dtsi
+++ b/arch/arm/boot/dts/socfpga.dtsi
@@ -75,10 +75,20 @@
 			pdma: pdma@ffe01000 {
 				compatible = "arm,pl330", "arm,primecell";
 				reg = <0xffe01000 0x1000>;
-				interrupts = <0 180 4>;
+				interrupts = <0 104 4>,
+					<0 105 4>,
+					<0 106 4>,
+					<0 107 4>,
+					<0 108 4>,
+					<0 109 4>,
+					<0 110 4>,
+					<0 111 4>;
 				#dma-cells = <1>;
 				#dma-channels = <8>;
 				#dma-requests = <32>;
+				copy-align = <3>;
+				clocks = <&l4_main_clk>;
+				clock-names = "apb_pclk";
 			};
 		};
 
-- 
1.7.5.4

