From f53de3ee11a89e2a89b983d84f1b543bb6884952 Mon Sep 17 00:00:00 2001
From: Dinh Nguyen <dinguyen@opensource.altera.com>
Date: Wed, 24 Sep 2014 20:09:05 -0500
Subject: [PATCH 096/172] arm: socfpga: Change cpu1 reset register for Arria 10
 SOC

The Arria 10 SOC had a different cpu1 reset register than the Cyclone5 and
the Arria5 SOC.

Signed-off-by: Dinh Nguyen <dinguyen@opensource.altera.com>
[czou:Original patch taken from
https://github.com/altera-opensource/linux-socfpga.git socfpga-4.1]
Signed-off-by: czou <cao.zou@windriver.com>

Conflicts:
	arch/arm/mach-socfpga/platsmp.c
---
 arch/arm/mach-socfpga/platsmp.c | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/arch/arm/mach-socfpga/platsmp.c b/arch/arm/mach-socfpga/platsmp.c
index 996b5af..e9ea0f2 100644
--- a/arch/arm/mach-socfpga/platsmp.c
+++ b/arch/arm/mach-socfpga/platsmp.c
@@ -47,8 +47,11 @@ static int socfpga_boot_secondary(unsigned int cpu, struct task_struct *idle)
 		smp_wmb();
 		outer_clean_range(0, trampoline_size);
 
-		/* This will release CPU #1 out of reset. */
-		writel(0, rst_manager_base_addr + SOCFPGA_RSTMGR_MODMPURST);
+		/* This will release CPU #1 out of reset.*/
+		if (of_machine_is_compatible("altr,socfpga-arria10"))
+			writel(0, rst_manager_base_addr + 0x20);
+		else
+			writel(0, rst_manager_base_addr + 0x10);
 	}
 
 	return 0;
-- 
1.9.1

