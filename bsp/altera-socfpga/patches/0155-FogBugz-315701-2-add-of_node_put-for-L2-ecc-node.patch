From 40cd8e2eca58539a0becbf1ac0f22cb77babd0c2 Mon Sep 17 00:00:00 2001
From: Dinh Nguyen <dinguyen@opensource.altera.com>
Date: Mon, 3 Aug 2015 16:23:49 -0500
Subject: [PATCH 155/172] FogBugz #315701-2: add of_node_put for L2 ecc node

Both of the ecc init functions need to call of_node_put once the node is
found.

Signed-off-by: Dinh Nguyen <dinguyen@opensource.altera.com>
[czou:Original patch taken from
https://github.com/altera-opensource/linux-socfpga.git socfpga-4.1]
Signed-off-by: czou <cao.zou@windriver.com>
---
 arch/arm/mach-socfpga/l2_cache.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/arch/arm/mach-socfpga/l2_cache.c b/arch/arm/mach-socfpga/l2_cache.c
index bc94689..ff265e1 100644
--- a/arch/arm/mach-socfpga/l2_cache.c
+++ b/arch/arm/mach-socfpga/l2_cache.c
@@ -48,6 +48,7 @@ void socfpga_init_arria10_l2_ecc(void)
 
 	pr_alert("SOCFPGA: Success Initializing L2 cache ECC for Arria10");
 
+	of_node_put(np);
 	return;
 }
 
@@ -72,6 +73,7 @@ void socfpga_init_l2_ecc(void)
 	writel(0x01, mapped_l2_edac_addr);
 
 	pr_alert("SOCFPGA: Success Initializing L2 cache ECC");
+	of_node_put(np);
 
 	return;
 }
-- 
1.9.1

