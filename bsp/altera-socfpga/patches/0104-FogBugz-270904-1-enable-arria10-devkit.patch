From a627fb9bcc13e1c66e5a11d7967d22dead0f6a25 Mon Sep 17 00:00:00 2001
From: Dinh Nguyen <dinguyen@opensource.altera.com>
Date: Mon, 26 Jan 2015 16:43:11 -0600
Subject: [PATCH 104/172] FogBugz #270904-1: enable arria10 devkit

Update the arria10 dts to have some hard-coded clock frequencies.
For the devkit, uart1 is the debug uart.

Signed-off-by: Dinh Nguyen <dinguyen@opensource.altera.com>
[czou:Original patch taken from
https://github.com/altera-opensource/linux-socfpga.git socfpga-4.1]
Signed-off-by: czou <cao.zou@windriver.com>
---
 arch/arm/boot/dts/socfpga_arria10.dtsi      | 38 ++++++++++++++++++-----------
 arch/arm/boot/dts/socfpga_arria10_socdk.dts |  2 +-
 2 files changed, 25 insertions(+), 15 deletions(-)

diff --git a/arch/arm/boot/dts/socfpga_arria10.dtsi b/arch/arm/boot/dts/socfpga_arria10.dtsi
index 539e40f..387e026 100644
--- a/arch/arm/boot/dts/socfpga_arria10.dtsi
+++ b/arch/arm/boot/dts/socfpga_arria10.dtsi
@@ -103,20 +103,21 @@
 						compatible = "fixed-clock";
 					};
 
-					main_pll: main_pll {
-						#address-cells = <1>;
-						#size-cells = <0>;
+					l4_mp_clk: l4_mp_clk {
 						#clock-cells = <0>;
-						compatible = "altr,socfpga-pll-clock";
-						clocks = <&osc1>;
+						compatible = "fixed-clock";
+						clock-frequency = <200000000>;
+					};
+
+					sdmmc_clk: sdmmc_clk {
+						#clock-cells = <0>;
+						compatible = "fixed-clock";
 					};
 
-					periph_pll: periph_pll {
-						#address-cells = <1>;
-						#size-cells = <0>;
+					mpu_periph_clk: mpu_periph_clk {
 						#clock-cells = <0>;
-						compatible = "altr,socfpga-pll-clock";
-						clocks = <&osc1>;
+						compatible = "fixed-clock";
+						clock-frequency = <200000000>;
 					};
 				};
 		};
@@ -280,6 +281,8 @@
 			reg = <0xff808000 0x1000>;
 			interrupts = <0 98 IRQ_TYPE_LEVEL_HIGH>;
 			fifo-depth = <0x400>;
+			clocks = <&l4_mp_clk>, <&sdmmc_clk>;
+			clock-names = "biu", "ciu";
 		};
 
 		ocram: sram@ffe00000 {
@@ -304,28 +307,32 @@
 			compatible = "arm,cortex-a9-twd-timer";
 			reg = <0xffffc600 0x100>;
 			interrupts = <1 13 0xf04>;
+			clocks = <&mpu_periph_clk>;
 		};
 
 		timer0: timer0@ffc02700 {
-			compatible = "snps,dw-apb-timer";
+			compatible = "snps,dw-apb-timer-sp";
 			interrupts = <0 115 IRQ_TYPE_LEVEL_HIGH>;
 			reg = <0xffc02700 0x100>;
+			clock-frequency = <100000000>;
 		};
 
 		timer1: timer1@ffc02800 {
-			compatible = "snps,dw-apb-timer";
+			compatible = "snps,dw-apb-timer-sp";
 			interrupts = <0 116 IRQ_TYPE_LEVEL_HIGH>;
 			reg = <0xffc02800 0x100>;
+			clock-frequency = <100000000>;
 		};
 
 		timer2: timer2@ffd00000 {
-			compatible = "snps,dw-apb-timer";
+			compatible = "snps,dw-apb-timer-osc";
 			interrupts = <0 117 IRQ_TYPE_LEVEL_HIGH>;
 			reg = <0xffd00000 0x100>;
+			clock-frequency = <100000000>;
 		};
 
 		timer3: timer3@ffd00100 {
-			compatible = "snps,dw-apb-timer";
+			compatible = "snps,dw-apb-timer-osc";
 			interrupts = <0 118 IRQ_TYPE_LEVEL_HIGH>;
 			reg = <0xffd01000 0x100>;
 		};
@@ -336,6 +343,7 @@
 			interrupts = <0 110 IRQ_TYPE_LEVEL_HIGH>;
 			reg-shift = <2>;
 			reg-io-width = <4>;
+			status = "disabled";
 		};
 
 		uart1: serial1@ffc02100 {
@@ -344,6 +352,8 @@
 			interrupts = <0 111 IRQ_TYPE_LEVEL_HIGH>;
 			reg-shift = <2>;
 			reg-io-width = <4>;
+			clock-frequency = <100000000>;
+			status = "disabled";
 		};
 
 		usbphy0: usbphy@0 {
diff --git a/arch/arm/boot/dts/socfpga_arria10_socdk.dts b/arch/arm/boot/dts/socfpga_arria10_socdk.dts
index b9e33ef..65a4eca 100755
--- a/arch/arm/boot/dts/socfpga_arria10_socdk.dts
+++ b/arch/arm/boot/dts/socfpga_arria10_socdk.dts
@@ -126,7 +126,7 @@
 			};
 		};
 
-		serial0@ffc02000 {
+		serial1@ffc02100 {
 			status = "okay";
 		};
 	};
-- 
1.9.1

