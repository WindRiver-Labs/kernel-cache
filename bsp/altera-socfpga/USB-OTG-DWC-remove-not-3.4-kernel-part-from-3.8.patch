From ae17f6b820bb72437b4591ab969a5cad66df9a64 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Mon, 15 Apr 2013 13:29:48 +0800
Subject: [PATCH 249/254] USB: OTG: DWC: remove not 3.4 kernel part from 3.8

Since these patches back-port from kernel 3.8 of socfpga,
the related parts should be removed for compiling.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/usb/otg/dwc/platform.c |    7 +++----
 1 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/drivers/usb/otg/dwc/platform.c b/drivers/usb/otg/dwc/platform.c
index ebb3675..5ba0517 100644
--- a/drivers/usb/otg/dwc/platform.c
+++ b/drivers/usb/otg/dwc/platform.c
@@ -52,7 +52,6 @@
  */
 
 #include <linux/usb/dwc_otg.h>
-#include <linux/usb/nop-usb-xceiv.h>
 #include <linux/platform_device.h>
 #include <linux/of_platform.h>
 
@@ -130,7 +129,7 @@ static int __devexit dwc_otg_driver_remove(struct platform_device *ofdev)
 	if (dwc_dev->phys_addr)
 		release_mem_region(dwc_dev->phys_addr, dwc_dev->base_len);
 
-	usb_put_phy(dwc_dev->core_if->xceiv);
+	usb_put_transceiver(dwc_dev->core_if->xceiv);
 	dwc_dev->core_if->xceiv = NULL;
 
 	kfree(dwc_dev);
@@ -276,7 +275,7 @@ static int __devinit dwc_otg_driver_probe(struct platform_device *ofdev)
 #endif
 
 	usb_nop_xceiv_register();
-	dwc_dev->core_if->xceiv = usb_get_phy(USB_PHY_TYPE_USB2);
+	dwc_dev->core_if->xceiv = usb_get_transceiver();
 	if (!dwc_dev->core_if->xceiv) {
 		retval = -ENODEV;
 		goto fail_xceiv;
@@ -366,7 +365,7 @@ fail_hcd:
 			dwc_otg_pcd_remove(dev);
 	}
 fail_req_irq:
-	usb_put_phy(dwc_dev->core_if->xceiv);
+	usb_put_transceiver(dwc_dev->core_if->xceiv);
 fail_xceiv:
 	usb_nop_xceiv_unregister();
 fail_check_param:
-- 
1.7.5.4

