From 460f2c0dd63635727af8e153e1688df8c981a542 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Wed, 17 Apr 2013 15:27:01 +0800
Subject: [PATCH 1/1] grsec: mm: workaround is for changes of kernel module 

FIXME: update arch/arm/modules to meet the changes
of struct module introducing by CGP kernel.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/kernel/module.c |    4 ++++
 1 file changed, 4 insertions(+)

diff --git a/arch/arm/kernel/module.c b/arch/arm/kernel/module.c
index 1e9be5d..62f5ca0 100644
--- a/arch/arm/kernel/module.c
+++ b/arch/arm/kernel/module.c
@@ -39,6 +39,10 @@
 #ifdef CONFIG_MMU
 void *module_alloc(unsigned long size)
 {
+
+	if (!size) 
+		return NULL;
+
 	return __vmalloc_node_range(size, 1, MODULES_VADDR, MODULES_END,
 				GFP_KERNEL, PAGE_KERNEL_EXEC, -1,
 				__builtin_return_address(0));
-- 
1.7.10.4

