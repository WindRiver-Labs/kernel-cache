From d67c0bf9b98464db25e5a33e9c9a9b76ff34b8f6 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Wed, 17 Apr 2013 12:03:04 +0800
Subject: [PATCH 1/1] grsec: mmc: disable irq thread for mmc

Since irq thread on mmc is not compatible with grsec,
so disable it to mute benign warnings.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/mmc/host/dw_mmc.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/mmc/host/dw_mmc.c b/drivers/mmc/host/dw_mmc.c
index d3d8913..875bc33 100644
--- a/drivers/mmc/host/dw_mmc.c
+++ b/drivers/mmc/host/dw_mmc.c
@@ -2258,7 +2258,7 @@ int dw_mci_probe(struct dw_mci *host)
 		goto err_dmaunmap;
 	INIT_WORK(&host->card_work, dw_mci_work_routine_card);
 	ret = devm_request_irq(host->dev, host->irq, dw_mci_interrupt,
-			       host->irq_flags, "dw-mci", host);
+			       host->irq_flags | IRQF_NO_THREAD, "dw-mci", host);
 	if (ret)
 		goto err_workqueue;
 
-- 
1.7.10.4

