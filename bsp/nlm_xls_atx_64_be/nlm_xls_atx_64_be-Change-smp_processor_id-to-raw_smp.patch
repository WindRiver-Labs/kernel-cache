From c684e9590a82ac8aad60f787c45d968c1a80bb2f Mon Sep 17 00:00:00 2001
From: Tian Le <le.tian@windriver.com>
Date: Fri, 28 Jan 2011 11:42:06 +0800
Subject: [PATCH] nlm_xls_atx_64_be: Change smp_processor_id to raw_smp_processor_id to fix call trace.

The call trace is caused by using smp_processor_id() in preemptible
context. So change it to raw_smp_processor_id().

Signed-off-by: Tian Le <le.tian@windriver.com>
---
 drivers/net/phoenix_user_mac.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/net/phoenix_user_mac.c b/drivers/net/phoenix_user_mac.c
index 0159e45..70e78d6 100644
--- a/drivers/net/phoenix_user_mac.c
+++ b/drivers/net/phoenix_user_mac.c
@@ -1172,7 +1172,7 @@ static int user_mac_proc_read(char *page, char **start, off_t off,
 	len += sprintf(page + len,
 		       "\n*************** USER MAC STATISTICS ****************\n"
 		       "cpu_%d: proc_read_count = %d\n",
-		       smp_processor_id(), proc_read_count);
+		       raw_smp_processor_id(), proc_read_count);
 	if (!proc_pos_check(&begin, &len, off, count))
 		goto out;
 
-- 
1.6.5.2

