From 0ad002e486ccf127ccc415bc6eee4176073ab202 Mon Sep 17 00:00:00 2001
From: Shuo Liu <shuo.liu@windriver.com>
Date: Tue, 3 Nov 2009 17:38:29 +0800
Subject: [PATCH 4/4] add a "env" partition on the flash

Modify the mtd partitions table, add a "env" partition for bootloader storing environment variable.

Signed-off-by: Shuo Liu <shuo.liu@windriver.com>
---
 drivers/mtd/maps/bcm5621x_flash.c |   15 ++++++++++-----
 1 files changed, 10 insertions(+), 5 deletions(-)

diff --git a/drivers/mtd/maps/bcm5621x_flash.c b/drivers/mtd/maps/bcm5621x_flash.c
index c4c5c6d..0b9b618 100644
--- a/drivers/mtd/maps/bcm5621x_flash.c
+++ b/drivers/mtd/maps/bcm5621x_flash.c
@@ -40,15 +40,20 @@ static struct mtd_partition bcm_partitions[] = {
 		.mask_flags = MTD_WRITEABLE,
 	},
 	{
-		.name = "os",
+		.name = "env",
 		.offset = 0x80000,
-		.size = 0x400000,			  /* New CFI flash at 1C000000 offset 00080000 size 4096KB(4MB) */
+		.size = 0x8000,			 	  /* New CFI flash at 1C000000 offset 00080000 size 32KB */   
+	},
+	{
+		.name = "os",
+		.offset = 0x88000,
+		.size = 0x600000,			  /* New CFI flash at 1C000000 offset 00080000 size 6MB */
 	},
 	{
 		.name = "rootfs",
-		.offset = 0x480000,
-		.size = 0xb00000,			  /* New CFI flash at 1C000000 offset 00480000 size 11264KB(11MB) */
-	}
+		.offset = 0x688000,
+		.size = 0xf00000,			  /* New CFI flash at 1C000000 offset 00480000 size 15MB */
+	},
 };
 
 #define NUM_PARTITIONS ARRAY_SIZE(bcm_partitions)
-- 
1.6.5.2

