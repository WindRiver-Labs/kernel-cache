From 072542d9d2f76e0a6cb7b58b57abd797c46bfe78 Mon Sep 17 00:00:00 2001
From: Wu Zhangjin <zhangjin.wu@windriver.com>
Date: Fri, 16 Jul 2010 20:02:56 +0800
Subject: [PATCH 01/12] powerpc/85xx: eSPI: Update SPI-flash parameters

Without this fix, the SPI flash will not be probed successfully and then
no information about SPI will be shown in /proc/mtd.

The basic idea of this fix is originally from "Update eSPI flash
parameters set in fsl_p2020rdb dts file".

Signed-off-by: Wu Zhangjin <zhangjin.wu@windriver.com>
---
 arch/powerpc/boot/dts/p1020rdb.dts |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/boot/dts/p1020rdb.dts b/arch/powerpc/boot/dts/p1020rdb.dts
index df52690..e116a30 100644
--- a/arch/powerpc/boot/dts/p1020rdb.dts
+++ b/arch/powerpc/boot/dts/p1020rdb.dts
@@ -242,6 +242,7 @@
 			compatible = "fsl,espi";
 			reg = <0x7000 0x1000>;
 			interrupts = <59 0x2>;
+			espi,num-ss-bits = <4>;
 			interrupt-parent = <&mpic>;
 			mode = "cpu";
 
@@ -252,7 +253,7 @@
 				reg = <0>;
 				linux,modalias = "fsl_m25p80";
 				modal = "s25sl128b";
-				spi-max-frequency = <50000000>;
+				spi-max-frequency = <40000000>;
 				mode = <0>;
 
 				partition@0 {
-- 
1.6.5.2

