From be6b8416618d945d5df39d411f48443a32195a07 Mon Sep 17 00:00:00 2001
From: Chunbo Luo <chunbo.luo@windriver.com>
Date: Fri, 10 Jul 2009 11:06:22 +0800
Subject: [PATCH] broadcom_bcm98548xmc: update dts to fix PCI interrupt maps

Fix PCI interrupt map for broadcom bcm98548xmc board.

Signed-off-by: Chunbo Luo <chunbo.luo@windriver.com>
---
 arch/powerpc/boot/dts/bcm98548xmc.dts |  142 +++++++++++++++++++--------------
 1 files changed, 81 insertions(+), 61 deletions(-)

diff --git a/arch/powerpc/boot/dts/bcm98548xmc.dts b/arch/powerpc/boot/dts/bcm98548xmc.dts
index e9e00b7..b8129c6 100644
--- a/arch/powerpc/boot/dts/bcm98548xmc.dts
+++ b/arch/powerpc/boot/dts/bcm98548xmc.dts
@@ -200,69 +200,89 @@
 	pci@e0008000 {
 		interrupt-map-mask = <0xf800 0x0 0x0 0x7>;
 		interrupt-map = <
-			/* IDSEL 0x4 (PCIX Slot 2) */
-			0x2000 0x0 0x0 0x1 &mpic 0x0 0x1
-			0x2000 0x0 0x0 0x2 &mpic 0x1 0x1
-			0x2000 0x0 0x0 0x3 &mpic 0x2 0x1
-			0x2000 0x0 0x0 0x4 &mpic 0x3 0x1
-
-			/* IDSEL 0x5 (PCIX Slot 3) */
-			0x2800 0x0 0x0 0x1 &mpic 0x1 0x1
-			0x2800 0x0 0x0 0x2 &mpic 0x2 0x1
-			0x2800 0x0 0x0 0x3 &mpic 0x3 0x1
-			0x2800 0x0 0x0 0x4 &mpic 0x0 0x1
-
-			/* IDSEL 0x6 (PCIX Slot 4) */
-			0x3000 0x0 0x0 0x1 &mpic 0x2 0x1
-			0x3000 0x0 0x0 0x2 &mpic 0x3 0x1
-			0x3000 0x0 0x0 0x3 &mpic 0x0 0x1
-			0x3000 0x0 0x0 0x4 &mpic 0x1 0x1
-
-			/* IDSEL 0x8 (PCIX Slot 5) */
-			0x4000 0x0 0x0 0x1 &mpic 0x0 0x1
-			0x4000 0x0 0x0 0x2 &mpic 0x1 0x1
-			0x4000 0x0 0x0 0x3 &mpic 0x2 0x1
-			0x4000 0x0 0x0 0x4 &mpic 0x3 0x1
-
-			/* IDSEL 0xC (Tsi310 bridge) */
-			0x6000 0x0 0x0 0x1 &mpic 0x0 0x1
-			0x6000 0x0 0x0 0x2 &mpic 0x1 0x1
-			0x6000 0x0 0x0 0x3 &mpic 0x2 0x1
-			0x6000 0x0 0x0 0x4 &mpic 0x3 0x1
-
-			/* IDSEL 0x14 (Slot 2) */
-			0xa000 0x0 0x0 0x1 &mpic 0x0 0x1
-			0xa000 0x0 0x0 0x2 &mpic 0x1 0x1
-			0xa000 0x0 0x0 0x3 &mpic 0x2 0x1
-			0xa000 0x0 0x0 0x4 &mpic 0x3 0x1
-
-			/* IDSEL 0x15 (Slot 3) */
-			0xa800 0x0 0x0 0x1 &mpic 0x1 0x1
-			0xa800 0x0 0x0 0x2 &mpic 0x2 0x1
-			0xa800 0x0 0x0 0x3 &mpic 0x3 0x1
-			0xa800 0x0 0x0 0x4 &mpic 0x0 0x1
-
-			/* IDSEL 0x16 (Slot 4) */
-			0xb000 0x0 0x0 0x1 &mpic 0x2 0x1
-			0xb000 0x0 0x0 0x2 &mpic 0x3 0x1
-			0xb000 0x0 0x0 0x3 &mpic 0x0 0x1
-			0xb000 0x0 0x0 0x4 &mpic 0x1 0x1
-
-			/* IDSEL 0x18 (Slot 5) */
-			0xc000 0x0 0x0 0x1 &mpic 0x0 0x1
-			0xc000 0x0 0x0 0x2 &mpic 0x1 0x1
-			0xc000 0x0 0x0 0x3 &mpic 0x2 0x1
-			0xc000 0x0 0x0 0x4 &mpic 0x3 0x1
-
-			/* IDSEL 0x1C (Tsi310 bridge PCI primary) */
-			0xe000 0x0 0x0 0x1 &mpic 0x0 0x1
-			0xe000 0x0 0x0 0x2 &mpic 0x1 0x1
-			0xe000 0x0 0x0 0x3 &mpic 0x2 0x1
-			0xe000 0x0 0x0 0x4 &mpic 0x3 0x1>;
+			0x08000 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x08000 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x08000 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x08000 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x08800 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x08800 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x08800 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x08800 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x09000 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x09000 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x09000 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x09000 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x09800 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x09800 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x09800 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x09800 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0a000 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0a000 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0a000 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0a000 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0a800 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0a800 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0a800 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0a800 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0b000 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0b000 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0b000 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0b000 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0b800 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0b800 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0b800 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0b800 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0c000 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0c000 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0c000 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0c000 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0c800 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0c800 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0c800 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0c800 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0d000 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0d000 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0d000 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0d000 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0d800 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0d800 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0d800 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0d800 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0e000 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0e000 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0e000 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0e000 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0e800 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0e800 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0e800 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0e800 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0f000 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0f000 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0f000 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0f000 0x0 0x0 0x4 &mpic 0x33 0x1
+
+			0x0f800 0x0 0x0 0x1 &mpic 0x30 0x1
+			0x0f800 0x0 0x0 0x2 &mpic 0x31 0x1
+			0x0f800 0x0 0x0 0x3 &mpic 0x32 0x1
+			0x0f800 0x0 0x0 0x4 &mpic 0x33 0x1>;
 
 		interrupt-parent = <&mpic>;
-		interrupts = <24 2>;
-		bus-range = <0 0>;
+		interrupts = <8 2>;
+		bus-range = <0x00 0x7f>;
 		ranges = <0x02000000 0x0 0x50000000 0x50000000 0x0 0x10000000
 			  0x01000000 0x0 0x00000000 0xe2000000 0x0 0x04000000>;
 		clock-frequency = <0x3b74a460>;
-- 
1.6.3.3

