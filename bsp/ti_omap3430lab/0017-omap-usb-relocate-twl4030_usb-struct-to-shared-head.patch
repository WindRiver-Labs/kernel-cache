From c3417c448c451d7f94cc415c84324f4eb3b7b43a Mon Sep 17 00:00:00 2001
From: Stanley.Miao <stanley.miao@windriver.com>
Date: Mon, 11 May 2009 22:06:20 +0800
Subject: [PATCH] omap usb: relocate twl4030_usb struct to shared header.

Future changes will require the twl4030_usb struct definition to be
visible to the shared code in musb_core.c so factor it out and put
it into the appropriate header file.

Signed-off-by: Stanley.Miao <stanley.miao@windriver.com>
---
 drivers/i2c/chips/twl4030-usb.c |   23 -----------------------
 include/linux/i2c/twl4030.h     |   24 ++++++++++++++++++++++++
 2 files changed, 24 insertions(+), 23 deletions(-)

diff --git a/drivers/i2c/chips/twl4030-usb.c b/drivers/i2c/chips/twl4030-usb.c
index f967353..3267191 100644
--- a/drivers/i2c/chips/twl4030-usb.c
+++ b/drivers/i2c/chips/twl4030-usb.c
@@ -248,29 +248,6 @@
 	OTG_CTRL_BITS)
 
 
-enum linkstat {
-	USB_LINK_UNKNOWN = 0,
-	USB_LINK_NONE,
-	USB_LINK_VBUS,
-	USB_LINK_ID,
-};
-
-struct twl4030_usb {
-	struct otg_transceiver	otg;
-	struct device		*dev;
-
-	/* for vbus reporting with irqs disabled */
-	spinlock_t		lock;
-
-	/* pin configuration */
-	enum twl4030_usb_mode	usb_mode;
-
-	int			irq;
-	u8			linkstat;
-	u8			asleep;
-	bool			irq_enabled;
-};
-
 /* internal define on top of container_of */
 #define xceiv_to_twl(x)		container_of((x), struct twl4030_usb, otg);
 
diff --git a/include/linux/i2c/twl4030.h b/include/linux/i2c/twl4030.h
index fb604dc..477aa4c 100644
--- a/include/linux/i2c/twl4030.h
+++ b/include/linux/i2c/twl4030.h
@@ -340,4 +340,28 @@ int twl4030_set_gpio_debounce(int gpio, int enable);
 	static inline int twl4030charger_usb_en(int enable) { return 0; }
 #endif
 
+enum linkstat {
+	USB_LINK_UNKNOWN = 0,
+	USB_LINK_NONE,
+	USB_LINK_VBUS,
+	USB_LINK_ID,
+};
+
+#include <linux/usb/otg.h>
+struct twl4030_usb {
+	struct otg_transceiver	otg;
+	struct device		*dev;
+
+	/* for vbus reporting with irqs disabled */
+	spinlock_t		lock;
+
+	/* pin configuration */
+	enum twl4030_usb_mode	usb_mode;
+
+	int			irq;
+	u8			linkstat;
+	u8			asleep;
+	bool			irq_enabled;
+};
+
 #endif /* End of __TWL4030_H */
-- 
1.6.0.4

