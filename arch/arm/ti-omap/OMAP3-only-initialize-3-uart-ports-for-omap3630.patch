From f6ffa816193fa63e8275372f45d9ea5388eb6e62 Mon Sep 17 00:00:00 2001
From: Stanley.Miao <stanley.miao@windriver.com>
Date: Fri, 29 Jul 2011 14:51:00 +0800
Subject: [PATCH] OMAP3: only initialize 3 uart ports for omap3630

Initializing the 4th uart port of omap3630 will cause dsplink not to work
properly. So only initialize the first 3 uart ports for omap3630.

Signed-off-by: Stanley.Miao <stanley.miao@windriver.com>
---
 arch/arm/mach-omap2/serial.c |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/arch/arm/mach-omap2/serial.c b/arch/arm/mach-omap2/serial.c
index cdc98a7..3f98a92 100644
--- a/arch/arm/mach-omap2/serial.c
+++ b/arch/arm/mach-omap2/serial.c
@@ -639,10 +639,10 @@ void __init omap_serial_early_init(void)
 	int i, nr_ports;
 	char name[16];
 
-	if (!(cpu_is_omap3630() || cpu_is_omap4430()))
-		nr_ports = 3;
-	else
+	if (cpu_is_omap4430())
 		nr_ports = ARRAY_SIZE(omap_uart);
+	else
+		nr_ports = 3;
 
 	/*
 	 * Make sure the serial ports are muxed on at this point.
@@ -774,10 +774,10 @@ void __init omap_serial_init(void)
 {
 	int i, nr_ports;
 
-	if (!(cpu_is_omap3630() || cpu_is_omap4430()))
-		nr_ports = 3;
-	else
+	if (cpu_is_omap4430())
 		nr_ports = ARRAY_SIZE(omap_uart);
+	else
+		nr_ports = 3;
 
 	for (i = 0; i < nr_ports; i++)
 		omap_serial_init_port(i);
-- 
1.7.0.4

