From 50c23d3c9d91251c06f8230fed672d4189bad037 Mon Sep 17 00:00:00 2001
From: Russell King <rmk+kernel@arm.linux.org.uk>
Date: Sat, 8 Oct 2011 14:03:22 +0800
Subject: [PATCH] ARM: AMBA: Add pclk definition for platforms using primecells

upstream: 3126c7bc

Add a dummy clk definition for the APB pclk signal on all platforms
using the AMBA bus infrastructure.  This ensures that these platforms
continue to work when the core amba bus code controls the APB pclk.

Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>

[Only picked mach-versatile changes from the original commit.]

Integrated-by: Hui Wang <Hui.Wang@windriver.com>
---
 arch/arm/mach-versatile/core.c |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-versatile/core.c b/arch/arm/mach-versatile/core.c
index 3b1a4ee..bb309ac 100644
--- a/arch/arm/mach-versatile/core.c
+++ b/arch/arm/mach-versatile/core.c
@@ -416,8 +416,13 @@ static struct clk ref24_clk = {
 	.rate	= 24000000,
 };
 
+static struct clk dummy_apb_pclk;
+
 static struct clk_lookup lookups[] = {
-	{	/* UART0 */
+	{       /* AMBA bus clock */
+		.con_id         = "apb_pclk",
+		.clk            = &dummy_apb_pclk,
+	}, {    /* UART0 */
 		.dev_id		= "dev:f1",
 		.clk		= &ref24_clk,
 	}, {	/* UART1 */
-- 
1.7.0.4

