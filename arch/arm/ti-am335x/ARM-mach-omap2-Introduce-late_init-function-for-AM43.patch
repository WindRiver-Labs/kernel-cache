From cf3ca9a896b14db3b6c4517a928a288017bcc81c Mon Sep 17 00:00:00 2001
From: Keerthy <j-keerthy@ti.com>
Date: Wed, 6 Nov 2013 15:52:50 +0530
Subject: [PATCH 0656/1115] ARM: mach-omap2: Introduce late_init function for
 AM43x

Introduce late_init function for AM43x.

Signed-off-by: Keerthy <j-keerthy@ti.com>
(cherry picked from commit e455c636ddfc760eea84e736e0b974d3d6328621)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-omap2/board-generic.c |    1 +
 arch/arm/mach-omap2/common.h        |    1 +
 arch/arm/mach-omap2/io.c            |    5 +++++
 3 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-omap2/board-generic.c b/arch/arm/mach-omap2/board-generic.c
index e5218c7..519f635 100644
--- a/arch/arm/mach-omap2/board-generic.c
+++ b/arch/arm/mach-omap2/board-generic.c
@@ -227,6 +227,7 @@ DT_MACHINE_START(AM43_DT, "Generic AM43 (Flattened Device Tree)")
 	.reserve	= am33xx_reserve,
 	.map_io		= am33xx_map_io,
 	.init_early	= am43xx_init_early,
+	.init_late	= am43xx_init_late,
 	.init_irq	= omap_gic_of_init,
 	.init_machine	= omap_generic_init,
 	.init_time	= omap3_sync32k_timer_init,
diff --git a/arch/arm/mach-omap2/common.h b/arch/arm/mach-omap2/common.h
index c94ea40..6ef1409 100644
--- a/arch/arm/mach-omap2/common.h
+++ b/arch/arm/mach-omap2/common.h
@@ -106,6 +106,7 @@ void am35xx_init_early(void);
 void ti81xx_init_early(void);
 void am33xx_init_early(void);
 void am43xx_init_early(void);
+void am43xx_init_late(void);
 void omap4430_init_early(void);
 void omap5_init_early(void);
 void omap3_init_late(void);	/* Do not use this one */
diff --git a/arch/arm/mach-omap2/io.c b/arch/arm/mach-omap2/io.c
index 9e3ac19..9532909 100644
--- a/arch/arm/mach-omap2/io.c
+++ b/arch/arm/mach-omap2/io.c
@@ -624,6 +624,11 @@ void __init am43xx_init_early(void)
 	omap_hwmod_init_postsetup();
 	omap_clk_init = am43xx_clk_init;
 }
+
+void __init am43xx_init_late(void)
+{
+	omap2_common_pm_late_init();
+}
 #endif
 
 #ifdef CONFIG_ARCH_OMAP4
-- 
1.7.5.4

