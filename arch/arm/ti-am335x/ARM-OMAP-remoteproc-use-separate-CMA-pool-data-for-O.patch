From 1a9ed8e04c5cdfe6c38beb2257735b7da7f3a1d4 Mon Sep 17 00:00:00 2001
From: Suman Anna <s-anna@ti.com>
Date: Fri, 15 Feb 2013 17:38:02 -0600
Subject: [PATCH 0694/1115] ARM: OMAP: remoteproc: use separate CMA pool data
 for OMAP5

OMAP5 has to support a larger memory footprint on IPU compared to
OMAP4. Adjust the CMA addresses and sizes for OMAP5 by defining new
SoC pertinent macros. The SoC detection logic is already supported
by means of the SoC-specific identifier passed from the corresponding
board reserve functions.

Signed-off-by: Suman Anna <s-anna@ti.com>
(cherry picked from commit 77f9b49aa41e1d5850cbf7b06c7b9632033ba2fb)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-omap2/remoteproc.c |   23 ++++++++++++++---------
 1 files changed, 14 insertions(+), 9 deletions(-)

diff --git a/arch/arm/mach-omap2/remoteproc.c b/arch/arm/mach-omap2/remoteproc.c
index d4e1329..15f4d4b 100644
--- a/arch/arm/mach-omap2/remoteproc.c
+++ b/arch/arm/mach-omap2/remoteproc.c
@@ -61,11 +61,16 @@ struct omap_rproc_pdev_data {
  * XXX: Adjust these values depending on your firmware needs.
  * Placing these in Kconfig is not worth the complexity.
  */
-#define OMAP_RPROC_CMA_BASE_IPU		(0x99000000)
-#define OMAP_RPROC_CMA_BASE_DSP		(0x98800000)
+#define OMAP5_RPROC_CMA_BASE_IPU	(0x95800000)
+#define OMAP5_RPROC_CMA_BASE_DSP	(0x95000000)
+
+#define OMAP4_RPROC_CMA_BASE_IPU	(0x99000000)
+#define OMAP4_RPROC_CMA_BASE_DSP	(0x98800000)
 
 #define OMAP_RPROC_CMA_SIZE_DSP		(0x800000)
-#define OMAP_RPROC_CMA_SIZE_IPU		(0x7000000)
+
+#define OMAP4_RPROC_CMA_SIZE_IPU	(0x7000000)
+#define OMAP5_RPROC_CMA_SIZE_IPU	(0xA400000)
 
 /*
  * These data structures define the desired timers that would
@@ -144,7 +149,7 @@ static struct omap_rproc_pdev_data omap4_rproc_pdev_data[] = {
 		.enabled = 1,
 #endif
 		.pdev = &omap4_dsp,
-		.cma_addr = OMAP_RPROC_CMA_BASE_DSP,
+		.cma_addr = OMAP4_RPROC_CMA_BASE_DSP,
 		.cma_size = OMAP_RPROC_CMA_SIZE_DSP,
 	},
 	{
@@ -152,8 +157,8 @@ static struct omap_rproc_pdev_data omap4_rproc_pdev_data[] = {
 		.enabled = 1,
 #endif
 		.pdev = &omap4_ipu,
-		.cma_addr = OMAP_RPROC_CMA_BASE_IPU,
-		.cma_size = OMAP_RPROC_CMA_SIZE_IPU,
+		.cma_addr = OMAP4_RPROC_CMA_BASE_IPU,
+		.cma_size = OMAP4_RPROC_CMA_SIZE_IPU,
 	},
 };
 
@@ -163,7 +168,7 @@ static struct omap_rproc_pdev_data omap5_rproc_pdev_data[] = {
 		.enabled = 1,
 #endif
 		.pdev = &omap4_dsp,
-		.cma_addr = OMAP_RPROC_CMA_BASE_DSP,
+		.cma_addr = OMAP5_RPROC_CMA_BASE_DSP,
 		.cma_size = OMAP_RPROC_CMA_SIZE_DSP,
 	},
 	{
@@ -171,8 +176,8 @@ static struct omap_rproc_pdev_data omap5_rproc_pdev_data[] = {
 		.enabled = 1,
 #endif
 		.pdev = &omap4_ipu,
-		.cma_addr = OMAP_RPROC_CMA_BASE_IPU,
-		.cma_size = OMAP_RPROC_CMA_SIZE_IPU,
+		.cma_addr = OMAP5_RPROC_CMA_BASE_IPU,
+		.cma_size = OMAP5_RPROC_CMA_SIZE_IPU,
 	},
 };
 
-- 
1.7.5.4

