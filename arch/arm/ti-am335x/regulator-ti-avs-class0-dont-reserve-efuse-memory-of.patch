From 307fb62012af28a06e9b72058bff7fa17a28289f Mon Sep 17 00:00:00 2001
From: Nishanth Menon <nm@ti.com>
Date: Tue, 30 Apr 2013 14:48:47 -0500
Subject: [PATCH 0943/1115] regulator: ti-avs-class0: dont reserve efuse
 memory offsets

devm_request_and_ioremap reserves the efuse offsets for AVS class0,
However, these efuse offsets might be used by other drivers for
information from the same efuse offset ranges as well. hence just
remap the range with devm_ioremap_nocache and read the required data
out.

Signed-off-by: Nishanth Menon <nm@ti.com>
Signed-off-by: Keerthy <j-keerthy@ti.com>
(cherry picked from commit 0bda6795b684deb4aa4de045ce1e0148f72ef3a1)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/regulator/ti-avs-class0-regulator.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/regulator/ti-avs-class0-regulator.c b/drivers/regulator/ti-avs-class0-regulator.c
index e64ac29..2df4fa6 100644
--- a/drivers/regulator/ti-avs-class0-regulator.c
+++ b/drivers/regulator/ti-avs-class0-regulator.c
@@ -218,7 +218,7 @@ static int tiavs_class0_probe(struct platform_device *pdev)
 		return -ENODEV;
 	}
 
-	base = devm_request_and_ioremap(&pdev->dev, res);
+	base = devm_ioremap_nocache(&pdev->dev, res->start, resource_size(res));
 	if (!base) {
 		dev_err(&pdev->dev, "Unable to map Efuse registers\n");
 		return -ENOMEM;
-- 
1.7.5.4

