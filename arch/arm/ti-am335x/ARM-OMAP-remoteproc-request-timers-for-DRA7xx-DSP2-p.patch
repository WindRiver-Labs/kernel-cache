From 2aeb319b659b382cf0dee9db86849e633e53ce22 Mon Sep 17 00:00:00 2001
From: Suman Anna <s-anna@ti.com>
Date: Fri, 6 Dec 2013 11:55:25 -0600
Subject: [PATCH 0701/1115] ARM: OMAP: remoteproc: request timers for DRA7xx
 DSP2 processor

The GPTimer #6 is chosen as the BIOS tick source for the DRA7xx
DSP2 processor, so add this timer data to be able to successfully
boot and run a DSP2 image configured with this timer.

The timers are optional, but are mandatory to support device
management features such as power management and watchdog support.
The timer value also needs to be unique from the ones used by
other processors so that they can be run simultaneously.

Signed-off-by: Suman Anna <s-anna@ti.com>
(cherry picked from commit 1238e3eaa67e93acde38e9686086e93b0b5fb3a3)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-omap2/remoteproc.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-omap2/remoteproc.c b/arch/arm/mach-omap2/remoteproc.c
index ce0d283..9ab8ba6 100644
--- a/arch/arm/mach-omap2/remoteproc.c
+++ b/arch/arm/mach-omap2/remoteproc.c
@@ -101,6 +101,10 @@ static struct omap_rproc_timers_info ipu1_timers[] = {
 	{ .name = "timer11", },
 };
 
+static struct omap_rproc_timers_info dsp2_timers[] = {
+	{ .name = "timer6", },
+};
+
 /*
  * These data structures define platform-specific information
  * needed for each supported remote processor.
@@ -148,6 +152,8 @@ static struct omap_rproc_pdata dra7_rproc_data[] = {
 		.firmware	= "dra7-dsp2-fw.xe66",
 		.mbox_name	= "mbox-dsp2",
 		.oh_name	= "dsp2",
+		.timers		= dsp2_timers,
+		.timers_cnt	= ARRAY_SIZE(dsp2_timers),
 		.set_bootaddr	= dra7_ctrl_write_dsp2_boot_addr,
 	},
 	{
-- 
1.7.5.4

