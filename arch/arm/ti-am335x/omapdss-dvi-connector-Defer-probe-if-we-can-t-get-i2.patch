From d22a21115fb8df49c89e2285ae04b66b463ffc2e Mon Sep 17 00:00:00 2001
From: Archit Taneja <archit@ti.com>
Date: Mon, 23 Sep 2013 11:58:14 +0530
Subject: [PATCH 0533/1115] omapdss: dvi connector: Defer probe if we can't
 get i2c adapter

The dvi connector can't probe successfully if it doesn't get the i2c adpater.
The omap i2c devices may probe later if they defer themselves because of
missing pinumx data. This could result in the dvi panel driver probing before
i2c is initialized.

Defer probe if dvi can't find it's i2c adapter instead of bailing out.

Signed-off-by: Archit Taneja <archit@ti.com>
(cherry picked from commit 6bc0688cf77eb04ce0f897297d2e44220dd59811)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/video/omap2/displays-new/connector-dvi.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/video/omap2/displays-new/connector-dvi.c b/drivers/video/omap2/displays-new/connector-dvi.c
index 1f53a32..d6325fa 100644
--- a/drivers/video/omap2/displays-new/connector-dvi.c
+++ b/drivers/video/omap2/displays-new/connector-dvi.c
@@ -301,7 +301,7 @@ static int dvic_probe_of(struct platform_device *pdev)
 		adapter = of_find_i2c_adapter_by_node(adapter_node);
 		if (adapter == NULL) {
 			dev_err(&pdev->dev, "failed to parse i2c-bus\n");
-			return -EINVAL;
+			return -EPROBE_DEFER;
 		}
 
 		ddata->i2c_adapter = adapter;
-- 
1.7.5.4

