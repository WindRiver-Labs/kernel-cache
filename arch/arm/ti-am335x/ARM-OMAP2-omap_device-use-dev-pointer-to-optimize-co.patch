From b1c3d676b29c41cde81cf168f7f46f0cf0abe325 Mon Sep 17 00:00:00 2001
From: Nishanth Menon <nm@ti.com>
Date: Tue, 13 Aug 2013 14:02:07 -0500
Subject: [PATCH 0325/1115] ARM: OMAP2+: omap_device: use dev pointer to
 optimize code

_add_clkdev uses &od->pdev->dev for all reference of device struct.

Simplify the usage with a variable.

Signed-off-by: Nishanth Menon <nm@ti.com>
Signed-off-by: Tero Kristo <t-kristo@ti.com>
(cherry picked from commit bcbded3e866c90e7c72593e49df2cdda78bfa107)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-omap2/omap_device.c |   16 +++++++---------
 1 files changed, 7 insertions(+), 9 deletions(-)

diff --git a/arch/arm/mach-omap2/omap_device.c b/arch/arm/mach-omap2/omap_device.c
index 9ee2b4c..15ba474 100644
--- a/arch/arm/mach-omap2/omap_device.c
+++ b/arch/arm/mach-omap2/omap_device.c
@@ -47,31 +47,29 @@ static void _add_clkdev(struct omap_device *od, const char *clk_alias,
 {
 	struct clk *r;
 	struct clk_lookup *l;
+	struct device *dev = &od->pdev->dev;
 
 	if (!clk_alias || !clk_name)
 		return;
 
-	dev_dbg(&od->pdev->dev, "Creating %s -> %s\n", clk_alias, clk_name);
+	dev_dbg(dev, "Creating %s -> %s\n", clk_alias, clk_name);
 
-	r = clk_get_sys(dev_name(&od->pdev->dev), clk_alias);
+	r = clk_get_sys(dev_name(dev), clk_alias);
 	if (!IS_ERR(r)) {
-		dev_warn(&od->pdev->dev,
-			 "alias %s already exists\n", clk_alias);
+		dev_warn(dev, "alias %s already exists\n", clk_alias);
 		clk_put(r);
 		return;
 	}
 
 	r = clk_get(NULL, clk_name);
 	if (IS_ERR(r)) {
-		dev_err(&od->pdev->dev,
-			"clk_get for %s failed\n", clk_name);
+		dev_err(dev, "clk_get for %s failed\n", clk_name);
 		return;
 	}
 
-	l = clkdev_alloc(r, clk_alias, dev_name(&od->pdev->dev));
+	l = clkdev_alloc(r, clk_alias, dev_name(dev));
 	if (!l) {
-		dev_err(&od->pdev->dev,
-			"clkdev_alloc for %s failed\n", clk_alias);
+		dev_err(dev, "clkdev_alloc for %s failed\n", clk_alias);
 		return;
 	}
 
-- 
1.7.5.4

