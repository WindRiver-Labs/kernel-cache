From 460f572de6cff3cd0add1d65b008fe8d0394394f Mon Sep 17 00:00:00 2001
From: Peter Ujfalusi <peter.ujfalusi@ti.com>
Date: Thu, 7 Nov 2013 11:16:52 +0200
Subject: [PATCH 0642/1115] ARM: OMAP2+: hwmod: Correct oh->opt_clks_cnt in
 case of DT boot

The oh->opt_clks_cnt should not be incremented within the loop since we
already assigned the correct number of opt_clks prior to the loop.
We ended up with incorrect number in the oh->opt_clks_cnt (double of the
real opt_clks).

Signed-off-by: Peter Ujfalusi <peter.ujfalusi@ti.com>
(cherry picked from commit 874971ccff3717ca6df367b5f4c8450dead921be)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-omap2/omap_hwmod.c |    1 -
 1 files changed, 0 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-omap2/omap_hwmod.c b/arch/arm/mach-omap2/omap_hwmod.c
index 6331258..5c46de9 100644
--- a/arch/arm/mach-omap2/omap_hwmod.c
+++ b/arch/arm/mach-omap2/omap_hwmod.c
@@ -863,7 +863,6 @@ static int _init_opt_clks_dt(struct omap_hwmod *oh, struct device_node *np)
 		}
 		oh->opt_clks[i]._clk = c;
 		oh->opt_clks[i].role = opt_clk_names[i];
-		oh->opt_clks_cnt++;
 		clk_prepare(oh->opt_clks[i]._clk);
 	}
 	return ret;
-- 
1.7.5.4

