From b0769ff41ce30474a498dfd016b7426a3aa1f09a Mon Sep 17 00:00:00 2001
From: Suman Anna <s-anna@ti.com>
Date: Tue, 17 Dec 2013 17:14:54 -0600
Subject: [PATCH 0722/1115] ARM: OMAP: remoteproc: adjust the CMA pool
 addresses for OMAP4

The CMA pool addresses for OMAP4 have been shifted down by 8MB to
avoid the CMA reservation failure for IPU when the fdt_high relocation
is enabled in u-boot. Any fdt_high value other than 0xFFFFFFFF causes
the DT blob to occupy memory just before the chosen fdt_high. This
shift causes the CMA pools to end at 0x99800000 instead of the previous
0xA0000000, and works well with the chosen fdt_high value of 0xA0000000
in ti-u-boot.

NOTE: This requires the BIOS-side images to use matching addresses
in the resource table, so older images with different resource tables
may not boot after this change.

Signed-off-by: Suman Anna <s-anna@ti.com>
(cherry picked from commit 18e8088be361a33ed4c7534e126b0f3e8479b0b1)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/mach-omap2/remoteproc.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/arm/mach-omap2/remoteproc.c b/arch/arm/mach-omap2/remoteproc.c
index 497c776..1cb2b4b 100644
--- a/arch/arm/mach-omap2/remoteproc.c
+++ b/arch/arm/mach-omap2/remoteproc.c
@@ -73,8 +73,8 @@ static void dra7_ctrl_write_dsp2_boot_addr(u32 bootaddr);
 #define OMAP5_RPROC_CMA_BASE_IPU	(0x95800000)
 #define OMAP5_RPROC_CMA_BASE_DSP	(0x95000000)
 
-#define OMAP4_RPROC_CMA_BASE_IPU	(0x99000000)
-#define OMAP4_RPROC_CMA_BASE_DSP	(0x98800000)
+#define OMAP4_RPROC_CMA_BASE_IPU	(0x98800000)
+#define OMAP4_RPROC_CMA_BASE_DSP	(0x98000000)
 
 #define OMAP_RPROC_CMA_SIZE_DSP		(0x800000)
 #define DRA7_RPROC_CMA_SIZE_DSP1	(0x4000000)
-- 
1.7.5.4

