From f2fc002daf2824dd51f7294d220b1a7183ce2e56 Mon Sep 17 00:00:00 2001
From: Rajendra Nayak <rnayak@ti.com>
Date: Tue, 8 Oct 2013 16:53:26 +0530
Subject: [PATCH 0622/1115] ARM: OMAP2+: Disable ARCH_MULTIPLATFORM and enable
 erratum I688

Erratum I688 is critical for all OMAP4+ devices (OMAP4, OMAP5 and
DRA7) and enabling it requires MULTIPLATFORM to be disabled across
OMAPs.

Signed-off-by: Rajendra Nayak <rnayak@ti.com>
(cherry picked from commit 57a1a4b6e5400bdc6166aac98c6136d964f5c092)

Conflicts:
	arch/arm/Kconfig.debug
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/arm/Kconfig            |   25 ++++++++++++++++++++++++-
 arch/arm/Kconfig.debug      |    2 +-
 arch/arm/mach-omap2/Kconfig |   23 -----------------------
 3 files changed, 25 insertions(+), 25 deletions(-)

diff --git a/arch/arm/Kconfig b/arch/arm/Kconfig
index 67470ae..bf67f50 100644
--- a/arch/arm/Kconfig
+++ b/arch/arm/Kconfig
@@ -887,10 +887,33 @@ config ARCH_OMAP1
 	help
 	  Support for older TI OMAP1 (omap7xx, omap15xx or omap16xx)
 
+config ARCH_OMAP2PLUS
+	bool "TI OMAP2+"
+	depends on MMU
+	select ARCH_HAS_BANDGAP
+	select ARCH_HAS_CPUFREQ
+	select ARCH_HAS_HOLES_MEMORYMODEL
+	select ARCH_OMAP
+	select ARCH_REQUIRE_GPIOLIB
+	select CLKDEV_LOOKUP
+	select CLKSRC_MMIO
+	select GENERIC_CLOCKEVENTS
+	select GENERIC_IRQ_CHIP
+	select HAVE_CLK
+	select OMAP_DM_TIMER
+	select PINCTRL
+	select PROC_DEVICETREE if PROC_FS
+	select SOC_BUS
+	select SPARSE_IRQ
+	select TI_PRIV_EDMA
+	select USE_OF
+	select AUTO_ZRELADDR
+	help
+	  SUpport for OMAP2, OMAP3, OMAP4 and OMAP5
+
 endchoice
 
 menu "Multiple platform selection"
-	depends on ARCH_MULTIPLATFORM
 
 comment "CPU Core family selection"
 
diff --git a/arch/arm/Kconfig.debug b/arch/arm/Kconfig.debug
index fc6582c..4426bc9 100644
--- a/arch/arm/Kconfig.debug
+++ b/arch/arm/Kconfig.debug
@@ -686,7 +686,7 @@ config DEBUG_UNCOMPRESS
 
 config UNCOMPRESS_INCLUDE
 	string
-	default "debug/uncompress.h" if ARCH_MULTIPLATFORM
+	default "debug/uncompress.h" if ARCH_MULTIPLATFORM || ARCH_OMAP
 	default "mach/uncompress.h"
 
 config EARLY_PRINTK
diff --git a/arch/arm/mach-omap2/Kconfig b/arch/arm/mach-omap2/Kconfig
index adb5753..8234aa3 100644
--- a/arch/arm/mach-omap2/Kconfig
+++ b/arch/arm/mach-omap2/Kconfig
@@ -90,29 +90,6 @@ config SOC_AM43XX
 	select ARCH_HAS_RESET_CONTROLLER
 	select RESET_TI
 
-config ARCH_OMAP2PLUS
-	bool
-	select ARCH_HAS_BANDGAP
-	select ARCH_HAS_CPUFREQ
-	select ARCH_HAS_HOLES_MEMORYMODEL
-	select ARCH_OMAP
-	select ARCH_REQUIRE_GPIOLIB
-	select CLKDEV_LOOKUP
-	select CLKSRC_MMIO
-	select GENERIC_CLOCKEVENTS
-	select GENERIC_IRQ_CHIP
-	select HAVE_CLK
-	select OMAP_DM_TIMER
-	select PINCTRL
-	select PROC_DEVICETREE if PROC_FS
-	select SOC_BUS
-	select SPARSE_IRQ
-	select TI_PRIV_EDMA
-	select USE_OF
-	help
-	  Systems based on OMAP2, OMAP3, OMAP4 or OMAP5
-
-
 if ARCH_OMAP2PLUS
 
 menu "TI OMAP2/3/4 Specific Features"
-- 
1.7.5.4

