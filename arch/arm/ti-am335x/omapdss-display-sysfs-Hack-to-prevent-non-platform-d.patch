From ac0309cf58d31c7fcc8cda312b96c76a077a9521 Mon Sep 17 00:00:00 2001
From: Archit Taneja <archit@ti.com>
Date: Wed, 25 Sep 2013 19:08:17 +0530
Subject: [PATCH 0545/1115] omapdss: display sysfs: Hack to prevent
 non-platform-device based panels sysfs breaks

Panels based on i2c/spi etc devices will create a sysfs entry using the dev's
kobject. When we register the panel's omapdss device with the i2c/spi client's
device, we try to add a sysfs entry in display_init_sysfs() using the same
kobkect.

This leads to sysfs api returning an error, add a hack to make sure 'name'
attribute doesn't conflict.

Signed-off-by: Archit Taneja <archit@ti.com>
(cherry picked from commit b6902edd6fcec902055c61fa858f4f035c770fc5)
Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 drivers/video/omap2/dss/display-sysfs.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/video/omap2/dss/display-sysfs.c b/drivers/video/omap2/dss/display-sysfs.c
index 21d7f77..eedb271 100644
--- a/drivers/video/omap2/dss/display-sysfs.c
+++ b/drivers/video/omap2/dss/display-sysfs.c
@@ -277,7 +277,7 @@ static ssize_t display_wss_store(struct device *dev,
 	return size;
 }
 
-static DEVICE_ATTR(name, S_IRUGO, display_name_show, NULL);
+static DEVICE_ATTR(disp_name, S_IRUGO, display_name_show, NULL);
 static DEVICE_ATTR(enabled, S_IRUGO|S_IWUSR,
 		display_enabled_show, display_enabled_store);
 static DEVICE_ATTR(tear_elim, S_IRUGO|S_IWUSR,
@@ -292,7 +292,7 @@ static DEVICE_ATTR(wss, S_IRUGO|S_IWUSR,
 		display_wss_show, display_wss_store);
 
 static const struct attribute *display_sysfs_attrs[] = {
-	&dev_attr_name.attr,
+	&dev_attr_disp_name.attr,
 	&dev_attr_enabled.attr,
 	&dev_attr_tear_elim.attr,
 	&dev_attr_timings.attr,
-- 
1.7.5.4

