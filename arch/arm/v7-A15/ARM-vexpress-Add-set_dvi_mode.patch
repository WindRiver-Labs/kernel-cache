From 1dc1e7df7eb1db6d0be521f3afa96abb703915c1 Mon Sep 17 00:00:00 2001
From: Guoqing Jiang <Guoqing.Jiang@windriver.com>
Date: Mon, 22 Oct 2012 15:42:08 +0800
Subject: [PATCH 09/28] ARM: vexpress: Add set_dvi_mode()

Commit a527e39b6faa8d5692568393bb7f43704cb3cf9f from
git://git.linaro.org/kernel/linux-linaro-tracking.git

The HDMI transmitter on the motherboard needs configuring for
different display modes. This function provides a methods for
display drivers to use to set this.

Signed-off-by: Jon Medhurst <tixy@linaro.org>
[with context adjust]
Signed-off-by: Guoqing Jiang <Guoqing.Jiang@windriver.com>
---
 arch/arm/mach-vexpress/v2m.c |   14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/arch/arm/mach-vexpress/v2m.c b/arch/arm/mach-vexpress/v2m.c
index 9694e3e..7d8b883 100644
--- a/arch/arm/mach-vexpress/v2m.c
+++ b/arch/arm/mach-vexpress/v2m.c
@@ -494,6 +494,20 @@ MACHINE_START(VEXPRESS, "ARM-Versatile Express")
 	.restart	= v2m_restart,
 MACHINE_END
 
+int set_dvi_mode(int mode)
+{
+	/* mode is a value from:
+	0 = VGA
+	1 = SVGA
+	2 = XGA
+	3 = SXGA
+	4 = UXGA
+	5 = WUXGA
+	*/
+	v2m_cfg_write(SYS_CFG_DVIMODE, mode);
+	return 0;
+}
+
 #if defined(CONFIG_ARCH_VEXPRESS_DT)
 
 static struct map_desc v2m_rs1_io_desc __initdata = {
-- 
1.7.9.7

