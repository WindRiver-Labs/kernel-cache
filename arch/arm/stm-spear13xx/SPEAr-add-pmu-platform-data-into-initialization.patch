From 7d0181c0477d7a73d794afcff14b82e4f72ff854 Mon Sep 17 00:00:00 2001
From: Liming Wang <liming.wang@windriver.com>
Date: Thu, 19 Jul 2012 12:14:13 +0800
Subject: [PATCH 27/28] SPEAr: add pmu platform data into initialization

Oprofile needs pmu to collect data, so add pmu platform data
to ensure pmu initialization when the kernel boots.

Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 arch/arm/mach-spear13xx/spear1310_evb.c      |    1 +
 arch/arm/mach-spear13xx/spear1310_reva_evb.c |    1 +
 arch/arm/mach-spear13xx/spear1340_evb.c      |    1 +
 3 files changed, 3 insertions(+)

diff --git a/arch/arm/mach-spear13xx/spear1310_evb.c b/arch/arm/mach-spear13xx/spear1310_evb.c
index 5bbe500..836e323 100644
--- a/arch/arm/mach-spear13xx/spear1310_evb.c
+++ b/arch/arm/mach-spear13xx/spear1310_evb.c
@@ -127,6 +127,7 @@ static struct platform_device *plat_devs[] __initdata = {
 	&spear13xx_smi_device,
 	&spear13xx_thermal_device,
 	&spear13xx_wdt_device,
+	&spear13xx_pmu_device,
 
 	/* spear1310 specific devices */
 	&spear1310_plgpio_device,
diff --git a/arch/arm/mach-spear13xx/spear1310_reva_evb.c b/arch/arm/mach-spear13xx/spear1310_reva_evb.c
index dbabc14..6c80589 100644
--- a/arch/arm/mach-spear13xx/spear1310_reva_evb.c
+++ b/arch/arm/mach-spear13xx/spear1310_reva_evb.c
@@ -224,6 +224,7 @@ static struct platform_device *plat_devs[] __initdata = {
 	&spear13xx_thermal_device,
 	&spear13xx_udc_device,
 	&spear13xx_wdt_device,
+	&spear13xx_pmu_device,
 
 	/* spear1310_reva specific devices */
 	&spear1310_reva_can0_device,
diff --git a/arch/arm/mach-spear13xx/spear1340_evb.c b/arch/arm/mach-spear13xx/spear1340_evb.c
index d6dd786..8c6ba23 100644
--- a/arch/arm/mach-spear13xx/spear1340_evb.c
+++ b/arch/arm/mach-spear13xx/spear1340_evb.c
@@ -278,6 +278,7 @@ static struct platform_device *plat_devs[] __initdata = {
 	&spear13xx_sdhci_device,
 	&spear13xx_smi_device,
 	&spear13xx_wdt_device,
+	&spear13xx_pmu_device,
 
 	/* spear1340 specific devices */
 	&spear1340_camif3_device,
-- 
1.7.9.7

