From 6b2f8e3efff44db2309a39e6d9147c5a8e761f98 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Wed, 8 Jul 2015 14:46:43 +0800
Subject: [PATCH 17/23] arm64:ThunderX:Update Kernel options

Add Kernel options for ThunderX SOC.
Extracted from ThunderX-SDK pre-release 0.4.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 arch/arm64/Kconfig |   28 +++++++++++++++++++++++++---
 1 files changed, 25 insertions(+), 3 deletions(-)

diff --git a/arch/arm64/Kconfig b/arch/arm64/Kconfig
index 23950cc..a4a366f 100644
--- a/arch/arm64/Kconfig
+++ b/arch/arm64/Kconfig
@@ -41,7 +41,7 @@ config ARM64
 	select HAVE_DEBUG_KMEMLEAK
 	select HAVE_DMA_API_DEBUG
 	select HAVE_DMA_ATTRS
-	select HAVE_DMA_CONTIGUOUS
+	select HAVE_DMA_CONTIGUOUS if !ARCH_THUNDER
 	select HAVE_DYNAMIC_FTRACE
 	select HAVE_EFFICIENT_UNALIGNED_ACCESS
 	select HAVE_FTRACE_MCOUNT_RECORD
@@ -140,9 +140,27 @@ config ARCH_THUNDER
 	  This enables support for Cavium's Thunder Family of SoCs.
 	select PCI
 	select PCI_THUNDER
+	select PCI_DOMAINS_GENERIC
 	select SATA_AHCI
-	select SATA_AHCI_PLATFORM
 	select NET_VENDOR_CAVIUM
+	select PHY_LIB
+	select MARVELL_PHY
+	select BROADCOM_PHY
+	select BCM87XX_PHY
+	select MDIO_OCTEON
+	select IOMMU_SUPPORT
+	select ARM_SMMU
+
+menu   "Cavium ThunderX errata"
+
+config THUNDERX_PASS1_ERRATA_23154
+	bool "Cavium ThunderX erratum 23154"
+	depends on ARCH_THUNDER
+	def_bool ARCH_THUNDER
+	help
+	  Enable workaround for erratum 23154.
+
+endmenu
 
 config ARCH_VEXPRESS
 	bool "ARMv8 software model (Versatile Express)"
@@ -186,6 +204,9 @@ source "drivers/pci/Kconfig"
 source "drivers/pci/pcie/Kconfig"
 source "drivers/pci/hotplug/Kconfig"
 
+config PCI_THUNDER
+	depends on PCI && ARCH_THUNDER
+
 endmenu
 
 menu "Kernel Features"
@@ -286,7 +307,7 @@ config NR_CPUS
 	range 2 64
 	depends on SMP
 	# These have to remain sorted largest to smallest
-	default "32" if ARCH_THUNDER
+	default "48" if ARCH_THUNDER
 	default "64"
 
 config HOTPLUG_CPU
@@ -357,6 +378,7 @@ config XEN
 config FORCE_MAX_ZONEORDER
 	int
 	default "14" if (ARM64_64K_PAGES && TRANSPARENT_HUGEPAGE)
+	default "13" if (ARCH_THUNDER && !ARM64_64K_PAGES)
 	default "11"
 
 endmenu
-- 
1.7.5.4

