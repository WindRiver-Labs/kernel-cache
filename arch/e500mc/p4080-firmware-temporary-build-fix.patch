From ab98c44cdebbe660011ca0987a1bd0d52feab59e Mon Sep 17 00:00:00 2001
From: Bruce Ashfield <bruce.ashfield@windriver.com>
Date: Mon, 28 Feb 2011 16:23:46 -0500
Subject: [PATCH] p4080/firmware: temporary build fix

The async BSP removed firmware that is required by the guest OS.
This breaks the build, so we'll remove the references to the
external variables.

This is temporary and will be dropped in the future.

Signed-off-by: Bruce Ashfield <bruce.ashfield@windriver.com>
---
 .../kernel/2.6/wrappers/Peripherals/FM/lnxwrp_fm.c |    7 -------
 1 files changed, 0 insertions(+), 7 deletions(-)

diff --git a/drivers/net/dpa/NetCommSw/user/env/linux/kernel/2.6/wrappers/Peripherals/FM/lnxwrp_fm.c b/drivers/net/dpa/NetCommSw/user/env/linux/kernel/2.6/wrappers/Peripherals/FM/lnxwrp_fm.c
index 6184dc7..3202aa0 100644
--- a/drivers/net/dpa/NetCommSw/user/env/linux/kernel/2.6/wrappers/Peripherals/FM/lnxwrp_fm.c
+++ b/drivers/net/dpa/NetCommSw/user/env/linux/kernel/2.6/wrappers/Peripherals/FM/lnxwrp_fm.c
@@ -1301,9 +1301,6 @@ __setup("fman_ucode=", FmanUcodeAddrParam);
  * If we have an older U-Boot, then we assume that the firmware is located in
  * flash at physical address 'P4080_UCAddr'
  */
-#ifdef	CONFIG_PPC85xx_VT_MODE
-extern struct qe_firmware p4080_fman_firmware;
-#endif
 static const struct qe_firmware *FindFmanMicrocode(void)
 {
     static const struct qe_firmware *P4080_UCPatch;
@@ -1323,9 +1320,6 @@ static const struct qe_firmware *FindFmanMicrocode(void)
 	    else
 		    REPORT_ERROR(WARNING, E_NOT_FOUND, ("firmware node is incomplete"));
     }
-#ifdef	CONFIG_PPC85xx_VT_MODE
-	P4080_UCPatch = &p4080_fman_firmware;
-#else
     /* If not, then we have a legacy U-Boot.  The firmware is in flash. */
 
     /* Only map enough to the get the core structure */
@@ -1334,7 +1328,6 @@ static const struct qe_firmware *FindFmanMicrocode(void)
         REPORT_ERROR(MAJOR, E_NULL_POINTER, ("ioremap(%llx) returned NULL", (u64) P4080_UCAddr));
         return NULL;
     }
-#endif
     /* Make sure it really is a QE Firmware blob */
     hdr = &P4080_UCPatch->header;
     if (!hdr ||
-- 
1.6.5.2

