From 4eb610b25dfc25355ec55c2ee1aecdb3648ed552 Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Thu, 9 Sep 2010 16:38:16 +0800
Subject: [PATCH 181/252] crypto: caam - algapi: correct initial pdb override command content

Patch taken from FSL vendor SDK 2.1.

rev. 2 h/w introduced the ovrd_ecn struct member in commit
"crypto: caam/algapi: rev.2 h/w: add ECN field in DPOVRD
register", but the initialization wasn't updated appropriately.

Since the tunnel mode reduction into transport mode, we always
override the pdb on encrypt, so make this clear.

Signed-off-by: Kim Phillips <kim.phillips@freescale.com>
Integrated-by: Andrew Liu <shengping.liu@windriver.com>
---
 drivers/crypto/caam/algapi.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/crypto/caam/algapi.c b/drivers/crypto/caam/algapi.c
index 1491443..9abbbb0 100644
--- a/drivers/crypto/caam/algapi.c
+++ b/drivers/crypto/caam/algapi.c
@@ -756,7 +756,7 @@ static int ipsec_esp(struct ipsec_esp_edesc *edesc, struct aead_request *areq,
 	int ivsize = crypto_aead_ivsize(aead);
 	dma_addr_t ptr;
 	/* defaults; may be overwritten */
-	struct ipsec_deco_dpovrd dpovrd = { 0, 0, IPPROTO_IPIP};
+	struct ipsec_deco_dpovrd dpovrd = {0, 0, 0, 0};
 
 #ifdef DEBUG
 	debug("assoclen %d cryptlen %d authsize %d\n",
-- 
1.6.5.2

