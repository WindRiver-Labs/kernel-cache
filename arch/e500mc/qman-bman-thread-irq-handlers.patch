From 185a2d541847dbf7f408b4d9044d1c821778b333 Mon Sep 17 00:00:00 2001
From: Weiwei Wang <weiwei.wang@windriver.com>
Date: Tue, 11 Jan 2011 14:00:07 +0800
Subject: [PATCH 19/28] {qman,bman}: thread irq handlers

delete IRQF_NODELAY flag in order to thread bman
and qman irq handlers

Signed-off-by: Weiwei Wang <weiwei.wang@windriver.com>
---
 drivers/hwalloc/bman_high.c |    4 ----
 drivers/hwqueue/qman_high.c |    4 ----
 2 files changed, 0 insertions(+), 8 deletions(-)

diff --git a/drivers/hwalloc/bman_high.c b/drivers/hwalloc/bman_high.c
index 61a31ec..75c844d 100644
--- a/drivers/hwalloc/bman_high.c
+++ b/drivers/hwalloc/bman_high.c
@@ -229,11 +229,7 @@ int bman_create_affine_portal(const struct bm_portal_config *config,
 	bm_isr_status_clear(__p, 0xffffffff);
 #ifdef CONFIG_FSL_BMAN_HAVE_IRQ
 	snprintf(portal->irqname, MAX_IRQNAME, IRQNAME, config->cpu);
-#if defined(CONFIG_PREEMPT_HARDIRQS) || defined(CONFIG_PREEMPT_SOFTIRQS)
-	if (request_irq(config->irq, portal_isr, IRQF_NODELAY, portal->irqname, portal)) {
-#else
 	if (request_irq(config->irq, portal_isr, 0, portal->irqname, portal)) {
-#endif
 		pr_err("request_irq() failed\n");
 		goto fail_irq;
 	}
diff --git a/drivers/hwqueue/qman_high.c b/drivers/hwqueue/qman_high.c
index 68ee41b..27f6f3d 100644
--- a/drivers/hwqueue/qman_high.c
+++ b/drivers/hwqueue/qman_high.c
@@ -387,11 +387,7 @@ int qman_create_affine_portal(const struct qm_portal_config *config, u32 flags,
 	qm_isr_status_clear(__p, 0xffffffff);
 #ifdef CONFIG_FSL_QMAN_HAVE_IRQ
 	snprintf(portal->irqname, MAX_IRQNAME, IRQNAME, config->cpu);
-#if defined(CONFIG_PREEMPT_HARDIRQS) || defined(CONFIG_PREEMPT_SOFTIRQS)
-	if (request_irq(config->irq, portal_isr, IRQF_NODELAY, portal->irqname, portal)) {
-#else
 	if (request_irq(config->irq, portal_isr, 0, portal->irqname, portal)) {
-#endif
 		pr_err("request_irq() failed\n");
 		goto fail_irq;
 	}
-- 
1.6.5.2

