From 1a072f5fb88384f29a26bfe18e94d4a0034930ee Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Fri, 5 Aug 2011 11:34:38 +0800
Subject: [PATCH 3/6] ppc-mc: don't support to boot from core other than 0

Native Linux can boot from core other than 0 but based on the HY
guest OS dosen't support this so guest OS has to initialize
the boot_cpuid to 0 at the first time.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/kernel/head_wrhv_p4080.S |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/kernel/head_wrhv_p4080.S b/arch/powerpc/kernel/head_wrhv_p4080.S
index 9772733..6041784 100644
--- a/arch/powerpc/kernel/head_wrhv_p4080.S
+++ b/arch/powerpc/kernel/head_wrhv_p4080.S
@@ -136,6 +136,10 @@ _ENTRY(__early_start)
 	lwz	r24, WRHV_COREID_OFFSET(r24)
 	cmpwi	r24,0
 	bne	__secondary_start
+	li	r4, 0
+	lis	r3, boot_cpuid@h
+	ori	r3, r3, boot_cpuid@l
+	stw	r4, 0(r3)
 #endif
 
 	/*
-- 
1.7.0.4

