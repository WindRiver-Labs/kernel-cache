From 4a4663a37d0764016373634b1ad92f28c74ba91c Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Thu, 9 Sep 2010 16:27:42 +0800
Subject: [PATCH 179/252] crypto: caam - algapi: add support for 3des-sha1 combined cipher

Patch taken from FSL vendor SDK 2.1.

IPSec ESP RFCs require this algorithm variant.

Signed-off-by: Kim Phillips <kim.phillips@freescale.com>
Integrated-by: Andrew Liu <shengping.liu@windriver.com>
---
 drivers/crypto/caam/algapi.c |   17 +++++++++++++++++
 1 files changed, 17 insertions(+), 0 deletions(-)

diff --git a/drivers/crypto/caam/algapi.c b/drivers/crypto/caam/algapi.c
index 4b84fc1..be9a44a 100644
--- a/drivers/crypto/caam/algapi.c
+++ b/drivers/crypto/caam/algapi.c
@@ -1184,6 +1184,23 @@ static struct caam_alg_template driver_algs[] = {
 		.class2_alg_type = AUTH_TYPE_IPSEC_SHA1HMAC_96,
 	},
 	{
+		.name = "authenc(hmac(sha1),cbc(3des))",
+		.driver_name = "authenc-hmac-sha1-cbc-3des-caam",
+		.blocksize = DES3_EDE_BLOCK_SIZE,
+		.aead = {
+			.setkey = aead_authenc_setkey,
+			.setauthsize = aead_authenc_setauthsize,
+			.encrypt = aead_authenc_encrypt_first,
+			.decrypt = aead_authenc_decrypt_first,
+			.givencrypt = aead_authenc_givencrypt_first,
+			.geniv = "<built-in>",
+			.ivsize = DES3_EDE_BLOCK_SIZE,
+			.maxauthsize = SHA1_DIGEST_SIZE,
+			},
+		.class1_alg_type = CIPHER_TYPE_IPSEC_3DESCBC,
+		.class2_alg_type = AUTH_TYPE_IPSEC_SHA1HMAC_96,
+	},
+	{
 		.name = "authenc(hmac(sha1),cbc(des))",
 		.driver_name = "authenc-hmac-sha1-cbc-des-caam",
 		.blocksize = DES_BLOCK_SIZE,
-- 
1.6.5.2

