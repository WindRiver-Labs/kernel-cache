From 6646dd92263e9d3a2f39307baaf143bf7a250619 Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Fri, 5 Aug 2011 12:35:53 +0800
Subject: [PATCH 5/6]  ppc-mc/dpaa: skip destrying qman fq even initialize failed

When run multiple geust OS we have to skip this since guest OS would
initialize failed some shared qman resource.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 drivers/net/dpa/dpaa_eth.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/net/dpa/dpaa_eth.c b/drivers/net/dpa/dpaa_eth.c
index a2aab2a..6802b9d 100644
--- a/drivers/net/dpa/dpaa_eth.c
+++ b/drivers/net/dpa/dpaa_eth.c
@@ -484,7 +484,7 @@ _dpa_fq_alloc(struct list_head *list, struct dpa_fq *dpa_fq)
 		};
 
 		_errno = qman_init_fq(fq, QMAN_INITFQ_FLAG_SCHED, &initfq);
-#ifndef CONFIG_CRASH_DUMP
+#if !defined(CONFIG_CRASH_DUMP) && !defined(CONFIG_WRHV)
 		if (_errno < 0) {
 			dpaa_eth_err(dev, "qman_init_fq(%u) = %d\n",
 					qman_fq_fqid(fq), _errno);
-- 
1.7.0.4

