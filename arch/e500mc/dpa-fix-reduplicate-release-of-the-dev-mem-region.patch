From 8d35c66eb1a1794f16bb830ac2c6d69c8409a08b Mon Sep 17 00:00:00 2001
From: Weiwei Wang <weiwei.wang@windriver.com>
Date: Wed, 29 Jun 2011 12:39:48 +0800
Subject: [PATCH 197/233] dpa: fix reduplicate release of the dev mem region

The dev mem region has already been released in devm_iounmap.
So additional __devm_release_region/release_mem_region are
not needed. Just remove them.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
Signed-off-by: Weiwei Wang <weiwei.wang@windriver.com>
---
 .../src/wrappers/Peripherals/FM/lnxwrp_fm.c        |    5 -----
 1 files changed, 0 insertions(+), 5 deletions(-)

diff --git a/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/lnxwrp_fm.c b/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/lnxwrp_fm.c
index 520b255..52be651 100644
--- a/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/lnxwrp_fm.c
+++ b/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/lnxwrp_fm.c
@@ -2371,15 +2371,11 @@ static void FreeFmDev(t_LnxWrpFmDev  *p_LnxWrpFmDev)
     {
         SYS_UnregisterIoMap(p_LnxWrpFmDev->fmRtcBaseAddr);
         devm_iounmap(p_LnxWrpFmDev->dev, UINT_TO_PTR(p_LnxWrpFmDev->fmRtcBaseAddr));
-        __devm_release_region(p_LnxWrpFmDev->dev, p_LnxWrpFmDev->res, p_LnxWrpFmDev->fmRtcBaseAddr, p_LnxWrpFmDev->fmRtcMemSize);
     }
     SYS_UnregisterIoMap(p_LnxWrpFmDev->fmMuramBaseAddr);
     devm_iounmap(p_LnxWrpFmDev->dev, UINT_TO_PTR(p_LnxWrpFmDev->fmMuramBaseAddr));
-    __devm_release_region(p_LnxWrpFmDev->dev, p_LnxWrpFmDev->res, p_LnxWrpFmDev->fmMuramBaseAddr, p_LnxWrpFmDev->fmMuramMemSize);
     SYS_UnregisterIoMap(p_LnxWrpFmDev->fmBaseAddr);
     devm_iounmap(p_LnxWrpFmDev->dev, UINT_TO_PTR(p_LnxWrpFmDev->fmBaseAddr));
-    release_mem_region(p_LnxWrpFmDev->fmBaseAddr, p_LnxWrpFmDev->fmMemSize);
-//    devm_release_mem_region(p_LnxWrpFmDev->dev, p_LnxWrpFmDev->fmBaseAddr, p_LnxWrpFmDev->fmMemSize);
 }
 
 static void FreeFmPortDev(t_LnxWrpFmPortDev *p_LnxWrpFmPortDev)
@@ -2392,7 +2388,6 @@ static void FreeFmPortDev(t_LnxWrpFmPortDev *p_LnxWrpFmPortDev)
     if (p_LnxWrpFmPortDev->h_Dev)
         FM_PORT_Free(p_LnxWrpFmPortDev->h_Dev);
     devm_iounmap(p_LnxWrpFmDev->dev, UINT_TO_PTR(p_LnxWrpFmPortDev->baseAddr));
-    __devm_release_region(p_LnxWrpFmDev->dev, p_LnxWrpFmDev->res, p_LnxWrpFmPortDev->baseAddr, p_LnxWrpFmPortDev->memSize);
 }
 
 
-- 
1.7.0.4

