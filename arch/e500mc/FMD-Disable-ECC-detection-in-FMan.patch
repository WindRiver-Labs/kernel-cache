From 1db16c181394675d3957a1f1a9b86181af7cf11c Mon Sep 17 00:00:00 2001
From: Madalin Bucur <madalin.bucur@freescale.com>
Date: Wed, 18 May 2011 16:02:57 +0300
Subject: [PATCH 108/233] FMD: Disable ECC detection in FMan

Extracted from vendor drop QorIQ-DPAA-SDK-V1-20110609-systembuilder.iso
0136-FMD-Disable-ECC-detection-in-FMan.patch

Disable ECC detection in FMan by setting FM_RCR[FEE]=0.

Signed-off-by: Madalin Bucur <madalin.bucur@freescale.com>
---
 .../P3040_P4080_P5020/dpaa_integration_ext.h       |    2 ++
 .../src/wrappers/Peripherals/FM/lnxwrp_fm.c        |    4 ++++
 2 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/drivers/net/dpa/NetCommSw/inc/integrations/P3040_P4080_P5020/dpaa_integration_ext.h b/drivers/net/dpa/NetCommSw/inc/integrations/P3040_P4080_P5020/dpaa_integration_ext.h
index 7d280e8..8fcf526 100644
--- a/drivers/net/dpa/NetCommSw/inc/integrations/P3040_P4080_P5020/dpaa_integration_ext.h
+++ b/drivers/net/dpa/NetCommSw/inc/integrations/P3040_P4080_P5020/dpaa_integration_ext.h
@@ -383,6 +383,8 @@ typedef enum e_FmInterModuleEvent {
 #define FM_TX_FIFO_CORRUPTION_ERRATA_10GMAC_A007
 #define FM_ECC_HALT_NO_SYNC_ERRATA_10GMAC_A008
 
+#define FM_TX_INVALID_ECC_ERRATA_10GMAC_A009
+
 #define FM_NO_RX_PREAM_ERRATA_DTSECx1
 #define FM_RX_PREAM_4_ERRATA_DTSEC_A001                 FM_NO_RX_PREAM_ERRATA_DTSECx1
 #define FM_GRS_ERRATA_DTSEC_A002
diff --git a/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/lnxwrp_fm.c b/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/lnxwrp_fm.c
index aa554a0..22ba10f 100644
--- a/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/lnxwrp_fm.c
+++ b/drivers/net/dpa/NetCommSw/src/wrappers/Peripherals/FM/lnxwrp_fm.c
@@ -2735,6 +2735,10 @@ static int /*__devinit*/ fm_port_probe(struct of_device *of_dev, const struct of
         return -EIO;
     }
 
+#ifdef FM_TX_INVALID_ECC_ERRATA_10GMAC_A009
+    FM_DisableRamsEcc(p_LnxWrpFmDev->h_Dev);
+#endif /* FM_TX_INVALID_ECC_ERRATA_10GMAC_A009 */
+
     DBG(TRACE, ("%s probed", p_LnxWrpFmPortDev->name));
 
     return 0;
-- 
1.7.0.4

