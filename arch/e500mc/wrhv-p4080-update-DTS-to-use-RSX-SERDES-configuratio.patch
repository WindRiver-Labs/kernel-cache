From d7eaf8c4c3cc3604289adc6b93c6d88b33bf91a8 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Tue, 3 Aug 2010 13:22:53 +0800
Subject: [PATCH 204/233] wrhv/p4080: update DTS to use RSX SERDES configuration for rev1

It is possible to use the same SERDES configuration as rev2 on
rev1 board. That means both the rev1 and rev2 use the same DTS
now.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/boot/dts/wrhv_p4080ds.dts |   31 ++++++++++++++++++++-----------
 1 files changed, 20 insertions(+), 11 deletions(-)

diff --git a/arch/powerpc/boot/dts/wrhv_p4080ds.dts b/arch/powerpc/boot/dts/wrhv_p4080ds.dts
index 4e8c2b0..754ff52 100644
--- a/arch/powerpc/boot/dts/wrhv_p4080ds.dts
+++ b/arch/powerpc/boot/dts/wrhv_p4080ds.dts
@@ -1291,7 +1291,7 @@
 				fsl,port-handles = <&fman0_rx0 &fman0_tx0>;
 				local-mac-address = [ 00 01 02 03 04 05 ];
 				tbi-handle = <&tbi0>;
-				phy-handle = <&phy0>;
+				phy-handle = <&phydummy>;
 				phy-connection-type = "sgmii";
 			};
 
@@ -1327,6 +1327,7 @@
 					compatible = "fsl,p4080ds-mdio";
 					fsl,mdio-handle = <&mdio0>;
 					fsl,muxval = <1>;
+					status = "disabled";
 
 					phy5: ethernet-phy@1c {
 						reg = <0x1c>;
@@ -1348,7 +1349,6 @@
 					compatible = "fsl,p4080ds-mdio";
 					fsl,mdio-handle = <&mdio0>;
 					fsl,muxval = <2>;
-					status = "disabled";
 
 					phy5slot3: ethernet-phy@1c {
 						reg = <0x1c>;
@@ -1370,6 +1370,11 @@
 					compatible = "fsl,p4080ds-mdio";
 					fsl,mdio-handle = <&mdio0>;
 					fsl,muxval = <3>;
+					status = "disabled";
+
+					phydummy: ethernet-phy@dummy {
+						reg = <0x10>;
+					};
 
 					phy0: ethernet-phy@1c {
 						reg = <0x1c>;
@@ -1393,8 +1398,8 @@
 				fsl,port-handles = <&fman0_rx1 &fman0_tx1>;
 				local-mac-address = [ 00 01 02 03 04 06 ];
 				tbi-handle = <&tbi1>;
-				phy-handle = <&phy1>;
-				phy-connection-type = "sgmii";
+				phy-handle = <&phyrgmii>;
+				phy-connection-type = "rgmii";
 			};
 
 			mdio@e3120 {
@@ -1417,7 +1422,7 @@
 				fsl,port-handles = <&fman0_rx2 &fman0_tx2>;
 				local-mac-address = [ 00 01 02 03 04 07 ];
 				tbi-handle = <&tbi2>;
-				phy-handle = <&phy2>;
+				phy-handle = <&phydummy>;
 				phy-connection-type = "sgmii";
 			};
 
@@ -1441,7 +1446,7 @@
 				fsl,port-handles = <&fman0_rx3 &fman0_tx3>;
 				local-mac-address = [ 00 01 02 03 04 08 ];
 				tbi-handle = <&tbi3>;
-				phy-handle = <&phy3>;
+				phy-handle = <&phydummy>;
 				phy-connection-type = "sgmii";
 			};
 
@@ -1654,8 +1659,8 @@
 				fsl,port-handles = <&fman1_rx0 &fman1_tx0>;
 				local-mac-address = [ 00 01 02 03 04 0a ];
 				tbi-handle = <&tbi5>;
-				phy-handle = <&phyrgmii>;
-				phy-connection-type = "rgmii";
+				phy-handle = <&phy5slot3>;
+				phy-connection-type = "sgmii";
 			};
 			mdio@e1120 {
 				#address-cells = <1>;
@@ -1675,8 +1680,9 @@
 				compatible = "fsl,p4080-fman-1g-mac", "fsl,fman-1g-mac";
 				reg = <0xe2000 0x1000>;
 				fsl,port-handles = <&fman1_rx1 &fman1_tx1>;
+				local-mac-address = [ 00 01 02 03 04 0b ];
 				tbi-handle = <&tbi6>;
-				phy-handle = <&phy6>;
+				phy-handle = <&phy6slot3>;
 				phy-connection-type = "sgmii";
 			};
 
@@ -1698,8 +1704,9 @@
 				compatible = "fsl,p4080-fman-1g-mac", "fsl,fman-1g-mac";
 				reg = <0xe4000 0x1000>;
 				fsl,port-handles = <&fman1_rx2 &fman1_tx2>;
+				local-mac-address = [ 00 01 02 03 04 0c ];
 				tbi-handle = <&tbi7>;
-				phy-handle = <&phy7>;
+				phy-handle = <&phy7slot3>;
 				phy-connection-type = "sgmii";
 			};
 
@@ -1721,8 +1728,9 @@
 				compatible = "fsl,p4080-fman-1g-mac", "fsl,fman-1g-mac";
 				reg = <0xe6000 0x1000>;
 				fsl,port-handles = <&fman1_rx3 &fman1_tx3>;
+				local-mac-address = [ 00 01 02 03 04 0d ];
 				tbi-handle = <&tbi8>;
-				phy-handle = <&phy8>;
+				phy-handle = <&phy8slot3>;
 				phy-connection-type = "sgmii";
 			};
 
@@ -1742,6 +1750,7 @@
 			enet9: ethernet@f0000 {
 				cell-index = <0>;
 				compatible = "fsl,p4080-fman-10g-mac", "fsl,fman-10g-mac";
+				local-mac-address = [ 00 01 02 03 04 0e ];
 				reg = <0xf0000 0x1000>;
 				fsl,port-handles = <&fman1_rx4 &fman1_tx4>;
 				phy-handle = <&phy11>;
-- 
1.7.0.4

