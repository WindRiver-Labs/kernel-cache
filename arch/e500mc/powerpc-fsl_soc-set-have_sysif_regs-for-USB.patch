From e482befc82cfe5ffcb331fbda2b78a37d1a7c843 Mon Sep 17 00:00:00 2001
From: Kumar Gala <galak@kernel.crashing.org>
Date: Thu, 2 Jun 2011 23:25:44 -0500
Subject: [PATCH 060/233] powerpc/fsl_soc: set have_sysif_regs for USB

Extracted from vendor drop QorIQ-DPAA-SDK-V1-20110609-systembuilder.iso
0126-powerpc-fsl_soc-set-have_sysif_regs-for-USB.patch

Since we are NOT utilizing the upstream drivers/usb/host/fsl-mph-dr-of.c
code we need to set have_sysif_regs to make sure we enable the
controller.

In the future we will replace this with:

commit 126512e3f274802ca65ebeca8660237f0361ad48
Author: Anatolij Gustschin <agust@denx.de>
Date:   Tue Sep 28 20:55:20 2010 +0200

    USB: add platform glue driver for FSL USB DR controller

Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
---
 arch/powerpc/sysdev/fsl_soc.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/sysdev/fsl_soc.c b/arch/powerpc/sysdev/fsl_soc.c
index 985a511..c05116b 100644
--- a/arch/powerpc/sysdev/fsl_soc.c
+++ b/arch/powerpc/sysdev/fsl_soc.c
@@ -257,6 +257,7 @@ static int __init fsl_usb_of_init(void)
 		usb_dev_mph->dev.coherent_dma_mask = 0xffffffffUL;
 		usb_dev_mph->dev.dma_mask = &usb_dev_mph->dev.coherent_dma_mask;
 
+		usb_data.have_sysif_regs = 1;
 		usb_data.operating_mode = FSL_USB2_MPH_HOST;
 
 		prop = of_get_property(np, "port0", NULL);
@@ -298,6 +299,7 @@ static int __init fsl_usb_of_init(void)
 
 		prop = of_get_property(np, "dr_mode", NULL);
 
+		usb_data.have_sysif_regs = 1;
 		if (!prop || !strcmp(prop, "host")) {
 			usb_data.operating_mode = FSL_USB2_DR_HOST;
 			usb_dev_dr_host = platform_device_register_simple(
-- 
1.7.0.4

