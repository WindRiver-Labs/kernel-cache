From a1c12cf6e3b7e1014fa77e42bfa4f511e636faee Mon Sep 17 00:00:00 2001
From: Xufeng Zhang <xufeng.zhang@windriver.com>
Date: Wed, 8 May 2013 10:54:42 +0800
Subject: [PATCH] spi/mpc8xxx: export necessary symbols

When spi_fsl_lib and spi_fsl_espi are built into modules,
insmod these two modules would lead to "Unknown symbol" error.

Export some symbols to resolve this problem.

Signed-off-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 drivers/spi/spi_fsl_lib.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/drivers/spi/spi_fsl_lib.c b/drivers/spi/spi_fsl_lib.c
index 3c34da9..76573c6 100644
--- a/drivers/spi/spi_fsl_lib.c
+++ b/drivers/spi/spi_fsl_lib.c
@@ -54,6 +54,9 @@ MPC8XXX_SPI_TX_BUF(u8)
 MPC8XXX_SPI_TX_BUF(u16)
 MPC8XXX_SPI_TX_BUF(u32)
 
+EXPORT_SYMBOL(mpc8xxx_spi_tx_buf_u32);
+EXPORT_SYMBOL(mpc8xxx_spi_rx_buf_u32);
+
 struct mpc8xxx_spi_probe_info *to_of_pinfo(struct fsl_spi_platform_data *pdata)
 {
 	return container_of(pdata, struct mpc8xxx_spi_probe_info, pdata);
@@ -168,6 +171,7 @@ int mpc8xxx_spi_probe(struct device *dev, struct resource *mem,
 err:
 	return ret;
 }
+EXPORT_SYMBOL(mpc8xxx_spi_probe);
 
 int __devexit mpc8xxx_spi_remove(struct device *dev)
 {
@@ -188,6 +192,7 @@ int __devexit mpc8xxx_spi_remove(struct device *dev)
 
 	return 0;
 }
+EXPORT_SYMBOL(mpc8xxx_spi_remove);
 
 int __devinit of_mpc8xxx_spi_probe(struct of_device *ofdev,
 				   const struct of_device_id *ofid)
@@ -235,3 +240,6 @@ err:
 	kfree(pinfo);
 	return ret;
 }
+EXPORT_SYMBOL(of_mpc8xxx_spi_probe);
+
+MODULE_LICENSE("GPL v2");
-- 
1.7.0

