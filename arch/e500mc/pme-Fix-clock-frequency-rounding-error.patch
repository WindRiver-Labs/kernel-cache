From 346d5a2544dc05e76a18c0ca7c2b2eed071ed5fb Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Thu, 9 Sep 2010 15:34:49 +0800
Subject: [PATCH 191/252] pme: Fix clock frequency rounding error

Patch taken from FSL vendor SDK 2.1.

Use DIV_ROUND_UP to round up.

Signed-off-by: Jeffrey Ladouceur <Jeffrey.Ladouceur@freescale.com>
Integrated-by: Andrew Liu <shengping.liu@windriver.com>
---
 drivers/match/pme2_ctrl.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/match/pme2_ctrl.c b/drivers/match/pme2_ctrl.c
index e4bb213..2d13c71 100644
--- a/drivers/match/pme2_ctrl.c
+++ b/drivers/match/pme2_ctrl.c
@@ -354,7 +354,7 @@ static int __devinit of_fsl_pme_probe(struct of_device *ofdev,
 	value = of_get_property(nprop, "clock-frequency", NULL);
 	if (value)
 		clkfreq = *value;
-	pme_out(global_pme, SFRCC, clkfreq/1000000);
+	pme_out(global_pme, SFRCC, DIV_ROUND_UP(clkfreq, 1000000));
 
 	pme_out(global_pme, PDSRBAH, (u32)((u64)dxe_a >> 32));
 	pme_out(global_pme, PDSRBAL, (u32)dxe_a);
-- 
1.6.5.2

