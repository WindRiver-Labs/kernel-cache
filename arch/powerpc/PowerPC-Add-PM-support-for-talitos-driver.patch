From 2a5f5488ebb34d5878866e7c9a8f10013a337c6a Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Wed, 1 Dec 2010 14:23:01 +0800
Subject: [PATCH 10/13] PowerPC:Add PM support for talitos driver

Talitios need re-initialize after resume from sleep. So add resume
routine to talitos driver.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/crypto/talitos.c |   12 ++++++++++++
 1 files changed, 12 insertions(+), 0 deletions(-)

diff --git a/drivers/crypto/talitos.c b/drivers/crypto/talitos.c
index dc558a0..9de39dd 100644
--- a/drivers/crypto/talitos.c
+++ b/drivers/crypto/talitos.c
@@ -1739,6 +1739,15 @@ static int hw_supports(struct device *dev, __be32 desc_hdr_template)
 	return ret;
 }
 
+#ifdef CONFIG_SUSPEND
+static int talitos_resume(struct of_device *ofdev)
+{
+	struct device *dev = &ofdev->dev;
+	init_device(dev);
+	return 0;
+}
+#endif
+
 static int talitos_remove(struct of_device *ofdev)
 {
 	struct device *dev = &ofdev->dev;
@@ -1972,6 +1981,9 @@ static struct of_platform_driver talitos_driver = {
 	.match_table = talitos_match,
 	.probe = talitos_probe,
 	.remove = talitos_remove,
+#ifdef CONFIG_SUSPEND
+	.resume = talitos_resume,
+#endif
 };
 
 static int __init talitos_init(void)
-- 
1.6.5.2

