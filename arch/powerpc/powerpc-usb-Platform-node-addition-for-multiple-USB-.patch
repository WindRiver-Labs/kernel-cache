From 1d55e9739b79755e850d55f983e21936c4654d66 Mon Sep 17 00:00:00 2001
From: Xufeng Zhang <xufeng.zhang@windriver.com>
Date: Wed, 10 Aug 2011 15:57:32 +0800
Subject: [PATCH 1/5] powerpc/usb: Platform node addition for multiple USB Controllers

Fix the problem of USB mode duplication for multiple USB platform nodes.

Extracted from vendor drop QorIQ-NONDPAA-SDK-V1-20110429_ltib.iso
linux-2.6.35-qoriq-BUG-Fix-Platform-node-addition-for-mult.patch.

Signed-off-by: Ramneek Mehresh <ramneek.mehresh@freescale.com>
Integrated-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 arch/powerpc/sysdev/fsl_soc.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/sysdev/fsl_soc.c b/arch/powerpc/sysdev/fsl_soc.c
index 985a511..f1077b1 100644
--- a/arch/powerpc/sysdev/fsl_soc.c
+++ b/arch/powerpc/sysdev/fsl_soc.c
@@ -277,6 +277,7 @@ static int __init fsl_usb_of_init(void)
 		if (ret)
 			goto unreg_mph;
 		i++;
+		usb_dev_mph = NULL;
 	}
 
 	for_each_compatible_node(np, NULL, "fsl-usb2-dr") {
@@ -373,6 +374,8 @@ static int __init fsl_usb_of_init(void)
 				goto unreg_dr;
 		}
 		i++;
+		usb_dev_dr_host = NULL;
+		usb_dev_dr_client = NULL;
 	}
 	return 0;
 
-- 
1.7.0.2

