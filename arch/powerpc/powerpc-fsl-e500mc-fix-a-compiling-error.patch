From c972b705de5e484b187a0540062af6d471ab7c7e Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Mon, 10 Dec 2012 12:05:38 +0800
Subject: [PATCH] powerpc/fsl-e500mc: fix a compiling error

[
This should be squashed into my previous commit in our tree:

commit 1c12f8f3b72b56c31e195dada8a16a5e6a4574e6

    book3e/kexec/kdump: introduce a kexec kernel flag
]

|   CC      arch/powerpc/platforms/85xx/p4080_ds_mdio.o
| arch/powerpc/platforms/85xx/smp.c: In function 'smp_85xx_kick_cpu':
| arch/powerpc/platforms/85xx/smp.c:177:17: error: unused variable 'ptr' [-Werror=unused-variable]
| cc1: all warnings being treated as errors
| make[4]: *** [arch/powerpc/platforms/85xx/smp.o] Error 1
| make[4]: *** Waiting for unfinished jobs....
| make[3]: *** [arch/powerpc/platforms/85xx] Error 2
| make[2]: *** [arch/powerpc/platforms] Error 2
| make[1]: *** [sub-make] Error 2
| make: *** [all] Error 2
| ERROR: oe_runmake failed

That variable should only be valid for !PPC32.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/platforms/85xx/smp.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/powerpc/platforms/85xx/smp.c b/arch/powerpc/platforms/85xx/smp.c
index 29f8c8a..3aae392 100644
--- a/arch/powerpc/platforms/85xx/smp.c
+++ b/arch/powerpc/platforms/85xx/smp.c
@@ -173,7 +173,7 @@ static int __cpuinit smp_85xx_kick_cpu(int nr)
 	int hw_cpu = get_hard_smp_processor_id(nr);
 	int ioremappable;
 	int ret = 0;
-#if defined(CONFIG_KEXEC) || defined(CONFIG_CRASH_DUMP)
+#if (defined(CONFIG_KEXEC) || defined(CONFIG_CRASH_DUMP)) && !defined(CONFIG_PPC32)
 	unsigned long *ptr;
 #endif
 
-- 
1.7.9.7

