From 2b96cf09d658687895a2909e181bd0a737e610fc Mon Sep 17 00:00:00 2001
From: Hong H. Pham <hong.pham@windriver.com>
Date: Wed, 5 Nov 2008 18:55:40 -0500
Subject: [PATCH] sparc64 initialize hrt_khz

Initialize the SPARC64 high resolution timer frequency.

Signed-off-by: Hong H. Pham <hong.pham@windriver.com>
---
 arch/sparc64/kernel/time.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/arch/sparc64/kernel/time.c b/arch/sparc64/kernel/time.c
index af70cab..363e3e3 100644
--- a/arch/sparc64/kernel/time.c
+++ b/arch/sparc64/kernel/time.c
@@ -1106,18 +1106,20 @@ void __init time_init(void)
 		clockevent_delta2ns(0xF, &sparc64_clockevent);
 
 	printk("clockevent: mult[%lx] shift[%d]\n",
 	       sparc64_clockevent.mult, sparc64_clockevent.shift);
 
 	setup_sparc64_timer();
 
 #if defined(HWTIMER_USE_JIFFY)
-	 register_hwtimer(&sparc64_timer);
+	register_hwtimer(&sparc64_timer);
 #endif
+
+	hrt_khz = sparc64_get_clock_tick(0) / 1000;
 }
 
 unsigned long long sched_clock(void)
 {
 	unsigned long ticks = tick_ops->get_tick();
 
 	return (ticks * timer_ticks_per_nsec_quotient)
 		>> SPARC64_NSEC_PER_CYC_SHIFT;
-- 
1.5.5.1

