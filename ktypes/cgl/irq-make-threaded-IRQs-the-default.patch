From eedd0ef2870f51f959b34ac889b7851a93d84291 Mon Sep 17 00:00:00 2001
From: Amy Fong <Amy.Fong@windriver.com>
Date: Mon, 7 Jan 2013 14:52:50 -0500
Subject: [PATCH 7/8] irq: make threaded IRQs the default

Making threadirqs the default. Add another kernel parameter nothreadirqs
to disable this.

Signed-off-by: Amy Fong <Amy.Fong@windriver.com>
Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 kernel/irq/manage.c |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/kernel/irq/manage.c b/kernel/irq/manage.c
index dc4db32..02b6637 100644
--- a/kernel/irq/manage.c
+++ b/kernel/irq/manage.c
@@ -22,7 +22,7 @@
 #include "internals.h"
 
 #ifdef CONFIG_IRQ_FORCED_THREADING
-__read_mostly bool force_irqthreads;
+__read_mostly bool force_irqthreads = true;
 
 static int __init setup_forced_irqthreads(char *arg)
 {
@@ -30,6 +30,13 @@ static int __init setup_forced_irqthreads(char *arg)
 	return 0;
 }
 early_param("threadirqs", setup_forced_irqthreads);
+
+static int __init setup_no_forced_irqthreads(char *arg)
+{
+	force_irqthreads = false;
+	return 0;
+}
+early_param("nothreadirqs", setup_no_forced_irqthreads);
 #endif
 
 /**
-- 
1.7.5.4

