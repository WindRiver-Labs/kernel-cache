From fe4356c113eae7d41ad1e2d5b6f480a245c802b3 Mon Sep 17 00:00:00 2001
From: Yong Zhang <yong.zhang@windriver.com>
Date: Tue, 24 Apr 2012 12:44:19 +0800
Subject: [PATCH] syscall: fix syscall table mismatch

Signed-off-by: Yong Zhang <yong.zhang@windriver.com>
---
 arch/mips/kernel/scall32-o32.S     |    6 +++---
 arch/mips/kernel/scall64-n32.S     |    6 +++---
 arch/mips/kernel/scall64-o32.S     |    6 +++---
 arch/x86/include/asm/unistd_32.h   |   16 ++++++++--------
 arch/x86/include/asm/unistd_64.h   |   22 +++++++++++-----------
 arch/x86/kernel/syscall_table_32.S |   14 +++++++-------
 6 files changed, 35 insertions(+), 35 deletions(-)

diff --git a/arch/mips/kernel/scall32-o32.S b/arch/mips/kernel/scall32-o32.S
index 0439730..8e492f1 100644
--- a/arch/mips/kernel/scall32-o32.S
+++ b/arch/mips/kernel/scall32-o32.S
@@ -585,14 +585,14 @@ einval:	li	v0, -ENOSYS
 	sys	sys_accept4		4
 	sys     sys_recvmmsg            5
 	sys	sys_revokeat		2
-	sys	sys_vbi_mem		5
-	sys 	sys_vbi_activate_vb	2
-	sys 	sys_vbi_control		3
 	sys     sys_sched_setscheduler_ex 4
 	sys     sys_sched_setparam_ex	3
 	sys     sys_sched_getparam_ex	3
 	sys     sys_sched_wait_interval	2
 	sys     sys_setns               2
+	sys	sys_vbi_mem		5
+	sys 	sys_vbi_activate_vb	2
+	sys 	sys_vbi_control		3
 	.endm
 
 	/* We pre-compute the number of _instruction_ bytes needed to
diff --git a/arch/mips/kernel/scall64-n32.S b/arch/mips/kernel/scall64-n32.S
index 5b02a23..6225f6e 100644
--- a/arch/mips/kernel/scall64-n32.S
+++ b/arch/mips/kernel/scall64-n32.S
@@ -423,12 +423,12 @@ EXPORT(sysn32_call_table)
 	PTR     compat_sys_recvmmsg
 	PTR     sys_getdents64
 	PTR	sys_revokeat
-	PTR     sys_vbi_mem
-	PTR     sys_vbi_activate_vb
-	PTR     sys_vbi_control
 	PTR     sys_sched_setscheduler_ex
 	PTR     sys_sched_setparam_ex
 	PTR     sys_sched_getparam_ex
 	PTR     sys_sched_wait_interval
 	PTR     sys_setns
+	PTR     sys_vbi_mem
+	PTR     sys_vbi_activate_vb
+	PTR     sys_vbi_control
 	.size	sysn32_call_table,.-sysn32_call_table
diff --git a/arch/mips/kernel/scall64-o32.S b/arch/mips/kernel/scall64-o32.S
index 28e2410..a2ce4ac 100644
--- a/arch/mips/kernel/scall64-o32.S
+++ b/arch/mips/kernel/scall64-o32.S
@@ -540,12 +540,12 @@ EXPORT(syso32_call_table)
 	PTR	sys_accept4
 	PTR     compat_sys_recvmmsg
 	PTR	sys_revokeat
-	PTR     sys_vbi_mem
-	PTR     sys_vbi_activate_vb
-	PTR     sys_vbi_control
 	PTR     sys_sched_setscheduler_ex
 	PTR     sys_sched_setparam_ex
 	PTR     sys_sched_getparam_ex
 	PTR     sys_sched_wait_interval
 	PTR     sys_setns
+	PTR     sys_vbi_mem
+	PTR     sys_vbi_activate_vb
+	PTR     sys_vbi_control
 	.size	sys_call_table,.-sys_call_table
diff --git a/arch/x86/include/asm/unistd_32.h b/arch/x86/include/asm/unistd_32.h
index a1d457e..23ed0ca 100644
--- a/arch/x86/include/asm/unistd_32.h
+++ b/arch/x86/include/asm/unistd_32.h
@@ -344,14 +344,14 @@
 #define __NR_perf_event_open	336
 #define __NR_recvmmsg		337
 #define __NR_revokeat		338
-#define __NR_vbi_mem		339
-#define __NR_vbi_activate_vb	340
-#define __NR_vbi_control	341
-#define __NR_sched_setscheduler_ex	342
-#define __NR_sched_setparam_ex		343
-#define __NR_sched_getparam_ex		344
-#define __NR_sched_wait_interval	345
-#define __NR_setns		346
+#define __NR_sched_setscheduler_ex	339
+#define __NR_sched_setparam_ex		340
+#define __NR_sched_getparam_ex		341
+#define __NR_sched_wait_interval	342
+#define __NR_setns		343
+#define __NR_vbi_mem		334
+#define __NR_vbi_activate_vb	345
+#define __NR_vbi_control	346
 
 #define VBI_MEM_READ		0x0010
 #define VBI_MEM_WRITE		0x0100
diff --git a/arch/x86/include/asm/unistd_64.h b/arch/x86/include/asm/unistd_64.h
index c730cd5..032c241 100644
--- a/arch/x86/include/asm/unistd_64.h
+++ b/arch/x86/include/asm/unistd_64.h
@@ -663,22 +663,22 @@ __SYSCALL(__NR_rt_tgsigqueueinfo, sys_rt_tgsigqueueinfo)
 __SYSCALL(__NR_perf_event_open, sys_perf_event_open)
 #define __NR_recvmmsg				299
 __SYSCALL(__NR_recvmmsg, sys_recvmmsg)
-#define __NR_vbi_mem				300
-__SYSCALL(__NR_vbi_mem, sys_vbi_mem)
-#define __NR_vbi_activate_vb			301
-__SYSCALL(__NR_vbi_activate_vb, sys_vbi_activate_vb)
-#define __NR_vbi_control			302
-__SYSCALL(__NR_vbi_control, sys_vbi_control)
-#define __NR_sched_setscheduler_ex		303
+#define __NR_sched_setscheduler_ex		300
 __SYSCALL(__NR_sched_setscheduler_ex, sys_sched_setscheduler_ex)
-#define __NR_sched_setparam_ex			304
+#define __NR_sched_setparam_ex			301
 __SYSCALL(__NR_sched_setparam_ex, sys_sched_setparam_ex)
-#define __NR_sched_getparam_ex			305
+#define __NR_sched_getparam_ex			302
 __SYSCALL(__NR_sched_getparam_ex, sys_sched_getparam_ex)
-#define __NR_sched_wait_interval		306
+#define __NR_sched_wait_interval		303
 __SYSCALL(__NR_sched_wait_interval, sys_sched_wait_interval)
-#define __NR_setns				307
+#define __NR_setns				304
 __SYSCALL(__NR_setns, sys_setns)
+#define __NR_vbi_mem				305
+__SYSCALL(__NR_vbi_mem, sys_vbi_mem)
+#define __NR_vbi_activate_vb			306
+__SYSCALL(__NR_vbi_activate_vb, sys_vbi_activate_vb)
+#define __NR_vbi_control			307
+__SYSCALL(__NR_vbi_control, sys_vbi_control)
 
 #define VBI_MEM_READ           0x0010
 #define VBI_MEM_WRITE          0x0100
diff --git a/arch/x86/kernel/syscall_table_32.S b/arch/x86/kernel/syscall_table_32.S
index 635587b..e450287 100644
--- a/arch/x86/kernel/syscall_table_32.S
+++ b/arch/x86/kernel/syscall_table_32.S
@@ -338,11 +338,11 @@ ENTRY(sys_call_table)
 	.long sys_perf_event_open
 	.long sys_recvmmsg
 	.long sys_revokeat
-	.long sys_vbi_mem		/* 339 */
-	.long sys_vbi_activate_vb	/* 340 */
-	.long sys_vbi_control		/* 341 */
-	.long sys_sched_setscheduler_ex
-	.long sys_sched_setparam_ex
-	.long sys_sched_getparam_ex	/* 344 */
-	.long sys_sched_wait_interval	/* 345 */
+	.long sys_sched_setscheduler_ex	/* 339 */
+	.long sys_sched_setparam_ex	/* 340 */
+	.long sys_sched_getparam_ex	/* 341 */
+	.long sys_sched_wait_interval	/* 342 */
 	.long sys_setns
+	.long sys_vbi_mem		/* 344 */
+	.long sys_vbi_activate_vb	/* 345 */
+	.long sys_vbi_control		/* 346 */
-- 
1.7.0

