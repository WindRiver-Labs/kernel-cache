From 1b050e744b076278b597acb86b46b883befb423a Mon Sep 17 00:00:00 2001
From: Paul Gortmaker <paul.gortmaker@windriver.com>
Date: Sun, 20 Mar 2011 20:19:03 -0400
Subject: [PATCH] arm: fix munged merge of at91sam926x_time.c use of raw_local_irq_save

Upstream commit 501d70383aa9f was largely present in the merge of
33-rt20 patch but this chunk was neglected.  It can be clearly
seen in the above commit ID.

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>

diff --git a/arch/arm/mach-at91/at91sam926x_time.c b/arch/arm/mach-at91/at91sam926x_time.c
index e94db28..e22a06f 100644
--- a/arch/arm/mach-at91/at91sam926x_time.c
+++ b/arch/arm/mach-at91/at91sam926x_time.c
@@ -67,12 +67,10 @@ pit_clkevt_mode(enum clock_event_mode mode, struct clock_event_device *dev)
 		/* Set up irq handler */
 		setup_irq(AT91_ID_SYS, &at91sam926x_pit_irq);
 
-		/* update clocksource counter, then enable the IRQ */
-		raw_local_irq_save(flags);
+		/* update clocksource counter */
 		pit_cnt += pit_cycle * PIT_PICNT(at91_sys_read(AT91_PIT_PIVR));
 		at91_sys_write(AT91_PIT_MR, (pit_cycle - 1) | AT91_PIT_PITEN
 				| AT91_PIT_PITIEN);
-		raw_local_irq_restore(flags);
 		break;
 	case CLOCK_EVT_MODE_ONESHOT:
 		BUG();
-- 
1.7.1.1

