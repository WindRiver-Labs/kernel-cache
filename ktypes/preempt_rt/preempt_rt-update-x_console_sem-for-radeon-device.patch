From b1aeab7688dc539c78c15ebc4842ea047fc50645 Mon Sep 17 00:00:00 2001
From: Michel Thebeau <michel.thebeau@windriver.com>
Date: Fri, 20 Aug 2010 10:03:13 -0700
Subject: [PATCH] preempt_rt: update x_console_sem for radeon device

The refactor of acquire_console_sem and release_console_sem was
    initiated in 'preempt-rt: -rt20 applied to 2.6.34 -standard'.
    The new names are:
      acquire_console_mutex
      release_console_mutex

    References to the two functions in radeon_device.c did not
    get refactored however, so here they are.

Signed-off-by: Michel Thebeau <michel.thebeau@windriver.com>
---
 drivers/gpu/drm/radeon/radeon_device.c |   10 +++++-----
 1 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/drivers/gpu/drm/radeon/radeon_device.c b/drivers/gpu/drm/radeon/radeon_device.c
index ed6a724..1348ca4 100644
--- a/drivers/gpu/drm/radeon/radeon_device.c
+++ b/drivers/gpu/drm/radeon/radeon_device.c
@@ -756,9 +756,9 @@ int radeon_suspend_kms(struct drm_device *dev, pm_message_t state)
 		pci_disable_device(dev->pdev);
 		pci_set_power_state(dev->pdev, PCI_D3hot);
 	}
-	acquire_console_sem();
+	acquire_console_mutex();
 	fb_set_suspend(rdev->fbdev_info, 1);
-	release_console_sem();
+	release_console_mutex();
 	return 0;
 }
 
@@ -769,11 +769,11 @@ int radeon_resume_kms(struct drm_device *dev)
 	if (rdev->powered_down)
 		return 0;
 
-	acquire_console_sem();
+	acquire_console_mutex();
 	pci_set_power_state(dev->pdev, PCI_D0);
 	pci_restore_state(dev->pdev);
 	if (pci_enable_device(dev->pdev)) {
-		release_console_sem();
+		release_console_mutex();
 		return -1;
 	}
 	pci_set_master(dev->pdev);
@@ -782,7 +782,7 @@ int radeon_resume_kms(struct drm_device *dev)
 	radeon_resume(rdev);
 	radeon_restore_bios_scratch_regs(rdev);
 	fb_set_suspend(rdev->fbdev_info, 0);
-	release_console_sem();
+	release_console_mutex();
 
 	/* reset hpd state */
 	radeon_hpd_init(rdev);
-- 
1.6.5.2

