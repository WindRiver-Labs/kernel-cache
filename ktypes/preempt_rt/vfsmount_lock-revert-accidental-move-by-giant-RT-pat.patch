From a979a2f7339de0478d84aedf74ab8fb06aafabbe Mon Sep 17 00:00:00 2001
From: Paul Gortmaker <paul.gortmaker@windriver.com>
Date: Sat, 19 Feb 2011 14:56:14 -0500
Subject: [PATCH] vfsmount_lock: revert accidental move by giant RT patch

Bundled into "preempt-rt: -rt20 applied to 2.6.34 -standard" was
an incorrect relocation of this lock from an internal header to one
with higher exposure.  Neither 33rt in tip, nor any changes between
33 and 34 created such a move.  Revert it.

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 fs/internal.h         |    1 +
 include/linux/mount.h |    1 -
 2 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/fs/internal.h b/fs/internal.h
index 4170a81..8a03a54 100644
--- a/fs/internal.h
+++ b/fs/internal.h
@@ -70,6 +70,7 @@ extern struct vfsmount *copy_tree(struct vfsmount *, struct dentry *, int);
 
 extern void __init mnt_init(void);
 
+extern spinlock_t vfsmount_lock;
 
 /*
  * fs_struct.c
diff --git a/include/linux/mount.h b/include/linux/mount.h
index 86063b7..4bd0547 100644
--- a/include/linux/mount.h
+++ b/include/linux/mount.h
@@ -134,7 +134,6 @@ extern int do_add_mount(struct vfsmount *newmnt, struct path *path,
 
 extern void mark_mounts_for_expiry(struct list_head *mounts);
 
-extern spinlock_t vfsmount_lock;
 extern dev_t name_to_dev_t(char *name);
 
 #endif /* _LINUX_MOUNT_H */
-- 
1.7.4

