From 2ea7f7c63c218698e00b8945186d018f6efde0e0 Mon Sep 17 00:00:00 2001
From: Xufeng Zhang <xufeng.zhang@windriver.com>
Date: Tue, 6 Dec 2011 19:11:35 +0800
Subject: [PATCH] Revert "sdhci: enable cache snooping"

Since DMA cache snooping is already enabled in esdhc_enable_dma(),
so we don't need to enable it again in sdhci_init(). Furthmore,
DMA control register is not an standard register in SDHCI
Specification, kernel may crash when there is not such register
on board.
So Revert the useless commit "sdhci: enable cache snooping".

Signed-off-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 drivers/mmc/host/sdhci.c |    4 ----
 drivers/mmc/host/sdhci.h |    1 -
 2 files changed, 0 insertions(+), 5 deletions(-)

diff --git a/drivers/mmc/host/sdhci.c b/drivers/mmc/host/sdhci.c
index 798fd6f..fc715c3 100644
--- a/drivers/mmc/host/sdhci.c
+++ b/drivers/mmc/host/sdhci.c
@@ -198,10 +198,6 @@ static void sdhci_init(struct sdhci_host *host, int soft)
 	else
 		sdhci_reset(host, SDHCI_RESET_ALL);
 
-	/* Enable cache snooping, if DMA is not broken */
-	if (!(host->quirks & SDHCI_QUIRK_BROKEN_DMA))
-		sdhci_writel(host, SDHCI_CACHE_SNOOP, SDHCI_HOST_DMA_CONTROL);
-
 	if (host->quirks & SDHCI_QUIRK_SET_AHB2MAG_IRQ_BYPASS) {
 		ctrl = sdhci_readl(host, SDHCI_HOST_DMA_CONTROL);
 		ctrl |= SDHCI_AHB2MAG_IRQ_BYPASS;
diff --git a/drivers/mmc/host/sdhci.h b/drivers/mmc/host/sdhci.h
index 81d6d4e..4879a7c 100644
--- a/drivers/mmc/host/sdhci.h
+++ b/drivers/mmc/host/sdhci.h
@@ -191,7 +191,6 @@
 /* 40C DMA control register */
 #define SDHCI_HOST_DMA_CONTROL	0x40C
 #define SDHCI_AHB2MAG_IRQ_BYPASS       0x20
-#define SDHCI_CACHE_SNOOP	0x40
 
 struct sdhci_ops;
 
-- 
1.7.0.4

