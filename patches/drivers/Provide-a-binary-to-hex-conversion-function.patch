From 36a59c6390b522c6670af51e7b27b6b7b46aa248 Mon Sep 17 00:00:00 2001
From: Ovidiu Panait <ovidiu.panait@windriver.com>
Date: Thu, 11 Oct 2018 15:51:34 +0300
Subject: [PATCH 2/3] Provide a binary to hex conversion function

commit 53d91c5ce0cb8945b55e8bb54e551cabc51eb28d upstream

Provide a function to convert a buffer of binary data into an unterminated
ascii hex string representation of that data.

Signed-off-by: David Howells <dhowells@redhat.com>
Acked-by: Vivek Goyal <vgoyal@redhat.com>
[OP: Adjusted context for kernel version 3.10]
Signed-off-by: Ovidiu Panait <ovidiu.panait@windriver.com>
---
 include/linux/kernel.h |    1 +
 lib/hexdump.c          |   16 ++++++++++++++++
 2 files changed, 17 insertions(+)

diff --git a/include/linux/kernel.h b/include/linux/kernel.h
index e9ef6d6..3c0ffb0 100644
--- a/include/linux/kernel.h
+++ b/include/linux/kernel.h
@@ -449,6 +449,7 @@ static inline char * __deprecated pack_hex_byte(char *buf, u8 byte)
 
 extern int hex_to_bin(char ch);
 extern int __must_check hex2bin(u8 *dst, const char *src, size_t count);
+extern char *bin2hex(char *dst, const void *src, size_t count);
 
 /*
  * General tracing related utility functions - trace_printk(),
diff --git a/lib/hexdump.c b/lib/hexdump.c
index 3f0494c..9b232f8 100644
--- a/lib/hexdump.c
+++ b/lib/hexdump.c
@@ -57,6 +57,22 @@ int hex2bin(u8 *dst, const char *src, size_t count)
 EXPORT_SYMBOL(hex2bin);
 
 /**
+ * bin2hex - convert binary data to an ascii hexadecimal string
+ * @dst: ascii hexadecimal result
+ * @src: binary data
+ * @count: binary data length
+ */
+char *bin2hex(char *dst, const void *src, size_t count)
+{
+	const unsigned char *_src = src;
+
+	while (count--)
+		dst = hex_byte_pack(dst, *_src++);
+	return dst;
+}
+EXPORT_SYMBOL(bin2hex);
+
+/**
  * hex_dump_to_buffer - convert a blob of data to "hex ASCII" in memory
  * @buf: data blob to dump
  * @len: number of bytes in the @buf
-- 
1.7.9.5

