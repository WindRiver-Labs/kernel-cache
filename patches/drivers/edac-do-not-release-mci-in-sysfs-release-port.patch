From 5ff8cb45c9728479ecf93472f9029ac25a8c22c5 Mon Sep 17 00:00:00 2001
From: Liwei Song <liwei.song@windriver.com>
Date: Tue, 11 Aug 2015 16:36:42 +0800
Subject: [PATCH 1/2] edac: do not release mci in sysfs release port

since the ungister and free task for mci has been down in edac_mc_free():
here in sysfs release function do not need do the dual free task, so remove it.

Signed-off-by: Liwei Song <liwei.song@windriver.com>
---
 drivers/edac/edac_mc_sysfs.c |   12 ------------
 1 files changed, 0 insertions(+), 12 deletions(-)

diff --git a/drivers/edac/edac_mc_sysfs.c b/drivers/edac/edac_mc_sysfs.c
index 98eb602..32bcba4 100644
--- a/drivers/edac/edac_mc_sysfs.c
+++ b/drivers/edac/edac_mc_sysfs.c
@@ -291,10 +291,6 @@ static const struct attribute_group *csrow_attr_groups[] = {
 
 static void csrow_attr_release(struct device *dev)
 {
-	struct csrow_info *csrow = container_of(dev, struct csrow_info, dev);
-
-	edac_dbg(1, "Releasing csrow device %s\n", dev_name(dev));
-	kfree(csrow);
 }
 
 static struct device_type csrow_attr_type = {
@@ -586,10 +582,6 @@ static const struct attribute_group *dimm_attr_groups[] = {
 
 static void dimm_attr_release(struct device *dev)
 {
-	struct dimm_info *dimm = container_of(dev, struct dimm_info, dev);
-
-	edac_dbg(1, "Releasing dimm device %s\n", dev_name(dev));
-	kfree(dimm);
 }
 
 static struct device_type dimm_attr_type = {
@@ -884,10 +876,6 @@ static const struct attribute_group *mci_attr_groups[] = {
 
 static void mci_attr_release(struct device *dev)
 {
-	struct mem_ctl_info *mci = container_of(dev, struct mem_ctl_info, dev);
-
-	edac_dbg(1, "Releasing csrow device %s\n", dev_name(dev));
-	kfree(mci);
 }
 
 static struct device_type mci_attr_type = {
-- 
1.7.5.4

