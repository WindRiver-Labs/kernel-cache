From 28a1b15eda7d74a451178225d27664001f47eeb0 Mon Sep 17 00:00:00 2001
From: Xufeng Zhang <xufeng.zhang@windriver.com>
Date: Tue, 9 Aug 2011 19:23:22 +0800
Subject: [PATCH 40/47] powerpc/85xx: Fix to allow coexistence of filer, TOE and 1588

This patch retains the filer and checksum offloading functionality
which otherwise got disabled when ptp_timer node exists in the
device tree.

Extracted from vendor drop QorIQ-NONDPAA-SDK-V1-20110429_ltib.iso
0085-powerpc-85xx-Fix-to-allow-coexistence-of-filer-TOE-a.patch.

Signed-off-by: Bhaskar Upadhaya <Bhaskar.Upadhaya@freescale.com>
Integrated-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 drivers/net/gianfar.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/net/gianfar.c b/drivers/net/gianfar.c
index 86d99ad..d9a44ef 100644
--- a/drivers/net/gianfar.c
+++ b/drivers/net/gianfar.c
@@ -501,7 +501,7 @@ static void gfar_init_mac(struct net_device *ndev)
 		/* Set Filer Table */
 		gfar_1588_start(ndev);
 		if (priv->device_flags & FSL_GIANFAR_DEV_HAS_PADDING)
-			rctrl &= RCTRL_PAL_MASK;
+			rctrl &= ~RCTRL_PAL_MASK;
 		/* Enable Filer for Rx Queue */
 		rctrl |= RCTRL_PRSDEP_INIT |
 			RCTRL_TS_ENABLE | RCTRL_PADDING(8);
-- 
1.7.0.2

