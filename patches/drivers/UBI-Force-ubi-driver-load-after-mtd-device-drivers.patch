From 4c7289f4d4d036fe7e91285c95340583221a6a35 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Tue, 7 Aug 2012 18:48:26 +0800
Subject: [PATCH] UBI:Force ubi driver load after mtd device drivers

UBI device driver must load after other mtd device driver to make sure
the mtd partition already exist when creating UBI deivce.

The patch updates the UBI device driver's initial routine to late_initcall.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/mtd/ubi/build.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/mtd/ubi/build.c b/drivers/mtd/ubi/build.c
index 0fde9fc..efbcaef 100644
--- a/drivers/mtd/ubi/build.c
+++ b/drivers/mtd/ubi/build.c
@@ -1275,7 +1275,7 @@ out:
 	ubi_err("UBI error: cannot initialize UBI, error %d", err);
 	return err;
 }
-module_init(ubi_init);
+late_initcall(ubi_init);
 
 static void __exit ubi_exit(void)
 {
-- 
1.7.9.7

