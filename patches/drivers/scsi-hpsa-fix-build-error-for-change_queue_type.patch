From 3b573065b1025a49fe6102354dd3b421dcb24caf Mon Sep 17 00:00:00 2001
From: chunguang yang <chunguang.yang@windriver.com>
Date: Tue, 20 Oct 2015 22:58:15 -0400
Subject: [PATCH 3/5] scsi/hpsa: fix build error for change_queue_type

when building, the following error will appear:
drivers/scsi/hpsa.c:1014:2: error: unknown field 'change_queue_type'
specified in initializer
  .change_queue_type = hpsa_change_queue_type,

commit efc3c1df5fda0aee84f53c226d55804e6dbede4f

scsi: remove ->change_queue_type method
this commit remove change_queue_type field, to fix this error,
remove the related function.
Signed-off-by: chunguang yang <chunguang.yang@windriver.com>
---
 drivers/scsi/hpsa.c | 15 ---------------
 1 file changed, 15 deletions(-)

diff --git a/drivers/scsi/hpsa.c b/drivers/scsi/hpsa.c
index ebe6d47..04513c2 100644
--- a/drivers/scsi/hpsa.c
+++ b/drivers/scsi/hpsa.c
@@ -288,7 +288,6 @@ static void hpsa_scan_start(struct Scsi_Host *);
 static int hpsa_scan_finished(struct Scsi_Host *sh,
 	unsigned long elapsed_time);
 DECLARE_CHANGE_QUEUE_DEPTH(hpsa_change_queue_depth);
-static int hpsa_change_queue_type(struct scsi_device *sdev, int type);
 
 static int hpsa_eh_device_reset_handler(struct scsi_cmnd *scsicmd);
 static int hpsa_eh_abort_handler(struct scsi_cmnd *scsicmd);
@@ -1011,7 +1010,6 @@ static struct scsi_host_template hpsa_driver_template = {
 	INITIALIZE_SCAN_FINISHED(hpsa_scan_finished)
 	HPSA_SKIP_HOST_LOCK
 	.change_queue_depth	= hpsa_change_queue_depth,
-	.change_queue_type	= hpsa_change_queue_type,
 	.this_id		= -1,
 	.use_clustering		= ENABLE_CLUSTERING,
 	.eh_abort_handler	= hpsa_eh_abort_handler,
@@ -5427,19 +5425,6 @@ DECLARE_CHANGE_QUEUE_DEPTH(hpsa_change_queue_depth)
 	return sdev->queue_depth;
 }
 
-static int hpsa_change_queue_type(struct scsi_device *sdev, int tag_type)
-{
-	if (sdev->tagged_supported) {
-		scsi_set_tag_type(sdev, tag_type);
-		if (tag_type)
-			scsi_activate_tcq(sdev, sdev->queue_depth);
-		else
-			scsi_deactivate_tcq(sdev, sdev->queue_depth);
-	} else
-		tag_type = 0;
-
-	return tag_type;
-}
 
 static void hpsa_unregister_scsi(struct ctlr_info *h)
 {
-- 
2.0.2

