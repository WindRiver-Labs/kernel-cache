From 6f23946c9e1b74a03ebe65d5a41010881e5aceeb Mon Sep 17 00:00:00 2001
From: Xufeng Zhang <xufeng.zhang@windriver.com>
Date: Tue, 28 Jun 2011 16:53:39 +0800
Subject: [PATCH 12/47] t23x driver compile error fixing

The error messages are as below
drivers/crypto/t23x/t23xtest/singledesc.c:70: warning: 'struct semaphore' declared inside parameter list
drivers/crypto/t23x/t23xtest/singledesc.c:70: warning: its scope is only this definition or declaration, which is probably not what you want
drivers/crypto/t23x/t23xtest/singledesc.c: In function 'intRelease':
drivers/crypto/t23x/t23xtest/singledesc.c:72: error: implicit declaration of function 'up'
drivers/crypto/t23x/t23xtest/singledesc.c: In function 'testOneDPD_withInterruptSHA':
drivers/crypto/t23x/t23xtest/singledesc.c:84: error: storage size of 'intlock' isn't known
drivers/crypto/t23x/t23xtest/singledesc.c:87: error: implicit declaration of function 'init_MUTEX_LOCKED'
drivers/crypto/t23x/t23xtest/singledesc.c:131: error: implicit declaration of function 'down_interruptible'
drivers/crypto/t23x/t23xtest/singledesc.c:84: warning: unused variable 'intlock'
drivers/crypto/t23x/t23xtest/singledesc.c: In function 'testOneDPD_withInterruptRND':
drivers/crypto/t23x/t23xtest/singledesc.c:189: error: storage size of 'intlock' isn't known
drivers/crypto/t23x/t23xtest/singledesc.c:196: error: implicit declaration of function 'kmalloc'
drivers/crypto/t23x/t23xtest/singledesc.c:210: error: implicit declaration of function 'kfree'
drivers/crypto/t23x/t23xtest/singledesc.c:189: warning: unused variable 'intlock'
drivers/crypto/t23x/t23xtest/singledesc.c: In function 'testOneDPD_withInterruptRND':
drivers/crypto/t23x/t23xtest/singledesc.c:197: error: implicit declaration of function 'kmalloc'
drivers/crypto/t23x/t23xtest/singledesc.c:211: error: implicit declaration of function 'kfree'
drivers/crypto/t23x/t23xtest/multidesc.c:106: warning: 'struct semaphore' declared inside parameter list
drivers/crypto/t23x/t23xtest/multidesc.c:106: warning: its scope is only this definition or declaration, which is probably not what you want
drivers/crypto/t23x/t23xtest/multidesc.c: In function 'testMultiIntRelease':
drivers/crypto/t23x/t23xtest/multidesc.c:108: error: implicit declaration of function 'up'
drivers/crypto/t23x/t23xtest/multidesc.c: In function 'testMultiDPD_withInterrupt':
drivers/crypto/t23x/t23xtest/multidesc.c:123: error: storage size of 'irqlock' isn't known
drivers/crypto/t23x/t23xtest/multidesc.c:126: error: implicit declaration of function 'init_MUTEX_LOCKED'
drivers/crypto/t23x/t23xtest/multidesc.c:240: error: implicit declaration of function 'down_interruptible'
drivers/crypto/t23x/t23xtest/multidesc.c:123: warning: unused variable 'irqlock'

Extracted from vendor drop QorIQ-NONDPAA-SDK-V1-20110429_ltib.iso
linux-2.6.35-qoriq-t23x-driver-compile-error-fixing.patch.

Signed-off-by: Jin Qing <b24347@freescale.com>
Integrated-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 drivers/crypto/t23x/t23xtest/multidesc.c  |    3 ++-
 drivers/crypto/t23x/t23xtest/singledesc.c |    4 +++-
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/drivers/crypto/t23x/t23xtest/multidesc.c b/drivers/crypto/t23x/t23xtest/multidesc.c
index e9c047f..4a1647a 100644
--- a/drivers/crypto/t23x/t23xtest/multidesc.c
+++ b/drivers/crypto/t23x/t23xtest/multidesc.c
@@ -3,7 +3,7 @@
  *
  * t23x RM testing module - multi-descriptor requests
  *
- * Copyright (c) 2007-2009 Freescale Semiconductor, Inc.
+ * Copyright (c) 2007-2010 Freescale Semiconductor, Inc.
  *
  * All rights reserved.
  *
@@ -48,6 +48,7 @@
 
 #include <linux/mm.h>
 #include <linux/vmalloc.h>
+#include <linux/semaphore.h>
 
 #include "../common/t23.h"
 #include "../common/xwcRMinterface.h"
diff --git a/drivers/crypto/t23x/t23xtest/singledesc.c b/drivers/crypto/t23x/t23xtest/singledesc.c
index 6e87acb..48f9120 100644
--- a/drivers/crypto/t23x/t23xtest/singledesc.c
+++ b/drivers/crypto/t23x/t23xtest/singledesc.c
@@ -3,7 +3,7 @@
  *
  * t23x RM testing module - single descriptor cases
  *
- * Copyright (c) 2007-2009 Freescale Semiconductor, Inc.
+ * Copyright (c) 2007-2010 Freescale Semiconductor, Inc.
  *
  * All rights reserved.
  *
@@ -50,6 +50,8 @@
 #include <linux/mm.h>
 #include <linux/vmalloc.h>
 #include <linux/interrupt.h>
+#include <linux/semaphore.h>
+#include <linux/slab.h>
 
 #include "../common/t23.h"
 #include "../common/xwcRMinterface.h"
-- 
1.7.0.4

