From c4a980e2cbe0d7da4abd2732598bc8c256dc6ad7 Mon Sep 17 00:00:00 2001
From: Qi Hou <qi.hou@windriver.com>
Date: Mon, 16 Jan 2017 12:40:18 +0800
Subject: [PATCH 3/4] i2c: add missing of_node_put in i2c_unregister_device

Refcount of of_node is increased with of_node_get() in of_i2c_register_device().
It must be decreased with of_node_put() in i2c_unregister_device().

Signed-off-by: Qi Hou <qi.hou@windriver.com>
---
 drivers/i2c/i2c-core.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/i2c/i2c-core.c b/drivers/i2c/i2c-core.c
index 16a5318..59d5080 100644
--- a/drivers/i2c/i2c-core.c
+++ b/drivers/i2c/i2c-core.c
@@ -1044,6 +1044,7 @@ EXPORT_SYMBOL_GPL(i2c_new_device);
  */
 void i2c_unregister_device(struct i2c_client *client)
 {
+	of_node_put(client->dev.of_node);
 	device_unregister(&client->dev);
 }
 EXPORT_SYMBOL_GPL(i2c_unregister_device);
-- 
1.7.5.4

