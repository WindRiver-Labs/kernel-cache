From: Jack Tan <jack.tan@windriver.com>
Subject: Fix ptrace.h namespace collsion with glibc.

The following constants:

PTRACE_TRACEME
PTRACE_PEEKTEXT
PTRACE_PEEKDATA
PTRACE_POKETEXT
PTRACE_POKEDATA 
PTRACE_POKEUSER
PTRACE_CONT
PTRACE_KILL
PTRACE_SINGLESTEP
PTRACE_GETREGS
PTRACE_SETREGS 
PTRACE_GETFPREGS
PTRACE_SETFPREGS
PTRACE_ATTACH
PTRACE_DETACH 
PTRACE_GETFPXREGS
PTRACE_SETFPXREGS
PTRACE_SYSCALL
PTRACE_SETOPTIONS
PTRACE_GETEVENTMSG
PTRACE_GETSIGINFO
PTRACE_SETSIGINFO

defined in glibc. 

So we need to make these invisible to user space. Because, if someone
included asm/ptrace.h before sys/ptrace.h there would be a macro 
definition collision which cause a compile-time error.

So, we don't support user applications building against the kernel 
headers directly, but instead our sanitized ones. And on top of that, 
we only really support them building against the glibc ones.

Signed-off-by: Jack Tan <jack.tan@windriver.com>
---

diff --git a/arch/arm/include/asm/ptrace.h b/arch/arm/include/asm/ptrace.h
index b415c0e..0b1473d 100644
--- a/arch/arm/include/asm/ptrace.h
+++ b/arch/arm/include/asm/ptrace.h
@@ -12,10 +12,12 @@
 
 #include <asm/hwcap.h>
 
+#ifdef __KERNEL__
 #define PTRACE_GETREGS		12
 #define PTRACE_SETREGS		13
 #define PTRACE_GETFPREGS	14
 #define PTRACE_SETFPREGS	15
+#endif
 /* PTRACE_ATTACH is 16 */
 /* PTRACE_DETACH is 17 */
 #define PTRACE_GETWMMXREGS	18
diff --git a/include/asm-mips/ptrace.h b/include/asm-mips/ptrace.h
index 786f7e3..97ae5bb 100644
--- a/include/asm-mips/ptrace.h
+++ b/include/asm-mips/ptrace.h
@@ -51,6 +51,7 @@ struct pt_regs {
 #endif /* CONFIG_MIPS_MT_SMTC */
 } __attribute__ ((aligned (8)));
 
+#ifdef __KERNEL__
 /* Arbitrarily choose the same ptrace numbers as used by the Sparc code. */
 #define PTRACE_GETREGS		12
 #define PTRACE_SETREGS		13
@@ -58,6 +59,7 @@ struct pt_regs {
 #define PTRACE_SETFPREGS		15
 /* #define PTRACE_GETFPXREGS		18 */
 /* #define PTRACE_SETFPXREGS		19 */
+#endif
 
 #define PTRACE_OLDSETOPTIONS	21
 
diff --git a/include/asm-x86/ptrace-abi.h b/include/asm-x86/ptrace-abi.h
index 72e7b9d..42aee8a 100644
--- a/include/asm-x86/ptrace-abi.h
+++ b/include/asm-x86/ptrace-abi.h
@@ -58,12 +58,14 @@
 #endif /* !__i386__ */
 
 /* Arbitrarily choose the same ptrace numbers as used by the Sparc code. */
+#ifdef __KERNEL__
 #define PTRACE_GETREGS            12
 #define PTRACE_SETREGS            13
 #define PTRACE_GETFPREGS          14
 #define PTRACE_SETFPREGS          15
 #define PTRACE_GETFPXREGS         18
 #define PTRACE_SETFPXREGS         19
+#endif
 
 #define PTRACE_OLDSETOPTIONS      21
 
diff --git a/include/linux/ptrace.h b/include/linux/ptrace.h
index ea7416c..bbf3ac7 100644
--- a/include/linux/ptrace.h
+++ b/include/linux/ptrace.h
@@ -4,7 +4,7 @@
 /* structs and defines to help the user use the ptrace system call. */
 
 /* has the defines to get at the registers. */
-
+#ifdef __KERNEL__
 #define PTRACE_TRACEME		   0
 #define PTRACE_PEEKTEXT		   1
 #define PTRACE_PEEKDATA		   2
@@ -26,6 +26,7 @@
 #define PTRACE_GETEVENTMSG	0x4201
 #define PTRACE_GETSIGINFO	0x4202
 #define PTRACE_SETSIGINFO	0x4203
+#endif
 
 /* options set using PTRACE_SETOPTIONS */
 #define PTRACE_O_TRACESYSGOOD	0x00000001
