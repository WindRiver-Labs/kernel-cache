From bed4b5d8f718dd6d65d9b3efd2ae282e026938e6 Mon Sep 17 00:00:00 2001
From: yzhu1 <yanjun.zhu@windriver.com>
Date: Mon, 25 Aug 2014 20:22:24 -0700
Subject: [PATCH] sctp: not send SCTP_PEER_ADDR_CHANGE notifications with
 failed probe

commit 78027ced63911229092c345dbac47c385259fe35 upstream

Since the transport has always been in state SCTP_UNCONFIRMED, it
therefore wasn't active before and hasn't been used before, and it
always has been, so it is unnecessary to bug the user with a
notification.

Reported-by: Deepak Khandelwal <khandelwal.deepak.1987@gmail.com>
Suggested-by: Vlad Yasevich <vyasevich@gmail.com>
Suggested-by: Michael Tuexen <tuexen@fh-muenster.de>
Suggested-by: Daniel Borkmann <dborkman@redhat.com>
Signed-off-by: Zhu Yanjun <Yanjun.Zhu@windriver.com>
Signed-off-by: yzhu1 <yanjun.zhu@windriver.com>
---
 net/sctp/associola.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/net/sctp/associola.c b/net/sctp/associola.c
index 62e86d9..9dccc8f 100644
--- a/net/sctp/associola.c
+++ b/net/sctp/associola.c
@@ -875,6 +875,7 @@ void sctp_assoc_control_transport(struct sctp_association *asoc,
 		else {
 			dst_release(transport->dst);
 			transport->dst = NULL;
+			ulp_notify = false;
 		}
 
 		spc_state = SCTP_ADDR_UNREACHABLE;
-- 
1.7.5.4

