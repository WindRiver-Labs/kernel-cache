From 8888bca724447ff7929f16ecd42c6e2010ac549a Mon Sep 17 00:00:00 2001
From: Srikanth Thokala <srikanth.thokala@xilinx.com>
Date: Thu, 11 Jul 2013 12:19:16 +0530
Subject: [PATCH 110/628] dma: xilinx: created common DMA_DEVICE_ID_SHIFT in
 header file

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit 0253dd2d6a2b12d5ec03a6bed688c5ad28dbe1f1

Moved dma device id shift macro to header file and also
renamed VDMA_DEVICE_ID_SHIFT to DMA_DEVICE_ID_SHIFT.

Signed-off-by: Srikanth Thokala <sthokal@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/dma/xilinx/xilinx_axidma.c  |    3 ---
 drivers/dma/xilinx/xilinx_axivdma.c |    5 +----
 include/linux/amba/xilinx_dma.h     |    3 +++
 3 files changed, 4 insertions(+), 7 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axidma.c b/drivers/dma/xilinx/xilinx_axidma.c
index 474eb04..6dca5ea 100644
--- a/drivers/dma/xilinx/xilinx_axidma.c
+++ b/drivers/dma/xilinx/xilinx_axidma.c
@@ -109,9 +109,6 @@
 #define XILINX_DMA_RESET_LOOP		1000000
 #define XILINX_DMA_HALT_LOOP		1000000
 
-/* Device Id in the private structure */
-#define XILINX_DMA_DEVICE_ID_SHIFT	28
-
 /* IO accessors */
 #define DMA_OUT(addr, val)	(iowrite32(val, addr))
 #define DMA_IN(addr)		(ioread32(addr))
diff --git a/drivers/dma/xilinx/xilinx_axivdma.c b/drivers/dma/xilinx/xilinx_axivdma.c
index f1317ed..ef74643 100644
--- a/drivers/dma/xilinx/xilinx_axivdma.c
+++ b/drivers/dma/xilinx/xilinx_axivdma.c
@@ -139,9 +139,6 @@
 #define XILINX_VDMA_RESET_LOOP	1000000
 #define XILINX_VDMA_HALT_LOOP	1000000
 
-/* Device Id in the private structure */
-#define XILINX_VDMA_DEVICE_ID_SHIFT	28
-
 /* IO accessors */
 #define VDMA_OUT(addr, val)	(iowrite32(val, addr))
 #define VDMA_IN(addr)		(ioread32(addr))
@@ -1144,7 +1141,7 @@ static int xilinx_vdma_chan_probe(struct xilinx_vdma_device *xdev,
 	 */
 	chan->private = (chan->direction & 0xFF) |
 		(chan->feature & XILINX_DMA_IP_MASK) |
-		(device_id << XILINX_VDMA_DEVICE_ID_SHIFT);
+		(device_id << XILINX_DMA_DEVICE_ID_SHIFT);
 	chan->common.private = (void *)&(chan->private);
 
 	if (!chan->has_dre)
diff --git a/include/linux/amba/xilinx_dma.h b/include/linux/amba/xilinx_dma.h
index dca98af..72c1544 100644
--- a/include/linux/amba/xilinx_dma.h
+++ b/include/linux/amba/xilinx_dma.h
@@ -39,6 +39,9 @@
 #define XILINX_DMA_IP_VDMA	0x00400000	/* A Video DMA IP */
 #define XILINX_DMA_IP_MASK	0x00700000	/* DMA IP MASK */
 
+/* Device Id in the private structure */
+#define XILINX_DMA_DEVICE_ID_SHIFT	28
+
 /*
  * Device configuration structure
  *
-- 
1.7.5.4

