From da9192d0b7c6da79f9880d60acfd5ae11ba70dd9 Mon Sep 17 00:00:00 2001
From: Zhixiong Chi <Zhixiong.Chi@windriver.com>
Date: Mon, 27 Jun 2016 14:46:24 +0800
Subject: [PATCH] aufs: modify callback function arguments

To keep consistent with kernel new format of inode lock, kernel commit
"aufs: convert inode_sb_list_lock to per-sb" modified the callback
function (au_arraycb_t type) declaration argument as follows:
  -typedef unsigned long long (*au_arraycb_t)(void *array,
  -                             unsigned long long max, void *arg);
  +typedef unsigned long long (*au_arraycb_t)(struct super_block *sb,
  +                             long max, void *arg);
but the patch missed the update of the callback function instances:
au_farray_cb and empty_cb function, so there will be no warning while
building kernel.

Signed-off-by: Zhixiong Chi <Zhixiong.Chi@windriver.com>
---
 fs/aufs/branch.c |    7 +++----
 1 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/fs/aufs/branch.c b/fs/aufs/branch.c
index 0186a76..879e94e 100644
--- a/fs/aufs/branch.c
+++ b/fs/aufs/branch.c
@@ -575,7 +575,7 @@ out:
 
 /* ---------------------------------------------------------------------- */
 
-static unsigned long long au_farray_cb(void *a,
+static unsigned long long au_farray_cb(struct super_block *sb, void *a,
 				       unsigned long long max __maybe_unused,
 				       void *arg)
 {
@@ -583,7 +583,6 @@ static unsigned long long au_farray_cb(void *a,
 	struct file **p, *f;
 	struct au_sphlhead *files;
 	struct au_finfo *finfo;
-	struct super_block *sb = arg;
 
 	n = 0;
 	p = a;
@@ -1008,8 +1007,8 @@ static void au_br_do_del(struct super_block *sb, aufs_bindex_t bindex,
 	au_br_do_free(br);
 }
 
-static unsigned long long empty_cb(void *array, unsigned long long max,
-				   void *arg)
+static unsigned long long empty_cb(struct super_block *sb, void *array,
+				   unsigned long long max, void *arg)
 {
 	return max;
 }
-- 
1.7.5.4

