From 15cfb6d7d53fe8a9d207f219cd43ee9e0d7f5592 Mon Sep 17 00:00:00 2001
From: Srikanth Thokala <srikanth.thokala@xilinx.com>
Date: Fri, 20 Sep 2013 12:29:46 +0530
Subject: [PATCH 152/628] cdma: xilinx: Return with proper error value in
 cdma_reset()

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit 7f75285a2135d6ebbaae10c433be15f74b80538b

This patch returns a proper error value in cdma_reset()

Signed-off-by: Srikanth Thokala <sthokal@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/dma/xilinx/xilinx_axicdma.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axicdma.c b/drivers/dma/xilinx/xilinx_axicdma.c
index 0d2ebb2..387e76a 100644
--- a/drivers/dma/xilinx/xilinx_axicdma.c
+++ b/drivers/dma/xilinx/xilinx_axicdma.c
@@ -445,7 +445,7 @@ static int cdma_reset(struct xilinx_cdma_chan *chan)
 	if (!loop) {
 		dev_err(chan->dev, "reset timeout, cr %x, sr %x\n",
 			cdma_read(&chan->regs->cr), cdma_read(&chan->regs->sr));
-		return 1;
+		return -EBUSY;
 	}
 
 	/* For Axi CDMA, always do sg transfers if sg mode is built in */
-- 
1.7.5.4

