From 31e0337341206cc6c2786a0c5bccf54b683fdf9d Mon Sep 17 00:00:00 2001
From: Srikanth Thokala <srikanth.thokala@xilinx.com>
Date: Wed, 18 Sep 2013 17:27:39 +0530
Subject: [PATCH 130/628] axidma: xilinx: Return with proper error value in
 dma_reset()

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit 09795b4e78bac80446b1208337a355a4a446b7a3

This patch returns a proper error value in dma_reset()

Signed-off-by: Srikanth Thokala <sthokal@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/dma/xilinx/xilinx_axidma.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/dma/xilinx/xilinx_axidma.c b/drivers/dma/xilinx/xilinx_axidma.c
index 616026a..17685a5 100644
--- a/drivers/dma/xilinx/xilinx_axidma.c
+++ b/drivers/dma/xilinx/xilinx_axidma.c
@@ -532,7 +532,7 @@ static int dma_reset(struct xilinx_dma_chan *chan)
 	if (!loop) {
 		dev_err(chan->dev, "reset timeout, cr %x, sr %x\n",
 			dma_read(&chan->regs->cr), dma_read(&chan->regs->sr));
-		return 1;
+		return -EBUSY;
 	}
 
 	return 0;
-- 
1.7.5.4

