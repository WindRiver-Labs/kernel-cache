From bd32ae2f477daeb587d1dc2f5882bce62671c95e Mon Sep 17 00:00:00 2001
From: Jibin Xu <jibin.xu@windriver.com>
Date: Wed, 29 Aug 2018 14:34:47 +0800
Subject: [PATCH 1/2] f2fs: add sbi in f2fs_io_info

Add sbi in f2fs_io_info and init it.
The other patch needs it.

Refer to https://git.kernel.org/pub/scm/linux/kernel/git/chao/linux.git
commit: 05ca3632e5a73b493b27ec3e2a337885563abff0

Signed-off-by: Jibin Xu <jibin.xu@windriver.com>
---
 fs/f2fs/f2fs.h   |    1 +
 fs/f2fs/inline.c |    1 +
 2 files changed, 2 insertions(+)

diff --git a/fs/f2fs/f2fs.h b/fs/f2fs/f2fs.h
index 2b23313..c213b26 100644
--- a/fs/f2fs/f2fs.h
+++ b/fs/f2fs/f2fs.h
@@ -571,6 +571,7 @@ enum page_type {
 };
 
 struct f2fs_io_info {
+	struct f2fs_sb_info *sbi;   /* f2fs_sb_info pointer */
 	enum page_type type;	/* contains DATA/NODE/META/META_FLUSH */
 	int rw;			/* contains R/RS/W/WS with REQ_META/REQ_PRIO */
 	block_t blk_addr;	/* block address to be written */
diff --git a/fs/f2fs/inline.c b/fs/f2fs/inline.c
index 8140e4f..b9d48a8 100644
--- a/fs/f2fs/inline.c
+++ b/fs/f2fs/inline.c
@@ -95,6 +95,7 @@ int f2fs_convert_inline_page(struct dnode_of_data *dn, struct page *page)
 {
 	void *src_addr, *dst_addr;
 	struct f2fs_io_info fio = {
+		.sbi = F2FS_I_SB(dn->inode),
 		.type = DATA,
 		.rw = WRITE_SYNC | REQ_PRIO,
 	};
-- 
1.7.9.5

