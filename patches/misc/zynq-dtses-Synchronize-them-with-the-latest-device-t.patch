From e736b4f70bb376928eda5592b4a602e853da1afb Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Fri, 23 Aug 2013 16:35:42 +0200
Subject: [PATCH 624/628] zynq: dtses: Synchronize them with the latest
 device-tree BSP

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit 21bf7e7b2082f5180c582d3abeafe56274fba5c1

Device-tree BSP top commit:
"ipi: axi_dma: Vivado supports to setup loopback just by one bus"
(sha1: d90a6eb8a4b5fe2c5c2e30250b36200db136fc2e)

Changes:
Add bus-handle to cpu node
Add interrupt-handle to cpu node
Remove unused #cpus property
Specify num_cpus and num_interrupts in GIC
Setup fclk-enable property
Fix compatible property for ps7-can

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 arch/arm/boot/dts/zynq-zc706.dts |    9 ++++++++-
 1 files changed, 8 insertions(+), 1 deletions(-)

diff --git a/arch/arm/boot/dts/zynq-zc706.dts b/arch/arm/boot/dts/zynq-zc706.dts
index c11ff44..1283577 100644
--- a/arch/arm/boot/dts/zynq-zc706.dts
+++ b/arch/arm/boot/dts/zynq-zc706.dts
@@ -45,24 +45,27 @@
 	} ;
 	cpus {
 		#address-cells = <1>;
-		#cpus = <0x2>;
 		#size-cells = <0>;
 		ps7_cortexa9_0: cpu@0 {
+			bus-handle = <&ps7_axi_interconnect_0>;
 			compatible = "arm,cortex-a9";
 			d-cache-line-size = <0x20>;
 			d-cache-size = <0x8000>;
 			device_type = "cpu";
 			i-cache-line-size = <0x20>;
 			i-cache-size = <0x8000>;
+			interrupt-handle = <&ps7_scugic_0>;
 			reg = <0x0>;
 		} ;
 		ps7_cortexa9_1: cpu@1 {
+			bus-handle = <&ps7_axi_interconnect_0>;
 			compatible = "arm,cortex-a9";
 			d-cache-line-size = <0x20>;
 			d-cache-size = <0x8000>;
 			device_type = "cpu";
 			i-cache-line-size = <0x20>;
 			i-cache-size = <0x8000>;
+			interrupt-handle = <&ps7_scugic_0>;
 			reg = <0x1>;
 		} ;
 	} ;
@@ -221,6 +224,7 @@
 					};
 				};
 
+
 				i2c@7 {
 					#address-cells = <1>;
 					#size-cells = <0>;
@@ -307,6 +311,8 @@
 			#size-cells = <1>;
 			compatible = "xlnx,ps7-scugic-1.00.a", "arm,cortex-a9-gic", "arm,gic";
 			interrupt-controller ;
+			num_cpus = <2>;
+			num_interrupts = <96>;
 			reg = <0xf8f01000 0x1000>, <0xf8f00100 0x100>;
 		} ;
 		ps7_scutimer_0: ps7-scutimer@f8f00600 {
@@ -355,6 +361,7 @@
 						"uart0_aper", "uart1_aper", "gpio_aper", "lqspi_aper", "smc_aper",
 						"swdt", "dbg_trc", "dbg_apb";
 					compatible = "xlnx,ps7-clkc";
+					fclk-enable = <0xf>;
 					ps-clk-frequency = <33333333>;
 				} ;
 			} ;
-- 
1.7.5.4

