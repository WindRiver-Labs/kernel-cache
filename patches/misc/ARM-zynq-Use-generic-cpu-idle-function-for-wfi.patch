From 89b22d82fa95bf9a4db0a33f03f944075c72e743 Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Tue, 28 May 2013 07:46:23 +0200
Subject: [PATCH 052/628] ARM: zynq: Use generic cpu idle function for wfi

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit 54c2d9863444fd29cc7a36a923dfd1bbc432f7f1

Use cpu_do_idle for entering the wfi mode.
Based on Sanjay Singh Rawat patch in hotplug.c.

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 arch/arm/mach-zynq/pm.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-zynq/pm.c b/arch/arm/mach-zynq/pm.c
index 95c9ca6..e8dc97e 100644
--- a/arch/arm/mach-zynq/pm.c
+++ b/arch/arm/mach-zynq/pm.c
@@ -144,7 +144,7 @@ static int zynq_pm_suspend(unsigned long arg)
 			pr_warn("DDR self refresh failed.\n");
 	} else {
 		WARN_ONCE(1, "DRAM self-refresh not available\n");
-		wfi();
+		cpu_do_idle();
 	}
 
 	if (!IS_ERR(cpupll))
-- 
1.7.5.4

