From 6b6ec4d0b37e2f13ac082624b72523e68f18fe11 Mon Sep 17 00:00:00 2001
From: Mathias Krause <minipli@googlemail.com>
Date: Fri, 7 Mar 2014 15:46:47 +0800
Subject: [PATCH] isofs: avoid info leak on export

commit fe685aabf7c8c9f138e5ea900954d295bf229175 upstream

For type 1 the parent_offset member in struct isofs_fid gets copied
uninitialized to userland. Fix this by initializing it to 0.

Signed-off-by: Mathias Krause <minipli@googlemail.com>
Signed-off-by: Jan Kara <jack@suse.cz>
Signed-off-by: Xufeng Zhang <xufeng.zhang@windriver.com>
---
 fs/isofs/export.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/fs/isofs/export.c b/fs/isofs/export.c
index ed752cb..344aa60 100644
--- a/fs/isofs/export.c
+++ b/fs/isofs/export.c
@@ -131,6 +131,7 @@ isofs_export_encode_fh(struct dentry *dentry,
 	len = 3;
 	fh32[0] = ei->i_iget5_block;
  	fh16[2] = (__u16)ei->i_iget5_offset;  /* fh16 [sic] */
+	fh16[3] = 0;  /* avoid leaking uninitialized data */
 	fh32[2] = inode->i_generation;
 	if (connectable && !S_ISDIR(inode->i_mode)) {
 		struct inode *parent;
-- 
1.7.0

