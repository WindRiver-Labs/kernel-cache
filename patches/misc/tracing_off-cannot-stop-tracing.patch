From 0b76d307dc2b0dfcef027c22955fe01f558281f6 Mon Sep 17 00:00:00 2001
From: Jian Liu <jian.liu@windriver.com>
Date: Tue, 20 May 2014 11:34:37 +0800
Subject: [PATCH] tracing_off cannot stop tracing

commit f2bf1f6f5f89d031245067512449fc889b2f4bb2 upstream

The API 'tracing_off' in kernel/trace/trace.c cannot stop
tracing when it is called. The reason is that 'tracing_off'
call 'ring_buffer_record_on' incorrectly, it should call
'ring_buffer_record_off'.

Signed-off-by: Steven Rostedt <rostedt@goodmis.org>
Signed-off-by: Jian Liu <jian.liu@windriver.com>
---
 kernel/trace/trace.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/kernel/trace/trace.c b/kernel/trace/trace.c
index a55d2e5..910e2d0 100644
--- a/kernel/trace/trace.c
+++ b/kernel/trace/trace.c
@@ -365,7 +365,7 @@ EXPORT_SYMBOL_GPL(tracing_on);
 void tracing_off(void)
 {
 	if (global_trace.buffer)
-		ring_buffer_record_on(global_trace.buffer);
+		ring_buffer_record_off(global_trace.buffer);
 	/*
 	 * This flag is only looked at when buffers haven't been
 	 * allocated yet. We don't really care about the race
-- 
1.7.0

