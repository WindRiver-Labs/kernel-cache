From 875ec2c17d55048107b397c19bd19292a5554bac Mon Sep 17 00:00:00 2001
From: Rui Wang <rui.wang@windriver.com>
Date: Mon, 13 Aug 2018 09:57:32 +0800
Subject: [PATCH] x86/fpu: fix warning of unused check_fpu function

if CONFIG_X86_32 is not set, and because check_fpu is a static
function, compiler will consider that it will never be used,
then a warning message about unused-function will appear. So
add the same macro to judge if it should be compiled into kernel.

Signed-off-by: Rui Wang <rui.wang@windriver.com>
---
 arch/x86/kernel/cpu/bugs.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/arch/x86/kernel/cpu/bugs.c b/arch/x86/kernel/cpu/bugs.c
index d250c9ea78cb..df3d6eb99f09 100644
--- a/arch/x86/kernel/cpu/bugs.c
+++ b/arch/x86/kernel/cpu/bugs.c
@@ -27,6 +27,7 @@
 #include <asm/cacheflush.h>
 #include <asm/intel-family.h>
 
+#ifdef CONFIG_X86_32
 static double __initdata x = 4195835.0;
 static double __initdata y = 3145727.0;
 
@@ -72,6 +73,7 @@ static void __init check_fpu(void)
 		pr_warn("Hmm, FPU with FDIV bug\n");
 	}
 }
+#endif
 
 static void __init spectre_v2_select_mitigation(void);
 static void __init ssb_select_mitigation(void);
-- 
2.17.1

