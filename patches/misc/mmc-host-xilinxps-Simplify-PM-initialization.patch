From 93b3bcc2fc4b8719d185b8ba2aefc7444285f372 Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Tue, 10 Sep 2013 16:14:23 +0200
Subject: [PATCH 074/628] mmc: host: xilinxps: Simplify PM initialization

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit 085157e92870cf037d77194d4506bce664b760a3

Use SIMPLE_DEV_PM_OPS macro.

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/mmc/host/sdhci-of-xilinxps.c |   13 ++++---------
 1 files changed, 4 insertions(+), 9 deletions(-)

diff --git a/drivers/mmc/host/sdhci-of-xilinxps.c b/drivers/mmc/host/sdhci-of-xilinxps.c
index 5e8bf6a..f3a590a 100644
--- a/drivers/mmc/host/sdhci-of-xilinxps.c
+++ b/drivers/mmc/host/sdhci-of-xilinxps.c
@@ -130,16 +130,11 @@ static int xsdhcips_resume(struct device *dev)
 
 	return sdhci_resume_host(host);
 }
-
-static const struct dev_pm_ops xsdhcips_dev_pm_ops = {
-	SET_SYSTEM_SLEEP_PM_OPS(xsdhcips_suspend, xsdhcips_resume)
-};
-#define XSDHCIPS_PM	(&xsdhcips_dev_pm_ops)
-
-#else /* ! CONFIG_PM_SLEEP */
-#define XSDHCIPS_PM	NULL
 #endif /* ! CONFIG_PM_SLEEP */
 
+static SIMPLE_DEV_PM_OPS(xsdhcips_dev_pm_ops, xsdhcips_suspend,
+			 xsdhcips_resume);
+
 static int sdhci_zynq_probe(struct platform_device *pdev)
 {
 	int ret;
@@ -232,7 +227,7 @@ static struct platform_driver sdhci_zynq_driver = {
 		.name = "sdhci-zynq",
 		.owner = THIS_MODULE,
 		.of_match_table = sdhci_zynq_of_match,
-		.pm = XSDHCIPS_PM,
+		.pm = &xsdhcips_dev_pm_ops,
 	},
 	.probe = sdhci_zynq_probe,
 	.remove = sdhci_zynq_remove,
-- 
1.7.5.4

