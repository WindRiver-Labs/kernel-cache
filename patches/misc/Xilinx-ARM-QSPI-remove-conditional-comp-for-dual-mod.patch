From 45332769c187e72663e9e79f8ea2c8ce17b2c5cb Mon Sep 17 00:00:00 2001
From: John Linn <john.linn@xilinx.com>
Date: Tue, 31 Jul 2012 16:15:04 -0700
Subject: [PATCH 214/628] Xilinx: ARM: QSPI: remove conditional comp for dual
 mode

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit b559bc0b9d9cd74534dce3b723eec72f07c146a9

It now no longer has any kernel configuration needed for
dual mode support as it's being pulled from the device
tree only.

Signed-off-by: John Linn <john.linn@xilinx.com>
[cherry picked the xilinx qspi driver modification only]
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/spi/Kconfig          |   10 ----------
 drivers/spi/spi-xilinx-qps.c |    2 --
 2 files changed, 0 insertions(+), 12 deletions(-)

diff --git a/drivers/spi/Kconfig b/drivers/spi/Kconfig
index 96cc31f..09b54a1 100644
--- a/drivers/spi/Kconfig
+++ b/drivers/spi/Kconfig
@@ -486,16 +486,6 @@ config SPI_XILINX_PS_QSPI
 	help
 	  This selects the PS Quad SPI controller master driver from the Xilinx.
 
-config XILINX_PS_QSPI_USE_DUAL_FLASH
-	bool "Use dual flash memories with seperate QSPI buses"
-	depends on SPI_XILINX_PS_QSPI
-	default y
-	help
-	  This option enables two SPI flash memories operating in parallel mode.
-	  This increases the maximum addressable QSPI flash memory from 16 MB
-	  (24-bit addressing) to 32 MB (25-bit addressing), and the throughput
-	  by a factor of 2.
-
 config SPI_XILINX_PS_SPI
 	tristate "Xilinx PS SPI controller"
 	depends on SPI_MASTER && EXPERIMENTAL
diff --git a/drivers/spi/spi-xilinx-qps.c b/drivers/spi/spi-xilinx-qps.c
index 662b0ca..5167e30 100644
--- a/drivers/spi/spi-xilinx-qps.c
+++ b/drivers/spi/spi-xilinx-qps.c
@@ -988,8 +988,6 @@ static int __devinit xqspips_probe(struct platform_device *dev)
 		dev_warn(&dev->dev, "couldn't determine configuration info "
 			 "about dual memories. defaulting to single memory\n");
 	}
-#elif defined CONFIG_XILINX_PS_QSPI_USE_DUAL_FLASH
-	xqspi->is_dual = 1;
 #endif
 
 	/* QSPI controller initializations */
-- 
1.7.5.4

