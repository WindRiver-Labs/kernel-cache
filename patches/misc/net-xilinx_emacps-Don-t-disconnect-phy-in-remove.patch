From 7cd49f44773773bad0c2b51198967f45dbe82eb3 Mon Sep 17 00:00:00 2001
From: Peter Crosthwaite <peter.crosthwaite@xilinx.com>
Date: Tue, 28 May 2013 12:13:34 +1000
Subject: [PATCH 392/628] net: xilinx_emacps: Don't disconnect phy in remove

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit ce863da15652d14ae00fbed461d0a3c73e5d00c4

The phy is always connected in xemacps_open() so it should only
disconnect it in its cleanup counterpart xemapcs_close(). Remove
the extraneous phy_disconnect() in xemacps_remove accordingly.

Reported-by: Davor Joja <davorjoja@logicbricks.com>
Signed-off-by: Peter Crosthwaite <peter.crosthwaite@xilinx.com>
Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/net/ethernet/xilinx/xilinx_emacps.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/xilinx/xilinx_emacps.c b/drivers/net/ethernet/xilinx/xilinx_emacps.c
index 3a223d6..ceb0904 100644
--- a/drivers/net/ethernet/xilinx/xilinx_emacps.c
+++ b/drivers/net/ethernet/xilinx/xilinx_emacps.c
@@ -2765,8 +2765,6 @@ static int __exit xemacps_remove(struct platform_device *pdev)
 
 	if (ndev) {
 		lp = netdev_priv(ndev);
-		if (lp->phy_dev)
-			phy_disconnect(lp->phy_dev);
 
 		mdiobus_unregister(lp->mii_bus);
 		kfree(lp->mii_bus->irq);
-- 
1.7.5.4

