From bd648da8839e85599497ba9a6d9d937789a8b0e6 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Wed, 15 Sep 2010 23:30:00 -0700
Subject: [PATCH] crypto: fix missed kfree for crypto_req

Insert ablkcipher_request_free to free crypto_req after done.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 crypto/ocf/cryptosoft.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/crypto/ocf/cryptosoft.c b/crypto/ocf/cryptosoft.c
index aac0e8f..e732b3b 100644
--- a/crypto/ocf/cryptosoft.c
+++ b/crypto/ocf/cryptosoft.c
@@ -844,6 +844,7 @@ static void swcr_process_req(struct swcr_req *req)
 		case 0:
 			dprintk("crypto OP %s %d\n", ret ? "failed" : "success", ret);
 			crp->crp_etype = ret;
+			ablkcipher_request_free(req->crypto_req);
 			goto done;
 		}
 		} break;
-- 
1.6.5.2

