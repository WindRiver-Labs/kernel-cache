From 1ca2fbbef3454589e7e0b13f4e6b5db4b6d5cb20 Mon Sep 17 00:00:00 2001
From: Michal Simek <michal.simek@xilinx.com>
Date: Mon, 8 Jul 2013 15:43:53 +0200
Subject: [PATCH 252/628] spi: xilinx-ps: Remove platform_set_drvdata setup to
 NULL

git://github.com/Xilinx/linux-xlnx.git xilinx-v14.7
commit 2b05150309c87e4063dec77a059ebe53dceae413

It is done automatically.

Signed-off-by: Michal Simek <michal.simek@xilinx.com>
Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/spi/spi-xilinx-ps.c |    4 ----
 1 files changed, 0 insertions(+), 4 deletions(-)

diff --git a/drivers/spi/spi-xilinx-ps.c b/drivers/spi/spi-xilinx-ps.c
index 80d5442..40d2464 100644
--- a/drivers/spi/spi-xilinx-ps.c
+++ b/drivers/spi/spi-xilinx-ps.c
@@ -820,7 +820,6 @@ unmap_io:
 release_mem:
 	release_mem_region(r->start, r->end - r->start + 1);
 put_master:
-	platform_set_drvdata(dev, NULL);
 	spi_master_put(master);
 	kfree(master);
 	return ret;
@@ -862,9 +861,6 @@ static int xspips_remove(struct platform_device *pdev)
 	spi_unregister_master(master);
 	spi_master_put(master);
 
-	/* Prevent double remove */
-	platform_set_drvdata(pdev, NULL);
-
 	clk_notifier_unregister(xspi->devclk, &xspi->clk_rate_change_nb);
 	clk_disable_unprepare(xspi->devclk);
 	clk_disable_unprepare(xspi->aperclk);
-- 
1.7.5.4

