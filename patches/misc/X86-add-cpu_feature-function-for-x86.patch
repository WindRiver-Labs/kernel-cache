From 50d584912aa55307595eb31a7524600c529640d6 Mon Sep 17 00:00:00 2001
From: Jianchuan Wang <jianchuan.wang@windriver.com>
Date: Fri, 10 Oct 2014 15:53:22 +0800
Subject: [PATCH] X86: add cpu_feature function for x86

When cpu feature based module autoloading is enabled, the following
build error is triggered in all x86 builds:

 include/linux/cpufeature.h:47:15:
 error: implicit declaration of function 'cpu_feature'
 [-Werror=implicit-function-declaration]

To fix this issue, we can define cpu_feature in a similar manner as
ARM64 in commit 64acd011a12.

Signed-off-by: Jianchuan Wang <jianchuan.wang@windriver.com>
---
 arch/x86/include/asm/cpufeature.h | 1 +
 1 file changed, 1 insertion(+)

diff --git a/arch/x86/include/asm/cpufeature.h b/arch/x86/include/asm/cpufeature.h
index d5e5a3b..803f3b3 100644
--- a/arch/x86/include/asm/cpufeature.h
+++ b/arch/x86/include/asm/cpufeature.h
@@ -547,6 +547,7 @@ static __always_inline __pure bool _static_cpu_has_safe(u16 bit)
 
 #define MAX_CPU_FEATURES	(NCAPINTS * 32)
 #define cpu_have_feature	boot_cpu_has
+#define cpu_feature(x) 		ilog2(X86_FEATURE_ ## x) 
 
 #define CPU_FEATURE_TYPEFMT	"x86,ven%04Xfam%04Xmod%04X"
 #define CPU_FEATURE_TYPEVAL	boot_cpu_data.x86_vendor, boot_cpu_data.x86, \
-- 
2.0.2

