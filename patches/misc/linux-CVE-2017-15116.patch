From cfe10896a6e4927697fad835300ea199f2775dc3 Mon Sep 17 00:00:00 2001
From: lwang1 <li.wang@windriver.com>
Date: Tue, 19 Dec 2017 13:51:39 +0800
Subject: [PATCH] linux: CVE-2017-15116

the patch comes from:
https://bugzilla.redhat.com/show_bug.cgi?id=1514609

The simple fix is to put a check in rngapi_reset checking for
a slen of 0 then setting seed to null.

Signed-off-by: lwang1 <li.wang@windriver.com>
---
 crypto/rng.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/crypto/rng.c b/crypto/rng.c
index e0a25c2..12b3a7e 100644
--- a/crypto/rng.c
+++ b/crypto/rng.c
@@ -34,6 +34,9 @@ static int rngapi_reset(struct crypto_rng *tfm, u8 *seed, unsigned int slen)
 	u8 *buf = NULL;
 	int err;
 
+	if (slen == 0)
+		seed = NULL;
+
 	if (!seed && slen) {
 		buf = kmalloc(slen, GFP_KERNEL);
 		if (!buf)
-- 
1.7.5.4

