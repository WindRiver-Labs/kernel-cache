From dee24aef27a435c190628ff91971783f73b8029e Mon Sep 17 00:00:00 2001
From: Liu Haitao <haitao.liu@windriver.com>
Date: Thu, 30 Nov 2017 17:44:55 +0800
Subject: [PATCH] KEY: change ACCESS_ONCE_RW to ACCESS_ONCE

When compile the kernel of standard branch, the following error would be reported.

  """

    linux/security/keys/key.c:418:5: error: implicit declaration of function 'ACCESS_ONCE_RW'

  """
The macrro ,ACCESS_ONCE_RW, has not been implemented at standard branch of WRL5.

So change it to ACCESS_ONCE.

Signed-off-by: Liu Haitao <haitao.liu@windriver.com>
---
 security/keys/key.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/security/keys/key.c b/security/keys/key.c
index 68fee94..75f165c 100644
--- a/security/keys/key.c
+++ b/security/keys/key.c
@@ -415,7 +415,7 @@ static void mark_key_instantiated(struct key *key, int reject_error)
 	 */
     int value =  reject_error < 0 ? reject_error : KEY_IS_POSITIVE;
     smp_mb();
-    ACCESS_ONCE_RW(key->state) = value;
+    ACCESS_ONCE(key->state) = value;
 }
 
 /*
-- 
1.7.5.4

