From 4df9ed6ca237ba4e90bddd2e52cfc407cf450cb4 Mon Sep 17 00:00:00 2001
From: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
Date: Wed, 1 Jun 2011 18:59:45 -0400
Subject: [PATCH 163/540] Fix syscall tracing argument input

The probe code was jumping over the argument read.

Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
---
 .../lttng2/instrumentation/events/lttng-module/syscalls.h     | 11 +++++++----
 1 file changed, 7 insertions(+), 4 deletions(-)

diff --git a/drivers/staging/lttng2/instrumentation/events/lttng-module/syscalls.h b/drivers/staging/lttng2/instrumentation/events/lttng-module/syscalls.h
index 182be76..a2bb956 100644
--- a/drivers/staging/lttng2/instrumentation/events/lttng-module/syscalls.h
+++ b/drivers/staging/lttng2/instrumentation/events/lttng-module/syscalls.h
@@ -31,10 +31,13 @@ TRACE_EVENT(sys_enter,
 	TP_fast_assign(
 		tp_assign(id, id)
 		{
-			unsigned long args_copy[6];
-
-			syscall_get_arguments(current, regs, 0, 6, args_copy);
-			tp_memcpy(args, args_copy, sizeof(args_copy));
+			tp_memcpy(args,
+				({
+					unsigned long args_copy[6];
+					syscall_get_arguments(current, regs,
+							0, 6, args_copy);
+					args_copy;
+				}), 6 * sizeof(unsigned long));
 		}
 	),
 
-- 
1.8.4.93.g57e4c17

