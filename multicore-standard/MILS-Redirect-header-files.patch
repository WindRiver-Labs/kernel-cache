From fdd8e7ec2b176234842f17716ba83dc8bf24d311 Mon Sep 17 00:00:00 2001
From: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
Date: Fri, 19 Feb 2010 08:15:37 -0500
Subject: [PATCH] [MILS] Redirect header files

There are significant differences between the SK(Separation Kernel) /
MILS and the standard hypervisor.  Simply redirect header files
to the correct versions.  This keeps the MILS work separate and
distinct.

Signed-off-by: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
---
 arch/powerpc/include/asm/arch_vbi.h |    5 ++++-
 include/vbi/syscall.h               |    5 ++++-
 include/vbi/vdk_interface.h         |    2 +-
 3 files changed, 9 insertions(+), 3 deletions(-)

diff --git a/arch/powerpc/include/asm/arch_vbi.h b/arch/powerpc/include/asm/arch_vbi.h
index 4fbc504..738eb53 100644
--- a/arch/powerpc/include/asm/arch_vbi.h
+++ b/arch/powerpc/include/asm/arch_vbi.h
@@ -13,6 +13,9 @@
  *
  */
 
+#ifdef CONFIG_WRHV_MILS
+#include <vbi/vdk_syscalls.h>
+#else
 #ifndef _ASM_ARCH_VBI_H
 #define _ASM_ARCH_VBI_H
 
@@ -657,5 +660,5 @@ endIntVcoreLock:
 	lwz reg, LO(wr_vb_status)(reg)
 
 #endif /*_ASMLANGUAGE */
-
 #endif /* _ASM_ARCH_VBI_H */
+#endif /* WRHV_MILS */
diff --git a/include/vbi/syscall.h b/include/vbi/syscall.h
index ce72393..a697305 100644
--- a/include/vbi/syscall.h
+++ b/include/vbi/syscall.h
@@ -15,8 +15,10 @@
  */
 
 #ifndef _VBI_SYSCALL_H
+#ifdef CONFIG_WRHV_MILS
+#include <vbi/vdk_syscalls.h>
+#else
 #define _VBI_SYSCALL_H
-
 #include <linux/linkage.h>
 #include <vbi/types.h>
 #include <vbi/arch.h>
@@ -161,3 +163,4 @@ extern asmlinkage int32_t vbi_vb_write_reg(VBI_HREG_SET *regCtl,
 
 #endif	/* _ASMLANGUAGE */
 #endif  /* _VBI_SYSCALL_H */
+#endif  /* WRHV_MILS */
diff --git a/include/vbi/vdk_interface.h b/include/vbi/vdk_interface.h
index 33d29b5..3c2dc47 100644
--- a/include/vbi/vdk_interface.h
+++ b/include/vbi/vdk_interface.h
@@ -15,7 +15,7 @@
  */
 
 
-#if !defined(_VDK_INTERFACE_H) && defined(CONFIG_WRHV_MILS)
+#ifndef _VDK_INTERFACE_H
 #define _VDK_INTERFACE_H
 
 #include <linux/linkage.h>
-- 
1.7.0

