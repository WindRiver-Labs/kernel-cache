From 993f1f26eacdb0a6f816b3948109fb85f0b5bd91 Mon Sep 17 00:00:00 2001
From: Weiwei Wang <weiwei.wang@windriver.com>
Date: Mon, 19 Oct 2009 10:21:49 +0800
Subject: [PATCH 3/4] x86: fix ipi never be ack'ed issue

On Sept 25th+ hypervisor, our guest os ipi direction
doesn't mark as input int, int direction sanity test
will fail and no real ack will be issue. so delete
the sanity test here.

Signed-off-by: Weiwei Wang <weiwei.wang@windriver.com>
---
 kernel/vbiVioApic.c |    8 --------
 1 files changed, 0 insertions(+), 8 deletions(-)

diff --git a/kernel/vbiVioApic.c b/kernel/vbiVioApic.c
index 8a50ae4..7f74919 100644
--- a/kernel/vbiVioApic.c
+++ b/kernel/vbiVioApic.c
@@ -440,19 +440,11 @@ vbiStatus_t vbiVioapicIntAck
     vbiIrq_t    irq   /* table entry to modify (0-23) */
     )
     {
-    VB_CONFIG * config = VBI_CONFIG_ADDR_GET();
-    VB_INT_INFO * info = config->interruptConfiguration;
-
     /* check argument */
 
     if (irq > VIOAPIC_MAX_REDTABLE_ENTRIES-1)
         return VBI_VIOAPIC_IRQ_OUTBOUND;
 
-    /* sanity test on irq direction */
-
-    if (info[irq].intDirection != VB_INPUT_INT)
-	return VBI_VIOAPIC_IRQ_INVALID_DIR;
-
     return vbiIoapicOp (VBI_IOAPICIOCTL_EOI, irq, 0, 0);
     }
 
-- 
1.6.3.3

