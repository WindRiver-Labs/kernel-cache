From 5225fa7ae74c5b733605914baf36109cc4a35afb Mon Sep 17 00:00:00 2001
From: Paul Gortmaker <paul.gortmaker@windriver.com>
Date: Tue, 20 Oct 2009 18:24:32 -0400
Subject: [PATCH 4/8] vbi: make remaining includes independent of CONFIG_WRHV

The current include layout was added conditional on WRHV,
(with quoted includes) and the original reference implementation
includes were left as they were.  This makes the in-use
includes the default (without the CONFIG_WRHV switch) and
deletes the old reference implementation includes.

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 arch/powerpc/kernel/vbi/show.c     |    5 -----
 arch/powerpc/kernel/vbi/syscalls.S |   10 ++--------
 arch/x86/kernel/vbi/syscalls.S     |    6 ------
 include/asm-x86/reg_vbi.h          |    5 -----
 kernel/vbi/io_apic.c               |    5 -----
 kernel/vbi/show.c                  |    4 ----
 6 files changed, 2 insertions(+), 33 deletions(-)

diff --git a/arch/powerpc/kernel/vbi/show.c b/arch/powerpc/kernel/vbi/show.c
index 273bb87..10d3d5f 100644
--- a/arch/powerpc/kernel/vbi/show.c
+++ b/arch/powerpc/kernel/vbi/show.c
@@ -14,13 +14,8 @@
  *
  */
 
-#ifdef CONFIG_WRHV
 #include <linux/kernel.h>
 #include <vbi/vbi.h>
-#define kprintf printk
-#else
-#include <vbi.h>
-#endif
 
 /*******************************************************************************
 *
diff --git a/arch/powerpc/kernel/vbi/syscalls.S b/arch/powerpc/kernel/vbi/syscalls.S
index 2209aaf..328d9e4 100644
--- a/arch/powerpc/kernel/vbi/syscalls.S
+++ b/arch/powerpc/kernel/vbi/syscalls.S
@@ -16,13 +16,8 @@
 
 #define _ASMLANGUAGE
 
-#ifdef CONFIG_WRHV
 #include <vbi/vbi.h>
 #include <asm/vbi.h>
-#else
-#include <vbi.h>
-#include <asm.h>
-#endif /* CONFIG_WRHV */
 
 #define HCALL sc
 
@@ -203,7 +198,7 @@ FUNC_END(vbiVbSuspend)
 *
 * A valid core number: Reset the specified core that exist within the Virtual
 * Board.
-*\me
+*
 *
 * The third argument argument passed to this function specifies options that are
 * applicable only when the second argument is VBI_VB_CORES_ALL. The options
@@ -211,11 +206,10 @@ FUNC_END(vbiVbSuspend)
 * one of the following or a combination:
 *
 *
-*
 * VBI_VBMGMT_RESET_DOWNLOAD: Reset the cores and reload the executable images
 *
 * VBI_VBMGMT_RESET_AND_START_CORE0: Reset and start core0 within the VB
-*\me
+*
 *
 *
 * IMPORTANT:
diff --git a/arch/x86/kernel/vbi/syscalls.S b/arch/x86/kernel/vbi/syscalls.S
index afe22d8..2b275d7 100644
--- a/arch/x86/kernel/vbi/syscalls.S
+++ b/arch/x86/kernel/vbi/syscalls.S
@@ -16,15 +16,9 @@
 
 #define _ASMLANGUAGE
 
-#ifdef CONFIG_WRHV
 #include <asm/reg_vbi.h>
 #include <asm/vbi.h>
 #include <vbi/syscall.h>
-#else
-#include <x86/regs.h>
-#include <asm.h>
-#include <vbi/syscall.h>
-#endif /* CONFIG_WRHV */
 
 	/* globals */
 	.globl vbiDebugShellStart
diff --git a/include/asm-x86/reg_vbi.h b/include/asm-x86/reg_vbi.h
index 968053c..2d597b4 100644
--- a/include/asm-x86/reg_vbi.h
+++ b/include/asm-x86/reg_vbi.h
@@ -17,11 +17,6 @@
 #ifndef	__INCx86regsh
 #define	__INCx86regsh
 
-#ifdef CONFIG_WRHV
-#else
-#include <sys/types.h>
-#endif /* CONFIG_WRHV */
-
 #define IO_BMAP_SIZE	32	/* IO bitmap for port 0x000 - 0x3ff */
 
 #ifndef	_ASMLANGUAGE
diff --git a/kernel/vbi/io_apic.c b/kernel/vbi/io_apic.c
index c662a16..f078d11 100644
--- a/kernel/vbi/io_apic.c
+++ b/kernel/vbi/io_apic.c
@@ -14,16 +14,11 @@
  *
  */
 
-#ifdef CONFIG_WRHV
 #include <linux/types.h>
 #include <linux/module.h>
 #include <vbi/vbi.h>
 #include <vbi/private.h>
 #define kprintf printk
-#else
-#include <vbi.h>
-#include <vbi/private.h>
-#endif /* CONFIG_WRHV */
 
 /* globals */
 
diff --git a/kernel/vbi/show.c b/kernel/vbi/show.c
index 002658f..af89c39 100644
--- a/kernel/vbi/show.c
+++ b/kernel/vbi/show.c
@@ -22,14 +22,10 @@ control and configuration data structures.
 
 */
 
-#ifdef CONFIG_WRHV
 #define LONG_FMT "0x%lx"
 #define kprintf printk
 #include <linux/types.h>
 #include <vbi/vbi.h>
-#else
-#include <vbi.h>
-#endif /* CONFIG_WRHV */
 
 /*******************************************************************************
 *
-- 
1.6.5.rc3

