From 17ea5a0c7b47ce99e3f8103169aabc3343033b49 Mon Sep 17 00:00:00 2001
From: WRS Support <support@windriver.com>
Date: Fri, 2 Oct 2009 16:12:13 -0400
Subject: [PATCH] hypervisor: core kernel changes for hypervisor/guest

This represents changes to existing core kernel files in
order to support linux as a guest OS on WR hypervisor.

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
Signed-off-by: Bruce Ashfield <bruce.ashfield@windriver.com>
---
 include/linux/interrupt.h    |    2 +-
 init/Kconfig                 |    2 ++
 kernel/Makefile              |    1 +

diff --git a/include/linux/interrupt.h b/include/linux/interrupt.h
index 58ff4e7..0c5ca39 100644
--- a/include/linux/interrupt.h
+++ b/include/linux/interrupt.h
@@ -92,7 +92,7 @@ extern void devm_free_irq(struct device *dev, unsigned int irq, void *dev_id);
  * places left. So the only effect should be slightly increased
  * irqs-off latencies.
  */
-#ifdef CONFIG_LOCKDEP
+#if defined(CONFIG_LOCKDEP) || defined(CONFIG_PARAVIRT)
 # define local_irq_enable_in_hardirq()	do { } while (0)
 #else
 # define local_irq_enable_in_hardirq()	local_irq_enable()
-- 
1.6.5.2

