From 5613dd227af22b6d05a791685b566b3903911df6 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Mon, 12 Oct 2009 10:14:36 +0800
Subject: [PATCH 3/3] Map vIoapic structure in wrhv_mapping

Map vIoapic structure which is used by VIOAPIC irq_chip related
code, like mask/unmask/ack/eoi, etc.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/powerpc/kernel/wrhv.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/kernel/wrhv.c b/arch/powerpc/kernel/wrhv.c
index ab5dad5..ea10f98 100644
--- a/arch/powerpc/kernel/wrhv.c
+++ b/arch/powerpc/kernel/wrhv.c
@@ -152,6 +152,8 @@ void wrhv_mapping(void)
 		 (unsigned long)wrhvConfig->vbControl, _PAGE_RAM);
 	map_page((unsigned long)wrhvConfig->interruptConfiguration,
 		 (unsigned long)wrhvConfig->interruptConfiguration, _PAGE_RAM);
+	map_page((unsigned long)wrhvConfig->vbControl->vIoapic,
+		 (unsigned long)wrhvConfig->vbControl->vIoapic, _PAGE_RAM);
 
 	razorConfig = wrhvConfig;
 	memcpy(&__wrhvConfig, wrhvConfig, sizeof(__wrhvConfig));
-- 
1.6.3.3

