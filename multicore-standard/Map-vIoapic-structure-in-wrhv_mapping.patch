From 0c18a6781362c6be1713625277eadf17c0044cf0 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Mon, 12 Oct 2009 10:14:36 +0800
Subject: [PATCH] Map vIoapic structure in wrhv_mapping

Map vIoapic structure which is used by VIOAPIC irq_chip related
code, like mask/unmask/ack/eoi, etc.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/powerpc/kernel/vbi/wrhv.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/kernel/vbi/wrhv.c b/arch/powerpc/kernel/vbi/wrhv.c
index b78ae97..d9de5d3 100644
--- a/arch/powerpc/kernel/vbi/wrhv.c
+++ b/arch/powerpc/kernel/vbi/wrhv.c
@@ -151,6 +151,8 @@ void wrhv_mapping(void)
 		 (unsigned long)wrhvConfig->vbControl, _PAGE_RAM);
 	map_page((unsigned long)wrhvConfig->interruptConfiguration,
 		 (unsigned long)wrhvConfig->interruptConfiguration, _PAGE_RAM);
+	map_page((unsigned long)wrhvConfig->vbControl->vIoapic,
+		 (unsigned long)wrhvConfig->vbControl->vIoapic, _PAGE_RAM);
 
 	memcpy(&__wrhvConfig, wrhvConfig, sizeof(__wrhvConfig));
 	/* map any shared memory region info */
-- 
1.6.5.2

