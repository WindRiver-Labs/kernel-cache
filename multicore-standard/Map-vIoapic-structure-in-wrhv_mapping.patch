From 2559186194e5d364d74514e4467293c02951a540 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Mon, 12 Oct 2009 10:14:36 +0800
Subject: [PATCH 18/59] Map vIoapic structure in wrhv_mapping

Map vIoapic structure which is used by VIOAPIC irq_chip related
code, like mask/unmask/ack/eoi, etc.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/powerpc/kernel/vbi/wrhv.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/kernel/vbi/wrhv.c b/arch/powerpc/kernel/vbi/wrhv.c
index ac90c65..b4094c3 100644
--- a/arch/powerpc/kernel/vbi/wrhv.c
+++ b/arch/powerpc/kernel/vbi/wrhv.c
@@ -151,6 +151,8 @@ void wrhv_mapping(void)
 		 (unsigned long)wr_config->vb_control, _PAGE_RAM);
 	map_page((unsigned long)wr_config->interruptConfiguration,
 		 (unsigned long)wr_config->interruptConfiguration, _PAGE_RAM);
+	map_page((unsigned long)wr_config->vb_control->vIoapic,
+		 (unsigned long)wr_config->vb_control->vIoapic, _PAGE_RAM);
 
 	memcpy(&__wr_config, wr_config, sizeof(__wr_config));
 	/* map any shared memory region info */
-- 
1.6.5.2

