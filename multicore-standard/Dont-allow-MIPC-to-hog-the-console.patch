From febc347214dadf9706f201e83095d977c2f51b6a Mon Sep 17 00:00:00 2001
From: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
Date: Fri, 19 Feb 2010 07:41:14 -0500
Subject: [PATCH] Dont allow MIPC to hog the console

MIPC wants to hog the serial console

Signed-off-by: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
---
 drivers/serial/serial_core.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/serial/serial_core.c b/drivers/serial/serial_core.c
index a67970d..7ec0192 100644
--- a/drivers/serial/serial_core.c
+++ b/drivers/serial/serial_core.c
@@ -2499,7 +2499,7 @@ int uart_add_one_port(struct uart_driver *drv, struct uart_port *port)
 		lockdep_set_class(&port->lock, &port_lock_key);
 	}
 
-#ifdef CONFIG_WRHV
+#if defined(CONFIG_WRHV) && !defined(CONFIG_WRHV_MILS)
 #define __MIPC_MSD_MAJOR	236
 	if (!uart_console(port) && (drv->major != __MIPC_MSD_MAJOR)) {
 		ret = -EBUSY;
-- 
1.7.0

