From c92527195cf22dc4c7c7464ca5cfc909e012a8f2 Mon Sep 17 00:00:00 2001
From: WRS Support <support@windriver.com>
Date: Fri, 2 Oct 2009 16:23:11 -0400
Subject: [PATCH] drivers: MIPC serial device

Add MIPC serial device node number.

---
 drivers/serial/serial_core.c        |    9 +++++++++

diff --git a/drivers/serial/serial_core.c b/drivers/serial/serial_core.c
index 7547e94..4784808 100644
--- a/drivers/serial/serial_core.c
+++ b/drivers/serial/serial_core.c
@@ -2492,6 +2492,15 @@ int uart_add_one_port(struct uart_driver *drv, struct uart_port *port)
 		lockdep_set_class(&port->lock, &port_lock_key);
 	}
 
+#ifdef CONFIG_WRHV
+#define __MIPC_MSD_MAJOR	236
+	if (!uart_console(port) && (drv->major != __MIPC_MSD_MAJOR)) {
+		ret = -EBUSY;
+		goto out;
+	}
+#undef __MIPC_MSD_MAJOR
+#endif
+
 	uart_configure_port(drv, state, port);
 
 	/*

