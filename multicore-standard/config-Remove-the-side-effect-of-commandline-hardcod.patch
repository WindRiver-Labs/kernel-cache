From 752028a0fb9103a9da2aa9a3c813d3545dea26c1 Mon Sep 17 00:00:00 2001
From: Andrew Liu <shengping.liu@windriver.com>
Date: Thu, 15 Oct 2009 15:54:23 +0800
Subject: [PATCH] config: Remove the side effect of commandline hardcoded in DTS

Allow the DTS and XML command line specifications to co-exist.

Signed-off-by: Andrew Liu <shengping.liu@windriver.com>
---
 arch/powerpc/platforms/85xx/wrhv_8572ds.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/platforms/85xx/wrhv_8572ds.c b/arch/powerpc/platforms/85xx/wrhv_8572ds.c
index 4c3d6ce..aa80e2f 100644
--- a/arch/powerpc/platforms/85xx/wrhv_8572ds.c
+++ b/arch/powerpc/platforms/85xx/wrhv_8572ds.c
@@ -161,6 +161,9 @@ static int __init wrhv_8572ds_probe(void)
 	strncpy(cmd_line, wrhvConfig->bootLine, VB_MAX_BOOTLINE_LENGTH - 1);
 	cmd_line[VB_MAX_BOOTLINE_LENGTH - 1] = 0;
 
+	/* Save command line for /proc/cmdline */
+        strlcpy(boot_command_line, cmd_line, COMMAND_LINE_SIZE);
+
 	if (of_flat_dt_is_compatible(root, "fsl,MPC8572DS")) {
 #ifdef CONFIG_PCI
 		primary_phb_addr = 0x8000;
-- 
1.6.5.2

