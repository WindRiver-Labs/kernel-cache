From b37588c879c0878efa19d081fad0af1649e64587 Mon Sep 17 00:00:00 2001
From: Thomas Tai <thomas.tai@windriver.com>
Date: Wed, 21 Oct 2009 14:17:47 -0400
Subject: [PATCH 26/59] initialize wrhvConfig in wrhv_init

In order to access wrhvConfig very early, move
wrhvConfig initialization into wrhv_init.

Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 arch/powerpc/platforms/85xx/wrhv_8572ds.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/arch/powerpc/platforms/85xx/wrhv_8572ds.c b/arch/powerpc/platforms/85xx/wrhv_8572ds.c
index 46f5838..36ea35f 100644
--- a/arch/powerpc/platforms/85xx/wrhv_8572ds.c
+++ b/arch/powerpc/platforms/85xx/wrhv_8572ds.c
@@ -151,10 +151,10 @@ static int __init wrhv_8572ds_probe(void)
 {
 	unsigned long root = of_get_flat_dt_root();
 
-	wr_config = (struct vb_config *)0xF0000000;	/* TODO */
-	wrhvControl = wrhvConfig->vbControl;
-	wrhvStatus = wrhvConfig->vbStatus;
-	 
+	/*
+	 * wrhvConfig should have been initialized in wrhv_init(),
+	 * continue to complete the vbi initialization here.
+	 */
 	wrhv_mapping(); /* Map vb_config structure */
 	vbi_init(wr_config);
 
-- 
1.6.5.2

