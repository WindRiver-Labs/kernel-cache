From koba@kmckk.co.jp Wed Oct  3 04:28:36 2012
From: Tetsuyuki Kobayashi <koba@kmckk.co.jp>
Date: Wed,  3 Oct 2012 20:23:06 +0900
Subject: [PATCH 14/26] clocksource: em_sti: Add DT support
To: greg@kroah.com
Cc: ltsi-dev@lists.linuxfoundation.org, horms@verge.net.au, damm@opensource.se, Magnus Damm <magnus.damm@gmail.com>, arnd@arndb.de, johnstul@us.ibm.com, rjw@sisk.pl, lethal@linux-sh.org, gregkh@linuxfoundation.org, olof@lixom.net, Thomas Gleixner <tglx@linutronix.de>, Tetsuyuki Kobayashi <koba@kmckk.co.jp>
Message-ID: <1349263398-13152-15-git-send-email-koba@kmckk.co.jp>


From: Magnus Damm <magnus.damm@gmail.com>

Update the em-sti driver to support DT.

Signed-off-by: Magnus Damm <damm@opensource.se>
Cc: arnd@arndb.de
Cc: horms@verge.net.au
Cc: johnstul@us.ibm.com
Cc: rjw@sisk.pl
Cc: lethal@linux-sh.org
Cc: gregkh@linuxfoundation.org
Cc: olof@lixom.net
Link: http://lkml.kernel.org/r/20120509143950.27521.7949.sendpatchset@w520
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
(cherry picked from commit fc0830fe017d02b7b4995b5c402b484b65d9dfc6)

Signed-off-by: Tetsuyuki Kobayashi <koba@kmckk.co.jp>
---
 drivers/clocksource/em_sti.c |    7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/drivers/clocksource/em_sti.c b/drivers/clocksource/em_sti.c
index 719584a..372051d 100644
--- a/drivers/clocksource/em_sti.c
+++ b/drivers/clocksource/em_sti.c
@@ -384,11 +384,18 @@ static int __devexit em_sti_remove(struct platform_device *pdev)
 	return -EBUSY; /* cannot unregister clockevent and clocksource */
 }
 
+static const struct of_device_id em_sti_dt_ids[] __devinitconst = {
+	{ .compatible = "renesas,em-sti", },
+	{},
+};
+MODULE_DEVICE_TABLE(of, em_sti_dt_ids);
+
 static struct platform_driver em_sti_device_driver = {
 	.probe		= em_sti_probe,
 	.remove		= __devexit_p(em_sti_remove),
 	.driver		= {
 		.name	= "em_sti",
+		.of_match_table = em_sti_dt_ids,
 	}
 };
 
-- 
1.7.9.5

