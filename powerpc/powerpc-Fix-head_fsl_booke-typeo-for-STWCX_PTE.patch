From f60686dd82b175aa3535857e4751d72c46f15194 Mon Sep 17 00:00:00 2001
From: Ed Swarthout <Ed.Swarthout@freescale.com>
Date: Mon, 20 Oct 2008 10:41:25 -0500
Subject: [PATCH 4/5] powerpc: Fix head_fsl_booke typeo for STWCX_PTE

Original patch taken from rev 1.1 board support ISO image for fsl_p4080.
[Known as P4080SW_01_01_00B-ltib.iso]

When CONFIG_SMP=n and CONFIG_PTE_64BIT=y we get:

arch/powerpc/kernel/head_fsl_booke.S: Assembler messages:
arch/powerpc/kernel/head_fsl_booke.S:599: Error: Unrecognized opcode: `stwcx_pte'
arch/powerpc/kernel/head_fsl_booke.S:813: Error: Unrecognized opcode: `stwcx_pte'
arch/powerpc/kernel/head_fsl_booke.S:978: Error: Unrecognized opcode: `stwcx_pte'

Signed-off-by: Ed Swarthout <Ed.Swarthout@freescale.com>
Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
Integrated-by: Liang Li <liang.li@windriver.com>
---
 arch/powerpc/kernel/head_fsl_booke.S |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/kernel/head_fsl_booke.S b/arch/powerpc/kernel/head_fsl_booke.S
index 367c247..d0a1542 100644
--- a/arch/powerpc/kernel/head_fsl_booke.S
+++ b/arch/powerpc/kernel/head_fsl_booke.S
@@ -452,7 +452,7 @@ skpinv:	addi	r6,r6,1				/* Increment */
 #    define STWCX_PTE \
 	addi	r12, r12, 4;	\
 	stwcx.	r11, 0, r12;	\
-	addi	r12, r12, -4;	\
+	addi	r12, r12, -4;
 #else
 #    define LWARX_PTE \
 	lwz	r11, 4(r12)
-- 
1.6.3.3

