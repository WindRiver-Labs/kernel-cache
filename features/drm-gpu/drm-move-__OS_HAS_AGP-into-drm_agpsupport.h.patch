From dc2f9e45620b93c8f433149e005e12b703f08b69 Mon Sep 17 00:00:00 2001
From: David Herrmann <dh.herrmann@gmail.com>
Date: Fri, 29 Aug 2014 12:12:36 +0200
Subject: [PATCH 1262/1369] drm: move __OS_HAS_AGP into drm_agpsupport.h

commit 71930d74e4ad5b2cddc03e0a47ad0cc7ba51845c upstream.

With drm_memory.h gone, there is no header left that uses __OS_HAS_AGP.
Move it into drm_agpsupport.h (which is itself included from drmP.h) to
hide it harder from public eyes.

Signed-off-by: David Herrmann <dh.herrmann@gmail.com>
Signed-off-by: Dave Airlie <airlied@redhat.com>
Signed-off-by: Pengyu Ma <pengyu.ma@windriver.com>
---
 include/drm/drmP.h           |    2 --
 include/drm/drm_agpsupport.h |    3 +++
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/include/drm/drmP.h b/include/drm/drmP.h
index d42c4db..5508ac1 100644
--- a/include/drm/drmP.h
+++ b/include/drm/drmP.h
@@ -67,8 +67,6 @@
 
 #include <linux/idr.h>
 
-#define __OS_HAS_AGP (defined(CONFIG_AGP) || (defined(CONFIG_AGP_MODULE) && defined(MODULE)))
-
 struct module;
 
 struct drm_file;
diff --git a/include/drm/drm_agpsupport.h b/include/drm/drm_agpsupport.h
index 3bebeb4..4f1724c 100644
--- a/include/drm/drm_agpsupport.h
+++ b/include/drm/drm_agpsupport.h
@@ -8,6 +8,9 @@
 #include <linux/agp_backend.h>
 #include <drm/drmP.h>
 
+#define __OS_HAS_AGP (defined(CONFIG_AGP) || (defined(CONFIG_AGP_MODULE) && \
+					      defined(MODULE)))
+
 struct drm_agp_head {
 	struct agp_kern_info agp_info;
 	struct list_head memory;
-- 
1.7.5.4

