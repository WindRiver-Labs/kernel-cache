From 6217aeceebf17cba5c33fbfa9e1feccb7d0e37da Mon Sep 17 00:00:00 2001
From: Alex Deucher <alexander.deucher@amd.com>
Date: Sun, 28 Jul 2013 18:26:38 -0400
Subject: [PATCH 838/886] drm/radeon/dpm: disable cac setup on SI

commit d05f7e700a3a47eeb7dbe236d2680381f5b5edcb upstream

Disable cac setup on SI for now since it causes
strange performance level restrictions on certain
cards.  I suspect there may be issues with some of
the 64 bit fixed point double emulation that is used
to set up those parameters.  I need to double check
the math before this can be re-enabled.

Signed-off-by: Alex Deucher <alexander.deucher@amd.com>
---
 drivers/gpu/drm/radeon/si_dpm.c |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/gpu/drm/radeon/si_dpm.c b/drivers/gpu/drm/radeon/si_dpm.c
index 994f9e5..e8ee685 100644
--- a/drivers/gpu/drm/radeon/si_dpm.c
+++ b/drivers/gpu/drm/radeon/si_dpm.c
@@ -1929,6 +1929,7 @@ static void si_initialize_powertune_defaults(struct radeon_device *rdev)
 			si_pi->cac_override = cac_override_pitcairn;
 			si_pi->powertune_data = &powertune_data_pitcairn;
 			si_pi->dte_data = dte_data_pitcairn;
+			break;
 		}
 	} else if (rdev->family == CHIP_VERDE) {
 		si_pi->lcac_config = lcac_cape_verde;
@@ -2041,7 +2042,8 @@ static void si_initialize_powertune_defaults(struct radeon_device *rdev)
 	ni_pi->enable_sq_ramping = false;
 	si_pi->enable_dte = false;
 
-	if (si_pi->powertune_data->enable_powertune_by_default) {
+	/* XXX: fix me */
+	if (0/*si_pi->powertune_data->enable_powertune_by_default*/) {
 		ni_pi->enable_power_containment= true;
 		ni_pi->enable_cac = true;
 		if (si_pi->dte_data.enable_dte_by_default) {
-- 
1.7.9.5

