From 08558c0b6892f85e81c8d1bac621960f8111a711 Mon Sep 17 00:00:00 2001
From: Sandor Yu <R01008@freescale.com>
Date: Thu, 7 Aug 2014 14:53:13 +0800
Subject: [PATCH 0906/1074] ENGR00326250 csi v4l2 capture: Add RGB32 output
 support

Add RGB32 format output support.

Signed-off-by: Sandor Yu <R01008@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 .../media/platform/mxc/capture/csi_v4l2_capture.c  |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

diff --git a/drivers/media/platform/mxc/capture/csi_v4l2_capture.c b/drivers/media/platform/mxc/capture/csi_v4l2_capture.c
index 542cbc7..ca82d53 100644
--- a/drivers/media/platform/mxc/capture/csi_v4l2_capture.c
+++ b/drivers/media/platform/mxc/capture/csi_v4l2_capture.c
@@ -650,6 +650,7 @@ static inline int valid_mode(u32 palette)
 {
 	return (palette == V4L2_PIX_FMT_RGB565) ||
 	    (palette == V4L2_PIX_FMT_YUYV) ||
+	    (palette == V4L2_PIX_FMT_RGB32) ||
 	    (palette == V4L2_PIX_FMT_UYVY) ||
 	    (palette == V4L2_PIX_FMT_YUV444) ||
 		(palette == V4L2_PIX_FMT_YUV420);
@@ -946,6 +947,10 @@ static int csi_v4l2_s_fmt(cam_data *cam, struct v4l2_format *f)
 		cam->bswapenable = false;
 
 		switch (f->fmt.pix.pixelformat) {
+		case V4L2_PIX_FMT_RGB32:
+			size = f->fmt.pix.width * f->fmt.pix.height * 4;
+			bytesperline = f->fmt.pix.width * 4;
+			break;
 		case V4L2_PIX_FMT_RGB565:
 			size = f->fmt.pix.width * f->fmt.pix.height * 2;
 			bytesperline = f->fmt.pix.width * 2;
@@ -978,7 +983,6 @@ static int csi_v4l2_s_fmt(cam_data *cam, struct v4l2_format *f)
 		case V4L2_PIX_FMT_RGB24:
 		case V4L2_PIX_FMT_BGR24:
 		case V4L2_PIX_FMT_BGR32:
-		case V4L2_PIX_FMT_RGB32:
 		case V4L2_PIX_FMT_NV12:
 		default:
 			pr_debug("   case not supported\n");
-- 
1.7.5.4

