From edb2434bd6bd6820d4c8daf9741a53f3664a48d9 Mon Sep 17 00:00:00 2001
From: Liu Ying <Ying.Liu@freescale.com>
Date: Thu, 12 Sep 2013 15:50:13 +0800
Subject: [PATCH 0181/1074] ENGR00279401 mxc v4l2 capture: use flush_work
 instead of flush_work_sync

Since commit 43829731d (workqueue: deprecate flush[_delayed]_work_sync()),
flush_work() should be used instead of flush_work_sync().

Signed-off-by: Liu Ying <Ying.Liu@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 .../platform/mxc/capture/ipu_bg_overlay_sdc.c      |    2 +-
 .../platform/mxc/capture/ipu_fg_overlay_sdc.c      |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/media/platform/mxc/capture/ipu_bg_overlay_sdc.c b/drivers/media/platform/mxc/capture/ipu_bg_overlay_sdc.c
index fc77525..ad5e1c8 100644
--- a/drivers/media/platform/mxc/capture/ipu_bg_overlay_sdc.c
+++ b/drivers/media/platform/mxc/capture/ipu_bg_overlay_sdc.c
@@ -418,7 +418,7 @@ static int bg_overlay_stop(void *private)
 	}
 #endif
 
-	flush_work_sync(&cam->csi_work_struct);
+	flush_work(&cam->csi_work_struct);
 	cancel_work_sync(&cam->csi_work_struct);
 
 	if (cam->vf_bufs_vaddr[0]) {
diff --git a/drivers/media/platform/mxc/capture/ipu_fg_overlay_sdc.c b/drivers/media/platform/mxc/capture/ipu_fg_overlay_sdc.c
index 43baba2..416b40b 100644
--- a/drivers/media/platform/mxc/capture/ipu_fg_overlay_sdc.c
+++ b/drivers/media/platform/mxc/capture/ipu_fg_overlay_sdc.c
@@ -515,7 +515,7 @@ static int foreground_stop(void *private)
 	}
 #endif
 
-	flush_work_sync(&cam->csi_work_struct);
+	flush_work(&cam->csi_work_struct);
 	cancel_work_sync(&cam->csi_work_struct);
 
 	if (cam->vf_bufs_vaddr[0]) {
-- 
1.7.5.4

