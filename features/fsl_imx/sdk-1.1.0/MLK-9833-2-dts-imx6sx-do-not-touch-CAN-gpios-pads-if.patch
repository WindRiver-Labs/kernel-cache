From 53144f69f1e081ef5f25de965dbaa73a00540106 Mon Sep 17 00:00:00 2001
From: Dong Aisheng <b29396@freescale.com>
Date: Tue, 11 Nov 2014 21:18:12 +0800
Subject: [PATCH 0528/1074] MLK-9833-2 dts: imx6sx: do not touch CAN gpios
 pads if M4 is enabled

CAN devices are allocated to run on M4.
So do not touch CAN pads setting if M4 is enabled.

Signed-off-by: Dong Aisheng <b29396@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/boot/dts/imx6sx-sdb-m4.dts |    5 +++++
 arch/arm/boot/dts/imx6sx-sdb.dts    |   11 ++++++++---
 2 files changed, 13 insertions(+), 3 deletions(-)

diff --git a/arch/arm/boot/dts/imx6sx-sdb-m4.dts b/arch/arm/boot/dts/imx6sx-sdb-m4.dts
index ebc7696..96db295 100644
--- a/arch/arm/boot/dts/imx6sx-sdb-m4.dts
+++ b/arch/arm/boot/dts/imx6sx-sdb-m4.dts
@@ -15,6 +15,11 @@
 	};
 };
 
+&iomuxc {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_hog>;
+};
+
 /*
  * The flollowing modules are conflicting with M4, disable them when m4
  * is running.
diff --git a/arch/arm/boot/dts/imx6sx-sdb.dts b/arch/arm/boot/dts/imx6sx-sdb.dts
index 3c74fe8..6219165 100644
--- a/arch/arm/boot/dts/imx6sx-sdb.dts
+++ b/arch/arm/boot/dts/imx6sx-sdb.dts
@@ -383,7 +383,7 @@
 
 &iomuxc {
 	pinctrl-names = "default";
-	pinctrl-0 = <&pinctrl_hog>;
+	pinctrl-0 = <&pinctrl_hog &pinctrl_can_gpios>;
 
 	usdhc4 {
 		pinctrl_usdhc4_gpios: usdhc4-gpios {
@@ -404,9 +404,7 @@
 				MX6SX_PAD_KEY_ROW0__GPIO2_IO_15	0x17059
 				MX6SX_PAD_KEY_COL1__GPIO2_IO_11	0x17059
 				MX6SX_PAD_SD1_DATA0__GPIO6_IO_2 0x17059
-				MX6SX_PAD_QSPI1B_DATA1__GPIO4_IO_25 0x17059
 				MX6SX_PAD_QSPI1B_DATA2__GPIO4_IO_26 0x17059
-				MX6SX_PAD_QSPI1B_DATA3__GPIO4_IO_27 0x17059
 				MX6SX_PAD_CSI_DATA03__GPIO1_IO_17 0x17059
 				MX6SX_PAD_CSI_DATA04__GPIO1_IO_18 0x17059
 				MX6SX_PAD_CSI_DATA05__GPIO1_IO_19 0x17059
@@ -414,6 +412,13 @@
 				MX6SX_PAD_GPIO1_IO13__WDOG1_WDOG_ANY 0x30b0
 			>;
 		};
+
+		pinctrl_can_gpios: can-gpios {
+			fsl,pins = <
+				MX6SX_PAD_QSPI1B_DATA1__GPIO4_IO_25 0x17059
+				MX6SX_PAD_QSPI1B_DATA3__GPIO4_IO_27 0x17059
+			>;
+		};
 	};
 };
 
-- 
1.7.5.4

