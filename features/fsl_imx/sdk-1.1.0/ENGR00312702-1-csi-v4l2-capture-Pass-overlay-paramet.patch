From 24dab6d4bafd235a7b1aebc8924a5a038f2f981c Mon Sep 17 00:00:00 2001
From: Sandor Yu <R01008@freescale.com>
Date: Thu, 8 May 2014 10:41:53 +0800
Subject: [PATCH 0822/1074] ENGR00312702-1 csi v4l2 capture: Pass overlay
 parameter to pxp dma

Pass overlay parameter to pxp dma, otherwise struct of ol_param
will remain the value as last pxp task.

Signed-off-by: Sandor Yu <R01008@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 .../media/platform/mxc/capture/csi_v4l2_capture.c  |    6 +++++-
 1 files changed, 5 insertions(+), 1 deletions(-)

diff --git a/drivers/media/platform/mxc/capture/csi_v4l2_capture.c b/drivers/media/platform/mxc/capture/csi_v4l2_capture.c
index c9a8fe0..3da1628 100644
--- a/drivers/media/platform/mxc/capture/csi_v4l2_capture.c
+++ b/drivers/media/platform/mxc/capture/csi_v4l2_capture.c
@@ -360,11 +360,15 @@ static int pxp_process_update(cam_data *cam)
 			pxp_conf->s0_param.paddr = sg_dma_address(&sg[0]);
 			memcpy(&desc->layer_param.s0_param, &pxp_conf->s0_param,
 				sizeof(struct pxp_layer_param));
-		} else if (i == 1) {
+		} else if (i == 1) {/* output */
 			pxp_conf->out_param.paddr = sg_dma_address(&sg[1]);
 			memcpy(&desc->layer_param.out_param,
 				&pxp_conf->out_param,
 				sizeof(struct pxp_layer_param));
+		} else {/* overlay */
+			memcpy(&desc->layer_param.ol_param,
+				&pxp_conf->ol_param,
+				sizeof(struct pxp_layer_param));
 		}
 
 		desc = desc->next;
-- 
1.7.5.4

