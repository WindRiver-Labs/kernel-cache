From c9419c15ec6023f81be1554d9332c9b80887a383 Mon Sep 17 00:00:00 2001
From: Anson Huang <b20788@freescale.com>
Date: Wed, 19 Nov 2014 15:13:19 +0800
Subject: [PATCH 0535/1074] MLK-9872-2 arm: dts: imx6sx: add new qspi restore
 node

As on different boards, MQX may run on different QSPI
module, such as i.MX6SX SDB board using QSPI2, and i.MX6SX
SABREAUTO using QSPI1, so here we add a node to tell kernel
which QSPI module need to be restored after resume from
DSM mode with Mega/Fast off, by default it is for QSPI2 to
align with i.MX6SX SDB board, modify the baord dtb file to
change it.

Signed-off-by: Anson Huang <b20788@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/boot/dts/imx6sx-sabreauto-m4.dts |    5 +++++
 arch/arm/boot/dts/imx6sx-sdb-m4.dts       |    4 ++++
 arch/arm/boot/dts/imx6sx.dtsi             |    6 ++++++
 3 files changed, 15 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/imx6sx-sabreauto-m4.dts b/arch/arm/boot/dts/imx6sx-sabreauto-m4.dts
index f18a643..935a870 100644
--- a/arch/arm/boot/dts/imx6sx-sabreauto-m4.dts
+++ b/arch/arm/boot/dts/imx6sx-sabreauto-m4.dts
@@ -55,6 +55,11 @@
 	status = "disabled";
 };
 
+&qspi_m4 {
+	reg = <0x021e0000 0x4000>;
+	status = "okay";
+};
+
 &ocram {
 	reg = <0x00901000 0x1E000>;
 };
diff --git a/arch/arm/boot/dts/imx6sx-sdb-m4.dts b/arch/arm/boot/dts/imx6sx-sdb-m4.dts
index 96db295..9b789c8 100644
--- a/arch/arm/boot/dts/imx6sx-sdb-m4.dts
+++ b/arch/arm/boot/dts/imx6sx-sdb-m4.dts
@@ -48,6 +48,10 @@
         status = "disabled";
 };
 
+&qspi_m4 {
+	status = "okay";
+};
+
 &ocram {
 	reg = <0x00901000 0x1E000>;
 };
diff --git a/arch/arm/boot/dts/imx6sx.dtsi b/arch/arm/boot/dts/imx6sx.dtsi
index 67157df..c8dadce 100644
--- a/arch/arm/boot/dts/imx6sx.dtsi
+++ b/arch/arm/boot/dts/imx6sx.dtsi
@@ -770,6 +770,12 @@
 				status = "disabled";
 			};
 
+			qspi_m4: qspi-m4 {
+				compatible = "fsl,imx6sx-qspi-m4-restore";
+				reg = <0x021e4000 0x4000>;
+				status = "disabled";
+			};
+
 			romcp@021ac000 {
 				compatible = "fsl,imx6sx-romcp", "syscon";
 				reg = <0x021ac000 0x4000>;
-- 
1.7.5.4

