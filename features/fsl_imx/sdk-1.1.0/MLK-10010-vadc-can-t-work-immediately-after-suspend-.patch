From 69a7f6414a9775d91f89727fa9bf3e505b5e68c2 Mon Sep 17 00:00:00 2001
From: Sandor Yu <R01008@freescale.com>
Date: Wed, 17 Dec 2014 09:50:09 +0800
Subject: [PATCH 0984/1074] MLK-10010: vadc: can't work immediately after
 suspend&resume

The issue only can duplicate with PAL camera.
It is cause by vadc did not detect right video mode.
Add 0.5s delay before mode detect to resolved the issue.

Signed-off-by: Sandor Yu <R01008@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 drivers/media/platform/mxc/capture/mxc_vadc.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/drivers/media/platform/mxc/capture/mxc_vadc.c b/drivers/media/platform/mxc/capture/mxc_vadc.c
index 648e411..6b3d5f6 100644
--- a/drivers/media/platform/mxc/capture/mxc_vadc.c
+++ b/drivers/media/platform/mxc/capture/mxc_vadc.c
@@ -436,6 +436,9 @@ static void vadc_get_std(struct vadc_data *vadc, v4l2_std_id *std)
 	pr_debug("In vadc_get_std\n");
 
 	/* Read PAL mode detected result */
+	pr_debug("wait vadc auto detect video mode....");
+	msleep(500);
+
 	tmp = reg32_read(VDEC_VIDMOD);
 	tmp &= (VDEC_VIDMOD_PAL_MASK | VDEC_VIDMOD_M625_MASK);
 
@@ -454,6 +457,8 @@ static void vadc_get_std(struct vadc_data *vadc, v4l2_std_id *std)
 		vadc->sen.pix.width = video_fmts[video_idx].active_width;
 		vadc->sen.pix.height = video_fmts[video_idx].active_height;
 	}
+
+	pr_debug("Mode %s\n", video_fmts[video_idx].name);
 }
 
 /* --------------- IOCTL functions from v4l2_int_ioctl_desc --------------- */
-- 
1.7.5.4

