From e2c9a15ee0d29216a75f14d109c7c03edf09aa3a Mon Sep 17 00:00:00 2001
From: Dong Aisheng <b29396@freescale.com>
Date: Wed, 5 Mar 2014 16:30:25 +0800
Subject: [PATCH 0303/1074] ENGR00302227-3 dts:imx6sx-sdb: add SD3 support

Add SD3 support

Signed-off-by: Dong Aisheng <b29396@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/boot/dts/imx6sx-sdb.dts |   26 ++++++++++++++++++++++++++
 1 files changed, 26 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/imx6sx-sdb.dts b/arch/arm/boot/dts/imx6sx-sdb.dts
index 188efdb..1447787 100644
--- a/arch/arm/boot/dts/imx6sx-sdb.dts
+++ b/arch/arm/boot/dts/imx6sx-sdb.dts
@@ -35,6 +35,15 @@
 			enable-active-high;
 		};
 
+		reg_sd3_vmmc: sd3_vmmc{
+			compatible = "regulator-fixed";
+			regulator-name = "VCC_SD3";
+			regulator-min-microvolt = <3000000>;
+			regulator-max-microvolt = <3000000>;
+			gpio = <&gpio2 11 GPIO_ACTIVE_HIGH>;
+			enable-active-high;
+		};
+
 		reg_vref_3v3: regulator@0 {
 			compatible = "regulator-fixed";
 			regulator-name = "vref-3v3";
@@ -229,6 +238,9 @@
 				MX6SX_PAD_ENET2_COL__GPIO2_IO_6 0x80000000
 				MX6SX_PAD_QSPI1A_DATA0__GPIO4_IO_16 0x80000000
 				MX6SX_PAD_QSPI1A_DATA3__GPIO4_IO_19 0x80000000
+				MX6SX_PAD_KEY_COL0__GPIO2_IO_10	0x17059
+				MX6SX_PAD_KEY_ROW0__GPIO2_IO_15	0x17059
+				MX6SX_PAD_KEY_COL1__GPIO2_IO_11	0x17059
 			>;
 		};
 	};
@@ -246,6 +258,20 @@
 	status = "okay";
 };
 
+&usdhc3 {
+	pinctrl-names = "default", "state_100mhz", "state_200mhz";
+	pinctrl-0 = <&pinctrl_usdhc3_1>;
+	pinctrl-1 = <&pinctrl_usdhc3_1_100mhz>;
+	pinctrl-2 = <&pinctrl_usdhc3_1_200mhz>;
+	bus-width = <8>;
+	cd-gpios = <&gpio2 10 0>;
+	wp-gpios = <&gpio2 15 0>;
+	keep-power-in-suspend;
+	enable-sdio-wakeup;
+	vmmc-supply = <&reg_sd3_vmmc>;
+	status = "okay";
+};
+
 &usdhc4 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_usdhc4_1>;
-- 
1.7.5.4

