From d46ef79e792746d0d552d635493ce4d93a05d17a Mon Sep 17 00:00:00 2001
From: Liu Ying <Ying.Liu@freescale.com>
Date: Tue, 29 Oct 2013 12:31:36 +0800
Subject: [PATCH 0571/1074] ENGR00285273-3 IPU dev:Remove unnecessary memset
 before kfree

This patch removes unnecessary memset() before kfree().
Also, it fixes a potential NULL pointer dereference(writing
to a freed block of memory).

Signed-off-by: Liu Ying <Ying.Liu@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 drivers/mxc/ipu3/ipu_device.c |    3 ---
 1 files changed, 0 insertions(+), 3 deletions(-)

diff --git a/drivers/mxc/ipu3/ipu_device.c b/drivers/mxc/ipu3/ipu_device.c
index e202414..72a9905 100644
--- a/drivers/mxc/ipu3/ipu_device.c
+++ b/drivers/mxc/ipu3/ipu_device.c
@@ -1414,8 +1414,6 @@ static void task_mem_free(struct kref *ref)
 {
 	struct ipu_task_entry *tsk =
 			container_of(ref, struct ipu_task_entry, refcount);
-
-	memset(tsk, 0, sizeof(*tsk));
 	kfree(tsk);
 }
 
@@ -1731,7 +1729,6 @@ err_exit:
 		if (!tsk)
 			continue;
 		kfree(tsk);
-		memset(tsk, 0, sizeof(*tsk));
 	}
 	t->state = STATE_ERR;
 	return ret;
-- 
1.7.5.4

