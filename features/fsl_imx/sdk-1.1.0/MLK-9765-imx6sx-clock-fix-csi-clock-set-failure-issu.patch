From e8621fb3b73898dcbc9142eb03b91fd1fb2f94ba Mon Sep 17 00:00:00 2001
From: Robby Cai <r63905@freescale.com>
Date: Wed, 29 Oct 2014 16:38:37 +0800
Subject: [PATCH 0510/1074] MLK-9765 imx6sx: clock: fix csi clock set failure
 issue

"Patch ENGR00329450 ARM: imx: set CLK_SET_RATE_GATE for gate and divider clocks"
requires that the particular clock (derived from PLL) need to be disabled before
its rate is changed. While on imx6sx, CSI0 and CSI1 shares the same CSI clock,
which means the CSI clock cannot be disabled then changed the clock when another
CSI module is already working.

Currently the CSI clock is only derived from OSC 24Mhz instead of PLL.
Now use the clk_register_gate() without CLK_SET_RATE_GATE flag by compromise
to make two CSIs work properly.

Signed-off-by: Robby Cai <r63905@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/mach-imx/clk-imx6sx.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-imx/clk-imx6sx.c b/arch/arm/mach-imx/clk-imx6sx.c
index d89119e..dbe98d4 100644
--- a/arch/arm/mach-imx/clk-imx6sx.c
+++ b/arch/arm/mach-imx/clk-imx6sx.c
@@ -367,7 +367,7 @@ static void __init imx6sx_clocks_init(struct device_node *ccm_node)
 	clks[IMX6SX_CLK_CANFD]        = imx_clk_gate2("canfd",         "can_podf",          base + 0x6c, 30);
 
 	/* CCGR2 */
-	clks[IMX6SX_CLK_CSI]          = imx_clk_gate2("csi",           "csi_podf",          base + 0x70, 2);
+	clks[IMX6SX_CLK_CSI]          = imx_clk_gate("csi",           "csi_podf",          base + 0x70, 2);
 	clks[IMX6SX_CLK_I2C1]         = imx_clk_gate2("i2c1",          "perclk",            base + 0x70, 6);
 	clks[IMX6SX_CLK_I2C2]         = imx_clk_gate2("i2c2",          "perclk",            base + 0x70, 8);
 	clks[IMX6SX_CLK_I2C3]         = imx_clk_gate2("i2c3",          "perclk",            base + 0x70, 10);
-- 
1.7.5.4

