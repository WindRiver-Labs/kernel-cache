From 6cb338b2cffb6a50f1f078f36145a5b7aa99f945 Mon Sep 17 00:00:00 2001
From: Robby Cai <R63905@freescale.com>
Date: Wed, 19 Feb 2014 13:57:58 +0800
Subject: [PATCH 0278/1074] ENGR00299746-5 ARM: dts: imx: add lcdif support on
 imx6sx 17x17 arm2 board

- add pinmux setting for lcdif
- add pwm3 setting for lcdif backlight
- add a dummy clock for imx23/imx28/imx60

Signed-off-by: Robby Cai <R63905@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/boot/dts/imx23.dtsi            |    4 +-
 arch/arm/boot/dts/imx28.dtsi            |    3 +-
 arch/arm/boot/dts/imx6sl.dtsi           |    5 +-
 arch/arm/boot/dts/imx6sx-17x17-arm2.dts |   45 ++++++++++++++++++++
 arch/arm/boot/dts/imx6sx.dtsi           |   70 +++++++++++++++++++++++++++++++
 5 files changed, 122 insertions(+), 5 deletions(-)

diff --git a/arch/arm/boot/dts/imx23.dtsi b/arch/arm/boot/dts/imx23.dtsi
index a984259..21c0f88 100644
--- a/arch/arm/boot/dts/imx23.dtsi
+++ b/arch/arm/boot/dts/imx23.dtsi
@@ -364,8 +364,8 @@
 				compatible = "fsl,imx23-lcdif";
 				reg = <0x80030000 2000>;
 				interrupts = <46 45>;
-				clocks = <&clks 38>, <&clks 38>;
-				clock-names = "pix", "axi";
+				clocks = <&clks 38>, <&clks 38>, <&clks 38>;
+				clock-names = "pix", "axi", "disp_axi";
 				status = "disabled";
 			};
 
diff --git a/arch/arm/boot/dts/imx28.dtsi b/arch/arm/boot/dts/imx28.dtsi
index 2b770e5..71a6060 100644
--- a/arch/arm/boot/dts/imx28.dtsi
+++ b/arch/arm/boot/dts/imx28.dtsi
@@ -842,7 +842,8 @@
 				compatible = "fsl,imx28-lcdif";
 				reg = <0x80030000 0x2000>;
 				interrupts = <38>;
-				clocks = <&clks 55>, <&clks 55>;
+				clocks = <&clks 55>, <&clks 55>, <&clks 55>;
+				clock-names = "pix", "axi", "disp_axi";
 				clock-names = "pix", "axi";
 				dmas = <&dma_apbh 13>;
 				dma-names = "rx";
diff --git a/arch/arm/boot/dts/imx6sl.dtsi b/arch/arm/boot/dts/imx6sl.dtsi
index b8834d5..87ee351 100644
--- a/arch/arm/boot/dts/imx6sl.dtsi
+++ b/arch/arm/boot/dts/imx6sl.dtsi
@@ -1066,8 +1066,9 @@
 				reg = <0x020f8000 0x4000>;
 				interrupts = <0 39 0x04>;
 				clocks = <&clks IMX6SL_CLK_LCDIF_PIX>,
-					 <&clks IMX6SL_CLK_LCDIF_AXI>;
-				clock-names = "pix", "axi";
+					 <&clks IMX6SL_CLK_LCDIF_AXI>,
+					 <&clks IMX6SL_CLK_DUMMY>;
+				clock-names = "pix", "axi", "disp_axi";
 				status = "disabled";
 			};
 
diff --git a/arch/arm/boot/dts/imx6sx-17x17-arm2.dts b/arch/arm/boot/dts/imx6sx-17x17-arm2.dts
index 8e11c8c..c0bef11 100644
--- a/arch/arm/boot/dts/imx6sx-17x17-arm2.dts
+++ b/arch/arm/boot/dts/imx6sx-17x17-arm2.dts
@@ -14,6 +14,13 @@
 	model = "Freescale i.MX6 SoloX 17x17 ARM2 Board";
 	compatible = "fsl,imx6sx-17x17-arm2", "fsl,imx6sx";
 
+	backlight {
+		compatible = "pwm-backlight";
+		pwms = <&pwm3 0 5000000>;
+		brightness-levels = <0 4 8 16 32 64 128 255>;
+		default-brightness-level = <6>;
+	};
+
 	memory {
 		reg = <0x80000000 0x40000000>;
 	};
@@ -74,6 +81,44 @@
         status = "okay";
 };
 
+&lcdif1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_lcdif_dat_0
+		     &pinctrl_lcdif_ctrl_0>;
+	display = <&display>;
+	status = "okay";
+
+	display: display {
+		bits-per-pixel = <16>;
+		bus-width = <24>;
+
+		display-timings {
+			native-mode = <&timing0>;
+			timing0: timing0 {
+				clock-frequency = <33500000>;
+				hactive = <800>;
+				vactive = <480>;
+				hback-porch = <89>;
+				hfront-porch = <164>;
+				vback-porch = <23>;
+				vfront-porch = <10>;
+				hsync-len = <10>;
+				vsync-len = <10>;
+				hsync-active = <0>;
+				vsync-active = <0>;
+				de-active = <1>;
+				pixelclk-active = <0>;
+			};
+		};
+	};
+};
+
+&pwm3 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_pwm3_0>;
+	status = "okay";
+};
+
 &uart1 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_uart1_1>;
diff --git a/arch/arm/boot/dts/imx6sx.dtsi b/arch/arm/boot/dts/imx6sx.dtsi
index c73f626..c5dfb75 100644
--- a/arch/arm/boot/dts/imx6sx.dtsi
+++ b/arch/arm/boot/dts/imx6sx.dtsi
@@ -397,6 +397,27 @@
 				reg = <0x02240000 0x40000>;
 				ranges;
 
+				lcdif1: lcdif@02220000 {
+					compatible = "fsl,imx6sx-lcdif", "fsl,imx28-lcdif";
+					reg = <0x02220000 0x4000>;
+					interrupts = <0 5 0x04>;
+					clocks = <&clks IMX6SX_CLK_LCDIF1_PIX>,
+						<&clks IMX6SX_CLK_LCDIF_APB>,
+						<&clks IMX6SX_CLK_DISPLAY_AXI>;
+					clock-names = "pix", "axi", "disp_axi";
+					status = "disabled";
+				};
+
+				lcdif2: lcdif@02224000 {
+					compatible = "fsl,imx6sx-lcdif", "fsl,imx28-lcdif";
+					reg = <0x02224000 0x4000>;
+					interrupts = <0 6 0x04>;
+					clocks = <&clks IMX6SX_CLK_LCDIF2_PIX>,
+						<&clks IMX6SX_CLK_LCDIF_APB>,
+						<&clks IMX6SX_CLK_DISPLAY_AXI>;
+					clock-names = "pix", "axi", "disp_axi";
+					status = "disabled";
+				};
 				spba@0223c000 {
 					reg = <0x0223c000 0x4000>;
 				};
@@ -506,6 +527,55 @@
 		};
 	};
 
+	lcdif1 {
+		pinctrl_lcdif_dat_0: lcdifdatgrp-0 {
+			fsl,pins = <
+				MX6SX_PAD_LCD1_DATA00__LCDIF1_DATA_0 0x1b0b0
+				MX6SX_PAD_LCD1_DATA01__LCDIF1_DATA_1 0x1b0b0
+				MX6SX_PAD_LCD1_DATA02__LCDIF1_DATA_2 0x1b0b0
+				MX6SX_PAD_LCD1_DATA03__LCDIF1_DATA_3 0x1b0b0
+				MX6SX_PAD_LCD1_DATA04__LCDIF1_DATA_4 0x1b0b0
+				MX6SX_PAD_LCD1_DATA05__LCDIF1_DATA_5 0x1b0b0
+				MX6SX_PAD_LCD1_DATA06__LCDIF1_DATA_6 0x1b0b0
+				MX6SX_PAD_LCD1_DATA07__LCDIF1_DATA_7 0x1b0b0
+				MX6SX_PAD_LCD1_DATA08__LCDIF1_DATA_8 0x1b0b0
+				MX6SX_PAD_LCD1_DATA09__LCDIF1_DATA_9 0x1b0b0
+				MX6SX_PAD_LCD1_DATA10__LCDIF1_DATA_10 0x1b0b0
+				MX6SX_PAD_LCD1_DATA11__LCDIF1_DATA_11 0x1b0b0
+				MX6SX_PAD_LCD1_DATA12__LCDIF1_DATA_12 0x1b0b0
+				MX6SX_PAD_LCD1_DATA13__LCDIF1_DATA_13 0x1b0b0
+				MX6SX_PAD_LCD1_DATA14__LCDIF1_DATA_14 0x1b0b0
+				MX6SX_PAD_LCD1_DATA15__LCDIF1_DATA_15 0x1b0b0
+				MX6SX_PAD_LCD1_DATA16__LCDIF1_DATA_16 0x1b0b0
+				MX6SX_PAD_LCD1_DATA17__LCDIF1_DATA_17 0x1b0b0
+				MX6SX_PAD_LCD1_DATA18__LCDIF1_DATA_18 0x1b0b0
+				MX6SX_PAD_LCD1_DATA19__LCDIF1_DATA_19 0x1b0b0
+				MX6SX_PAD_LCD1_DATA20__LCDIF1_DATA_20 0x1b0b0
+				MX6SX_PAD_LCD1_DATA21__LCDIF1_DATA_21 0x1b0b0
+				MX6SX_PAD_LCD1_DATA22__LCDIF1_DATA_22 0x1b0b0
+				MX6SX_PAD_LCD1_DATA23__LCDIF1_DATA_23 0x1b0b0
+			>;
+		};
+
+		pinctrl_lcdif_ctrl_0: lcdifctrlgrp-0 {
+			fsl,pins = <
+				MX6SX_PAD_LCD1_CLK__LCDIF1_CLK	0x1b0b0
+				MX6SX_PAD_LCD1_ENABLE__LCDIF1_ENABLE 0x1b0b0
+				MX6SX_PAD_LCD1_VSYNC__LCDIF1_VSYNC 0x1b0b0
+				MX6SX_PAD_LCD1_HSYNC__LCDIF1_HSYNC 0x1b0b0
+				MX6SX_PAD_LCD1_RESET__LCDIF1_RESET 0x1b0b0
+			>;
+		};
+	};
+
+	pwm3 {
+		pinctrl_pwm3_0: pwm3grp-0 {
+			fsl,pins = <
+				MX6SX_PAD_GPIO1_IO12__PWM3_OUT 0x110b0
+			>;
+		};
+	};
+
 	uart1 {
 		pinctrl_uart1_1: uart1grp-1 {
 			fsl,pins = <
-- 
1.7.5.4

