From f31f6cdabebf0e0004a19f64a8b7a37dd7ed8a19 Mon Sep 17 00:00:00 2001
From: Nicolin Chen <Guangyu.Chen@freescale.com>
Date: Tue, 8 Apr 2014 19:14:14 +0800
Subject: [PATCH 0381/1074] ENGR00307635-8 ARM: imx6sx: Add SAI support to
 each board level dts

SAI has pin conflicts with other moudles on all current boards of Solo X
and two sdma event conflicts with UART5.

Thus this patch adds new dtbs for SAI cases that occupy the pins and the
event IDs of SDMA.

Acked-by: Wang Shengjiu <b02247@freescale.com>
Signed-off-by: Nicolin Chen <Guangyu.Chen@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/boot/dts/Makefile                  |    4 ++
 arch/arm/boot/dts/imx6sx-17x17-arm2-sai.dts |   64 +++++++++++++++++++++++++++
 arch/arm/boot/dts/imx6sx-17x17-arm2-ssi.dts |   44 ++++++++++++++++++
 arch/arm/boot/dts/imx6sx-17x17-arm2.dts     |    6 +++
 arch/arm/boot/dts/imx6sx-19x19-arm2-sai.dts |   23 ++++++++++
 arch/arm/boot/dts/imx6sx-sdb-sai.dts        |   29 ++++++++++++
 arch/arm/boot/dts/imx6sx-sdb.dts            |    6 +++
 7 files changed, 176 insertions(+), 0 deletions(-)
 create mode 100644 arch/arm/boot/dts/imx6sx-17x17-arm2-sai.dts
 create mode 100644 arch/arm/boot/dts/imx6sx-17x17-arm2-ssi.dts
 create mode 100644 arch/arm/boot/dts/imx6sx-19x19-arm2-sai.dts
 create mode 100644 arch/arm/boot/dts/imx6sx-sdb-sai.dts

diff --git a/arch/arm/boot/dts/Makefile b/arch/arm/boot/dts/Makefile
index 14195c8..066aa93 100644
--- a/arch/arm/boot/dts/Makefile
+++ b/arch/arm/boot/dts/Makefile
@@ -183,11 +183,15 @@ dtb-$(CONFIG_ARCH_MXC) += \
 	imx6sl-evk-ldo.dtb \
 	imx6sl-evk-pf200.dtb \
 	imx6sx-17x17-arm2.dtb \
+	imx6sx-17x17-arm2-sai.dtb \
+	imx6sx-17x17-arm2-ssi.dtb \
 	imx6sx-17x17-arm2-spdif.dtb \
 	imx6sx-19x19-arm2.dtb \
 	imx6sx-19x19-arm2-lcdif1.dtb \
+	imx6sx-19x19-arm2-sai.dtb \
 	imx6sx-sdb.dtb \
 	imx6sx-sdb-lcdif1.dtb \
+	imx6sx-sdb-sai.dtb \
 	vf610-cosmic.dtb \
 	vf610-twr.dtb
 dtb-$(CONFIG_ARCH_MXS) += imx23-evk.dtb \
diff --git a/arch/arm/boot/dts/imx6sx-17x17-arm2-sai.dts b/arch/arm/boot/dts/imx6sx-17x17-arm2-sai.dts
new file mode 100644
index 0000000..f977f3c
--- /dev/null
+++ b/arch/arm/boot/dts/imx6sx-17x17-arm2-sai.dts
@@ -0,0 +1,64 @@
+/*
+ * Copyright (C) 2014 Freescale Semiconductor, Inc.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include "imx6sx-17x17-arm2.dts"
+
+/ {
+	sound {
+		cpu-dai = <&sai2>;
+	};
+};
+
+&audmux {
+	/* Pin conflict with SAI */
+	status = "disabled";
+};
+
+&pinctrl_hog_1 {
+	/* Pin conflict with SAI */
+	fsl,pins = <
+		MX6SX_PAD_QSPI1A_SS0_B__GPIO4_IO_22     0x80000000
+		/* CAN1_2_EN */
+		MX6SX_PAD_QSPI1B_DATA1__GPIO4_IO_25     0x17059
+		/* CAN1_2_STBY_B */
+		MX6SX_PAD_QSPI1B_DATA3__GPIO4_IO_27     0x17059
+		/* CAN1_ERR_B */
+		MX6SX_PAD_QSPI1B_DATA0__GPIO4_IO_24	0x17059
+		/* CAN2_ERR_B */
+		MX6SX_PAD_QSPI1B_SS0_B__GPIO4_IO_30     0x17059
+	>;
+};
+
+&reg_sdb_vmmc{
+	/* Pin conflict with SAI */
+	gpio = <0 0 0>;
+};
+
+&sai2 {
+	status = "okay";
+};
+
+&sdma {
+	/* SDMA event remap for SAI2 */
+	fsl,sdma-event-remap = <0 17 1>, <0 18 1>;
+};
+
+&usdhc2 {
+	/* Pin conflict with SAI */
+	status = "disabled";
+};
+
+&usdhc3 {
+	/* Pin conflict with SAI */
+	status = "disabled";
+};
+
+&usdhc4 {
+	/* Pin conflict with SAI */
+	status = "disabled";
+};
diff --git a/arch/arm/boot/dts/imx6sx-17x17-arm2-ssi.dts b/arch/arm/boot/dts/imx6sx-17x17-arm2-ssi.dts
new file mode 100644
index 0000000..07ea803
--- /dev/null
+++ b/arch/arm/boot/dts/imx6sx-17x17-arm2-ssi.dts
@@ -0,0 +1,44 @@
+/*
+ * Copyright (C) 2014 Freescale Semiconductor, Inc.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include "imx6sx-17x17-arm2.dts"
+
+&pinctrl_hog_1 {
+	/* Pin conflict with SSI */
+	fsl,pins = <
+		MX6SX_PAD_QSPI1A_SS0_B__GPIO4_IO_22     0x80000000
+		/* CAN1_2_EN */
+		MX6SX_PAD_QSPI1B_DATA1__GPIO4_IO_25     0x17059
+		/* CAN1_2_STBY_B */
+		MX6SX_PAD_QSPI1B_DATA3__GPIO4_IO_27     0x17059
+		/* CAN1_ERR_B */
+		MX6SX_PAD_QSPI1B_DATA0__GPIO4_IO_24	0x17059
+		/* CAN2_ERR_B */
+		MX6SX_PAD_QSPI1B_SS0_B__GPIO4_IO_30     0x17059
+	>;
+};
+
+&reg_sdb_vmmc{
+	/* Pin conflict with SSI */
+	gpio = <0 0 0>;
+};
+
+&usdhc2 {
+	/* Pin conflict with SSI */
+	status = "disabled";
+};
+
+&usdhc3 {
+	/* Pin conflict with SSI */
+	status = "disabled";
+};
+
+&usdhc4 {
+	/* Pin conflict with SSI */
+	status = "disabled";
+};
diff --git a/arch/arm/boot/dts/imx6sx-17x17-arm2.dts b/arch/arm/boot/dts/imx6sx-17x17-arm2.dts
index ebed132..50d1e08 100644
--- a/arch/arm/boot/dts/imx6sx-17x17-arm2.dts
+++ b/arch/arm/boot/dts/imx6sx-17x17-arm2.dts
@@ -414,6 +414,12 @@
 	};
 };
 
+&sai2 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_sai2_1>;
+	status = "disabled";
+};
+
 &spdif {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_spdif_1>;
diff --git a/arch/arm/boot/dts/imx6sx-19x19-arm2-sai.dts b/arch/arm/boot/dts/imx6sx-19x19-arm2-sai.dts
new file mode 100644
index 0000000..f0f2326
--- /dev/null
+++ b/arch/arm/boot/dts/imx6sx-19x19-arm2-sai.dts
@@ -0,0 +1,23 @@
+/*
+ * Copyright (C) 2014 Freescale Semiconductor, Inc.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include "imx6sx-19x19-arm2.dts"
+
+&esai {
+	/* pin conflict with sai */
+	status = "disabled";
+};
+
+&sai1 {
+	status = "okay";
+};
+
+&sdma {
+	/* SDMA event remap for SAI1 */
+	fsl,sdma-event-remap = <0 15 1>, <0 16 1>;
+};
diff --git a/arch/arm/boot/dts/imx6sx-sdb-sai.dts b/arch/arm/boot/dts/imx6sx-sdb-sai.dts
new file mode 100644
index 0000000..646aca7
--- /dev/null
+++ b/arch/arm/boot/dts/imx6sx-sdb-sai.dts
@@ -0,0 +1,29 @@
+/*
+ * Copyright (C) 2014 Freescale Semiconductor, Inc.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include "imx6sx-sdb.dts"
+
+/ {
+	sound {
+		cpu-dai = <&sai1>;
+	};
+};
+
+&audmux {
+	/* pin conflict with sai */
+	status = "disabled";
+};
+
+&sai1 {
+	status = "okay";
+};
+
+&sdma {
+	/* SDMA event remap for SAI1 */
+	fsl,sdma-event-remap = <0 15 1>, <0 16 1>;
+};
diff --git a/arch/arm/boot/dts/imx6sx-sdb.dts b/arch/arm/boot/dts/imx6sx-sdb.dts
index 44bfb26..ede4b54 100644
--- a/arch/arm/boot/dts/imx6sx-sdb.dts
+++ b/arch/arm/boot/dts/imx6sx-sdb.dts
@@ -384,6 +384,12 @@
 	status = "okay";
 };
 
+&sai1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_sai1_2>;
+	status = "disabled";
+}
+
 &uart1 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_uart1_1>;
-- 
1.7.5.4

