From 9f38116ce7b40bcd05d5160f4a0120855b58b64b Mon Sep 17 00:00:00 2001
From: Robby Cai <r63905@freescale.com>
Date: Mon, 30 Jun 2014 16:55:16 +0800
Subject: [PATCH 0433/1074] ENGR00320428 v4l2 capture: imx6sx: fix "csi_id is
 missing or invalid" issue

csi_id property is missing in dts file for imx6sx-sdb board, which
causes the following kernel dump when insert the csi_v4l2_capture module.
This patch fixed it.

udevd[122]: starting version 182
csi_v4l2 csi1_v4l2_cap.29: csi_id missing or invalid
Unable to handle kernel NULL pointer dereference at virtual address 00000034
pgd = a8c50000
[00000034] *pgd=a8c2f831, *pte=00000000, *ppte=00000000
Internal error: Oops: 817 [#1] PREEMPT SMP ARM
Modules linked in: evbug csi_v4l2_capture(+) fsl_csi
CPU: 0 PID: 147 Comm: udevd Not tainted 3.10.31-01988-gd965cfd-dirty #831
task: a8c95a40 ti: a8c4c000 task.ti: a8c4c000
PC is at csi_v4l2_probe+0x58/0xfc [csi_v4l2_capture]
LR is at csi_v4l2_probe+0x50/0xfc [csi_v4l2_capture]
pc : [<7f007efc>]    lr : [<7f007ef4>]    psr: a00f0113
sp : a8c4de40  ip : 600f0113  fp : 00097220
r10: 7f00c000  r9 : a8c4c000  r8 : 7f009d78
r7 : 00000000  r6 : a80ec810  r5 : a80ec800  r4 : 7f009f30
r3 : a8c03000  r2 : 00000000  r1 : a8c03000  r0 : 00000000
Flags: NzCv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user
Control: 10c53c7d  Table: a8c5004a  DAC: 00000015
Process udevd (pid: 147, stack limit = 0xa8c4c238)
Stack: (0xa8c4de40 to 0xa8c4e000)

This patch also changed csi_id for vadc to 1.

Signed-off-by: Robby Cai <r63905@freescale.com>
(cherry picked from commit 3c16fd041fa430bd4b601964b944daa2bc474c20)
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/boot/dts/imx6sx-sdb.dts |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/arm/boot/dts/imx6sx-sdb.dts b/arch/arm/boot/dts/imx6sx-sdb.dts
index 2e0e61e..4ecced3 100644
--- a/arch/arm/boot/dts/imx6sx-sdb.dts
+++ b/arch/arm/boot/dts/imx6sx-sdb.dts
@@ -121,6 +121,7 @@
 
 	csi1_v4l2_cap {
 		compatible = "fsl,imx6sx-csi-v4l2", "fsl,imx6sl-csi-v4l2";
+		csi_id = <0>;
 		status = "okay";
 	};
 };
@@ -589,6 +590,6 @@
 
 &vadc {
 	vadc_in = <0>;
-	csi_id = <0>;
+	csi_id = <1>;
 	status = "okay";
 };
-- 
1.7.5.4

