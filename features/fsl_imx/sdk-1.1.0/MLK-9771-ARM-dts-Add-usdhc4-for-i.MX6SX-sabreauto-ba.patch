From a2cbecfaf1de49ebf0588f8e0d8645501948118f Mon Sep 17 00:00:00 2001
From: Haibo Chen <haibo.chen@freescale.com>
Date: Thu, 30 Oct 2014 14:51:59 +0800
Subject: [PATCH 0512/1074] MLK-9771 ARM: dts: Add usdhc4 for
 i.MX6SX-sabreauto base board

The i.MX6SX-sabreauto board has an base board which contains a SD
slot, this SD slot is connect to usdhc4, so add usdhc4 in devicetree.

Due to the SD slot is on base board, if we set the usdhc4 pad drive
strength as 87 Ohm, the signal on these pads is not good, usdhc4 can't
get the SD card's status. So change the usdhc4 pad drive strength to
43 Ohm, then usdhc4 can work well for base board.

Signed-off-by: Haibo Chen <haibo.chen@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/boot/dts/imx6sx-sabreauto.dts |   12 ++++++++++++
 arch/arm/boot/dts/imx6sx.dtsi          |   15 +++++++++++++++
 2 files changed, 27 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/imx6sx-sabreauto.dts b/arch/arm/boot/dts/imx6sx-sabreauto.dts
index 10b994b..56e90b5 100644
--- a/arch/arm/boot/dts/imx6sx-sabreauto.dts
+++ b/arch/arm/boot/dts/imx6sx-sabreauto.dts
@@ -174,6 +174,7 @@
 	hog {
 		pinctrl_hog: hoggrp {
 			fsl,pins = <
+				MX6SX_PAD_USB_H_STROBE__GPIO7_IO_11 0x17059
 				MX6SX_PAD_USB_H_DATA__GPIO7_IO_10	0x17059
 				MX6SX_PAD_LCD1_DATA18__GPIO3_IO_19	0x17059
 				MX6SX_PAD_SD4_RESET_B__GPIO6_IO_22	0x80000000
@@ -511,6 +512,17 @@
 	status = "okay";
 };
 
+&usdhc4 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_usdhc4_3>;
+	bus-width = <8>;
+	cd-gpios = <&gpio7 11 0>;
+	no-1-8-v;
+	keep-power-in-suspend;
+	enable-sdio-wakup;
+	status = "okay";
+};
+
 &pwm4 {
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_pwm4_0>;
diff --git a/arch/arm/boot/dts/imx6sx.dtsi b/arch/arm/boot/dts/imx6sx.dtsi
index eb59b9b..95f3086 100644
--- a/arch/arm/boot/dts/imx6sx.dtsi
+++ b/arch/arm/boot/dts/imx6sx.dtsi
@@ -1638,6 +1638,21 @@
 				>;
 			};
 
+			pinctrl_usdhc4_3: usdhc4grp-3 {
+				fsl,pins = <
+					MX6SX_PAD_SD4_CMD__USDHC4_CMD     0x17071
+					MX6SX_PAD_SD4_CLK__USDHC4_CLK     0x10071
+					MX6SX_PAD_SD4_DATA0__USDHC4_DATA0 0x17071
+					MX6SX_PAD_SD4_DATA1__USDHC4_DATA1 0x17071
+					MX6SX_PAD_SD4_DATA2__USDHC4_DATA2 0x17071
+					MX6SX_PAD_SD4_DATA3__USDHC4_DATA3 0x17071
+					MX6SX_PAD_SD4_DATA4__USDHC4_DATA4 0x17071
+					MX6SX_PAD_SD4_DATA5__USDHC4_DATA5 0x17071
+					MX6SX_PAD_SD4_DATA6__USDHC4_DATA6 0x17071
+					MX6SX_PAD_SD4_DATA7__USDHC4_DATA7 0x17071
+				>;
+			};
+
 	};
 
 	weim {
-- 
1.7.5.4

