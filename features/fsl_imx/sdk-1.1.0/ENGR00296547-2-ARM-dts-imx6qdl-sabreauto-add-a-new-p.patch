From 4c1ac507890ee3aed398b03e2b8914551e0eee03 Mon Sep 17 00:00:00 2001
From: Huang Shijie <b32955@freescale.com>
Date: Sun, 26 Jan 2014 10:58:14 +0800
Subject: [PATCH 0258/1074] ENGR00296547-2 ARM: dts: imx6qdl-sabreauto: add a
 new pinctrl for ECSPI1

The ECSPI1 needs the GPIO3_19 to select/de-select the SPI NOR chip.

This patch adds a new pinctrl for this GPIO, and select this pinctrl
when we enable the ECSPI1.

Signed-off-by: Huang Shijie <b32955@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 arch/arm/boot/dts/imx6qdl-sabreauto.dtsi |    2 +-
 arch/arm/boot/dts/imx6qdl.dtsi           |    6 ++++++
 2 files changed, 7 insertions(+), 1 deletions(-)

diff --git a/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi b/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
index c67a770..415215c 100644
--- a/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
@@ -170,7 +170,7 @@
 	fsl,spi-num-chipselects = <1>;
 	cs-gpios = <&gpio3 19 0>;
 	pinctrl-names = "default";
-	pinctrl-0 = <&pinctrl_ecspi1_1>;
+	pinctrl-0 = <&pinctrl_ecspi1_1 &pinctrl_ecspi1_cs_1>;
 
 	flash: m25p80@0 {
 		#address-cells = <1>;
diff --git a/arch/arm/boot/dts/imx6qdl.dtsi b/arch/arm/boot/dts/imx6qdl.dtsi
index 9167073..c4902e2 100644
--- a/arch/arm/boot/dts/imx6qdl.dtsi
+++ b/arch/arm/boot/dts/imx6qdl.dtsi
@@ -688,6 +688,12 @@
 				};
 
 				ecspi1 {
+					pinctrl_ecspi1_cs_1: ecspi1_cs_grp-1 {
+						fsl,pins = <
+							MX6QDL_PAD_EIM_D19__GPIO3_IO19 0x80000000
+						>;
+					};
+
 					pinctrl_ecspi1_1: ecspi1grp-1 {
 						fsl,pins = <
 							MX6QDL_PAD_EIM_D17__ECSPI1_MISO 0x100b1
-- 
1.7.5.4

