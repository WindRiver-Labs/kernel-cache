From 8a989f9550d7ab25cce328da08a5601101eb7ec1 Mon Sep 17 00:00:00 2001
From: Fancy Fang <B47543@freescale.com>
Date: Wed, 11 Dec 2013 18:48:44 +0800
Subject: [PATCH 0660/1074] ENGR00291731 PXP: move pxp_irq_info definition
 from PXP dma to PXP device

struct pxp_irq_info is only used by PXP device driver, so it is unreasonable
to define it in pxp_dma.h which will be included by EPDC, V4L2 PXP and PXP
device driver.

Signed-off-by: Fancy Fang <B47543@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 drivers/dma/pxp/pxp_device.c |    9 ++++++++-
 include/linux/pxp_dma.h      |    7 -------
 2 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/drivers/dma/pxp/pxp_device.c b/drivers/dma/pxp/pxp_device.c
index efe1eeb..2c28294 100644
--- a/drivers/dma/pxp/pxp_device.c
+++ b/drivers/dma/pxp/pxp_device.c
@@ -37,7 +37,6 @@ static DEFINE_SPINLOCK(pxp_mem_lock);
 static DEFINE_SPINLOCK(pxp_chan_lock);
 static LIST_HEAD(head);
 static LIST_HEAD(list);
-static struct pxp_irq_info irq_info[NR_PXP_VIRT_CHANNEL];
 
 struct pxp_chan_handle {
 	int chan_id;
@@ -55,6 +54,14 @@ struct pxp_chan_info {
 	struct list_head list;
 };
 
+struct pxp_irq_info {
+	wait_queue_head_t waitq;
+	int irq_pending;
+	int hist_status;
+	spinlock_t lock;
+};
+static struct pxp_irq_info irq_info[NR_PXP_VIRT_CHANNEL];
+
 static int pxp_alloc_dma_buffer(struct pxp_mem_desc *mem)
 {
 	mem->cpu_addr = (unsigned long)
diff --git a/include/linux/pxp_dma.h b/include/linux/pxp_dma.h
index 613d89f..0961753 100644
--- a/include/linux/pxp_dma.h
+++ b/include/linux/pxp_dma.h
@@ -55,13 +55,6 @@ struct pxp_channel {
 	char eof_name[16];	/* EOF IRQ name for request_irq()  */
 };
 
-struct pxp_irq_info {
-	wait_queue_head_t waitq;
-	int irq_pending;
-	int hist_status;
-	spinlock_t lock;
-};
-
 #define to_tx_desc(tx) container_of(tx, struct pxp_tx_desc, txd)
 #define to_pxp_channel(d) container_of(d, struct pxp_channel, dma_chan)
 
-- 
1.7.5.4

