From 55e76960013823a09fd0cee6f41c5e51ebb5465a Mon Sep 17 00:00:00 2001
From: Liu Ying <Ying.Liu@freescale.com>
Date: Wed, 18 Dec 2013 10:03:22 +0800
Subject: [PATCH 0667/1074] ENGR00291103 IPUv3 common:Don't initialize PRP_VF
 for MEM_VDI_MEM

Since the channel MEM_VDI_MEM doesn't use the PRP_VF task, this
patch removes the code to initialize the PRP_VF task for the
channel MEM_VDI_MEM. This change may fix the issue caused by
the unnesessary PRP_VF task output resolution limitation check.
The issue can be reproduced by the following unit test case:

mxc_vpu_test.out -D "-f 2 -y 2 -v m -i
1080i_shields1088i2997_shields_ter_4x300_15fps_track1.h264"

Signed-off-by: Liu Ying <Ying.Liu@freescale.com>
[Original patch taken from git://git.freescale.com/imx/linux-2.6-imx.git]
Signed-off-by: Biyao Zhai <biyao.zhai@windriver.com>
---
 drivers/mxc/ipu3/ipu_common.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

diff --git a/drivers/mxc/ipu3/ipu_common.c b/drivers/mxc/ipu3/ipu_common.c
index a31fb97..df467d2 100644
--- a/drivers/mxc/ipu3/ipu_common.c
+++ b/drivers/mxc/ipu3/ipu_common.c
@@ -802,7 +802,6 @@ int32_t ipu_init_channel(struct ipu_soc *ipu, ipu_channel_t channel, ipu_channel
 		ipu->using_ic_dirct_ch = MEM_VDI_MEM;
 		ipu->ic_use_count++;
 		ipu->vdi_use_count++;
-		_ipu_ic_init_prpvf(ipu, params, false);
 		_ipu_vdi_init(ipu, channel, params);
 		break;
 	case MEM_ROT_VF_MEM:
@@ -1043,7 +1042,6 @@ void ipu_uninit_channel(struct ipu_soc *ipu, ipu_channel_t channel)
 		ipu->vdi_use_count--;
 		if (ipu->using_ic_dirct_ch == MEM_VDI_MEM)
 			ipu->using_ic_dirct_ch = 0;
-		_ipu_ic_uninit_prpvf(ipu);
 		_ipu_vdi_uninit(ipu);
 		break;
 	case MEM_VDI_PRP_VF_MEM_P:
-- 
1.7.5.4

