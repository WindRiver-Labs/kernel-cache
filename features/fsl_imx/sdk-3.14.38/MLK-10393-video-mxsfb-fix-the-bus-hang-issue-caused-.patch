From af54c9297c1300ca9ec1492da424982bd49f888f Mon Sep 17 00:00:00 2001
From: Fancy Fang <chen.fang@freescale.com>
Date: Tue, 10 Mar 2015 14:18:16 +0800
Subject: [PATCH 0878/1594] MLK-10393 video: mxsfb: fix the bus hang issue
 caused by lcdif register access

commit d331acf68d00105660707b644d95ffa3d67f11e9 from
git://git.freescale.com/imx/linux-2.6-imx.git

In 7D platform, the pixel clock should also be enabled
when accesing the lcdif registers. Otherwise, the bus
will be hang.

Signed-off-by: Fancy Fang <chen.fang@freescale.com>
---
 drivers/video/fbdev/mxsfb.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/video/fbdev/mxsfb.c b/drivers/video/fbdev/mxsfb.c
index 1969496..9754dc4 100644
--- a/drivers/video/fbdev/mxsfb.c
+++ b/drivers/video/fbdev/mxsfb.c
@@ -624,6 +624,7 @@ static int mxsfb_set_par(struct fb_info *fb_info)
 
 	mxsfb_enable_axi_clk(host);
 	clk_enable_disp_axi(host);
+	clk_prepare_enable(host->clk);
 
 	sema_init(&host->flip_sem, 1);
 
@@ -879,6 +880,7 @@ static int mxsfb_pan_display(struct fb_var_screeninfo *var,
 	}
 
 	clk_enable_disp_axi(host);
+	clk_prepare_enable(host->clk);
 
 	offset = fb_info->fix.line_length * var->yoffset;
 
-- 
1.7.5.4

