From e1171783995b5c85afc939abbe9482bd33bccac8 Mon Sep 17 00:00:00 2001
From: Bai Ping <b51503@freescale.com>
Date: Fri, 26 Jun 2015 23:07:19 +0800
Subject: [PATCH 1256/1594] MLK-11178-02 thermal: imx: disbale hardware reset
 funtion on imx7

commit d6ba85e73f9fd7fa71d0e4b815c25906d10a609d from
git://git.freescale.com/imx/linux-2.6-imx.git

As per to the design team, use the software poweroff when critical
trip temp reached. No need to set the panic alam register bits
when using the software poweroff as the critical trip action.

Signed-off-by: Bai Ping <b51503@freescale.com>
---
 drivers/thermal/imx_thermal.c |    5 ++---
 1 files changed, 2 insertions(+), 3 deletions(-)

diff --git a/drivers/thermal/imx_thermal.c b/drivers/thermal/imx_thermal.c
index 3d8f4c7..6d25025 100644
--- a/drivers/thermal/imx_thermal.c
+++ b/drivers/thermal/imx_thermal.c
@@ -397,7 +397,7 @@ static int imx_set_trip_temp(struct thermal_zone_device *tz, int trip,
 
 	if (trip == IMX_TRIP_CRITICAL) {
 		data->temp_critical = temp;
-		if (data->socdata->version != TEMPMON_IMX6Q)
+		if (data->socdata->version == TEMPMON_IMX6SX)
 			imx_set_panic_temp(data, temp);
 	}
 
@@ -760,8 +760,7 @@ static int imx_thermal_probe(struct platform_device *pdev)
 
 	/* Enable measurements at ~ 10 Hz */
 	measure_freq = DIV_ROUND_UP(32768, 10); /* 10 Hz */
-	if (data->socdata->version != TEMPMON_V3)
-		regmap_field_write(data->measure_freq, measure_freq);
+	regmap_field_write(data->measure_freq, measure_freq);
 	imx_set_alarm_temp(data, data->temp_passive);
 
 	if (data->socdata->version == TEMPMON_IMX6SX)
-- 
1.7.5.4

