From 901e14dedb9a8e758267583e0fde2a8653f0d8e8 Mon Sep 17 00:00:00 2001
From: Ryan QIAN <b32804@freescale.com>
Date: Wed, 16 Jan 2013 10:23:28 +0800
Subject: [PATCH 0693/1594] ENGR00240226-07 mmc: add delay after CMD6 befoer
 sending CMD13 for sandisk

commit cab933836498df2ae83392b259674c28a0fdcbdc from
git://git.freescale.com/imx/linux-2.6-imx.git

- Some sandisk emmc cards need certain delay befor sending cmd13 after
cmd6. Original CR: ENGR174296 (commit: fd031f9)

Acked-by: Aisheng Dong <b29396@freescale.com>
Signed-off-by: Ryan QIAN <b32804@freescale.com>
(cherry picked from commit f942bf1db36355d46f38792601594949f3f2c71b)
---
 drivers/mmc/core/mmc_ops.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/drivers/mmc/core/mmc_ops.c b/drivers/mmc/core/mmc_ops.c
index 0ea042d..818091c 100644
--- a/drivers/mmc/core/mmc_ops.c
+++ b/drivers/mmc/core/mmc_ops.c
@@ -513,6 +513,12 @@ int __mmc_switch(struct mmc_card *card, u8 set, u8 index, u8 value,
 		return 0;
 
 	/*
+	 * WORKAROUND: for Sandisk eMMC cards, it might need certain delay
+	 * before sending CMD13 after CMD6
+	 */
+	mdelay(1);
+
+	/*
 	 * CRC errors shall only be ignored in cases were CMD13 is used to poll
 	 * to detect busy completion.
 	 */
-- 
1.7.5.4

