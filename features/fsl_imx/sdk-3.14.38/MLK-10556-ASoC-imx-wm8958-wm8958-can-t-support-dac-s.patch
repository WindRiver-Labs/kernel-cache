From 0af805c45c1c4f63e81587e42ae213cc5c3994a6 Mon Sep 17 00:00:00 2001
From: Zidan Wang <zidan.wang@freescale.com>
Date: Thu, 2 Apr 2015 11:39:00 +0800
Subject: [PATCH 0930/1594] MLK-10556 ASoC: imx-wm8958: wm8958 can't support
 dac sample rate 64kHZ

commit cc186e50082f981b6d96b85ab269a574c129fb0b from
git://git.freescale.com/imx/linux-2.6-imx.git

wm8958 can't support dac sample rate 64kHZ, so add a constraint
list for it.

Signed-off-by: Zidan Wang <zidan.wang@freescale.com>
---
 sound/soc/fsl/imx-wm8958.c |   14 ++++++++++++++
 1 files changed, 14 insertions(+), 0 deletions(-)

diff --git a/sound/soc/fsl/imx-wm8958.c b/sound/soc/fsl/imx-wm8958.c
index 97a8dd6..1d02eff 100644
--- a/sound/soc/fsl/imx-wm8958.c
+++ b/sound/soc/fsl/imx-wm8958.c
@@ -228,16 +228,27 @@ static int imx_hifi_hw_free(struct snd_pcm_substream *substream)
 
 	return 0;
 }
+
 static u32 imx_wm8958_adc_rates[] = {
 	8000, 11025, 12000, 16000, 22050,
 	24000, 32000, 44100, 48000
 };
 
+static u32 imx_wm8958_dac_rates[] = {
+	8000, 11025, 12000, 16000, 22050,
+	24000, 32000, 44100, 48000, 88200, 96000
+};
+
 static struct snd_pcm_hw_constraint_list imx_wm8958_adc_rate_constraints = {
 	.count = ARRAY_SIZE(imx_wm8958_adc_rates),
 	.list = imx_wm8958_adc_rates,
 };
 
+static struct snd_pcm_hw_constraint_list imx_wm8958_dac_rate_constraints = {
+	.count = ARRAY_SIZE(imx_wm8958_dac_rates),
+	.list = imx_wm8958_dac_rates,
+};
+
 static int imx_hifi_startup(struct snd_pcm_substream *substream)
 {
 	struct snd_soc_pcm_runtime *rtd = substream->private_data;
@@ -256,6 +267,9 @@ static int imx_hifi_startup(struct snd_pcm_substream *substream)
 	if (substream->stream == SNDRV_PCM_STREAM_CAPTURE)
 		ret = snd_pcm_hw_constraint_list(substream->runtime, 0,
 			SNDRV_PCM_HW_PARAM_RATE, &imx_wm8958_adc_rate_constraints);
+	else if (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)
+		ret = snd_pcm_hw_constraint_list(substream->runtime, 0,
+			SNDRV_PCM_HW_PARAM_RATE, &imx_wm8958_dac_rate_constraints);
 	return ret;
 }
 
-- 
1.7.5.4

