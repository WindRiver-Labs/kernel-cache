From 06893a293ff4c5612a27de38f21fe3a512ff4e2b Mon Sep 17 00:00:00 2001
From: Robin Gong <b38343@freescale.com>
Date: Mon, 15 Sep 2014 13:33:46 +0800
Subject: [PATCH 0165/1594] ENGR00331450-4: ARM: dts: imx6q/dl: add ldo-bypass
 support

commit c94c3075755f814f05e021c42851f797525bce89 from
git://git.freescale.com/imx/linux-2.6-imx.git

Add ldo-bypass support on imx6q/dl. Currently, we use ldo-bypass
mode on imx6qdl-sabresd board, and ldo-enabled mode on imx6dl-sabre
auto board.

Signed-off-by: Robin Gong <b38343@freescale.com>
---
 arch/arm/boot/dts/imx6dl-sabresd.dts   |    5 +++++
 arch/arm/boot/dts/imx6dl.dtsi          |    2 +-
 arch/arm/boot/dts/imx6q-sabresd.dts    |    5 +++++
 arch/arm/boot/dts/imx6q.dtsi           |    2 +-
 arch/arm/boot/dts/imx6qdl-sabresd.dtsi |    5 +++++
 arch/arm/boot/dts/imx6qdl.dtsi         |    3 +++
 6 files changed, 20 insertions(+), 2 deletions(-)

diff --git a/arch/arm/boot/dts/imx6dl-sabresd.dts b/arch/arm/boot/dts/imx6dl-sabresd.dts
index e9da1b1..3d1ffed 100644
--- a/arch/arm/boot/dts/imx6dl-sabresd.dts
+++ b/arch/arm/boot/dts/imx6dl-sabresd.dts
@@ -22,6 +22,11 @@
 	offset-usb-charger = <1285>;
 };
 
+&cpu0 {
+	arm-supply = <&sw1a_reg>;
+	soc-supply = <&sw1c_reg>;
+};
+
 &ldb {
 	lvds-channel@0 {
 		crtc = "ipu1-di0";
diff --git a/arch/arm/boot/dts/imx6dl.dtsi b/arch/arm/boot/dts/imx6dl.dtsi
index fe29461..5e3331c 100644
--- a/arch/arm/boot/dts/imx6dl.dtsi
+++ b/arch/arm/boot/dts/imx6dl.dtsi
@@ -21,7 +21,7 @@
 		#address-cells = <1>;
 		#size-cells = <0>;
 
-		cpu@0 {
+		cpu0: cpu@0 {
 			compatible = "arm,cortex-a9";
 			device_type = "cpu";
 			reg = <0>;
diff --git a/arch/arm/boot/dts/imx6q-sabresd.dts b/arch/arm/boot/dts/imx6q-sabresd.dts
index 44ea024..bb0e4f9 100644
--- a/arch/arm/boot/dts/imx6q-sabresd.dts
+++ b/arch/arm/boot/dts/imx6q-sabresd.dts
@@ -26,6 +26,11 @@
 	offset-usb-charger = <1685>;
 };
 
+&cpu0 {
+	arm-supply = <&sw1a_reg>;
+	soc-supply = <&sw1c_reg>;
+};
+
 &ldb {
 	lvds-channel@0 {
 		crtc = "ipu2-di0";
diff --git a/arch/arm/boot/dts/imx6q.dtsi b/arch/arm/boot/dts/imx6q.dtsi
index 5bf7889..a281077 100644
--- a/arch/arm/boot/dts/imx6q.dtsi
+++ b/arch/arm/boot/dts/imx6q.dtsi
@@ -22,7 +22,7 @@
 		#address-cells = <1>;
 		#size-cells = <0>;
 
-		cpu@0 {
+		cpu0: cpu@0 {
 			compatible = "arm,cortex-a9";
 			device_type = "cpu";
 			reg = <0>;
diff --git a/arch/arm/boot/dts/imx6qdl-sabresd.dtsi b/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
index 5d44eb4..43ce256 100644
--- a/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
@@ -714,6 +714,11 @@
 	status = "okay";
 };
 
+&gpc {
+	/* use ldo-bypass, u-boot will check it and configure */
+	fsl,ldo-bypass = <1>;
+};
+
 &hdmi_audio {
 	status = "okay";
 };
diff --git a/arch/arm/boot/dts/imx6qdl.dtsi b/arch/arm/boot/dts/imx6qdl.dtsi
index 13c4235..7af0dad 100644
--- a/arch/arm/boot/dts/imx6qdl.dtsi
+++ b/arch/arm/boot/dts/imx6qdl.dtsi
@@ -640,6 +640,7 @@
 					anatop-min-bit-val = <1>;
 					anatop-min-voltage = <725000>;
 					anatop-max-voltage = <1450000>;
+					regulator-allow-bypass;
 				};
 
 				reg_pu: regulator-vddpu@140 {
@@ -657,6 +658,7 @@
 					anatop-min-bit-val = <1>;
 					anatop-min-voltage = <725000>;
 					anatop-max-voltage = <1450000>;
+					regulator-allow-bypass;
 				};
 
 				reg_soc: regulator-vddsoc@140 {
@@ -674,6 +676,7 @@
 					anatop-min-bit-val = <1>;
 					anatop-min-voltage = <725000>;
 					anatop-max-voltage = <1450000>;
+					regulator-allow-bypass;
 				};
 			};
 
-- 
1.7.5.4

