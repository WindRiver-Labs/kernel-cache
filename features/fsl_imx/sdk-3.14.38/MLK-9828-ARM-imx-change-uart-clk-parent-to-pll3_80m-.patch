From a4cdaaeeb7a4d69ae33bb6616b8863c37446e0d5 Mon Sep 17 00:00:00 2001
From: Fugang Duan <b38611@freescale.com>
Date: Mon, 8 Dec 2014 16:27:54 +0800
Subject: [PATCH 0464/1594] MLK-9828 ARM: imx: change uart clk parent to
 pll3_80m on i.mx6sx in default

commit 10507697dac4dcebd318f5d7f6414a0cb81dfcdf from
git://git.freescale.com/imx/linux-2.6-imx.git

By default, uboot set uart clk parent to OSC to make UART work when M4
is enabled. In the situation, uart maximum baud rate only reach at 1.5Mbps
that cannot match real case requirement.

The patch set the uart module clock source to pll3_80m in default. If
test low power case, it needs to add "uart_from_osc" in kernel command line.

Signed-off-by: Fugang Duan <B38611@freescale.com>
---
 arch/arm/mach-imx/clk-imx6sx.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-imx/clk-imx6sx.c b/arch/arm/mach-imx/clk-imx6sx.c
index f6a12a2..37265b8 100644
--- a/arch/arm/mach-imx/clk-imx6sx.c
+++ b/arch/arm/mach-imx/clk-imx6sx.c
@@ -633,6 +633,8 @@ static void __init imx6sx_clocks_init(struct device_node *ccm_node)
 	/* Set the UART parent if needed. */
 	if (uart_from_osc)
 		imx_clk_set_parent(clks[IMX6SX_CLK_UART_SEL], clks[IMX6SX_CLK_OSC]);
+	else
+		imx_clk_set_parent(clks[IMX6SX_CLK_UART_SEL], clks[IMX6SX_CLK_PLL3_80M]);
 
 	/* pll2_bus is the best parent of QSPI clock */
 	imx_clk_set_parent(clks[IMX6SX_CLK_QSPI1_SEL], clks[IMX6SX_CLK_PLL2_BUS]);
-- 
1.7.5.4

