From 69804572e6a2f15db77c7339388232a6e29349d0 Mon Sep 17 00:00:00 2001
From: Richard Zhu <Richard.Zhu@freescale.com>
Date: Tue, 18 Nov 2014 10:20:03 +0800
Subject: [PATCH 0740/1594] MLK-9870 mcc: sema4: mutex lock should be
 initiazled

commit 35e90e1aaa53d69ac18c0d731db69e85ab416ddf from
git://git.freescale.com/imx/linux-2.6-imx.git

mutex lock should be initialized, otherwise
there maybe kernel BUG warning.
"BUG: spinlock bad magic on CPU#0, swapper/0/1"

Signed-off-by: Richard Zhu <Richard.Zhu@freescale.com>
(cherry picked from commit 5db690b478afea00ca226f200ddf892b691674dd)
---
 drivers/char/imx_mcc/imx_sema4.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/char/imx_mcc/imx_sema4.c b/drivers/char/imx_mcc/imx_sema4.c
index a32ec2d..24bb6d7 100644
--- a/drivers/char/imx_mcc/imx_sema4.c
+++ b/drivers/char/imx_mcc/imx_sema4.c
@@ -342,6 +342,7 @@ static int imx_sema4_probe(struct platform_device *pdev)
 
 	imx6_sema4->dev = &pdev->dev;
 	imx6_sema4->cpine_val = 0;
+	spin_lock_init(&imx6_sema4->lock);
 
 	res = platform_get_resource(pdev, IORESOURCE_MEM, 0);
 	if (IS_ERR(res)) {
-- 
1.7.5.4

