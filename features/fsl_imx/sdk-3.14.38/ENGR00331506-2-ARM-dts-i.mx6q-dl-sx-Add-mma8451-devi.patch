From b3f147d3e80127eb7a133d89d132d022107a4fe3 Mon Sep 17 00:00:00 2001
From: luweizhou <b45643@freescale.com>
Date: Mon, 15 Sep 2014 16:34:31 +0800
Subject: [PATCH 0162/1594] ENGR00331506-2 ARM: dts: i.mx6q/dl/sx: Add mma8451
 device tree support.

commit 3cdba9373d4fb1204d01b7792c552171e488dfe4 from
git://git.freescale.com/imx/linux-2.6-imx.git

Add mma8451 sensor device tree support on i.MX6Q/DL/SX platform.

Signed-off-by: Luwei Zhou <b45643@freescale.com>
---
 arch/arm/boot/dts/imx6qdl-sabreauto.dtsi |   10 ++++++++++
 arch/arm/boot/dts/imx6qdl-sabresd.dtsi   |   24 ++++++++++++++++++++++++
 arch/arm/boot/dts/imx6sx-sdb.dtsi        |   18 ++++++++++++++++++
 3 files changed, 52 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi b/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
index 36ff497..a48cda4 100644
--- a/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-sabreauto.dtsi
@@ -239,6 +239,15 @@
 		gpio-controller;
 		#gpio-cells = <2>;
 	};
+
+	mma8451@1c {
+		compatible = "fsl,mma8451";
+		reg = <0x1c>;
+		position = <7>;
+		interrupt-parent = <&gpio6>;
+		interrupts = <31 8>;
+		interrupt-route = <1>;
+	};
 };
 
 &mlb {
@@ -259,6 +268,7 @@
 				MX6QDL_PAD_GPIO_18__SD3_VSELECT 0x17059
 				MX6QDL_PAD_EIM_A24__GPIO5_IO04   0x80000000
 				MX6QDL_PAD_SD2_DAT0__GPIO1_IO15  0x80000000
+				MX6QDL_PAD_EIM_BCLK__GPIO6_IO31 0x80000000
 			>;
 		};
 
diff --git a/arch/arm/boot/dts/imx6qdl-sabresd.dtsi b/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
index f27e839..6bc0430 100644
--- a/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-sabresd.dtsi
@@ -77,6 +77,17 @@
 			enable-active-high;
 		};
 
+		reg_sensor: regulator@4 {
+			compatible = "regulator-fixed";
+			reg = <3>;
+			regulator-name = "sensor-supply";
+			regulator-min-microvolt = <3300000>;
+			regulator-max-microvolt = <3300000>;
+			gpio = <&gpio2 31 0>;
+			startup-delay-us = <500>;
+			enable-active-high;
+		};
+
 		reg_pcie: regulator@3 {
 			compatible = "regulator-fixed";
 			reg = <3>;
@@ -281,6 +292,17 @@
 			0x0000 /* 5:Default */
 		>;
        };
+
+	mma8451@1c {
+		compatible = "fsl,mma8451";
+		reg = <0x1c>;
+		position = <0>;
+		vdd-supply = <&reg_sensor>;
+		vddio-supply = <&reg_sensor>;
+		interrupt-parent = <&gpio1>;
+		interrupts = <18 8>;
+		interrupt-route = <1>;
+	};
 };
 
 &i2c2 {
@@ -439,6 +461,8 @@
 				MX6QDL_PAD_ENET_RXD0__GPIO1_IO27 0x1b0b0
 				MX6QDL_PAD_EIM_A25__GPIO5_IO02 0x1b0b0
 				MX6QDL_PAD_EIM_D23__GPIO3_IO23 0x1b0b0
+				MX6QDL_PAD_EIM_EB3__GPIO2_IO31 0x1b0b0
+				MX6QDL_PAD_SD1_CMD__GPIO1_IO18 0x1b0b0
 			>;
 		};
 
diff --git a/arch/arm/boot/dts/imx6sx-sdb.dtsi b/arch/arm/boot/dts/imx6sx-sdb.dtsi
index 8973ac5..1810829 100644
--- a/arch/arm/boot/dts/imx6sx-sdb.dtsi
+++ b/arch/arm/boot/dts/imx6sx-sdb.dtsi
@@ -403,10 +403,28 @@
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_i2c3>;
 	status = "okay";
+
+	mma8451@1c {
+		compatible = "fsl,mma8451";
+		reg = <0x1c>;
+		position = <1>;
+		interrupt-parent = <&gpio6>;
+		interrupts = <2 8>;
+		interrupt-route = <2>;
+	};
 };
 
 &iomuxc {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_hog>;
+
 	imx6x-sdb {
+		pinctrl_hog: hoggrp {
+			fsl,pins = <
+				MX6SX_PAD_SD1_DATA0__GPIO6_IO_2 0x17059
+			>;
+		};
+
 		pinctrl_canfd1: canfd1grp-1 {
 			fsl,pins = <
 				MX6SX_PAD_QSPI1B_DQS__CANFD_TX1         0x1b0b0
-- 
1.7.5.4

