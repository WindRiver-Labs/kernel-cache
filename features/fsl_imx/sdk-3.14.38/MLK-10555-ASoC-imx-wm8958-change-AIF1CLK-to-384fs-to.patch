From 2ae2238d7a763076c42ebdf432069f8f211bf744 Mon Sep 17 00:00:00 2001
From: Zidan Wang <zidan.wang@freescale.com>
Date: Thu, 2 Apr 2015 15:36:14 +0800
Subject: [PATCH 0934/1594] MLK-10555 ASoC: imx-wm8958: change AIF1CLK to
 384fs to get accurate sample rate for 24 bit word
 length

commit 45f0bc8b21b79e779b47ab4e4a94de8bafb00a51 from
git://git.freescale.com/imx/linux-2.6-imx.git

change AIF1CLK to 384fs to get accurate sample rate for 24 bit word length.

Signed-off-by: Zidan Wang <zidan.wang@freescale.com>
---
 sound/soc/fsl/imx-wm8958.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/sound/soc/fsl/imx-wm8958.c b/sound/soc/fsl/imx-wm8958.c
index 1d02eff..adf543e 100644
--- a/sound/soc/fsl/imx-wm8958.c
+++ b/sound/soc/fsl/imx-wm8958.c
@@ -163,7 +163,10 @@ static int imx_hifi_hw_params(struct snd_pcm_substream *substream,
 	} else {
 		data->sr_stream[tx] = params_rate(params);
 
-		pll_out = data->sr_stream[tx] * 256;
+		if (params_width(params) == 24)
+			pll_out = data->sr_stream[tx] * 384;
+		else
+			pll_out = data->sr_stream[tx] * 256;
 
 		ret = snd_soc_dai_set_pll(codec_dai, WM8994_FLL1,
 					  WM8994_FLL_SRC_MCLK1,
-- 
1.7.5.4

