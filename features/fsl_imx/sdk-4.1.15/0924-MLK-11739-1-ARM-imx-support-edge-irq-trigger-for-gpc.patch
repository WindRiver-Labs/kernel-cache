From f46b4708c5aa4b8844c3c8120a178311ac185d4f Mon Sep 17 00:00:00 2001
From: Anson Huang <b20788@freescale.com>
Date: Mon, 19 Oct 2015 16:36:05 +0800
Subject: [PATCH 0924/1691] MLK-11739-1 ARM: imx: support edge irq trigger for
 gpc

commit f46b4708c5aa4b8844c3c8120a178311ac185d4f from
git://git.freescale.com/imx/linux-2.6-imx.git imx_4.1.15_1.0.0_ga

GPC irq domain is a child domain of GIC, now all of
platform irqs are inside GPC domain, during the module
populate, all devices irq should have correct type
setting in GIC, however, there is no .irq_set_type
callback setting in GPC, so the irq_set_type will be
skipped and cause edge raising type of irq work
abnormally after kernel boot up.

Since GPC has no irq type, so just tell kernel to
use irq_chip_set_type_parent instead.

Signed-off-by: Anson Huang <b20788@freescale.com>
---
 arch/arm/mach-imx/gpc.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/arch/arm/mach-imx/gpc.c b/arch/arm/mach-imx/gpc.c
index 7e43d06..bda6385 100644
--- a/arch/arm/mach-imx/gpc.c
+++ b/arch/arm/mach-imx/gpc.c
@@ -309,6 +309,7 @@ static struct irq_chip imx_gpc_chip = {
 	.irq_unmask		= imx_gpc_irq_unmask,
 	.irq_retrigger		= irq_chip_retrigger_hierarchy,
 	.irq_set_wake		= imx_gpc_irq_set_wake,
+	.irq_set_type           = irq_chip_set_type_parent,
 #ifdef CONFIG_SMP
 	.irq_set_affinity	= irq_chip_set_affinity_parent,
 #endif
-- 
1.9.1

