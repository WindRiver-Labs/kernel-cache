From 02eeea4cc9c8cb6819bc00a869bac9e0026be347 Mon Sep 17 00:00:00 2001
From: Dan Douglass <dan.douglass@freescale.com>
Date: Fri, 11 Mar 2016 17:17:40 -0600
Subject: [PATCH 1607/1691]  MLK-12475 CAAM: sg pointer updated instead of
 local copy

commit 02eeea4cc9c8cb6819bc00a869bac9e0026be347 from
git://git.freescale.com/imx/linux-2.6-imx.git imx_4.1.15_1.0.0_ga

Correct error in CAAM driver port. dma_map_sg_chained() had a patch
applied to traverse the sg list using a local copy to prevent
changing the value of the passed in sg list pointer.

    Signed-off-by: Dan Douglass <dan.douglass@nxp.com>
---
 drivers/crypto/caam/sg_sw_sec4.h | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/crypto/caam/sg_sw_sec4.h b/drivers/crypto/caam/sg_sw_sec4.h
index 70af42d..d0f7ecb 100644
--- a/drivers/crypto/caam/sg_sw_sec4.h
+++ b/drivers/crypto/caam/sg_sw_sec4.h
@@ -1,7 +1,7 @@
 /*
  * CAAM/SEC 4.x functions for using scatterlists in caam driver
  *
- * Copyright 2008-2015 Freescale Semiconductor, Inc.
+ * Copyright 2008-2016 Freescale Semiconductor, Inc.
  *
  */
 
@@ -91,14 +91,14 @@ static int dma_map_sg_chained(struct device *dev, struct scatterlist *sg,
 {
 	if (unlikely(chained)) {
 		int i;
-	struct scatterlist *tsg = sg;
+		struct scatterlist *tsg = sg;
 
 	/* We use a local copy of the sg pointer to avoid moving the
 	 * head of the list pointed to by sg as we wall the list.
 	 */
 		for (i = 0; i < nents; i++) {
 			dma_map_sg(dev, tsg, 1, dir);
-			sg = sg_next(tsg);
+			tsg = sg_next(tsg);
 		}
 	} else {
 		dma_map_sg(dev, sg, nents, dir);
-- 
1.9.1

