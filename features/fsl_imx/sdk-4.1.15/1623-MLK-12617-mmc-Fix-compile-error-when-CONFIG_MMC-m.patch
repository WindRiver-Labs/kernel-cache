From 3b2520f17d427b8fa8db37a6d9a4311f20c29036 Mon Sep 17 00:00:00 2001
From: Haibo Chen <haibo.chen@nxp.com>
Date: Tue, 5 Apr 2016 17:43:38 +0800
Subject: [PATCH 1623/1691] MLK-12617 mmc: Fix compile error when CONFIG_MMC=m

commit 3b2520f17d427b8fa8db37a6d9a4311f20c29036 from
git://git.freescale.com/imx/linux-2.6-imx.git imx_4.1.15_1.0.0_ga

When CONFIG_MMC=m, compile error shows up

ERROR: "of_alias_max_index" [drivers/mmc/core/mmc_core.ko] undefined!
ERROR: "mmc_get_reserved_index" [drivers/mmc/card/mmc_block.ko] undefined!
ERROR: "mmc_first_nonreserved_index" [drivers/mmc/card/mmc_block.ko] undefined!
make[1]: *** [__modpost] Error 1
make: *** [modules] Error 2
make: *** Waiting for unfinished jobs....

This patch export the upper three symbol for module runtime load.

Signed-off-by: Haibo Chen <haibo.chen@nxp.com>
---
 drivers/mmc/core/core.c | 2 ++
 drivers/of/base.c       | 1 +
 2 files changed, 3 insertions(+)

diff --git a/drivers/mmc/core/core.c b/drivers/mmc/core/core.c
index 910cc7c..be86d92 100644
--- a/drivers/mmc/core/core.c
+++ b/drivers/mmc/core/core.c
@@ -2831,6 +2831,7 @@ int mmc_first_nonreserved_index(void)
 {
 	return __mmc_max_reserved_idx + 1;
 }
+EXPORT_SYMBOL(mmc_first_nonreserved_index);
 
 /**
  * mmc_get_reserved_index() - get the index reserved for this host
@@ -2842,6 +2843,7 @@ int mmc_get_reserved_index(struct mmc_host *host)
 {
 	return of_alias_get_id(host->parent->of_node, "mmc");
 }
+EXPORT_SYMBOL(mmc_get_reserved_index);
 
 static void mmc_of_reserve_idx(void)
 {
diff --git a/drivers/of/base.c b/drivers/of/base.c
index 169bbaf..ab53ed8 100644
--- a/drivers/of/base.c
+++ b/drivers/of/base.c
@@ -1912,6 +1912,7 @@ int of_alias_max_index(const char *stem)
 
 	return max;
 }
+EXPORT_SYMBOL_GPL(of_alias_max_index);
 
 /**
  * of_alias_scan - Scan all properties of the 'aliases' node
-- 
1.9.1

