From eaca0cfa606a1002e27cd605d857c0fc2b4957b7 Mon Sep 17 00:00:00 2001
From: Shengjiu Wang <shengjiu.wang@freescale.com>
Date: Wed, 27 May 2015 14:15:58 +0800
Subject: [PATCH 0567/1691] MLK-10880: ASoC: fsl_asrc: the limitation for rate
 is not accurate.

commit eaca0cfa606a1002e27cd605d857c0fc2b4957b7 from
git://git.freescale.com/imx/linux-2.6-imx.git imx_4.1.15_1.0.0_ga

The limitation is for the case that output sampling rate is between 8kHz
and 30kHz.

Signed-off-by: Shengjiu Wang <shengjiu.wang@freescale.com>
(cherry picked from commit 670346d6bcfa906ba97afe1b8bd58ca70aee3e23)
---
 sound/soc/fsl/fsl_asrc.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/sound/soc/fsl/fsl_asrc.c b/sound/soc/fsl/fsl_asrc.c
index cb51c34..533c85b 100644
--- a/sound/soc/fsl/fsl_asrc.c
+++ b/sound/soc/fsl/fsl_asrc.c
@@ -287,7 +287,8 @@ static int fsl_asrc_config_pair(struct fsl_asrc_pair *pair, bool p2p_in, bool p2
 		return -EINVAL;
 	}
 
-	if (outrate/inrate > 24 || inrate/outrate > 8) {
+	if ((outrate > 8000 && outrate < 30000) &&
+			(outrate/inrate > 24 || inrate/outrate > 8)) {
 		pair_err("exceed supported ratio range [1/24, 8] for \
 				inrate/outrate: %d/%d\n", inrate, outrate);
 		return -EINVAL;
-- 
1.9.1

