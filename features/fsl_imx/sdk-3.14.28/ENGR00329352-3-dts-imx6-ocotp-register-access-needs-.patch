From 3d5fbf14699eefe513dd420d08003e62fbb29c0e Mon Sep 17 00:00:00 2001
From: Dong Aisheng <b29396@freescale.com>
Date: Thu, 28 Aug 2014 16:37:13 +0800
Subject: [PATCH 0375/1543] ENGR00329352-3 dts: imx6: ocotp register access
 needs clock

commit 5012e38f7762e5752424a9709d93507011635208 from
git://git.freescale.com/imx/linux-2.6-imx.git

Without clock, accessing ocotp register will cause system hang.
So define the clock here in device tree for driver to use.

Signed-off-by: Dong Aisheng <b29396@freescale.com>
(cherry picked from commit fa8e45c7c9865d78480043db87eba55a301edd8f)
---
 arch/arm/boot/dts/imx6qdl.dtsi |    1 +
 arch/arm/boot/dts/imx6sl.dtsi  |    1 +
 2 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/arm/boot/dts/imx6qdl.dtsi b/arch/arm/boot/dts/imx6qdl.dtsi
index 4048621..9dbd74f 100644
--- a/arch/arm/boot/dts/imx6qdl.dtsi
+++ b/arch/arm/boot/dts/imx6qdl.dtsi
@@ -956,6 +956,7 @@
 			ocotp: ocotp@021bc000 {
 				compatible = "fsl,imx6q-ocotp", "syscon";
 				reg = <0x021bc000 0x4000>;
+				clocks = <&clks IMX6QDL_CLK_IIM>;
 			};
 
 			tzasc@021d0000 { /* TZASC1 */
diff --git a/arch/arm/boot/dts/imx6sl.dtsi b/arch/arm/boot/dts/imx6sl.dtsi
index da45fad..0d0eb0e 100644
--- a/arch/arm/boot/dts/imx6sl.dtsi
+++ b/arch/arm/boot/dts/imx6sl.dtsi
@@ -802,6 +802,7 @@
 			ocotp: ocotp@021bc000 {
 				compatible = "fsl,imx6sl-ocotp", "syscon";
 				reg = <0x021bc000 0x4000>;
+				clocks = <&clks IMX6SL_CLK_OCOTP>;
 			};
 
 			audmux: audmux@021d8000 {
-- 
1.7.5.4

