From 19dd2736ba6ab56db1e8b56d83ba251244363f76 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Fri, 28 Aug 2015 14:49:55 +0800
Subject: [PATCH 1/3] kgdboc, imx: rx polling hook for this serial driver

The RX polling hook allows the debugger to hook character input so as
to allow entry to the kernel debugger with a control-c as an example.

Signed-off-by: Zumeng Chen <zumeng.chen@@windriver.com>
---
 drivers/tty/serial/imx.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/tty/serial/imx.c b/drivers/tty/serial/imx.c
index d557f1e..6c92023 100644
--- a/drivers/tty/serial/imx.c
+++ b/drivers/tty/serial/imx.c
@@ -715,6 +715,10 @@ static irqreturn_t imx_rxint(int irq, void *dev_id)
 				continue;
 		}
 
+#ifdef CONFIG_CONSOLE_POLL
+		if (sport->port.poll_rx_cb && sport->port.poll_rx_cb((unsigned char)rx))
+			continue;
+#endif
 		if (uart_handle_sysrq_char(&sport->port, (unsigned char)rx))
 			continue;
 
-- 
1.7.5.4

