From b9fc6a8038dd7ca5d8b38e30e3687bb5a49a2905 Mon Sep 17 00:00:00 2001
From: Zidan Wang <zidan.wang@freescale.com>
Date: Thu, 2 Apr 2015 15:36:14 +0800
Subject: [PATCH 0320/1221] MLK-10555 ASoC: imx-wm8958: change AIF1CLK to
 384fs to get accurate sample rate for 24 bit word
 length

change AIF1CLK to 384fs to get accurate sample rate for 24 bit word length.

Signed-off-by: Zidan Wang <zidan.wang@freescale.com>
[zou:Original patch taken from
git.freescale.com/imx/fsl-arm-yocto-bsp.git-b imx-3.14.52-1.1.0_ga]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 sound/soc/fsl/imx-wm8958.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/sound/soc/fsl/imx-wm8958.c b/sound/soc/fsl/imx-wm8958.c
index fb0399c..49ce823 100644
--- a/sound/soc/fsl/imx-wm8958.c
+++ b/sound/soc/fsl/imx-wm8958.c
@@ -163,7 +163,10 @@ static int imx_hifi_hw_params(struct snd_pcm_substream *substream,
 	} else {
 		data->sr_stream[tx] = params_rate(params);
 
-		pll_out = data->sr_stream[tx] * 256;
+		if (params_width(params) == 24)
+			pll_out = data->sr_stream[tx] * 384;
+		else
+			pll_out = data->sr_stream[tx] * 256;
 
 		ret = snd_soc_dai_set_pll(codec_dai, WM8994_FLL1,
 					  WM8994_FLL_SRC_MCLK1,
-- 
1.7.5.4

