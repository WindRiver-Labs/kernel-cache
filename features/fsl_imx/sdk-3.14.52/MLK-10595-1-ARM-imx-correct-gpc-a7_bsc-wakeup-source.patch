From 2aabbad15f00696f62c71484093911102ba45235 Mon Sep 17 00:00:00 2001
From: Anson Huang <b20788@freescale.com>
Date: Tue, 7 Apr 2015 18:20:28 +0800
Subject: [PATCH 0343/1221] MLK-10595-1 ARM: imx: correct gpc a7_bsc wakeup
 source setting

GPC_LPCR_A7_BSC should be set to be waked up by GIC/GPC both,
the value should be 0x3, otherwise, first time DSM will be
entered by mistake when program the GPC low power mode register
but ARM NOT enter wfi yet.

Signed-off-by: Anson Huang <b20788@freescale.com>
[zou:Original patch taken from
git.freescale.com/imx/fsl-arm-yocto-bsp.git-b imx-3.14.52-1.1.0_ga]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 arch/arm/mach-imx/gpcv2.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-imx/gpcv2.c b/arch/arm/mach-imx/gpcv2.c
index 198e063..7c4691e 100644
--- a/arch/arm/mach-imx/gpcv2.c
+++ b/arch/arm/mach-imx/gpcv2.c
@@ -512,7 +512,7 @@ void __init imx_gpcv2_init(void)
 	}
 
 	/* only external IRQs to wake up LPM and core 0/1 */
-	writel_relaxed(BM_LPCR_A7_BSC_IRQ_SRC_A7_WAKEUP,
+	writel_relaxed(0x3 << BP_LPCR_A7_BSC_IRQ_SRC,
 		gpc_base + GPC_LPCR_A7_BSC);
 	/* mask m4 dsm trigger */
 	writel_relaxed(readl_relaxed(gpc_base + GPC_LPCR_M4) |
-- 
1.7.5.4

