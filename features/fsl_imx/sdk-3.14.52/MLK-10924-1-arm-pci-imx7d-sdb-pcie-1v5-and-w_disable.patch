From fd622fc9c84d4b60c73899761b14a66097de0e6c Mon Sep 17 00:00:00 2001
From: Richard Zhu <Richard.Zhu@freescale.com>
Date: Tue, 19 May 2015 13:44:37 +0800
Subject: [PATCH 0570/1221] MLK-10924-1 arm: pci: imx7d sdb pcie 1v5 and
 w_disable

- PCIE_1V5 is required, thus the LDO2 should be always on.
- w_disable is used on imx7d sdb, add this signal control
into imx7d sdb dts too

Signed-off-by: Richard Zhu <Richard.Zhu@freescale.com>
[zou:Original patch taken from
git.freescale.com/imx/fsl-arm-yocto-bsp.git-b imx-3.14.52-1.1.0_ga]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 arch/arm/boot/dts/imx7d-sdb.dts |   15 ++++++++++++++-
 1 files changed, 14 insertions(+), 1 deletions(-)

diff --git a/arch/arm/boot/dts/imx7d-sdb.dts b/arch/arm/boot/dts/imx7d-sdb.dts
index 4fe75ef..329f5a9 100644
--- a/arch/arm/boot/dts/imx7d-sdb.dts
+++ b/arch/arm/boot/dts/imx7d-sdb.dts
@@ -73,6 +73,17 @@
 			regulator-max-microvolt = <1800000>;
 		};
 
+		reg_pcie: regulator@4 {
+			compatible = "regulator-fixed";
+			reg = <4>;
+			regulator-name = "MPCIE_3V3";
+			regulator-min-microvolt = <3300000>;
+			regulator-max-microvolt = <3300000>;
+			gpio = <&gpio_spi 6 GPIO_ACTIVE_HIGH>;
+			regulator-always-on;
+			enable-active-high;
+		};
+
 		wlreg_on: fixedregulator@100 {
 			compatible = "regulator-fixed";
 			regulator-min-microvolt = <5000000>;
@@ -291,6 +302,7 @@
 			vgen2_reg: vldo2 {
 				regulator-min-microvolt = <800000>;
 				regulator-max-microvolt = <1550000>;
+				regulator-always-on;
 			};
 
 			vgen3_reg: vccsd {
@@ -871,7 +883,8 @@
 
 &pcie {
 	pinctrl-names = "default";
-	reset-gpio = <&gpio_spi 1 GPIO_ACTIVE_HIGH>;
+	reset-gpio = <&gpio_spi 1 GPIO_ACTIVE_LOW>;
+	disable-gpio = <&gpio_spi 0 GPIO_ACTIVE_LOW>;
 	status = "okay";
 };
 
-- 
1.7.5.4

