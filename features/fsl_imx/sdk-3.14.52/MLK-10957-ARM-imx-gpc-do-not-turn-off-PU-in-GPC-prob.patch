From 965d52302e5f30eb854cd12ddcfaa0db717b0a4b Mon Sep 17 00:00:00 2001
From: Robin Gong <b38343@freescale.com>
Date: Fri, 22 May 2015 10:59:23 +0800
Subject: [PATCH 0610/1221] MLK-10957 : ARM: imx: gpc: do not turn off PU in
 GPC probe

There is narrow window that PRE driver is ready but  GPU driver probe later,
and the later GPU driver turn on PU may cause 'PRE hang' issue. To simplify
thing, do not turn off PU in u-boot and PU power domain register.

check more information from below commit:
MLK-10465: ARM: imx6qp: keep PU always on for TKT259465

Signed-off-by: Robin Gong <b38343@freescale.com>
[zou:Original patch taken from
git.freescale.com/imx/fsl-arm-yocto-bsp.git-b imx-3.14.52-1.1.0_ga]
Signed-off-by: zou cao <cao.zou@windriver.com>
---
 arch/arm/mach-imx/gpc.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/arm/mach-imx/gpc.c b/arch/arm/mach-imx/gpc.c
index dddf00e..e5f5ad4 100644
--- a/arch/arm/mach-imx/gpc.c
+++ b/arch/arm/mach-imx/gpc.c
@@ -598,7 +598,8 @@ static int imx_gpc_genpd_init(struct device *dev, struct regulator *pu_reg)
 	imx6s_display_domain.num_clks = k;
 
 	is_off = IS_ENABLED(CONFIG_PM_RUNTIME);
-	if (is_off)
+	if (is_off && !(cpu_is_imx6q() &&
+		imx_get_soc_revision() == IMX_CHIP_REVISION_2_0))
 		imx6q_pm_pu_power_off(&imx6q_pu_domain.base);
 
 	pm_genpd_init(&imx6q_pu_domain.base, NULL, is_off);
-- 
1.7.5.4

