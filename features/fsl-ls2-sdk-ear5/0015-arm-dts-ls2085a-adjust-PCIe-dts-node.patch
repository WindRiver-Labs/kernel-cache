From 2f7356089c945adef263793c611345fd44d4448d Mon Sep 17 00:00:00 2001
From: Minghuan Lian <Minghuan.Lian@freescale.com>
Date: Mon, 23 Mar 2015 15:55:52 +0800
Subject: [PATCH 015/214] arm/dts/ls2085a: adjust PCIe dts node

Signed-off-by: Minghuan Lian <Minghuan.Lian@freescale.com>
Change-Id: I64e73b8e67ace069d79f1252bb97950e6802925b
Reviewed-on: http://git.am.freescale.net:8181/33246
Reviewed-by: Stuart Yoder <stuart.yoder@freescale.com>
Tested-by: Stuart Yoder <stuart.yoder@freescale.com>
[Original patch extracted from FSL LS2085 SDK EAR5.0,
Layerscape2-SDK-SOURCE-20150828-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 .../devicetree/bindings/pci/layerscape-pci.txt         |  1 +
 arch/arm64/boot/dts/freescale/fsl-ls2085a.dtsi         | 18 +++++++-----------
 2 files changed, 8 insertions(+), 11 deletions(-)

diff --git a/Documentation/devicetree/bindings/pci/layerscape-pci.txt b/Documentation/devicetree/bindings/pci/layerscape-pci.txt
index 6286f04..a90e4b3 100644
--- a/Documentation/devicetree/bindings/pci/layerscape-pci.txt
+++ b/Documentation/devicetree/bindings/pci/layerscape-pci.txt
@@ -5,6 +5,7 @@ and thus inherits all the common properties defined in designware-pcie.txt.
 
 Required properties:
 - compatible: should contain the platform identifier such as "fsl,ls1021a-pcie"
+  "fsl,ls2085a-pcie"
 - reg: base addresses and lengths of the PCIe controller
 - interrupts: A list of interrupt outputs of the controller. Must contain an
   entry for each entry in the interrupt-names property.
diff --git a/arch/arm64/boot/dts/freescale/fsl-ls2085a.dtsi b/arch/arm64/boot/dts/freescale/fsl-ls2085a.dtsi
index a81fde8..84ade51 100644
--- a/arch/arm64/boot/dts/freescale/fsl-ls2085a.dtsi
+++ b/arch/arm64/boot/dts/freescale/fsl-ls2085a.dtsi
@@ -389,11 +389,10 @@
 	pcie@3400000 {
 		compatible = "fsl,ls2085a-pcie", "snps,dw-pcie";
 		reg = <0x00 0x03400000 0x0 0x00100000   /* controller registers */
-		       0x10 0x00000000 0x0 0x00002000>; /* configuration space */
+		       0x10 0x00000000 0x0 0x00001000>; /* configuration space */
 		reg-names = "regs", "config";
 		interrupts = <0 108 0x4>; /* Level high type */
 		interrupt-names = "intr";
-		num-atus = <6>;
 		#address-cells = <3>;
 		#size-cells = <2>;
 		device_type = "pci";
@@ -412,15 +411,14 @@
 	pcie@3500000 {
 		compatible = "fsl,ls2085a-pcie", "snps,dw-pcie";
 		reg = <0x00 0x03500000 0x0 0x00100000   /* controller registers */
-		       0x12 0x00000000 0x0 0x00002000>; /* configuration space */
+		       0x12 0x00000000 0x0 0x00001000>; /* configuration space */
 		reg-names = "regs", "config";
 		interrupts = <0 113 0x4>; /* Level high type */
 		interrupt-names = "intr";
-		num-atus = <6>;
 		#address-cells = <3>;
 		#size-cells = <2>;
 		device_type = "pci";
-		num-lanes = <2>;
+		num-lanes = <4>;
 		bus-range = <0x0 0xff>;
 		ranges = <0x81000000 0x0 0x00000000 0x12 0x00010000 0x0 0x00010000   /* downstream I/O */
 			  0x82000000 0x0 0x40000000 0x12 0x40000000 0x0 0x40000000>; /* non-prefetchable memory */
@@ -435,15 +433,14 @@
 	pcie@3600000 {
 		compatible = "fsl,ls2085a-pcie", "snps,dw-pcie";
 		reg = <0x00 0x03600000 0x0 0x00100000   /* controller registers */
-		       0x14 0x00000000 0x0 0x00002000>; /* configuration space */
+		       0x14 0x00000000 0x0 0x00001000>; /* configuration space */
 		reg-names = "regs", "config";
 		interrupts = <0 118 0x4>; /* Level high type */
 		interrupt-names = "intr";
-		num-atus = <6>;
 		#address-cells = <3>;
 		#size-cells = <2>;
 		device_type = "pci";
-		num-lanes = <4>;
+		num-lanes = <8>;
 		bus-range = <0x0 0xff>;
 		ranges = <0x81000000 0x0 0x00000000 0x14 0x00010000 0x0 0x00010000   /* downstream I/O */
 			  0x82000000 0x0 0x40000000 0x14 0x40000000 0x0 0x40000000>; /* non-prefetchable memory */
@@ -458,15 +455,14 @@
 	pcie@3700000 {
 		compatible = "fsl,ls2085a-pcie", "snps,dw-pcie";
 		reg = <0x00 0x03700000 0x0 0x00100000   /* controller registers */
-		       0x16 0x00000000 0x0 0x00002000>; /* configuration space */
+		       0x16 0x00000000 0x0 0x00001000>; /* configuration space */
 		reg-names = "regs", "config";
 		interrupts = <0 123 0x4>; /* Level high type */
 		interrupt-names = "intr";
-		num-atus = <6>;
 		#address-cells = <3>;
 		#size-cells = <2>;
 		device_type = "pci";
-		num-lanes = <2>;
+		num-lanes = <4>;
 		bus-range = <0x0 0xff>;
 		ranges = <0x81000000 0x0 0x00000000 0x16 0x00010000 0x0 0x00010000   /* downstream I/O */
 			  0x82000000 0x0 0x40000000 0x16 0x40000000 0x0 0x40000000>; /* non-prefetchable memory */
-- 
2.5.3

