From 90df6153f9e6472136bf26a97dbb2c7da612499d Mon Sep 17 00:00:00 2001
From: Jaiprakash Singh <b44839@freescale.com>
Date: Mon, 4 May 2015 13:40:20 +0530
Subject: [PATCH 192/214] driver/ifc: Enable IFC NOR

Enable MTD/CFI config reqired for IFC
FSL_SOC config is for PPC hece added new
confit ARM, ARM64 for IFC compilation on
ARM platform.

Signed-off-by: Jaiprakash Singh <b44839@freescale.com>
Change-Id: Ib685b8edc3c5e3c2935269b2a5d7896f3b3145bf
Reviewed-on: http://git.am.freescale.net:8181/35686
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Scott Wood <scottwood@freescale.com>
Reviewed-by: Stuart Yoder <stuart.yoder@freescale.com>
(cherry picked from commit 20fc1d336ab81ace3145e0eaa6ffbb98010ee16d)
[Original patch extracted from FSL LS2085 SDK EAR5.0,
Layerscape2-SDK-SOURCE-20150828-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/memory/Kconfig   | 2 +-
 drivers/memory/fsl_ifc.c | 7 +++++++
 drivers/mtd/nand/Kconfig | 2 +-
 3 files changed, 9 insertions(+), 2 deletions(-)

diff --git a/drivers/memory/Kconfig b/drivers/memory/Kconfig
index 868036f..342ac8b 100644
--- a/drivers/memory/Kconfig
+++ b/drivers/memory/Kconfig
@@ -81,7 +81,7 @@ config FSL_CORENET_CF
 
 config FSL_IFC
 	bool
-	depends on FSL_SOC
+	depends on FSL_SOC || ARM || ARM64
 
 config JZ4780_NEMC
 	bool "Ingenic JZ4780 SoC NEMC driver"
diff --git a/drivers/memory/fsl_ifc.c b/drivers/memory/fsl_ifc.c
index e87459f..dfef7f2 100644
--- a/drivers/memory/fsl_ifc.c
+++ b/drivers/memory/fsl_ifc.c
@@ -30,7 +30,14 @@
 #include <linux/of_device.h>
 #include <linux/platform_device.h>
 #include <linux/fsl_ifc.h>
+#ifdef CONFIG_FSL_SOC
 #include <asm/prom.h>
+#else
+#include <linux/of_irq.h>
+#include <linux/irqdomain.h>
+#include <linux/of_address.h>
+#include <linux/sched.h>
+#endif
 
 struct fsl_ifc_ctrl *fsl_ifc_ctrl_dev;
 EXPORT_SYMBOL(fsl_ifc_ctrl_dev);
diff --git a/drivers/mtd/nand/Kconfig b/drivers/mtd/nand/Kconfig
index 5897d8d..a042dc0 100644
--- a/drivers/mtd/nand/Kconfig
+++ b/drivers/mtd/nand/Kconfig
@@ -431,7 +431,7 @@ config MTD_NAND_FSL_ELBC
 
 config MTD_NAND_FSL_IFC
 	tristate "NAND support for Freescale IFC controller"
-	depends on MTD_NAND && FSL_SOC
+	depends on MTD_NAND && (FSL_SOC || ARM || ARM64)
 	select FSL_IFC
 	select MEMORY
 	help
-- 
2.5.3

