From 6de36531959bd7edb8351b70be4878359ff4e1f0 Mon Sep 17 00:00:00 2001
From: Jim Somerville <Jim.Somerville@windriver.com>
Date: Tue, 18 Oct 2011 11:17:31 -0400
Subject: [PATCH] wrhv: arm: Set proper vec tab base when DOMAINS not used

With WRHV we must root the vector table at the configured
address all the time, regardless of whether or not domains are
in use.

Signed-off-by: Jim Somerville <Jim.Somerville@windriver.com>
---
 arch/arm/kernel/traps.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/arm/kernel/traps.c b/arch/arm/kernel/traps.c
index f677022..ee7d248 100644
--- a/arch/arm/kernel/traps.c
+++ b/arch/arm/kernel/traps.c
@@ -770,7 +770,7 @@ void __init trap_init(void)
 
 void __init early_trap_init(void)
 {
-#if defined(CONFIG_CPU_USE_DOMAINS)
+#if defined(CONFIG_CPU_USE_DOMAINS) || defined(CONFIG_WRHV)
 	unsigned long vectors = CONFIG_VECTORS_BASE;
 #else
 	unsigned long vectors = (unsigned long)vectors_page;
-- 
1.7.0.4

