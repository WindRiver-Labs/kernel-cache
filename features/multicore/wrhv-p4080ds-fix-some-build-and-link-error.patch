From 0461d277435e9d5177fd690e8fd6dc2cbbb8424c Mon Sep 17 00:00:00 2001
From: Liang Li <liang.li@windriver.com>
Date: Thu, 3 Jun 2010 09:02:16 +0800
Subject: [PATCH] wrhv/p4080ds: fix some build and link error

Be aware of the option is CONFIG_WRHV_P4080DS instead of
CONFIG_WRHV_P4080

Signed-off-by: Liang Li <liang.li@windriver.com>
---
 arch/powerpc/Makefile                |    4 ++++
 arch/powerpc/include/asm/pv_hw_irq.h |    2 +-
 arch/powerpc/kernel/Makefile         |    2 +-
 3 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/Makefile b/arch/powerpc/Makefile
index e6c52f4..f1700ef 100644
--- a/arch/powerpc/Makefile
+++ b/arch/powerpc/Makefile
@@ -142,7 +142,11 @@ head-$(CONFIG_40x)		:= arch/powerpc/kernel/head_40x.o
 head-$(CONFIG_44x)		:= arch/powerpc/kernel/head_44x.o
 
 ifeq ($(CONFIG_WRHV),y)
+ifeq ($(CONFIG_WRHV_P4080DS),y)
+head-$(CONFIG_FSL_BOOKE)        := arch/powerpc/kernel/head_wrhv_p4080.o
+else
 head-$(CONFIG_FSL_BOOKE)        := arch/powerpc/kernel/head_wrhv.o
+endif
 else
 head-$(CONFIG_FSL_BOOKE)        := arch/powerpc/kernel/head_fsl_booke.o
 endif
diff --git a/arch/powerpc/include/asm/pv_hw_irq.h b/arch/powerpc/include/asm/pv_hw_irq.h
index 7552c67..cdd3c99 100644
--- a/arch/powerpc/include/asm/pv_hw_irq.h
+++ b/arch/powerpc/include/asm/pv_hw_irq.h
@@ -22,7 +22,7 @@ extern int wrhv_int_lvl_get (void);
 #ifdef CONFIG_WRHV_E500
 #define IRQS_ENABLED 0
 #define IRQS_DISABLED -1
-#elif CONFIG_WRHV_P4080
+#elif CONFIG_WRHV_P4080DS
 #define IRQS_ENABLED 1
 #define IRQS_DISABLED 0
 #endif
diff --git a/arch/powerpc/kernel/Makefile b/arch/powerpc/kernel/Makefile
index d1342ba..8ecc75f 100644
--- a/arch/powerpc/kernel/Makefile
+++ b/arch/powerpc/kernel/Makefile
@@ -80,7 +80,7 @@ extra-$(CONFIG_40x)		:= head_40x.o
 extra-$(CONFIG_44x)		:= head_44x.o
 
 ifeq ($(CONFIG_WRHV),y)
-ifeq ($(CONFIG_WRHV_P4080),y)
+ifeq ($(CONFIG_WRHV_P4080DS),y)
 extra-$(CONFIG_WRHV)		:= head_wrhv_p4080.o
 else
 extra-$(CONFIG_WRHV)		:= head_wrhv.o
-- 
1.6.5.2

