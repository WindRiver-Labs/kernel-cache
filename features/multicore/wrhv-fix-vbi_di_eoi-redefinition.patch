From 8133b27f099b46edbe087f8a04ca654fb860f8d8 Mon Sep 17 00:00:00 2001
From: Weiwei Wang <weiwei.wang@windriver.com>
Date: Thu, 1 Sep 2011 09:56:57 +0800
Subject: [PATCH] wrhv: fix vbi_di_eoi redefinition

When CONFIG_WRHV_COREVBI_ONLY is enabled, vbi_di_eoi is defined
in include/vbi/vbi.h as:
...
static inline void vbi_di_eoi(void)
{
        VBISTAT_VERBOSE(vbi_di_eoi);
        return;
}
...

Which conficts with weak definition in kernel/vbi/wrhv.c. So use
macro to restrict related code in kernel/vbi/wrhv.c

Signed-off-by: Weiwei Wang <weiwei.wang@windriver.com>
---
 kernel/vbi/wrhv.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/kernel/vbi/wrhv.c b/kernel/vbi/wrhv.c
index 1d40dc8..6e23b6c 100644
--- a/kernel/vbi/wrhv.c
+++ b/kernel/vbi/wrhv.c
@@ -78,9 +78,11 @@ static void wrhv_ack_irq(unsigned int irq)
 }
 
 __weak int wrhv_dir_irq = 0;
+#ifndef CONFIG_WRHV_COREVBI_ONLY
 __weak asmlinkage void vbi_di_eoi(void)
 {
 }
+#endif
 
 static void wrhv_eoi_irq(unsigned int irq)
 {
-- 
1.7.0.4

