From f8fde321e4c375462c2e0653e66a1a7b5411f630 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Sat, 22 Jan 2011 00:06:20 +0800
Subject: [PATCH 1/4] wrhv/x86: add map for guest device info in x86-64

We need to access these devices informations in some
cases. So add map for it.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/x86/kernel/vbi/wrhv.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/arch/x86/kernel/vbi/wrhv.c b/arch/x86/kernel/vbi/wrhv.c
index 897788d..32c6061 100644
--- a/arch/x86/kernel/vbi/wrhv.c
+++ b/arch/x86/kernel/vbi/wrhv.c
@@ -152,6 +152,9 @@ static inline void construct_fake_wr_config(void)
 	fake_wr_config->interruptConfiguration = (struct vb_int_info *)
 		(delta + (unsigned long)wr_config->interruptConfiguration);
 
+	fake_wr_config->deviceConfiguration = (struct vb_dev_info *)(delta +
+			 (unsigned long)wr_config->deviceConfiguration);
+
 	if ((unsigned long)fake_wr_config->vb_control->vIoapic <
 	    ((unsigned long)1 << 32))
 		fake_wr_config->vb_control->vIoapic = (void *)(delta +
-- 
1.6.5.2

