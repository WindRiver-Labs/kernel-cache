From 242bad36768aeedf9744944f10914222064397b4 Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Fri, 4 Jun 2010 10:00:04 +0800
Subject: [PATCH] WRHV/PPC: Support CONFIG_HOTPLUG_CPU

Add the function, cpu_die, to support CONFIG_HOTPLUG_CPU.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/kernel/vbi/wrhv.c |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/kernel/vbi/wrhv.c b/arch/powerpc/kernel/vbi/wrhv.c
index 6686483..7611712 100644
--- a/arch/powerpc/kernel/vbi/wrhv.c
+++ b/arch/powerpc/kernel/vbi/wrhv.c
@@ -1562,6 +1562,14 @@ struct smp_ops_t smp_wrhv_ops = {
 	.setup_cpu = smp_wrhv_setup_cpu,
 };
 
+#if defined(CONFIG_HOTPLUG_CPU)
+void cpu_die(void)
+{
+	if (smp_ops->cpu_die)
+		smp_ops->cpu_die(smp_processor_id());
+}
+#endif
+
 void __init wrhv_smp_init(void)
 {
 	smp_ops = &smp_wrhv_ops;
-- 
1.6.5.2

