From 8b8662d47bf1d7088f9303bb50da219e4952d409 Mon Sep 17 00:00:00 2001
From: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
Date: Mon, 31 Jan 2011 13:43:34 -0500
Subject: [PATCH 01/10] WRHV/e500: ASID kconfig

ASID - Address Space Identifier

The main purpose of ASID is to act as a MMU Assist register
thereby limiting the number of flushes and increasing the
overall guest performance.

Creation of user selectable and tunable ASID value. This
menu item enables and disables the ASID performance
feature.

Ideally we could have enabled and set the number of ASID's
through the bootline.  But the call to parse the bootline
value comes way too late for this.

Signed-off-by: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
---
 init/Kconfig.wrhv |   22 ++++++++++++++++++++++
 1 files changed, 22 insertions(+), 0 deletions(-)

diff --git a/init/Kconfig.wrhv b/init/Kconfig.wrhv
index 792c2a0..21c609c 100644
--- a/init/Kconfig.wrhv
+++ b/init/Kconfig.wrhv
@@ -24,3 +24,25 @@ config WRHV_GUEST_PROTECTION
 	   kernel memory.
 
 	   Don't change this option unless you know what you are doing.
+
+
+config WRHV_ASID_OPTIMIZATION
+	bool "ASID performance optimization"
+	default n
+	depends on WRHV && E500
+	help
+	  ASID performance optimization.  The cost of invalidating and
+	  re-filling TLB cache's on behalf of the guest is an extremely
+	  expensive operation which results in a performance degradation.
+	  ASIDs enable TLB entries to remain resident during context switches,
+	  avoiding the penalty
+
+
+config WRHV_NUM_ASID
+	int "Number of ASID handles"
+	range 1 63
+	default "62"
+	depends on WRHV_ASID_OPTIMIZATION
+	help
+	   This defines the number of ASID handles used by this specific
+	   virtual board.
-- 
1.6.5.2

