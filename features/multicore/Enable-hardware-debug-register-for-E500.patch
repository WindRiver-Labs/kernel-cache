From 938b5efc15811361404e29d58aae9e6d0e594909 Mon Sep 17 00:00:00 2001
From: Thomas Tai <thomas.tai@windriver.com>
Date: Fri, 20 Aug 2010 10:55:08 -0700
Subject: [PATCH 1/3] Enable hardware debug register for E500

Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 arch/powerpc/include/asm/ptrace.h |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/include/asm/ptrace.h b/arch/powerpc/include/asm/ptrace.h
index e90f8d2..c248b23 100644
--- a/arch/powerpc/include/asm/ptrace.h
+++ b/arch/powerpc/include/asm/ptrace.h
@@ -136,7 +136,12 @@ do {									      \
 #ifndef CONFIG_PARAVIRT
 #define arch_has_single_step()	(1)
 #else
+#ifdef CONFIG_PPC_E500MC
 #define arch_has_single_step()	(0)
+#else
+/* E500 hypervisor has hardware debug register for GuestOS */
+#define arch_has_single_step()	(1)
+#endif
 #endif
 #define arch_has_block_step()	(!cpu_has_feature(CPU_FTR_601))
 #define ARCH_HAS_USER_SINGLE_STEP_INFO
-- 
1.6.5.2

