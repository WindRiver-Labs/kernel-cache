From 9117b09099cd2ad979087b654f6ea8eb93ed92ab Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Thu, 24 Feb 2011 16:36:42 +0800
Subject: [PATCH 26/38] WRHV: MIPS: Add MIPS specific VB show functions

Add MIPS specific vb_stat and vb_ctrl show functions which are
called by common VB show functions.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/mips/kernel/vbi/Makefile |    2 +-
 arch/mips/kernel/vbi/show.c   |   57 +++++++++++++++++++++++++++++++++++++++++
 2 files changed, 58 insertions(+), 1 deletions(-)
 create mode 100644 arch/mips/kernel/vbi/show.c

diff --git a/arch/mips/kernel/vbi/Makefile b/arch/mips/kernel/vbi/Makefile
index df31cc5..6bbdd94 100644
--- a/arch/mips/kernel/vbi/Makefile
+++ b/arch/mips/kernel/vbi/Makefile
@@ -1,4 +1,4 @@
 #
 # Makefile for the vbi MIPS64.
 #
-obj-y		+= syscalls.o wrhv.o
+obj-y		+= syscalls.o wrhv.o show.o
diff --git a/arch/mips/kernel/vbi/show.c b/arch/mips/kernel/vbi/show.c
new file mode 100644
index 0000000..02a5ef9
--- /dev/null
+++ b/arch/mips/kernel/vbi/show.c
@@ -0,0 +1,57 @@
+/*
+ * show.c - vbi MIPS64 show routines
+ *
+ * Copyright (c) 2010 Wind River Systems, Inc.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
+ * See the GNU General Public License for more details.
+ *
+ */
+
+#include <linux/kernel.h>
+#include <vbi/vbi.h>
+
+/*
+ * vbi_disp_status_regs - display registers from a EREG_SET
+ *
+ * This routine display the contents of the MIPS64 emulated status registers
+ * structure on the console.
+ *
+ */
+
+void vbi_disp_status_regs(void)
+{
+	struct vb_status *p = VBI_STATUS_ADDR_GET();
+
+	printk("  EPC:			0x%llx\n", VB_STATUS_REGS_ACCESS(p, epc));
+	printk("  Status Register: 	0x%llx\n", VB_STATUS_REGS_ACCESS(p, sr));
+	printk("  Cause Register: 	0x%llx\n", VB_STATUS_REGS_ACCESS(p, cause));
+	printk("  Return Address: 	0x%llx\n", VB_STATUS_REGS_ACCESS(p, ra));
+	printk("  K0 Register:		0x%llx\n", VB_STATUS_REGS_ACCESS(p, k0));
+	printk("  K1 Register:		0x%llx\n", VB_STATUS_REGS_ACCESS(p, k1));
+}
+
+/*
+ * vbi_disp_ctrl_regs - display registers from a EREG_SET
+ *
+ * This routine display the contents of the MIPS64 emulated status registers
+ * structure on the console.
+ *
+ */
+
+void vbi_disp_ctrl_regs(void)
+{
+	struct vb_control *p = VBI_CNTRL_ADDR_GET();
+
+	printk("  EPC:			0x%llx\n", VB_CONTROL_REGS_ACCESS(p, epc));
+	printk("  Status Register: 	0x%llx\n", VB_CONTROL_REGS_ACCESS(p, sr));
+	printk("  V0 Register:		0x%llx\n", VB_CONTROL_REGS_ACCESS(p, v0));
+	printk("  K0 Register:		0x%llx\n", VB_CONTROL_REGS_ACCESS(p, k0));
+	printk("  K1 Register:		0x%llx\n", VB_CONTROL_REGS_ACCESS(p, k1));
+}
-- 
1.6.5.2

