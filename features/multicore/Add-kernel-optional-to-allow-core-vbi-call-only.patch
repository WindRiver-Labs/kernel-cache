From 59f840f0e7b159e5f2eedc16ae19c3a5902dae4b Mon Sep 17 00:00:00 2001
From: Thomas Tai <thomas.tai@windriver.com>
Date: Wed, 4 May 2011 14:47:25 -0400
Subject: [PATCH 1/3] Add kernel optional to allow core vbi call only

A kernel configure optional CONFIG_WRHV_COREVBI_ONLY
is added, if enabled, a warning message will be printed
out. The call count is log in /proc/windriver/vbistat.
CONFIG_WRHV_COREVBI_ONLY is also selected when WRHV_CERT
is selected.

Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 init/Kconfig.wrhv |    8 ++++++++
 1 files changed, 8 insertions(+), 0 deletions(-)

diff --git a/init/Kconfig.wrhv b/init/Kconfig.wrhv
index 3087939..c60fedd 100644
--- a/init/Kconfig.wrhv
+++ b/init/Kconfig.wrhv
@@ -15,6 +15,14 @@ config WRHV_CERT
 	help
 	  This options select certifiable hypervisor virtualization extensions
 	  in the Linux Kernel
+	select WRHV_COREVBI_ONLY
+
+config WRHV_COREVBI_ONLY
+	bool "Allow core VBI only"
+	default n
+	depends on WRHV
+	help
+	  Only allow use of the core virtual board interface, not the optional parts
 
 config DEBUG_VIRTUAL_IRQS
 	bool "Debug VIOAPIC with software IRQ"
-- 
1.7.0.2

