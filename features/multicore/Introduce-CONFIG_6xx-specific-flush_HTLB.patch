From 2a88cdf039c397ab1adfab7f1adefbdf347c768e Mon Sep 17 00:00:00 2001
From: Thomas Tai <thomas.tai@windriver.com>
Date: Thu, 8 Apr 2010 21:49:45 -0400
Subject: [PATCH] Introduce CONFIG_6xx specific flush_HTLB

This is paravirt specific, no impact to native users.

Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 arch/powerpc/mm/mmu_decl.h |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/mm/mmu_decl.h b/arch/powerpc/mm/mmu_decl.h
index 2d1631a..5a77052 100644
--- a/arch/powerpc/mm/mmu_decl.h
+++ b/arch/powerpc/mm/mmu_decl.h
@@ -59,7 +59,14 @@ extern phys_addr_t lowmem_end_addr;
  */
 #if defined(CONFIG_PARAVIRT)
 
+#if defined(CONFIG_E500)
 #define flush_HPTE(pid, va, pg)	_tlbie(va, pid)
+#elif defined(CONFIG_6xx)
+#define flush_HPTE(pid, va, pg)	_tlbie(va)
+#else
+#error unsupported CPU family
+#endif
+
 extern void MMU_init_hw(void);
 extern unsigned long mmu_mapin_ram(void);
 extern void adjust_total_lowmem(void);
-- 
1.6.5.2

