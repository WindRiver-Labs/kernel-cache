From d968fa5f022c5522398097929ba1c32003465793 Mon Sep 17 00:00:00 2001
From: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
Date: Tue, 18 May 2010 14:34:44 -0400
Subject: [PATCH 08/11] WRHV: Ensure stubs are truely stubs when KGDB disabled

If KGDB is disabled in the kernel config, make sure that the
stub is truely inert and doesn't generate a compile error.

Signed-off-by: Jeremy McNicoll <jeremy.mcnicoll@windriver.com>
---
 arch/powerpc/kernel/paravirt.c |    2 ++
 arch/powerpc/kernel/vbi/wrhv.c |    1 -
 2 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/kernel/paravirt.c b/arch/powerpc/kernel/paravirt.c
index b98eb0b..091919f 100644
--- a/arch/powerpc/kernel/paravirt.c
+++ b/arch/powerpc/kernel/paravirt.c
@@ -124,7 +124,9 @@ struct pv_irq_ops pv_irq_ops = {
 struct pv_cpu_ops pv_cpu_ops = {
 	.get_pvr = native_get_pvr,
 	.DebugException = native_DebugException,
+#ifdef CONFIG_KGDB
 	.kgdb_arch_handle_exception = native_kgdb_arch_handle_exception,
+#endif
 	.ppc_proc_freq = native_ppc_proc_freq,
 };
 
diff --git a/arch/powerpc/kernel/vbi/wrhv.c b/arch/powerpc/kernel/vbi/wrhv.c
index 2c88961..ddc9535 100644
--- a/arch/powerpc/kernel/vbi/wrhv.c
+++ b/arch/powerpc/kernel/vbi/wrhv.c
@@ -1307,7 +1307,6 @@ int wrhv_kgdb_arch_handle_exception(int vector, int signo, int err_code,
 		}
 		return 0;
 	}
-
 	return -1;
 }
 
-- 
1.6.5.2

