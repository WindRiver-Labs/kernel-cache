From bfe917c5eb0bb7f60ee48c58ba169bde1dabe34a Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Sat, 22 Jan 2011 01:37:04 +0800
Subject: [PATCH] wrhv/vbi: fix a vbi_send bug in x86-64

We try to copy a arg from stack, but it seems that we have made
a wrong between src and dst. This will cause the arg7 has the
wrong value in hypervisor.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/x86/kernel/vbi/syscalls.S |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/x86/kernel/vbi/syscalls.S b/arch/x86/kernel/vbi/syscalls.S
index 67a9582..c108a92 100644
--- a/arch/x86/kernel/vbi/syscalls.S
+++ b/arch/x86/kernel/vbi/syscalls.S
@@ -72,7 +72,7 @@ name:						\
 #ifdef LP64
 .globl vbi_send;
 vbi_send:
-	mov     %rax,ARG7(VBI_STACK_FRAME_SIZE) /* ctl */
+	mov     ARG7(VBI_STACK_FRAME_SIZE),%rax /* ctl */
 	push    %r10            /* save the value of r10 */
 	mov     %rax,%r10       /* load r10 with the values of "ctl" */
 	push    $7              /* number of arguments */
-- 
1.6.5.2

