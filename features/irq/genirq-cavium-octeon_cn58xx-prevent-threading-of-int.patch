From d7a1c001fafced10c203b1dbbb244d05789bd0ee Mon Sep 17 00:00:00 2001
From: Mark Asselstine <mark.asselstine@windriver.com>
Date: Tue, 6 Jul 2010 13:13:09 -0700
Subject: [PATCH 1/4] genirq: cavium octeon_cn58xx: prevent threading of interrupts

Various irq handlers have been shown to not function correctly when
handled in threads. Add IRQF_NODELAY to prevent threading.

Signed-off-by: Mark Asselstine <mark.asselstine@windriver.com>
---
 drivers/staging/octeon/ethernet-rgmii.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/staging/octeon/ethernet-rgmii.c b/drivers/staging/octeon/ethernet-rgmii.c
index a0d4d4b..b0c4822 100644
--- a/drivers/staging/octeon/ethernet-rgmii.c
+++ b/drivers/staging/octeon/ethernet-rgmii.c
@@ -347,7 +347,7 @@ int cvm_oct_rgmii_init(struct net_device *dev)
 	 */
 	if (number_rgmii_ports == 0) {
 		r = request_irq(OCTEON_IRQ_RML, cvm_oct_rgmii_rml_interrupt,
-				IRQF_SHARED, "RGMII", &number_rgmii_ports);
+				IRQF_SHARED|IRQF_NODELAY, "RGMII", &number_rgmii_ports);
 		if (r != 0)
 			return r;
 	}
-- 
1.6.5.2

