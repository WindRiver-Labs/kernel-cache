From ecb7c67987f751bbddc9dd6a2daed70ac2a2b751 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Fri, 13 Feb 2015 15:26:30 +0530
Subject: [PATCH 117/148] MIPS/Kconfig: OCTEON: Seperate SoC and CPU related
 config items

Commit 6eb974ae15dcde784625f7727d54cf1b1daa71a4 from
git://git.yoctoproject.org/linux-yocto-3.14

Segregate SOC and CPU related config items so that if we select
CPU_CAVIUM_OCTEON, we don't get to select SoC support unrelated to the
CPU, those are enabled by CAVIUM_OCTEON_SOC.

MIPS: Move system level config items from CPU_CAVIUM_OCTEON to CAVIUM_OCTEON_SOC

They are a property of the SoC not the CPU itself.  Also get rid of
CPU_SUPPORTS_HIGHMEM as it doesn't support a 32-bit kernel and HIGHMEM
is untested and usless on 64-bit kernels.
Update the help text to be more factual.

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Abhishek Paliwal <abhishek.paliwal@aricent.com>
---
 arch/mips/Kconfig               | 37 ++++++++++++++++---------------------
 arch/mips/cavium-octeon/Kconfig |  3 +--
 2 files changed, 17 insertions(+), 23 deletions(-)

diff --git a/arch/mips/Kconfig b/arch/mips/Kconfig
index e2da95d..e1fc2e6 100644
--- a/arch/mips/Kconfig
+++ b/arch/mips/Kconfig
@@ -720,20 +720,25 @@ config CAVIUM_OCTEON_SOC
 	select ZONE_DMA32
 	select HOLES_IN_ZONE
 	select ARCH_REQUIRE_GPIOLIB
+	select MTD_COMPLEX_MAPPINGS
+	select LIBFDT
+	select USE_OF
+	select USB_EHCI_BIG_ENDIAN_MMIO
+	select ARCH_SPARSEMEM_ENABLE
+	select SYS_SUPPORTS_SMP
 	select NR_CPUS_DEFAULT_64
 	select MIPS_NR_CPU_NR_MAP_1024
 	select SYS_SUPPORTS_NUMA
 	help
-	  This option supports all of the Octeon reference boards from Cavium
-	  Networks. It builds a kernel that dynamically determines the Octeon
-	  CPU type and supports all known board reference implementations.
-	  Some of the supported boards are:
-		EBT3000
-		EBH3000
-		EBH3100
-		Thunder
-		Kodama
-		Hikari
+	  This option supports all of the Octeon SoCs and reference
+	  boards from Cavium, Inc. The Cavium Octeon processor is a
+	  highly integrated chip containing many Ethernet hardware
+	  widgets for networking tasks. The processor can have up to
+	  many Mips64v2 cores (32+) and many integrated 10M - 10G
+	  Ethernet ports.  It builds a kernel that dynamically
+	  determines the Octeon CPU type and supports all known board
+	  reference implementations.
+
 	  Say Y here for most Octeon reference boards.
 
 config NLM_XLR_BOARD
@@ -1384,24 +1389,14 @@ config CPU_SB1
 config CPU_CAVIUM_OCTEON
 	bool "Cavium Octeon processor"
 	depends on SYS_HAS_CPU_CAVIUM_OCTEON
-	select ARCH_SPARSEMEM_ENABLE
 	select CPU_HAS_PREFETCH
 	select CPU_SUPPORTS_64BIT_KERNEL
-	select SYS_SUPPORTS_SMP
-	select NR_CPUS_DEFAULT_16
 	select WEAK_ORDERING
-	select CPU_SUPPORTS_HIGHMEM
 	select CPU_SUPPORTS_HUGEPAGES
-	select LIBFDT
-	select USE_OF
-	select USB_EHCI_BIG_ENDIAN_MMIO
 	select SYS_HAS_DMA_OPS
 	select MIPS_L1_CACHE_SHIFT_7
 	help
-	  The Cavium Octeon processor is a highly integrated chip containing
-	  many ethernet hardware widgets for networking tasks. The processor
-	  can have up to 16 Mips64v2 cores and 8 integrated gigabit ethernets.
-	  Full details can be found at http://www.caviumnetworks.com.
+	  The Cavium Octeon processor is Mips64v2 + extensions.
 
 config CPU_BMIPS
 	bool "Broadcom BMIPS"
diff --git a/arch/mips/cavium-octeon/Kconfig b/arch/mips/cavium-octeon/Kconfig
index c88eca4..d197fa8 100644
--- a/arch/mips/cavium-octeon/Kconfig
+++ b/arch/mips/cavium-octeon/Kconfig
@@ -256,5 +256,4 @@ config OCTEON_ERROR_INJECTOR
 # To be enabled later
 # source "arch/mips/cavium-octeon/executive/Kconfig"
 
-endif # CPU_CAVIUM_OCTEON
-
+endif #CAVIUM_OCTEON_SOC
-- 
1.8.2.1

