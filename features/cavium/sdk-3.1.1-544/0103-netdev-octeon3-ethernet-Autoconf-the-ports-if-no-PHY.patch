From 21739cbe15759f8554132df7d304ee32494ba2ca Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Fri, 6 Jun 2014 14:37:10 -0700
Subject: [PATCH 103/202] netdev: octeon3-ethernet: Autoconf the ports if no
 PHY present.

This allows them to work on MAC-to-MAC mode.

Signed-off-by: David Daney <david.daney@cavium.com>
[Original patch taken from Cavium SDK 3.1.1-544]
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 drivers/net/ethernet/octeon/octeon-bgx-port.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/net/ethernet/octeon/octeon-bgx-port.c b/drivers/net/ethernet/octeon/octeon-bgx-port.c
index 11cefba..373b268 100644
--- a/drivers/net/ethernet/octeon/octeon-bgx-port.c
+++ b/drivers/net/ethernet/octeon/octeon-bgx-port.c
@@ -254,6 +254,7 @@ int bgx_port_enable(struct net_device *netdev)
 	}
 
 	if (priv->phy_np == NULL) {
+		cvmx_helper_link_autoconf(priv->ipd_port);
 		netif_carrier_on(netdev);
 		return 0;
 	}
-- 
1.8.2.1

