From 8919e645ea6ae873f7e946555810c9e3e3d86b9c Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Fri, 13 Feb 2015 14:37:40 +0530
Subject: [PATCH 062/132] ata: Use WARN instead of BUG in pata_octeon_cf.

Commit e320689c53d208a3c298a1026af6b722a2053a10 from
git://git.yoctoproject.org/linux-yocto-3.14

It is preferable not to crash the kernel.

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Abhishek Paliwal <abhishek.paliwal@aricent.com>
[Original patch taken from OCTEON-SDK 3.1.1-544.]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/ata/pata_octeon_cf.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/ata/pata_octeon_cf.c b/drivers/ata/pata_octeon_cf.c
index 2724595..1df599b 100644
--- a/drivers/ata/pata_octeon_cf.c
+++ b/drivers/ata/pata_octeon_cf.c
@@ -153,7 +153,7 @@ static void octeon_cf_set_piomode(struct ata_port *ap, struct ata_device *dev)
 	T = (int)((1000000000000LL * div) / octeon_get_io_clock_rate());
 
 	if (ata_timing_compute(dev, dev->pio_mode, &timing, T, T))
-		BUG();
+		WARN_ON(true);
 
 	t1 = timing.setup;
 	if (t1)
@@ -576,7 +576,7 @@ static void octeon_cf_dma_start(struct ata_queued_cmd *qc)
 
 	/* Get the scatter list entry we need to DMA into */
 	sg = qc->cursg;
-	BUG_ON(!sg);
+	WARN_ON(!sg);
 
 	/*
 	 * Clear the DMA complete status.
@@ -817,7 +817,7 @@ static unsigned int octeon_cf_qc_issue(struct ata_queued_cmd *qc)
 
 	case ATAPI_PROT_DMA:
 		dev_err(ap->dev, "Error, ATAPI not supported\n");
-		BUG();
+		WARN_ON(true);
 
 	default:
 		return ata_sff_qc_issue(qc);
-- 
1.9.1

