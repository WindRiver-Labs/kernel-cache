From b1b9a0f40b7cf9307a48ec8adc6125572cafeeff Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@localhost.localdomain>
Date: Wed, 24 Sep 2014 16:17:22 -0700
Subject: [PATCH 152/202] MIPS:OCTEON: Call appropriate error interrupts based
 on model.

Signed-off-by: Chandrakala Chavva <cchavva@localhost.localdomain>
[Original patch taken from Cavium SDK 3.1.1-544]
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 arch/mips/cavium-octeon/octeon-error-tree.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/mips/cavium-octeon/octeon-error-tree.c b/arch/mips/cavium-octeon/octeon-error-tree.c
index c28b40c..3181e6c 100644
--- a/arch/mips/cavium-octeon/octeon-error-tree.c
+++ b/arch/mips/cavium-octeon/octeon-error-tree.c
@@ -250,7 +250,7 @@ static int __init octeon_error_tree_init(void)
 	u32 prid = read_c0_prid();
 	struct cvmx_error_tree *tree = octeon_error_trees;
 
-	if (disable)
+	if (disable || octeon_has_feature(OCTEON_FEATURE_CIU3))
 		return 0;
 
 	while (tree->tree) {
@@ -318,7 +318,7 @@ static void octeon_error_tree_handler78(int node, int intsn)
 static int __init octeon_error_tree_init78(void)
 {
 	int i;
-	if (disable || !OCTEON_IS_MODEL(OCTEON_CN78XX))
+	if (disable || !octeon_has_feature(OCTEON_FEATURE_CIU3))
 		return 0;
 
 	octeon_ciu3_errbits_set_handler(octeon_error_tree_handler78);
-- 
1.8.2.1

