From cbcbf11a93e1aa5fd3b9c925e7f4ecfd2a66f34c Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Fri, 3 Oct 2014 11:04:48 -0700
Subject: [PATCH 164/202] netdev: octeon3-ethernet: Add comments about buffer
 layout.

Signed-off-by: David Daney <david.daney@cavium.com>
[Original patch taken from Cavium SDK 3.1.1-544]
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 drivers/net/ethernet/octeon/octeon3-ethernet.c | 79 ++++++++++++++++++++++++++
 1 file changed, 79 insertions(+)

diff --git a/drivers/net/ethernet/octeon/octeon3-ethernet.c b/drivers/net/ethernet/octeon/octeon3-ethernet.c
index 1d09395..0c5ea9d2 100644
--- a/drivers/net/ethernet/octeon/octeon3-ethernet.c
+++ b/drivers/net/ethernet/octeon/octeon3-ethernet.c
@@ -49,6 +49,85 @@
 
 #include "octeon-bgx.h"
 
+
+/*
+
+ First buffer:
+
+                              +---SKB---------+
+                              |               |
+                              |               |
+                           +--+--*data        |
+                           |  |               |
+                           |  |               |
+                           |  +---------------+
+                           |       /|\
+                           |        |
+                           |        |
+                          \|/       |
+  WQE - 128 --+-----> +-------------+-------+     -+-
+              |       |    *skb ----+       |      |
+              |       |                     |      |
+              |       |                     |      |
+    WQE_SKIP = 128    |                     |      |
+              |       |                     |      |
+              |       |                     |      |
+              |       |                     |      |
+              |       |                     |      First Skip
+  WQE    -----+-----> +---------------------+      |
+                      |   word 0            |      |
+                      |   word 1            |      |
+                      |   word 2            |      |
+                      |   word 3            |      |
+                      |   word 4            |      |
+                      +---------------------+     -+-
+                 +----+- packet link        |
+                 |    |  packet data        |
+                 |    |                     |
+                 |    |                     |
+                 |    |         .           |
+                 |    |         .           |
+                 |    |         .           |
+                 |    +---------------------+
+                 |
+                 |
+ Later buffers:  |
+                 |
+                 |
+                 |
+                 |
+                 |
+                 |            +---SKB---------+
+                 |            |               |
+                 |            |               |
+                 |         +--+--*data        |
+                 |         |  |               |
+                 |         |  |               |
+                 |         |  +---------------+
+                 |         |       /|\
+                 |         |        |
+                 |         |        |
+                 |        \|/       |
+  WQE - 128 -----+--> +-------------+-------+     -+-
+                 |    |    *skb ----+       |      |
+                 |    |                     |      |
+                 |    |                     |      |
+                 |    |                     |      |
+                 |    |                     |      LATER_SKIP = 128
+                 |    |                     |      |
+                 |    |                     |      |
+                 |    |                     |      |
+                 +--> +---------------------+     -+-
+                      |  packet link        |
+                      |  packet data        |
+                      |                     |
+                      |                     |
+                      |         .           |
+                      |         .           |
+                      |         .           |
+                      +---------------------+
+ */
+
 #define MAX_TX_QUEUE_DEPTH 512
 #define SSO_INTSN_EXE 0x61
 #define OCTEON3_ETH_MAX_NUMA_NODES 2
-- 
1.8.2.1

