From 04e83a8ebc1f35323fb556ea5466d32468c3fa77 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Fri, 13 Feb 2015 15:07:08 +0530
Subject: [PATCH 081/132] MIPS: OCTEON: Enable Micrel 9031 PHY for OCTEON.

Commit 999d26801677d9dbbc897a0255ed155c7324c888 from
git://git.yoctoproject.org/linux-yocto-3.14

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
Signed-off-by: Abhishek Paliwal <abhishek.paliwal@aricent.com>
[Original patch taken from OCTEON-SDK 3.1.1-544.]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/net/phy/micrel.c | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/drivers/net/phy/micrel.c b/drivers/net/phy/micrel.c
index ebdc357..0723331 100644
--- a/drivers/net/phy/micrel.c
+++ b/drivers/net/phy/micrel.c
@@ -576,6 +576,12 @@ static int kszphy_probe(struct phy_device *phydev)
 	return 0;
 }
 
+static struct of_device_id micrel9031_match[] = {
+	{
+		.compatible = "micrel,ksz9031",
+	}
+};
+
 static struct phy_driver ksphy_driver[] = {
 {
 	.phy_id		= PHY_ID_KS8737,
@@ -591,7 +597,10 @@ static struct phy_driver ksphy_driver[] = {
 	.config_intr	= kszphy_config_intr,
 	.suspend	= genphy_suspend,
 	.resume		= genphy_resume,
-	.driver		= { .owner = THIS_MODULE,},
+	.driver		= {
+				.owner = THIS_MODULE,
+				.of_match_table = micrel9031_match,
+			  },
 }, {
 	.phy_id		= PHY_ID_KSZ8021,
 	.phy_id_mask	= 0x00ffffff,
-- 
1.9.1

