From 5c64a084a25401aeb2f27654d06e0b5a38d34b87 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Tue, 8 Jan 2013 15:57:51 -0800
Subject: [PATCH 299/337] MIPS: OCTEON: Initialize KGDB after serial port is
 setup.

Based On SDK 3.0.0-482

Signed-off-by: Corey Minyard <cminyard@mvista.com>
Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 drivers/tty/serial/kgdboc.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/drivers/tty/serial/kgdboc.c b/drivers/tty/serial/kgdboc.c
index 1f11ac5..bb2ab8d 100644
--- a/drivers/tty/serial/kgdboc.c
+++ b/drivers/tty/serial/kgdboc.c
@@ -487,7 +487,11 @@ static int __init kgdboc_early_init(char *opt)
 early_param("ekgdboc", kgdboc_early_init);
 #endif /* CONFIG_KGDB_SERIAL_CONSOLE */
 
+#ifdef CONFIG_CPU_CAVIUM_OCTEON
+late_initcall(init_kgdboc);
+#else
 module_init(init_kgdboc);
+#endif
 module_exit(cleanup_kgdboc);
 module_param_call(kgdboc, param_set_kgdboc_var, param_get_string, &kps, 0644);
 /* The optional paramters to the config string are:
-- 
1.7.5.4

