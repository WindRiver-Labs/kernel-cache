From b5cbf07953e701992cf645b2a2a55cf82c57a509 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Wed, 11 Jul 2012 16:12:20 -0700
Subject: [PATCH 128/337] staging/netdev: octeon-ethernet: Use
 dev_kfree_skb_any instead of dev_kfree_skb_irq.

Based On SDK 3.0.0-482

We may not be in interrupt context here, so don't force the overhead
of dev_kfree_skb_irq().

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 drivers/staging/octeon/ethernet-rx.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/staging/octeon/ethernet-rx.c b/drivers/staging/octeon/ethernet-rx.c
index 0ae2114..c5a3271 100644
--- a/drivers/staging/octeon/ethernet-rx.c
+++ b/drivers/staging/octeon/ethernet-rx.c
@@ -572,7 +572,7 @@ static int cvm_oct_napi_poll(struct napi_struct *napi, int budget)
 			} else {
 				/* Drop any packet received for a device that isn't up */
 				atomic64_add(1, (atomic64_t *)&priv->netdev->stats.rx_dropped);
-				dev_kfree_skb_irq(skb);
+				dev_kfree_skb_any(skb);
 			}
 		} else {
 			/* Drop any packet received for a device that
@@ -580,7 +580,7 @@ static int cvm_oct_napi_poll(struct napi_struct *napi, int budget)
 			 */
 			printk_ratelimited("Port %d not controlled by Linux, packet dropped\n",
 					   work->word1.cn38xx.ipprt);
-			dev_kfree_skb_irq(skb);
+			dev_kfree_skb_any(skb);
 		}
 		/* Check to see if the skbuff and work share the same
 		 * packet buffer.
-- 
1.7.5.4

