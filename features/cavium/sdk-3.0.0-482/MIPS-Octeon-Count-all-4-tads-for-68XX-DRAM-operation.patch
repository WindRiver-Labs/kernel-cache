From de04ffdce69e048eca0e202c836b11b6946196ee Mon Sep 17 00:00:00 2001
From: Venkat Subbiah <venkat.subbiah@cavium.com>
Date: Mon, 19 Nov 2012 14:28:36 -0800
Subject: [PATCH 228/337] MIPS: Octeon: Count all 4 tads for 68XX DRAM
 operations.

Based On SDK 3.0.0-482

Signed-off-by: Venkat Subbiah <venkat.subbiah@cavium.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 arch/mips/cavium-octeon/perf_counters.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/arch/mips/cavium-octeon/perf_counters.c b/arch/mips/cavium-octeon/perf_counters.c
index 5388fb9..273254f 100644
--- a/arch/mips/cavium-octeon/perf_counters.c
+++ b/arch/mips/cavium-octeon/perf_counters.c
@@ -377,9 +377,12 @@ static int proc_perf_show(struct seq_file *m, void *v)
 			cvmx_read_csr(CVMX_LMCX_DCLK_CNT_LO(0));
 	} else {
 		int tad;
+		int tad_cnt = 1;
 		dram_operations = 0;
 		dram_clocks = 0;
-		for (tad = 0; tad < 1; tad++) {
+		if (OCTEON_IS_MODEL(OCTEON_CN68XX))
+			tad_cnt = 4;
+		for (tad = 0; tad < tad_cnt; tad++) {
 			dram_operations += cvmx_read_csr
 					(CVMX_LMCX_OPS_CNT(tad));
 			dram_clocks += cvmx_read_csr
-- 
1.7.5.4

