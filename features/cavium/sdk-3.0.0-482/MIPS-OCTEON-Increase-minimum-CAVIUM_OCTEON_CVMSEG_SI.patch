From d5dd1bc3f415ac9dad7b612bff2a5aeaab8f296e Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Tue, 25 Sep 2012 11:53:01 -0700
Subject: [PATCH 171/337] MIPS: OCTEON: Increase minimum
 CAVIUM_OCTEON_CVMSEG_SIZE to two.

Based On SDK 3.0.0-482

This allows optimal operation with fast TLB refill handlers and IOBDMA
operations.  Also some chips require that the CVMSEG blocks used by
IOBDMA are disjoint from those used as scratchpad working memory, two
block satisfies this requirement.

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 arch/mips/cavium-octeon/Kconfig |    9 ++++++---
 1 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/arch/mips/cavium-octeon/Kconfig b/arch/mips/cavium-octeon/Kconfig
index 1548ca8..c88b391 100644
--- a/arch/mips/cavium-octeon/Kconfig
+++ b/arch/mips/cavium-octeon/Kconfig
@@ -33,15 +33,18 @@ config CAVIUM_OCTEON_HW_FIX_UNALIGNED
 
 config CAVIUM_OCTEON_CVMSEG_SIZE
 	int "Number of L1 cache lines reserved for CVMSEG memory"
-	range 0 54
-	default 1
+	range 2 54
+	default 2
 	help
 	  CVMSEG LM is a segment that accesses portions of the dcache as a
 	  local memory; the larger CVMSEG is, the smaller the cache is.
 	  This selects the size of CVMSEG LM, which is in cache blocks. The
-	  legally range is from zero to 54 cache blocks (i.e. CVMSEG LM is
+	  legally range is from 2 to 54 cache blocks (i.e. CVMSEG LM is
 	  between zero and 6192 bytes).
 
+	  The kernel uses two blocks (one for TLB exception handlers
+	  and the other for driver IOBDMA operations).
+
 config FAST_ACCESS_TO_THREAD_POINTER
 	bool "Enable fast access to the thread pointer"
 	default "y"
-- 
1.7.5.4

