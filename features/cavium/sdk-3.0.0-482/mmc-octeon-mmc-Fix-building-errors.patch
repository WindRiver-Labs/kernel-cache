From 9817a7feac9a2ddc9217bd24b555526004459bb6 Mon Sep 17 00:00:00 2001
From: Yang Wei <Wei.Yang@windriver.com>
Date: Mon, 4 Aug 2014 14:38:19 +0800
Subject: [PATCH 19/20] mmc:octeon-mmc:Fix building errors:

There are two building errors:

drivers/mmc/host/octeon_mmc.c:131:7: error: 'OCTEON_CN70XX'
undeclared (first use in this function)
drivers/mmc/host/octeon_mmc.c:132:19: error: 'CVMX_MIO_BOOT_CTL'
undeclared (first use in this function)

The fix is picked from a patch of SDK-3.1.0-515
0110-MIPS-OCTEON-Import-new-S.E.-and-adjust-things-to-mat.patch

Signed-off-by: Yang Wei <Wei.Yang@windriver.com>
---
 arch/mips/include/asm/octeon/cvmx-mio-defs.h |   11 +++++++++++
 arch/mips/include/asm/octeon/octeon-model.h  |    3 +++
 2 files changed, 14 insertions(+), 0 deletions(-)

diff --git a/arch/mips/include/asm/octeon/cvmx-mio-defs.h b/arch/mips/include/asm/octeon/cvmx-mio-defs.h
index d40e2dc..61346ba 100644
--- a/arch/mips/include/asm/octeon/cvmx-mio-defs.h
+++ b/arch/mips/include/asm/octeon/cvmx-mio-defs.h
@@ -65,6 +65,17 @@ static inline uint64_t CVMX_MIO_BOOT_COMP_FUNC(void)
 #define CVMX_MIO_BOOT_COMP (CVMX_ADD_IO_SEG(0x00011800000000B8ull))
 #endif
 #if CVMX_ENABLE_CSR_ADDRESS_CHECKING
+#define CVMX_MIO_BOOT_CTL CVMX_MIO_BOOT_CTL_FUNC()
+static inline uint64_t CVMX_MIO_BOOT_CTL_FUNC(void)
+{
+	if (!(OCTEON_IS_MODEL(OCTEON_CN70XX)))
+		cvmx_warn("CVMX_MIO_BOOT_CTL not supported on this chip\n");
+	return CVMX_ADD_IO_SEG(0x00011800000000D0ull);
+}
+#else
+#define CVMX_MIO_BOOT_CTL (CVMX_ADD_IO_SEG(0x00011800000000D0ull))
+#endif
+#if CVMX_ENABLE_CSR_ADDRESS_CHECKING
 static inline uint64_t CVMX_MIO_BOOT_DMA_CFGX(unsigned long offset)
 {
 	if (!(
diff --git a/arch/mips/include/asm/octeon/octeon-model.h b/arch/mips/include/asm/octeon/octeon-model.h
index 64cfbbc..5cb74ce 100644
--- a/arch/mips/include/asm/octeon/octeon-model.h
+++ b/arch/mips/include/asm/octeon/octeon-model.h
@@ -77,6 +77,7 @@ extern "C" {
 */
 
 #define OCTEON_FAMILY_MASK      0x00ffff00
+#define OCTEON_CN70XX_PASS1_0   0x000d9600
 #define OCTEON_PRID_MASK	0x00ffffff
 
 /* Flag bits in top byte */
@@ -91,6 +92,8 @@ extern "C" {
 #define OM_MATCH_F7XXX_FAMILY_MODELS    0x80000000	/* Match all cnf7XXX Octeon models. */
 #define OM_MATCH_FAMILY_MODELS		(OM_MATCH_5XXX_FAMILY_MODELS | OM_MATCH_6XXX_FAMILY_MODELS | OM_MATCH_F7XXX_FAMILY_MODELS)
 
+#define OCTEON_CN70XX           (OCTEON_CN70XX_PASS1_0 | OM_IGNORE_REVISION)
+#define OCTEON_CN70XX_PASS1_X   (OCTEON_CN70XX_PASS1_0 | OM_IGNORE_MINOR_REVISION)
 /*
  * CNF7XXX models with new revision encoding
  */
-- 
1.7.5.4

