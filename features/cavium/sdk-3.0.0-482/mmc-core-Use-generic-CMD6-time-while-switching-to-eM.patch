From 27f9daccd91e56fe23c857e80abb458b78c853c6 Mon Sep 17 00:00:00 2001
From: Ulf Hansson <ulf.hansson@linaro.org>
Date: Tue, 14 Jan 2014 17:36:21 +0100
Subject: [PATCH 05/20] mmc: core: Use generic CMD6 time while switching to
 eMMC HS200 mode

commit 57de31f6351ecad9212a26d2112b546e4c8b4a5b upstream

Conform to the eMMC spec and use the CMD6 generic timeout from the
EXT_CSD register, when switching to HS200 mode.

Signed-off-by: Ulf Hansson <ulf.hansson@linaro.org>
Signed-off-by: Chris Ball <chris@printf.net>
Signed-off-by: Yang Wei <Wei.Yang@windriver.com>
---
 drivers/mmc/core/mmc.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/drivers/mmc/core/mmc.c b/drivers/mmc/core/mmc.c
index c72be26..02798a8 100644
--- a/drivers/mmc/core/mmc.c
+++ b/drivers/mmc/core/mmc.c
@@ -818,7 +818,8 @@ static int mmc_select_hs200(struct mmc_card *card)
 	/* switch to HS200 mode if bus width set successfully */
 	if (!err)
 		err = mmc_switch(card, EXT_CSD_CMD_SET_NORMAL,
-				 EXT_CSD_HS_TIMING, 2, 0);
+				 EXT_CSD_HS_TIMING, 2,
+				 card->ext_csd.generic_cmd6_time);
 err:
 	return err;
 }
-- 
1.7.5.4

