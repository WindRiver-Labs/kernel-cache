From ca848988737a95306f6e6ff8473f871efe402632 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Fri, 3 Jun 2011 10:40:33 -0700
Subject: [PATCH 253/337] MIPS: Octeon: Fix the FUSE mask value.

Based On SDK 3.0.0-482

Octeon II models have 32 cores, fix the mask to return correct
number of cores.

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 arch/mips/include/asm/octeon/cvmx.h |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/mips/include/asm/octeon/cvmx.h b/arch/mips/include/asm/octeon/cvmx.h
index 0c04d2c..8f705ce 100644
--- a/arch/mips/include/asm/octeon/cvmx.h
+++ b/arch/mips/include/asm/octeon/cvmx.h
@@ -419,7 +419,7 @@ static inline void cvmx_reset_octeon(void)
 /* Return the number of cores available in the chip */
 static inline uint32_t cvmx_octeon_num_cores(void)
 {
-	uint32_t ciu_fuse = (uint32_t) cvmx_read_csr(CVMX_CIU_FUSE) & 0xffff;
+	uint32_t ciu_fuse = (uint32_t) cvmx_read_csr(CVMX_CIU_FUSE) & 0xffffffff;
 	return cvmx_pop(ciu_fuse);
 }
 
-- 
1.7.5.4

