From 4a5bc40b733557327ef2084b71250ac7b6d24c15 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Tue, 8 Oct 2013 19:06:59 -0700
Subject: [PATCH 289/382] netdev: octeon-ethernet: Allocate queues for QSGMII interface.

Based on SDK octeon3_3.10.

QSGMII is similar to SGMII, parse device tree to make sure the ports
on the interface are valid. Allocate resources to the available ports.

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/net/ethernet/octeon/ethernet.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/drivers/net/ethernet/octeon/ethernet.c b/drivers/net/ethernet/octeon/ethernet.c
index dff2a5f..e693309 100644
--- a/drivers/net/ethernet/octeon/ethernet.c
+++ b/drivers/net/ethernet/octeon/ethernet.c
@@ -213,6 +213,7 @@ static bool cvm_oct_pko_lockless(void)
 			case CVMX_HELPER_INTERFACE_MODE_XAUI:
 			case CVMX_HELPER_INTERFACE_MODE_RXAUI:
 			case CVMX_HELPER_INTERFACE_MODE_SGMII:
+			case CVMX_HELPER_INTERFACE_MODE_QSGMII:
 			case CVMX_HELPER_INTERFACE_MODE_RGMII:
 			case CVMX_HELPER_INTERFACE_MODE_GMII:
 			case CVMX_HELPER_INTERFACE_MODE_SPI:
@@ -250,6 +251,7 @@ static void cvm_oct_set_pko_multiqueue(void)
 			case CVMX_HELPER_INTERFACE_MODE_XAUI:
 			case CVMX_HELPER_INTERFACE_MODE_RXAUI:
 			case CVMX_HELPER_INTERFACE_MODE_SGMII:
+			case CVMX_HELPER_INTERFACE_MODE_QSGMII:
 			case CVMX_HELPER_INTERFACE_MODE_AGL:
 			case CVMX_HELPER_INTERFACE_MODE_RGMII:
 			case CVMX_HELPER_INTERFACE_MODE_GMII:
@@ -774,6 +776,7 @@ static int cvm_oct_get_port_status(struct device_node *pip)
 			case CVMX_HELPER_INTERFACE_MODE_XAUI:
 			case CVMX_HELPER_INTERFACE_MODE_RXAUI:
 			case CVMX_HELPER_INTERFACE_MODE_SPI:
+			case CVMX_HELPER_INTERFACE_MODE_AGL:
 				if (cvm_oct_node_for_port(pip, i, j) != NULL)
 					cvmx_helper_set_port_valid(i, j, true);
 				else
@@ -782,7 +785,7 @@ static int cvm_oct_get_port_status(struct device_node *pip)
 				cvmx_helper_set_1000x_mode(i, j, false);
 				break;
 			case CVMX_HELPER_INTERFACE_MODE_SGMII:
-			case CVMX_HELPER_INTERFACE_MODE_AGL:
+			case CVMX_HELPER_INTERFACE_MODE_QSGMII:
 			{
 				struct device_node *n;
 				if (cvm_oct_node_for_port(pip, i, j) != NULL)
-- 
1.7.0.4

