From d6d20a9b7ee721ebb89d0fe8b17a8258e762d5d6 Mon Sep 17 00:00:00 2001
From: Leonid Rosenboim <lrosenboim@caviumnetworks.com>
Date: Thu, 10 Oct 2013 15:25:43 -0700
Subject: [PATCH 291/382] Fix macro name clash when KVM enabled

Based on SDK octeon3_3.10.

Use the CP0_CVMCTL register definition already defined in the file
instead of including cvmx-asm.h header for that purpose.
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 .../asm/mach-cavium-octeon/kernel-entry-init.h     |    7 +++----
 1 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h b/arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h
index c094113..4f01f24 100644
--- a/arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h
+++ b/arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h
@@ -8,8 +8,6 @@
 #ifndef __ASM_MACH_CAVIUM_OCTEON_KERNEL_ENTRY_H
 #define __ASM_MACH_CAVIUM_OCTEON_KERNEL_ENTRY_H
 
-#include "asm/octeon/cvmx-asm.h"
-
 #define CP0_CVMCTL_REG $9, 7
 #define CP0_CVMMEMCTL_REG $11,7
 #define CP0_PRID_REG $15, 0
@@ -44,11 +42,12 @@ FEXPORT(octeon_hotplug_entry)
 	.set push
 	.set noreorder
 	/* Hotpplugged CPUs enter in Big-Endian mode, switch here to LE */
-	dmfc0   v0, COP0_CVMCTL
+	dmfc0   v0, CP0_CVMCTL
 	nop
 	ori     v0, v0, 2
 	nop
-	dmtc0   v0, COP0_CVMCTL	/* little-endian */
+	dmtc0   v0, CP0_CVMCTL	/* little-endian */
+	nop
 	synci	0($0)
 	.set pop
 #endif	/* CONFIG_CPU_LITTLE_ENDIAN */
-- 
1.7.0.4

