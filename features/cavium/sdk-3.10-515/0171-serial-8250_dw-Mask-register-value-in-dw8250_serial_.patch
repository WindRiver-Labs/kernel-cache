From 08219d92543d44b3951b2f45ebfa9081c092c324 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Tue, 23 Jul 2013 11:43:24 -0700
Subject: [PATCH 171/382] serial: 8250_dw: Mask register value in dw8250_serial_outq.

Based on SDK octeon3_3.10.

Any one bits created by sign extension can cause undefined behavior.

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/tty/serial/8250/8250_dw.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/tty/serial/8250/8250_dw.c b/drivers/tty/serial/8250/8250_dw.c
index cb94f9f..3d55cc3 100644
--- a/drivers/tty/serial/8250/8250_dw.c
+++ b/drivers/tty/serial/8250/8250_dw.c
@@ -76,6 +76,7 @@ static void dw8250_serial_outq(struct uart_port *p, int offset, int value)
 		d->last_lcr = value;
 
 	offset <<= p->regshift;
+	value &= 0xff;
 	__raw_writeq(value, p->membase + offset);
 	dw8250_serial_inq(p, UART_LCR);
 }
-- 
1.7.0.4

