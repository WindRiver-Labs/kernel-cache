From 3f55be328c57ef94096899a60506787cfd833704 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Thu, 17 Oct 2013 19:50:42 -0700
Subject: [PATCH 303/382] MIPS:USB:OCTEON: Configure SHIM according to endianness

Based on SDK octeon3_3.10.

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/usb/host/xhci-octeon.c |    7 ++++++-
 1 files changed, 6 insertions(+), 1 deletions(-)

diff --git a/drivers/usb/host/xhci-octeon.c b/drivers/usb/host/xhci-octeon.c
index e35e9fb..4b592eb 100644
--- a/drivers/usb/host/xhci-octeon.c
+++ b/drivers/usb/host/xhci-octeon.c
@@ -179,8 +179,13 @@ void octeon3_usb_set_endian_mode(int index)
 {
 	union cvmx_usbdrdx_uctl_shim_cfg shim_cfg;
 	shim_cfg.u64 = cvmx_read_csr(CVMX_USBDRDX_UCTL_SHIM_CFG(index));
+#ifdef __BIG_ENDIAN
 	shim_cfg.s.dma_endian_mode = 1;
-	shim_cfg.s.csr_endian_mode = 1; //to_do, check for little big endian
+	shim_cfg.s.csr_endian_mode = 1;
+#else
+	shim_cfg.s.dma_endian_mode = 0;
+	shim_cfg.s.csr_endian_mode = 0;
+#endif
 	cvmx_write_csr(CVMX_USBDRDX_UCTL_SHIM_CFG(index), shim_cfg.u64);
 }
 EXPORT_SYMBOL(octeon3_usb_set_endian_mode);
-- 
1.7.0.4

