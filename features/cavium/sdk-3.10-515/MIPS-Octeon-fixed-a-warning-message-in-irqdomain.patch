From 8c956c540acd2a5e9350d40e4440b63e79946cc6 Mon Sep 17 00:00:00 2001
From: Bin Jiang <bin.jiang@windriver.com>
Date: Tue, 26 Mar 2013 16:03:49 +0800
Subject: [PATCH 1/5] MIPS: Octeon: fixed a warning message in irqdomain

The hwirq is DMA, it failed in "octeon_irq_ciu_to_irq[line][bit] != 0".
This condition should be used for GPIO, need more investigatation.

irq: irq-121==>hwirq-0x3f mapping failed: -22
------------[ cut here ]------------
WARNING: at linux/kernel/irq/irqdomain.c:444 irq_domain_associate_many+0x230/0x250()
Modules linked in:
Call Trace:
[<ffffffff80832068>] dump_stack+0x1c/0x50
[<ffffffff8017110c>] warn_slowpath_common+0x8c/0xc0
[<ffffffff8017116c>] warn_slowpath_null+0x2c/0x40
[<ffffffff80200b48>] irq_domain_associate_many+0x230/0x250
[<ffffffff80200c0c>] irq_create_mapping+0xa4/0x180
[<ffffffff80200d6c>] irq_create_of_mapping+0x84/0x190
[<ffffffff806cdf08>] irq_of_parse_and_map+0x50/0x68
[<ffffffff806cdf5c>] of_irq_to_resource+0x3c/0xe8
[<ffffffff806ce04c>] of_irq_count+0x44/0x68
[<ffffffff806ce91c>] of_device_alloc+0x8c/0x230
[<ffffffff806ceb10>] of_platform_device_create_pdata+0x50/0xe0
[<ffffffff806cece8>] of_platform_bus_create+0x148/0x210
[<ffffffff806ced48>] of_platform_bus_create+0x1a8/0x210
[<ffffffff806cee74>] of_platform_bus_probe+0xc4/0x108
[<ffffffff80a9d220>] octeon_publish_devices+0x24/0x38
[<ffffffff8010044c>] do_one_initcall+0x4c/0x180

Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
Signed-off-by: Jack Tan <jack.tan@windriver.com>
---
 arch/mips/cavium-octeon/octeon-irq.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/mips/cavium-octeon/octeon-irq.c b/arch/mips/cavium-octeon/octeon-irq.c
index 53acb5f..ae47ce1 100644
--- a/arch/mips/cavium-octeon/octeon-irq.c
+++ b/arch/mips/cavium-octeon/octeon-irq.c
@@ -1889,7 +1889,7 @@ static int octeon_irq_ciu2_map(struct irq_domain *d,
 		return -EINVAL;
 
 	/* Line 7  are the GPIO lines */
-	if (line > 6 || octeon_irq_ciu_to_irq[line][bit] != 0)
+	if (line > 6)
 		return -EINVAL;
 
 	if (octeon_irq_ciu2_is_edge(line, bit))
-- 
1.7.5.4

