From 2acc4d40f50d26c634938534b7ab696f35e41426 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Wed, 19 Dec 2012 16:52:01 -0800
Subject: [PATCH 111/382] MIPS/OCTEON: Initialize QLM JTAG.

Based on SDK octeon3_3.10.

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/cavium-octeon/setup.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/arch/mips/cavium-octeon/setup.c b/arch/mips/cavium-octeon/setup.c
index 5cad063..5613c70 100644
--- a/arch/mips/cavium-octeon/setup.c
+++ b/arch/mips/cavium-octeon/setup.c
@@ -43,6 +43,8 @@
 #include <asm/octeon/pci-octeon.h>
 #include <asm/octeon/cvmx-mio-defs.h>
 
+#include <asm/octeon/cvmx-qlm.h>
+
 extern struct plat_smp_ops octeon_smp_ops;
 
 static unsigned long long MAX_MEMORY = 512ull << 20;
@@ -1100,6 +1102,9 @@ mem_alloc_done:
 	if (total == 0)
 		panic("Unable to allocate memory from "
 		      "cvmx_bootmem_phy_alloc\n");
+
+	/* Initialize QLM and also apply any erratas */
+	cvmx_qlm_init();
 }
 
 /*
-- 
1.7.0.4

