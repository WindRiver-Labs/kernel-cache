From 110bd230900a5b425ee51e4ab7a39bdf91978fee Mon Sep 17 00:00:00 2001
From: David Daney <ddaney@caviumnetworks.com>
Date: Fri, 14 May 2010 14:22:55 -0700
Subject: [PATCH 081/518] MIPS: Octeon: Increase PCI_CONFIG_SPACE_DELAY

Source: Cavium Networks, Inc.
MR: 00000
Type: Integration
Disposition: Merged from Octeon Tree
ChangeID: 5d84506bc8e8f80fdf943f2ca6c2e01b3564b4c2
Description:

Some PCI cards require delays when accessing config space. A Sil3124
behind an Intel bridge will fail with 10ms and succeed with 11ms. The
setting below of 15ms adds some extra.

Signed-off-by: David Daney <ddaney@caviumnetworks.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
[Original patch taken from Cavium SDK 3.1.1 525]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/include/asm/octeon/pci-octeon.h | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/arch/mips/include/asm/octeon/pci-octeon.h b/arch/mips/include/asm/octeon/pci-octeon.h
index 64ba56a..9397ef1 100644
--- a/arch/mips/include/asm/octeon/pci-octeon.h
+++ b/arch/mips/include/asm/octeon/pci-octeon.h
@@ -11,8 +11,12 @@
 
 #include <linux/pci.h>
 
-/* Some PCI cards require delays when accessing config space. */
-#define PCI_CONFIG_SPACE_DELAY 10000
+/*
+ * Some PCI cards require delays when accessing config space. A
+ * Sil3124 behind an Intel bridge will fail with 10ms and succeed with
+ * 11ms. The setting below of 15ms adds some extra.
+ */
+#define PCI_CONFIG_SPACE_DELAY 15000
 
 /*
  * The physical memory base mapped by BAR1.  256MB at the end of the
-- 
1.9.1

