From bb82ff63f004457f69f1dcab28dfd99f580de878 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Wed, 4 Dec 2013 12:15:15 -0800
Subject: [PATCH 361/518] ata: sata_octeon: Adjust DMA parameters.

Source: Cavium Networks, Inc.
MR: 00000
Type: Integration
Disposition: Merged from Octeon Tree
ChangeID: 5c41dc8f232ad62abc241f7f170e3609847c2293
Description:

Setting DMA_READ_CMD to 1, thus not polluting the L2 cache as much
helps write performance.

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
[Original patch taken from Cavium SDK 3.1.1 525]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/ata/sata_octeon.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/ata/sata_octeon.c b/drivers/ata/sata_octeon.c
index b84731b..f757414 100644
--- a/drivers/ata/sata_octeon.c
+++ b/drivers/ata/sata_octeon.c
@@ -30,6 +30,7 @@ void ahci_octeon_config(struct platform_device *pdev)
 	shim_cfg.s.dma_endian_mode = 0;
 	shim_cfg.s.csr_endian_mode = 0;
 #endif
+	shim_cfg.s.dma_read_cmd = 1; /* No allocate L2C */
 	cvmx_write_csr(CVMX_SATA_UCTL_SHIM_CFG, shim_cfg.u64);
 
 	/* Set a good dma_mask */
-- 
1.9.1

