From a1b300103c723c359564e117350076fbf892c4fd Mon Sep 17 00:00:00 2001
From: Corey Minyard <cminyard@mvista.com>
Date: Fri, 14 Jun 2013 13:05:06 -0500
Subject: [PATCH 121/518] MIPS: Octeon: Change kuid_t references to
 __kuid_val()

There were some arithmetic references to some kuid_t values.  That
won't work if CONFIG_UIDGID_STRICT_TYPE_CHECKS is set, use the
proper reference.

Signed-off-by: Corey Minyard <cminyard@mvista.com>
[Original patch taken from Cavium SDK 3.1.1 525]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/cavium-octeon/setup.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/arch/mips/cavium-octeon/setup.c b/arch/mips/cavium-octeon/setup.c
index 087e424..9e795fb 100644
--- a/arch/mips/cavium-octeon/setup.c
+++ b/arch/mips/cavium-octeon/setup.c
@@ -519,10 +519,10 @@ static int is_task_and_current_same(struct task_struct *t)
 	const struct cred *cred = current_cred(), *tcred;
 
 	tcred = __task_cred(t);
-	if ((cred->euid ^ tcred->suid) &&
-	    (cred->euid ^ tcred->uid) &&
-	    (cred->uid  ^ tcred->suid) &&
-	    (cred->uid  ^ tcred->uid)) {
+	if ((__kuid_val(cred->euid) ^ __kuid_val(tcred->suid)) &&
+	    (__kuid_val(cred->euid) ^ __kuid_val(tcred->uid)) &&
+	    (__kuid_val(cred->uid)  ^ __kuid_val(tcred->suid)) &&
+	    (__kuid_val(cred->uid)  ^ __kuid_val(tcred->uid))) {
 		return 0;
 	}
 	return 1;
-- 
1.9.1

