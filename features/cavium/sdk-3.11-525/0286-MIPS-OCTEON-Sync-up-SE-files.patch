From 29c30feb410d6c1c644f189f6b75a07e6baed15e Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Fri, 18 Oct 2013 09:40:17 -0700
Subject: [PATCH 286/518] MIPS: OCTEON: Sync up SE files

Source: Cavium Networks, Inc.
MR: 00000
Type: Integration
Disposition: Merged from Octeon Tree
ChangeID: 2c204218ae5ef2c2ba63e0b59125ead9ef0b1410
Description:

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
[Original patch taken from Cavium SDK 3.1.1 525]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/cavium-octeon/executive/cvmx-qlm.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/mips/cavium-octeon/executive/cvmx-qlm.c b/arch/mips/cavium-octeon/executive/cvmx-qlm.c
index 111b532..bc3c7e6 100644
--- a/arch/mips/cavium-octeon/executive/cvmx-qlm.c
+++ b/arch/mips/cavium-octeon/executive/cvmx-qlm.c
@@ -42,7 +42,7 @@
  *
  * Helper utilities for qlm.
  *
- * <hr>$Revision: 88975 $<hr>
+ * <hr>$Revision: 89635 $<hr>
  */
 #ifdef CVMX_BUILD_FOR_LINUX_KERNEL
 #include <asm/octeon/cvmx.h>
@@ -807,8 +807,6 @@ static enum cvmx_qlm_mode __cvmx_qlm_get_mode_cn70xx(int qlm)
 			pem1_cfg.u64 = cvmx_read_csr(CVMX_PEMX_CFG(1));
 			pem2_cfg.u64 = cvmx_read_csr(CVMX_PEMX_CFG(2));
 
-			if (sata_cfg.s.sata_en)
-				return CVMX_QLM_MODE_SATA_2X1;
 			if (pem0_cfg.cn70xx.md == CVMX_PEM_MD_GEN2_4LANE
 			    || pem0_cfg.cn70xx.md == CVMX_PEM_MD_GEN1_4LANE)
 				return CVMX_QLM_MODE_PCIE;
@@ -827,6 +825,8 @@ static enum cvmx_qlm_mode __cvmx_qlm_get_mode_cn70xx(int qlm)
 			    || pem2_cfg.cn70xx.md == CVMX_PEM_MD_GEN1_1LANE)
 				return CVMX_QLM_MODE_PCIE_2X1;
 			return CVMX_QLM_MODE_DISABLED;
+			if (sata_cfg.s.sata_en)
+				return CVMX_QLM_MODE_SATA_2X1;
 		}
 	default:
 		return CVMX_QLM_MODE_DISABLED;
-- 
1.9.1

