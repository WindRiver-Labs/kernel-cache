From 1b196aede8cb9ff9b98bf1dd415724474ab4bab6 Mon Sep 17 00:00:00 2001
From: David Daney <ddaney@caviumnetworks.com>
Date: Fri, 10 Jun 2011 16:53:45 -0700
Subject: [PATCH 086/518] MIPS: Octeon: Don't restore $ra in SAVE_SOME

Source: Cavium Networks, Inc.
MR: 00000
Type: Integration
Disposition: Merged from Octeon Tree
ChangeID: b0c4419a0f725199b47fe4403fb42432d6438559
Description:

The $ra value is never used, so we can save an instruction by not
restoring it.

Signed-off-by: David Daney <ddaney@caviumnetworks.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
[Original patch taken from Cavium SDK 3.1.1 525]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/include/asm/stackframe.h | 2 --
 1 file changed, 2 deletions(-)

diff --git a/arch/mips/include/asm/stackframe.h b/arch/mips/include/asm/stackframe.h
index 7c67f6b..67642e0 100644
--- a/arch/mips/include/asm/stackframe.h
+++ b/arch/mips/include/asm/stackframe.h
@@ -226,8 +226,6 @@
 		    corrupt it */
 		jal	octeon_mult_save
 		LONG_L	v1, 0($28)  /* Load the current pointer */
-			 /* Restore $31(ra) that was changed by the jal */
-		LONG_L	ra, PT_R31(sp)
 		pref	0, 0(v1)    /* Prefetch the current thread */
 #endif
 		.set	pop
-- 
1.9.1

