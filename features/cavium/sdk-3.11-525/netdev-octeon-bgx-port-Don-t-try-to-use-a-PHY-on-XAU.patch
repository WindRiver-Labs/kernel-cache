From 584085f57fd2afa8dd34afe2cec1a2aa3db6b732 Mon Sep 17 00:00:00 2001
From: Bin Jiang <bin.jiang@windriver.com>
Date: Thu, 16 Oct 2014 15:18:41 +0800
Subject: [PATCH] netdev: octeon-bgx-port: Don't try to use a PHY on XAUI
 port.

It's no need to connect to a PHY for XAUI.

Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 drivers/net/ethernet/octeon/octeon-bgx-port.c |    3 +--
 1 files changed, 1 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/octeon/octeon-bgx-port.c b/drivers/net/ethernet/octeon/octeon-bgx-port.c
index 373b268..b3c0bfc 100644
--- a/drivers/net/ethernet/octeon/octeon-bgx-port.c
+++ b/drivers/net/ethernet/octeon/octeon-bgx-port.c
@@ -252,8 +252,7 @@ int bgx_port_enable(struct net_device *netdev)
 				    min_pkt.u64);
 
 	}
-
-	if (priv->phy_np == NULL) {
+	if ((priv->phy_np == NULL) || (cfg.s.lmac_type != 0)) {
 		cvmx_helper_link_autoconf(priv->ipd_port);
 		netif_carrier_on(netdev);
 		return 0;
-- 
1.7.5.4

