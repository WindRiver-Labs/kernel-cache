From eb96f2cbb9f48f2faefddc803788b70bc59dde55 Mon Sep 17 00:00:00 2001
From: Peter Swain <pswain@cavium.com>
Date: Wed, 11 Nov 2015 16:18:08 -0800
Subject: [PATCH 164/184] mips: octeon: adjust 32bit memory reservation when
 mem >= 16GB

Increase the low-address-space reservation for systems
with 16..32GB main memory.
Now they reserve 512MB.

Signed-off-by: Peter Swain <pswain@cavium.com>
[Original patch taken from octeon-linux-kernel-patches-SDK-3.1.2-release]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/cavium-octeon/setup.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/mips/cavium-octeon/setup.c b/arch/mips/cavium-octeon/setup.c
index ae6577a..1943b57 100644
--- a/arch/mips/cavium-octeon/setup.c
+++ b/arch/mips/cavium-octeon/setup.c
@@ -1045,7 +1045,7 @@ void __init plat_mem_setup(void)
                 system_limit = max_memory;
 
 	/* Try to get 256MB (or more) of 32-bit memory */
-	mem_32_size = system_limit <= (16ull * (2 << 30)) ? 256 * (1 << 20) : 512 * (1 << 20);
+	mem_32_size = system_limit <= (16ull * (1ull << 30)) ? 256 * (1 << 20) : 512 * (1 << 20);
 
 	cvmx_bootmem_lock();
 	limit_max = 0xffffffffull;
-- 
1.9.1

