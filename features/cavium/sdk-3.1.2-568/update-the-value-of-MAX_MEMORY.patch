From ca04004a7c241fa24b94a2ebda57e2451fc3662e Mon Sep 17 00:00:00 2001
From: Jack Tan <jack.tan@windriver.com>
Date: Thu, 30 Aug 2012 17:44:50 +0800
Subject: [PATCH 3/4] update the value of MAX_MEMORY

get the correct value of MAX_MEMORY from bootinfo structure

Signed-off-by: Jack Tan <jack.tan@windriver.com>
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 arch/mips/cavium-octeon/setup.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/arch/mips/cavium-octeon/setup.c b/arch/mips/cavium-octeon/setup.c
index 72b220d..ddf2528 100644
--- a/arch/mips/cavium-octeon/setup.c
+++ b/arch/mips/cavium-octeon/setup.c
@@ -591,6 +591,7 @@ void __init prom_init(void)
 	 */
 	octeon_boot_desc_ptr = (struct octeon_boot_descriptor *)fw_arg3;
 	octeon_bootinfo = phys_to_virt(octeon_boot_desc_ptr->cvmx_desc_vaddr);
+	max_memory = (uint64_t)octeon_bootinfo->dram_size << 20;
 	cvmx_bootmem_init(octeon_bootinfo->phy_mem_desc_addr);
 
 	sysinfo = cvmx_sysinfo_get();
-- 
1.7.5.4

