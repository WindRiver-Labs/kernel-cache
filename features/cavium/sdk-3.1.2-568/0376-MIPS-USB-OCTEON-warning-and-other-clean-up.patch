From 8d4a1d3336dc46691f2a644e4ed6b093950b2dab Mon Sep 17 00:00:00 2001
From: Vinita Gupta <vgupta@caviumnetworks.com>
Date: Tue, 5 Nov 2013 16:41:45 -0800
Subject: [PATCH 376/974] MIPS:USB:OCTEON:warning and other clean up

Signed-off-by: Vinita Gupta <vgupta@caviumnetworks.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/usb/dwc3/core.c        | 4 ++--
 drivers/usb/host/xhci-octeon.c | 8 ++++----
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/drivers/usb/dwc3/core.c b/drivers/usb/dwc3/core.c
index a33d9ae..e80ba72 100644
--- a/drivers/usb/dwc3/core.c
+++ b/drivers/usb/dwc3/core.c
@@ -64,8 +64,8 @@ static char *maximum_speed = "super";
 module_param(maximum_speed, charp, 0);
 MODULE_PARM_DESC(maximum_speed, "Maximum supported speed.");
 extern void octeon3_usb_phy_reset(int index);
-extern int xhci_octeon_start(struct paltform_device *pdev);
-extern int xhci_octeon_stop(struct paltform_device *pdev);
+extern int xhci_octeon_start(struct platform_device *pdev);
+extern int xhci_octeon_stop(struct platform_device *pdev);
 static u64 xhci_octeon_dma_mask = DMA_BIT_MASK(64);
 
 /* -------------------------------------------------------------------------- */
diff --git a/drivers/usb/host/xhci-octeon.c b/drivers/usb/host/xhci-octeon.c
index 9180ffe..72e9e4d 100644
--- a/drivers/usb/host/xhci-octeon.c
+++ b/drivers/usb/host/xhci-octeon.c
@@ -202,7 +202,7 @@ static void octeon3_usb_clocks_start(struct platform_device *pdev, int index)
 	uctl_ctl.s.drd_mode = 0;
 	cvmx_write_csr(CVMX_USBDRDX_UCTL_CTL(index), uctl_ctl.u64);
 
-	octeon_error_tree_enable(CVMX_ERROR_GROUP_USB, -1);//to_do separate for both usb
+	octeon_error_tree_enable(CVMX_ERROR_GROUP_USB, index);
 exit:
 	if (index == 0)
 		mutex_unlock(&octeon3_usb1_clocks_mutex);
@@ -217,13 +217,13 @@ static void octeon3_usb_clocks_stop(int index)
 		mutex_lock(&octeon3_usb1_clocks_mutex);
 		octeon3_usb1_clock_start_cnt--;
 		if (octeon3_usb1_clock_start_cnt == 0)
-			octeon_error_tree_disable(CVMX_ERROR_GROUP_USB, -1);//to_do separate for both usb
+			octeon_error_tree_disable(CVMX_ERROR_GROUP_USB, index);
 		mutex_unlock(&octeon3_usb1_clocks_mutex);
 	} else {
 		mutex_lock(&octeon3_usb2_clocks_mutex);
 		octeon3_usb2_clock_start_cnt--;
 		if (octeon3_usb2_clock_start_cnt == 0 )
-			octeon_error_tree_disable(CVMX_ERROR_GROUP_USB, -1);//to_do separate for both usb
+			octeon_error_tree_disable(CVMX_ERROR_GROUP_USB, index);
 		mutex_unlock(&octeon3_usb1_clocks_mutex);
 	}
 }
@@ -279,7 +279,7 @@ int xhci_octeon_start(struct platform_device *pdev)
 	}
 	octeon3_usb_clocks_start(pr_pdev, host_ctrl);
 	octeon3_usb_set_endian_mode(host_ctrl);
-	dev_info(&pr_pdev->dev, "clocks initialized!!!!!!\n");
+	dev_info(&pr_pdev->dev, "clocks initialized.\n");
 	return 0;
 }
 
-- 
2.6.2

