From 8e2a975968905272f49191e51b0681430e372c91 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Sun, 6 Jul 2014 18:05:50 -0700
Subject: [PATCH 887/974] MIPS:OCTEON: Fix compilation issues with NAND flash

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/cavium-octeon/executive/cvmx-bch.c | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/arch/mips/cavium-octeon/executive/cvmx-bch.c b/arch/mips/cavium-octeon/executive/cvmx-bch.c
index 5a79843..7d7fe64 100644
--- a/arch/mips/cavium-octeon/executive/cvmx-bch.c
+++ b/arch/mips/cavium-octeon/executive/cvmx-bch.c
@@ -116,7 +116,11 @@ int cvmx_bch_initialize(void)
 	debug("pool: %d, pool size: %llu, bufcount %d\n",
 		bch_pool, bch_pool_size, buf_cnt);
 	/* Setup the FPA */
-	cvmx_fpa_enable();
+	if (octeon_has_feature(OCTEON_FEATURE_FPA3))
+		/* FIXME */
+		return -ENOMEM;
+	else
+		cvmx_fpa1_enable();
 
 	bch_pool = cvm_oct_alloc_fpa_pool(bch_pool, bch_pool_size);
 	if (bch_pool < 0) {
-- 
2.6.2

