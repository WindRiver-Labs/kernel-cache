From b49c92ab22af53e8dac484ab7896bc520c21d5d8 Mon Sep 17 00:00:00 2001
From: Vinita Gupta <vgupta@caviumnetworks.com>
Date: Thu, 30 Oct 2014 10:20:42 -0700
Subject: [PATCH 003/184] netdev: Octeon3-ethernet: Don't swap packet linked
 pointers in LE mode. Signed-off-by: Vinita Gupta <vgupta@caviumnetworks.com>

Source: Cavium Networks, Inc.
MR: 00000
Type: Integration
Disposition: Merged from Octeon Tree
ChangeID: cb6959fe918456dff8f71511aba981c72d22ae55
Description:

Signed-off-by: Corey Minyard <cminyard@mvista.com>
[Original patch taken from octeon-linux-kernel-patches-SDK-3.1.2-release]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/net/ethernet/octeon/octeon3-ethernet.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/octeon/octeon3-ethernet.c b/drivers/net/ethernet/octeon/octeon3-ethernet.c
index 240a50b..9053448 100644
--- a/drivers/net/ethernet/octeon/octeon3-ethernet.c
+++ b/drivers/net/ethernet/octeon/octeon3-ethernet.c
@@ -1033,8 +1033,10 @@ static int octeon3_eth_rx_one(struct octeon3_rx *rx, bool is_async,
 			if (segments <= 0)
 				break;
 			packet_ptr.u64 = *(u64 *)(data - 8);
+#ifndef __LITTLE_ENDIAN
 			/* PKI_BUFLINK_S's are endian-swapped */
 			packet_ptr.u64 = swab64(packet_ptr.u64);
+#endif
 			data = phys_to_virt(packet_ptr.addr);
 			skb = octeon3_eth_work_to_skb((void *)round_down((unsigned long)data, 128ul));
 		}
@@ -1068,9 +1070,10 @@ static int octeon3_eth_rx_one(struct octeon3_rx *rx, bool is_async,
 			if (segments == 0)
 				break;
 			packet_ptr.u64 = *(u64 *)(data - 8);
+#ifndef __LITTLE_ENDIAN
 			/* PKI_BUFLINK_S's are endian-swapped */
 			packet_ptr.u64 = swab64(packet_ptr.u64);
-
+#endif
 			data = phys_to_virt(packet_ptr.addr);
 			next_skb = octeon3_eth_work_to_skb((void *)round_down((unsigned long)data, 128ul));
 			if (first_frag) {
-- 
1.9.1

