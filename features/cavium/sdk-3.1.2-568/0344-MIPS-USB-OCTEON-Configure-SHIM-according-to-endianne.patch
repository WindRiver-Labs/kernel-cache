From 57074c17062795f715b599a95a9259de5cc7e7df Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Thu, 17 Oct 2013 18:21:07 -0700
Subject: [PATCH 344/974] MIPS:USB:OCTEON: Configure SHIM according to
 endianness

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/usb/host/xhci-octeon.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/drivers/usb/host/xhci-octeon.c b/drivers/usb/host/xhci-octeon.c
index e35e9fb..4b592eb 100644
--- a/drivers/usb/host/xhci-octeon.c
+++ b/drivers/usb/host/xhci-octeon.c
@@ -179,8 +179,13 @@ void octeon3_usb_set_endian_mode(int index)
 {
 	union cvmx_usbdrdx_uctl_shim_cfg shim_cfg;
 	shim_cfg.u64 = cvmx_read_csr(CVMX_USBDRDX_UCTL_SHIM_CFG(index));
+#ifdef __BIG_ENDIAN
 	shim_cfg.s.dma_endian_mode = 1;
-	shim_cfg.s.csr_endian_mode = 1; //to_do, check for little big endian
+	shim_cfg.s.csr_endian_mode = 1;
+#else
+	shim_cfg.s.dma_endian_mode = 0;
+	shim_cfg.s.csr_endian_mode = 0;
+#endif
 	cvmx_write_csr(CVMX_USBDRDX_UCTL_SHIM_CFG(index), shim_cfg.u64);
 }
 EXPORT_SYMBOL(octeon3_usb_set_endian_mode);
-- 
2.6.2

