From 0c950fcce766bd2dd7be413c5d9fed9662cf1647 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Sat, 28 Sep 2013 10:29:21 -0700
Subject: [PATCH 316/974] MIPS: OCTEON: Enable Micrel 9031 PHY for OCTEON.

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/net/phy/micrel.c | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/drivers/net/phy/micrel.c b/drivers/net/phy/micrel.c
index d8766ec..14d1853 100644
--- a/drivers/net/phy/micrel.c
+++ b/drivers/net/phy/micrel.c
@@ -174,6 +174,12 @@ static int ksz8873mll_config_aneg(struct phy_device *phydev)
 	return 0;
 }
 
+static struct of_device_id micrel9031_match[] = {
+	{
+		.compatible = "micrel,ksz9031",
+	}
+};
+
 static struct phy_driver ksphy_driver[] = {
 {
 	.phy_id		= PHY_ID_KS8737,
@@ -314,7 +320,10 @@ static struct phy_driver ksphy_driver[] = {
 	.read_status	= genphy_read_status,
 	.ack_interrupt	= kszphy_ack_interrupt,
 	.config_intr	= ksz9021_config_intr,
-	.driver		= { .owner = THIS_MODULE, },
+	.driver		= {
+				.owner = THIS_MODULE,
+				.of_match_table = micrel9031_match,
+			  },
 }, {
 	.phy_id		= PHY_ID_KSZ8873MLL,
 	.phy_id_mask	= 0x00fffff0,
-- 
2.6.2

