From a1d87873b3a0bd7941abb47dc23bb43094eb33a3 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Sun, 6 Jul 2014 18:05:50 -0700
Subject: [PATCH 814/974] watchdog: octeon-wdt: Fix timer rate for all OCTEON
 III parts.

All CIU3 based parts have a count specified in multiples of 1024.

Signed-off-by: David Daney <david.daney@cavium.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/watchdog/octeon-wdt-main.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/watchdog/octeon-wdt-main.c b/drivers/watchdog/octeon-wdt-main.c
index ac40604..2a442a3 100644
--- a/drivers/watchdog/octeon-wdt-main.c
+++ b/drivers/watchdog/octeon-wdt-main.c
@@ -644,7 +644,7 @@ static int __init octeon_wdt_init(void)
 
 	if (OCTEON_IS_MODEL(OCTEON_CN68XX))
 		counter_shift = 9;
-	else if (OCTEON_IS_MODEL(OCTEON_CN78XX))
+	else if (octeon_has_feature(OCTEON_FEATURE_CIU3))
 		counter_shift = 10;
 	else
 		counter_shift = 8;
-- 
2.6.2

