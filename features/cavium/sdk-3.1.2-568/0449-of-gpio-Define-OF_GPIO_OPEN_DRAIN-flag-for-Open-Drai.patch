From acb70b35e2e1d15b29e62e790b1197ac381fccde Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Mon, 10 Feb 2014 13:46:59 -0800
Subject: [PATCH 449/974] of/gpio: Define OF_GPIO_OPEN_DRAIN flag for Open
 Drain outputs.

When we have a GPIO pin connected to an open-drain network, we want a
standard way of specifying this in the device tree.  So we choose bit
1 of the flag field to indicate open drain.

A typical use case would be something like:

	enum of_gpio_flags f;
	.
	.
	.
	reset_gpio = of_get_named_gpio_flags(node, "reset", 0, &f);
	.
	.
	.
	ret = gpio_request_one(reset_gpio,
		(f & OF_GPIO_OPEN_DRAIN) ? GPIOF_OPEN_DRAIN : 0,
		 "reset");
	.
	.
	.
	gpio_direction_output(reset_gpio, 1);
	gpio_set_value(reset_gpio, 0);
	msleep(20);
	gpio_set_value(reset_gpio, 1);
	.
	.
	.

Signed-off-by: David Daney <david.daney@cavium.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 include/linux/of_gpio.h | 1 +
 1 file changed, 1 insertion(+)

diff --git a/include/linux/of_gpio.h b/include/linux/of_gpio.h
index a83dc6f..20924a8 100644
--- a/include/linux/of_gpio.h
+++ b/include/linux/of_gpio.h
@@ -29,6 +29,7 @@ struct device_node;
  */
 enum of_gpio_flags {
 	OF_GPIO_ACTIVE_LOW = 0x1,
+	OF_GPIO_OPEN_DRAIN = 0x2,
 };
 
 #ifdef CONFIG_OF_GPIO
-- 
2.6.2

