From 626193a012207e7365ce0dfb919829d6670c39ba Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Mon, 21 Jul 2014 18:05:50 -0700
Subject: [PATCH 824/974] netdev: octeon_mgmt: Use __BITFIELD_FIELD in
 structure declarations.

Signed-off-by: David Daney <david.daney@cavium.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/net/ethernet/octeon/octeon_mgmt.c | 21 ++++++++-------------
 1 file changed, 8 insertions(+), 13 deletions(-)

diff --git a/drivers/net/ethernet/octeon/octeon_mgmt.c b/drivers/net/ethernet/octeon/octeon_mgmt.c
index b682136..665683a 100644
--- a/drivers/net/ethernet/octeon/octeon_mgmt.c
+++ b/drivers/net/ethernet/octeon/octeon_mgmt.c
@@ -21,6 +21,8 @@
 #include <linux/phy.h>
 #include <linux/io.h>
 
+#include <asm/bitfield.h>
+
 #include <asm/octeon/octeon.h>
 #include <asm/octeon/cvmx-mixx-defs.h>
 #include <asm/octeon/cvmx-agl-defs.h>
@@ -44,23 +46,16 @@ union mgmt_port_ring_entry {
 	struct {
 #define RING_ENTRY_CODE_DONE 0xf
 #define RING_ENTRY_CODE_MORE 0x10
-#ifdef __BIG_ENDIAN_BITFIELD
-		u64 reserved_62_63:2;
+		__BITFIELD_FIELD(u64 reserved_62_63:2,
 		/* Length of the buffer/packet in bytes */
-		u64 len:14;
+		__BITFIELD_FIELD(u64 len:14,
 		/* For TX, signals that the packet should be timestamped */
-		u64 tstamp:1;
+		 __BITFIELD_FIELD(u64 tstamp:1,
 		/* The RX error code */
-		u64 code:7;
+		__BITFIELD_FIELD(u64 code:7,
 		/* Physical address of the buffer */
-		u64 addr:40;
-#else
-		u64 addr:40;
-		u64 code:7;
-		u64 tstamp:1;
-		u64 len:14;
-		u64 reserved_62_63:2;
-#endif
+		__BITFIELD_FIELD(u64 addr:40,
+		;)))))
 	} s;
 };
 
-- 
2.6.2

