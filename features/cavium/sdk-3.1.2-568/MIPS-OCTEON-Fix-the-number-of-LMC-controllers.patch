From c4980ea001f77a2bb8e658825878542a89e894e4 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Thu, 7 Jan 2016 15:20:41 -0800
Subject: [PATCH 09/13] MIPS:OCTEON: Fix the number of LMC controllers

Configure the EDAC driver for all the available LMC controllers
on a given processor.

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
[Original patch taken from patch set for OCTEON SDK 3.1.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/cavium-octeon/setup.c |    7 +++++--
 1 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/arch/mips/cavium-octeon/setup.c b/arch/mips/cavium-octeon/setup.c
index 117d659..c95f074 100644
--- a/arch/mips/cavium-octeon/setup.c
+++ b/arch/mips/cavium-octeon/setup.c
@@ -1337,8 +1337,11 @@ static int __init edac_devinit(void)
 		}
 	}
 
-	num_lmc = OCTEON_IS_MODEL(OCTEON_CN68XX) ? 4 :
-		(OCTEON_IS_MODEL(OCTEON_CN56XX) ? 2 : 1);
+	num_lmc = (OCTEON_IS_MODEL(OCTEON_CN68XX)
+		   || OCTEON_IS_MODEL(OCTEON_CN78XX)) ? 4 :
+		((OCTEON_IS_MODEL(OCTEON_CN56XX)
+		  || OCTEON_IS_MODEL(OCTEON_CN73XX)
+		  || OCTEON_IS_MODEL(OCTEON_CNF75XX)) ? 2 : 1);
 	for (i = 0; i < num_lmc; i++) {
 		dev = platform_device_register_simple("octeon_lmc_edac",
 						      i, NULL, 0);
-- 
1.7.5.4

