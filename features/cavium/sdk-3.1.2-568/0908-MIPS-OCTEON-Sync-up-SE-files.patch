From 8582c6d28143b985aa662df626d185f5829b3ab3 Mon Sep 17 00:00:00 2001
From: Chandrakala Chavva <cchavva@caviumnetworks.com>
Date: Thu, 17 Jul 2014 18:05:50 -0700
Subject: [PATCH 908/974] MIPS: OCTEON: Sync-up SE files.

Signed-off-by: Chandrakala Chavva <cchavva@caviumnetworks.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/cavium-octeon/executive/cvmx-pcie.c | 17 +++--------------
 1 file changed, 3 insertions(+), 14 deletions(-)

diff --git a/arch/mips/cavium-octeon/executive/cvmx-pcie.c b/arch/mips/cavium-octeon/executive/cvmx-pcie.c
index 81ff5e0..f35e689 100644
--- a/arch/mips/cavium-octeon/executive/cvmx-pcie.c
+++ b/arch/mips/cavium-octeon/executive/cvmx-pcie.c
@@ -42,7 +42,7 @@
  *
  * Interface to PCIe as a host(RC) or target(EP)
  *
- * <hr>$Revision: 121858 $<hr>
+ * <hr>$Revision: 121873 $<hr>
  */
 #ifdef CVMX_BUILD_FOR_LINUX_KERNEL
 #include <asm/octeon/cvmx.h>
@@ -1462,17 +1462,6 @@ static int __cvmx_pcie_rc_initialize_gen2(int pcie_port)
 		return -1;
 	}
 
-	/* No need to re-initialize if PCIe is already initialized */
-	if (OCTEON_IS_OCTEON3()) {
-		pciercx_cfg032.u32 = CVMX_PCIE_CFGX_READ(pcie_port,
-						CVMX_PCIERCX_CFG032(pcie_port));
-		if (pciercx_cfg032.s.dlla == 1 && pciercx_cfg032.s.lt == 0) {
-			cvmx_printf("%d:PCIe: Port %d link active, %d lanes, speed gen%d\n",
-				node, pcie_port, pciercx_cfg032.s.nlw, pciercx_cfg032.s.ls);
-			return 0;
-		}
-	}
-	
 #if 0
 	/* Enable this code to force PCIe link for x1 lane card. */
 	__cvmx_qlm_pcie_cfg_rxd_set_tweak(qlm, 0);
@@ -1789,8 +1778,8 @@ static int __cvmx_pcie_rc_initialize_gen2(int pcie_port)
 	/* Display the link status */
 	pciercx_cfg032.u32 = CVMX_PCIE_CFGX_READ(pcie_port,
 						 CVMX_PCIERCX_CFG032(pcie_port));
-	cvmx_printf("%d:PCIe: Port %d link active, %d lanes, speed gen%d\n",
-		    node, pcie_port, pciercx_cfg032.s.nlw, pciercx_cfg032.s.ls);
+	cvmx_printf("%d:PCIe: Port %d link active, %d lanes\n",
+		    node, pcie_port, pciercx_cfg032.s.nlw);
 
 	return 0;
 }
-- 
2.6.2

