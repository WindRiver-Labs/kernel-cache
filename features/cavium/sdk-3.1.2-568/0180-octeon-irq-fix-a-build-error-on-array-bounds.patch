From 5570f5ae2caea03ad2c1ec5c8107885e907c2fac Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Fri, 4 Aug 2017 12:44:52 +0800
Subject: [PATCH 180/184] octeon-irq: fix a build error on array bounds

This is to fix the below error:

arch/mips/cavium-octeon/octeon-irq.c: In function 'octeon_irq_init_ciu3':
arch/mips/cavium-octeon/octeon-irq.c:2941:27: error: array subscript is
 below array bounds [-Werror=array-bounds]
  octeon_ciu3_info_per_node[node] = ciu3_info;
                           ^

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/mips/cavium-octeon/octeon-irq.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/arch/mips/cavium-octeon/octeon-irq.c b/arch/mips/cavium-octeon/octeon-irq.c
index 1fa41b4..73a503b 100644
--- a/arch/mips/cavium-octeon/octeon-irq.c
+++ b/arch/mips/cavium-octeon/octeon-irq.c
@@ -2893,6 +2893,8 @@ static int __init octeon_irq_init_ciu3(struct device_node *ciu_node,
 	union cvmx_ciu3_const consts;
 
 	node = of_node_to_nid(ciu_node);
+	if (node < 0)
+		node = 0;
 	ciu3_info = kzalloc_node(sizeof(*ciu3_info), GFP_KERNEL, node);
 
 	if (!ciu3_info)
-- 
1.9.1

