From d376dee21c515186469eebd8466092d0c9c52517 Mon Sep 17 00:00:00 2001
From: Quanyang Wang <quanyang.wang@windriver.com>
Date: Tue, 2 Feb 2016 10:05:34 +0800
Subject: [PATCH 1/7] cav-octeon3: fix compile warning for macro COP0_STATUS
 redefinition

The macro COP0_STATUS in asm-offsets.c is only used for KVM, it
will conflict with the macro COP0_STATUS defined in cvmx-asm.h.
So disable it by adding CONFIG_KVM limitions, or it will occurr
warning as below:

In file included from arch/mips/include/asm/mach-cavium-octeon/kernel-entry-init.h:11:0,
                 from arch/mips/kernel/head.S:28:
arch/mips/include/asm/octeon/cvmx-asm.h:82:0: warning: "COP0_STATUS" redefined [enabled by default]
 #define COP0_STATUS $12,0 /* Mips status register */
 ^
In file included from arch/mips/include/asm/asm-offsets.h:1:0,
                 from arch/mips/include/asm/asmmacro-64.h:11,
                 from arch/mips/include/asm/asmmacro.h:17,
                 from arch/mips/kernel/head.S:21:
include/generated/asm-offsets.h:277:0: note: this is the location of the previous definition
 #define COP0_STATUS 768 /* offsetof(struct mips_coproc, reg[12][0])  # */

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/kernel/asm-offsets.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/mips/kernel/asm-offsets.c b/arch/mips/kernel/asm-offsets.c
index 02cf19c..90c4462 100644
--- a/arch/mips/kernel/asm-offsets.c
+++ b/arch/mips/kernel/asm-offsets.c
@@ -332,6 +332,7 @@ void output_pbe_defines(void)
 }
 #endif
 
+#if IS_ENABLED(CONFIG_KVM)
 void output_kvm_defines(void)
 {
 	COMMENT(" KVM/MIPS Specfic offsets. ");
@@ -395,3 +396,4 @@ void output_kvm_defines(void)
 	OFFSET(COP0_STATUS, mips_coproc, reg[MIPS_CP0_STATUS][0]);
 	BLANK();
 }
+#endif
-- 
1.7.5.4

