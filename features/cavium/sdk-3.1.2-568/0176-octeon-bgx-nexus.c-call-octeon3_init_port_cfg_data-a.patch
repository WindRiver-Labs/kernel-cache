From acaef7641c5c33908e3766e9f05af4ed1bab4c20 Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Mon, 7 Aug 2017 14:42:12 +0800
Subject: [PATCH 176/184] octeon-bgx-nexus.c: call octeon3_init_port_cfg_data()
 after numa_node is initialized

Same as SDK's final image(OCTEON-SDK-3.1.2-568 .i386.rpm + sdk_3.1.2_update_p10 .tgz),
we can't use uninitialized variable numa_node.

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/net/ethernet/octeon/octeon-bgx-nexus.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/drivers/net/ethernet/octeon/octeon-bgx-nexus.c b/drivers/net/ethernet/octeon/octeon-bgx-nexus.c
index 9dd378d..e84329e 100644
--- a/drivers/net/ethernet/octeon/octeon-bgx-nexus.c
+++ b/drivers/net/ethernet/octeon/octeon-bgx-nexus.c
@@ -140,14 +140,14 @@ static int bgx_probe(struct platform_device *pdev)
 	int r = 0;
 	char id[64];
 
-	/* Initialize the node's ports' configuration data */
-	octeon3_init_port_cfg_data(numa_node);
-
 	reg = of_get_property(pdev->dev.of_node, "reg", NULL);
 	addr = of_translate_address(pdev->dev.of_node, reg);
 	interface = (addr >> 24) & 0xf;
 	numa_node = (addr >> 36) & 0x7;
 
+	/* Initialize the node's ports' configuration data */
+	octeon3_init_port_cfg_data(numa_node);
+
 	__cvmx_helper_bgx_probe(cvmx_helper_node_interface_to_xiface(numa_node, interface));
 
 	/* Assign 8 CAM entries per LMAC */
-- 
1.9.1

