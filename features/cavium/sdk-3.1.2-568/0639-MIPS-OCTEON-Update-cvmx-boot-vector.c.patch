From 74ca34c718074e53e619698e1c8e87ddfe673774 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Tue, 15 Jul 2014 18:05:50 -0700
Subject: [PATCH 639/974] MIPS: OCTEON: Update cvmx-boot-vector.c

Signed-off-by: David Daney <david.daney@cavium.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/cavium-octeon/executive/cvmx-boot-vector.c | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/arch/mips/cavium-octeon/executive/cvmx-boot-vector.c b/arch/mips/cavium-octeon/executive/cvmx-boot-vector.c
index 903b959..1f2b1f6 100644
--- a/arch/mips/cavium-octeon/executive/cvmx-boot-vector.c
+++ b/arch/mips/cavium-octeon/executive/cvmx-boot-vector.c
@@ -56,7 +56,7 @@ reset_vector:
 	cache	17, 0($0)	# Core-14345, clear L1 Dcache virtual tags if the core hit an NMI
 
 	ld	$k0, 0x78($k0)	# k0 <- (bfc00078) pointer to the reset vector
-	nop
+	synci	0($0)		# Invalidate ICache to get coherent view of target code.
 
 	daddu	$k0, $k0, $k1
 	nop
@@ -101,7 +101,7 @@ wait_loop:
   24:	bc110000	cache	0x11,0(zero)
 
   28:	df5a0078	ld	k0,120(k0)
-  2c:	00000000	nop
+  2c:	041f0000 	synci	0(zero)
 
   30:	035bd02d	daddu	k0,k0,k1
   34:	00000000	nop
@@ -143,7 +143,7 @@ static CVMX_SHARED unsigned long long _cvmx_bootvector_data[16] = {
 	0x375a0084337b03ffull,
 	0x409a6000001bd8c0ull,
 	0x3c1abfc0bc110000ull,
-	0xdf5a007800000000ull,
+	0xdf5a0078041f0000ull,
 	0x035bd02d00000000ull,
 	0xdf5a0000403bf803ull,  /* patch low order 8-bits if no KScratch*/
 	0x1340000500000000ull,
-- 
2.6.2

