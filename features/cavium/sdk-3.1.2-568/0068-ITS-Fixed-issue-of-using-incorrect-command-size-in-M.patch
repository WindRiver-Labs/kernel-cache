From 7a6918af806270232d37736f35a1a50d27c332a2 Mon Sep 17 00:00:00 2001
From: Sunil Goutham <sgoutham@cavium.com>
Date: Fri, 6 Jun 2014 16:06:37 +0530
Subject: [PATCH 068/184] ITS: Fixed issue of using incorrect 'command size' in
 MAPD command

Source: Cavium Networks, Inc.
MR: 13384
Type: Integration
Disposition: Merged from THUNDERX Tree
ChangeID: eba2c041ada435b4c8f78efe42ae9ec9c461be0a
Description:

Signed-off-by: Sunil Goutham <sgoutham@cavium.com>
Signed-off-by: Robert Richter <rrichter@cavium.com>
(cherry picked from commit b81d43b96fdd9c496cff01936ac462ba8628a97f)

Signed-off-by: Corey Minyard <cminyard@mvista.com>
[Original patch taken from octeon-linux-kernel-patches-SDK-3.1.2-release]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/irqchip/irq-gic-v3-its.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/irqchip/irq-gic-v3-its.c b/drivers/irqchip/irq-gic-v3-its.c
index 003ef93..4b922e6 100644
--- a/drivers/irqchip/irq-gic-v3-its.c
+++ b/drivers/irqchip/irq-gic-v3-its.c
@@ -199,8 +199,8 @@ static void its_encode_phys_id(struct its_cmd_block *cmd, u32 phys_id)
 
 static void its_encode_size(struct its_cmd_block *cmd, u8 size)
 {
-	cmd->raw_cmd[1] &= ~0x1fUL;
-	cmd->raw_cmd[1] |= size & 0x1f;
+	cmd->raw_cmd[1] &= ~0xffUL;
+	cmd->raw_cmd[1] |= size & 0xff;
 }
 
 static void its_encode_itt(struct its_cmd_block *cmd, u64 itt_addr)
-- 
1.9.1

