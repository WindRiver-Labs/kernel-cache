From 7c5bbc40040966454d9b5b73ff7ab9c649561ebe Mon Sep 17 00:00:00 2001
From: Carlos Munoz <cmunoz@caviumnetworks.com>
Date: Sat, 5 Jul 2014 18:05:50 -0700
Subject: [PATCH 922/974] MIPS: OCTEON: Don't fall through error handling code
 after successfully initializing pool.

Signed-off-by: Carlos Munoz <cmunoz@caviumnetworks.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/cavium-octeon/octeon-fpa3.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/arch/mips/cavium-octeon/octeon-fpa3.c b/arch/mips/cavium-octeon/octeon-fpa3.c
index 8c6c4a5..5e347fe 100644
--- a/arch/mips/cavium-octeon/octeon-fpa3.c
+++ b/arch/mips/cavium-octeon/octeon-fpa3.c
@@ -121,6 +121,9 @@ int octeon_fpa3_pool_init(int			node,
 	cfg.s.ena = 1;
 	cvmx_write_csr_node(node, CVMX_FPA_POOLX_CFG(pool->lpool), cfg.u64);
 
+	mutex_unlock(&octeon_fpa3_lock);
+	return 0;
+
  error_stack:
 	cvmx_fpa3_release_pool(*pool);
  error:
-- 
2.6.2

