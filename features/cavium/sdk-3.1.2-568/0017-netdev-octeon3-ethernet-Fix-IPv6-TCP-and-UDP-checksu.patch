From bfabc9dbcc9d390eeeb7c6824871a5d3c20b3491 Mon Sep 17 00:00:00 2001
From: David Daney <david.daney@cavium.com>
Date: Fri, 7 Nov 2014 11:13:02 -0800
Subject: [PATCH 017/184] netdev: octeon3-ethernet: Fix IPv6 TCP and UDP
 checksum generation.

Source: Cavium Networks, Inc.
MR: 00000
Type: Integration
Disposition: Merged from Octeon Tree
ChangeID: 09d05989fc63a6a57b9c80f310ab669746abba45
Description:

Need to supply valid L3PTR.

Signed-off-by: David Daney <david.daney@cavium.com>
Signed-off-by: Corey Minyard <cminyard@mvista.com>
[Original patch taken from octeon-linux-kernel-patches-SDK-3.1.2-release]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/net/ethernet/octeon/octeon3-ethernet.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/net/ethernet/octeon/octeon3-ethernet.c b/drivers/net/ethernet/octeon/octeon3-ethernet.c
index 8fcf8c4..5f0981b 100644
--- a/drivers/net/ethernet/octeon/octeon3-ethernet.c
+++ b/drivers/net/ethernet/octeon/octeon3-ethernet.c
@@ -1760,6 +1760,7 @@ static int octeon3_eth_ndo_start_xmit(struct sk_buff *skb, struct net_device *ne
 			break;
 		case __constant_htons(ETH_P_IPV6):
 			l4_hdr = ipv6_hdr(skb)->nexthdr;
+			send_hdr.s.l3ptr = ETH_HLEN;
 			break;
 		default:
 			break;
-- 
1.9.1

