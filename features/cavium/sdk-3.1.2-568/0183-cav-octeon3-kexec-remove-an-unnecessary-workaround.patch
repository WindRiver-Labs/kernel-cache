From b6c378e88493fcf68959ae487b3d63d888f42cdc Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Wed, 9 Aug 2017 12:51:15 +0800
Subject: [PATCH 183/184] cav-octeon3: kexec: remove an unnecessary workaround

A previous commit

"mips: OCTEON: Workround for kexec/kdump networking in cn78xx"

added some workarounds for kexec, we don't need to free named_block now
due to SDK3.1.2-568 uses a new file resource-mgr.c to manage resoure.
Remove the relative workaround but keep the others.

Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/net/ethernet/octeon/octeon3-ethernet.c | 10 ----------
 1 file changed, 10 deletions(-)

diff --git a/drivers/net/ethernet/octeon/octeon3-ethernet.c b/drivers/net/ethernet/octeon/octeon3-ethernet.c
index 9b7d377..ebc93ba 100644
--- a/drivers/net/ethernet/octeon/octeon3-ethernet.c
+++ b/drivers/net/ethernet/octeon/octeon3-ethernet.c
@@ -2803,16 +2803,6 @@ static int octeon3_eth_probe(struct platform_device *pdev)
 	int r;
 
 	struct mac_platform_data *pd = dev_get_platdata(&pdev->dev);
-#if defined(CONFIG_KEXEC) || defined(CONFIG_CRASH_DUMP)
-	static bool cvmx_res_clear = false;
-	if (cvmx_res_clear == false) {
-		cvmx_bootmem_phy_named_block_free("cvmx-global-resources",CVMX_BOOTMEM_FLAG_NO_LOCKING);
-		cvmx_bootmem_phy_named_block_free("cvmx_pko3_global_dq_table",CVMX_BOOTMEM_FLAG_NO_LOCKING);
-		cvmx_bootmem_phy_named_block_free("cvmx-app-config",CVMX_BOOTMEM_FLAG_NO_LOCKING);
-		cvmx_bootmem_phy_named_block_free("cvmx-app-id",CVMX_BOOTMEM_FLAG_NO_LOCKING);
-		cvmx_res_clear = true;
-	}
-#endif
 	r = octeon3_eth_global_init(pd->numa_node);
 	if (r)
 		return r;
-- 
1.9.1

