From 79f06dfb58291be1ffdb1878654750cb391430d6 Mon Sep 17 00:00:00 2001
From: Peter Swain <pswain@cavium.com>
Date: Wed, 11 Nov 2015 17:25:24 -0800
Subject: [PATCH 967/974] mips: octeon: adjust 32bit memory reservation when
 mem >= 16GB

Increase the low-address-space reservation for systems
with 16..32GB main memory.
Now they reserve 512MB.

Signed-off-by: Peter Swain <pswain@cavium.com>
[Original patch taken from Cavium SDK 3.1.2-568]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/cavium-octeon/setup.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/mips/cavium-octeon/setup.c b/arch/mips/cavium-octeon/setup.c
index e519a93..eaf2003 100644
--- a/arch/mips/cavium-octeon/setup.c
+++ b/arch/mips/cavium-octeon/setup.c
@@ -1049,7 +1049,7 @@ void __init plat_mem_setup(void)
 	if (system_limit > max_memory)
 		system_limit = max_memory;
 	/* Try to get 256MB (or more) of 32-bit memory */
-	mem_32_size = system_limit <= (16ull * (2 << 30)) ? 256 * (1 << 20) : 512 * (1 << 20);
+	mem_32_size = system_limit <= (16ull * (1ull << 30)) ? 256 * (1 << 20) : 512 * (1 << 20);
 
 	cvmx_bootmem_lock();
 	limit_max = 0xffffffffull;
-- 
2.6.2

