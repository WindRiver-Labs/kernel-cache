From 0f001dd86a9e61db50c4a7447764ef104884f5a9 Mon Sep 17 00:00:00 2001
From: Alexander Graf <agraf@suse.de>
Date: Wed, 25 Apr 2012 13:48:54 +0200
Subject: [PATCH 52/63] KVM: PPC: Restrict PPC_[L|ST]D macro to asm code

commit 3d4c6826ed2a28e69e8ee14f1d58c4c8622f04b3 upstream.

We only want asm code macros to be accessible from asm code, so #ifdef it
depending on it.

Signed-off-by: Alexander Graf <agraf@suse.de>
Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 arch/powerpc/include/asm/kvm_asm.h |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/arch/powerpc/include/asm/kvm_asm.h b/arch/powerpc/include/asm/kvm_asm.h
index 7d4018d..76fdcfe 100644
--- a/arch/powerpc/include/asm/kvm_asm.h
+++ b/arch/powerpc/include/asm/kvm_asm.h
@@ -20,6 +20,7 @@
 #ifndef __POWERPC_KVM_ASM_H__
 #define __POWERPC_KVM_ASM_H__
 
+#ifdef __ASSEMBLY__
 #ifdef CONFIG_64BIT
 #define PPC_STD(sreg, offset, areg)  std sreg, (offset)(areg)
 #define PPC_LD(treg, offset, areg)   ld treg, (offset)(areg)
@@ -27,6 +28,7 @@
 #define PPC_STD(sreg, offset, areg)  stw sreg, (offset+4)(areg)
 #define PPC_LD(treg, offset, areg)   lwz treg, (offset+4)(areg)
 #endif
+#endif
 
 /* IVPR must be 64KiB-aligned. */
 #define VCPU_SIZE_ORDER 4
-- 
1.7.9.7

