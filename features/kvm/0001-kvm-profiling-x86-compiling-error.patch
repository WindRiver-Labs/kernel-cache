From 8a57201f0f38579b911d8e0510ae214e9bb98113 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Wed, 10 Sep 2008 11:35:53 +0800
Subject: [PATCH] kvm profiling x86 compiling error

Add CONFIG_PROFILING definition to avoid compiling error.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/x86/kvm/x86.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.c
index e5c7bb3..5f6d7f1 100644
--- a/arch/x86/kvm/x86.c
+++ b/arch/x86/kvm/x86.c
@@ -2916,7 +2916,11 @@ again:
 	/*
 	 * Profile KVM exit RIPs:
 	 */
+#ifdef CONFIG_PROFILING
 	if (unlikely(imv_read(prof_on) == KVM_PROFILING)) {
+#else
+	if (unlikely(prof_on == KVM_PROFILING)) {
+#endif
 		kvm_x86_ops->cache_regs(vcpu);
 		profile_hit(KVM_PROFILING, (void *)vcpu->arch.rip);
 	}
-- 
1.5.5.1.67.gbdb8

