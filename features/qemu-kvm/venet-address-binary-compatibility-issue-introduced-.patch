From 94a121b65fbf78921e443e7266d79898d07aa558 Mon Sep 17 00:00:00 2001
From: Patrick Mullaney <pmullaney@novell.com>
Date: Wed, 9 Dec 2009 12:59:45 -0500
Subject: [PATCH 106/119] venet: address binary compatibility issue introduced with venet macvlan

Scatter gather support for older clients was broken with the venet
macvlan driver check-in. This patch allows older clients to continue
working but they will fall back to non-SG operation.

Signed-off-by: Patrick Mullaney <pmullaney@novell.com>
Signed-off-by: Gregory Haskins <ghaskins@novell.com>
---
 include/linux/venet.h |    6 ++++--
 1 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/include/linux/venet.h b/include/linux/venet.h
index 4e5fdf4..b571280 100644
--- a/include/linux/venet.h
+++ b/include/linux/venet.h
@@ -37,9 +37,10 @@ struct venet_capabilities {
 	__u32 bits;
 };
 
-#define VENET_CAP_GROUP_SG     0
+/* DEPRECATED: 0, 2 */
 #define VENET_CAP_GROUP_EVENTQ 1
-#define VENET_CAP_GROUP_L4RO    2 /* layer-4 reassem offloading */
+#define VENET_CAP_GROUP_SG     3
+#define VENET_CAP_GROUP_L4RO   4 /* layer-4 reassem offloading */
 
 /* CAPABILITIES-GROUP SG */
 #define VENET_CAP_SG     (1 << 0)
@@ -83,6 +84,7 @@ struct venet_sg {
 		__u32    network;     /* network offset */
 		__u32    transport;   /* transport offset */
 	} phdr;
+	__u32            pad[32]; /* pad area for future use */
 	__u32            count;   /* nr of iovs */
 	struct venet_iov iov[1];
 };
-- 
1.6.5.2

