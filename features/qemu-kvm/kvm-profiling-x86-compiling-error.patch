From 978f7bedbf818ca8a3087e071a36133fbc1ab5c3 Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Tue, 1 Jun 2010 19:21:39 +0800
Subject: [PATCH] kvm profiling x86 compiling error

Add CONFIG_PROFILING definition to avoid compiling error.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>
---
 arch/x86/kvm/x86.c |    4 ++++
 1 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/arch/x86/kvm/x86.c b/arch/x86/kvm/x86.c
index 0972edb..aad6a95 100644
--- a/arch/x86/kvm/x86.c
+++ b/arch/x86/kvm/x86.c
@@ -4355,7 +4355,11 @@ static int vcpu_enter_guest(struct kvm_vcpu *vcpu)
 	/*
 	 * Profile KVM exit RIPs:
 	 */
+#ifdef CONFIG_PROFILING
 	if (unlikely(imv_read(prof_on) == KVM_PROFILING)) {
+#else
+ 	if (unlikely(prof_on == KVM_PROFILING)) {
+#endif
 		unsigned long rip = kvm_rip_read(vcpu);
 		profile_hit(KVM_PROFILING, (void *)rip);
 	}
-- 
1.6.5.2

