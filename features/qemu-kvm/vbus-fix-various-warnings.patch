From 448d7da11711a558cceeaabc6efd33407821d53a Mon Sep 17 00:00:00 2001
From: Ira W. Snyder <iws@ovro.caltech.edu>
Date: Tue, 1 Dec 2009 09:00:40 -0500
Subject: [PATCH 091/119] vbus: fix various warnings

There are various warnings compiling the vbus code on x86. Fix the easiest
of them.

Signed-off-by: Ira W. Snyder <iws@ovro.caltech.edu>
Signed-off-by: Gregory Haskins <ghaskins@novell.com>
---
 kernel/vbus/config-ioctl.c         |    2 +-
 kernel/vbus/connectors/null.c      |    8 ++++----
 kernel/vbus/devices/venet/device.c |    2 +-
 3 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/kernel/vbus/config-ioctl.c b/kernel/vbus/config-ioctl.c
index 307fec9..44e823b 100644
--- a/kernel/vbus/config-ioctl.c
+++ b/kernel/vbus/config-ioctl.c
@@ -206,7 +206,7 @@ out:
 	return ret;
 }
 
-static ssize_t
+static long
 vbus_admin_chardev_ioctl(struct file *filp, unsigned int ioctl,
 			 unsigned long arg)
 {
diff --git a/kernel/vbus/connectors/null.c b/kernel/vbus/connectors/null.c
index 7142de7..b6d16cb 100644
--- a/kernel/vbus/connectors/null.c
+++ b/kernel/vbus/connectors/null.c
@@ -121,10 +121,10 @@ guest_device_close(struct vbus_device_proxy *dev, int flags)
 }
 
 static int
-guest_device_shm(struct vbus_device_proxy *dev, int id, int prio,
-	       void *ptr, size_t len,
-	       struct shm_signal_desc *sdesc, struct shm_signal **signal,
-	       int flags)
+guest_device_shm(struct vbus_device_proxy *dev, const char *name, int id,
+		 int prio, void *ptr, size_t len,
+		 struct shm_signal_desc *sdesc, struct shm_signal **signal,
+		 int flags)
 {
 	struct guest_device *_dev = to_dev(dev);
 	struct guest_signal *_signal = NULL;
diff --git a/kernel/vbus/devices/venet/device.c b/kernel/vbus/devices/venet/device.c
index a30df94..01d6f1c 100644
--- a/kernel/vbus/devices/venet/device.c
+++ b/kernel/vbus/devices/venet/device.c
@@ -1234,7 +1234,7 @@ sg_txstream_write(struct venet_txstream *str, const void *src, unsigned long len
 
 	while (len) {
 		struct venet_iov *iov         = &vsg->iov[_str->index];
-		int               bytestocopy = min(len, _str->remain);
+		int               bytestocopy = min_t(size_t, len, _str->remain);
 
 		if (!bytestocopy) {
 			sg_txstream_replenish(_str);
-- 
1.6.5.2

