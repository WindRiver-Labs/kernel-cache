From a756e01c8b8769bb756275919cc06baf7d92edcc Mon Sep 17 00:00:00 2001
From: Liming Wang <liming.wang@windriver.com>
Date: Mon, 15 Mar 2010 10:12:15 +0800
Subject: [PATCH 22/22] kmemleak: remove kmemleak from vt

this patch revert the following commit from vt.c:

kmemleak: Remove some of the kmemleak false positives

Because this hasn't been applied to vt.c and has been remove from
mainline kernel.

Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 drivers/char/vt.c |    7 -------
 1 files changed, 0 insertions(+), 7 deletions(-)

diff --git a/drivers/char/vt.c b/drivers/char/vt.c
index 6045bae..372267d 100644
--- a/drivers/char/vt.c
+++ b/drivers/char/vt.c
@@ -100,7 +100,6 @@
 #include <linux/font.h>
 #include <linux/bitops.h>
 #include <linux/notifier.h>
-#include <linux/kmemleak.h>
 
 #include <asm/io.h>
 #include <asm/system.h>
@@ -2907,12 +2906,6 @@ static int __init con_init(void)
 	 */
 	for (currcons = 0; currcons < MIN_NR_CONSOLES; currcons++) {
 		vc_cons[currcons].d = vc = alloc_bootmem(sizeof(struct vc_data));
-		/*
-		 * Kmemleak does not track the memory allocated via
-		 * alloc_bootmem() but this block contains pointers to
-		 * other blocks allocated via kmalloc.
-		 */
-		kmemleak_alloc(vc, sizeof(struct vc_data), 1, GFP_ATOMIC);
 		INIT_WORK(&vc_cons[currcons].SAK_work, vc_SAK);
 		visual_init(vc, currcons, 1);
 		vc->vc_screenbuf = (unsigned short *)alloc_bootmem(vc->vc_screenbuf_size);
-- 
1.7.0

