From a7cf3ef4a25eb1d1870f320af5da2a0f02537e91 Mon Sep 17 00:00:00 2001
From: Yong Zhang <yong.zhang@windriver.com>
Date: Tue, 21 Feb 2012 09:49:31 +0800
Subject: [PATCH] kgdb: build fix

Move gdbstub_use_prev_in_buf/gdbstub_prev_in_buf_pos
out of CONFIG_KGDB_KDB to fix below build error:

build/linux/kernel/debug/gdbstub.c: In function 'gdbstub_state':
build/linux/kernel/debug/gdbstub.c:1169: error:
'gdbstub_use_prev_in_buf' undeclared (first use in this function)
build/linux/kernel/debug/gdbstub.c:1169: error: (Each undeclared
identifier is reported only once
build/linux/kernel/debug/gdbstub.c:1169: error: for each function it
appears in.)
build/linux/kernel/debug/gdbstub.c:1170: error:
'gdbstub_prev_in_buf_pos' undeclared (first use in this function)

Signed-off-by: Yong Zhang <yong.zhang@windriver.com>
---
 kernel/debug/gdbstub.c |    5 ++---
 1 files changed, 2 insertions(+), 3 deletions(-)

diff --git a/kernel/debug/gdbstub.c b/kernel/debug/gdbstub.c
index 0d64633..9e30492 100644
--- a/kernel/debug/gdbstub.c
+++ b/kernel/debug/gdbstub.c
@@ -43,6 +43,8 @@
 /* Our I/O buffers. */
 static char			remcom_in_buffer[BUFMAX];
 static char			remcom_out_buffer[BUFMAX];
+static int 			gdbstub_use_prev_in_buf;
+static int 			gdbstub_prev_in_buf_pos;
 
 /* Storage for the registers, in GDB format. */
 static unsigned long		gdb_regs[(NUMREGBYTES +
@@ -65,9 +67,6 @@ static int hex(char ch)
 }
 
 #ifdef CONFIG_KGDB_KDB
-static int gdbstub_use_prev_in_buf;
-static int gdbstub_prev_in_buf_pos;
-
 static int gdbstub_read_wait(void)
 {
 	int ret = -1;
-- 
1.7.0.4

