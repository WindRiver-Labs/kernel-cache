From 052ceb33c342b4c6cc0970fe52804f49db880b23 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Wed, 12 Mar 2014 08:07:50 -0700
Subject: [PATCH] kgdboc: usb-serial: Use atomic interface to manipulate
 atomic variable

tty_port.count is atomic variable, so use atomic interface to manipulate it to
avoid the below build error:

drivers/usb/serial/usb-serial.c:1292:6: error: wrong type argument to unary exclamation mark

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 drivers/usb/serial/usb-serial.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/usb/serial/usb-serial.c b/drivers/usb/serial/usb-serial.c
index 45a2df4..e0af85c 100644
--- a/drivers/usb/serial/usb-serial.c
+++ b/drivers/usb/serial/usb-serial.c
@@ -1289,7 +1289,7 @@ static void serial_poll_put_char(struct tty_driver *driver, int line, char ch)
 
 	port = serial->port[line - serial->minor];
 
-	if (!port->port.count)
+	if (!atomic_read(&port->port.count))
 		return;
 
 	buf[0] = ch;
-- 
1.7.9.5

