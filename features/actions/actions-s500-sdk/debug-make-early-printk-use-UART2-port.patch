From 3f99049854e6c6ad9e2a76245d2a1c067cc9bbff Mon Sep 17 00:00:00 2001
From: Yixun Lan <yixun.lan@gmail.com>
Date: Thu, 13 Aug 2015 15:59:49 +0000
Subject: [PATCH 29/62] debug: make early printk use UART2 port

commit 5be6de1b847ab1d931e534658a95aeb6439c8683 from
https://github.com/xapp-le/kernel.git

Signed-off-by: Yixun Lan <yixun.lan@gmail.com>
---
 arch/arm/mach-owl/include/mach/debug-macro.S |   12 ++++++------
 1 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/arch/arm/mach-owl/include/mach/debug-macro.S b/arch/arm/mach-owl/include/mach/debug-macro.S
index 04d9388..e7231f8 100755
--- a/arch/arm/mach-owl/include/mach/debug-macro.S
+++ b/arch/arm/mach-owl/include/mach/debug-macro.S
@@ -15,11 +15,11 @@
 #include <mach/hardware.h>
 
     .macro  addruart, rp, rv, tmp
-    ldr     \rp, =UART0_CTL                     @ physical base address
+    ldr     \rp, =UART2_CTL                     @ physical base address
     mrc     p15, 0, \rv, c1, c0
     tst     \rv, #1                             @ MMU enabled?
     beq     100f
-    ldr     \rp, =IO_ADDRESS(UART0_CTL)         @ virtual address
+    ldr     \rp, =IO_ADDRESS(UART2_CTL)         @ virtual address
 
 100:
     ldr     \rv, [\rp]
@@ -38,19 +38,19 @@
     .endm
 
     .macro  senduart,rd,rx
-    str     \rd, [\rx, #(UART0_TXDAT - UART0_BASE)] @ Write to Transmitter Holding Register
+    str     \rd, [\rx, #(UART2_TXDAT - UART2_BASE)] @ Write to Transmitter Holding Register
     .endm
 
     .macro  busyuart, rd, rx
 1001:   
-    ldr     \rd, [\rx, #(UART0_STAT - UART0_BASE)]  @ Read Status Register
+    ldr     \rd, [\rx, #(UART2_STAT - UART2_BASE)]  @ Read Status Register
     tst     \rd, #0x40                          @ TXFIFO Full?
     bne     1001b
     .endm
 
     .macro  waituart,rd,rx
 1001:   
-    ldr     \rd, [\rx, #(UART0_STAT - UART0_BASE)]  @ Read Status Register
+    ldr     \rd, [\rx, #(UART2_STAT - UART2_BASE)]  @ Read Status Register
     tst     \rd, #0x400                         @ TXFIFO Empty?
     beq     1001b
-    .endm
\ No newline at end of file
+    .endm
-- 
1.7.5.4

