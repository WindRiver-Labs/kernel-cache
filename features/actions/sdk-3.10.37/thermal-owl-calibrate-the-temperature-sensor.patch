From bae84b469ccbd437bbce25837673d18049ca9152 Mon Sep 17 00:00:00 2001
From: wurui <wurui@actions-semi.com>
Date: Tue, 22 Dec 2015 14:57:13 +0800
Subject: [PATCH 46/62] thermal: owl: calibrate the temperature sensor

commit d2d20bd0c1220763bf842468bb18d289c8439af6 from
https://github.com/xapp-le/kernel.git

Change-Id: I8d106ff30b8988b0886c89ed3accb2e33f870f18
---
 drivers/thermal/s500-thermal.c |   14 +++++++-------
 1 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/drivers/thermal/s500-thermal.c b/drivers/thermal/s500-thermal.c
index 400d6e9..1dfd082 100755
--- a/drivers/thermal/s500-thermal.c
+++ b/drivers/thermal/s500-thermal.c
@@ -423,16 +423,16 @@ static void owl_unregister_thermal(void)
 /*
  * Calculate a temperature value from a temperature code.
  * The unit of the temperature is degree Celsius.
- * T = 838.45*7.894/(1024*12/count+7.894)-275+offset
+ * T = (838.45*5.068/(1024*12/count+7.894)-162+offset
  */
 static int offset=0;
 static int code_to_temp(struct owl_tmu_data *data, u32 temp_code)
 {
 	int tmp1,tmp2;
-	tmp1 = 83845*7894;
+	tmp1 = 83845*5068;
 	tmp2 = (1024*12*100000/temp_code)+789400;
 	tmp1 = tmp1/tmp2;
-	tmp1 = tmp1 - 275 + offset;
+	tmp1 = tmp1 - 162 + offset;
 
 	return tmp1;
 }
@@ -531,11 +531,11 @@ static struct thermal_sensor_conf owl_sensor_conf = {
 };
 
 static struct owl_tmu_platform_data atm7095a_default_tmu_data = {
-	.threshold_falling = 10,
-	.threshold = 105,
+	.threshold_falling = 6,
+	.threshold = 80,
 	.trigger_levels[0] = 0,
-	.trigger_levels[1] = 10,
-	.trigger_levels[2] = 20,
+	.trigger_levels[1] = 6,
+	.trigger_levels[2] = 12,
 	.trigger_level0_en = 1,
 	.trigger_level1_en = 1,
 	.trigger_level2_en = 1,
-- 
1.7.5.4

