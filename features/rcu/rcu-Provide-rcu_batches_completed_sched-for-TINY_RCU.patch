From de56ba7dde3d778de801db72713803386f22e0d3 Mon Sep 17 00:00:00 2001
From: "Paul E. McKenney" <paulmck@linux.vnet.ibm.com>
Date: Fri, 21 Nov 2014 15:45:27 -0800
Subject: [PATCH] rcu: Provide rcu_batches_completed_sched() for TINY_RCU

commit c1fe9cde4ae904fffb5b4d975d0a37e99136ff50 upstream.

A bug in rcutorture has caused it to ignore completed batches.
In preparation for fixing that bug, this commit provides TINY_RCU with
the required rcu_batches_completed_sched().

Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>

diff --git a/include/linux/rcutiny.h b/include/linux/rcutiny.h
index 5f904c10c619..ca2b76b3ed44 100644
--- a/include/linux/rcutiny.h
+++ b/include/linux/rcutiny.h
@@ -97,6 +97,14 @@ static inline unsigned long rcu_batches_completed_bh(void)
 	return 0;
 }
 
+/*
+ * Return the number of sched grace periods.
+ */
+static inline unsigned long rcu_batches_completed_sched(void)
+{
+	return 0;
+}
+
 static inline void rcu_force_quiescent_state(void)
 {
 }
-- 
2.3.4

