From 656f5c304f014885bf761f098f3146bc3fa3c216 Mon Sep 17 00:00:00 2001
From: "Paul E. McKenney" <paulmck@linux.vnet.ibm.com>
Date: Tue, 1 Oct 2013 10:14:09 -0700
Subject: [PATCH] rcutorture: Eliminate --rcu-kvm argument

commit 2bcdf4e31ae4e215b1e61831d9defa3632cb7bd3 upstream.

The --rcu-kvm argument was intended to allow the scripts to live in
an alternate location.  Unfortunately, this prevents the kvm.sh script
from using common functions until after it finished parsing arguments,
because it doesn't know where to find them until then.  However, "cp -a"
and "ln -s" work pretty well, so lack of an --rcu-kvm argument can be
easily worked around.

This commit therefore removes this argument.

Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
Cc: Greg KH <gregkh@linuxfoundation.org>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>

diff --git a/tools/testing/selftests/rcutorture/bin/kvm.sh b/tools/testing/selftests/rcutorture/bin/kvm.sh
index 89164c2..2af5494 100644
--- a/tools/testing/selftests/rcutorture/bin/kvm.sh
+++ b/tools/testing/selftests/rcutorture/bin/kvm.sh
@@ -46,7 +46,6 @@ usage () {
 	echo "       --duration minutes"
 	echo "       --kversion vN.NN"
 	echo "       --qemu-cmd qemu-system-..."
-	echo "       --rcu-kvm absolute-pathname"
 	echo "       --results absolute-pathname"
 	echo "       --relbuilddir relative-pathname"
 	exit 1
@@ -107,19 +106,6 @@ do
 		RCU_QEMU_CMD="$2"; export RCU_QEMU_CMD
 		shift
 		;;
-	--rcu-kvm)
-		checkarg --rcu-kvm "(absolute pathname)" "$#" "$2" '^/' error
-		KVM=$2; export KVM
-		if -z "$gotbuilddir"
-		then
-			builddir=${KVM}/b1
-		fi
-		if -n "$gotrelbuilddir"
-		then
-			builddir=${KVM}/${relbuilddir}
-		fi
-		shift
-		;;
 	--relbuilddir)
 		checkarg --relbuilddir "(relative pathname)" "$#" "$2" '^[^/]*$' '^--'
 		relbuilddir=$2
@@ -133,6 +119,7 @@ do
 		shift
 		;;
 	*)
+		echo Unknown argument $1
 		usage
 		;;
 	esac
-- 
1.8.2.3

