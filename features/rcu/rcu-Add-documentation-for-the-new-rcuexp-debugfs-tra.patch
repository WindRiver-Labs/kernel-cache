From 77a94dec76535899f09b5ff517bac782b321137d Mon Sep 17 00:00:00 2001
From: "Paul E. McKenney" <paul.mckenney@linaro.org>
Date: Wed, 31 Oct 2012 13:22:08 -0700
Subject: [PATCH] rcu: Add documentation for the new rcuexp debugfs trace file

commit d484a215139cf556cb718a7ec7042260b7fc2d28 upstream.

This commit adds the documentation of the rcuexp debugfs trace file
that records statistics for expedited grace periods.

Signed-off-by: Paul E. McKenney <paul.mckenney@linaro.org>
Signed-off-by: Paul E. McKenney <paulmck@linux.vnet.ibm.com>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
Signed-off-by: Yang Shi <yang.shi@windriver.com>

diff --git a/Documentation/RCU/trace.txt b/Documentation/RCU/trace.txt
index 79ce989..c776968 100644
--- a/Documentation/RCU/trace.txt
+++ b/Documentation/RCU/trace.txt
@@ -41,6 +41,8 @@ also rcu/rcu_preempt) the following files will be present:
 
 rcudata:
 	Displays fields in struct rcu_data.
+rcuexp:
+	Displays statistics for expedited grace periods.
 rcugp:
 	Displays grace-period counters.
 rcuhier:
@@ -233,6 +235,45 @@ o	"ktl" is the low-order 16 bits (in hexadecimal) of the count of
 	This field is displayed only for CONFIG_RCU_BOOST kernels.
 
 
+The output of "cat rcu/rcu_preempt/rcuexp" looks as follows:
+
+s=21872 d=21872 w=0 tf=0 wd1=0 wd2=0 n=0 sc=21872 dt=21872 dl=0 dx=21872
+
+These fields are as follows:
+
+o	"s" is the starting sequence number.
+
+o	"d" is the ending sequence number.  When the starting and ending
+	numbers differ, there is an expedited grace period in progress.
+
+o	"w" is the number of times that the sequence numbers have been
+	in danger of wrapping.
+
+o	"tf" is the number of times that contention has resulted in a
+	failure to begin an expedited grace period.
+
+o	"wd1" and "wd2" are the number of times that an attempt to
+	start an expedited grace period found that someone else had
+	completed an expedited grace period that satisfies the
+	attempted request.  "Our work is done."
+
+o	"n" is number of times that contention was so great that
+	the request was demoted from an expedited grace period to
+	a normal grace period.
+
+o	"sc" is the number of times that the attempt to start a
+	new expedited grace period succeeded.
+
+o	"dt" is the number of times that we attempted to update
+	the "d" counter.
+
+o	"dl" is the number of times that we failed to update the "d"
+	counter.
+
+o	"dx" is the number of times that we succeeded in updating
+	the "d" counter.
+
+
 The output of "cat rcu/rcu_preempt/rcugp" looks as follows:
 
 completed=31249  gpnum=31250  age=1  max=18
-- 
1.7.5.4

