From 12faac3547224db49f79d1fe4ea1ff42f52798f7 Mon Sep 17 00:00:00 2001
From: Liang Li <liang.li@windriver.com>
Date: Fri, 19 Oct 2012 11:25:59 +0800
Subject: [PATCH 3/8] drivers: staging: cdv: fix wrong kernel header file
 inclusion

o eliminate wrong reference to <asm/system.h>
o coordinate with the rename cdvsysinfo.h
o add <linux/module.h> as needed

Signed-off-by: Liang Li <liang.li@windriver.com>
---
 drivers/staging/cdv/pvr/include4/pvrmodule.h       |    3 +++
 .../cdv/pvr/services4/include/servicesint.h        |    2 +-
 .../cdv/pvr/services4/srvkm/env/linux/event.c      |    3 ---
 .../cdv/pvr/services4/srvkm/env/linux/osfunc.c     |    3 ---
 .../cdv/pvr/services4/srvkm/env/linux/proc.h       |    1 -
 .../cdv/pvr/services4/srvkm/include/osfunc.h       |    3 +--
 .../cdv/pvr/services4/system/include/syscommon.h   |    2 +-
 .../cdv/pvr/services4/system/unified/sysutils.c    |    2 +-
 8 files changed, 7 insertions(+), 12 deletions(-)

diff --git a/drivers/staging/cdv/pvr/include4/pvrmodule.h b/drivers/staging/cdv/pvr/include4/pvrmodule.h
index 3dd5845..4e36557 100644
--- a/drivers/staging/cdv/pvr/include4/pvrmodule.h
+++ b/drivers/staging/cdv/pvr/include4/pvrmodule.h
@@ -26,6 +26,9 @@
 
 #ifndef	_PVRMODULE_H_
 #define	_PVRMODULE_H_
+
+#include <linux/module.h>
+
 MODULE_AUTHOR("Imagination Technologies Ltd. <gpl-support@imgtec.com>");
 MODULE_LICENSE("GPL");
 #endif	
diff --git a/drivers/staging/cdv/pvr/services4/include/servicesint.h b/drivers/staging/cdv/pvr/services4/include/servicesint.h
index efd8f50..ad6e6fc 100644
--- a/drivers/staging/cdv/pvr/services4/include/servicesint.h
+++ b/drivers/staging/cdv/pvr/services4/include/servicesint.h
@@ -32,7 +32,7 @@ extern "C" {
 #endif
 
 #include "services.h"
-#include "sysinfo.h"
+#include "cdvsysinfo.h"
 
 #define HWREC_DEFAULT_TIMEOUT	(500)
 
diff --git a/drivers/staging/cdv/pvr/services4/srvkm/env/linux/event.c b/drivers/staging/cdv/pvr/services4/srvkm/env/linux/event.c
index 7e160c3..8ae19da 100644
--- a/drivers/staging/cdv/pvr/services4/srvkm/env/linux/event.c
+++ b/drivers/staging/cdv/pvr/services4/srvkm/env/linux/event.c
@@ -34,9 +34,6 @@
 
 #include <asm/io.h>
 #include <asm/page.h>
-#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,22))
-#include <asm/system.h>
-#endif
 #include <linux/mm.h>
 #include <linux/slab.h>
 #include <linux/vmalloc.h>
diff --git a/drivers/staging/cdv/pvr/services4/srvkm/env/linux/osfunc.c b/drivers/staging/cdv/pvr/services4/srvkm/env/linux/osfunc.c
index 7d4f21b..55d4d46 100644
--- a/drivers/staging/cdv/pvr/services4/srvkm/env/linux/osfunc.c
+++ b/drivers/staging/cdv/pvr/services4/srvkm/env/linux/osfunc.c
@@ -34,9 +34,6 @@
 
 #include <asm/io.h>
 #include <asm/page.h>
-#if (LINUX_VERSION_CODE >= KERNEL_VERSION(2,6,22))
-#include <asm/system.h>
-#endif
 #include <asm/cacheflush.h>
 #include <linux/mm.h>
 #include <linux/pagemap.h>
diff --git a/drivers/staging/cdv/pvr/services4/srvkm/env/linux/proc.h b/drivers/staging/cdv/pvr/services4/srvkm/env/linux/proc.h
index 2066d71..9e96ffa 100644
--- a/drivers/staging/cdv/pvr/services4/srvkm/env/linux/proc.h
+++ b/drivers/staging/cdv/pvr/services4/srvkm/env/linux/proc.h
@@ -27,7 +27,6 @@
 #ifndef __SERVICES_PROC_H__
 #define __SERVICES_PROC_H__
 
-#include <asm/system.h>		
 #include <linux/proc_fs.h>	
 #include <linux/seq_file.h> 
 
diff --git a/drivers/staging/cdv/pvr/services4/srvkm/include/osfunc.h b/drivers/staging/cdv/pvr/services4/srvkm/include/osfunc.h
index b76cefd..2f61c1c 100644
--- a/drivers/staging/cdv/pvr/services4/srvkm/include/osfunc.h
+++ b/drivers/staging/cdv/pvr/services4/srvkm/include/osfunc.h
@@ -39,7 +39,6 @@ extern "C" {
 #if defined(__linux__) && defined(__KERNEL__)
 #include <linux/hardirq.h>
 #include <linux/string.h>
-#include <asm/system.h>
 #if defined(__arm__)
 #include <asm/memory.h>
 #endif
@@ -47,7 +46,7 @@ extern "C" {
 
 
 	
-	#define PVRSRV_PAGEABLE_SELECT		PVRSRV_OS_PAGEABLE_HEAP
+#define PVRSRV_PAGEABLE_SELECT		PVRSRV_OS_PAGEABLE_HEAP
 
 #define KERNEL_ID			0xffffffffL
 #define POWER_MANAGER_ID	0xfffffffeL
diff --git a/drivers/staging/cdv/pvr/services4/system/include/syscommon.h b/drivers/staging/cdv/pvr/services4/system/include/syscommon.h
index 6131e13..215a065 100644
--- a/drivers/staging/cdv/pvr/services4/system/include/syscommon.h
+++ b/drivers/staging/cdv/pvr/services4/system/include/syscommon.h
@@ -28,7 +28,7 @@
 #define _SYSCOMMON_H
 
 #include "sysconfig.h"      
-#include "sysinfo.h"		
+#include "cdvsysinfo.h"
 #include "servicesint.h"
 #include "queue.h"
 #include "power.h"
diff --git a/drivers/staging/cdv/pvr/services4/system/unified/sysutils.c b/drivers/staging/cdv/pvr/services4/system/unified/sysutils.c
index b89a1da..2b1352b 100644
--- a/drivers/staging/cdv/pvr/services4/system/unified/sysutils.c
+++ b/drivers/staging/cdv/pvr/services4/system/unified/sysutils.c
@@ -25,6 +25,6 @@
  ******************************************************************************/
 
 #include "services_headers.h"
-#include "sysinfo.h"
+#include "cdvsysinfo.h"
 #include "syslocal.h"
 
-- 
1.7.9.7

