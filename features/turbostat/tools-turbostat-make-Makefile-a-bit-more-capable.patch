From 90a8960d1b8cc5b80eeed912fe0a3eb9d67c61a2 Mon Sep 17 00:00:00 2001
From: Mark Asselstine <mark.asselstine@windriver.com>
Date: Wed, 9 Mar 2011 11:59:09 -0500
Subject: [PATCH 4/4] tools: turbostat: make Makefile a bit more capable

The turbostat Makefile was pretty simple, its output would be placed
in the same directory as the source, the install rule had no
concept of a prefix or sysroot, and the default make rules would
be used preventing use of a cross compiler. By making a few minor
changes these limitations are removed while leaving the default
behavior matching what it used to be.

Signed-off-by: Mark Asselstine <mark.asselstine@windriver.com>
---
 tools/power/x86/turbostat/Makefile |   15 ++++++++++++---
 1 files changed, 12 insertions(+), 3 deletions(-)

diff --git a/tools/power/x86/turbostat/Makefile b/tools/power/x86/turbostat/Makefile
index fd8e1f1..13ae23b 100644
--- a/tools/power/x86/turbostat/Makefile
+++ b/tools/power/x86/turbostat/Makefile
@@ -1,8 +1,17 @@
+CC              = $(CROSS_COMPILE)gcc
+BUILD_OUTPUT	:= $(PWD)
+PREFIX		:= /usr
+DESTDIR		:=
+
 turbostat : turbostat.c
 
+%: %.c
+	@mkdir -p $(BUILD_OUTPUT)
+	$(CC) -c $(CFLAGS) $< -o $(BUILD_OUTPUT)/$@
+
 clean :
-	rm -f turbostat
+	rm -f $(BUILD_OUTPUT)/turbostat
 
 install :
-	install turbostat /usr/bin/turbostat
-	install turbostat.8 /usr/share/man/man8
+	install $(BUILD_OUTPUT)/turbostat $(DESTDIR)$(PREFIX)/bin/turbostat
+	install turbostat.8 $(DESTDIR)$(PREFIX)/share/man/man8
-- 
1.6.5.2

