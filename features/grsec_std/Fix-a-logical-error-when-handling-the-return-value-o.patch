From 1e5be8aa675efbf820658500a7bea669adb43253 Mon Sep 17 00:00:00 2001
From: Lans Zhang <jia.zhang@windriver.com>
Date: Thu, 5 Jan 2012 12:12:02 +0800
Subject: [PATCH] Fix a logical error when handling the return value of seq_putc()

Obviously, seq_putc() returning 0 indicates the success. This defect
is introduced by original grsecurity patch.

Signed-off-by: Lans Zhang <jia.zhang@windriver.com>
Integrated-by: Renxiu Liang <renxiu.liang@windriver.com>
---
 drivers/char/tpm/tpm_bios.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/char/tpm/tpm_bios.c b/drivers/char/tpm/tpm_bios.c
index b29fde6..19b6c2e 100644
--- a/drivers/char/tpm/tpm_bios.c
+++ b/drivers/char/tpm/tpm_bios.c
@@ -291,7 +291,7 @@ static int tpm_binary_bios_measurements_show(struct seq_file *m, void *v)
 	int i;
 
 	for (i = 0; i < sizeof(struct tcpa_event) + event->event_size; i++)
-		if (!seq_putc(m, data[i]))
+		if (seq_putc(m, data[i]))
 			return -EFAULT;
 
 	return 0;
-- 
1.7.0.5

