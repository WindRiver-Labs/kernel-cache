From 926aa22d84eb75b68bb47b2a910df8201e492cd5 Mon Sep 17 00:00:00 2001
From: Li Wang <li.wang@windriver.com>
Date: Tue, 21 Feb 2012 14:00:23 +0800
Subject: [PATCH] fuse: fix double kmalloc mem leak in fuse_notify_inval_entry

remove one redundant kmalloc function to fix it.

Signed-off-by: Li Wang <li.wang@windriver.com>
---
 fs/fuse/dev.c |    5 -----
 1 files changed, 0 insertions(+), 5 deletions(-)

diff --git a/fs/fuse/dev.c b/fs/fuse/dev.c
index bb9b418..5621477 100644
--- a/fs/fuse/dev.c
+++ b/fs/fuse/dev.c
@@ -903,11 +903,6 @@ static int fuse_notify_inval_entry(struct fuse_conn *fc, unsigned int size,
 	if (outarg.namelen > FUSE_NAME_MAX)
 		goto err;
 
-	err = -ENOMEM;
-	buf = kmalloc(FUSE_NAME_MAX+1, GFP_KERNEL);
-	if (!buf)
-		goto err;
-
 	name.name = buf;
 	name.len = outarg.namelen;
 	err = fuse_copy_one(cs, buf, outarg.namelen + 1);
-- 
1.7.0.4

