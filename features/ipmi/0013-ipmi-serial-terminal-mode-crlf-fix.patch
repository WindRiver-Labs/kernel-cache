From f57c0bd314815ce5d86ad7260353c2b0009d6a51 Mon Sep 17 00:00:00 2001
From: Jonathan Fournier <jonathan.fournier@windriver.com>
Date: Wed, 3 Sep 2008 18:38:37 -0400
Subject: [PATCH] ipmi serial terminal mode crlf fix

Serial terminal mode send a carriage return along with the line
feed in case some systems need this (e.g. the Motorola ATCA-7101)

Signed-off-by: Corey Minyard <cminyard@mvista.com>
Integrated-by: Jonathan Fournier <jonathan.fournier@windriver.com>
---
 drivers/char/ipmi/ipmi_serial_terminal_mode.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/drivers/char/ipmi/ipmi_serial_terminal_mode.c b/drivers/char/ipmi/ipmi_serial_terminal_mode.c
index b61a547..9acec1a 100644
--- a/drivers/char/ipmi/ipmi_serial_terminal_mode.c
+++ b/drivers/char/ipmi/ipmi_serial_terminal_mode.c
@@ -257,6 +257,8 @@ static void format_msg(struct ipmi_serial_codec_data *data,
 	len++;
 	c[len] = hex2char[msg[0] & 0xf];
 	len++;
+        c[len] = 0x0d; /* We definitely have room for this byte. */
+        len++;
 
 	/*
 	 * Insert the sequence number and bridge bits.  Bridge bits
-- 
1.5.5.1

