From 26873828801901462b3ff421b1c79410e61ab79e Mon Sep 17 00:00:00 2001
From: Paul Gortmaker <paul.gortmaker@windriver.com>
Date: Tue, 16 Apr 2013 16:16:01 -0400
Subject: [PATCH] fork: update for new cputime accounting structures

Our cherry pick of mainline commit d37f761dbd276790f70dcf73a2
("cputime: Consolidate cputime adjustment code") introduces
a compile failure in fork.c, since the old struct entries
were initialized there in the 3.4.x baseline.  Change them
to reference the new field names.

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>

diff --git a/kernel/fork.c b/kernel/fork.c
index ec2ff23..960dcf1 100644
--- a/kernel/fork.c
+++ b/kernel/fork.c
@@ -1238,7 +1238,7 @@ static struct task_struct *copy_process(unsigned long clone_flags,
 	p->utime = p->stime = p->gtime = 0;
 	p->utimescaled = p->stimescaled = 0;
 #ifndef CONFIG_VIRT_CPU_ACCOUNTING
-	p->prev_utime = p->prev_stime = 0;
+	p->prev_cputime.utime = p->prev_cputime.stime = 0;
 #endif
 #if defined(SPLIT_RSS_COUNTING)
 	memset(&p->rss_stat, 0, sizeof(p->rss_stat));
-- 
1.8.3.1

