From 3aa0dd093824c66f06f95578905e9a5d3a296017 Mon Sep 17 00:00:00 2001
From: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
Date: Thu, 13 May 2010 19:28:09 -0400
Subject: [PATCH 327/391] lttng-switch-timer-fix-del-timer

lttng switch timer fix del timer

Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@polymtl.ca>
---
 ltt/ltt-relay-lockless.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/ltt/ltt-relay-lockless.c b/ltt/ltt-relay-lockless.c
index 2bfa6b8..d8b1a9c 100644
--- a/ltt/ltt-relay-lockless.c
+++ b/ltt/ltt-relay-lockless.c
@@ -444,6 +444,7 @@ static void switch_buffer(unsigned long data)
 	if (atomic_long_read(&buf->active_readers))
 		ltt_force_switch(buf, FORCE_ACTIVE);
 
+	del_timer(&buf->switch_timer);
 	buf->switch_timer.expires += chan->switch_timer_interval;
 	add_timer_on(&buf->switch_timer, smp_processor_id());
 }
-- 
1.6.5.2

