From 6e9b5ebc587f6759a3cfe8d9b8eea06973ff7a2d Mon Sep 17 00:00:00 2001
From: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
Date: Wed, 18 May 2011 18:42:43 -0400
Subject: [PATCH 195/248] markers-update-to-2.6.35-tracepoints

markers update to 2.6.35 tracepoints

Add extra parameter to register.

Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
---
 include/linux/marker.h |    4 ++--
 kernel/marker.c        |    6 +++---
 2 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/include/linux/marker.h b/include/linux/marker.h
index 440692f..2efd78c 100644
--- a/include/linux/marker.h
+++ b/include/linux/marker.h
@@ -120,7 +120,7 @@ struct marker {
 	do {								\
 		void __check_tp_type(void)				\
 		{							\
-			register_trace_##tp_name(tp_cb);		\
+			register_trace_##tp_name(tp_cb, NULL);		\
 		}							\
 		DEFINE_MARKER_TP(channel, name, tp_name, tp_cb, format);\
 		__mark_check_format(format, ## args);			\
@@ -142,7 +142,7 @@ extern void marker_update_probe_range(struct marker *begin,
 	do {								\
 		void __check_tp_type(void)				\
 		{							\
-			register_trace_##tp_name(tp_cb);		\
+			register_trace_##tp_name(tp_cb, NULL);		\
 		}							\
 		__mark_check_format(format, ## args);			\
 	} while (0)
diff --git a/kernel/marker.c b/kernel/marker.c
index 619d868..56b51b7 100644
--- a/kernel/marker.c
+++ b/kernel/marker.c
@@ -598,11 +598,11 @@ static int set_marker(struct marker_entry *entry, struct marker *elem,
 			BUG_ON(!ret);
 			ret = tracepoint_probe_register_noupdate(
 				elem->tp_name,
-				elem->tp_cb);
+				elem->tp_cb, NULL);
 		} else {
 			ret = tracepoint_probe_unregister_noupdate(
 				elem->tp_name,
-				elem->tp_cb);
+				elem->tp_cb, NULL);
 			/*
 			 * tracepoint_probe_update_all() must be called
 			 * before the module containing tp_cb is unloaded.
@@ -634,7 +634,7 @@ static void disable_marker(struct marker *elem)
 		 * checking has been done in the __trace_mark_tp() macro.
 		 */
 		ret = tracepoint_probe_unregister_noupdate(elem->tp_name,
-			elem->tp_cb);
+			elem->tp_cb, NULL);
 		WARN_ON(ret);
 		/*
 		 * tracepoint_probe_update_all() must be called
-- 
1.7.0.4

