From 2e930e32c15fac39547808f2d2ff06be364fc451 Mon Sep 17 00:00:00 2001
From: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
Date: Thu, 13 May 2010 19:28:37 -0400
Subject: [PATCH 376/391] immediate-values-powerpc-broken

Immediate values broken on ppc

Had a report that immediate values were working intermittently on ppc. Mark them
as broken for powerpc.

Immediate values are a slight optimization over the "read, test and
branch" done by tracepoints by default. Newer gcc 4.5 will support asm
gotos, and so will the mainline kernel. It replaces the immediate
values. So, eventually, even though immediate values have been really
useful to show the merit of static jump patching (they served as
prototype for the asm goto requirements), they will be eventually
phased-out.

So I would tend to simply mark them as "BROKEN" in the next release for
powerpc rather than spend time trying to find out what subtle compiler
breakage we have here.

Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
---
 init/Kconfig |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/init/Kconfig b/init/Kconfig
index 5e246ec..ceaf7a4 100644
--- a/init/Kconfig
+++ b/init/Kconfig
@@ -1183,6 +1183,7 @@ config HAVE_IMMEDIATE
 config IMMEDIATE
 	default y
 	depends on HAVE_IMMEDIATE
+	depends on BROKEN || !PPC
 	bool "Immediate value optimization" if EMBEDDED
 	help
 	  Immediate values are used as read-mostly variables that are rarely
-- 
1.6.5.2

