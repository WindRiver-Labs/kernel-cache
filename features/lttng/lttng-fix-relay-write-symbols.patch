From 8088472f6ced92f95e5f068bc9f33d9076e42640 Mon Sep 17 00:00:00 2001
From: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
Date: Thu, 13 May 2010 19:28:40 -0400
Subject: [PATCH 382/391] lttng-fix-relay-write-symbols

lttng fix relay write symbols

Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
---
 ltt/Kconfig  |   40 +++++++++++++++-------------------------
 ltt/Makefile |    2 +-
 2 files changed, 16 insertions(+), 26 deletions(-)

diff --git a/ltt/Kconfig b/ltt/Kconfig
index 05eef6d..f81f4ec 100644
--- a/ltt/Kconfig
+++ b/ltt/Kconfig
@@ -34,16 +34,24 @@ config LTT_FILTER
 config HAVE_LTT_DUMP_TABLES
 	def_bool n
 
-config LTT_RELAY
-	tristate "LTTng buffer relay"
-	depends on LTT_TRACER
+config LTT_TRACER
+	tristate "Linux Trace Toolkit Tracer"
 	default y
 	help
-	  Build the LTTng ring-buffer.
+	  If you enable this option, the Linux Trace Toolkit Tracer will be
+	  either built in the kernel or as module.
+
+	  Critical parts of the kernel will call upon the kernel tracing
+	  function. The data is then recorded by the tracer if a trace daemon
+	  is running in user-space and has issued a "start" command.
+
+	  For more information on kernel tracing, the trace daemon or the event
+	  decoder, please check the following address :
+	       http://lttng.org
 
 choice
 	prompt "LTTng Buffer Concurrency Management Algorithm"
-	depends on LTT_RELAY
+	depends on LTT_TRACER
 	default LTT_RELAY_LOCKLESS
 	help
 	  Choose between the fast lockless and the slower, spinlock/irq disable
@@ -79,7 +87,7 @@ endchoice
 
 config LTT_SERIALIZE
 	tristate "Linux Trace Toolkit Serializer"
-	depends on LTT_RELAY
+	depends on LTT_TRACER
 	depends on (LTT_RELAY_LOCKLESS || LTT_RELAY_IRQOFF || LTT_RELAY_LOCKED)
 	default y
 	help
@@ -88,7 +96,7 @@ config LTT_SERIALIZE
 
 config LTT_FAST_SERIALIZE
 	tristate "Linux Trace Toolkit Custom Serializer"
-	depends on LTT_RELAY
+	depends on LTT_TRACER
 	depends on (LTT_RELAY_LOCKLESS || LTT_RELAY_IRQOFF || LTT_RELAY_LOCKED)
 	default y
 	help
@@ -115,23 +123,6 @@ config LTT_TRACE_CONTROL
 	  If you enable this option, the debugfs-based Linux Trace Toolkit Trace
 	  Controller will be either built in the kernel or as module.
 
-config LTT_TRACER
-	tristate "Linux Trace Toolkit Tracer"
-	default y
-	help
-	  If you enable this option, the Linux Trace Toolkit Tracer will be
-	  either built in the kernel or as module.
-
-	  Critical parts of the kernel will call upon the kernel tracing
-	  function. The data is then recorded by the tracer if a trace daemon
-	  is running in user-space and has issued a "start" command.
-
-	  For more information on kernel tracing, the trace daemon or the event
-	  decoder, please check the following address :
-	       http://www.opersys.com/ltt
-	  See also the experimental page of the project :
-	       http://ltt.polymtl.ca
-
 config LTT_ALIGNMENT
 	bool "Align Linux Trace Toolkit Traces"
 	default n
@@ -214,7 +205,6 @@ config LTT_ASCII
 	bool "Linux Trace Toolkit Ascii Output (EXPERIMENTAL)"
 	depends on EXPERIMENTAL
 	depends on LTT_TRACER
-	depends on LTT_RELAY
 	depends on LTT_SERIALIZE
 	default n
 	help
diff --git a/ltt/Makefile b/ltt/Makefile
index 88d3d46..2a5122d 100644
--- a/ltt/Makefile
+++ b/ltt/Makefile
@@ -19,7 +19,7 @@ ifdef CONFIG_LTT_RELAY_LOCKED
 RELAY_LOCKING := ltt-relay-locked.o
 endif
 
-obj-$(CONFIG_LTT_RELAY) += ltt-relay.o
+obj-$(CONFIG_LTT_TRACER) += ltt-relay.o
 ltt-relay-objs := $(RELAY_LOCKING) ltt-relay-alloc.o ltt-relay-splice.o \
 		  ltt-relay-vfs.o
 
-- 
1.6.5.2

