From 8256e82d7886f4976076148461e4d210f7689cd4 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Tue, 29 May 2012 16:03:26 -0700
Subject: [PATCH 246/248] lttng-modules: Convert to new irq_chip functions

Add cleanup direct access to irq_desc[].

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 ltt/ltt-statedump.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/ltt/ltt-statedump.c b/ltt/ltt-statedump.c
index 43cc2ed..47a0232 100644
--- a/ltt/ltt-statedump.c
+++ b/ltt/ltt-statedump.c
@@ -303,12 +303,15 @@ static inline void list_interrupts(struct ltt_probe_private_data *call_data)
 	unsigned int irq;
 	unsigned long flags = 0;
 	struct irq_desc *desc;
+	struct irq_chip *chip;
 
 	/* needs irq_desc */
 	for_each_irq_desc(irq, desc) {
 		struct irqaction *action;
+		chip = irq_desc_get_chip(desc);
+
 		const char *irq_chip_name =
-			desc->chip->name ? : "unnamed_irq_chip";
+			chip->name ? : "unnamed_irq_chip";
 
 		local_irq_save(flags);
 		raw_spin_lock(&desc->lock);
-- 
1.7.0.4

