From fb89a19c492e4f237b964fb058ff9674e68a0ac5 Mon Sep 17 00:00:00 2001
From: Liang Li <liang.li@windriver.com>
Date: Wed, 6 Jun 2012 22:37:18 +0800
Subject: [PATCH 2/2] lttng: powerpc kvm: restrict to x86 kvm

The implementation just for x86, so ifdef them.

Signed-off-by: Thomas Tai <thomas.tai@windriver.com>
---
 ltt/probes/kvm-trace.c |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/ltt/probes/kvm-trace.c b/ltt/probes/kvm-trace.c
index b611efc..a1dd502 100644
--- a/ltt/probes/kvm-trace.c
+++ b/ltt/probes/kvm-trace.c
@@ -9,8 +9,9 @@
  */
 
 #include <linux/module.h>
-#include <asm/vmx.h>
 #include <linux/kvm_host.h>
+#ifdef CONFIG_X86
+#include <asm/vmx.h>
 #include <asm/kvm-trace.h>
 
 void probe_kvm_entry(void *_data, unsigned int vcpu_id)
@@ -208,3 +209,4 @@ void probe_kvm_skinit(void *_data, __u64 rip, __u32 slb)
 MODULE_LICENSE("GPL and additional rights");
 MODULE_AUTHOR("Julien Desfossez");
 MODULE_DESCRIPTION("KVM Tracepoint Probes");
+#endif
-- 
1.7.9.7

