From c3da4e4401a9eba4db59607b2e5dae29ef16e985 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Fri, 1 Jun 2012 16:27:41 -0700
Subject: [PATCH 3/3] lttng: hugetlb: hugetlb_get_quota is no longer exist

Due to commit 90481622d75715bfcb68501280a917dbfe516029
[hugepages: fix use after free bug in "quota" handling],
hugetlb_get/put_quota is no longer exist, so replace hugetlb_get_quota
to hugepage_subpool_get_pages.

Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 mm/hugetlb.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/mm/hugetlb.c b/mm/hugetlb.c
index 7610151..680a7da 100644
--- a/mm/hugetlb.c
+++ b/mm/hugetlb.c
@@ -3017,7 +3017,7 @@ int hugetlb_reserve_pages(struct inode *inode,
 	}
 
 	/* There must be enough pages in the subpool for the mapping */
-	if (hugetlb_get_quota(inode->i_mapping, chg)) {
+	if (hugepage_subpool_get_pages(spool, chg)) {
 		ret = -ENOSPC;
 		goto end;
 	}
-- 
1.7.9.7

