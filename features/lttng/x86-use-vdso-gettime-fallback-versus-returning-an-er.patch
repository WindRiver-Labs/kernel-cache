From 4ae8f8605c81c39b959948e23f7123294a5dfb3f Mon Sep 17 00:00:00 2001
From: Liming Wang <liming.wang@windriver.com>
Date: Wed, 24 Aug 2011 10:45:19 +0800
Subject: [PATCH] x86: use vdso gettime fallback versus returning an error

__vdso_clock_gettime should fall back to call vdso_fallback_gettime function
if no clockid is selected, not just return error.

Signed-off-by: Liming Wang <liming.wang@windriver.com>
---
 arch/x86/vdso/vclock_gettime.c |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

diff --git a/arch/x86/vdso/vclock_gettime.c b/arch/x86/vdso/vclock_gettime.c
index 7bc4815..2365a5b 100644
--- a/arch/x86/vdso/vclock_gettime.c
+++ b/arch/x86/vdso/vclock_gettime.c
@@ -173,8 +173,6 @@ notrace int __vdso_clock_gettime(clockid_t clock, struct timespec *ts)
 			return do_trace_clock(ts);
 		case CLOCK_TRACE_FREQ:
 			return do_trace_clock_freq(ts);
-		default:
-			return -EINVAL;
 		}
 	return vdso_fallback_gettime(clock, ts);
 }
-- 
1.7.4.1

