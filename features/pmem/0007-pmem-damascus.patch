From 0ee8021ac22ded81b3c8bfb9219e8df840c9630c Mon Sep 17 00:00:00 2001
From: Yongli He <yongli.he@windriver.com>
Date: Tue, 23 Sep 2008 15:36:35 +0800
Subject: [PATCH] pmem damascus

nitialization for 9030 device to be used by PMEM was added to DAMASCUS
(intel_mpcbl0040).

Signed-off-by: Jason HU <yongqi.hu@windriver.com>
Integrated-by: Yongli he   <yongli.he@windriver.com>
---
 drivers/pmem/pmem_pci.c |   11 ++++++++---
 1 files changed, 8 insertions(+), 3 deletions(-)

diff --git a/drivers/pmem/pmem_pci.c b/drivers/pmem/pmem_pci.c
index effdd2c..b18f8dc 100644
--- a/drivers/pmem/pmem_pci.c
+++ b/drivers/pmem/pmem_pci.c
@@ -7,12 +7,13 @@
 
 #if defined(CONFIG_PMEM_HW_ATCAF101)
 #define PCI_DEVICE_ID_MOTOROLA_9030	0x4824
-#define PCI_9030_PMEM_RESOURCE		2
 #elif defined(CONFIG_PMEM_HW_ATCA7101)
 #define PCI_DEVICE_ID_MOTOROLA_9030	0x4825
-#define PCI_9030_PMEM_RESOURCE		2
 #endif
 
+#define PCI_DEVICE_ID_PLX_9030	        0x9030
+#define PCI_9030_PMEM_RESOURCE		2
+
 #define PCI_PMC815_PMEM_RESOURCE        2
 
 /* GWC will have 4 PMC280s.  MC will have 1 PMC280 on bus-4 device-4 */
@@ -198,7 +199,7 @@ static int probe_harrier(struct pci_dev *dev, const struct pci_device_id *id)
 }
 #endif
 
-#if defined(CONFIG_PMEM_HW_ATCA7101) || defined(CONFIG_PMEM_HW_ATCAF101)
+#if defined(CONFIG_PMEM_HW_ATCA7101) || defined(CONFIG_PMEM_HW_ATCAF101) || defined(CONFIG_PMEM_HW_DAMASCUS)
 /* Initialize the 9030 device to be used for Pmem */
 static int probe_9030(struct pci_dev *dev, const struct pci_device_id *id)
 {
@@ -289,6 +290,10 @@ static struct pci_device_id ids[] = {
 	{PCI_DEVICE(PCI_VENDOR_ID_MOTOROLA, PCI_DEVICE_ID_MOTOROLA_9030),
 	 0, 0, (kernel_ulong_t) & probe_9030},
 #endif
+#ifdef CONFIG_PMEM_HW_DAMASCUS
+	{PCI_DEVICE(PCI_VENDOR_ID_PLX, PCI_DEVICE_ID_PLX_9030),
+	 0, 0, (kernel_ulong_t) & probe_9030},
+#endif
 #ifdef CONFIG_PMEM_HW_ATCA717
 	{PCI_DEVICE(PCI_VENDOR_ID_MARVELL, PCI_DEVICE_ID_MARVELL_MV64360),
 	 0, 0, (kernel_ulong_t) & probe_64360},
-- 
1.5.5.1

