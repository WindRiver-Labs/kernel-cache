From 5057bd2cdff6b98bd6df6d4f09b16e1e39557a95 Mon Sep 17 00:00:00 2001
From: Dave Lerner <dave.lerner@windriver.com>
Date: Wed, 2 Oct 2013 11:16:04 -0500
Subject: [PATCH] Add the cpuid values for the haswell target
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

WIND: US18075

Use the values in Table 35-1 "CPUID Signature Values of
DisplayFamily_DisplayModel" volume 3A of the "Intel® 64
and IA-32 Architectures Software Developer’s Manual" to add the
haswell target to oprofile.  This changes the oprofile initialization
to write the string "i386/haswell" in /dev/oprofile/cpu_type.  That
field is the pointer to the file directory included with the oprofile
uprev 0.9.9, /usr/share/oprofile/i386/haswell.

Signed-off-by: Dave Lerner <dave.lerner@windriver.com>
---
 arch/x86/oprofile/nmi_int.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/arch/x86/oprofile/nmi_int.c b/arch/x86/oprofile/nmi_int.c
index 48768df..529ebbb 100644
--- a/arch/x86/oprofile/nmi_int.c
+++ b/arch/x86/oprofile/nmi_int.c
@@ -672,6 +672,11 @@ static int __init ppro_init(char **cpu_type)
 	case 0x1c:
 		*cpu_type = "i386/atom";
 		break;
+	case 0x3c:
+	case 0x45:
+	case 0x46:
+		*cpu_type = "i386/haswell";
+		break;
 	default:
 		/* Unknown */
 		return 0;
-- 
1.8.4.93.g57e4c17

