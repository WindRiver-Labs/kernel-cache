From 8691c3f88461ea03290c86af140e0bda3332d013 Mon Sep 17 00:00:00 2001
From: Junxiao Bi <Junxiao.Bi@windriver.com>
Date: Fri, 29 Jul 2011 16:29:50 +0800
Subject: [PATCH] stm_spear13xx: register PMU IRQ

Register PMU IRQ into perf subsystem to support oprofile in hardware
PMU mode

Signed-off-by: Junxiao Bi <junxiao.bi@windriver.com>
---
 arch/arm/kernel/pmu.c                       |    3 +++
 arch/arm/mach-spear13xx/include/mach/irqs.h |    2 ++
 2 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/arch/arm/kernel/pmu.c b/arch/arm/kernel/pmu.c
index c74f867..66c86c8 100644
--- a/arch/arm/kernel/pmu.c
+++ b/arch/arm/kernel/pmu.c
@@ -48,6 +48,9 @@ static const int irqs[] = {
 	IRQ_PMU_MXC,
 #elif defined(CONFIG_ARCH_CNS3XXX)
 	IRQ_PMU_CNS3XXX,
+#elif defined(CONFIG_MACH_SPEAR1310)
+	IRQ_PMU_CPU0,
+	IRQ_PMU_CPU1,
 #endif
 };
 
diff --git a/arch/arm/mach-spear13xx/include/mach/irqs.h b/arch/arm/mach-spear13xx/include/mach/irqs.h
index eeb48a2..3e31c2b 100644
--- a/arch/arm/mach-spear13xx/include/mach/irqs.h
+++ b/arch/arm/mach-spear13xx/include/mach/irqs.h
@@ -28,6 +28,8 @@
 /* Shared Peripheral Interrupt (SHPI) */
 #define IRQ_SHPI_START		32
 
+#define IRQ_PMU_CPU0		(IRQ_SHPI_START + 6)
+#define IRQ_PMU_CPU1		(IRQ_SHPI_START + 7)
 #define IRQ_PLAY_I2S0		(IRQ_SHPI_START + 10)
 #define IRQ_REC_I2S0		(IRQ_SHPI_START + 11)
 #define IRQ_ADC			(IRQ_SHPI_START + 12)
-- 
1.7.0.4

