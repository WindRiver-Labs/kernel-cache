From 3affaf5d4dc5cb3c1a893a0b8a7470486f74410d Mon Sep 17 00:00:00 2001
From: Yongli He <yongli.he@windriver.com>
Date: Mon, 25 Aug 2008 11:29:32 +0800
Subject: [PATCH] revoke: support for ext2 and ext3 V7
 From: Pekka Enberg <penberg@cs.helsinki.fi>

Add revoke support to ext2, ext3 and ext4 by wiring f_ops->revoke with
generic_file_revoke.

Cc: Alan Cox <alan@redhat.com>
Cc: Al Viro <viro@zeniv.linux.org.uk>
Cc: Christoph Hellwig <hch@infradead.org>
Cc: Peter Zijlstra <peterz@infradead.org>
Signed-off-by: Pekka Enberg <penberg@cs.helsinki.fi>
Integrated-by: Yongli he   <yongli.he@windriver.com>
---
 fs/ext2/file.c |    1 +
 fs/ext3/file.c |    1 +
 fs/ext4/file.c |    1 +
 3 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/fs/ext2/file.c b/fs/ext2/file.c
index 5f2fa9c..1b9797d 100644
--- a/fs/ext2/file.c
+++ b/fs/ext2/file.c
@@ -58,6 +58,7 @@ const struct file_operations ext2_file_operations = {
 	.fsync		= ext2_sync_file,
 	.splice_read	= generic_file_splice_read,
 	.splice_write	= generic_file_splice_write,
+	.revoke		= generic_file_revoke,
 };
 
 #ifdef CONFIG_EXT2_FS_XIP
diff --git a/fs/ext3/file.c b/fs/ext3/file.c
index acc4913..35997c7 100644
--- a/fs/ext3/file.c
+++ b/fs/ext3/file.c
@@ -122,6 +122,7 @@ const struct file_operations ext3_file_operations = {
 	.fsync		= ext3_sync_file,
 	.splice_read	= generic_file_splice_read,
 	.splice_write	= generic_file_splice_write,
+	.revoke         = generic_file_revoke,
 };
 
 const struct inode_operations ext3_file_inode_operations = {
diff --git a/fs/ext4/file.c b/fs/ext4/file.c
index 430eb79..14a2e8e 100644
--- a/fs/ext4/file.c
+++ b/fs/ext4/file.c
@@ -156,6 +156,7 @@ const struct file_operations ext4_file_operations = {
 	.fsync		= ext4_sync_file,
 	.splice_read	= generic_file_splice_read,
 	.splice_write	= generic_file_splice_write,
+	.revoke         = generic_file_revoke,
 };
 
 const struct inode_operations ext4_file_inode_operations = {
-- 
1.5.5.1

