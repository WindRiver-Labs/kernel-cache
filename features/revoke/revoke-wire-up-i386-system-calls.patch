From 72396b69ce7f0e5791ec1f119bd4c63059cb21b3 Mon Sep 17 00:00:00 2001
From: Yongli He <yongli.he@windriver.com>
Date: Mon, 25 Aug 2008 11:27:58 +0800
Subject: [PATCH] revoke wire up i386 system call V7
 From: Pekka Enberg <penberg@cs.helsinki.fi>

Make revokeat system call available to user-space on i386.

[akpm@linux-foundation.org: fix 32-bit userspace]
Cc: Alan Cox <alan@redhat.com>
Cc: Al Viro <viro@zeniv.linux.org.uk>
Cc: Christoph Hellwig <hch@infradead.org>
Cc: Peter Zijlstra <peterz@infradead.org>
Signed-off-by: Pekka Enberg <penberg@cs.helsinki.fi>
Integrated-by: Yongli he   <yongli.he@windriver.com>
---
 arch/x86/ia32/ia32entry.S          |    1 +
 arch/x86/kernel/syscall_table_32.S |    1 +
 include/asm-x86/unistd_32.h        |    3 ++-
 3 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/arch/x86/ia32/ia32entry.S b/arch/x86/ia32/ia32entry.S
index 2e246f3..4587a0b 100644
--- a/arch/x86/ia32/ia32entry.S
+++ b/arch/x86/ia32/ia32entry.S
@@ -834,4 +834,5 @@ ia32_sys_call_table:
 	.quad sys_inotify_init1
 	.quad sys_marker
 	.quad sys_trace
+	.quad sys_revokeat		/* 335 */
 ia32_syscall_end:
diff --git a/arch/x86/kernel/syscall_table_32.S b/arch/x86/kernel/syscall_table_32.S
index 0fedfd5..6bc6eb6 100644
--- a/arch/x86/kernel/syscall_table_32.S
+++ b/arch/x86/kernel/syscall_table_32.S
@@ -334,3 +334,4 @@ ENTRY(sys_call_table)
 	.long sys_inotify_init1
 	.long sys_marker
 	.long sys_trace
+	.long sys_revokeat		/* 335 */
diff --git a/include/asm-x86/unistd_32.h b/include/asm-x86/unistd_32.h
index be04670..b426394 100644
--- a/include/asm-x86/unistd_32.h
+++ b/include/asm-x86/unistd_32.h
@@ -340,8 +340,9 @@
 #define __NR_inotify_init1	332
 #define __NR_marker		333
 #define __NR_trace		334
+#define __NR_revokeat		335
 
-#define NR_syscalls		335
+#define NR_syscalls		336
 
 #ifdef __KERNEL__
 
-- 
1.5.5.1

