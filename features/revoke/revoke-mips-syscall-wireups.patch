From 627d75fa4c576f0479bcfcf9675593739dfb5859 Mon Sep 17 00:00:00 2001
From: Bruce Ashfield <bruce.ashfield@windriver.com>
Date: Wed, 2 Jun 2010 00:31:33 -0400
Subject: [PATCH] revoke: mips: syscall wireups

Signed-off-by: Bruce Ashfield <bruce.ashfield@windriver.com>
---
 arch/mips/include/asm/unistd.h |   15 +++++++++------
 arch/mips/kernel/scall32-o32.S |    1 +
 arch/mips/kernel/scall64-64.S  |    1 +
 arch/mips/kernel/scall64-n32.S |    1 +
 arch/mips/kernel/scall64-o32.S |    1 +
 5 files changed, 13 insertions(+), 6 deletions(-)

diff --git a/arch/mips/include/asm/unistd.h b/arch/mips/include/asm/unistd.h
index e98b834..4eda7c1 100644
--- a/arch/mips/include/asm/unistd.h
+++ b/arch/mips/include/asm/unistd.h
@@ -363,6 +363,7 @@
 #define __NR_sched_setparam_ex		(__NR_Linux + 340)
 #define __NR_sched_getparam_ex		(__NR_Linux + 341)
 #define __NR_sched_wait_interval	(__NR_Linux + 342)
+#define __NR_revokeat			(__NR_Linux + 343)
 
 #define VBI_MEM_READ			0x0010
 #define VBI_MEM_WRITE			0x0100
@@ -373,12 +374,12 @@
 /*
  * Offset of the last Linux o32 flavoured syscall
  */
-#define __NR_Linux_syscalls		342
+#define __NR_Linux_syscalls		343
 
 #endif /* _MIPS_SIM == _MIPS_SIM_ABI32 */
 
 #define __NR_O32_Linux			4000
-#define __NR_O32_Linux_syscalls		342
+#define __NR_O32_Linux_syscalls		343
 
 #if _MIPS_SIM == _MIPS_SIM_ABI64
 
@@ -688,6 +689,7 @@
 #define __NR_sched_setparam_ex		(__NR_Linux + 299)
 #define __NR_sched_getparam_ex		(__NR_Linux + 300)
 #define __NR_sched_wait_interval	(__NR_Linux + 301)
+#define __NR_revokeat			(__NR_Linux + 302)
 
 #define VBI_MEM_READ			0x0010
 #define VBI_MEM_WRITE			0x0100
@@ -698,12 +700,12 @@
 /*
  * Offset of the last Linux 64-bit flavoured syscall
  */
-#define __NR_Linux_syscalls		301
+#define __NR_Linux_syscalls		302
 
 #endif /* _MIPS_SIM == _MIPS_SIM_ABI64 */
 
 #define __NR_64_Linux			5000
-#define __NR_64_Linux_syscalls		301
+#define __NR_64_Linux_syscalls		302
 
 #if _MIPS_SIM == _MIPS_SIM_NABI32
 
@@ -1018,6 +1020,7 @@
 #define __NR_sched_setparam_ex		(__NR_Linux + 304)
 #define __NR_sched_getparam_ex		(__NR_Linux + 305)
 #define __NR_sched_wait_interval	(__NR_Linux + 306)
+#define __NR_revokeat			(__NR_Linux + 307)
 
 #define VBI_MEM_READ			0x0010
 #define VBI_MEM_WRITE			0x0100
@@ -1028,12 +1031,12 @@
 /*
  * Offset of the last N32 flavoured syscall
  */
-#define __NR_Linux_syscalls		306
+#define __NR_Linux_syscalls		307
 
 #endif /* _MIPS_SIM == _MIPS_SIM_NABI32 */
 
 #define __NR_N32_Linux			6000
-#define __NR_N32_Linux_syscalls		306
+#define __NR_N32_Linux_syscalls		307
 
 #ifdef __KERNEL__
 
diff --git a/arch/mips/kernel/scall32-o32.S b/arch/mips/kernel/scall32-o32.S
index e74815b..05a35d1 100644
--- a/arch/mips/kernel/scall32-o32.S
+++ b/arch/mips/kernel/scall32-o32.S
@@ -593,6 +593,7 @@ einval:	li	v0, -ENOSYS
 	sys     sys_sched_getparam_ex	3
 	sys     sys_sched_wait_interval	2
 	sys     sys_setns               2
+	sys     sys_revokeat            2
 	.endm
 
 	/* We pre-compute the number of _instruction_ bytes needed to
diff --git a/arch/mips/kernel/scall64-64.S b/arch/mips/kernel/scall64-64.S
index a77b8d1..e7aca5b 100644
--- a/arch/mips/kernel/scall64-64.S
+++ b/arch/mips/kernel/scall64-64.S
@@ -433,4 +433,5 @@ EXPORT(sys_call_table)
 	PTR     sys_sched_getparam_ex
 	PTR     sys_sched_wait_interval
 	PTR     sys_setns
+	PTR     sys_revokeat
 	.size	sys_call_table,.-sys_call_table
diff --git a/arch/mips/kernel/scall64-n32.S b/arch/mips/kernel/scall64-n32.S
index e30ecec..9930ecd 100644
--- a/arch/mips/kernel/scall64-n32.S
+++ b/arch/mips/kernel/scall64-n32.S
@@ -436,4 +436,5 @@ EXPORT(sysn32_call_table)
 	PTR     sys_sched_getparam_ex
 	PTR     sys_sched_wait_interval
 	PTR     sys_setns
+	PTR     sys_revokeat
 	.size	sysn32_call_table,.-sysn32_call_table
diff --git a/arch/mips/kernel/scall64-o32.S b/arch/mips/kernel/scall64-o32.S
index affc07a..68b2ed1 100644
--- a/arch/mips/kernel/scall64-o32.S
+++ b/arch/mips/kernel/scall64-o32.S
@@ -552,4 +552,5 @@ EXPORT(syso32_call_table)
 	PTR     sys_sched_getparam_ex
 	PTR     sys_sched_wait_interval
 	PTR     sys_setns
+	PTR     sys_revokeat
 	.size	sys_call_table,.-sys_call_table
-- 
1.7.0.4

