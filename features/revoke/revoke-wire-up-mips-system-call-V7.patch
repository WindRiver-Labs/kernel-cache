From 20fba0f0cd9514987c6584312dbfce2d4069aba6 Mon Sep 17 00:00:00 2001
From: Yongli He <yongli.he@windriver.com>
Date: Mon, 1 Sep 2008 15:20:34 +0800
Subject: [PATCH] revoke wire up mips system call V7\

Make revokeat system call available to user-space on mips

igned-off-by: Yongli he   <yongli.he@windriver.com>
---
 arch/mips/kernel/scall32-o32.S |    1 +
 arch/mips/kernel/scall64-64.S  |    1 +
 arch/mips/kernel/scall64-n32.S |    1 +
 arch/mips/kernel/scall64-o32.S |    1 +
 include/asm-mips/unistd.h      |    5 +++--
 5 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/arch/mips/kernel/scall32-o32.S b/arch/mips/kernel/scall32-o32.S
index d9e07aa..af45923 100644
--- a/arch/mips/kernel/scall32-o32.S
+++ b/arch/mips/kernel/scall32-o32.S
@@ -651,6 +651,7 @@ einval:	li	v0, -ENOSYS
 	sys	sys_dup3		3
 	sys	sys_pipe2		2
 	sys	sys_inotify_init1	1
+	sys     sys_revokeat            2
 	.endm
 
 	/* We pre-compute the number of _instruction_ bytes needed to
diff --git a/arch/mips/kernel/scall64-64.S b/arch/mips/kernel/scall64-64.S
index 9df3f40..a8ea38c 100644
--- a/arch/mips/kernel/scall64-64.S
+++ b/arch/mips/kernel/scall64-64.S
@@ -484,6 +484,7 @@ EXPORT(sys64_call_table)
 	PTR	sys_timerfd_create		/* 5280 */
 	PTR	sys_timerfd_gettime
 	PTR	sys_timerfd_settime
+	PTR     sys_revokeat        
 	PTR	sys_signalfd4
 	PTR	sys_eventfd2
 	PTR	sys_epoll_create1		/* 5285 */
diff --git a/arch/mips/kernel/scall64-n32.S b/arch/mips/kernel/scall64-n32.S
index 082128d..29cbe1e 100644
--- a/arch/mips/kernel/scall64-n32.S
+++ b/arch/mips/kernel/scall64-n32.S
@@ -409,6 +409,7 @@ EXPORT(sysn32_call_table)
 	PTR	sys_timerfd_create
 	PTR	compat_sys_timerfd_gettime	/* 5285 */
 	PTR	compat_sys_timerfd_settime
+	PTR     sys_revokeat            
 	PTR	sys_signalfd4
 	PTR	sys_eventfd2
 	PTR	sys_epoll_create1
diff --git a/arch/mips/kernel/scall64-o32.S b/arch/mips/kernel/scall64-o32.S
index 2aa5e9c..b530772 100644
--- a/arch/mips/kernel/scall64-o32.S
+++ b/arch/mips/kernel/scall64-o32.S
@@ -528,6 +528,7 @@ EXPORT(sys_call_table)
 	PTR	sys_timerfd_create
 	PTR	compat_sys_timerfd_gettime
 	PTR	compat_sys_timerfd_settime
+	PTR     sys_revokeat            
 	PTR	compat_sys_signalfd4
 	PTR	sys_eventfd2			/* 4325 */
 	PTR	sys_epoll_create1
diff --git a/include/asm-mips/unistd.h b/include/asm-mips/unistd.h
index a73e153..e5fcb3a 100644
--- a/include/asm-mips/unistd.h
+++ b/include/asm-mips/unistd.h
@@ -966,16 +966,17 @@
 #define __NR_dup3			(__NR_Linux + 290)
 #define __NR_pipe2			(__NR_Linux + 291)
 #define __NR_inotify_init1		(__NR_Linux + 292)
+#define __NR_revokeat			(__NR_Linux + 293)
 
 /*
  * Offset of the last N32 flavoured syscall
  */
-#define __NR_Linux_syscalls		292
+#define __NR_Linux_syscalls		293
 
 #endif /* _MIPS_SIM == _MIPS_SIM_NABI32 */
 
 #define __NR_N32_Linux			6000
-#define __NR_N32_Linux_syscalls		292
+#define __NR_N32_Linux_syscalls		293
 
 #ifdef __KERNEL__
 
-- 
1.6.3.3

