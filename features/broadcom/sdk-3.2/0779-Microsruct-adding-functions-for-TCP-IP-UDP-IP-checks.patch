From fbce58e2e4a478916ac2386f25ef28a269058b9e Mon Sep 17 00:00:00 2001
From: Prasanna Mumbai <prasanna.mumbai@broadcom.com>
Date: Fri, 23 Aug 2013 16:48:04 +0530
Subject: [PATCH 0779/1532] Microsruct: adding functions for TCP/IP & UDP/IP
 checksum

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/netlib/include/netsoc_msg.h | 24 ++++++++++++++++++++++
 1 file changed, 24 insertions(+)

diff --git a/arch/mips/netlogic/lib/netlib/include/netsoc_msg.h b/arch/mips/netlogic/lib/netlib/include/netsoc_msg.h
index 2da2900..bfcf2af 100644
--- a/arch/mips/netlogic/lib/netlib/include/netsoc_msg.h
+++ b/arch/mips/netlogic/lib/netlib/include/netsoc_msg.h
@@ -634,6 +634,30 @@ static inline uint64_t nae_egop_udpcsum(uint32_t ip_fcoe_start, uint32_t l4_hdr_
                 ((uint64_t) (payload_off & MS_DESC0_PLOAD_OFF_MASK) << MS_DESC0_PLOAD_OFF_POS));
 }
 
+static inline uint64_t nae_egop_tcpipcsum(uint32_t ip_fcoe_start, uint32_t l4_hdr_start, uint32_t ip_csum_off, uint32_t pseudo_hdr_sum, uint32_t l4_csum_off, uint32_t payload_off)
+{
+        return (((uint64_t) DESC_TYPE_MSC << MS_DESC0_TYPE_POS) |
+                ((uint64_t) EGOP_IPCSUM_TCPCSUM << MS_DESC0_OPCODE_POS) |
+                ((uint64_t) (ip_fcoe_start & MS_DESC0_IPFCOE_START_MASK) << MS_DESC0_IPFCOE_START_POS) |
+                ((uint64_t) (l4_hdr_start & MS_DESC0_LAYER4_START_MASK) << MS_DESC0_LAYER4_START_POS) |
+                ((uint64_t) (ip_csum_off & MS_DESC0_IPCSUM_OFF_MASK) << MS_DESC0_IPCSUM_OFF_POS) |
+		((uint64_t) (pseudo_hdr_sum & MS_DESC0_PSDOHDRSUM_MASK) << MS_DESC0_PSDOHDRSUM_POS) |
+                ((uint64_t) (l4_csum_off & MS_DESC0_TCPUDPCSUM_OFF_MASK) << MS_DESC0_TCPUDPCSUM_OFF_POS) |
+                ((uint64_t) (payload_off & MS_DESC0_PLOAD_OFF_MASK) << MS_DESC0_PLOAD_OFF_POS));
+}
+
+static inline uint64_t nae_egop_udpipcsum(uint32_t ip_fcoe_start, uint32_t l4_hdr_start, uint32_t ip_csum_off, uint32_t pseudo_hdr_sum, uint32_t l4_csum_off, uint32_t payload_off)
+{
+        return (((uint64_t) DESC_TYPE_MSC << MS_DESC0_TYPE_POS) |
+                ((uint64_t) EGOP_IPCSUM_UDPCSUM << MS_DESC0_OPCODE_POS) |
+                ((uint64_t) (ip_fcoe_start & MS_DESC0_IPFCOE_START_MASK) << MS_DESC0_IPFCOE_START_POS) |
+                ((uint64_t) (l4_hdr_start & MS_DESC0_LAYER4_START_MASK) << MS_DESC0_LAYER4_START_POS) |
+                ((uint64_t) (ip_csum_off & MS_DESC0_IPCSUM_OFF_MASK) << MS_DESC0_IPCSUM_OFF_POS) |
+                ((uint64_t) (pseudo_hdr_sum & MS_DESC0_PSDOHDRSUM_MASK) << MS_DESC0_PSDOHDRSUM_POS) |
+                ((uint64_t) (l4_csum_off & MS_DESC0_TCPUDPCSUM_OFF_MASK) << MS_DESC0_TCPUDPCSUM_OFF_POS) |
+                ((uint64_t) (payload_off & MS_DESC0_PLOAD_OFF_MASK) << MS_DESC0_PLOAD_OFF_POS));
+}
+
 static inline uint64_t netv1_nae_fbid_desc(nae_desc_t type, uint32_t dest)
 {
 	return ((uint64_t) (type & TX_DESC_TYPE_MASK) << TX_DESC_TYPE_POS) |
-- 
1.9.1

