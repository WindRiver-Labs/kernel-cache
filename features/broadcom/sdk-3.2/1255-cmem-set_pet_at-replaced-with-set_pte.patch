From 1d2aff4bdf3a62204b69549984f1377d9277eb11 Mon Sep 17 00:00:00 2001
From: Hareesh R <hareeshr@broadcom.com>
Date: Wed, 26 Nov 2014 19:15:07 +0530
Subject: [PATCH 1255/1532] cmem : set_pet_at replaced with set_pte

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/misc/netlogic/cmem/cmem.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/drivers/misc/netlogic/cmem/cmem.c b/drivers/misc/netlogic/cmem/cmem.c
index 02a6f80..e9943e5 100644
--- a/drivers/misc/netlogic/cmem/cmem.c
+++ b/drivers/misc/netlogic/cmem/cmem.c
@@ -266,7 +266,8 @@ static int remap_pte_fn(pte_t *pte, struct page *pmd_page,
 	pval = pte_mkspecial(pfn_pte(pfn, prot));
 	
 	Message("%s addr %lx phys %llx\n", __FUNCTION__, addr, pfn << PAGE_SHIFT);
-	set_pte_at(current->mm, addr, pte, pval);
+	//set_pte_at(current->mm, addr, pte, pval);
+	set_pte(pte, pval);
 	args[0]++;
         return 0;
 }
@@ -275,7 +276,8 @@ static int unmap_pte_fn(pte_t *pte, struct page *pmd_page,
                         unsigned long addr, void *data)
 {
 	Message("%s addr %lx\n", __FUNCTION__, addr);
-	set_pte_at(current->mm, addr, pte, __pte(0));
+	//set_pte_at(current->mm, addr, pte, __pte(0));
+	set_pte(pte, __pte(0));
 	return 0;
 }
 
-- 
1.9.1

