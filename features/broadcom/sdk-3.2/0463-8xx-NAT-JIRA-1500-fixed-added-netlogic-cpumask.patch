From a2c237733c690f6de3f7826cd67a679e7146c38a Mon Sep 17 00:00:00 2001
From: Rahul Gupta <guptar@broadcom.com>
Date: Thu, 5 Dec 2013 17:51:17 +0530
Subject: [PATCH 0463/1532] 8xx NAT: JIRA 1500 fixed, added netlogic cpumask

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/boot/dts/xlp8xx-helinux-nat.dts     |  1 +
 arch/mips/boot/dts/xlp8xx-helinux-pcienet.dts | 15 ++++++++++++---
 2 files changed, 13 insertions(+), 3 deletions(-)

diff --git a/arch/mips/boot/dts/xlp8xx-helinux-nat.dts b/arch/mips/boot/dts/xlp8xx-helinux-nat.dts
index 36737f9..9ccd840 100644
--- a/arch/mips/boot/dts/xlp8xx-helinux-nat.dts
+++ b/arch/mips/boot/dts/xlp8xx-helinux-nat.dts
@@ -143,6 +143,7 @@
 	};
 
 	chosen {
+		netlogic,cpumask = <0xffffffff>;
 		bootargs = " console=ttyS0,115200 ";
 	};
 
diff --git a/arch/mips/boot/dts/xlp8xx-helinux-pcienet.dts b/arch/mips/boot/dts/xlp8xx-helinux-pcienet.dts
index d04fe6e..db64ee5 100644
--- a/arch/mips/boot/dts/xlp8xx-helinux-pcienet.dts
+++ b/arch/mips/boot/dts/xlp8xx-helinux-pcienet.dts
@@ -16,7 +16,15 @@
                         0 0x20000000 0 0x26000000>;
         };
 
-
+        pktmem {
+            device_type = "pktmem";
+             /* format: node number, 64-bit addr, 64-bit size */
+             reg = <0 0x0 0x50000000 0x0 0x20000000 // 512M @ 1.25GB
+                    1 0x0 0x0 0x0 0x0
+                    2 0x0 0x0 0x0 0x0
+                    3 0x0 0x0 0x0 0x0>;
+        };
+ 
 	hypervisor {
 		hypervisor-name = "Xen";
 		alloc_dom0_memory = <1>;
@@ -36,7 +44,7 @@
 
 			cpu {
 				onlinemask = <0xffff>;
-                		napi-vc-mask = <0x0>;
+                		napi-vc-mask = <0x8>;
 			};
 			uart {
 				id = <0>;
@@ -44,7 +52,7 @@
 				sharedcfg = <0x1f000000>;
 			};
 			fmn {
-           			node_0_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
+           			node_0_vc_mask = <0x88888888 0x88888888 0x88888888 0x88888888>;
 	           		node_1_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
         	   		node_2_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
            			node_3_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
@@ -103,6 +111,7 @@
 	};
 
 	chosen {
+        netlogic,cpumask = <0xffff>;
 		bootargs = " xlp_noi2c console=ttyS0,115200 autoboot_pciedrv";
 	};
 
-- 
1.9.1

