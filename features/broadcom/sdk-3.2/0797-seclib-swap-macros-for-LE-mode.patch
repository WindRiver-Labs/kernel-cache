From 5707f97fcfbc800dfe56824b2f70d5075e789464 Mon Sep 17 00:00:00 2001
From: Hareesh R <hareeshr@broadcom.com>
Date: Fri, 20 Sep 2013 18:46:58 +0530
Subject: [PATCH 0797/1532] seclib: swap macros for LE mode

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/seclib/cryptosoc_lib.h | 36 +++++++++++++++++++++++++++
 1 file changed, 36 insertions(+)

diff --git a/arch/mips/netlogic/lib/seclib/cryptosoc_lib.h b/arch/mips/netlogic/lib/seclib/cryptosoc_lib.h
index eb20318..8a20f1a 100644
--- a/arch/mips/netlogic/lib/seclib/cryptosoc_lib.h
+++ b/arch/mips/netlogic/lib/seclib/cryptosoc_lib.h
@@ -66,6 +66,42 @@ typedef  unsigned long long   _uint64_t;
 	#define cryptosoc_print(fmt, args...) printk(fmt, ##args)
 #endif
 
+#define crypto_swap64(x)   ( (unsigned long long)((x & 0x000000FF) << 56) | \
+		(unsigned long long)((x & 0x0000FF00) << 40) | \
+		(unsigned long long)((x & 0x00FF0000) << 24) | \
+		(unsigned long long)((x & 0xFF000000) <<  8) | \
+		((x & (unsigned long long)0xFF << 32) >>  8) | \
+		((x & (unsigned long long)0xFF << 40) >> 24) | \
+		((x & (unsigned long long)0xFF << 48) >> 40) | \
+		((x & (unsigned long long)0xFF << 56) >> 56)   \
+		)
+
+#define crypto_swap32(x) ((unsigned int)((x & 0x000000ff) << 24) | \
+		(unsigned int)((x & 0x0000ff00) <<  8) | \
+		(unsigned int)((x & 0x00ff0000) >>  8) | \
+		(unsigned int)((x & 0xff000000) >> 24) \
+		)
+
+#define crypto_swap16(x) ((unsigned short)((x & 0x00ff) << 8) | \
+			(unsigned short)((x & 0xff00) >> 8) \
+		)
+
+#if !defined(__MIPSEL__) && !defined(__MIPSEB__)
+	$(error ENDIANESS is not specified(__MIPSEL__ , __MIPSEB__))
+#endif
+
+#ifdef __MIPSEL__
+#define ccpu_to_be64(x) crypto_swap64(x)
+#define ccpu_to_be32(x) crypto_swap32(x)
+#define ccpu_to_be16(x) crypto_swap16(x)
+#else
+#define ccpu_to_be64(x) (x)
+#define ccpu_to_be32(x) (x)
+#define ccpu_to_be16(x) (x)
+#endif
+
+
+
 #ifndef CRYPTOSOC_DBG_EN
 #define cryptosoc_dbg_print(fmt, args...) { }
 #endif
-- 
1.9.1

