From 3b7029efcf71cec241c1277f20f7eefe304eeb75 Mon Sep 17 00:00:00 2001
From: Hareesh R <hareeshr@broadcom.com>
Date: Tue, 15 Jul 2014 12:27:49 +0530
Subject: [PATCH 0992/1532] seclib: Hmac bit should be set 0 for CMAC

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/seclib/saesoc_lib.h | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/arch/mips/netlogic/lib/seclib/saesoc_lib.h b/arch/mips/netlogic/lib/seclib/saesoc_lib.h
index 64900f9..14809e5 100644
--- a/arch/mips/netlogic/lib/seclib/saesoc_lib.h
+++ b/arch/mips/netlogic/lib/seclib/saesoc_lib.h
@@ -684,7 +684,8 @@ static inline int saesoc_new_session(
 			if ( (initp->hash.mode == SAESOC_HASH_MODE_XCBC) ||
 			  	(initp->hash.mode == SAESOC_HASH_MODE_GCM) ||
                                 (initp->hash.mode == SAESOC_HASH_MODE_CCM) ||
-				(initp->hash.mode == SAESOC_HASH_MODE_CBC))
+				(initp->hash.mode == SAESOC_HASH_MODE_CBC) || 
+				(initp->hash.mode == SAESOC_HASH_MODE_CMAC))
 			       hmac = 0;	
 			spriv->hash_en = 1;
 			spriv->addl_hash_len = initp->hash.addl_hash_len;
-- 
1.9.1

