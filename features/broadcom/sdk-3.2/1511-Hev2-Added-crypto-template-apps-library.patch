From 6a02351f983a2d9f9ff95abb2dc61e407239d5c0 Mon Sep 17 00:00:00 2001
From: Hareesh R <hareeshr@broadcom.com>
Date: Wed, 19 Jun 2013 17:34:48 +0530
Subject: [PATCH 1511/1532] Hev2: Added crypto template apps & library

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/crypto/sae/nlm_aead.c | 12 ++++++------
 drivers/crypto/sae/nlm_auth.c |  6 +++---
 2 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/drivers/crypto/sae/nlm_aead.c b/drivers/crypto/sae/nlm_aead.c
index f0f8ccd..a8a1506 100755
--- a/drivers/crypto/sae/nlm_aead.c
+++ b/drivers/crypto/sae/nlm_aead.c
@@ -308,7 +308,7 @@ static int xlp_aes_cbc_setkey( struct crypto_aead *tfm, uint8_t *key, unsigned i
 	initp->hash.key = auth_key;
 	initp->hash.key_len = auth_keylen;
 	initp->hash.mute_mask_sel = 0;
-	initp->hash.tag_len = saesoc_gen1_tag_len[hash_type];
+	initp->hash.tag_len = saesoc_gen1_tag_len[hash_type] / 8;
 	initp->hash.tagin_offset = 0;
 	initp->hash.aad_offset = 0;
 	initp->hash.addl_hash_len = 16; /* iv len */ 
@@ -383,7 +383,7 @@ static int  xlp_3des_setkey(struct crypto_aead *tfm, u8 *key, unsigned int keyle
 	initp->hash.key = auth_key;
 	initp->hash.key_len = auth_keylen;
 	initp->hash.mute_mask_sel = 0;
-	initp->hash.tag_len = saesoc_gen1_tag_len[hash_type];
+	initp->hash.tag_len = saesoc_gen1_tag_len[hash_type] / 8;
 	initp->hash.tagin_offset = 0;
 	initp->hash.aad_offset = 0;
 	initp->hash.addl_hash_len = 8; /* iv len */ 
@@ -459,7 +459,7 @@ static int xlp_des_setkey( struct crypto_aead *tfm, uint8_t  *key, unsigned int
 	initp->hash.key = auth_key;
 	initp->hash.key_len = auth_keylen;
 	initp->hash.mute_mask_sel = 0;
-	initp->hash.tag_len = saesoc_gen1_tag_len[hash_type];
+	initp->hash.tag_len = saesoc_gen1_tag_len[hash_type] / 8;
 	initp->hash.tagin_offset = 0;
 	initp->hash.aad_offset = 0;
 	initp->hash.addl_hash_len = 8; /* iv len */ 
@@ -535,7 +535,7 @@ static int aead_gcm_rfc4106_setkey( struct crypto_aead *tfm, const u8 *key,
 	initp->hash.key = (char *)key;
 	initp->hash.key_len = keylen;
 	initp->hash.mute_mask_sel = 0;
-	initp->hash.tag_len = 128;
+	initp->hash.tag_len = 128 / 8;
 	initp->hash.tagin_offset = 0;
 	initp->hash.aad_offset = 16; /* auth offset */
 	/* req->assoclen */
@@ -623,7 +623,7 @@ static int aead_ccm_rfc4309_setkey(struct crypto_aead *tfm, const u8 *key,
 	initp->hash.key = (char *)key;
 	initp->hash.key_len = cipher_keylen;
 	initp->hash.mute_mask_sel = 0;
-	initp->hash.tag_len = 128;
+	initp->hash.tag_len = 128 / 8;
 	initp->hash.tagin_offset = 0;
 	initp->hash.aad_offset = 16; /* auth offset */
 	initp->hash.addl_hash_len = 16; 
@@ -714,7 +714,7 @@ static int xlp_aes_ctr_setkey( struct crypto_aead *tfm, u8 *key,
 	initp->hash.key = auth_key;
 	initp->hash.key_len = auth_keylen;
 	initp->hash.mute_mask_sel = 0;
-	initp->hash.tag_len = saesoc_gen1_tag_len[hash_type];
+	initp->hash.tag_len = saesoc_gen1_tag_len[hash_type] / 8;
 	initp->hash.tagin_offset = 0;
 	initp->hash.aad_offset = CTR_RFC3686_BLOCK_SIZE;
 	initp->hash.addl_hash_len =  CTR_RFC3686_IV_SIZE; /* iv len */ 
diff --git a/drivers/crypto/sae/nlm_auth.c b/drivers/crypto/sae/nlm_auth.c
index 42ad496..6cc06b0 100644
--- a/drivers/crypto/sae/nlm_auth.c
+++ b/drivers/crypto/sae/nlm_auth.c
@@ -300,7 +300,7 @@ int hash_key(int type, int mode, const uint8_t * key, unsigned int keylen, uint8
 	initp.hash.key = NULL;
 	initp.hash.key_len = 0;
 	initp.hash.mute_mask_sel = 0;
-	initp.hash.tag_len = saesoc_gen1_tag_len[type]; 
+	initp.hash.tag_len = saesoc_gen1_tag_len[type] / 8; 
 	initp.hash.tagin_offset = 0;
 	initp.hash.aad_offset =0;
 	initp.hash.addl_hash_len = 0;
@@ -386,7 +386,7 @@ static int auth_setkey(struct crypto_ahash *tfm, const u8 * key, unsigned int ke
 	initp->hash.mode = 0;
 	initp->hash.iv_offset = 0;
 	initp->hash.mute_mask_sel = 0;
-	initp->hash.tag_len = saesoc_gen1_tag_len[type];
+	initp->hash.tag_len = saesoc_gen1_tag_len[type] / 8;
 	initp->hash.tagin_offset = 0;
 	initp->hash.aad_offset =0;
 	initp->hash.addl_hash_len = 0;
@@ -451,7 +451,7 @@ static int xlp_auth_aes_xcbc_setkey(struct crypto_ahash *tfm, const u8 * key, un
 	initp->hash.mode = SAESOC_HASH_MODE_XCBC;
 	initp->hash.iv_offset = 0;
 	initp->hash.mute_mask_sel = 0;
-	initp->hash.tag_len = saesoc_gen1_tag_len[hash_alg];
+	initp->hash.tag_len = saesoc_gen1_tag_len[hash_alg] / 8;
 	initp->hash.tagin_offset = 0;
 	initp->hash.aad_offset =0;
 	initp->hash.addl_hash_len = 0;
-- 
1.9.1

