From 9f47dbabcb1426d7066112d76c694ece01561d80 Mon Sep 17 00:00:00 2001
From: Lakshan Dias <ldias@broadcom.com>
Date: Mon, 4 Nov 2013 12:18:59 -0800
Subject: [PATCH 0834/1532] netlib: Removed indirect_pma_register_read/wite
 functions

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/netlib/include/netsoc_nae.h | 50 ++--------------------
 1 file changed, 3 insertions(+), 47 deletions(-)

diff --git a/arch/mips/netlogic/lib/netlib/include/netsoc_nae.h b/arch/mips/netlogic/lib/netlib/include/netsoc_nae.h
index 3a584f4..84a15e2 100644
--- a/arch/mips/netlogic/lib/netlib/include/netsoc_nae.h
+++ b/arch/mips/netlogic/lib/netlib/include/netsoc_nae.h
@@ -258,26 +258,6 @@ static inline uint32_t __netsoc_read_pma2p0_reg(uint64_t base, uint32_t lane_no,
     return (rd_data & 0xFF);
 }
 
-static inline uint32_t __netsoc_indirect_pma_register_read(nae_t *nae, int block, int lane_ctrl, int pma_reg_addr)
-{
-        uint32_t val = 0;
-	uint64_t mac_base = netsoc_get_macreg_base_for_phy(nae->mac_base, block);
-	int timeout = 10000;
-
-        val = netsoc_read_mac_reg(mac_base, lane_ctrl);
-        val |= (1<<30) | (1<<17) | (1<<16);
-        val = val | (pma_reg_addr<<8);
-        netsoc_write_mac_reg(mac_base, lane_ctrl, val);
-        while(--timeout){
-                val = netsoc_read_mac_reg(mac_base, lane_ctrl);
-                if(val & (1<<18))
-                        break;
-        }
-	if (!timeout)
-		nlm_print("\nERROR: __netsoc_indirect_pma_register_read failed \n");
-        return (val&0xff);
-}
-
 #ifdef PMA2P0_DEBUG
 static void __netsoc_display_pma2p0_indirect_reg(uint64_t base, int block)
 {
@@ -296,37 +276,13 @@ static void __netsoc_display_pma2p0_indirect_reg(uint64_t base, int block)
 }
 #endif
 
-static inline void __netsoc_indirect_pma_register_wite(nae_t *nae, int block, int lane_ctrl, int pma_reg_addr, int reg_val)
-{
-        uint32_t val = 0,i;
-	uint64_t mac_base = netsoc_get_macreg_base_for_phy(nae->mac_base, block);
-	int timeout = 10000;
-
-        val = netsoc_read_mac_reg(mac_base, lane_ctrl);
-        val |= (1<<30) | (1<<17);
-        val &= ~(1<<16);
-        val = (val & 0xffff0000) | ((pma_reg_addr & 0xff) << 8) | (reg_val & 0xff);
-
-        for (i=0; i<2; i++) {
-                netsoc_write_mac_reg(mac_base, lane_ctrl, val);
-                while(--timeout) {
-                        val = netsoc_read_mac_reg(mac_base, lane_ctrl);
-                        if(val & (1<<18))
-                        break;
-                }
-		if (!timeout)
-	                nlm_print("\nERROR: __netsoc_indirect_pma_register_wite failed \n");
-		timeout = 10000;
-        }
-}
-
 static inline void __netsoc_set_bit2_pm_fifo (nae_t *nae, int block, int lane_ctrl)
 {
         uint32_t val = 0;
-        val = __netsoc_indirect_pma_register_read(nae,  block, lane_ctrl, 0xE);
+        val = __netsoc_read_pma_reg(nae,  block, lane_ctrl, 0xE);
         val |= (1<<2);
-        __netsoc_indirect_pma_register_wite(nae,  block, lane_ctrl, 0xE, val);
-        val = __netsoc_indirect_pma_register_read(nae,  block, lane_ctrl, 0xE);
+        __netsoc_write_pma_reg(nae,  block, lane_ctrl, 0xE, val);
+        val = __netsoc_read_pma_reg(nae,  block, lane_ctrl, 0xE);
 }
 
 static inline void __netsoc_write_ucore_sprayvec(nae_t *nae, int hw_port_id, uint32_t spray_vec)
-- 
1.9.1

