From 7526dbac831d91cf5db181b1c1a1f64266598a50 Mon Sep 17 00:00:00 2001
From: Quanyang Wang <quanyang.wang@windriver.com>
Date: Thu, 12 Feb 2015 23:30:04 +0800
Subject: [PATCH 1475/1532] Add Netlogic NAE compile support

The NAE makefile is picked from the path "buildroot/output/build/linux-userspace/kmod/nae"
in the SDK 3.2

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/net/ethernet/broadcom/Kconfig      |  9 +++++++++
 drivers/net/ethernet/broadcom/Makefile     |  1 +
 drivers/net/ethernet/broadcom/nae/Makefile | 23 +++++++++++++++++++++++
 3 files changed, 33 insertions(+)
 create mode 100644 drivers/net/ethernet/broadcom/nae/Makefile

diff --git a/drivers/net/ethernet/broadcom/Kconfig b/drivers/net/ethernet/broadcom/Kconfig
index 3e69b3f..910a922 100644
--- a/drivers/net/ethernet/broadcom/Kconfig
+++ b/drivers/net/ethernet/broadcom/Kconfig
@@ -16,6 +16,15 @@ config NET_VENDOR_BROADCOM
 	  the questions regarding AMD chipsets. If you say Y, you will be asked
 	  for your specific chipset/driver in the following questions.
 
+config XLP_NAE_SUPPORT
+	tristate "Enable Netlogic XLP NAE support"
+	depends on NLM_XLP_BOARD
+	default y
+	help
+	 This option enables XLP Network Acceleration engine support.
+	 For more information on xlp NAE driver, please visit
+	 <http://support.broadcom.com>
+
 if NET_VENDOR_BROADCOM
 
 config B44
diff --git a/drivers/net/ethernet/broadcom/Makefile b/drivers/net/ethernet/broadcom/Makefile
index 68efa1a..0b96e94 100644
--- a/drivers/net/ethernet/broadcom/Makefile
+++ b/drivers/net/ethernet/broadcom/Makefile
@@ -10,3 +10,4 @@ obj-$(CONFIG_BNX2X) += bnx2x/
 obj-$(CONFIG_SB1250_MAC) += sb1250-mac.o
 obj-$(CONFIG_TIGON3) += tg3.o
 obj-$(CONFIG_BGMAC) += bgmac.o
+obj-$(CONFIG_XLP_NAE_SUPPORT) += nae/
diff --git a/drivers/net/ethernet/broadcom/nae/Makefile b/drivers/net/ethernet/broadcom/nae/Makefile
new file mode 100644
index 0000000..1c35b61
--- /dev/null
+++ b/drivers/net/ethernet/broadcom/nae/Makefile
@@ -0,0 +1,23 @@
+################################################################################
+#
+# Makefile for xlp_nae network driver
+#
+
+ccflags-y := -DCONFIG_XLP_FMN_SUPPORT -DNLM_HAL_LINUX_KERNEL
+ccflags-y += -DCONFIG_NLM_ENABLE_LOAD_BALANCING -Wno-format -Wno-unused-function
+ccflags-y += -Iarch/mips/netlogic/lib/syslib/include
+ccflags-y += -Iarch/mips/netlogic/lib/fmnlib
+ccflags-y += -Iarch/mips/netlogic/lib/netlib/include
+ccflags-y += -Iarch/mips/netlogic/boot
+
+obj-$(CONFIG_XLP_NAE_SUPPORT)   += nae.o
+nae-objs        := xlpge_main.o
+nae-objs        += xlpge_nae.o
+nae-objs        += xlpge_eeprom.o
+nae-objs        += xlpge_board.o
+nae-objs        += xlpge_ethtool.o
+nae-objs        += xlpge_proc.o
+nae-objs        += xlpge_rx.o
+nae-objs        += xlpge_sgmii.o
+nae-objs        += xlpge_tx.o
+nae-objs        += xlpge_msec.o
-- 
1.9.1

