From cbc67a3b2ee5b6858dca3ec180ad4640ed588d7f Mon Sep 17 00:00:00 2001
From: Kamlakant Patel <kamlakant.patel@broadcom.com>
Date: Thu, 10 Jul 2014 10:31:13 +0530
Subject: [PATCH 0556/1532] nand: add support for multiple nand chips

add support for xlp9xx/5xx nand.
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/boot/dts/xlp5xx-linux-tmpl.dts | 32 +++++++++++++++++++-------------
 arch/mips/boot/dts/xlp9xx-linux-tmpl.dts | 32 +++++++++++++++++++-------------
 2 files changed, 38 insertions(+), 26 deletions(-)

diff --git a/arch/mips/boot/dts/xlp5xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp5xx-linux-tmpl.dts
index 7e52685..b44eef3 100644
--- a/arch/mips/boot/dts/xlp5xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp5xx-linux-tmpl.dts
@@ -150,27 +150,33 @@
 			};
 		};
 
-		nand_flash@0,0 {
+		nand_flash@139000 {
 			compatible = "brcm,xlp9xx-nand";
 			#address-cells = <1>;
-			#size-cells = <1>;
+			#size-cells = <0>;
 			reg = <0 0x139000 0x1000>;
 
 			nand-ecc-mode = "hw";
 
-			partition@0 {
-				label = "firmware";
-				reg = <0x0 0x20000000>;
-			};
+			nand_cs1 {
+				#address-cells = <1>;
+				#size-cells = <1>;
+				reg = <1>;
 
-			partition@1 {
-				label = "kernel";
-				reg = <0x20000000 0x20000000>;
-			};
+				partition@0 {
+					label = "firmware";
+					reg = <0x0 0x20000000>;
+				};
+
+				partition@1 {
+					label = "kernel";
+					reg = <0x20000000 0x20000000>;
+				};
 
-			partition@2 {
-				label = "user";
-				reg = <0x40000000 0x0>;
+				partition@2 {
+					label = "user";
+					reg = <0x40000000 0x0>;
+				};
 			};
 		};
 
diff --git a/arch/mips/boot/dts/xlp9xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp9xx-linux-tmpl.dts
index c219946..0f331c6 100644
--- a/arch/mips/boot/dts/xlp9xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp9xx-linux-tmpl.dts
@@ -156,27 +156,33 @@
 			};
 		};
 
-		nand_flash@0,0 {
+		nand_flash@139000 {
 			compatible = "brcm,xlp9xx-nand";
 			#address-cells = <1>;
-			#size-cells = <1>;
+			#size-cells = <0>;
 			reg = <0 0x139000 0x1000>;
 
 			nand-ecc-mode = "hw";
 
-			partition@0 {
-				label = "firmware";
-				reg = <0x0 0x20000000>;
-			};
+			nand_cs1 {
+				#address-cells = <1>;
+				#size-cells = <1>;
+				reg = <1>;
 
-			partition@1 {
-				label = "kernel";
-				reg = <0x20000000 0x20000000>;
-			};
+				partition@0 {
+					label = "firmware";
+					reg = <0x0 0x20000000>;
+				};
+
+				partition@1 {
+					label = "kernel";
+					reg = <0x20000000 0x20000000>;
+				};
 
-			partition@2 {
-				label = "user";
-				reg = <0x40000000 0x0>;
+				partition@2 {
+					label = "user";
+					reg = <0x40000000 0x0>;
+				};
 			};
 		};
 
-- 
1.9.1

