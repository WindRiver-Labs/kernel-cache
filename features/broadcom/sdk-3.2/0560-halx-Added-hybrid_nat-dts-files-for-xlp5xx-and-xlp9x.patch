From f8dcf7104bfba5fc35f5cceed8d7e2f583864466 Mon Sep 17 00:00:00 2001
From: Saswat Kumar Dash <saswat.dash@broadcom.com>
Date: Tue, 22 Jul 2014 02:04:40 -0700
Subject: [PATCH 0560/1532] halx: Added hybrid_nat dts files for xlp5xx and
 xlp9xx (root and guest)

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 .../boot/dts/xlp5xx-hybrid-nat-helinux-guest.dts   | 106 +++++++
 arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux.dts   | 284 ++++++++++++++++++
 .../boot/dts/xlp9xx-hybrid-nat-helinux-guest.dts   | 125 ++++++++
 arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux.dts   | 323 +++++++++++++++++++++
 4 files changed, 838 insertions(+)
 create mode 100644 arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux-guest.dts
 create mode 100644 arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux.dts
 create mode 100644 arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux-guest.dts
 create mode 100644 arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux.dts

diff --git a/arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux-guest.dts b/arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux-guest.dts
new file mode 100644
index 0000000..334956d
--- /dev/null
+++ b/arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux-guest.dts
@@ -0,0 +1,106 @@
+/* XLP5XX Device Tree Source
+ *
+ */
+
+/dts-v1/;
+/ {
+	model = "netlogic,XLP-GVP";
+	compatible = "netlogic,xlp";
+	#address-cells = <2>;
+	#size-cells = <2>;
+
+	memory {
+		device_type = "memory";
+		reg =  <0x0 0x1000000  0x0 0xb000000     /* 16M - 16+176M */
+			0x1 0x0        0x0 0xc0000000>;  /* 4096M - 4096M+3072M */
+
+	};
+	/* memory range for HEv2 pkt mem. Only one contig memory per node supported */
+	/* size 0 will be ignored. */
+	pktmem {
+		device_type = "pktmem";
+
+		/* format: node number, 64-bit addr, 64-bit size */
+		reg = <0 0x0 0xc0000000 0x0 0x10000000
+			1 0x0 0x0 0x0 0x0
+			2 0x0 0x0 0x0 0x0
+			3 0x0 0x0 0x0 0x0>;
+	};
+
+	doms {
+		#address-cells = <1>;
+		#size-cells = <1>;
+
+		/* dom@0 is used when this dtb is actually used at root,
+		 * at guest, the device has been initialized by root so dom@0 is not used.
+		 */
+		dom@0 {
+			device_type = "domain";
+			os = "linux";
+
+			fmn {
+				node_0_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_1_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_2_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_3_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+			};
+			dtre {
+				dtre_init_only = <0>;
+			};
+			owner-config {
+				fmn = <0x1>;
+			};
+			resource-allocation {
+				net@0 {
+					port-mask = <0x4 0 0 0>;
+					frinlifo-mask = <0xffff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x1 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+			};
+		};
+
+		dom@1 {
+			device_type = "domain";
+			os = "linux";
+
+			cpu {
+				dtre-rx-vc = <2>;
+			};
+
+			app-param {
+				onlinemask = <0xffffffff>;
+			};
+
+			resource-allocation {
+				net@0 {
+					port-mask = <0x3 0 0 0>;
+					frinlifo-mask = <0xff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x2 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+			};
+		};
+	};
+
+	chosen {
+		netlogic,cpumask = <0xffffffff>;
+		bootargs = " console=ttyS0,115200  rhash_entries=1048576";
+		linux,initrd-start=<0x0>;
+		linux,initrd-end=<0x0>;
+	};
+
+	soc {
+		nodes {
+			num-nodes = <1>;
+		};
+
+	};
+};
+
diff --git a/arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux.dts b/arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux.dts
new file mode 100644
index 0000000..c9ec98b
--- /dev/null
+++ b/arch/mips/boot/dts/xlp5xx-hybrid-nat-helinux.dts
@@ -0,0 +1,284 @@
+/* XLP5XX Device Tree Source
+ *
+ */
+
+/dts-v1/;
+/ {
+	model = "netlogic,XLP-GVP";
+	compatible = "netlogic,xlp";
+
+	#address-cells = <2>;
+	#size-cells = <2>;
+
+	memory {
+                device_type = "memory";
+                reg =  <0x0 0x0000000  0x0 0xb000000     /* 0M - 176M */
+                        0x1 0x0        0x1 0x00000000>;  /*   4096M - 4096+4096M */
+
+        };
+
+        /* memory range for HEv2 pkt mem. Only one contig memory per node supported */
+	pktmem {
+		device_type = "pktmem";
+
+		/* format: node number, 64-bit addr, 64-bit size */
+		reg =  <0 0x0 0x20000000 0x0 0x20000000             /* 512M - 512+512M */
+			1 0x0 0x0 0x0 0x0
+			2 0x0 0x0 0x0 0x0
+			3 0x0 0x0 0x0 0x0>;
+	};
+
+	hypervisor {
+		hypervisor-name = "KVM";
+		guest_use_dtre = <1>;
+	};
+
+	doms {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		dom@0 {
+			device_type = "domain";
+			os = "linux";
+
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			cpu {
+				onlinemask = <0xffffffff>;
+				nae-rx-vc = <0>;
+				nae-fb-vc = <1>;
+				napi-vc-mask = <0x3>;
+			};
+
+			uart {
+				id = <0>;
+				owner = <1>;
+				sharedcfg = <0x1f000000>;
+			};
+
+			fmn {
+				node_0_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_1_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_2_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_3_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_4_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_5_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_6_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_7_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+			};
+
+			nae-0 {
+				sh-domains = <1>;
+				freein-fifo-mask = <0xff00 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <80 32 32 80>;
+				/* hw entries */
+				vfbtbl-hw-offset = <80 32 32 80>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+			};
+
+			owner-config {
+				nae = <0x1>;
+				sae = <0x1>;
+				rsa = <0x1>;
+				fmn = <0x1>;
+			};
+
+			resource-allocation {
+				net@0 {
+					port-mask = <0x4 0 0 0>;
+					frinlifo-mask = <0xffff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x1 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+			};
+		};
+
+		dom@1 {
+			device_type = "domain";
+			os = "uspace";
+
+			heap-size = <0x0 0x8000000>; // 128M
+			shared-mem =  <0x0 0xe0000000 0x1 0x00000000>; // 4GB @ 3.5GB
+
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			app-bootcmd = "smpload";
+			app-loadaddr = "0xf0000000"; // 3.75GB
+
+			kernel {
+				/* Kernel Memory allocated from xen domain-heap */
+				size = <0x02000000>;  // 32M
+
+				/* Domain destroy currently doesn't work with hyperexec */
+				dom_destroy_hack = <0>;
+			};
+
+			cpu {
+				onlinemask = <0xffffffff>;
+                                nae-rx-vc = <2>;
+                                nae-fb-vc = <3>;
+				dtre-rx-vc = <2>;
+				lzs-vc = <2>;
+				sae-rx-vc = <0>; /* sharing with nae */
+				sae-rx-sync-vc = <0>;  /* sharing with nae */
+				/* helinux, as only 1 thread per cpu, it should poll for both nae and sae
+				   responses. Also there is no other vc as linux is using other 2 vcs */
+                                /* Setting this to '1' makes NAE driver to skip buf alloction and initial
+                                   sending of packet buffers*/
+                                nae-buf-alloc-by-app = <1>;
+			};
+
+			uart {
+				id = <0>;
+			};
+
+			app-param{
+				onlinemask = <0xffffffff>;
+				enable-nae-hw-parser = <0>;
+				enable-nae-jumbo = <0>;
+				enable-nae-p2p = <0>;
+			};
+
+			nae-0 {
+				sh-domains = <0>;
+				freein-fifo-mask = <0x00ff 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <80 32 32 80>;
+				/* hw entries */
+				vfbtbl-hw-offset = <80 32 32 80>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
+			};
+
+			owner-config {
+				nae = <0x0>;   // currently for node 0
+				sae = <0x0>;
+				rsa = <0x0>;
+				fmn = <0x1>;
+			};
+
+			resource-allocation {
+				net@0 {
+					port-mask = <0x3 0 0 0>;
+					frinlifo-mask = <0xff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x2 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+			};
+
+			fmn {
+				node_0_vc_mask = <0xcccccccc 0xcccccccc 0xcccccccc 0xcccccccc>;
+				node_1_vc_mask = <0xcccccccc 0xcccccccc 0xcccccccc 0xcccccccc>;
+				node_2_vc_mask = <0xcccccccc 0xcccccccc 0xcccccccc 0xcccccccc>;
+				node_3_vc_mask = <0xcccccccc 0xcccccccc 0xcccccccc 0xcccccccc>;
+            		};
+		};
+
+		dom@2 {
+			device_type = "domain";
+			os = "uspace";
+
+			heap-size = <0x0 0x8000000>; // 128M
+
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			app-bootcmd = "smpload";
+			app-loadaddr = "0xf0000000"; // 3.75GB
+
+			kernel {
+				/* Kernel Memory allocated from xen domain-heap */
+				size = <0x02000000>;  // 32M
+
+
+				/* Domain destroy currently doesn't work with hyperexec */
+				dom_destroy_hack = <0>;
+			};
+
+			cpu {
+				onlinemask = <0x000f>;
+                                nae-rx-vc = <0>;
+                                nae-fb-vc = <3>;
+                                /* Setting this to '1' makes NAE driver to skip buf alloction and initial
+                                   sending of packet buffers*/
+                                nae-buf-alloc-by-app = <1>;
+			};
+			uart {
+				id = <0>;
+			};
+			memory {
+				reg = <0xE0000000 0x60000000>;  // 1.5Gb @ 3584Mb
+			};
+			app-param{
+				onlinemask = <0x000f>;
+			};
+			nae{
+			};
+			owner-config {
+				nae = <0x0>;
+				sae = <0x1>;
+				rsa = <0x1>;
+				fmn = <0x1>;
+			};
+
+                        fmn {
+                                node_0_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
+                                node_1_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
+                                node_2_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
+                                node_3_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
+                        };
+		};
+	};
+
+	chosen {
+		/* examples for different core/thread models.
+		 * 16core: netlogic,cpumask=<0xffffffff 0xffffffff>
+		 * 20core: netlogic,cpumask=<0xffff 0xffffffff 0xffffffff>
+		 * 15 core, skipping core #5: netlogic,cpumask=<0xffffffff 0xff0fffff>
+		 */
+		netlogic,cpumask = <0xffffffff>;
+		bootargs = " console=ttyS0,115200  ";
+		/* linux,initrd-start=<0x00c00000>;
+		   linux,initrd-end=<0x02c00000>; */
+	};
+
+	/* These binaries are downloaded at the resp physical memory locations
+	 * by their corresponding bootstrapping loaders. For example,
+	 * u-boot is loaded by x-load at 193M, sysconfig is loaded by u-boot
+	 * at 1M, hypervisor by u-boot hypervisor at 136M.
+	 * On simulator all these binaries are pre-loaded by using '-F' option
+	 * for convenience. On silicon, they will be loaded by their corresponding
+	 * temporary download locations the stage-1/stage-2 firmware
+	 */
+	firmware-download {
+		u-boot        = <0x0c100000 0x3f00000>;  /* 63M @ 193M */
+		sysconfig     = <0x00100000 0x00100000>; /* 1M @ 1M */
+		hypervisor    = <0x08800000 0x00800000>; /* 8M @ 136M */
+		dom0          = <0x09000000 0x03000000>; /* 48M @ 144M */
+		domU-ramdisk  = <0x60000000 0x60800000>; /* 8M @ 1536M */
+	};
+
+	soc {
+		nodes {
+			num-nodes = <1>;
+		};
+
+	};
+	frequency-config {
+		nae = <500>;
+		sae = <250>;
+		rsa = <667>;
+		dtre = <250>;
+		cde = <250>;
+	};
+};
diff --git a/arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux-guest.dts b/arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux-guest.dts
new file mode 100644
index 0000000..9cf35e1
--- /dev/null
+++ b/arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux-guest.dts
@@ -0,0 +1,125 @@
+/* XLP9XX Device Tree Source
+ *
+ */
+
+/dts-v1/;
+/ {
+	model = "netlogic,XLP-GVP";
+	compatible = "netlogic,xlp";
+	#address-cells = <2>;
+	#size-cells = <2>;
+
+	memory {
+		device_type = "memory";
+		reg =  <0x0 0x1000000  0x0 0xb000000     /* 16M - 16+176M */
+			0x1 0x0        0x0 0xc0000000>;  /*   4096M - 4096M + 3072M */
+
+	};
+	/* memory range for HEv2 pkt mem. Only one contig memory per node supported */
+	/* size 0 will be ignored. */
+	pktmem {
+		device_type = "pktmem";
+
+		/* format: node number, 64-bit addr, 64-bit size */
+		reg = <0 0x0 0xc0000000 0x0 0x20000000
+			1 0x0 0x0 0x0 0x0
+			2 0x0 0x0 0x0 0x0
+			3 0x0 0x0 0x0 0x0>;
+	};
+
+	doms {
+		#address-cells = <1>;
+		#size-cells = <1>;
+
+		/* dom@0 is used when this dtb is actually used at root,
+		 * at guest, the device has been initialized by root so dom@0 is not used.
+		 */
+		dom@0 {
+			device_type = "domain";
+			os = "linux";
+
+			fmn {
+				node_0_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_1_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_2_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+				node_3_vc_mask = <0x22222222 0x22222222 0x22222222 0x22222222>;
+			};
+			dtre {
+				dtre_init_only = <0>;
+			};
+			owner-config {
+				fmn = <0x1>;
+			};
+			resource-allocation {
+				net@0 {
+					port-mask = <0x4 0 0 0>;
+					frinlifo-mask = <0xffff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x1 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+				net@1 {
+					port-mask = <0x4 0 0 0>;
+					frinlifo-mask = <0xffff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <80 80 80 80>;
+
+					ucore-mask = <0x1 0 0 0>;
+					sram-off = <0 0 0 0>;
+				}; 
+			};
+
+		};
+
+		dom@1 {
+			device_type = "domain";
+			os = "linux";
+
+			cpu {
+				dtre-rx-vc = <2>;
+			};
+			app-param {
+				onlinemask = <0xffffffff>;
+			};
+
+			resource-allocation {
+				net@0 {
+					port-mask = <0x3 0 0 0>;
+					frinlifo-mask = <0xff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x2 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+				net@1 {
+					port-mask = <0x3 0 0 0>;
+					frinlifo-mask = <0x00ff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x2 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+
+			};
+		};
+	};
+
+	chosen {
+		netlogic,cpumask = <0xffffffff>;
+		bootargs = " console=ttyS0,115200  rhash_entries=1048576";
+		linux,initrd-start=<0x0>;
+		linux,initrd-end=<0x0>;
+	};
+
+	soc {
+		nodes {
+			num-nodes = <1>;
+		};
+
+	};
+};
diff --git a/arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux.dts b/arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux.dts
new file mode 100644
index 0000000..df1ddcf
--- /dev/null
+++ b/arch/mips/boot/dts/xlp9xx-hybrid-nat-helinux.dts
@@ -0,0 +1,323 @@
+/* XLP9XX Device Tree Source
+ *
+ */
+
+/dts-v1/;
+/ {
+	model = "netlogic,XLP-GVP";
+	compatible = "netlogic,xlp";
+
+	#address-cells = <2>;
+	#size-cells = <2>;
+
+	memory {
+                device_type = "memory";
+                reg =  <0x0 0x0000000  0x0 0xb000000        /* 0M - 176M */
+                        0x1 0x0        0x1 0x80000000>;     /* 4096M - 4096+6144M */
+
+        };
+
+        /* memory range for HEv2 pkt mem. Only one contig memory per node supported */
+	pktmem {
+		device_type = "pktmem";
+
+		/* format: node number, 64-bit addr, 64-bit size */
+        	reg = <	0 0x0 0x20000000 0x0 0x20000000             /* 512M - 512+512M */
+			1 0x0 0x0 0x0 0x0
+			2 0x0 0x0 0x0 0x0
+			3 0x0 0x0 0x0 0x0>;
+	};
+
+	hypervisor {
+		hypervisor-name = "KVM";
+		guest_use_dtre = <1>;
+	};
+
+	doms {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		dom@0 {
+			device_type = "domain";
+			os = "linux";
+
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			cpu {
+				/*onlinemask = <0xffffffff>;*/
+				onlinemask = <0x0 0xffffffff 0xffffffff>;
+                		nae-rx-vc = <0>;
+                		nae-fb-vc = <1>;
+                		napi-vc-mask = <0x3>;
+			};
+			uart {
+				id = <0>;
+				owner = <1>;
+				sharedcfg = <0x1f000000>;
+			};
+			fmn {
+				node_0_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_1_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_2_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_3_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_4_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_5_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_6_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+				node_7_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333 0x33333333>;
+			};
+
+			nae-0 {
+				sh-domains = <1>;
+				freein-fifo-mask = <0xff00 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <80 32 32 80>;
+				/* hw entries */
+				vfbtbl-hw-offset = <80 32 32 80>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+			};
+
+			nae-1 {
+				sh-domains = <1>;
+				freein-fifo-mask = <0xff00 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <80 80 80 80>;
+				/* hw entries */
+				vfbtbl-hw-offset = <80 80 80 80>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+			};
+
+			owner-config {
+				nae = <0x1>;
+				sae = <0x1>;
+				rsa = <0x1>;
+				fmn = <0x1>;
+			};
+
+			resource-allocation {
+				net@0 {
+					port-mask = <0x4 0 0 0>;
+					frinlifo-mask = <0xffff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <80 80 80 80>;
+					ucore-mask = <0x1 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+
+				net@1 {
+					port-mask = <0x4 0 0 0>;
+					frinlifo-mask = <0xffff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <80 80 80 80>;
+					ucore-mask = <0x1 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+			};
+		};
+
+		dom@1 {
+			device_type = "domain";
+			os = "uspace";
+
+			heap-size = <0x0 0x8000000>; // 128M
+			shared-mem =  <0x0 0xe0000000 0x1 0x00000000>; // 4GB @ 3.5GB
+
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			app-bootcmd = "smpload";
+			app-loadaddr = "0xf0000000"; // 3.75GB
+
+			kernel {
+				/* Kernel Memory allocated from xen domain-heap */
+				size = <0x02000000>;  // 32M
+
+				/* Domain destroy currently doesn't work with hyperexec */
+				dom_destroy_hack = <0>;
+			};
+
+			cpu {
+				/*onlinemask = <0xffffffff>;*/
+				onlinemask = <0x0 0xffffffff 0xffffffff>;
+                                nae-rx-vc = <2>;
+                                nae-fb-vc = <3>;
+				/* helinux, as only 1 thread per cpu, it should poll for both nae and sae
+				   responses. Also there is no other vc as linux is using other 2 vcs */
+                                /* Setting this to '1' makes NAE driver to skip buf alloction and initial
+                                   sending of packet buffers*/
+                                nae-buf-alloc-by-app = <1>;
+			};
+
+			uart {
+				id = <0>;
+			};
+
+			app-param{
+				/*onlinemask = <0x0 0x0 0xffffffff>;*/
+				onlinemask = <0xffffffff 0xffffffff>;
+				enable-nae-hw-parser = <0>;
+				enable-nae-jumbo = <0>;
+				enable-nae-p2p = <0>;
+			};
+
+			nae-0 {
+				sh-domains = <0>;
+				freein-fifo-mask = <0x00ff 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <80 32 32 80>;
+				/* hw entries */
+				vfbtbl-hw-offset = <80 32 32 80>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
+			};
+
+			nae-1 {
+				sh-domains = <0>;
+				freein-fifo-mask = <0x00ff 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <80 80 80 80>;
+				/* hw entries */
+				vfbtbl-hw-offset = <80 80 80 80>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
+			};
+
+			owner-config {
+				nae = <0x0>;   // currently for node 0
+				sae = <0x0>;
+				rsa = <0x0>;
+				fmn = <0x1>;
+			};
+
+			resource-allocation {
+				net@0 {
+					port-mask = <0x3 0 0 0>;
+					frinlifo-mask = <0x00ff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x2 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+
+				net@1 {
+					port-mask = <0x3 0 0 0>;
+					frinlifo-mask = <0x00ff 0 0 0>;
+					frinlifo-shared-mode = <0 0 0 0>;
+					vfbid-sw-offset = <0 0 0 0>;
+					vfbid-sw-entries = <0 0 0 0>;
+					ucore-mask = <0x2 0 0 0>;
+					sram-off = <0 0 0 0>;
+				};
+			};
+
+            		fmn {
+                		node_0_vc_mask = <0xcccccccc 0xcccccccc 0xcccccccc 0xcccccccc>;
+                		node_1_vc_mask = <0xcccccccc 0xcccccccc 0xcccccccc 0xcccccccc>;
+		                node_2_vc_mask = <0xcccccccc 0xcccccccc 0xcccccccc 0xcccccccc>;
+                		node_3_vc_mask = <0xcccccccc 0xcccccccc 0xcccccccc 0xcccccccc>;
+            		};
+		};
+
+		dom@2 {
+			device_type = "domain";
+			os = "uspace";
+
+			heap-size = <0x0 0x8000000>; // 128M
+
+			#address-cells = <1>;
+			#size-cells = <1>;
+
+			app-bootcmd = "smpload";
+			app-loadaddr = "0xf0000000"; // 3.75GB
+
+			kernel {
+				/* Kernel Memory allocated from xen domain-heap */
+				size = <0x02000000>;  // 32M
+
+
+				/* Domain destroy currently doesn't work with hyperexec */
+				dom_destroy_hack = <0>;
+			};
+
+			cpu {
+				onlinemask = <0x000f>;
+                                nae-rx-vc = <0>;
+                                nae-fb-vc = <3>;
+                                /* Setting this to '1' makes NAE driver to skip buf alloction and initial
+                                   sending of packet buffers*/
+                                nae-buf-alloc-by-app = <1>;
+			};
+			uart {
+				id = <0>;
+			};
+			memory {
+				reg = <0xE0000000 0x60000000>;  // 1.5Gb @ 3584Mb
+			};
+			app-param{
+				onlinemask = <0x000f>;
+			};
+			nae{
+			};
+			owner-config {
+				nae = <0x0>;
+				sae = <0x1>;
+				rsa = <0x1>;
+				fmn = <0x1>;
+			};
+
+                        fmn {
+                                node_0_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
+                                node_1_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
+                                node_2_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
+                                node_3_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
+                        };
+		};
+	};
+
+	chosen {
+		/* examples for different core/thread models.
+		 * 16core: netlogic,cpumask=<0xffffffff 0xffffffff>
+		 * 20core: netlogic,cpumask=<0xffff 0xffffffff 0xffffffff>
+		 * 15 core, skipping core #5: netlogic,cpumask=<0xffffffff 0xff0fffff>
+		 */
+		/*netlogic,cpumask = <0xffffffff>;*/
+        	netlogic,cpumask = <0x0 0xffffffff 0xffffffff>;
+		bootargs = " console=ttyS0,115200  ";
+		/* linux,initrd-start=<0x00c00000>;
+		   linux,initrd-end=<0x02c00000>; */
+	};
+
+	/* These binaries are downloaded at the resp physical memory locations
+	 * by their corresponding bootstrapping loaders. For example,
+	 * u-boot is loaded by x-load at 193M, sysconfig is loaded by u-boot
+	 * at 1M, hypervisor by u-boot hypervisor at 136M.
+	 * On simulator all these binaries are pre-loaded by using '-F' option
+	 * for convenience. On silicon, they will be loaded by their corresponding
+	 * temporary download locations the stage-1/stage-2 firmware
+	 */
+	firmware-download {
+		u-boot        = <0x0c100000 0x3f00000>;  /* 63M @ 193M */
+		sysconfig     = <0x00100000 0x00100000>; /* 1M @ 1M */
+		hypervisor    = <0x08800000 0x00800000>; /* 8M @ 136M */
+		dom0          = <0x09000000 0x03000000>; /* 48M @ 144M */
+		domU-ramdisk  = <0x60000000 0x60800000>; /* 8M @ 1536M */
+	};
+
+	soc {
+	};
+
+	frequency-config {
+		nae = <500>;
+		sae = <250>;
+		rsa = <667>;
+		dtre = <250>;
+		cde = <250>;
+	};
+};
+
-- 
1.9.1

