From e01f086c9688693fde245c2393a78613b7814a71 Mon Sep 17 00:00:00 2001
From: Hareesh R <hareesh@netlogicmicro.com>
Date: Wed, 7 Dec 2011 12:04:58 +0530
Subject: [PATCH 1526/1532] Integrated the cryptolib with prev library

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/seclib/nlmcrypto_ifc.h | 26 ++++----------------------
 1 file changed, 4 insertions(+), 22 deletions(-)

diff --git a/arch/mips/netlogic/lib/seclib/nlmcrypto_ifc.h b/arch/mips/netlogic/lib/seclib/nlmcrypto_ifc.h
index 7c6edef..c552bb3 100644
--- a/arch/mips/netlogic/lib/seclib/nlmcrypto_ifc.h
+++ b/arch/mips/netlogic/lib/seclib/nlmcrypto_ifc.h
@@ -33,6 +33,8 @@
 extern void *linuxu_shvaddr;
 extern unsigned long long linuxu_shoff;
 extern unsigned long long linuxu_shsize;
+extern void *contig_mem_align(size_t align, size_t size);
+extern void *contig_mem_free(void *ptr);
 
 static inline unsigned long long crypto_virt_to_phys(void *vaddr)
 {
@@ -44,28 +46,8 @@ static inline void *crypto_phys_to_virt(unsigned long long paddr)
 	return (void *)((paddr - linuxu_shoff) + linuxu_shvaddr);
 }
 
-static inline int crypto_is_addr_owned(void *vaddr)
-{
-	return ((vaddr >= linuxu_shvaddr) && (vaddr < (linuxu_shvaddr + linuxu_shsize)));
-}
-
-#ifdef CRYPTO_API_INCLUDE /* This is defined by cryptoapi */
-
-/* This portion is not exported to the appplication,
- application should call nlm_crypto_malign and nlm_crypto_mfree */
-
-#include "contig_alloc.h"
-
-#define crypto_malign(align, size) contig_malign(align, size)
-#define crypto_mfree(p) contig_free(p)
-
-/* Application specific lib init function, should be provided by all */
-static inline int nlm_crypto_app_lib_init(int *sae_rx_vc, int *sae_rx_sync_vc, void **pcpu_sync_lock_ptr)
-{
-	extern int nlm_crypto_app_linuxu_init(int *sae_rx_vc, int *sae_rx_sync_vc, void **pcpu_sync_lock_ptr);
-	return nlm_crypto_app_linuxu_init(sae_rx_vc, sae_rx_sync_vc, pcpu_sync_lock_ptr);
-}
+#define crypto_malign(align, size) contig_mem_align(align, size)
+#define crypto_mfree(p) contig_mem_free(p)
 
-#endif /* CRYPTO_API_INCLUDE */
 
 #endif
-- 
1.9.1

