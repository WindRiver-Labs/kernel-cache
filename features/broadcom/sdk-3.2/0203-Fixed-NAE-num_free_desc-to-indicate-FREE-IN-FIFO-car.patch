From a8388c38d53e13b4ba87019d64bcbc25002bd2b1 Mon Sep 17 00:00:00 2001
From: Siva Pochiraju <sivap@netlogicmicro.com>
Date: Tue, 5 Oct 2010 11:53:38 -0700
Subject: [PATCH 0203/1532] Fixed NAE num_free_desc to indicate FREE-IN FIFO
 carvings

1. Replaced even allocation of free desc fifo carving with nae.dts based values
2. Bumped up the num_free_desc across all complexes
3. code cleanup
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/boot/dts/nae.dts | 12 +++++++++---
 1 file changed, 9 insertions(+), 3 deletions(-)

diff --git a/arch/mips/boot/dts/nae.dts b/arch/mips/boot/dts/nae.dts
index 1d54483..3e142d7 100644
--- a/arch/mips/boot/dts/nae.dts
+++ b/arch/mips/boot/dts/nae.dts
@@ -38,7 +38,9 @@
 				   20 20 20 20 20 20 20 20
 				   20 20 20 20 20 20 20 20>;
 
-		num_free_descs = <32 32 32 32>;
+		// Max available descriptors are 1024 (across all complexes).
+		// Per port num_free_descriptors has to be even number
+		num_free_descs = <64 64 64 64>;
 		free_desc_sizes = <1536 1536 1536 1536>;
 		ucore_mask = <0xffff 0xffff 0xffff 0xffff>;
 	};
@@ -60,7 +62,9 @@
 		//  to populate the operand
 		rx_buffer_sizes = <20 20 20 20 20 20 20 20>;
 
-		num_free_descs = <32>;
+		// Max available descriptors are 1024  (across all complexes).
+		// Per port num_free_descriptors must be even number
+		num_free_descs = <512>;
 		free_desc_sizes = <1536>;
 		ucore_mask = <0xffff>;
 	};
@@ -83,7 +87,9 @@
 		rx_buffer_sizes = <20 20 20 20 20 20 20 20
 				   20 20 20 20 20 20 20 20>;
 
-		num_free_descs = <32 32>;
+		// Max available descriptors are 1024 (across all complexes).
+		// Per port num_free_descriptors must be even number
+		num_free_descs = <128 128>;
 		free_desc_sizes = <1536 1536>;
 		ucore_mask = <0xffff 0xffff>;
 	};
-- 
1.9.1

