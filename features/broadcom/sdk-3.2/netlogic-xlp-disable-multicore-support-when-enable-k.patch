From ff5e3df3111315df6ce52f2ee4543be6c1fe06a9 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Thu, 7 Aug 2014 16:27:33 +0800
Subject: [PATCH 11/14] netlogic:xlp:disable multicore support when enable
 kexec

Disable multicore support when enabled kexec feature on xlp.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/common/smp.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/mips/netlogic/common/smp.c b/arch/mips/netlogic/common/smp.c
index 01cbe51..e890fc2 100644
--- a/arch/mips/netlogic/common/smp.c
+++ b/arch/mips/netlogic/common/smp.c
@@ -360,7 +360,9 @@ int __cpuinit nlm_wakeup_secondary_cpus(void)
 	*reset_data = threadmode;
 
 #ifdef CONFIG_CPU_XLP
+#ifndef CONFIG_KEXEC
 	xlp_wakeup_secondary_cpus();
+#endif
 #else
 	xlr_wakeup_secondary_cpus();
 #endif
-- 
1.7.5.4

