From 9815c62d372a3ccb0fdb6fd80225aebf9c472b1e Mon Sep 17 00:00:00 2001
From: reshmic <reshmic@broadcom.com>
Date: Mon, 26 Nov 2012 17:02:42 +0530
Subject: [PATCH 1500/1532] crypto: Enabled crypto support for linux 3.0

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/crypto/sae/nlm_crypto.c | 5 ++---
 drivers/crypto/sae/nlm_enc.c    | 4 ++--
 2 files changed, 4 insertions(+), 5 deletions(-)

diff --git a/drivers/crypto/sae/nlm_crypto.c b/drivers/crypto/sae/nlm_crypto.c
index fc1bb4b..7743464 100644
--- a/drivers/crypto/sae/nlm_crypto.c
+++ b/drivers/crypto/sae/nlm_crypto.c
@@ -22,7 +22,7 @@ CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
 THE POSSIBILITY OF SUCH DAMAGE.
  *****************************#NETL_2#********************************/
-
+#include <asm/netlogic/xlp.h>
 #include <asm/netlogic/msgring.h>
 #include <linux/proc_fs.h>
 #include <asm/netlogic/proc.h>
@@ -118,7 +118,6 @@ int auth_mode_key_len[NLM_HASH_MAX][NLM_HASH_MODE_MAX] = {
 /* GHASH */		{0,    0,     0,     0,     0,    32,  32,   32,    32,   32, }, //todo:
 };
 
-#define MAX_KEY_LEN_IN_DW 20
 #define NLM_CRYPTO_MAX_STR_LEN 200
 #ifdef NLM_CRYPTO_DEBUG
 static char str_cipher_alg[NLM_CIPHER_MAX + 1][NLM_CRYPTO_MAX_STR_LEN] = {
@@ -706,7 +705,7 @@ nlm_crypto_init(void)
     return ret;
 }
 
-static void  init_sae()
+static void  init_sae(void)
 {
 	if( is_nlm_xlp2xx())
 		chip_feature = (ZUC | DES3_KEY_SWAP); 
diff --git a/drivers/crypto/sae/nlm_enc.c b/drivers/crypto/sae/nlm_enc.c
index 4e032d5..36e8dc5 100755
--- a/drivers/crypto/sae/nlm_enc.c
+++ b/drivers/crypto/sae/nlm_enc.c
@@ -260,10 +260,10 @@ xlp_crypt(struct ablkcipher_request *req, unsigned int enc, int iv_size, struct
 	int node ;
 	unsigned int max_frags= MAX_FRAGS;
 	unsigned int cipher_len = req->nbytes;
-	struct nlm_crypto_pkt_param * pkt_param = (struct nlm_crypto_pkt_param *) NLM_CRYPTO_PKT_PARAM_OFFSET(ablkcipher_request_ctx(req));
-	struct nlm_async_crypto * async =  (struct nlm_async_crypto *)NLM_ASYNC_PTR_PARAM_OFFSET(ablkcipher_request_ctx(req));;
 	int ret = -EINPROGRESS; 
 	int try = 0;
+	struct nlm_crypto_pkt_param * pkt_param = (struct nlm_crypto_pkt_param *) NLM_CRYPTO_PKT_PARAM_OFFSET(ablkcipher_request_ctx(req));
+	struct nlm_async_crypto * async =  (struct nlm_async_crypto *)NLM_ASYNC_PTR_PARAM_OFFSET(ablkcipher_request_ctx(req));;
 
 	async->pkt_param = NULL;
 
-- 
1.9.1

