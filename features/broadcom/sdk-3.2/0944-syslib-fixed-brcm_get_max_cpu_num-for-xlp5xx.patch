From a09a5e37aaf15960b0477476f43cbbf4ab2f4e8d Mon Sep 17 00:00:00 2001
From: Virendra Pathak <vpathak@broadcom.com>
Date: Wed, 21 May 2014 15:43:45 +0530
Subject: [PATCH 0944/1532] syslib: fixed brcm_get_max_cpu_num() for xlp5xx

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/syslib/include/brcm_xlp_cpu.h | 1 +
 arch/mips/netlogic/lib/syslib/src/brcm_xlp_cpu.c     | 2 ++
 2 files changed, 3 insertions(+)

diff --git a/arch/mips/netlogic/lib/syslib/include/brcm_xlp_cpu.h b/arch/mips/netlogic/lib/syslib/include/brcm_xlp_cpu.h
index cbce7e4..8bf00f9 100644
--- a/arch/mips/netlogic/lib/syslib/include/brcm_xlp_cpu.h
+++ b/arch/mips/netlogic/lib/syslib/include/brcm_xlp_cpu.h
@@ -47,6 +47,7 @@
 
 #define XLP9XX_MAX_NODES		8
 #define XLP9XX_MAX_CPU_PER_NODE   	80
+#define XLP5XX_MAX_CPU_PER_NODE 	32
 
 #define XLP3XX_MAX_CPU_PER_NODE 	16
 #define XLP2XX_MAX_CPU_PER_NODE 	8
diff --git a/arch/mips/netlogic/lib/syslib/src/brcm_xlp_cpu.c b/arch/mips/netlogic/lib/syslib/src/brcm_xlp_cpu.c
index 0d5fa1e..0d9b249 100644
--- a/arch/mips/netlogic/lib/syslib/src/brcm_xlp_cpu.c
+++ b/arch/mips/netlogic/lib/syslib/src/brcm_xlp_cpu.c
@@ -56,6 +56,8 @@ inline int brcm_get_max_cpu_num(void)
 
 	if (is_nlm_xlp9xx()) {
 		max_cpu = XLP9XX_MAX_CPU_PER_NODE;
+	} else if (is_nlm_xlp5xx()) {
+		max_cpu = XLP5XX_MAX_CPU_PER_NODE;
 	} else if (is_nlm_xlp8xx()) {
 		max_cpu = NLM_NCPUS_PER_NODE;
 	} else if (is_nlm_xlp3xx()) {
-- 
1.9.1

