From cba36e189f388c581280de3e6c9c98bc2b624f66 Mon Sep 17 00:00:00 2001
From: Manoj Vellala <manojv@broadcom.com>
Date: Tue, 18 Feb 2014 19:54:27 -0800
Subject: [PATCH 0895/1532] seclib: xlp8xx/2xx/3xx iv length correction for CCM
 and GCM

	1) IV lengths for GCM and CCM were swapped
	2) Based on new RFCs GCM mode should be
	   supported with Camellia. iv_len should not be -1
	3) iv_len LRW mode for camellia192 has been corrected
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/seclib/saesoc_lib.h | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/arch/mips/netlogic/lib/seclib/saesoc_lib.h b/arch/mips/netlogic/lib/seclib/saesoc_lib.h
index 4b43544..4c52827 100644
--- a/arch/mips/netlogic/lib/seclib/saesoc_lib.h
+++ b/arch/mips/netlogic/lib/seclib/saesoc_lib.h
@@ -209,14 +209,14 @@ static int saesoc_gen1_hash_mode[SAESOC_HASH_TYPE_MAX+1] = {
 /* max iv size */
 static int saesoc_iv_size[0xf][0xf] = 
 {
-	/*                  ECB  CBC   CFB   OFB   CTR  AESF8    LRW  XTS    GCM   CCM */
+	/*                  ECB  CBC   CFB   OFB   CTR  AESF8    LRW  XTS    CCM   GCM */
 	/* AES128 */	{   0,    16,   16,  16,    16,   16,     16,  16,   16,   16},
 	/* AES192 */	{   0,    16,   16,  16,    16,  16,     16,  16,    16,   16},
 	/* AES256 */	{   0,    16,   16,  16,    16,  16,     16,  16,    16,   16},
 	/* NONE */	{   0,     0,    0,   0,     0,   0,      0,   0,     0,    0},
-	/* CAMELLIA128*/{   0,    16,   16,  16,    16,  16,     16,  16,    -1,   16},
-	/* CAMELLIA192*/{   0,    16,   16,  16,    16,  16,     15,  16,    -1,   16},
-	/* CAMELLIA256*/{   0,    16,   16,  16,    16,  16,     16,  16,    -1,   16},
+	/* CAMELLIA128*/{   0,    16,   16,  16,    16,  16,     16,  16,    16,   16},
+	/* CAMELLIA192*/{   0,    16,   16,  16,    16,  16,     16,  16,    16,   16},
+	/* CAMELLIA256*/{   0,    16,   16,  16,    16,  16,     16,  16,    16,   16},
 	/* NONE */	{   0,     0,    0,   0,     0,   0,      0,   0,     0,    0},
 	/* BYPASS */	{   0,     0,    0,   0,     0,   0,      0,   0,     0,    0},
 	/* KASUMIF8*/  	{   0,     0,    0,   0,     0,   0,      0,   0,     0,    0},
-- 
1.9.1

