From afb1042e30e5e89b467f5febe2bdfe2c2a8e3fb1 Mon Sep 17 00:00:00 2001
From: Quanyang Wang <quanyang.wang@windriver.com>
Date: Wed, 29 Apr 2015 14:28:28 +0800
Subject: [PATCH 3/6] spi: spidev: fix two compile warnings

Move printk routine behind the defination of variable, else it will
ocurr the warning as below:
drivers/spi/spidev.c:603:3: warning: ISO C90 forbids mixed declarations and code [-Wdeclaration-after-statement]
   struct device *dev;
   ^
Add the CONFIG_ACPI condition compilation, else in no acpi kernel it
will occur the warning as below:
drivers/spi/spidev.c:657:30: warning: 'spidev_acpi_match' defined but not used [-Wunused-variable]
 static struct acpi_device_id spidev_acpi_match[] = {
                              ^

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/spi/spidev.c |    4 +++-
 1 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/drivers/spi/spidev.c b/drivers/spi/spidev.c
index 1cc11c1..d2494126 100644
--- a/drivers/spi/spidev.c
+++ b/drivers/spi/spidev.c
@@ -599,8 +599,8 @@ static int spidev_probe(struct spi_device *spi)
 	mutex_lock(&device_list_lock);
 	minor = find_first_zero_bit(minors, N_SPI_MINORS);
 	if (minor < N_SPI_MINORS) {
-		printk("%s:enter 1. bus_num %d, chipselect %d\n", __func__, spi->master->bus_num, spi->chip_select);
 		struct device *dev;
+		printk("%s:enter 1. bus_num %d, chipselect %d\n", __func__, spi->master->bus_num, spi->chip_select);
 
 		spidev->devt = MKDEV(SPIDEV_MAJOR, minor);
 		dev = device_create(spidev_class, &spi->dev, spidev->devt,
@@ -654,6 +654,7 @@ static const struct of_device_id spidev_dt_ids[] = {
 
 MODULE_DEVICE_TABLE(of, spidev_dt_ids);
 
+#ifdef CONFIG_ACPI
 static struct acpi_device_id spidev_acpi_match[] = {
 	{ "AUTH2750", 0 },
 	{ "SPI1001", 0 },       
@@ -661,6 +662,7 @@ static struct acpi_device_id spidev_acpi_match[] = {
 };
 
 MODULE_DEVICE_TABLE(acpi, spidev_acpi_match);
+#endif
 
 static struct spi_driver spidev_spi_driver = {
 	.driver = {
-- 
1.7.5.4

