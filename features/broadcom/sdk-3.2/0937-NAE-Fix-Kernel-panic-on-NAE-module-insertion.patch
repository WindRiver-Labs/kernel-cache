From a13b3bee41f36abaefa9d35aca4cdfa714314e08 Mon Sep 17 00:00:00 2001
From: Anurag <anurag.gopinath@broadcom.com>
Date: Tue, 29 Apr 2014 18:57:42 +0530
Subject: [PATCH 0937/1532] NAE : Fix Kernel panic on NAE module insertion

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/netlib/src/netsoc_config.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/arch/mips/netlogic/lib/netlib/src/netsoc_config.c b/arch/mips/netlogic/lib/netlib/src/netsoc_config.c
index 3e13693..0d02bb3 100644
--- a/arch/mips/netlogic/lib/netlib/src/netsoc_config.c
+++ b/arch/mips/netlogic/lib/netlib/src/netsoc_config.c
@@ -587,7 +587,8 @@ int __netsoc_parse_and_init(void *fdt, int dom_id, struct netsoc_lib_param* libp
         max_poe = __netsoc_get_max_poe();
 //        max_ale = __netsoc_get_max_ale();
 
-	bus = 0;
+	//bus = 0;
+        bus = (IS_NLM_XLP9XX_FAMILY) ? 1 : 0 ;
 
 	for(node = 0; node < max_nodes; node++) {
 		// Parset nae configuration from fdt
-- 
1.9.1

