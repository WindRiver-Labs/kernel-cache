From 8be6c0fee61116f9d45b22f70a31f663dca632f3 Mon Sep 17 00:00:00 2001
From: Sreekanth Molagavalli <sreekanth.molagavalli@broadcom.com>
Date: Mon, 20 Jan 2014 19:09:02 +0530
Subject: [PATCH 0477/1532] XLP3xx: Add SRIO support

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/boot/dts/xlp3xx-linux-tmpl.dts |  3 +++
 arch/mips/boot/dts/xlp3xx-linux.dts      | 10 ++++++++--
 2 files changed, 11 insertions(+), 2 deletions(-)

diff --git a/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
index d5759a3..17a2c1a 100644
--- a/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
@@ -232,6 +232,9 @@
 		        mac-address = [00 11 22 33 44 55];
 		        smsc,irq-push-pull;
 		};
+		rio: xlp_rio@2c000 {
+			compatible = "netlogic,xlp-rio";
+		};
 	};
 
 	chosen {
diff --git a/arch/mips/boot/dts/xlp3xx-linux.dts b/arch/mips/boot/dts/xlp3xx-linux.dts
index aa2ab7d..3eaf700 100644
--- a/arch/mips/boot/dts/xlp3xx-linux.dts
+++ b/arch/mips/boot/dts/xlp3xx-linux.dts
@@ -52,11 +52,17 @@
 			};
                         fmn {
 				/* make the node mask to 0xffffffff for SRIO */
-                                node_0_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
+                                /*node_0_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
                                 node_1_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
                                 node_2_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
                                 node_3_vc_mask = <0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb 0xbbbbbbbb>;
-                        };
+								*/
+                                node_0_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
+                                node_1_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
+                                node_2_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
+                                node_3_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
+
+			};
 			nae {
 				freein-fifo-mask = <0xff 0 0 0>;
 				/* node offsets and size */
-- 
1.9.1

