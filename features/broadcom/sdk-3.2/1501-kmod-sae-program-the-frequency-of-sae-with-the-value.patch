From 62414c857e157d080728690969dfad99bd0c3162 Mon Sep 17 00:00:00 2001
From: reshmic <reshmic@broadcom.com>
Date: Mon, 3 Dec 2012 15:20:08 +0530
Subject: [PATCH 1501/1532] kmod/sae : program the frequency of sae with the
 value given in fdt.

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/crypto/sae/nlm_crypto.c | 13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/drivers/crypto/sae/nlm_crypto.c b/drivers/crypto/sae/nlm_crypto.c
index 7743464..7b0c9cb 100644
--- a/drivers/crypto/sae/nlm_crypto.c
+++ b/drivers/crypto/sae/nlm_crypto.c
@@ -707,10 +707,23 @@ nlm_crypto_init(void)
 
 static void  init_sae(void)
 {
+	extern void *fdt;
+	int freq;
+	int node;
+
+	freq = nlm_hal_get_fdt_freq(fdt, NLM_SAE);
+
+	for_each_node(node) {
+
+		nlm_hal_set_sae_freq(node, freq);
+		nlm_hal_set_sae_engine_sel(node);
+	}
+
 	if( is_nlm_xlp2xx())
 		chip_feature = (ZUC | DES3_KEY_SWAP); 
 	else
 		chip_feature = 0x0;
+
 }
 
     static int __init
-- 
1.9.1

