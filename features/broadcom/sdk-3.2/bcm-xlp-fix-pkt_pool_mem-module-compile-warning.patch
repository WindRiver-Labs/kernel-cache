From 01cf74062b1d41a6a763f0b32058ae4dcdd8bdb4 Mon Sep 17 00:00:00 2001
From: Quanyang Wang <quanyang.wang@windriver.com>
Date: Wed, 29 Apr 2015 14:28:28 +0800
Subject: [PATCH 5/6] bcm-xlp: fix pkt_pool_mem module compile warning

Fix pkt_pool_mem module compile warning in kernel source code.

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/misc/netlogic/pkt_pool_mem/pkt_pool_mem.c |    8 ++++----
 1 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/drivers/misc/netlogic/pkt_pool_mem/pkt_pool_mem.c b/drivers/misc/netlogic/pkt_pool_mem/pkt_pool_mem.c
index 061eb57..e0505ed 100644
--- a/drivers/misc/netlogic/pkt_pool_mem/pkt_pool_mem.c
+++ b/drivers/misc/netlogic/pkt_pool_mem/pkt_pool_mem.c
@@ -203,8 +203,8 @@ static long pktmem_ioctl (struct file *fptr, unsigned int cmd, unsigned long dp)
 	/* Handling special cmd for cache flush operation */
 	if(cmd == CACHE_FLUSH) 
 	{
-		spin_lock(&cache_lock);
 		uint64_t paddr = dp;
+		spin_lock(&cache_lock);
 		cache_op(Hit_Writeback_Inv_D,paddr);
 		cache_op(Hit_Writeback_Inv_D,paddr+32);
 		udelay(30);
@@ -217,7 +217,7 @@ static long pktmem_ioctl (struct file *fptr, unsigned int cmd, unsigned long dp)
 	dptr = &data;
 	rc = 0;
 
-	copy_from_user(dptr, dp, sizeof(brcm_devmem_ioctl_t));
+	copy_from_user(dptr, (void *)dp, sizeof(brcm_devmem_ioctl_t));
 
 #ifdef PKTMEM_DEBUG
 	printk("pktmem: memory map before\n");
@@ -246,7 +246,7 @@ static long pktmem_ioctl (struct file *fptr, unsigned int cmd, unsigned long dp)
 	printk("pktmem: ioctl returns rc %d.\n", rc);
 #endif
 
-	copy_to_user(dp, dptr, sizeof(brcm_devmem_ioctl_t));
+	copy_to_user((void *)dp, dptr, sizeof(brcm_devmem_ioctl_t));
 
 	spin_unlock(&ioctl_lock);
 	return rc;
@@ -344,7 +344,7 @@ static int __init brcm_xlp_ppm_init (void)
 	else
 	{
 
-		if (pktmem_start_address[0] == NULL) {
+		if ((void *)pktmem_start_address[0] == NULL) {
 			printk(KERN_ERR "brcm_pktmem: unable to read pktmem from DTB.\n");
 			return -1;
 		}
-- 
1.7.5.4

