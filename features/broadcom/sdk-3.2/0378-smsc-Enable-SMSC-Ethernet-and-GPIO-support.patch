From 970cdcdf22b0a536648f9d3f78546ed21031fe6d Mon Sep 17 00:00:00 2001
From: Kamlakant Patel <kamlakant.patel@broadcom.com>
Date: Mon, 24 Jun 2013 09:08:45 +0530
Subject: [PATCH 0378/1532] smsc: Enable SMSC Ethernet and GPIO support.

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/boot/dts/xlp2xx-linux-tmpl.dts | 26 +++++++++++++++++++++++++-
 arch/mips/boot/dts/xlp3xx-linux-tmpl.dts | 26 +++++++++++++++++++++++++-
 2 files changed, 50 insertions(+), 2 deletions(-)

diff --git a/arch/mips/boot/dts/xlp2xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp2xx-linux-tmpl.dts
index 29b92f3..7b27156 100644
--- a/arch/mips/boot/dts/xlp2xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp2xx-linux-tmpl.dts
@@ -20,7 +20,7 @@
 		#size-cells = <1>;
 		compatible = "simple-bus";
 		ranges = <0 0  0 0x18000000  0x04000000   // PCIe CFG
-			  1 0  0 0x16000000  0x01000000>; // GBU chipselects
+			  1 0  0 0x16000000  0x02000000>; // GBU chipselects
 
 		serial0: serial@30000 {
 			device_type = "serial";
@@ -120,6 +120,30 @@
 				read-only;
 			};
 		};
+
+		gpio: xlp_gpio@34000 {
+			compatible = "netlogic,xlp-gpio";
+			reg = <0 0x34000 0x1000>;
+			#gpio-cells = <2>;
+			gpio-controller;
+
+			#interrupt-cells = <1>;
+			interrupt-parent = <&pic>;
+			interrupts = <39>;
+			interrupt-controller;
+		};
+		ethernet@2,0 {
+		        compatible = "smsc,lan9115";
+		        reg = <1 0x01200000 0x100000>;
+			reg-io-width = <4>;
+
+		        interrupts = <39>;
+		        interrupt-parent = <&gpio>;
+
+		        phy-mode = "mii";
+		        mac-address = [00 11 22 33 44 55];
+			smsc,irq-push-pull;
+		};
 	};
 
 	chosen {
diff --git a/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts b/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
index 32104ab..8776e53 100644
--- a/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
+++ b/arch/mips/boot/dts/xlp3xx-linux-tmpl.dts
@@ -21,7 +21,7 @@
 		#size-cells = <1>;
 		compatible = "simple-bus";
 		ranges = <0 0  0 0x18000000  0x04000000   // PCIe CFG
-			  1 0  0 0x16000000  0x01000000>; // GBU chipselects
+			  1 0  0 0x16000000  0x02000000>; // GBU chipselects
 
 		serial0: serial@30000 {
 			device_type = "serial";
@@ -121,6 +121,30 @@
 				read-only;
 			};
 		};
+
+		gpio: xlp_gpio@34000 {
+			compatible = "netlogic,xlp-gpio";
+			reg = <0 0x34000 0x1000>;
+			#gpio-cells = <2>;
+			gpio-controller;
+
+			#interrupt-cells = <1>;
+			interrupt-parent = <&pic>;
+			interrupts = <39>;
+			interrupt-controller;
+		};
+		ethernet@2,0 {
+		        compatible = "smsc,lan9115";
+		        reg = <1 0x01200000 0x100000>;
+			reg-io-width = <4>;
+
+		        interrupts = <39>;
+		        interrupt-parent = <&gpio>;
+
+		        phy-mode = "mii";
+		        mac-address = [00 11 22 33 44 55];
+		        smsc,irq-push-pull;
+		};
 	};
 
 	chosen {
-- 
1.9.1

