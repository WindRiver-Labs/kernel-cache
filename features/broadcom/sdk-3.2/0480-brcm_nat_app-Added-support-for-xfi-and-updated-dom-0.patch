From 8e9ce393a9aad7adf41e044f637185424ea09735 Mon Sep 17 00:00:00 2001
From: Rahul Gupta <guptar@broadcom.com>
Date: Fri, 31 Jan 2014 18:20:47 +0530
Subject: [PATCH 0480/1532] brcm_nat_app: Added support for xfi and updated
 dom@0 memory for NAT data structure.

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/boot/dts/xlp8xx-helinux-nat.dts |  5 +++--
 arch/mips/boot/dts/xlp9xx-helinux-nat.dts | 22 +++++++++++++---------
 2 files changed, 16 insertions(+), 11 deletions(-)

diff --git a/arch/mips/boot/dts/xlp8xx-helinux-nat.dts b/arch/mips/boot/dts/xlp8xx-helinux-nat.dts
index 9ccd840..47cf63f 100644
--- a/arch/mips/boot/dts/xlp8xx-helinux-nat.dts
+++ b/arch/mips/boot/dts/xlp8xx-helinux-nat.dts
@@ -13,14 +13,15 @@
         memory {
                 device_type = "memory";
                 reg =  <0 0x01000000 0 0x0B000000   //176M @ 1M
-                        0 0x20000000 0 0x40000000>;
+                        0 0x20000000 0 0x40000000
+                        0x2 0x00000000 0x1 0x80000000>;
         };
 	/* memory range for HEv2 pkt mem. Only one contig memory per node supported */
 	pktmem {
 		device_type = "pktmem";
 
 		/* format: node number, 64-bit addr, 64-bit size */
-		reg = <0 0 0xe0000000 0x1 0
+        reg = <0 0 0xe0000000 0x0 0x20000000
 	               1 0x0 0x0 0x0 0x0
 		       2 0x0 0x0 0x0 0x0
 		       3 0x0 0x0 0x0 0x0>;
diff --git a/arch/mips/boot/dts/xlp9xx-helinux-nat.dts b/arch/mips/boot/dts/xlp9xx-helinux-nat.dts
index aa9cc70..080721b 100644
--- a/arch/mips/boot/dts/xlp9xx-helinux-nat.dts
+++ b/arch/mips/boot/dts/xlp9xx-helinux-nat.dts
@@ -12,17 +12,17 @@
 
 	memory {
                 device_type = "memory";
-                reg =  <0 0x00100000 0 0x0FF00000       // 255M at 1M
-                        0 0x20000000 0 0x40000000>;
-        };
+                reg =  <0x0 0x1000000  0x0 0xb000000        /* 16M - 16+176M */
+                        0x1 0x0        0x1 0x80000000>;     /* 4096M - 4096+6144M */
 
+        };
         /* memory range for HEv2 pkt mem. Only one contig memory per node supported */
 pktmem {
 		device_type = "pktmem";
 
 		/* format: node number, 64-bit addr, 64-bit size */
-		reg = <0 0 0xe0000000 0x1 0
-	               1 0x0 0x0 0x0 0x0
+        reg = <0 0x0 0x20000000 0x0 0x20000000             /* 512M - 512+512M */
+	           1 0x0 0x0 0x0 0x0
 		       2 0x0 0x0 0x0 0x0
 		       3 0x0 0x0 0x0 0x0>;
 	};
@@ -42,7 +42,8 @@ pktmem {
 			#size-cells = <1>;
 
 			cpu {
-				onlinemask = <0x0 0x0 0xffffffff>;
+				/*onlinemask = <0x0 0x0 0xffffffff>;*/
+				onlinemask = <0x0 0xffffffff 0xffffffff>;
                 nae-rx-vc = <0>;
                 nae-fb-vc = <1>;
 			//	sae-rx-vc = <0>; /* sharing with nae */
@@ -115,7 +116,8 @@ pktmem {
 			};
 
 			cpu {
-				onlinemask = <0x0 0x0 0xffffffff>;
+				/*onlinemask = <0x0 0x0 0xffffffff>;*/
+                onlinemask = <0x0 0xffffffff 0xffffffff>;
                                 nae-rx-vc = <2>;
                                 nae-fb-vc = <3>;
 				dtre-rx-vc = <2>;
@@ -132,7 +134,8 @@ pktmem {
 				id = <0>;
 			};
 			app-param{
-				onlinemask = <0x0 0x0 0xffffffff>;
+				/*onlinemask = <0x0 0x0 0xffffffff>;*/
+				onlinemask = <0x0 0xffffffff 0xffffffff>;
 				enable-nae-hw-parser = <0>;
 				enable-nae-jumbo = <0>;
 				enable-nae-p2p = <0>;
@@ -250,7 +253,8 @@ pktmem {
 		 * 20core: netlogic,cpumask=<0xffff 0xffffffff 0xffffffff>
 		 * 15 core, skipping core #5: netlogic,cpumask=<0xffffffff 0xff0fffff>
 		 */
-		netlogic,cpumask = <0xffffffff>;
+		/*netlogic,cpumask = <0xffffffff>;*/
+        netlogic,cpumask = <0x0 0xffffffff 0xffffffff>;
 		bootargs = " console=ttyS0,115200  ";
 		/* linux,initrd-start=<0x00c00000>;
 		   linux,initrd-end=<0x02c00000>; */
-- 
1.9.1

