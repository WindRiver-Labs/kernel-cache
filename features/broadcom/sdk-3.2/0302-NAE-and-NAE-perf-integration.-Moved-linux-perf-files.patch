From 6f84f81b501ac024f6874be2e2016eec051b6c9d Mon Sep 17 00:00:00 2001
From: Hareesh R <hareeshr@broadcom.com>
Date: Fri, 13 Apr 2012 13:01:19 +0530
Subject: [PATCH 0302/1532] NAE and NAE-perf integration. Moved linux-perf
 files as linux

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/boot/dts/mnxlp8xx-linux-perf.dts | 96 ------------------------------
 arch/mips/boot/dts/mnxlp8xx-linux.dts      | 12 ++++
 arch/mips/boot/dts/mnxlpev-linux.dts       | 89 ---------------------------
 arch/mips/boot/dts/xlp3xx-linux-perf.dts   | 93 -----------------------------
 arch/mips/boot/dts/xlp3xx-linux.dts        | 16 ++++-
 arch/mips/boot/dts/xlp4xx-linux.dts        | 13 +++-
 arch/mips/boot/dts/xlp8xx-linux-perf.dts   | 92 ----------------------------
 arch/mips/boot/dts/xlp8xx-linux.dts        | 16 ++++-
 8 files changed, 52 insertions(+), 375 deletions(-)
 delete mode 100644 arch/mips/boot/dts/mnxlp8xx-linux-perf.dts
 delete mode 100644 arch/mips/boot/dts/mnxlpev-linux.dts
 delete mode 100644 arch/mips/boot/dts/xlp3xx-linux-perf.dts
 delete mode 100644 arch/mips/boot/dts/xlp8xx-linux-perf.dts

diff --git a/arch/mips/boot/dts/mnxlp8xx-linux-perf.dts b/arch/mips/boot/dts/mnxlp8xx-linux-perf.dts
deleted file mode 100644
index b95c55a..0000000
--- a/arch/mips/boot/dts/mnxlp8xx-linux-perf.dts
+++ /dev/null
@@ -1,96 +0,0 @@
-/* XLP8XX Device Tree Source
- *
- */
-
-/dts-v1/;
-/ {
-	model = "MIPS,XLP8XX";
-	compatible = "NETL,XLP8XX_A0";
-
-	#address-cells = <1>;
-	#size-cells = <1>;
-
-	hypervisor {
-		hypervisor-name = "Xen";
-		alloc_dom0_memory = <0>;
-		bootargs = "ncores=8 dom0_loadaddr=0x72000000 dom0_size=0x1c000000 dom0_cpumask=0xffffffff -- ";
-		domain_heap = <0x80000000 0x20000000>;
-	};
-	doms {
-		#address-cells = <1>;
-		#size-cells = <1>;
-		dom@0 {
-			device_type = "domain";
-			os = "linux";
-
-			#address-cells = <1>;
-			#size-cells = <1>;
-			#nodes = <2>;
-			#cpumask-cells=<2>;
-
-			cpu {
-				onlinemask = <0xffffffff 0xffffffff>;
-                                nae-rx-vc = <0>;
-                                nae-fb-vc = <1>;
-			};
-			uart {
-				id = <0>;
-				owner = <1>;
-				sharedcfg = <0x1f000000>;
-			};
-			//Make sure each node's memory is separated out 
-			memory {
-				reg = <0x01000000 0x0B000000	// 176M at 16M
-					0x20000000 0xa0000000>; // 2586M at 512M
-			};
-                        fmn {
-                                node_0_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
-                                node_1_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
-                                node_2_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
-                                node_3_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;                       
-			};
-			pic {
-			};
-			nae {
-				owner = <1 1 0 0>;
-				freein-fifo-mask = <0xffff 0xffff 0 0>;
-				/* node offsets and size */
-				vfbtbl-sw-offset = <0 0 0 0>;
-				vfbtbl-sw-nentries = <32 32 32 32>;
-				/* hw entries 40 for 2 nodes , 20 fifos each */
-				vfbtbl-hw-offset = <32 32 32 32>;
-				vfbtbl-hw-nentries = <40 40 40 40>;
-				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
-			};
-
-		};
-	};
-
-	chosen {
-		bootargs = " xlp_noi2c console=ttyS0,115200  mem=512m@3584m";
-	};
-
-	/* These binaries are downloaded at the resp physical memory locations
-	 * by their corresponding bootstrapping loaders. For example,
-	 * u-boot is loaded by x-load at 193M, sysconfig is loaded by u-boot
-	 * at 1M, hypervisor by u-boot hypervisor at 136M.
-	 * On simulator all these binaries are pre-loaded by using '-F' option
-	 * for convenience. On silicon, they will be loaded by their corresponding
-	 * temporary download locations the stage-1/stage-2 firmware
-	 */
-	firmware-download {
-		u-boot        = <0x0c100000 0x3f00000>;  /* 63M @ 193M */
-		sysconfig     = <0x00100000 0x00100000>; /* 1M @ 1M */
-		hypervisor    = <0x08800000 0x00800000>; /* 8M @ 136M */
-		dom0          = <0x09000000 0x03000000>; /* 48M @ 144M */
-		domU-ramdisk  = <0x60000000 0x60800000>; /* 8M @ 1536M */
-	};
-
-	soc {
-		nodes {
-			num-nodes = <2>;
-		};
-
-	};
-};
-
diff --git a/arch/mips/boot/dts/mnxlp8xx-linux.dts b/arch/mips/boot/dts/mnxlp8xx-linux.dts
index 84cf1eb..b84f86e 100644
--- a/arch/mips/boot/dts/mnxlp8xx-linux.dts
+++ b/arch/mips/boot/dts/mnxlp8xx-linux.dts
@@ -56,6 +56,18 @@
 			};
 			pic {
 			};
+			nae {
+				owner = <1 1 0 0>;
+				freein-fifo-mask = <0xffff 0xffff 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <32 32 32 32>;
+				/* hw entries 40 for 2 nodes , 20 fifos each */
+				vfbtbl-hw-offset = <32 32 32 32>;
+				vfbtbl-hw-nentries = <40 40 40 40>;
+				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
+			};
+
 		};
 	};
 
diff --git a/arch/mips/boot/dts/mnxlpev-linux.dts b/arch/mips/boot/dts/mnxlpev-linux.dts
deleted file mode 100644
index 84cf1eb..0000000
--- a/arch/mips/boot/dts/mnxlpev-linux.dts
+++ /dev/null
@@ -1,89 +0,0 @@
-/* XLP8XX Device Tree Source
- *
- */
-
-/dts-v1/;
-/ {
-	model = "MIPS,XLP8XX";
-	compatible = "NETL,XLP8XX_A0";
-
-	#address-cells = <1>;
-	#size-cells = <1>;
-
-	hypervisor {
-		hypervisor-name = "Xen";
-		alloc_dom0_memory = <0>;
-		bootargs = "ncores=8 dom0_loadaddr=0x72000000 dom0_size=0x1c000000 dom0_cpumask=0xffffffff -- ";
-		domain_heap = <0x80000000 0x20000000>;
-	};
-	doms {
-		#address-cells = <1>;
-		#size-cells = <1>;
-		dom@0 {
-			device_type = "domain";
-			os = "linux";
-
-			#address-cells = <1>;
-			#size-cells = <1>;
-			#nodes = <2>;
-			#cpumask-cells=<2>;
-
-			cpu {
-				onlinemask = <0xffffffff 0xffffffff>;
-                                nae-rx-vc = <0>;
-                                nae-fb-vc = <1>;
-                                napi-vc-mask = <0x3>;
-				sae-rx-vc = <0>; /* sharing with nae */
-				sae-rx-sync-vc  = <3>; /* should be exclusive */
-				ipsec-async-vc  = <0>;
-				ipsec-sync-vc   = <2>;
-			};
-			uart {
-				id = <0>;
-				owner = <1>;
-				sharedcfg = <0x1f000000>;
-			};
-			//Make sure each node's memory is separated out 
-			memory {
-				reg = <0x01000000 0x0B000000	// 176M at 16M
-					0x20000000 0xa0000000>; // 2586M at 512M
-			};
-                        fmn {
-                                node_0_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_1_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_2_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                                node_3_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;                       
-			};
-			pic {
-			};
-		};
-	};
-
-	chosen {
-		bootargs = " xlp_noi2c console=ttyS0,115200  mem=512m@3584m";
-	};
-
-	/* These binaries are downloaded at the resp physical memory locations
-	 * by their corresponding bootstrapping loaders. For example,
-	 * u-boot is loaded by x-load at 193M, sysconfig is loaded by u-boot
-	 * at 1M, hypervisor by u-boot hypervisor at 136M.
-	 * On simulator all these binaries are pre-loaded by using '-F' option
-	 * for convenience. On silicon, they will be loaded by their corresponding
-	 * temporary download locations the stage-1/stage-2 firmware
-	 */
-	firmware-download {
-		u-boot        = <0x0c100000 0x3f00000>;  /* 63M @ 193M */
-		sysconfig     = <0x00100000 0x00100000>; /* 1M @ 1M */
-		hypervisor    = <0x08800000 0x00800000>; /* 8M @ 136M */
-		dom0          = <0x09000000 0x03000000>; /* 48M @ 144M */
-		domU-ramdisk  = <0x60000000 0x60800000>; /* 8M @ 1536M */
-	};
-
-	soc {
-		nodes {
-			num-nodes = <2>;
-		};
-
-	};
-};
-
diff --git a/arch/mips/boot/dts/xlp3xx-linux-perf.dts b/arch/mips/boot/dts/xlp3xx-linux-perf.dts
deleted file mode 100644
index 8d150ec..0000000
--- a/arch/mips/boot/dts/xlp3xx-linux-perf.dts
+++ /dev/null
@@ -1,93 +0,0 @@
-/* XLP8XX Device Tree Source
- *
- */
-
-/dts-v1/;
-/ {
-	model = "MIPS,XLP3XX";
-	compatible = "NETL,XLP3XX_A0";
-
-	#address-cells = <1>;
-	#size-cells = <1>;
-
-	hypervisor {
-		hypervisor-name = "Xen";
-		alloc_dom0_memory = <0>;
-		bootargs = "ncores=4 dom0_loadaddr=0x72000000 dom0_size=0x1c000000 dom0_cpumask=0xffff -- ";
-		domain_heap = <0x80000000 0x20000000>;
-	};
-	doms {
-		#address-cells = <1>;
-		#size-cells = <1>;
-		dom@0 {
-			device_type = "domain";
-			os = "linux";
-
-			#address-cells = <1>;
-			#size-cells = <1>;
-
-			cpu {
-				onlinemask = <0xffff>;
-                                nae-rx-vc = <0>;
-                                nae-fb-vc = <1>;
-			};
-			uart {
-				id = <0>;
-				owner = <1>;
-				sharedcfg = <0x1f000000>;
-			};
-			memory {
-				reg = <0x01000000 0x0B000000	// 176M at 16M
-					0x20000000 0x60000000>;  // 2586M at 512M
-			};
-                        fmn {
-				node_0_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
-                                node_1_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_2_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_3_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                        };
-			pic {
-			};
-			nae {
-				owner = <1 0 0 0>;
-				freein-fifo-mask = <0xff 0 0 0>;
-				/* node offsets and size */
-				vfbtbl-sw-offset = <0 0 0 0>;
-				vfbtbl-sw-nentries = <32 32 32 32>;
-				/* hw entries */
-				vfbtbl-hw-offset = <32 32 32 32>;
-				vfbtbl-hw-nentries = <20 20 20 20>;
-			};
-
-
-		};
-	};
-
-	chosen {
-		bootargs = " xlp_noi2c console=ttyS0,115200  rhash_entries=1048576";
-	};
-
-	/* These binaries are downloaded at the resp physical memory locations
-	 * by their corresponding bootstrapping loaders. For example,
-	 * u-boot is loaded by x-load at 193M, sysconfig is loaded by u-boot
-	 * at 1M, hypervisor by u-boot hypervisor at 136M.
-	 * On simulator all these binaries are pre-loaded by using '-F' option
-	 * for convenience. On silicon, they will be loaded by their corresponding
-	 * temporary download locations the stage-1/stage-2 firmware
-	 */
-	firmware-download {
-		u-boot        = <0x0c100000 0x3f00000>;  /* 63M @ 193M */
-		sysconfig     = <0x00100000 0x00100000>; /* 1M @ 1M */
-		hypervisor    = <0x08800000 0x00800000>; /* 8M @ 136M */
-		dom0          = <0x09000000 0x03000000>; /* 48M @ 144M */
-		domU-ramdisk  = <0x60000000 0x60800000>; /* 8M @ 1536M */
-	};
-
-	soc {
-		nodes {
-			num-nodes = <1>;
-		};
-
-	};
-};
-
diff --git a/arch/mips/boot/dts/xlp3xx-linux.dts b/arch/mips/boot/dts/xlp3xx-linux.dts
index e4c1c6d..ff3a73a 100644
--- a/arch/mips/boot/dts/xlp3xx-linux.dts
+++ b/arch/mips/boot/dts/xlp3xx-linux.dts
@@ -51,14 +51,26 @@
                                 node_1_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
                                 node_2_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
                                 node_3_vc_mask = <0x33333333 0x33333333 0x33333333 0x33333333>;
-                       };
+                        };
 			pic {
 			};
+			nae {
+				owner = <1 0 0 0>;
+				freein-fifo-mask = <0xff 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <32 32 32 32>;
+				/* hw entries */
+				vfbtbl-hw-offset = <32 32 32 32>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+			};
+
+
 		};
 	};
 
 	chosen {
-		bootargs = " xlp_noi2c console=ttyS0,115200  mem=512m@3584m ";
+		bootargs = " xlp_noi2c console=ttyS0,115200 mem=512m@3584m rhash_entries=1048576";
 	};
 
 	/* These binaries are downloaded at the resp physical memory locations
diff --git a/arch/mips/boot/dts/xlp4xx-linux.dts b/arch/mips/boot/dts/xlp4xx-linux.dts
index 3807ac1..89209bb 100644
--- a/arch/mips/boot/dts/xlp4xx-linux.dts
+++ b/arch/mips/boot/dts/xlp4xx-linux.dts
@@ -54,11 +54,22 @@
                         };
 			pic {
 			};
+			nae {
+				owner = <1 0 0 0>;
+				freein-fifo-mask = <0xffff 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <32 32 32 32>;
+				/* hw entries */
+				vfbtbl-hw-offset = <32 32 32 32>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
+			};
 		};
 	};
 
 	chosen {
-		bootargs = " xlp_noi2c console=ttyS0,115200  ";
+		bootargs = " xlp_noi2c console=ttyS0,115200 rhash_entries=1048576";
 	};
 
 	/* These binaries are downloaded at the resp physical memory locations
diff --git a/arch/mips/boot/dts/xlp8xx-linux-perf.dts b/arch/mips/boot/dts/xlp8xx-linux-perf.dts
deleted file mode 100644
index 82dacb6..0000000
--- a/arch/mips/boot/dts/xlp8xx-linux-perf.dts
+++ /dev/null
@@ -1,92 +0,0 @@
-/* XLP8XX Device Tree Source
- *
- */
-
-/dts-v1/;
-/ {
-	model = "MIPS,XLP8XX";
-	compatible = "NETL,XLP8XX_A0";
-
-	#address-cells = <1>;
-	#size-cells = <1>;
-
-	hypervisor {
-		hypervisor-name = "Xen";
-		alloc_dom0_memory = <0>;
-		bootargs = "ncores=8 dom0_loadaddr=0x72000000 dom0_size=0x1c000000 dom0_cpumask=0xffffffff -- ";
-		domain_heap = <0x80000000 0x20000000>;
-	};
-	doms {
-		#address-cells = <1>;
-		#size-cells = <1>;
-		dom@0 {
-			device_type = "domain";
-			os = "linux";
-
-			#address-cells = <1>;
-			#size-cells = <1>;
-
-			cpu {
-				onlinemask = <0xffffffff>;
-                                nae-rx-vc = <0>;
-                                nae-fb-vc = <1>;
-			};
-			uart {
-				id = <0>;
-				owner = <1>;
-				sharedcfg = <0x1f000000>;
-			};
-			memory {
-				reg = <0x01000000 0x0B000000	// 176M at 16M
-					0x20000000 0x60000000>;  // 2586M at 512M
-			};
-                        fmn {
-                                node_0_vc_mask = <0x00000000 0x00000000 0x00000000 0x00000000>;
-                                node_1_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_2_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                                node_3_vc_mask = <0xffffffff 0xffffffff 0xffffffff 0xffffffff>;
-                        };
-			pic {
-			};
-			nae {
-				owner = <1 0 0 0>;
-				freein-fifo-mask = <0xffff 0 0 0>;
-				/* node offsets and size */
-				vfbtbl-sw-offset = <0 0 0 0>;
-				vfbtbl-sw-nentries = <32 32 32 32>;
-				/* hw entries */
-				vfbtbl-hw-offset = <32 32 32 32>;
-				vfbtbl-hw-nentries = <20 20 20 20>;
-				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
-			};
-
-		};
-	};
-	chosen {
-		bootargs = " xlp_noi2c console=ttyS0,115200  rhash_entries=1048576";
-	};
-
-	/* These binaries are downloaded at the resp physical memory locations
-	 * by their corresponding bootstrapping loaders. For example,
-	 * u-boot is loaded by x-load at 193M, sysconfig is loaded by u-boot
-	 * at 1M, hypervisor by u-boot hypervisor at 136M.
-	 * On simulator all these binaries are pre-loaded by using '-F' option
-	 * for convenience. On silicon, they will be loaded by their corresponding
-	 * temporary download locations the stage-1/stage-2 firmware
-	 */
-	firmware-download {
-		u-boot        = <0x0c100000 0x3f00000>;  /* 63M @ 193M */
-		sysconfig     = <0x00100000 0x00100000>; /* 1M @ 1M */
-		hypervisor    = <0x08800000 0x00800000>; /* 8M @ 136M */
-		dom0          = <0x09000000 0x03000000>; /* 48M @ 144M */
-		domU-ramdisk  = <0x60000000 0x60800000>; /* 8M @ 1536M */
-	};
-
-	soc {
-		nodes {
-			num-nodes = <1>;
-		};
-
-	};
-};
-
diff --git a/arch/mips/boot/dts/xlp8xx-linux.dts b/arch/mips/boot/dts/xlp8xx-linux.dts
index 943ec3a..8999d22 100644
--- a/arch/mips/boot/dts/xlp8xx-linux.dts
+++ b/arch/mips/boot/dts/xlp8xx-linux.dts
@@ -35,6 +35,7 @@
 				sae-rx-sync-vc  = <3>; /* should be exclusive */
 				ipsec-async-vc  = <0>;
 				ipsec-sync-vc   = <2>;
+
 			};
 			uart {
 				id = <0>;
@@ -53,11 +54,22 @@
                         };
 			pic {
 			};
+			nae {
+				owner = <1 0 0 0>;
+				freein-fifo-mask = <0xffff 0 0 0>;
+				/* node offsets and size */
+				vfbtbl-sw-offset = <0 0 0 0>;
+				vfbtbl-sw-nentries = <32 32 32 32>;
+				/* hw entries */
+				vfbtbl-hw-offset = <32 32 32 32>;
+				vfbtbl-hw-nentries = <20 20 20 20>;
+				dummy-pktdata-addr = <0x0 0x0ff00000>; // 255 MB
+			};
+
 		};
 	};
-
 	chosen {
-		bootargs = " xlp_noi2c console=ttyS0,115200  mem=512m@3584m ";
+		bootargs = " xlp_noi2c console=ttyS0,115200 mem=512m@3584m rhash_entries=1048576";
 	};
 
 	/* These binaries are downloaded at the resp physical memory locations
-- 
1.9.1

