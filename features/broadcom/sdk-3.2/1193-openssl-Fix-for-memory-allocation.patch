From 177877deaee6c9203160a4fb4299bf54b2b4c3d7 Mon Sep 17 00:00:00 2001
From: Hareesh R <hareeshr@broadcom.com>
Date: Tue, 29 Oct 2013 13:48:23 +0530
Subject: [PATCH 1193/1532] openssl:Fix for memory allocation

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/misc/netlogic/nlmcrypto/cryptodrv.c | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/drivers/misc/netlogic/nlmcrypto/cryptodrv.c b/drivers/misc/netlogic/nlmcrypto/cryptodrv.c
index 431753e..faca178 100644
--- a/drivers/misc/netlogic/nlmcrypto/cryptodrv.c
+++ b/drivers/misc/netlogic/nlmcrypto/cryptodrv.c
@@ -444,10 +444,11 @@ static long crypto_driver_ioctl(struct file *filp, unsigned int cmd,
 		case NLM_CRYPTO_GET_CHIP_FEATURE:
 		{
 			uint32_t *ptr = (uint32_t *) arg;
-			int nlm_crypto_chip_features;
+			int chip_type = 1;
 
-			nlm_crypto_chip_features = nlm_hal_get_sae_chip_feature();
-			copy_to_user((ptr), &nlm_crypto_chip_features,sizeof(nlm_crypto_chip_features));
+			if(is_nlm_xlp9xx())
+				chip_type = 2;
+			copy_to_user((ptr), &chip_type,sizeof(chip_type));
 
 			break;
 		}
-- 
1.9.1

