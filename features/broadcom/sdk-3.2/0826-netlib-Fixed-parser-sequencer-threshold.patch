From 4d7aadd4df40fe9b99268d9df6a744d5480bc330 Mon Sep 17 00:00:00 2001
From: Jayanthi A <jayanthi.annadurai@broadcom.com>
Date: Fri, 25 Oct 2013 10:50:11 -0700
Subject: [PATCH 0826/1532] netlib: Fixed parser sequencer threshold

[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/netlib/include/netsoc_dev.h | 1 +
 arch/mips/netlogic/lib/netlib/src/netsoc_nae.c     | 1 +
 2 files changed, 2 insertions(+)

diff --git a/arch/mips/netlogic/lib/netlib/include/netsoc_dev.h b/arch/mips/netlogic/lib/netlib/include/netsoc_dev.h
index 179549c..52a53f3 100644
--- a/arch/mips/netlogic/lib/netlib/include/netsoc_dev.h
+++ b/arch/mips/netlogic/lib/netlib/include/netsoc_dev.h
@@ -127,6 +127,7 @@ enum net_cfg_regs {
  FLOW_TABLE1_CFG                    = 0x84,
  FLOW_CLASS_BASE_MASK		    = 0x85,	
  FLOW_TABLE3_CFG                    = 0x86,
+ RX_FREE_LIFO_TH		    = 0x87,
  IFACE_FIFO_CFG             	    = 0x8a,
  PARSER_SEQ_FIFOTH_CFG		    = 0x8b,
  RX_ERRINJ_CTRL1		    = 0x8d,
diff --git a/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c b/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
index 5389678..2b13285 100644
--- a/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
+++ b/arch/mips/netlogic/lib/netlib/src/netsoc_nae.c
@@ -1511,6 +1511,7 @@ void __netsoc_config_nae_global(nae_t *nae)
 	}
 
         netsoc_write_nae_reg(nae->nae_base, FLOW_CRC16_POLY_CFG, (0x28 << 16) | 0xFFFF);
+	netsoc_write_nae_reg(nae->nae_base, RX_FREE_LIFO_TH, (8 << 8) | (2 * current_netsoc->max_ucores));
 
 	__netsoc_config_ingress_fifo(nae);
 	
-- 
1.9.1

