From 815c5ad52a9d28cea96fca721716b359e79ece05 Mon Sep 17 00:00:00 2001
From: Manoj Vellala <manojv@broadcom.com>
Date: Mon, 16 Dec 2013 02:51:13 -0800
Subject: [PATCH 0874/1532] seclib: Hash algorithm CBC_MAC doesnot support
 HMAC.

	set hmac = 0 for HASH_MODE_CBC
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/netlogic/lib/seclib/saesoc_lib.h | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/arch/mips/netlogic/lib/seclib/saesoc_lib.h b/arch/mips/netlogic/lib/seclib/saesoc_lib.h
index 7f71b96..4b43544 100644
--- a/arch/mips/netlogic/lib/seclib/saesoc_lib.h
+++ b/arch/mips/netlogic/lib/seclib/saesoc_lib.h
@@ -666,8 +666,9 @@ static inline int saesoc_new_session(
 			int hmac = initp->hash.key_len?1:0;
 			int mode ;
 			if ( (initp->hash.mode == SAESOC_HASH_MODE_XCBC) ||
-			  	(initp->hash.mode == SAESOC_HASH_MODE_GCM) || 
-				(initp->hash.mode == SAESOC_HASH_MODE_CCM))
+			  	(initp->hash.mode == SAESOC_HASH_MODE_GCM) ||
+                                (initp->hash.mode == SAESOC_HASH_MODE_CCM) ||
+				(initp->hash.mode == SAESOC_HASH_MODE_CBC))
 			       hmac = 0;	
 			spriv->hash_en = 1;
 			spriv->addl_hash_len = initp->hash.addl_hash_len;
-- 
1.9.1

