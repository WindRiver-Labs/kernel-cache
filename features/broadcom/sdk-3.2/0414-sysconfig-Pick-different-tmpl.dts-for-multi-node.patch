From f97c86da93881985dfeddbe528171f910fef5d73 Mon Sep 17 00:00:00 2001
From: Ganesan Ramalingam <ganesanr@broadcom.com>
Date: Mon, 23 Sep 2013 19:06:10 +0530
Subject: [PATCH 0414/1532] sysconfig: Pick different tmpl.dts for multi-node

For multi-node dts should setup other node properties like PIC,GPIO,
I2C etc, so pick mn-tmpl.dts file.

Set start of memory range to zero in all the dts files
[Based on SDK 3.2]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 arch/mips/boot/dts/mn4xlp8xx-linux.dts       |   7 +-
 arch/mips/boot/dts/mnxlp8xx-linux.dts        |   2 +-
 arch/mips/boot/dts/xlp2xx-ep-linux.dts       |   2 +-
 arch/mips/boot/dts/xlp2xx-linux.dts          |   2 +-
 arch/mips/boot/dts/xlp3xx-linux.dts          |   2 +-
 arch/mips/boot/dts/xlp3xx-xmc-linux.dts      |   2 +-
 arch/mips/boot/dts/xlp4xx-linux.dts          |   2 +-
 arch/mips/boot/dts/xlp8xx-linux-mn-tmpl.dts  | 146 ++++++++++++++++++++++++
 arch/mips/boot/dts/xlp8xx-linux-mn4-tmpl.dts | 160 +++++++++++++++++++++++++++
 arch/mips/boot/dts/xlp8xx-linux.dts          |   2 +-
 arch/mips/boot/dts/xlp9xx-linux.dts          |   2 +-
 11 files changed, 319 insertions(+), 10 deletions(-)
 create mode 100644 arch/mips/boot/dts/xlp8xx-linux-mn-tmpl.dts
 create mode 100644 arch/mips/boot/dts/xlp8xx-linux-mn4-tmpl.dts

diff --git a/arch/mips/boot/dts/mn4xlp8xx-linux.dts b/arch/mips/boot/dts/mn4xlp8xx-linux.dts
index 6cb2700..e75c99a 100644
--- a/arch/mips/boot/dts/mn4xlp8xx-linux.dts
+++ b/arch/mips/boot/dts/mn4xlp8xx-linux.dts
@@ -11,9 +11,12 @@
 	/*memory range for linux. This will not appear in dom0*/
         memory {
                 device_type = "memory";
-                reg =  <0 0x01000000 0 0x0B000000
+                reg =  <0 0x00000000 0 0x0B000000
                         0 0x20000000 0 0xa0000000
-                        0 0xe0000000 0 0x20000000>;
+                        0 0xe0000000 0 0x20000000
+                        1 0x00000000 1 0x00000000
+                        2 0x00000000 1 0x00000000
+                        3 0x00000000 1 0x00000000>;
         };
 
 	hypervisor {
diff --git a/arch/mips/boot/dts/mnxlp8xx-linux.dts b/arch/mips/boot/dts/mnxlp8xx-linux.dts
index 5de58e2..bde5332 100644
--- a/arch/mips/boot/dts/mnxlp8xx-linux.dts
+++ b/arch/mips/boot/dts/mnxlp8xx-linux.dts
@@ -11,7 +11,7 @@
 	/*memory range for linux. This will not appear in dom0*/
         memory {
                 device_type = "memory";
-                reg =  <0 0x01000000 0 0x0B000000
+                reg =  <0 0x00000000 0 0x0B000000
                         0 0x20000000 0 0xa0000000
                         0 0xe0000000 0 0x20000000>;
         };
diff --git a/arch/mips/boot/dts/xlp2xx-ep-linux.dts b/arch/mips/boot/dts/xlp2xx-ep-linux.dts
index 0bdb184..c95fcb1 100644
--- a/arch/mips/boot/dts/xlp2xx-ep-linux.dts
+++ b/arch/mips/boot/dts/xlp2xx-ep-linux.dts
@@ -11,7 +11,7 @@
 	/*memory range for linux. This will not appear in dom0*/
         memory {
                 device_type = "memory";
-                reg =  <0 0x01000000 0 0x0B000000
+                reg =  <0 0x00000000 0 0x0B000000
                         0 0x20000000 0 0xa0000000
                         0 0xe0000000 0 0x20000000>;
         };
diff --git a/arch/mips/boot/dts/xlp2xx-linux.dts b/arch/mips/boot/dts/xlp2xx-linux.dts
index f9566f7..9aba590 100644
--- a/arch/mips/boot/dts/xlp2xx-linux.dts
+++ b/arch/mips/boot/dts/xlp2xx-linux.dts
@@ -12,7 +12,7 @@
 	/*memory range for linux. This will not appear in dom0*/
         memory {
                 device_type = "memory";
-                reg =  <0 0x01000000 0 0x0B000000
+                reg =  <0 0x00000000 0 0x0B000000
                         0 0x20000000 0 0xa0000000
                         0 0xe0000000 0 0x20000000>;
         };
diff --git a/arch/mips/boot/dts/xlp3xx-linux.dts b/arch/mips/boot/dts/xlp3xx-linux.dts
index 5894e0b..60aaa0a 100644
--- a/arch/mips/boot/dts/xlp3xx-linux.dts
+++ b/arch/mips/boot/dts/xlp3xx-linux.dts
@@ -11,7 +11,7 @@
 	/*memory range for linux. This will not appear in dom0*/
         memory {
                 device_type = "memory";
-                reg =  <0 0x01000000 0 0x0B000000
+                reg =  <0 0x00000000 0 0x0B000000
                         0 0x20000000 0 0xa0000000
                         0 0xe0000000 0 0x20000000>;
         };
diff --git a/arch/mips/boot/dts/xlp3xx-xmc-linux.dts b/arch/mips/boot/dts/xlp3xx-xmc-linux.dts
index 3e4c624..f7b7eda 100644
--- a/arch/mips/boot/dts/xlp3xx-xmc-linux.dts
+++ b/arch/mips/boot/dts/xlp3xx-xmc-linux.dts
@@ -11,7 +11,7 @@
 	/*memory range for linux. This will not appear in dom0*/
         memory {
                 device_type = "memory";
-                reg =  <0 0x01000000 0 0x0B000000
+                reg =  <0 0x00000000 0 0x0B000000
                         0 0x20000000 0 0x28a00000>;
         };
 
diff --git a/arch/mips/boot/dts/xlp4xx-linux.dts b/arch/mips/boot/dts/xlp4xx-linux.dts
index 09c45287..185745a 100644
--- a/arch/mips/boot/dts/xlp4xx-linux.dts
+++ b/arch/mips/boot/dts/xlp4xx-linux.dts
@@ -11,7 +11,7 @@
 	/*memory range for linux. This will not appear in dom0*/
         memory {
                 device_type = "memory";
-                reg =  <0 0x01000000 0 0x0B000000   
+                reg =  <0 0x00000000 0 0x0B000000   
 			0 0x20000000 0 0x60000000>;  // 1536M at 512M
         };
 
diff --git a/arch/mips/boot/dts/xlp8xx-linux-mn-tmpl.dts b/arch/mips/boot/dts/xlp8xx-linux-mn-tmpl.dts
new file mode 100644
index 0000000..9151099
--- /dev/null
+++ b/arch/mips/boot/dts/xlp8xx-linux-mn-tmpl.dts
@@ -0,0 +1,146 @@
+/*
+ * XLP8XX Device Tree Source for EVP boards
+ */
+
+/dts-v1/;
+/ {
+	model = "netlogic,XLP-EVP";
+	compatible = "netlogic,xlp";
+	#address-cells = <2>;
+	#size-cells = <2>;
+
+	soc {
+		#address-cells = <2>;
+		#size-cells = <1>;
+		compatible = "simple-bus";
+		ranges = <0 0  0 0x18000000  0x04000000   // PCIe CFG
+			  1 0  0 0x16000000  0x02000000>; // GBU chipselects
+
+		/* Node 0 devices */
+		pic0: pic@4000 {
+			compatible = "netlogic,xlp-pic";
+			#address-cells = <0>;
+			#interrupt-cells = <1>;
+			reg = <0 0x4000 0x200>;
+			interrupt-controller;
+		};
+		serial00: serial@30000 {
+			device_type = "serial";
+			compatible = "ns16550";
+			reg = <0 0x30100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <133333333>;
+			interrupt-parent = <&pic0>;
+			interrupts = <17>;
+		};
+		serial01: serial@31000 {
+			device_type = "serial";
+			compatible = "ns16550";
+			reg = <0 0x31100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <133333333>;
+			interrupt-parent = <&pic0>;
+			interrupts = <18>;
+		};
+		i2c00: ocores@32000 {
+			compatible = "opencores,i2c-ocores";
+			#address-cells = <1>;
+			#size-cells = <0>;
+			reg = <0 0x32100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <32000000>;
+			interrupt-parent = <&pic0>;
+			interrupts = <30>;
+
+			rtc@68 {
+				compatible = "dallas,ds1374";
+				reg = <0x68>;
+			};
+
+			dtt@4c {
+				compatible = "national,lm90";
+				reg = <0x4c>;
+			};
+		};
+		i2c01: ocores@33000 {
+			compatible = "opencores,i2c-ocores";
+			#address-cells = <1>;
+			#size-cells = <0>;
+			reg = <0 0x33100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <32000000>;
+			interrupt-parent = <&pic0>;
+			interrupts = <31>;
+
+			rtc@68 {
+				compatible = "dallas,ds1374";
+				reg = <0x68>;
+			};
+
+			dtt@4c {
+				compatible = "national,lm90";
+				reg = <0x4c>;
+			};
+		};
+
+		gpio0: xlp_gpio@34000 {
+			compatible = "netlogic,xlp-gpio";
+			reg = <0 0x34100 0x1000>;
+			#gpio-cells = <2>;
+			gpio-controller;
+			
+			#interrupt-cells = <1>;
+			interrupt-parent = <&pic0>;
+			interrupts = <39>;
+			interrupt-controller;
+		};
+
+		/* Node 1 devices */
+		pic1: pic@44000 {
+			compatible = "netlogic,xlp-pic";
+			#address-cells = <0>;
+			#interrupt-cells = <1>;
+			reg = <0 0x44000 0x200>;
+			interrupt-controller;
+		};
+		serial10: serial@70000 {
+			device_type = "serial";
+			compatible = "ns16550";
+			reg = <0 0x70100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <133333333>;
+			interrupt-parent = <&pic1>;
+			interrupts = <17>;
+		};
+		serial11: serial@71000 {
+			device_type = "serial";
+			compatible = "ns16550";
+			reg = <0 0x71100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <133333333>;
+			interrupt-parent = <&pic1>;
+			interrupts = <18>;
+		};
+		gpio1: xlp_gpio@74000 {
+			compatible = "netlogic,xlp-gpio";
+			reg = <0 0x74000 0x1000>;
+			#gpio-cells = <2>;
+			gpio-controller;
+			
+			#interrupt-cells = <1>;
+			interrupt-parent = <&pic1>;
+			interrupts = <39>;
+			interrupt-controller;
+		};
+	};
+
+	chosen {
+		bootargs = "console=ttyS0,115200 rdinit=/sbin/init";
+	};
+};
diff --git a/arch/mips/boot/dts/xlp8xx-linux-mn4-tmpl.dts b/arch/mips/boot/dts/xlp8xx-linux-mn4-tmpl.dts
new file mode 100644
index 0000000..3e70fe9
--- /dev/null
+++ b/arch/mips/boot/dts/xlp8xx-linux-mn4-tmpl.dts
@@ -0,0 +1,160 @@
+/*
+ * XLP8XX Device Tree Source for EVP boards
+ */
+
+/dts-v1/;
+/ {
+	model = "netlogic,XLP-EVP";
+	compatible = "netlogic,xlp";
+	#address-cells = <2>;
+	#size-cells = <2>;
+
+	soc {
+		#address-cells = <2>;
+		#size-cells = <1>;
+		compatible = "simple-bus";
+		ranges = <0 0  0 0x18000000  0x04000000   // PCIe CFG
+			  1 0  0 0x16000000  0x02000000>; // GBU chipselects
+
+		/* Node 0 devices */
+		pic0: pic@4000 {
+			compatible = "netlogic,xlp-pic";
+			#address-cells = <0>;
+			#interrupt-cells = <1>;
+			reg = <0 0x4000 0x200>;
+			interrupt-controller;
+		};
+		serial00: serial@30000 {
+			device_type = "serial";
+			compatible = "ns16550";
+			reg = <0 0x30100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <133333333>;
+			interrupt-parent = <&pic0>;
+			interrupts = <17>;
+		};
+		serial01: serial@31000 {
+			device_type = "serial";
+			compatible = "ns16550";
+			reg = <0 0x31100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <133333333>;
+			interrupt-parent = <&pic0>;
+			interrupts = <18>;
+		};
+		i2c00: ocores@32000 {
+			compatible = "opencores,i2c-ocores";
+			#address-cells = <1>;
+			#size-cells = <0>;
+			reg = <0 0x32100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <32000000>;
+			interrupt-parent = <&pic0>;
+			interrupts = <30>;
+
+			rtc@68 {
+				compatible = "dallas,ds1374";
+				reg = <0x68>;
+			};
+
+			dtt@4c {
+				compatible = "national,lm90";
+				reg = <0x4c>;
+			};
+		};
+		i2c01: ocores@33000 {
+			compatible = "opencores,i2c-ocores";
+			#address-cells = <1>;
+			#size-cells = <0>;
+			reg = <0 0x33100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <32000000>;
+			interrupt-parent = <&pic0>;
+			interrupts = <31>;
+
+			rtc@68 {
+				compatible = "dallas,ds1374";
+				reg = <0x68>;
+			};
+
+			dtt@4c {
+				compatible = "national,lm90";
+				reg = <0x4c>;
+			};
+		};
+
+		gpio0: xlp_gpio@34000 {
+			compatible = "netlogic,xlp-gpio";
+			reg = <0 0x34100 0x1000>;
+			#gpio-cells = <2>;
+			gpio-controller;
+			
+			#interrupt-cells = <1>;
+			interrupt-parent = <&pic0>;
+			interrupts = <39>;
+			interrupt-controller;
+		};
+
+		/* Node 1 devices */
+		pic1: pic@44000 {
+			compatible = "netlogic,xlp-pic";
+			#address-cells = <0>;
+			#interrupt-cells = <1>;
+			reg = <0 0x44000 0x200>;
+			interrupt-controller;
+		};
+		serial10: serial@70000 {
+			device_type = "serial";
+			compatible = "ns16550";
+			reg = <0 0x70100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <133333333>;
+			interrupt-parent = <&pic1>;
+			interrupts = <17>;
+		};
+		serial11: serial@71000 {
+			device_type = "serial";
+			compatible = "ns16550";
+			reg = <0 0x71100 0xa00>;
+			reg-shift = <2>;
+			reg-io-width = <4>;
+			clock-frequency = <133333333>;
+			interrupt-parent = <&pic1>;
+			interrupts = <18>;
+		};
+		gpio1: xlp_gpio@74000 {
+			compatible = "netlogic,xlp-gpio";
+			reg = <0 0x74000 0x1000>;
+			#gpio-cells = <2>;
+			gpio-controller;
+			
+			#interrupt-cells = <1>;
+			interrupt-parent = <&pic1>;
+			interrupts = <39>;
+			interrupt-controller;
+		};
+		pic2: pic@84000 {
+			compatible = "netlogic,xlp-pic";
+			interrupt-controller;
+			#address-cells = <0>;
+			#interrupt-cells = <1>;
+			reg = <0 0x84000 0x200>;
+		};
+		pic3: pic@c4000 {
+			compatible = "netlogic,xlp-pic";
+			interrupt-controller;
+			#address-cells = <0>;
+			#interrupt-cells = <1>;
+			reg = <0 0xc4000 0x200>;
+		};
+	};
+
+	chosen {
+		bootargs = "console=ttyS0,115200 rdinit=/sbin/init";
+	};
+};
diff --git a/arch/mips/boot/dts/xlp8xx-linux.dts b/arch/mips/boot/dts/xlp8xx-linux.dts
index b7971e4..52655f7 100644
--- a/arch/mips/boot/dts/xlp8xx-linux.dts
+++ b/arch/mips/boot/dts/xlp8xx-linux.dts
@@ -11,7 +11,7 @@
 	/*memory range for linux. This will not appear in dom0*/
         memory {
                 device_type = "memory";
-                reg =  <0 0x01000000 0 0x0B000000
+                reg =  <0 0x00000000 0 0x0B000000
                         0 0x20000000 0 0xa0000000
                         0 0xe0000000 0 0x20000000>;
         };
diff --git a/arch/mips/boot/dts/xlp9xx-linux.dts b/arch/mips/boot/dts/xlp9xx-linux.dts
index 416d235..bdc509e 100644
--- a/arch/mips/boot/dts/xlp9xx-linux.dts
+++ b/arch/mips/boot/dts/xlp9xx-linux.dts
@@ -11,7 +11,7 @@
 
         memory {
                 device_type = "memory";
-                reg =  <0 0x00100000 0 0x0FF00000       // 255M at 1M
+                reg =  <0 0x00000000 0 0x0FF00000       // 255M at 1M
                         0 0x20000000 0 0xa0000000>;     // 2560M at 512M
         };
 
-- 
1.9.1

