From 3bec55a383dadcddac2a7c6bc45c96f82a0aa557 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Thu, 5 Jun 2014 15:45:16 +0800
Subject: [PATCH 1/2] kmap_types.h: Limit KM_TYPE_NR to 15 for systems with 16
 or more cores

Prevent overlap between fixmap mapping and CPU vector page for 16th core.

git.yoctoproject.org/git/linux-yocto-3.10
commit c2a3acc5a9fa1c0b099c44443cf253e4642b87cb standard/axxia/base.

Signed-off-by: Eddy Raineri <eddy.raineri@windriver.com>
---
 arch/arm/include/asm/kmap_types.h | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/arch/arm/include/asm/kmap_types.h b/arch/arm/include/asm/kmap_types.h
index ed77159..c1dce9d 100644
--- a/arch/arm/include/asm/kmap_types.h
+++ b/arch/arm/include/asm/kmap_types.h
@@ -4,6 +4,11 @@
 /*
  * This is the "bare minimum".  AIO seems to require this.
  */
+#if (NR_CPUS > 15)
+/* Prevent overlap between fixmap mapping and CPU vector page for 16th core */
+#define KM_TYPE_NR 15
+#else
 #define KM_TYPE_NR 17
+#endif
 
 #endif
-- 
1.9.2

