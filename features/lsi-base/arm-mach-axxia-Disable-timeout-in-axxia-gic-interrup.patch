From f6f865c1bb16648100b279f15e1ce4675a30069c Mon Sep 17 00:00:00 2001
From: Pengyu Ma <pengyu.ma@windriver.com>
Date: Wed, 25 Dec 2013 18:17:20 +0800
Subject: [PATCH 159/159] arm/mach-axxia: Disable timeout in axxia gic
 interrupt to support kgdb

Timeout trigger BUG_ON when KGDB halt cpu.
So remove time counts that cpu can wait for KGDB.

Signed-off-by: Pengyu Ma <pengyu.ma@windriver.com>
---
 arch/arm/mach-axxia/axxia-gic.c |    7 +------
 1 files changed, 1 insertions(+), 6 deletions(-)

diff --git a/arch/arm/mach-axxia/axxia-gic.c b/arch/arm/mach-axxia/axxia-gic.c
index d2edcef..1071a74 100644
--- a/arch/arm/mach-axxia/axxia-gic.c
+++ b/arch/arm/mach-axxia/axxia-gic.c
@@ -224,7 +224,6 @@ static void axxia_gic_handle_gic_rpc_ipi(void)
 static void axxia_gic_run_gic_rpc(int cpu, axxia_call_func_t *func, void *info)
 {
 	struct axxia_gic_rpc *slot = &__get_cpu_var(axxia_gic_rpc);
-	int timeout;
 
 	/* If the target CPU isn't online, don't bother. */
 	if (!cpu_online(cpu))
@@ -241,14 +240,10 @@ static void axxia_gic_run_gic_rpc(int cpu, axxia_call_func_t *func, void *info)
 	/* Send the IPI. */
 	axxia_gic_raise_softirq(cpumask_of(cpu), AXXIA_RPC);
 
-	timeout = 1000000;
-	while (slot->func && --timeout > 0) {
+	while (slot->func) {
 		axxia_gic_handle_gic_rpc(); /* Execute other CPU requests */
 		cpu_relax();
 	}
-
-	/* We should never hit this! */
-	BUG_ON(timeout == 0);
 }
 
 /*
-- 
1.7.5.4

