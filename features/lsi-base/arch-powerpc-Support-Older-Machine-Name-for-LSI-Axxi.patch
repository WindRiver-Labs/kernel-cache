From eface973af3a16226421430ec4059f2626a5b55c Mon Sep 17 00:00:00 2001
From: John Jacques <john.jacques@lsi.com>
Date: Wed, 16 Apr 2014 14:27:42 -0500
Subject: [PATCH 63/71] arch/powerpc: Support Older Machine Name for LSI Axxia

git://git.yoctoproject.org/linux-yocto-3.10 standard/axxia/base
commit e08c154c278711ba99d26d6076d6bba2e20a4a49

Older U-Boot versions pass ibm,acpx1-4xx instead of lsi,acp.  This
commit adds support for the older name.

Signed-off-by: John Jacques <john.jacques@lsi.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/powerpc/platforms/44x/acpx1.c |    5 +++--
 1 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/platforms/44x/acpx1.c b/arch/powerpc/platforms/44x/acpx1.c
index 934ea0a..467d852 100644
--- a/arch/powerpc/platforms/44x/acpx1.c
+++ b/arch/powerpc/platforms/44x/acpx1.c
@@ -165,7 +165,7 @@ static void smp_acpx14xx_machine_kexec(struct kimage *image)
 	}
 
 	if (!timeout)
-		printk(KERN_ERR "Unable to bring down secondary cpu(s)");
+		pr_err("Unable to bring down secondary cpu(s)");
 
 	for_each_online_cpu(i) {
 		if (i == smp_processor_id())
@@ -253,7 +253,8 @@ static int __init acpx14xx_probe(void)
 {
 	unsigned long root = of_get_flat_dt_root();
 
-	if (!of_flat_dt_is_compatible(root, "lsi,acp"))
+	if (!of_flat_dt_is_compatible(root, "lsi,acp") &&
+	    !of_flat_dt_is_compatible(root, "ibm,acpx1-4xx"))
 		return 0;
 
 	return 1;
-- 
1.7.5.4

