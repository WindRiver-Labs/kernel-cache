From e5cf559e146a898d69ff77a40b4a9041660da0fa Mon Sep 17 00:00:00 2001
From: John Jacques <john.jacques@lsi.com>
Date: Tue, 11 Mar 2014 09:20:51 -0500
Subject: [PATCH 53/71] arch/powerpc: Disable the ACP NAND Driver for 3500

git://git.yoctoproject.org/linux-yocto-3.10 standard/axxia/base
commit c6f030f1be690dbef9eb895e2b3f6c8288bdf501

Added code to check for the existence of the NAND driver for
3500. If the driver does not exist then the error is returned
gracefully

Signed-off-by: John Jacques <john.jacques@lsi.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 drivers/mtd/nand/lsi_acp_nand.c |    7 +++++++
 1 files changed, 7 insertions(+), 0 deletions(-)

diff --git a/drivers/mtd/nand/lsi_acp_nand.c b/drivers/mtd/nand/lsi_acp_nand.c
index 0379021..4a4f48a 100644
--- a/drivers/mtd/nand/lsi_acp_nand.c
+++ b/drivers/mtd/nand/lsi_acp_nand.c
@@ -3433,6 +3433,13 @@ lsi_nand_init(void)
 	static const char *part_probe_types[]
 	= { "cmdlinepart", "ofpart", NULL };
 
+	np = of_find_compatible_node(NULL, NULL, "lsi,acp3500");
+
+	if (NULL != np) {
+		pr_err("NAND Support is Not Yet Available on 3500\n");
+		return -1;
+	}
+
 	memset(&ppdata, 0, sizeof(ppdata));
 
 	np = of_find_node_by_type(np, "nand");
-- 
1.7.5.4

