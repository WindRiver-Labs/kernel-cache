From b421281e1075782c43d729a45b63351b6341073f Mon Sep 17 00:00:00 2001
From: Anders Berg <anders.berg@lsi.com>
Date: Fri, 24 Jan 2014 15:20:39 +0100
Subject: [PATCH 28/71] Revert "LSI AXM55XX: Disable use of wfe/sev in arch
 spinlock"

git://git.yoctoproject.org/linux-yocto-3.10 standard/axxia/base
commit: 99c64e75935c65b57bcd0d592c75e1c6501f045c

This reverts commit ae0c53fc61475c63150beb6cddf8ef343b3903e1.

Signed-off-by: Anders Berg <anders.berg@lsi.com>
Signed-off-by: Zhong Hongbo <hongbo.zhong@windriver.com>
---
 arch/arm/include/asm/spinlock.h |    5 -----
 1 files changed, 0 insertions(+), 5 deletions(-)

diff --git a/arch/arm/include/asm/spinlock.h b/arch/arm/include/asm/spinlock.h
index 93484de..b07c09e 100644
--- a/arch/arm/include/asm/spinlock.h
+++ b/arch/arm/include/asm/spinlock.h
@@ -37,9 +37,6 @@
 						\
 	"nop.w"					\
 )
-#elif CONFIG_ARCH_AXXIA || CONFIG_ARCH_AXXIA_SIM
-#define SEV
-#define WFE(cond)
 #else
 #define SEV		ALT_SMP("sev", "nop")
 #define WFE(cond)	ALT_SMP("wfe" cond, "nop")
@@ -91,9 +88,7 @@ static inline void arch_spin_lock(arch_spinlock_t *lock)
 	: "cc");
 
 	while (lockval.tickets.next != lockval.tickets.owner) {
-#if !CONFIG_ARCH_AXXIA && !CONFIG_ARCH_AXXIA_SIM
 		wfe();
-#endif
 		lockval.tickets.owner = ACCESS_ONCE(lock->tickets.owner);
 	}
 
-- 
1.7.5.4

