From 436bdb2fd85ac26e1a99d197c85719cfeacac879 Mon Sep 17 00:00:00 2001
From: David Mercado <david.mercado@windriver.com>
Date: Wed, 20 Nov 2013 17:15:39 -0500
Subject: [PATCH 152/175] LSI ACP34XX: Fix interrupts specification for ACP34xx dts files

git.yoctoproject.org/git/linux-yocto-3.10
commit e6a165292b33837e0e74ebe07c0658354004550e standard/axxia/base.

The MPIC: interrupt-controller #interrupt-cells is <2>, which requires
at least two parameters for a device's "interrupts" list.  Update the
plb device's "interrupts" entries in the acp34xx.dts files to include
an interrupt number and an interrupt level/edge trigger, to fix a
a mismatch with the MPIC: interrupt-controller's #interrupt-cells.

This fixes a failure when the device's interrupt is looked up in
the Open Firmware device tree (e.g. irq_of_parse_and_map).

Signed-off-by: Hong H. Pham <hong.pham@windriver.com>
---
 arch/powerpc/boot/dts/acp342x.dts |   12 ++++++------
 arch/powerpc/boot/dts/acp344x.dts |   12 ++++++------
 2 files changed, 12 insertions(+), 12 deletions(-)

diff --git a/arch/powerpc/boot/dts/acp342x.dts b/arch/powerpc/boot/dts/acp342x.dts
index 4db67df..b851788 100644
--- a/arch/powerpc/boot/dts/acp342x.dts
+++ b/arch/powerpc/boot/dts/acp342x.dts
@@ -97,7 +97,7 @@
                                 clock-frequency = <0xbebc200>;
                                 current-speed = <9600>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <22>;
+                                interrupts = <22 4>;
                         };
                         UART1: serial@00405000 {
                                 device_type = "serial";
@@ -108,7 +108,7 @@
                                 clock-frequency = <200000000>;
                                 current-speed = <9600>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <23>;
+                                interrupts = <23 4>;
                         };
                         USB0: usb@004a4000 {
                                 device_type = "usb";
@@ -116,21 +116,21 @@
                                 enabled = <0>;
                                 reg = <0x004a4000 0x00020000>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <31>;
+                                interrupts = <31 4>;
                         };
                         I2C: i2c@00403000 {
                                 compatible = "acp-i2c";
                                 enabled = <0>;
                                 reg = <0x00403000 0x00001000>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <21>;
+                                interrupts = <21 4>;
                         };
                         SSP: ssp@00402000 {
                                 compatible = "acp-ssp";
                                 enabled = <0>;
                                 reg = <0x00402000 0x00001000>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <20>;
+                                interrupts = <20 4>;
                         };
                         NAND: nand@00440000 {
                                 device_type = "nand";
@@ -147,7 +147,7 @@
                                        0x00481000 0x1000
                                        0x00482000 0x1000>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <33>;
+                                interrupts = <33 4>;
                                 mdio-reg = <0x00409000 0x1000>;
                                 // The following will get filled in by
                                 // the boot loader.
diff --git a/arch/powerpc/boot/dts/acp344x.dts b/arch/powerpc/boot/dts/acp344x.dts
index 4db67df..b851788 100644
--- a/arch/powerpc/boot/dts/acp344x.dts
+++ b/arch/powerpc/boot/dts/acp344x.dts
@@ -97,7 +97,7 @@
                                 clock-frequency = <0xbebc200>;
                                 current-speed = <9600>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <22>;
+                                interrupts = <22 4>;
                         };
                         UART1: serial@00405000 {
                                 device_type = "serial";
@@ -108,7 +108,7 @@
                                 clock-frequency = <200000000>;
                                 current-speed = <9600>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <23>;
+                                interrupts = <23 4>;
                         };
                         USB0: usb@004a4000 {
                                 device_type = "usb";
@@ -116,21 +116,21 @@
                                 enabled = <0>;
                                 reg = <0x004a4000 0x00020000>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <31>;
+                                interrupts = <31 4>;
                         };
                         I2C: i2c@00403000 {
                                 compatible = "acp-i2c";
                                 enabled = <0>;
                                 reg = <0x00403000 0x00001000>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <21>;
+                                interrupts = <21 4>;
                         };
                         SSP: ssp@00402000 {
                                 compatible = "acp-ssp";
                                 enabled = <0>;
                                 reg = <0x00402000 0x00001000>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <20>;
+                                interrupts = <20 4>;
                         };
                         NAND: nand@00440000 {
                                 device_type = "nand";
@@ -147,7 +147,7 @@
                                        0x00481000 0x1000
                                        0x00482000 0x1000>;
                                 interrupt-parent = <&MPIC>;
-                                interrupts = <33>;
+                                interrupts = <33 4>;
                                 mdio-reg = <0x00409000 0x1000>;
                                 // The following will get filled in by
                                 // the boot loader.
-- 
1.7.1

