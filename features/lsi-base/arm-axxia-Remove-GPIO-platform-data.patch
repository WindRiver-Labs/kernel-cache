From c513c118917dcbb6782d881df6733f5614c4deed Mon Sep 17 00:00:00 2001
From: Li Wang <li.wang@windriver.com>
Date: Tue, 25 Aug 2015 14:09:30 +0800
Subject: [PATCH 08/68] arm: axxia: Remove GPIO platform data

the patch comes from:
git://git.yoctoproject.org/linux-yocto-3.10
commit 588db1251aa9020b4d42b9bf042936e8215abe25 upstream

Use DT based config for GPIO and drop the platform data setup.

Signed-off-by: Anders Berg <anders.berg@avagotech.com>
Signed-off-by: Bruce Ashfield <bruce.ashfield@windriver.com>
Signed-off-by: Li Wang <li.wang@windriver.com>
---
 arch/arm/boot/dts/axm55xx.dtsi |    6 ++++++
 arch/arm/mach-axxia/axxia.c    |   18 ------------------
 2 files changed, 6 insertions(+), 18 deletions(-)

diff --git a/arch/arm/boot/dts/axm55xx.dtsi b/arch/arm/boot/dts/axm55xx.dtsi
index 801f50e..ad2fcb0 100644
--- a/arch/arm/boot/dts/axm55xx.dtsi
+++ b/arch/arm/boot/dts/axm55xx.dtsi
@@ -15,6 +15,8 @@
 	interrupt-parent = <&gic>;
 
 	aliases {
+		gpio0     = &gpio0;
+		gpio1     = &gpio1;
 		serial0	  = &serial0;
 		serial1   = &serial1;
 		serial2	  = &serial2;
@@ -344,6 +346,8 @@
 					     <0 15 4>,
 					     <0 16 4>,
 					     <0 17 4>;
+				interrupt-controller;
+				#interrupt-cells = <2>;
 				status = "disabled";
 			};
 
@@ -353,6 +357,8 @@
 				gpio-controller;
 				reg = <0x20 0x10093000 0x00 0x1000>;
 				interrupts = <0 18 4>;
+				interrupt-controller;
+				#interrupt-cells = <2>;
 				status = "disabled";
 			};
 
diff --git a/arch/arm/mach-axxia/axxia.c b/arch/arm/mach-axxia/axxia.c
index 5d3c3d3..16689da 100644
--- a/arch/arm/mach-axxia/axxia.c
+++ b/arch/arm/mach-axxia/axxia.c
@@ -152,27 +152,9 @@ static struct mmci_platform_data mmc_plat_data = {
 	.gpio_cd  = -ENOSYS
 };
 
-struct pl061_platform_data gpio0_plat_data = {
-	.gpio_base  = 0,
-	.irq_base   = 0,
-	.directions = 0,	/* startup directions, 1: out, 0: in */
-	.values     = 0		/* startup values */
-};
-
-struct pl061_platform_data gpio1_plat_data = {
-	.gpio_base  = 8,
-	.irq_base   = 0,
-	.directions = 0,	/* startup directions, 1: out, 0: in */
-	.values     = 0		/* startup values */
-};
-
 static struct of_dev_auxdata axxia_auxdata_lookup[] __initdata = {
 	OF_DEV_AUXDATA("arm,primecell", 0x20101E0000ULL,
 		       "mmci",  &mmc_plat_data),
-	OF_DEV_AUXDATA("arm,primecell", 0x2010092000ULL,
-		       "gpio0", &gpio0_plat_data),
-	OF_DEV_AUXDATA("arm,primecell", 0x2010093000ULL,
-		       "gpio1", &gpio1_plat_data),
 	{}
 };
 
-- 
1.7.5.4

