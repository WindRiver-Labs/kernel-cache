From 680b4953b987672c2a8a8b03784ba52d0a2d9f72 Mon Sep 17 00:00:00 2001
From: Paul Butler <paul.butler@windriver.com>
Date: Thu, 25 Apr 2013 16:13:08 +0800
Subject: [PATCH 020/159] arm/asm/io.h: let ioremap() fall back to platform
 specific one

git.yoctoproject.org/git/linux-yocto-3.10
commit 72ffd07dc014c0eda536cda8d87df3ca7530cb9e standard/axxia/base.

Signed-off-by: Paul Butler <paul.butler@windriver.com>
---
 arch/arm/include/asm/io.h |   20 +++++++++++++++-----
 1 files changed, 15 insertions(+), 5 deletions(-)

diff --git a/arch/arm/include/asm/io.h b/arch/arm/include/asm/io.h
index 652b560..723409c 100644
--- a/arch/arm/include/asm/io.h
+++ b/arch/arm/include/asm/io.h
@@ -325,11 +325,21 @@ extern void _memset_io(volatile void __iomem *, int, size_t);
  * Documentation/io-mapping.txt.
  *
  */
-#define ioremap(cookie,size)		__arm_ioremap((cookie), (size), MT_DEVICE)
-#define ioremap_nocache(cookie,size)	__arm_ioremap((cookie), (size), MT_DEVICE)
-#define ioremap_cached(cookie,size)	__arm_ioremap((cookie), (size), MT_DEVICE_CACHED)
-#define ioremap_wc(cookie,size)		__arm_ioremap((cookie), (size), MT_DEVICE_WC)
-#define iounmap				__arm_iounmap
+
+#ifndef __arch_ioremap
+#define __arch_ioremap			__arm_ioremap
+#define __arch_iounmap			__iounmap
+#endif
+
+#define ioremap(cookie, size) \
+	__arch_ioremap((cookie), (size), MT_DEVICE)
+#define ioremap_nocache(cookie, size) \
+	__arch_ioremap((cookie), (size), MT_DEVICE)
+#define ioremap_cached(cookie, size) \
+	__arch_ioremap((cookie), (size), MT_DEVICE_CACHED)
+#define ioremap_wc(cookie, size) \
+	__arch_ioremap((cookie), (size), MT_DEVICE_WC)
+#define iounmap				__arch_iounmap
 
 /*
  * io{read,write}{8,16,32} macros
-- 
1.7.5.4

