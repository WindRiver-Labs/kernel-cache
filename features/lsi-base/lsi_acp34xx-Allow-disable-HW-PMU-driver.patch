From 5102b83ab6b74830d334b335fcdd66d40f33919f Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Mon, 30 Dec 2013 08:09:46 +0000
Subject: [PATCH 9/9] lsi_acp34xx:Allow disable HW PMU driver

Update kconfig to allow user disable HW PMU option instead of
enable it by default.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 arch/powerpc/oprofile/common.c         |    2 ++
 arch/powerpc/platforms/Kconfig.cputype |    1 -
 2 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/oprofile/common.c b/arch/powerpc/oprofile/common.c
index 2465683..c81bed6 100644
--- a/arch/powerpc/oprofile/common.c
+++ b/arch/powerpc/oprofile/common.c
@@ -220,9 +220,11 @@ int __init oprofile_arch_init(struct oprofile_operations *ops)
 			model = &op_model_pa6t;
 			break;
 #endif
+#ifdef CONFIG_ACP_PMU_PERFMON
 		case PPC_OPROFILE_ACP_PMU:
 			model = &op_model_acp_pmu;
 			break;
+#endif
 #ifdef CONFIG_6xx
 		case PPC_OPROFILE_G4:
 			model = &op_model_7450;
diff --git a/arch/powerpc/platforms/Kconfig.cputype b/arch/powerpc/platforms/Kconfig.cputype
index 4304e0b..0473f88 100644
--- a/arch/powerpc/platforms/Kconfig.cputype
+++ b/arch/powerpc/platforms/Kconfig.cputype
@@ -188,7 +188,6 @@ config FSL_EMB_PERF_EVENT_E500
 
 config 4xx
 	bool
-	select ACP_PMU_PERFMON
 	depends on 40x || 44x
 	default y
 
-- 
1.7.5.4

