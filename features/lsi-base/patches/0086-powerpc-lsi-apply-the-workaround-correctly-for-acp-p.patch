From bb6a08f32c6ac5a09c40b23fbd0fcb2816340cc3 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Tue, 17 Dec 2013 09:45:17 +0000
Subject: [PATCH] powerpc/lsi: apply the workaround correctly for acp pcie

There is a typo in the check whether we should apply the
workaround for acp pcie, and it will cause the PIO malfunction
due to the tpage not setting up correctly.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 arch/powerpc/sysdev/lsi_pci.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/powerpc/sysdev/lsi_pci.c b/arch/powerpc/sysdev/lsi_pci.c
index ada78ad..e4b4500 100644
--- a/arch/powerpc/sysdev/lsi_pci.c
+++ b/arch/powerpc/sysdev/lsi_pci.c
@@ -773,7 +773,7 @@ configure_acp_pciex_PIMs(struct pciex_port *port,
 		 * For the address field we simply program an incrementing value
 		 * to map consecutive pages
 		 */
-		if (acp_plx == 0) {
+		if (acp_plx) {
 			int i;
 
 			for (i = 0; i < 8; i++) {
-- 
1.9.1

