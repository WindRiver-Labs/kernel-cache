From 1789d19d6134575c7060edca6a3ae2d71da4dca6 Mon Sep 17 00:00:00 2001
From: Steven Rostedt <rostedt@goodmis.org>
Date: Wed, 8 Oct 2008 14:53:22 -0400
Subject: [PATCH] [PATCH] [BUG RT] WARNING: at kernel/sched.c:5071 2.6.23-rc1-rt7

From 63cd77f20eeacb0ce5462883ef9b0e4271bbb978 Mon Sep 17 00:00:00 2001
Subject: [PATCH] [BUG RT] WARNING: at kernel/sched.c:5071 2.6.23-rc1-rt7
 The below ifndef, shouldn't that be ifndef CONFIG_PREEMPT_SOFTIRQS ?
 I hit that warning while I was running !PREEMPT_RT but with both hard
 and softiqs as threads.
---
 kernel/sched.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/kernel/sched.c b/kernel/sched.c
index eb4a31d..ffc090e 100644
--- a/kernel/sched.c
+++ b/kernel/sched.c
@@ -5552,7 +5552,9 @@ EXPORT_SYMBOL(cond_resched_lock);
  */
 int __sched cond_resched_softirq(void)
 {
+#ifndef CONFIG_PREEMPT_SOFTIRQS
 	WARN_ON_ONCE(!in_softirq());
+#endif
 
 	if (need_resched() && system_state == SYSTEM_RUNNING) {
 		local_bh_enable();
-- 
1.5.5.1

