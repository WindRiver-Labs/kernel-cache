From 4089af6291472e1a40c6b18ae4e426dce99b3122 Mon Sep 17 00:00:00 2001
From: Yang Shi <yang.shi@windriver.com>
Date: Fri, 19 Apr 2013 11:23:49 -0700
Subject: [PATCH] KVM: lapic: Replace remain kvm_timer_fn to apic_timer_fn

kvm_timer_fn is not available anymore, so replace it to the new
interface, apic_timer_fn.

Signed-off-by: Yang Shi <yang.shi@windriver.com>

diff --git a/arch/x86/kvm/lapic.c b/arch/x86/kvm/lapic.c
index 67c6d4c..ffd1ecc 100644
--- a/arch/x86/kvm/lapic.c
+++ b/arch/x86/kvm/lapic.c
@@ -74,6 +74,8 @@
 static unsigned int min_timer_period_us = 500;
 module_param(min_timer_period_us, uint, S_IRUGO | S_IWUSR);
 
+static enum hrtimer_restart apic_timer_fn(struct hrtimer *);
+
 static inline void apic_set_reg(struct kvm_lapic *apic, int reg_off, u32 val)
 {
 	*((u32 *) (apic->regs + reg_off)) = val;
@@ -986,7 +988,7 @@ again:
 		if (hrtimer_start(&apic->lapic_timer.timer,
 				  ktime_add_ns(now, apic->lapic_timer.period),
 				  HRTIMER_MODE_ABS) == -ETIME) {
-			if (kvm_timer_fn(&apic->lapic_timer.timer) == HRTIMER_RESTART)
+			if (apic_timer_fn(&apic->lapic_timer.timer) == HRTIMER_RESTART)
 				goto again;
 		}
 
-- 
1.8.1.2

