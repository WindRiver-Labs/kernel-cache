From 969e2ee3603ff3f4fe2d8434a563958021affa7e Mon Sep 17 00:00:00 2001
From: Corey Minyard <cminyard@mvista.com>
Date: Tue, 17 Jul 2012 19:38:06 -0500
Subject: [PATCH 05/18] Fix a compiler issue with MSA_NOW.

From the upstream project:
git://microstate.git.sourceforge.net/gitroot/microstate/linux-msa

Signed-off-by: Corey Minyard <cminyard@mvista.com>
---
 include/asm-generic/msa.h |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/include/asm-generic/msa.h b/include/asm-generic/msa.h
index c995b99..c84fb95 100644
--- a/include/asm-generic/msa.h
+++ b/include/asm-generic/msa.h
@@ -12,7 +12,7 @@
  * Every architecture is supposed to provide sched_clock, a free-running,
  * non-wrapping, per-cpu clock in nanoseconds.
  */
-#  define MSA_NOW(now)  do { (now) = sched_clock(); } while (0)
+#  define MSA_NOW(now) do { (now) = cpu_clock(smp_processor_id()); } while (0)
 #  define MSA_TO_NSEC(clk) (clk)
 #  define MICROSTATE_ACCT_USING_SCHED_CLOCK
 # endif
-- 
1.7.9.7

