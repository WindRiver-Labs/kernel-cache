From a3967138ca138b2ebbb9ec608336b863391689a1 Mon Sep 17 00:00:00 2001
From: Corey Minyard <cminyard@mvista.com>
Date: Thu, 11 Oct 2012 15:56:34 -0500
Subject: [PATCH 12/18] msa-mips: Fix a possible improper user return

MSA_USER may mess up t0, but that would result in the next
statement being incorrect.  Add an unconditional jump to
where the code should go in the MSA_USER case.

Signed-off-by: Corey Minyard <cminyard@mvista.com>
---
 arch/mips/kernel/entry.S |    1 +
 1 file changed, 1 insertion(+)

diff --git a/arch/mips/kernel/entry.S b/arch/mips/kernel/entry.S
index 0482434..222fb02 100644
--- a/arch/mips/kernel/entry.S
+++ b/arch/mips/kernel/entry.S
@@ -159,6 +159,7 @@ work_resched:
 #ifdef CONFIG_MICROSTATE_ACCT
 	bnez    t0, msa_user_skip
 	MSA_USER
+	j	restore_all
 msa_user_skip:
 #endif
 	beqz	t0, restore_all
-- 
1.7.9.7

