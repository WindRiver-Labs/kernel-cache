From d865483872ad9449a4c62dfa789277e01b34dad0 Mon Sep 17 00:00:00 2001
From: Corey Minyard <cminyard@mvista.com>
Date: Thu, 30 Aug 2012 13:01:53 -0500
Subject: [PATCH 08/18] x86-msa: Fix the IRQ number

From the upstream project:
git://microstate.git.sourceforge.net/gitroot/microstate/linux-msa

The vector, not the IRQ, was being reported for interrupts.  Switch
to the irq#.

Signed-off-by: Corey Minyard <cminyard@mvista.com>
---
 arch/x86/kernel/irq.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/arch/x86/kernel/irq.c b/arch/x86/kernel/irq.c
index 86cadf9..655f151 100644
--- a/arch/x86/kernel/irq.c
+++ b/arch/x86/kernel/irq.c
@@ -192,7 +192,7 @@ unsigned int __irq_entry do_IRQ(struct pt_regs *regs)
 
 	irq = __this_cpu_read(vector_irq[vector]);
 
-	msa_start_irq(vector);
+	msa_start_irq(irq);
 
 	if (!handle_irq(irq, regs)) {
 		ack_APIC_irq();
@@ -202,7 +202,7 @@ unsigned int __irq_entry do_IRQ(struct pt_regs *regs)
 				__func__, smp_processor_id(), vector, irq);
 	}
 
-	msa_irq_exit(vector, regs->cs != __KERNEL_CS);
+	msa_irq_exit(irq, regs->cs != __KERNEL_CS);
 
 	set_irq_regs(old_regs);
 	return 1;
-- 
1.7.9.7

