From ed0a530c6ed15d669e49501406801b0f6f8d1dc0 Mon Sep 17 00:00:00 2001
From: Corey Minyard <cminyard@mvista.com>
Date: Tue, 16 Oct 2012 10:59:39 -0500
Subject: [PATCH 14/18] msa-x86: Add MSA info to schedule_ipi()

From the upstream project:
git://microstate.git.sourceforge.net/gitroot/microstate/linux-msa

Signed-off-by: Corey Minyard <cminyard@mvista.com>
---
 arch/x86/kernel/smp.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/arch/x86/kernel/smp.c b/arch/x86/kernel/smp.c
index 54403a4..ed272b4 100644
--- a/arch/x86/kernel/smp.c
+++ b/arch/x86/kernel/smp.c
@@ -261,7 +261,8 @@ void smp_reschedule_interrupt(struct pt_regs *regs)
 {
 	ack_APIC_irq();
 	inc_irq_stat(irq_resched_count);
-	scheduler_ipi();
+	scheduler_ipi(SCHED_IPI_PARMSET(RESCHEDULE_VECTOR,
+					regs->cs != __KERNEL_CS));
 	/*
 	 * KVM uses this interrupt to force a cpu out of guest mode
 	 */
-- 
1.7.9.7

