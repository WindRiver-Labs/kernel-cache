From d9ff0ecaf4db984ee5e6e9105411a58cdc5b2198 Mon Sep 17 00:00:00 2001
From: Simon Marchi <simon.marchi@polymtl.ca>
Date: Fri, 23 Nov 2012 18:10:38 -0500
Subject: [PATCH 43/55] Fix compilation for 3.0 branch (>= 3.0.39)

commit 49bafb1440249c0f4e7d5161ef0ef8ae871102bf lttng.org/lttng-modules.git

The isolate_mode_t type that appeared in 3.2 was backported to 3.0.39 so
the version check must be fixed. It was not backported to the 3.1 branch
though, so it must be excluded.

Signed-off-by: Simon Marchi <simon.marchi@polymtl.ca>
Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com>
Signed-off-by: Paul Barrette <paul.barrette@windriver.com>
---
 drivers/staging/lttng2/probes/lttng-probe-vmscan.c |    5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/drivers/staging/lttng2/probes/lttng-probe-vmscan.c b/drivers/staging/lttng2/probes/lttng-probe-vmscan.c
index 2abd0e4..0205c7e 100644
--- a/drivers/staging/lttng2/probes/lttng-probe-vmscan.c
+++ b/drivers/staging/lttng2/probes/lttng-probe-vmscan.c
@@ -30,6 +30,8 @@
  */
 #include <trace/events/vmscan.h>
 
+#include "../lttng-kernel-version.h"
+
 /*
  * Create LTTng tracepoint probes.
  */
@@ -37,7 +39,8 @@
 #define CREATE_TRACE_POINTS
 #define TRACE_INCLUDE_PATH ../instrumentation/events/lttng-module
 
-#if (LINUX_VERSION_CODE < KERNEL_VERSION(3,2,0))
+#if (LINUX_VERSION_CODE <= KERNEL_VERSION(3,0,38)) || \
+	LTTNG_KERNEL_RANGE(3,1,0, 3,1,10)
 typedef int isolate_mode_t;
 #endif
 
-- 
1.7.9.7

