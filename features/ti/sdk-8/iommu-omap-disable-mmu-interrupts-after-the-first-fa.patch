From 2cf27f8afbb84217c95031385fe5b14cd591a7e3 Mon Sep 17 00:00:00 2001
From: "Guzman Lugo, Fernando" <fernando.lugo@ti.com>
Date: Sun, 18 Sep 2011 08:42:36 +0300
Subject: [PATCH 0972/1587] iommu/omap: disable mmu interrupts after the first
 fault

Signed-off-by: Guzman Lugo, Fernando <fernando.lugo@ti.com>
[zou: Original patch taken from
ti-sdk-am335x-evm-08.00.00.00-Linux-x86-Install.bin]
Signed-off-by: Cao Zou <cao.zou@windriver.com>
---
 drivers/iommu/omap-iommu.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/iommu/omap-iommu.c b/drivers/iommu/omap-iommu.c
index 7306449..a111ea9 100644
--- a/drivers/iommu/omap-iommu.c
+++ b/drivers/iommu/omap-iommu.c
@@ -823,7 +823,7 @@ static irqreturn_t iommu_fault_handler(int irq, void *data)
 	if (!report_iommu_fault(domain, obj->dev, da, 0))
 		return IRQ_HANDLED;
 
-	iommu_disable(obj);
+	iommu_write_reg(obj, 0, MMU_IRQENABLE);
 
 	iopgd = iopgd_offset(obj, da);
 
-- 
1.7.5.4

