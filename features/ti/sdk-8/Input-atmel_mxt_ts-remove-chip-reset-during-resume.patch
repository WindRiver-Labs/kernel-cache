From 8c556811c627b652cb7577a2172791798f902d69 Mon Sep 17 00:00:00 2001
From: Sekhar Nori <nsekhar@ti.com>
Date: Fri, 12 Sep 2014 16:58:04 +0530
Subject: [PATCH 1203/1587] Input: atmel_mxt_ts: remove chip reset during
 resume

Upstream commit 9d469d033d13 ("Input: atmel_mxt_ts - use
deep sleep mode when stopped") removes reset of touchscreen
chip during resume calling it "counterproductive" and "resulting
in a long delay".

During testing on TI DRA7x EVM, this chip reset is seen to result
in large stream of "__mxt_read_reg: i2c transfer failed (-121)"
messages due to an interrupt occurring while the chip is in
reset (why the touchscreen interrupt triggers is still unknown).

Remove chip reset during resume like upstream code.

Power consumption should remain the same before and after this patch
as we only remove reset from resume and do not touch suspend path (which
incidentally does not issue a reset).

Acked-by: Felipe Balbi <balbi@ti.com>
Signed-off-by: Sekhar Nori <nsekhar@ti.com>
[zou: Original patch taken from
ti-sdk-am335x-evm-08.00.00.00-Linux-x86-Install.bin]
Signed-off-by: Cao Zou <cao.zou@windriver.com>
---
 drivers/input/touchscreen/atmel_mxt_ts.c |    6 ------
 1 files changed, 0 insertions(+), 6 deletions(-)

diff --git a/drivers/input/touchscreen/atmel_mxt_ts.c b/drivers/input/touchscreen/atmel_mxt_ts.c
index 69325a6..92102e1 100644
--- a/drivers/input/touchscreen/atmel_mxt_ts.c
+++ b/drivers/input/touchscreen/atmel_mxt_ts.c
@@ -1415,12 +1415,6 @@ static int mxt_resume(struct device *dev)
 	struct mxt_data *data = i2c_get_clientdata(client);
 	struct input_dev *input_dev = data->input_dev;
 
-	/* Soft reset */
-	mxt_write_object(data, MXT_GEN_COMMAND_T6,
-			MXT_COMMAND_RESET, 1);
-
-	msleep(MXT_RESET_TIME);
-
 	mutex_lock(&input_dev->mutex);
 
 	if (input_dev->users)
-- 
1.7.5.4

