From e93942ec0745649e49d541edb725bce5354c3fef Mon Sep 17 00:00:00 2001
From: Benoit Parrot <bparrot@ti.com>
Date: Thu, 20 Nov 2014 17:29:09 -0600
Subject: [PATCH 1454/1587] v4l: ti-vpe: vip: remove compiler warnings

- Remove compiler warnings
- Add copyright header
- Removed #if 0 around helper functions - call with default values

Signed-off-by: Nikhil Devshatwar <nikhil.nd@ti.com>
Signed-off-by: Benoit Parrot <bparrot@ti.com>
[zou: Original patch taken from
ti-sdk-am335x-evm-08.00.00.00-Linux-x86-Install.bin]
Signed-off-by: Cao Zou <cao.zou@windriver.com>
---
 drivers/media/platform/ti-vpe/vip.c |   24 ++++++------------------
 drivers/media/platform/ti-vpe/vip.h |    6 +++---
 2 files changed, 9 insertions(+), 21 deletions(-)

diff --git a/drivers/media/platform/ti-vpe/vip.c b/drivers/media/platform/ti-vpe/vip.c
index dc519f8..44d1cca 100644
--- a/drivers/media/platform/ti-vpe/vip.c
+++ b/drivers/media/platform/ti-vpe/vip.c
@@ -2,10 +2,10 @@
  * TI VIP capture driver
  *
  * Copyright (C) 2013 - 2014 Texas Instruments, Inc.
- * Benoit Parrot, <bparrot@ti.com>
- *
- * Based on original work by Dale Farnsworth.
+ * David Griego, <dagriego@biglakesoftware.com>
  * Dale Farnsworth, <dale@farnsworth.org>
+ * Nikhil Devshatwar, <nikhil.nd@ti.com>
+ * Benoit Parrot, <bparrot@ti.com>
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License version 2 as
@@ -932,21 +932,6 @@ static void vip_set_slice_path(struct vip_dev *dev,
 	}
 }
 
-/* This are unused function for now.
- * Just declare them to quiet down the compiler.
- */
-struct dfn_holder {
-	void (*reset_port)(struct vip_port *port);
-	void (*xtra_set_repack_sel)(struct vip_port *port, int repack_mode);
-	void (*set_actvid_hsync_n)(struct vip_port *port, int enable);
-};
-
-static const struct dfn_holder s_dfn = {
-	.reset_port = vip_reset_port,
-	.xtra_set_repack_sel = vip_xtra_set_repack_sel,
-	.set_actvid_hsync_n = vip_set_actvid_hsync_n,
-};
-
 /*
  * Return the vip_stream structure for a given struct file
  */
@@ -1998,6 +1983,7 @@ static int vip_setup_parser(struct vip_port *port)
 	int sync_type;
 	unsigned int flags;
 
+	vip_reset_port(port);
 	vip_set_port_enable(port, 1);
 
 	if (endpoint->bus_type == V4L2_MBUS_BT656) {
@@ -2055,6 +2041,8 @@ static int vip_setup_parser(struct vip_port *port)
 			vip_set_pclk_polarity(port,
 				flags & V4L2_MBUS_PCLK_SAMPLE_RISING ? 1 : 0);
 
+		vip_xtra_set_repack_sel(port, 0);
+		vip_set_actvid_hsync_n(port, 0);
 		vip_set_actvid_polarity(port, 1);
 		vip_set_discrete_basic_mode(port);
 
diff --git a/drivers/media/platform/ti-vpe/vip.h b/drivers/media/platform/ti-vpe/vip.h
index 711c11a..ee610cb 100644
--- a/drivers/media/platform/ti-vpe/vip.h
+++ b/drivers/media/platform/ti-vpe/vip.h
@@ -2,10 +2,10 @@
  * TI VIP capture driver
  *
  * Copyright (C) 2013 - 2014 Texas Instruments, Inc.
- * Benoit Parrot, <bparrot@ti.com>
- *
- * Based on original work by Dale Farnsworth.
+ * David Griego, <dagriego@biglakesoftware.com>
  * Dale Farnsworth, <dale@farnsworth.org>
+ * Nikhil Devshatwar, <nikhil.nd@ti.com>
+ * Benoit Parrot, <bparrot@ti.com>
  *
  * This program is free software; you can redistribute it and/or modify
  * it under the terms of the GNU General Public License version 2 as
-- 
1.7.5.4

