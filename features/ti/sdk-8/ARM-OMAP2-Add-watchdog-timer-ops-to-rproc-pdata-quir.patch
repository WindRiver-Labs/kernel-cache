From 0a0ff3e7b14aaca49f5ad58712e3e7cd094a362e Mon Sep 17 00:00:00 2001
From: Suman Anna <s-anna@ti.com>
Date: Tue, 5 Aug 2014 16:36:25 -0500
Subject: [PATCH 1065/1587] ARM: OMAP2+: Add watchdog timer ops to rproc pdata
 quirks

The OMAP remoteproc driver achieves watchdog functionality by
registering and handling a timer interrupt, which is triggered
upon a watchdog condition on the remote processor. The OMAP
DMTimer API though is limited to only the arch/arm/ layers,
so the API needs to be accessed through OMAP rproc platform
data ops.

Add the ops for retrieving a DMTimer IRQ id, and for clearing
the Timer IRQ status (minimum ops required for watchdog
functionality in addition to other DMTimer ops) to the common
timer ops for both the IPU and DSP platform devices on OMAP4
and OMAP5 SoCs.

Signed-off-by: Suman Anna <s-anna@ti.com>
[zou: Original patch taken from
ti-sdk-am335x-evm-08.00.00.00-Linux-x86-Install.bin]
Signed-off-by: Cao Zou <cao.zou@windriver.com>
---
 arch/arm/mach-omap2/pdata-quirks.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-omap2/pdata-quirks.c b/arch/arm/mach-omap2/pdata-quirks.c
index 5577ed8..9ce011e 100644
--- a/arch/arm/mach-omap2/pdata-quirks.c
+++ b/arch/arm/mach-omap2/pdata-quirks.c
@@ -220,6 +220,8 @@ static struct omap_rproc_timer_ops omap_rproc_dmtimer_ops = {
 	.release_timer = omap_rproc_release_timer,
 	.start_timer = omap_rproc_start_timer,
 	.stop_timer = omap_rproc_stop_timer,
+	.get_timer_irq = omap_rproc_get_timer_irq,
+	.ack_timer_irq = omap_rproc_ack_timer_irq,
 };
 
 static struct omap_rproc_pdata omap4_ipu_pdata = {
-- 
1.7.5.4

