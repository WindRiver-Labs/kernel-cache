From ef7fb36df3496072eaf417c09803311f4d1ad90b Mon Sep 17 00:00:00 2001
From: Keerthy <j-keerthy@ti.com>
Date: Fri, 5 Dec 2014 15:34:53 +0530
Subject: [PATCH 1521/1587] phy: phy-omap-usb2: Switch pins to their sleep
 states during suspend/resume

Switch pins to their sleep states during suspend/resume. Keeping the pins
in the optimized state helps reducing power consumption in the idle modes.

Acked-by: Roger Quadros <rogerq@ti.com>
Signed-off-by: Keerthy <j-keerthy@ti.com>
Signed-off-by: Sekhar Nori <nsekhar@ti.com>
[zou: Original patch taken from
ti-sdk-am335x-evm-08.00.00.00-Linux-x86-Install.bin]
Signed-off-by: Cao Zou <cao.zou@windriver.com>
---
 drivers/phy/phy-omap-usb2.c |    6 ++++++
 1 files changed, 6 insertions(+), 0 deletions(-)

diff --git a/drivers/phy/phy-omap-usb2.c b/drivers/phy/phy-omap-usb2.c
index bd3bb1c..5786792 100644
--- a/drivers/phy/phy-omap-usb2.c
+++ b/drivers/phy/phy-omap-usb2.c
@@ -414,6 +414,9 @@ static int omap_usb2_suspend(struct device *dev)
 	if (!pm_runtime_suspended(dev))
 		omap_usb2_disable_clocks(phy);
 
+	if (!device_may_wakeup(dev))
+		pinctrl_pm_select_sleep_state(dev);
+
 	return 0;
 }
 
@@ -423,6 +426,9 @@ static int omap_usb2_resume(struct device *dev)
 	struct omap_usb	*phy = platform_get_drvdata(pdev);
 	int ret;
 
+	if (!device_may_wakeup(dev))
+		pinctrl_pm_select_default_state(dev);
+
 	if (!pm_runtime_suspended(dev)) {
 		ret = omap_usb2_enable_clocks(phy);
 		if (ret)
-- 
1.7.5.4

