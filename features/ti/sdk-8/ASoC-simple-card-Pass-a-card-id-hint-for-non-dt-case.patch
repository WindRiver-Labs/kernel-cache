From f3f6244deb0639e38f34f679fc8e45f52efd468d Mon Sep 17 00:00:00 2001
From: Misael Lopez Cruz <misael.lopez@ti.com>
Date: Fri, 7 Nov 2014 14:37:43 +0200
Subject: [PATCH 1366/1587] ASoC: simple-card: Pass a card id hint for non-dt
 case

The card id hint for the DT case is covered by ASoC core, so
id hint for the non-DT case has to be explicitly handled by
the simple card driver.

Signed-off-by: Misael Lopez Cruz <misael.lopez@ti.com>
[zou: Original patch taken from
ti-sdk-am335x-evm-08.00.00.00-Linux-x86-Install.bin]
Signed-off-by: Cao Zou <cao.zou@windriver.com>
---
 include/sound/simple_card.h     |    1 +
 sound/soc/generic/simple-card.c |    3 +++
 2 files changed, 4 insertions(+), 0 deletions(-)

diff --git a/include/sound/simple_card.h b/include/sound/simple_card.h
index 6d74fef..afe50d9 100644
--- a/include/sound/simple_card.h
+++ b/include/sound/simple_card.h
@@ -29,6 +29,7 @@ struct asoc_simple_card_info {
 	const char *codec;
 	const char *platform;
 
+	int id_hint;
 	unsigned int daifmt;
 	struct asoc_simple_dai cpu_dai;
 	struct asoc_simple_dai codec_dai;
diff --git a/sound/soc/generic/simple-card.c b/sound/soc/generic/simple-card.c
index 8dd7957..65ab513 100644
--- a/sound/soc/generic/simple-card.c
+++ b/sound/soc/generic/simple-card.c
@@ -17,6 +17,7 @@
 #include <sound/simple_card.h>
 #include <sound/soc-dai.h>
 #include <sound/soc.h>
+#include <sound/initval.h>
 
 struct simple_card_data {
 	struct snd_soc_card snd_card;
@@ -470,6 +471,8 @@ static int asoc_simple_card_probe(struct platform_device *pdev)
 		}
 
 		priv->snd_card.name	= (cinfo->card) ? cinfo->card : cinfo->name;
+		priv->snd_card.id_hint	= (cinfo->id_hint >= 0) ?
+					cinfo->id_hint : SNDRV_DEFAULT_IDX1;
 		dai_link->name		= cinfo->name;
 		dai_link->stream_name	= cinfo->name;
 		dai_link->platform_name	= cinfo->platform;
-- 
1.7.5.4

