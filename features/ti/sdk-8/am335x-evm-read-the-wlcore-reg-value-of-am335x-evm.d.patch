From 27be96606bcd9ada970d758a4c9fe4353201980e Mon Sep 17 00:00:00 2001
From: czou <cao.zou@windriver.com>
Date: Thu, 23 Apr 2015 10:19:28 +0800
Subject: [PATCH 4/4] am335x-evm: read the wlcore reg value of am335x-evm.dts

for am335x-evm wifi module, it dones't set the ref_clock default value,
here read it form the dts file and set it, otherwise wifi can't work

Signed-off-by: czou <cao.zou@windriver.com>
---
 drivers/net/wireless/ti/wlcore/sdio.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/drivers/net/wireless/ti/wlcore/sdio.c b/drivers/net/wireless/ti/wlcore/sdio.c
index 8e1e1a6..6211ed1 100644
--- a/drivers/net/wireless/ti/wlcore/sdio.c
+++ b/drivers/net/wireless/ti/wlcore/sdio.c
@@ -221,6 +221,7 @@ static struct wl12xx_platform_data *wlcore_probe_of(struct device *dev)
 {
 	struct device_node *np = dev->of_node;
 	struct wl12xx_platform_data *pdata;
+	int data;
 
 	if (!np || !of_device_is_compatible(np, "ti,wlcore")) {
 		dev_err(dev, "No platform data set\n");
@@ -240,6 +241,10 @@ static struct wl12xx_platform_data *wlcore_probe_of(struct device *dev)
 		return NULL;
 	}
 
+	if (!of_property_read_u32(np, "reg", &data)) {
+		pdata->board_ref_clock = data;
+	}
+
 	return pdata;
 }
 #else
-- 
1.7.5.4

