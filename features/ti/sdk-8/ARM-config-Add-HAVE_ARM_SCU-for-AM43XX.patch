From 4021107c945721fce230938a82821b71de317058 Mon Sep 17 00:00:00 2001
From: Dave Gerlach <d-gerlach@ti.com>
Date: Mon, 28 Jul 2014 22:35:29 -0500
Subject: [PATCH] ARM: config: Add HAVE_ARM_SCU for AM43XX

CONFIG_HAVE_ARM_SCU only gets selected if CONFIG_SMP is selected in an OMAP
system, however AM43XX needs this option regardless of CONFIG_SMP as it is
important for controlling power in the SoC. Without this suspend will
not work as scu_power_mode becomes an empty function.

AM43XX requires SCU CPU Power Status bits for A9 core to be set to off mode
in order for the MSTANDBY signal to be asserted from the MPU during WFI.
This signal is used by the PRCM to determine when it is appropriate to
clock gate the MPU clock domain and also trigger M3_IRQ2 to tell the
wkup_m3 firmware to put the part into the desired sleep more.

Signed-off-by: Dave Gerlach <d-gerlach@ti.com>
[zou: Original patch taken from
ti-sdk-am335x-evm-08.00.00.00-Linux-x86-Install.bin]
Signed-off-by: Cao Zou <cao.zou@windriver.com>

diff --git a/arch/arm/mach-omap2/Kconfig b/arch/arm/mach-omap2/Kconfig
index 0af7ca02314d..7ede1b029ba5 100644
--- a/arch/arm/mach-omap2/Kconfig
+++ b/arch/arm/mach-omap2/Kconfig
@@ -78,6 +78,7 @@ config SOC_AM43XX
 	select MULTI_IRQ_HANDLER
 	select ARM_GIC
 	select MACH_OMAP_GENERIC
+	select HAVE_ARM_SCU
 
 config SOC_DRA7XX
 	bool "TI DRA7XX"
-- 
2.1.0

