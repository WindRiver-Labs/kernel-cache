From 7f5a4237578cf3b6a13f0a6260c2a730614bd8e0 Mon Sep 17 00:00:00 2001
From: Mugunthan V N <mugunthanvnm@ti.com>
Date: Thu, 4 Sep 2014 17:41:08 +0530
Subject: [PATCH 1170/1587] drivers: net: cpsw: fix warn message on
 suspend/resume

In dual EMAC, skb is tried to requeue back to DMA when any of the
netdev interface is up and running in the commit id e7cf277 which
results in a warn as during suspend DMA is already in teardown mode.

Fixes: e7cf277a6eca ("drivers: net: cpsw: dual_emac: fix reducing of rx descriptor during ifdown")

Signed-off-by: Mugunthan V N <mugunthanvnm@ti.com>
Tested-by: Nishanth Menon <nm@ti.com>
Signed-off-by: Sekhar Nori <nsekhar@ti.com>
[zou: Original patch taken from
ti-sdk-am335x-evm-08.00.00.00-Linux-x86-Install.bin]
Signed-off-by: Cao Zou <cao.zou@windriver.com>
---
 drivers/net/ethernet/ti/cpsw.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/drivers/net/ethernet/ti/cpsw.c b/drivers/net/ethernet/ti/cpsw.c
index 7d2b0d6..2a01805 100644
--- a/drivers/net/ethernet/ti/cpsw.c
+++ b/drivers/net/ethernet/ti/cpsw.c
@@ -712,7 +712,7 @@ static void cpsw_rx_handler(void *token, int len, int status)
 					ndev_status = true;
 		}
 
-		if (ndev_status) {
+		if (ndev_status && (status >= 0)) {
 			/* Though this interface is down, other interface is up
 			 * and running so requeue skb back to cpdma.
 			 */
-- 
1.7.5.4

