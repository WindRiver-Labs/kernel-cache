From 9136cf1be2caeede0e0bbdb7baba526e20a3066a Mon Sep 17 00:00:00 2001
From: Zumeng Chen <zumeng.chen@windriver.com>
Date: Sat, 15 Feb 2014 12:35:47 +0800
Subject: [PATCH] ethernet: cpsw: enable carrier_on after phy_start

Like most ethernet driver, IP level should be well informed when
phy_start is over. If not, it will incur a 100 seconds delay in
the boot process for preempt-rt kernel.

Signed-off-by: Zumeng Chen <zumeng.chen@windriver.com>

diff --git a/drivers/net/ethernet/ti/cpsw.c b/drivers/net/ethernet/ti/cpsw.c
index 938a9755a5e6..41794b5a581a 100644
--- a/drivers/net/ethernet/ti/cpsw.c
+++ b/drivers/net/ethernet/ti/cpsw.c
@@ -1205,6 +1205,7 @@ static void cpsw_slave_open(struct cpsw_slave *slave, struct cpsw_priv *priv)
 		/* Configure GMII_SEL register */
 		cpsw_phy_sel(&priv->pdev->dev, slave->phy->interface,
 			     slave->slave_num);
+		netif_carrier_on(priv->ndev);
 	}
 }
 
-- 
2.1.0

