sched: only try to push a task on wakeup if it is migratable

From: Gregory Haskins <ghaskins@novell.com>

There is no sense in wasting time trying to push a task away that
cannot move anywhere else.  We gain no benefit from trying to push
other tasks at this point, so if the task being woken up is non
migratable, just skip the whole operation.  This reduces overhead
in the wakeup path for certain tasks.

Signed-off-by: Gregory Haskins <ghaskins@novell.com>
---
 kernel/sched_rt.c |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/kernel/sched_rt.c b/kernel/sched_rt.c
index d8bf5a7..9a869a8 100644
--- a/kernel/sched_rt.c
+++ b/kernel/sched_rt.c
@@ -1312,7 +1312,8 @@ static void task_wake_up_rt(struct rq *rq, struct task_struct *p)
 {
 	if (!task_running(rq, p) &&
 	    !test_tsk_need_resched(rq->curr) &&
-	    rq->rt.overloaded) {
+	    rq->rt.overloaded &&
+	    p->rt.nr_cpus_allowed > 1) {
 		push_rt_tasks(rq);
 		schedstat_inc(rq, rto_wakeup);
 	}
