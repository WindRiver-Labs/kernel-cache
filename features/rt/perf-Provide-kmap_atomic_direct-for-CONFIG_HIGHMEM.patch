From 32dd6ff16259612fa39bcaebd8bc08b8c7c2b42e Mon Sep 17 00:00:00 2001
From: Tim Blechmann <tim@klingt.org>
Date: Mon, 30 Aug 2010 12:20:19 +0200
Subject: [PATCH] perf: Provide kmap_atomic_direct for !CONFIG_HIGHMEM

commit 327735e61bcee29f59a6fd053db894cdddff987e in tip.

ddeca6231cbdebd0fa0f1bac816f1e1e6eae485b doesn't compile, if CONFIG_HIGHMEM
is not enabled, because kmap_atomic_direct and kunmap_atomic_direct are
undefined.

Signed-off-by: Tim Blechmann <tim@klingt.org>
Cc: Peter Zijlstra <a.p.zijlstra@chello.nl>
LKML-Reference: <8df2d360ce2f1b88d50e0929528f011d50dc1ce5.1283163601.git.tim@klingt.org>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 include/linux/highmem.h |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/include/linux/highmem.h b/include/linux/highmem.h
index 74152c0..79f7960 100644
--- a/include/linux/highmem.h
+++ b/include/linux/highmem.h
@@ -71,8 +71,10 @@ static inline void *kmap_atomic(struct page *page, enum km_type idx)
 	return page_address(page);
 }
 #define kmap_atomic_prot(page, idx, prot)	kmap_atomic(page, idx)
+#define kmap_atomic_direct(page, idx)		kmap_atomic(page, idx)
 
 #define kunmap_atomic(addr, idx)	do { pagefault_enable(); } while (0)
+#define kunmap_atomic_direct(page, idx)	kunmap_atomic(page, idx)
 #define kmap_atomic_pfn(pfn, idx)	kmap_atomic(pfn_to_page(pfn), (idx))
 #define kmap_atomic_to_page(ptr)	virt_to_page(ptr)
 
-- 
1.7.0.4

