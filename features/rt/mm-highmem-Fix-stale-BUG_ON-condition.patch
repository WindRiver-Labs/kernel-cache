From cf5a3d4ca01e8fe6c10eb76d4b367426cf1315b7 Mon Sep 17 00:00:00 2001
From: Thomas Gleixner <tglx@linutronix.de>
Date: Wed, 3 Mar 2010 18:06:30 +0100
Subject: [PATCH] mm: highmem: Fix stale BUG_ON condition

commit fb301a41bcc424d7fb704fe2b67ac893f78ba2a9 in tip.

Fixup the leftover of the highmem rewrite.

Reported-by: Fernando Lopez-Lezcano <nando@ccrma.stanford.edu>
Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 mm/highmem.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/mm/highmem.c b/mm/highmem.c
index 9164c02..470492a 100644
--- a/mm/highmem.c
+++ b/mm/highmem.c
@@ -531,7 +531,7 @@ static int __set_page_address(struct page *page, void *virtual, int pos)
 	struct page_address_map *pam;
 
 	VM_BUG_ON(!PageHighMem(page));
-	VM_BUG_ON(atomic_read(&pkmap_count[pos]) != 0);
+	VM_BUG_ON(atomic_read(&pkmap[pos].count) != 0);
 	VM_BUG_ON(pos < 0 || pos >= LAST_PKMAP);
 
 	pas = page_slot(page);
-- 
1.7.0.4

