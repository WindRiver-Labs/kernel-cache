From 43f8c0f8b9da120c7b94966d42b46200b6b1fb9b Mon Sep 17 00:00:00 2001
From: Wu Zhangjin <wuzhangjin@gmail.com>
Date: Wed, 10 Mar 2010 02:07:36 +0800
Subject: [PATCH] RT: MIPS: make cpufreq support depends on !PREEMTP_RT

commit d94aa877a44e2400a4bbdd0905109d7c0fc99030 in tip.

The cpufreq support will change the cpu frequency dynamically, and also
for most of the MIPS timer's frequency are relative to the cpu
frequency, for example, in Loongson, the MIPS timer is half of the cpu
frequency, if the cpu frequency changes all the time, the MIPS timer
will be mussy.

all of the above will make the whole system un-determinable, so, just
disable the cpufreq support when PREEMPT_RT is used.

Signed-off-by: Wu Zhangjin <wuzhangjin@gmail.com>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 arch/mips/kernel/cpufreq/Kconfig |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/arch/mips/kernel/cpufreq/Kconfig b/arch/mips/kernel/cpufreq/Kconfig
index 58c601e..8a29c86 100644
--- a/arch/mips/kernel/cpufreq/Kconfig
+++ b/arch/mips/kernel/cpufreq/Kconfig
@@ -9,6 +9,7 @@ config MIPS_CPUFREQ
 	bool
 	default y
 	depends on CPU_SUPPORTS_CPUFREQ && MIPS_EXTERNAL_TIMER
+	depends on !PREEMPT_RT
 
 if MIPS_CPUFREQ
 
-- 
1.7.0.4

