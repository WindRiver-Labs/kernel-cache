From caf192a3b7c341b1874ae1afbb67c2aec1fea3be Mon Sep 17 00:00:00 2001
From: Paul Gortmaker <paul.gortmaker@windriver.com>
Date: Sun, 15 Apr 2012 21:03:55 -0400
Subject: [PATCH] rt/ARM: spinlock_rt.h uses BUG_ON and needs bug.h

Seen on an RT_FULL enabled ARM stamp9g20_defconfig:

  CC      arch/arm/kernel/asm-offsets.s
In file included from include/linux/spinlock.h:273,
                 from include/linux/seqlock.h:29,
                 from include/linux/time.h:8,
                 from include/linux/timex.h:56,
                 from include/linux/sched.h:57,
                 from arch/arm/kernel/asm-offsets.c:13:
include/linux/spinlock_rt.h: In function 'assert_spin_locked':
include/linux/spinlock_rt.h:160: error: implicit declaration of function 'BUG_ON'
make[2]: *** [arch/arm/kernel/asm-offsets.s] Error 1

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>

diff --git a/include/linux/spinlock_rt.h b/include/linux/spinlock_rt.h
index 3b555b4..0618387 100644
--- a/include/linux/spinlock_rt.h
+++ b/include/linux/spinlock_rt.h
@@ -5,6 +5,8 @@
 #error Do not include directly. Use spinlock.h
 #endif
 
+#include <linux/bug.h>
+
 extern void
 __rt_spin_lock_init(spinlock_t *lock, char *name, struct lock_class_key *key);
 
-- 
1.7.9.6

