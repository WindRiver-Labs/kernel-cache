From 46c11ad4c2a0210892da7851dc850f547994d442 Mon Sep 17 00:00:00 2001
From: Thomas Gleixner <tglx@linutronix.de>
Date: Sat, 25 Jul 2009 22:06:27 +0200
Subject: [PATCH] mm: Remove preempt count from pagefault disable/enable

commit e34d6077d0c482847728eea55ecdb1eb715042b1 in tip.

Now that all users are cleaned up, we can remove the preemption count.

Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 mm/memory.c |    7 -------
 1 files changed, 0 insertions(+), 7 deletions(-)

diff --git a/mm/memory.c b/mm/memory.c
index 4160ee1..59a09d4 100644
--- a/mm/memory.c
+++ b/mm/memory.c
@@ -3157,7 +3157,6 @@ unlock:
 
 void pagefault_disable(void)
 {
-	inc_preempt_count();
 	current->pagefault_disabled++;
 	/*
 	 * make sure to have issued the store before a pagefault
@@ -3175,12 +3174,6 @@ void pagefault_enable(void)
 	 */
 	barrier();
 	current->pagefault_disabled--;
-	dec_preempt_count();
-	/*
-	 * make sure we do..
-	 */
-	barrier();
-	preempt_check_resched();
 }
 EXPORT_SYMBOL(pagefault_enable);
 
-- 
1.7.0.4

