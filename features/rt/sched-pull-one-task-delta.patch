balance_tasks: stop after the 1st task is pulled.

The original RT-26 patch named sched-pull-one-task-during-newidle.patch
inserted this code, but the patch was dropped since it appeared
upstream as commit c4acb2c0.   However that upstream commit didn't have
this RT specific part.

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 kernel/sched.c |   10 ++++++++++
 1 files changed, 10 insertions(+), 0 deletions(-)

diff --git a/kernel/sched.c b/kernel/sched.c
index 375ecb7..daab4f9 100644
--- a/kernel/sched.c
+++ b/kernel/sched.c
@@ -3205,6 +3205,16 @@ next:
 	pulled++;
 	rem_load_move -= p->se.load.weight;
 
+#ifdef CONFIG_PREEMPT
+	/*
+	 * NEWIDLE balancing is a source of latency, so preemptible kernels
+	 * will stop after the first task is pulled to minimize the critical
+	 * section.
+	 */
+	if (idle == CPU_NEWLY_IDLE)
+		goto out;
+#endif
+
 	/*
 	 * We only want to steal up to the prescribed amount of weighted load.
 	 */
