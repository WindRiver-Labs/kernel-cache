From 6aff8bd8d64b04a2da319f6987dc9aab68338d1d Mon Sep 17 00:00:00 2001
From: Thomas Gleixner <tglx@linutronix.de>
Date: Tue, 21 Jul 2009 16:07:37 +0200
Subject: [PATCH] genirq: disable random call on preempt-rt

commit 04479b1c97ac0f63350e1825f7bd12caccc77a35 in tip.

The random call introduces high latencies and is almost
unused. Disable it for -rt.

Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 kernel/irq/handle.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/kernel/irq/handle.c b/kernel/irq/handle.c
index e93b055..ece44f6 100644
--- a/kernel/irq/handle.c
+++ b/kernel/irq/handle.c
@@ -441,8 +441,11 @@ irqreturn_t handle_IRQ_event(unsigned int irq, struct irqaction *action)
 		action = action->next;
 	} while (action);
 
+#ifndef CONFIG_PREEMPT_RT
+	/* FIXME: Can we unbreak that ? */
 	if (status & IRQF_SAMPLE_RANDOM)
 		add_interrupt_randomness(irq);
+#endif
 	local_irq_disable();
 
 	return retval;
-- 
1.7.0.4

