From 923715af3013718541553fbec74230223ebffe12 Mon Sep 17 00:00:00 2001
From: Xianghua Xiao <xiaoxianghua@gmail.com>
Date: Fri, 23 Apr 2010 16:57:52 -0500
Subject: [PATCH] net: gianfar: More RT fixups

commit 510cc2234ac121f792d788f926d58f14ecc20e9a in tip.

stop_gfar() needs the same fixup (local_irq_save/restore_nort()) as
adjust_link().

Signed-off-by: Thomas Gleixner <tglx@linutronix.de>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 drivers/net/gianfar.c |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/net/gianfar.c b/drivers/net/gianfar.c
index 5e4eb41..a9de4a7 100644
--- a/drivers/net/gianfar.c
+++ b/drivers/net/gianfar.c
@@ -1549,7 +1549,7 @@ void stop_gfar(struct net_device *dev)
 
 
 	/* Lock it down */
-	local_irq_save(flags);
+	local_irq_save_nort(flags);
 	lock_tx_qs(priv);
 	lock_rx_qs(priv);
 
@@ -1557,7 +1557,7 @@ void stop_gfar(struct net_device *dev)
 
 	unlock_rx_qs(priv);
 	unlock_tx_qs(priv);
-	local_irq_restore(flags);
+	local_irq_restore_nort(flags);
 
 	/* Free the IRQs */
 	if (priv->device_flags & FSL_GIANFAR_DEV_HAS_MULTI_INTR) {
-- 
1.7.0.4

