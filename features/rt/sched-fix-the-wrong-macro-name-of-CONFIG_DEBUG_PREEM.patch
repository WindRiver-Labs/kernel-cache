From fc8e9e9810a1c5de6af9fa3eabf4011683b23944 Mon Sep 17 00:00:00 2001
From: Qiang Huang <h.huangqiang@huawei.com>
Date: Mon, 8 Apr 2013 19:47:29 +0800
Subject: [PATCH] sched: fix the wrong macro name of CONFIG_DEBUG_PREEMPT

Might be a typo, would cause some debug code never be run.

Signed-off-by: Qiang Huang <h.huangqiang@huawei.com>
[PG: taken from http://permalink.gmane.org/gmane.linux.rt.user/9992 ]
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>

diff --git a/kernel/sched/core.c b/kernel/sched/core.c
index 3751b6a..3d92bea 100644
--- a/kernel/sched/core.c
+++ b/kernel/sched/core.c
@@ -2861,7 +2861,7 @@ static noinline void __schedule_bug(struct task_struct *prev)
 	print_modules();
 	if (irqs_disabled())
 		print_irqtrace_events(prev);
-#ifdef DEBUG_PREEMPT
+#ifdef CONFIG_DEBUG_PREEMPT
 	if (in_atomic_preempt_off()) {
 		pr_err("Preemption disabled at:");
 		print_ip_sym(current->preempt_disable_ip);
@@ -7212,7 +7212,7 @@ void __might_sleep(const char *file, int line, int preempt_offset)
 	debug_show_held_locks(current);
 	if (irqs_disabled())
 		print_irqtrace_events(current);
-#ifdef DEBUG_PREEMPT
+#ifdef CONFIG_DEBUG_PREEMPT
 	if (!preempt_count_equals(preempt_offset)) {
 		pr_err("Preemption disabled at:");
 		print_ip_sym(current->preempt_disable_ip);
-- 
1.8.3.1

