From sebastien.dugue@bull.net Thu Sep 11 08:10:06 2008
Date: Thu, 11 Sep 2008 14:00:08 +0200
From: Sebastien Dugue <sebastien.dugue@bull.net>
To: Linux-rt <linux-rt-users@vger.kernel.org>
Cc: Steven Rostedt <rostedt@goodmis.org>, Jean Pierre Dion <jean-pierre.dion@bull.net>, Gilles Carry <Gilles.Carry@ext.bull.net>, Tim Chavez <tinytim@us.ibm.com>
Subject: [PATCH RT] tasklets: fix __tasklet_hi_schedule()

From b5ae1d4954394b05c17a87403e7584c7f90e457a Mon Sep 17 00:00:00 2001
From: Sebastien Dugue <sebastien.dugue@bull.net>
Date: Thu, 11 Sep 2008 13:47:40 +0200
Subject: [PATCH 1/1] tasklets: fix __tasklet_hi_schedule()

  fix __tasklet_hi_schedule() which incorrectly puts the tasklet to be
scheduled on the wrong list (tasklet_vec instead of tasklet_hi_vec).

  This broke rebooting a box with the ehea driver.

Signed-off-by: Sebastien Dugue <sebastien.dugue@bull.net>
---
 kernel/softirq.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/kernel/softirq.c b/kernel/softirq.c
index 158d775..d190a15 100644
--- a/kernel/softirq.c
+++ b/kernel/softirq.c
@@ -508,7 +508,7 @@ void __tasklet_hi_schedule(struct tasklet_struct *t)
 	unsigned long flags;
 
 	local_irq_save(flags);
-	__tasklet_common_schedule(t, &__get_cpu_var(tasklet_vec), HI_SOFTIRQ);
+	__tasklet_common_schedule(t, &__get_cpu_var(tasklet_hi_vec), HI_SOFTIRQ);
 	local_irq_restore(flags);
 }
 
