From 011ac99af2f65de5fe597fc9d6a590b887ac9339 Mon Sep 17 00:00:00 2001
From: Wu Zhangjin <wuzhangjin@gmail.com>
Date: Wed, 10 Mar 2010 02:11:26 +0800
Subject: [PATCH] RT: MIPS: Loongson: make the MFGPT timer depends on !PREEMPT_RT

commit 99335526b57f9e586ddaf3c2cc102abd9eb65e73 in tip.

There is a MFGPT timer in Lemote-2F family of machines, which have low
precision and not support oneshot mode, so, only let it be un-available
in PREEMTPT_RT for we have an MIPS-builtin high-resolution timer: r4k
timer.

For we disable it for PREEMPT_RT, there is no need to convert the
related lock to raw_ one.

Signed-off-by: Wu Zhangjin <wuzhangjin@gmail.com>
Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 arch/mips/loongson/Kconfig |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/mips/loongson/Kconfig b/arch/mips/loongson/Kconfig
index 3df1967..ab08247 100644
--- a/arch/mips/loongson/Kconfig
+++ b/arch/mips/loongson/Kconfig
@@ -64,7 +64,7 @@ config CS5536
 
 config CS5536_MFGPT
 	bool "CS5536 MFGPT Timer"
-	depends on CS5536
+	depends on CS5536 && !PREEMPT_RT
 	select MIPS_EXTERNAL_TIMER
 	help
 	  This option enables the mfgpt0 timer of AMD CS5536.
-- 
1.7.0.4

