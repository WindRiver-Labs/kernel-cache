From 432185da3e1d2075fc32ed74d94568874da5381c Mon Sep 17 00:00:00 2001
From: Paul Gortmaker <paul.gortmaker@windriver.com>
Date: Sun, 23 Jan 2011 13:00:04 -0500
Subject: [PATCH] make takeover_delayed_drop depend on HOTPLUG_CPU

This is one of several extractions from the merge up to 33-rc8.

See it in a git tip repo with:

   git diff 5f854cfc024622e4aae14d7cf422f6ff86278688^2 \
	5f854cfc024622e4aae14d7cf422f6ff86278688 kernel/fork.c

You can find the origin of this change in the tip merge commit:

     commit 5f854cfc024622e4aae14d7cf422f6ff86278688
     Merge: cc24da0 4ec62b2
     Author: Thomas Gleixner <tglx@linutronix.de>
     Date:   Sun Feb 21 20:17:22 2010 +0100

         Forward to 2.6.33-rc8

         Merge branch 'linus' into rt/head with a pile of conflicts.

         Signed-off-by: Thomas Gleixner <tglx@linutronix.de>

Normally there are not significant changes/additions in a merge commit that
are not from any other "normal" commit.  But in this case there are, so
break them out into separate explicit commits.

Signed-off-by: Paul Gortmaker <paul.gortmaker@windriver.com>
---
 kernel/fork.c |    2 ++
 1 files changed, 2 insertions(+), 0 deletions(-)

diff --git a/kernel/fork.c b/kernel/fork.c
index 1e4737e..d9a2819 100644
--- a/kernel/fork.c
+++ b/kernel/fork.c
@@ -1825,6 +1825,7 @@ void  __mmdrop_delayed(struct mm_struct *mm)
 	put_cpu_var(delayed_drop_list);
 }
 
+#ifdef CONFIG_HOTPLUG_CPU
 static void takeover_delayed_drop(int hotcpu)
 {
 	struct list_head *head = &per_cpu(delayed_drop_list, hotcpu);
@@ -1837,6 +1838,7 @@ static void takeover_delayed_drop(int hotcpu)
 		__mmdrop_delayed(mm);
 	}
 }
+#endif
 
 static int desched_thread(void * __bind_cpu)
 {
-- 
1.7.0.4

