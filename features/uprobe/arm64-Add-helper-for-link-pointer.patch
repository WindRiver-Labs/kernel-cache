From 7bea380269d3ded9d0b856990cdb3dc20dce35a8 Mon Sep 17 00:00:00 2001
From: Pratyush Anand <panand@redhat.com>
Date: Thu, 24 Sep 2015 14:19:54 -0700
Subject: [PATCH 18/26] arm64: Add helper for link pointer

Taken from:
git://github.com/pratyushanand/linux.git:uprobe/upstream_arm64_devel

At many a place we program procedure link pointer ie regs[30]. So adding
helper to do that.

Signed-off-by: Pratyush Anand <panand@redhat.com>
Signed-off-by: Yang Shi <yang.shi@windriver.com>
---
 arch/arm64/include/asm/ptrace.h | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/arch/arm64/include/asm/ptrace.h b/arch/arm64/include/asm/ptrace.h
index 1f4c1b7..dd77139 100644
--- a/arch/arm64/include/asm/ptrace.h
+++ b/arch/arm64/include/asm/ptrace.h
@@ -227,6 +227,13 @@ static inline int valid_user_regs(struct user_pt_regs *regs)
 #include <asm-generic/ptrace.h>
 
 #define stack_pointer(regs)		((regs)->sp)
+#define procedure_link_pointer(regs)	((regs)->regs[30])
+
+static inline void procedure_link_pointer_set(struct pt_regs *regs,
+					   unsigned long val)
+{
+	procedure_link_pointer(regs) = val;
+}
 
 #undef profile_pc
 #ifdef CONFIG_SMP
-- 
2.0.2

