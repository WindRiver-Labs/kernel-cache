From db9e4af3a009f9e2a49d6ec1cc3c4215001d4a59 Mon Sep 17 00:00:00 2001
From: Bruce Ashfield <bruce.ashfield@windriver.com>
Date: Tue, 17 Feb 2009 19:42:28 -0500
Subject: [PATCH] netlink: kernel Oops when running tc

Compiler optimization is causing an oops in the rtnetlink code
when certain utilities are run. This temporarily decreases
the optimization on two files to fix one symptom.

Signed-off-by: Bruce Ashfield <bruce.ashfield@windriver.com>
---
 net/netlink/Makefile |    2 +-
 net/sched/Makefile   |    2 ++
 2 files changed, 3 insertions(+), 1 deletions(-)

diff --git a/net/netlink/Makefile b/net/netlink/Makefile
index e3589c2..1008778 100644
--- a/net/netlink/Makefile
+++ b/net/netlink/Makefile
@@ -1,5 +1,5 @@
 #
 # Makefile for the netlink driver.
 #
-
+CFLAGS_af_netlink.o += -O0
 obj-y  				:= af_netlink.o attr.o genetlink.o
diff --git a/net/sched/Makefile b/net/sched/Makefile
index 91e9ee0..d66a55d 100644
--- a/net/sched/Makefile
+++ b/net/sched/Makefile
@@ -2,6 +2,8 @@
 # Makefile for the Linux Traffic Control Unit.
 #
 
+CFLAGS_cls_api.o += -O0
+
 obj-y	:= sch_generic.o
 
 obj-$(CONFIG_NET_SCHED)		+= sch_api.o sch_blackhole.o
-- 
1.6.0.3

