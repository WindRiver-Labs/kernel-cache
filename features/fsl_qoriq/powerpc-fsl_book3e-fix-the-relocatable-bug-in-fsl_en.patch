From 5630726bfdb3413c827aaef0af706ba4d5e4022f Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Thu, 7 Mar 2013 19:37:52 +0800
Subject: [PATCH 09/12] powerpc/fsl_book3e: fix the relocatable bug in fsl_enable_threads

The LOAD_REG_IMMEDIATE can't be used to load a function address when
relocatable enabled. So replace it with LOAD_REG_ADDR.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/kernel/exceptions-64e.S |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/kernel/exceptions-64e.S b/arch/powerpc/kernel/exceptions-64e.S
index cb9e91e..2f3c19d 100644
--- a/arch/powerpc/kernel/exceptions-64e.S
+++ b/arch/powerpc/kernel/exceptions-64e.S
@@ -1389,7 +1389,7 @@ BEGIN_FTR_SECTION
 	 * Set the NIA for the secondary thread to
 	 * generic_secondary_thread_init
 	 */
-	LOAD_REG_IMMEDIATE(r3, .fsl_secondary_thread_init);
+	LOAD_REG_ADDR(r3, .fsl_secondary_thread_init);
 	MTTMR(TMRN_INIA1, 3);
 
 	/* Release the other thread. It will spin until kick_cpu is called */
-- 
1.7.0

