From 653778c71173f4616b58e50d50419f14c9c386b4 Mon Sep 17 00:00:00 2001
From: Haiying Wang <Haiying.Wang@freescale.com>
Date: Thu, 4 Dec 2014 10:34:06 -0500
Subject: [PATCH 841/987] fsl_qman: use do_div in prescaler calculation

Signed-off-by: Haiying Wang <Haiying.Wang@freescale.com>
Change-Id: I103b9031feaa464197d816d1a11a6e8204219f9b
Reviewed-on: http://git.am.freescale.net:8181/25397
Reviewed-by: Geoff Thorpe <Geoff.Thorpe@freescale.com>
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Matthew Weigel <Matthew.Weigel@freescale.com>
[Lu:Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/staging/fsl_qbman/qman_config.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/staging/fsl_qbman/qman_config.c b/drivers/staging/fsl_qbman/qman_config.c
index 3861a5e..1eea298 100644
--- a/drivers/staging/fsl_qbman/qman_config.c
+++ b/drivers/staging/fsl_qbman/qman_config.c
@@ -887,7 +887,7 @@ int qman_ceetm_set_prescaler(enum qm_dc_portal portal)
 		return -ENODEV;
 
 	temp = 0x400000 * 100;
-	temp /= CONFIG_QMAN_CEETM_UPDATE_PERIOD;
+	do_div(temp, CONFIG_QMAN_CEETM_UPDATE_PERIOD);
 	temp *= 10000000;
 	pres = (u16)(temp / qman_clk);
 
-- 
1.9.1

