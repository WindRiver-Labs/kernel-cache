From 2ab28ec22eb255f66b235388d864c4c9103a7855 Mon Sep 17 00:00:00 2001
From: Madalin Bucur <madalin.bucur@freescale.com>
Date: Tue, 16 Sep 2014 16:39:30 +0300
Subject: [PATCH 770/987] dpaa_eth: verify return value

Signed-off-by: Madalin Bucur <madalin.bucur@freescale.com>
Change-Id: Ife32e1984f5dc8f481dad223602163229526b861
Reviewed-on: http://git.am.freescale.net:8181/18841
Reviewed-by: Marian Cristian Rotariu <marian.rotariu@freescale.com>
[Lu:Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth_generic.c | 10 +++++-----
 1 file changed, 5 insertions(+), 5 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_generic.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_generic.c
index 07b80ba..9447d31 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_generic.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_generic.c
@@ -1276,16 +1276,16 @@ static int dpa_generic_fq_create(struct net_device *netdev,
 	struct dpa_fq *fqs = NULL, *tmp = NULL;
 	struct task_struct *kth;
 	int err = 0;
+	int channel;
 
 	INIT_LIST_HEAD(&priv->dpa_fq_list);
 
 	list_replace_init(dpa_fq_list, &priv->dpa_fq_list);
 
-	priv->channel = dpa_get_channel();
-	if (priv->channel < 0) {
-		err = priv->channel;
-		return err;
-	}
+	channel = dpa_get_channel();
+	if (channel < 0)
+		return channel;
+	priv->channel = (uint16_t)channel;
 
 	/* Start a thread that will walk the cpus with affine portals
 	 * and add this pool channel to each's dequeue mask.
-- 
1.9.1

