From 0cb9b3e700ab1262e9b4ab247ac5374ab1706b3d Mon Sep 17 00:00:00 2001
From: Madalin Bucur <madalin.bucur@freescale.com>
Date: Wed, 15 Oct 2014 18:13:05 +0300
Subject: [PATCH 784/987] dpaa_eth: fix bp draining

Signed-off-by: Madalin Bucur <madalin.bucur@freescale.com>
Change-Id: Id50a07d95bd2799db086a50301326fc0dac4ec31
Reviewed-on: http://git.am.freescale.net:8181/21378
Reviewed-by: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
[Lu:Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c
index cca21cd..f7a2426 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c
@@ -754,7 +754,7 @@ void dpa_bp_drain(struct dpa_bp *bp)
 		struct bm_buffer bmb[8];
 		int i;
 
-		ret = bman_acquire(bp->pool, bmb, 8, 0);
+		ret = bman_acquire(bp->pool, bmb, num, 0);
 		if (ret < 0) {
 			if (num == 8) {
 				/* we have less than 8 buffers left;
-- 
1.9.1

