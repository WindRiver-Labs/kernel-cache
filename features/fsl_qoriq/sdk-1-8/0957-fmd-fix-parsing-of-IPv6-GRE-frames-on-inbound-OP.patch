From da068e2e9bea1bac62950c908c82c0299c080663 Mon Sep 17 00:00:00 2001
From: Mandy Lavi <mandy.lavi@freescale.com>
Date: Tue, 21 Apr 2015 00:11:54 +0900
Subject: [PATCH 957/987] fmd: fix parsing of IPv6 GRE frames on inbound OP

Change-Id: Ic55d4f698c2d406d524e54f817a07f0810f87e25
Signed-off-by: Mandy Lavi <mandy.lavi@freescale.com>
Reviewed-on: http://git.am.freescale.net:8181/35329
Reviewed-by: Liron Himi <Liron.Himi@freescale.com>
Reviewed-by: Honghua Yin <Hong-Hua.Yin@freescale.com>
Tested-by: Honghua Yin <Hong-Hua.Yin@freescale.com>
[Yang: Original patch taken from
QorIQ-SDK-V1.8-SOURCE-20150619-yocto.iso]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 .../freescale/fman/Peripherals/FM/Pcd/fm_prs.h     | 217 +++++++++++----------
 .../freescale/fman/Peripherals/FM/Port/fm_port.c   |  13 +-
 .../freescale/fman/Peripherals/FM/Port/fm_port.h   |   4 +-
 .../integrations/FMANV3H/dpaa_integration_ext.h    |   2 +-
 .../integrations/FMANV3L/dpaa_integration_ext.h    |   2 +-
 5 files changed, 124 insertions(+), 114 deletions(-)

diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd/fm_prs.h b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd/fm_prs.h
index e91311c..0185717 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd/fm_prs.h
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd/fm_prs.h
@@ -137,114 +137,115 @@
 /* version: 106.3.13 */
 #define SW_PRS_OFFLOAD_PATCH                           \
 {                                                      \
-    0x31,0x52,0x00,0xDA,0x0E,0x4F,0x00,0x00,0x00,0x00, \
-    0x00,0x00,0x51,0xF6,0x08,0x4B,0x31,0x53,0x00,0xFB, \
-    0xFF,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0x29,0x2B, \
-    0x33,0xF1,0x00,0xFB,0x00,0xDF,0x00,0x00,0x00,0x00, \
-    0x00,0x00,0x28,0x7F,0x31,0x52,0x00,0xDA,0x0A,0x00, \
-    0x00,0x00,0x00,0x00,0x00,0x00,0x42,0x00,0x00,0x00, \
-    0x00,0x01,0x1B,0xFE,0x00,0x00,0x99,0x00,0x52,0x09, \
-    0x00,0x00,0x00,0x00,0x9F,0x98,0x52,0x09,0x00,0x00, \
-    0x1A,0x24,0x09,0x5F,0x00,0x20,0x00,0x00,0x09,0x4F, \
-    0x00,0x20,0x00,0x00,0x34,0xB7,0x00,0xF9,0x00,0x00, \
-    0x01,0x00,0x00,0x00,0x00,0x00,0x2B,0x97,0x31,0xB3, \
-    0x29,0x8F,0x33,0xF1,0x00,0xF9,0x00,0x01,0x00,0x00, \
-    0x00,0x00,0x00,0x00,0x28,0x7F,0x00,0x03,0x00,0x02, \
-    0x00,0x00,0x00,0x01,0x1B,0xFE,0x00,0x01,0x1B,0xFE, \
-    0x31,0x52,0x00,0xDA,0xFC,0x00,0x00,0x00,0x00,0x00, \
-    0x00,0x00,0x52,0x32,0x40,0x00,0x31,0x92,0x52,0x32, \
-    0x00,0x88,0x1A,0x35,0x08,0x05,0x00,0x00,0x1A,0x79, \
-    0x02,0x1F,0x00,0x08,0x00,0x83,0x02,0x1F,0x00,0x20, \
-    0x28,0x1B,0x00,0x05,0x29,0x1F,0x30,0xD0,0x62,0x55, \
-    0x00,0x07,0x00,0x05,0x00,0x00,0xC3,0x8F,0x00,0x52, \
-    0x00,0x01,0x07,0x01,0x62,0x41,0x00,0x00,0x30,0xD0, \
-    0x00,0xDA,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00, \
-    0x42,0x52,0x00,0x00,0x02,0x8F,0x00,0x00,0x30,0xF2, \
-    0x00,0x06,0x1A,0x63,0x00,0x00,0x9F,0xFF,0x30,0xF2, \
-    0x00,0x06,0x29,0x1E,0x07,0x08,0x30,0xD0,0x00,0x52, \
-    0x00,0x08,0x28,0x1A,0x62,0x3D,0x00,0x00,0x30,0xF2, \
-    0x1A,0x63,0x06,0x00,0x29,0x1E,0x30,0xF2,0x29,0x0E, \
-    0x30,0x72,0x00,0x00,0x9B,0x8F,0x00,0x06,0x29,0x0E, \
-    0x32,0xF1,0x32,0xB0,0x00,0x4F,0x00,0x57,0x00,0x28, \
-    0x00,0x00,0x97,0x9E,0x00,0x4E,0x30,0x72,0x00,0x06, \
-    0x29,0x0E,0x08,0x05,0x00,0x01,0x31,0x52,0x00,0xDA, \
-    0x0E,0x4F,0x00,0x00,0x00,0x00,0x00,0x00,0x52,0x8F, \
-    0x04,0x4B,0x31,0x53,0x00,0xFB,0xFF,0xF0,0x00,0x00, \
-    0x00,0x00,0x00,0x00,0x29,0x2B,0x33,0xF1,0x00,0xFB, \
-    0x00,0xDF,0x00,0x00,0x00,0x00,0x00,0x00,0x28,0x7F, \
-    0x31,0x52,0x00,0xDA,0x06,0x00,0x00,0x00,0x00,0x00, \
-    0x00,0x00,0x42,0x99,0x00,0x00,0x00,0x01,0x1B,0xFE, \
-    0x31,0x52,0x00,0xDA,0x00,0x40,0x00,0x00,0x00,0x00, \
-    0x00,0x00,0x52,0xFD,0x00,0x00,0x00,0x00,0x9B,0x8F, \
-    0x28,0x01,0x32,0xC1,0x00,0x55,0x00,0x28,0x28,0x43, \
-    0x30,0x00,0x42,0xAF,0x00,0x00,0x30,0x00,0x42,0xAF, \
-    0x00,0x3C,0x1A,0xC7,0x32,0x11,0x32,0xC0,0x00,0x4F, \
-    0x00,0x81,0x00,0x00,0x83,0x8F,0x28,0x01,0x06,0x00, \
-    0x32,0x11,0x32,0xC0,0x00,0x4F,0x00,0x55,0x00,0x01, \
-    0x00,0x81,0x32,0x11,0x00,0x00,0x83,0x8E,0x00,0x50, \
-    0x00,0x01,0x01,0x04,0x00,0x4D,0x28,0x43,0x06,0x00, \
-    0x1A,0xA8,0x30,0x00,0x42,0xE5,0x00,0x2B,0x00,0x00, \
-    0x9B,0x8E,0x42,0xD3,0x00,0x00,0x32,0xC1,0x00,0x55, \
-    0x00,0x28,0x28,0x43,0x1A,0xE4,0x06,0x29,0x00,0x00, \
-    0x83,0x8F,0x28,0x23,0x06,0x00,0x06,0x29,0x32,0xC1, \
-    0x00,0x55,0x00,0x28,0x00,0x00,0x83,0x8E,0x00,0x50, \
-    0x00,0x01,0x01,0x04,0x00,0x4D,0x28,0x43,0x06,0x00, \
-    0x1A,0xFC,0x32,0x11,0x32,0xC0,0x00,0x4F,0x00,0x81, \
-    0x00,0x00,0x87,0x8F,0x28,0x23,0x06,0x00,0x32,0x11, \
-    0x32,0xC0,0x00,0x4F,0x00,0x55,0x00,0x01,0x00,0x81, \
-    0x32,0x11,0x00,0x00,0x83,0x8E,0x00,0x50,0x00,0x01, \
-    0x01,0x04,0x00,0x4D,0x28,0x43,0x06,0x00,0x1B,0x42, \
-    0x00,0x00,0x9B,0x8F,0x28,0x01,0x32,0xC1,0x00,0x55, \
-    0x00,0x28,0x28,0x43,0x30,0x00,0x43,0x27,0x00,0x2C, \
-    0x32,0x11,0x32,0xC0,0x00,0x4F,0x00,0x81,0x00,0x00, \
-    0x87,0x8F,0x28,0x23,0x06,0x00,0x32,0x11,0x32,0xC0, \
-    0x00,0x4F,0x00,0x81,0x00,0x00,0x83,0x8F,0x28,0x01, \
-    0x06,0x00,0x32,0x11,0x32,0xC0,0x00,0x4F,0x00,0x55, \
-    0x00,0x01,0x00,0x81,0x32,0x11,0x00,0x00,0x83,0x8E, \
-    0x00,0x50,0x00,0x01,0x01,0x04,0x00,0x4D,0x28,0x43, \
-    0x06,0x00,0x1B,0x04,0x09,0x5F,0x00,0x20,0x00,0x00, \
-    0x09,0x4F,0x00,0x20,0x00,0x00,0x34,0xB7,0x00,0xF9, \
-    0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x2B,0x97, \
-    0x31,0xB3,0x29,0x8F,0x33,0xF1,0x00,0xF9,0x00,0x01, \
-    0x00,0x00,0x00,0x00,0x00,0x00,0x28,0x7F,0x00,0x03, \
-    0x00,0x02,0x00,0x00,0x00,0x01,0x1B,0xFE,0x32,0xF1, \
-    0x32,0xC0,0x00,0x4F,0x00,0x81,0x00,0x02,0x30,0x50, \
-    0x53,0x99,0x00,0x01,0x00,0x00,0x97,0x9E,0x43,0x52, \
-    0x00,0x08,0x08,0x16,0x00,0x54,0x00,0x01,0x1B,0xFE, \
-    0x00,0x00,0x9F,0x9E,0x43,0x87,0x00,0x00,0x02,0x1F, \
-    0x00,0x08,0x28,0x1B,0x30,0x73,0x29,0x1F,0x30,0xD0, \
-    0x63,0x73,0x00,0x07,0x00,0x05,0x00,0x00,0xC3,0x8F, \
-    0x00,0x52,0x00,0x01,0x07,0x01,0x63,0x5F,0x00,0x00, \
-    0x30,0xD0,0x00,0xDA,0x00,0x01,0x00,0x00,0x00,0x00, \
-    0x00,0x00,0x43,0x70,0x00,0x00,0x02,0x8F,0x00,0x00, \
-    0x30,0xF2,0x00,0x06,0x1B,0x81,0x00,0x00,0x9F,0xFF, \
-    0x30,0xF2,0x00,0x06,0x29,0x1E,0x07,0x08,0x30,0xD0, \
-    0x00,0x52,0x00,0x08,0x28,0x1A,0x63,0x5B,0x00,0x00, \
-    0x30,0xF2,0x1B,0x81,0x06,0x00,0x29,0x1E,0x30,0xF2, \
-    0x53,0x87,0xFF,0xFF,0x1B,0x8C,0x08,0x16,0x00,0x54, \
-    0x00,0x01,0x1B,0xFE,0x1B,0x99,0x32,0xF1,0x28,0x5D, \
-    0x32,0xF1,0x00,0x55,0x00,0x08,0x28,0x5F,0x00,0x00, \
-    0x8F,0x9F,0x29,0x33,0x08,0x16,0x00,0x49,0x00,0x01, \
-    0x1B,0xFF,0x00,0x01,0x1B,0xFF,0x08,0x07,0x00,0x02, \
-    0x00,0x00,0x8D,0x80,0x53,0xA5,0x00,0x01,0x30,0x71, \
-    0x00,0x55,0x00,0x01,0x28,0x0F,0x00,0x00,0x8D,0x00, \
-    0x53,0xAD,0x00,0x01,0x30,0x71,0x00,0x55,0x00,0x01, \
-    0x28,0x0F,0x00,0x00,0x83,0x8E,0x53,0xC2,0x00,0x00, \
-    0x00,0x00,0x86,0x08,0x30,0x71,0x00,0x7B,0x03,0xC2, \
-    0x33,0xB4,0x00,0xDA,0xFF,0xFF,0x00,0x0F,0x00,0x00, \
-    0x00,0x00,0x00,0x00,0x86,0x09,0x01,0x03,0x00,0x7D, \
-    0x03,0xC2,0x1B,0xD1,0x33,0xD1,0x00,0xF9,0x00,0x10, \
-    0x00,0x00,0x00,0x00,0x00,0x00,0x28,0x7B,0x09,0x5F, \
-    0x00,0x1A,0x00,0x00,0x09,0x4F,0x00,0x1A,0x00,0x00, \
-    0x00,0x01,0x1B,0xFF,0x00,0x00,0x8C,0x00,0x53,0xF9, \
-    0x00,0x01,0x34,0xF5,0x00,0xFB,0xFF,0xFF,0x00,0x7F, \
-    0x00,0x00,0x00,0x00,0x2A,0x9F,0x00,0x00,0x93,0x8F, \
-    0x28,0x49,0x00,0x00,0x97,0x8F,0x28,0x4B,0x34,0x61, \
-    0x28,0x4D,0x34,0x71,0x28,0x4F,0x34,0xB7,0x00,0xF9, \
-    0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x2B,0x97, \
-    0x33,0xF1,0x00,0xF9,0x00,0x01,0x00,0x00,0x00,0x00, \
-    0x00,0x00,0x28,0x7F,0x00,0x03,0x00,0x02,0x00,0x00, \
-    0x00,0x01,0x1B,0xFF,0x00,0x01,0x1B,0xFF, \
+        0x31,0x52,0x00,0xDA,0x0E,0x4F,0x00,0x00,0x00,0x00, \
+        0x00,0x00,0x51,0xE6,0x08,0x4B,0x31,0x53,0x00,0xFB, \
+        0xFF,0xF0,0x00,0x00,0x00,0x00,0x00,0x00,0x29,0x2B, \
+        0x33,0xF1,0x00,0xFB,0x00,0xDF,0x00,0x00,0x00,0x00, \
+        0x00,0x00,0x28,0x7F,0x31,0x52,0x00,0xDA,0x0A,0x00, \
+        0x00,0x00,0x00,0x00,0x00,0x00,0x41,0xF0,0x00,0x00, \
+        0x00,0x01,0x1B,0xFE,0x00,0x00,0x99,0x00,0x51,0xF9, \
+        0x00,0x00,0x00,0x00,0x9F,0x98,0x51,0xF9,0x00,0x00, \
+        0x1A,0x14,0x09,0x5F,0x00,0x20,0x00,0x00,0x09,0x4F, \
+        0x00,0x20,0x00,0x00,0x34,0xB7,0x00,0xF9,0x00,0x00, \
+        0x01,0x00,0x00,0x00,0x00,0x00,0x2B,0x97,0x31,0xB3, \
+        0x29,0x8F,0x33,0xF1,0x00,0xF9,0x00,0x01,0x00,0x00, \
+        0x00,0x00,0x00,0x00,0x28,0x7F,0x00,0x03,0x00,0x02, \
+        0x00,0x00,0x00,0x01,0x1B,0xFE,0x00,0x01,0x1B,0xFE, \
+        0x31,0x52,0x00,0xDA,0xFC,0x00,0x00,0x00,0x00,0x00, \
+        0x00,0x00,0x52,0x22,0x40,0x00,0x31,0x92,0x52,0x22, \
+        0x00,0x88,0x1A,0x25,0x08,0x05,0x00,0x00,0x1A,0x69, \
+        0x02,0x1F,0x00,0x08,0x00,0x83,0x02,0x1F,0x00,0x20, \
+        0x28,0x1B,0x00,0x05,0x29,0x1F,0x30,0xD0,0x62,0x45, \
+        0x00,0x07,0x00,0x05,0x00,0x00,0xC3,0x8F,0x00,0x52, \
+        0x00,0x01,0x07,0x01,0x62,0x31,0x00,0x00,0x30,0xD0, \
+        0x00,0xDA,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x00, \
+        0x42,0x42,0x00,0x00,0x02,0x8F,0x00,0x00,0x30,0xF2, \
+        0x00,0x06,0x1A,0x53,0x00,0x00,0x9F,0xFF,0x30,0xF2, \
+        0x00,0x06,0x29,0x1E,0x07,0x08,0x30,0xD0,0x00,0x52, \
+        0x00,0x08,0x28,0x1A,0x62,0x2D,0x00,0x00,0x30,0xF2, \
+        0x1A,0x53,0x06,0x00,0x29,0x1E,0x30,0xF2,0x29,0x0E, \
+        0x30,0x72,0x00,0x00,0x9B,0x8F,0x00,0x06,0x29,0x0E, \
+        0x32,0xF1,0x32,0xB0,0x00,0x4F,0x00,0x57,0x00,0x28, \
+        0x00,0x00,0x97,0x9E,0x00,0x4E,0x30,0x72,0x00,0x06, \
+        0x29,0x0E,0x08,0x05,0x00,0x01,0x31,0x52,0x00,0xDA, \
+        0x0E,0x4F,0x00,0x00,0x00,0x00,0x00,0x00,0x52,0x7F, \
+        0x04,0x4B,0x31,0x53,0x00,0xFB,0xFF,0xF0,0x00,0x00, \
+        0x00,0x00,0x00,0x00,0x29,0x2B,0x33,0xF1,0x00,0xFB, \
+        0x00,0xDF,0x00,0x00,0x00,0x00,0x00,0x00,0x28,0x7F, \
+        0x31,0x52,0x00,0xDA,0x06,0x00,0x00,0x00,0x00,0x00, \
+        0x00,0x00,0x42,0x89,0x00,0x00,0x00,0x01,0x1B,0xFE, \
+        0x31,0x52,0x00,0xDA,0x00,0x40,0x00,0x00,0x00,0x00, \
+        0x00,0x00,0x52,0xED,0x00,0x00,0x00,0x00,0x9B,0x8F, \
+        0x28,0x01,0x32,0xC1,0x00,0x55,0x00,0x28,0x28,0x43, \
+        0x30,0x00,0x42,0x9F,0x00,0x00,0x30,0x00,0x42,0x9F, \
+        0x00,0x3C,0x1A,0xB7,0x32,0x11,0x32,0xC0,0x00,0x4F, \
+        0x00,0x81,0x00,0x00,0x83,0x8F,0x28,0x01,0x06,0x00, \
+        0x32,0x11,0x32,0xC0,0x00,0x4F,0x00,0x55,0x00,0x01, \
+        0x00,0x81,0x32,0x11,0x00,0x00,0x83,0x8E,0x00,0x50, \
+        0x00,0x01,0x01,0x04,0x00,0x4D,0x28,0x43,0x06,0x00, \
+        0x1A,0x98,0x30,0x00,0x42,0xD5,0x00,0x2B,0x00,0x00, \
+        0x9B,0x8E,0x42,0xC3,0x00,0x00,0x32,0xC1,0x00,0x55, \
+        0x00,0x28,0x28,0x43,0x1A,0xD4,0x06,0x29,0x00,0x00, \
+        0x83,0x8F,0x28,0x23,0x06,0x00,0x06,0x29,0x32,0xC1, \
+        0x00,0x55,0x00,0x28,0x00,0x00,0x83,0x8E,0x00,0x50, \
+        0x00,0x01,0x01,0x04,0x00,0x4D,0x28,0x43,0x06,0x00, \
+        0x1A,0xEC,0x32,0x11,0x32,0xC0,0x00,0x4F,0x00,0x81, \
+        0x00,0x00,0x87,0x8F,0x28,0x23,0x06,0x00,0x32,0x11, \
+        0x32,0xC0,0x00,0x4F,0x00,0x55,0x00,0x01,0x00,0x81, \
+        0x32,0x11,0x00,0x00,0x83,0x8E,0x00,0x50,0x00,0x01, \
+        0x01,0x04,0x00,0x4D,0x28,0x43,0x06,0x00,0x1B,0x32, \
+        0x00,0x00,0x9B,0x8F,0x28,0x01,0x32,0xC1,0x00,0x55, \
+        0x00,0x28,0x28,0x43,0x30,0x00,0x43,0x17,0x00,0x2C, \
+        0x32,0x11,0x32,0xC0,0x00,0x4F,0x00,0x81,0x00,0x00, \
+        0x87,0x8F,0x28,0x23,0x06,0x00,0x32,0x11,0x32,0xC0, \
+        0x00,0x4F,0x00,0x81,0x00,0x00,0x83,0x8F,0x28,0x01, \
+        0x06,0x00,0x32,0x11,0x32,0xC0,0x00,0x4F,0x00,0x55, \
+        0x00,0x01,0x00,0x81,0x32,0x11,0x00,0x00,0x83,0x8E, \
+        0x00,0x50,0x00,0x01,0x01,0x04,0x00,0x4D,0x28,0x43, \
+        0x06,0x00,0x1A,0xF4,0x09,0x5F,0x00,0x20,0x00,0x00, \
+        0x09,0x4F,0x00,0x20,0x00,0x00,0x34,0xB7,0x00,0xF9, \
+        0x00,0x00,0x01,0x00,0x00,0x00,0x00,0x00,0x2B,0x97, \
+        0x31,0xB3,0x29,0x8F,0x33,0xF1,0x00,0xF9,0x00,0x01, \
+        0x00,0x00,0x00,0x00,0x00,0x00,0x28,0x7F,0x00,0x03, \
+        0x00,0x02,0x00,0x00,0x00,0x01,0x1B,0xFE,0x30,0x50, \
+        0x53,0x37,0x00,0x00,0x00,0x01,0x1B,0xFE,0x32,0xF1, \
+        0x32,0xC0,0x00,0x4F,0x00,0x81,0x00,0x02,0x00,0x00, \
+        0x97,0x9E,0x43,0x44,0x00,0x08,0x08,0x16,0x00,0x54, \
+        0x00,0x01,0x1B,0xFE,0x00,0x00,0x9F,0x9E,0x43,0x79, \
+        0x00,0x00,0x02,0x1F,0x00,0x08,0x28,0x1B,0x30,0x73, \
+        0x29,0x1F,0x30,0xD0,0x63,0x65,0x00,0x07,0x00,0x05, \
+        0x00,0x00,0xC3,0x8F,0x00,0x52,0x00,0x01,0x07,0x01, \
+        0x63,0x51,0x00,0x00,0x30,0xD0,0x00,0xDA,0x00,0x01, \
+        0x00,0x00,0x00,0x00,0x00,0x00,0x43,0x62,0x00,0x00, \
+        0x02,0x8F,0x00,0x00,0x30,0xF2,0x00,0x06,0x1B,0x73, \
+        0x00,0x00,0x9F,0xFF,0x30,0xF2,0x00,0x06,0x29,0x1E, \
+        0x07,0x08,0x30,0xD0,0x00,0x52,0x00,0x08,0x28,0x1A, \
+        0x63,0x4D,0x00,0x00,0x30,0xF2,0x1B,0x73,0x06,0x00, \
+        0x29,0x1E,0x30,0xF2,0x53,0x79,0xFF,0xFF,0x1B,0x7E, \
+        0x08,0x16,0x00,0x54,0x00,0x01,0x1B,0xFE,0x1B,0x8B, \
+        0x32,0xF1,0x28,0x5D,0x32,0xF1,0x00,0x55,0x00,0x08, \
+        0x28,0x5F,0x00,0x00,0x8F,0x9F,0x29,0x33,0x08,0x16, \
+        0x00,0x49,0x00,0x01,0x1B,0xFF,0x00,0x01,0x1B,0xFF, \
+        0x08,0x07,0x00,0x02,0x00,0x00,0x8D,0x80,0x53,0x97, \
+        0x00,0x01,0x30,0x71,0x00,0x55,0x00,0x01,0x28,0x0F, \
+        0x00,0x00,0x8D,0x00,0x53,0x9F,0x00,0x01,0x30,0x71, \
+        0x00,0x55,0x00,0x01,0x28,0x0F,0x00,0x00,0x83,0x8E, \
+        0x53,0xB4,0x00,0x00,0x00,0x00,0x86,0x08,0x30,0x71, \
+        0x00,0x7B,0x03,0xB4,0x33,0xB4,0x00,0xDA,0xFF,0xFF, \
+        0x00,0x0F,0x00,0x00,0x00,0x00,0x00,0x00,0x86,0x09, \
+        0x01,0x03,0x00,0x7D,0x03,0xB4,0x1B,0xC3,0x33,0xD1, \
+        0x00,0xF9,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00, \
+        0x28,0x7B,0x09,0x5F,0x00,0x1A,0x00,0x00,0x09,0x4F, \
+        0x00,0x1A,0x00,0x00,0x00,0x01,0x1B,0xFF,0x00,0x00, \
+        0x8C,0x00,0x53,0xEB,0x00,0x01,0x34,0xF5,0x00,0xFB, \
+        0xFF,0xFF,0x00,0x7F,0x00,0x00,0x00,0x00,0x2A,0x9F, \
+        0x00,0x00,0x93,0x8F,0x28,0x49,0x00,0x00,0x97,0x8F, \
+        0x28,0x4B,0x34,0x61,0x28,0x4D,0x34,0x71,0x28,0x4F, \
+        0x34,0xB7,0x00,0xF9,0x00,0x00,0x01,0x00,0x00,0x00, \
+        0x00,0x00,0x2B,0x97,0x33,0xF1,0x00,0xF9,0x00,0x01, \
+        0x00,0x00,0x00,0x00,0x00,0x00,0x28,0x7F,0x00,0x03, \
+        0x00,0x02,0x00,0x00,0x00,0x01,0x1B,0xFF,0x00,0x01, \
+        0x1B,0xFF, \
 }
 
 #endif /* (DPAA_VERSION == 10) */
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/fm_port.c b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/fm_port.c
index f6f0ecd..9b4f1ba 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/fm_port.c
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/fm_port.c
@@ -1568,7 +1568,7 @@ static t_Error SetPcd(t_FmPort *p_FmPort, t_FmPortPcdParams *p_PcdParams)
                     p_FmPort->p_FmPortPrsRegs->hdrs[i].lcv,
                     FmPcdGetLcv(p_FmPort->h_FmPcd, p_FmPort->netEnvId, (uint8_t)i));
             /* set HXS register according to default+Additional params+protocol options */
-            WRITE_UINT32( p_FmPort->p_FmPortPrsRegs->hdrs[i].softSeqAttach,
+            WRITE_UINT32(p_FmPort->p_FmPortPrsRegs->hdrs[i].softSeqAttach,
                          tmpHxs[i]);
         }
 
@@ -1594,8 +1594,17 @@ static t_Error SetPcd(t_FmPort *p_FmPort, t_FmPortPcdParams *p_PcdParams)
                     p_PcdParams->p_PrsParams->prsResultPrivateInfo;
 
     } /* end parser */
-    else
+    else {
+        if (FmPcdIsAdvancedOffloadSupported(p_FmPort->h_FmPcd)
+            && (p_FmPort->portType == e_FM_PORT_TYPE_OH_OFFLINE_PARSING))
+        {
+            hdrNum = GetPrsHdrNum(HEADER_TYPE_IPv6);
+            WRITE_UINT32(p_FmPort->p_FmPortPrsRegs->hdrs[hdrNum].softSeqAttach,
+                         (PRS_HDR_SW_PRS_EN | OFFLOAD_SW_PATCH_IPv6_LABEL));
+        }
+
         p_FmPort->privateInfo = 0;
+    }
 
     WRITE_UINT32(
             *p_BmiPrsStartOffset,
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/fm_port.h b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/fm_port.h
index eabf892..bd06b9b 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/fm_port.h
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/fm_port.h
@@ -218,8 +218,8 @@ typedef uint32_t fmPcdEngines_t; /**< options as defined below: */
 #define OFFLOAD_SW_PATCH_IPv4_LABEL             0x300
 #else
 #define OFFLOAD_SW_PATCH_IPv4_SIZE              0x046
-#define OFFLOAD_SW_PATCH_IPv4_LABEL             0x1E0
-#define OFFLOAD_CAPWAP_SW_PATCH_LABEL           0x39b
+#define OFFLOAD_SW_PATCH_IPv4_LABEL             0x1D0
+#define OFFLOAD_CAPWAP_SW_PATCH_LABEL           0x38d
 #endif /* (DPAA_VERSION == 10) */
 /* Will be used for:
  * 1. identify fragments
diff --git a/drivers/net/ethernet/freescale/fman/inc/integrations/FMANV3H/dpaa_integration_ext.h b/drivers/net/ethernet/freescale/fman/inc/integrations/FMANV3H/dpaa_integration_ext.h
index 6df1144..3502c6f 100644
--- a/drivers/net/ethernet/freescale/fman/inc/integrations/FMANV3H/dpaa_integration_ext.h
+++ b/drivers/net/ethernet/freescale/fman/inc/integrations/FMANV3H/dpaa_integration_ext.h
@@ -220,7 +220,7 @@ typedef enum
 #define FM_PCD_PLCR_NUM_ENTRIES         256                 /**< Total number of policer profiles */
 #define FM_PCD_KG_NUM_OF_SCHEMES        32                  /**< Total number of KG schemes */
 #define FM_PCD_MAX_NUM_OF_CLS_PLANS     256                 /**< Number of classification plan entries. */
-#define FM_PCD_PRS_SW_PATCHES_SIZE      0x00000440          /**< Number of bytes saved for patches */
+#define FM_PCD_PRS_SW_PATCHES_SIZE      0x00000460          /**< Number of bytes saved for patches */
 #define FM_PCD_SW_PRS_SIZE              0x00000800          /**< Total size of SW parser area */
 
 /* RTC defines */
diff --git a/drivers/net/ethernet/freescale/fman/inc/integrations/FMANV3L/dpaa_integration_ext.h b/drivers/net/ethernet/freescale/fman/inc/integrations/FMANV3L/dpaa_integration_ext.h
index f489ba2..89b7a6c 100644
--- a/drivers/net/ethernet/freescale/fman/inc/integrations/FMANV3L/dpaa_integration_ext.h
+++ b/drivers/net/ethernet/freescale/fman/inc/integrations/FMANV3L/dpaa_integration_ext.h
@@ -221,7 +221,7 @@ typedef enum
 #define FM_PCD_PLCR_NUM_ENTRIES         256                 /**< Total number of policer profiles */
 #define FM_PCD_KG_NUM_OF_SCHEMES        32                  /**< Total number of KG schemes */
 #define FM_PCD_MAX_NUM_OF_CLS_PLANS     256                 /**< Number of classification plan entries. */
-#define FM_PCD_PRS_SW_PATCHES_SIZE      0x00000440          /**< Number of bytes saved for patches */
+#define FM_PCD_PRS_SW_PATCHES_SIZE      0x00000460          /**< Number of bytes saved for patches */
 #define FM_PCD_SW_PRS_SIZE              0x00000800          /**< Total size of SW parser area */
 
 /* RTC defines */
-- 
1.9.1

