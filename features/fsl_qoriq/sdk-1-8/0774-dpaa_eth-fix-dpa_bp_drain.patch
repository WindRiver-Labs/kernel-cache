From 6f4b3c91ff98c095c34648b80c65bc43067ef6a5 Mon Sep 17 00:00:00 2001
From: Madalin Bucur <madalin.bucur@freescale.com>
Date: Wed, 17 Sep 2014 18:38:32 +0300
Subject: [PATCH 774/987] dpaa_eth: fix dpa_bp_drain()

The continue jumps to the end of the loop, condition is evaluated
and if ret is not > 0 the loop ends. Setting ret to 1 to continue
processing until pool is drained.

Signed-off-by: Madalin Bucur <madalin.bucur@freescale.com>
Change-Id: If0acf0eba9e1fc814ef61b939d717819a48c7e29
Reviewed-on: http://git.am.freescale.net:8181/19071
Reviewed-by: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
Reviewed-by: Marian Cristian Rotariu <marian.rotariu@freescale.com>
[Lu:Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c
index 5ffe7e1..f01e3e9 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_common.c
@@ -762,6 +762,7 @@ void dpa_bp_drain(struct dpa_bp *bp)
 				 * drain them one by one
 				 */
 				num = 1;
+				ret = 1;
 				continue;
 			} else {
 				/* Pool is fully drained */
-- 
1.9.1

