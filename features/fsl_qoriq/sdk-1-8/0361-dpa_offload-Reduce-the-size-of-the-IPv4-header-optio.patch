From 3e84e5d1a05d007e0dd48791270d63313b2b6780 Mon Sep 17 00:00:00 2001
From: Marian Chereji <marian.chereji@freescale.com>
Date: Tue, 27 Aug 2013 17:35:28 +0300
Subject: [PATCH 361/987] dpa_offload: Reduce the size of the IPv4 header
 options field

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

According to RFC 791, the size of the IPv4 header (options
included) is represented on 4 bits (IHL), hence it can be an
absolute maximum of 15 * 4 = 60 bytes. The IPv4 options buffer
size field in the fsl_dpa_offload.h header file, in the
ipv4_header data structure, was declared as an "unsigned int" and
this was causing a static analysis warning in dpa_classifier.

The field was reduced to uint8_t which is more than enough to
store the size of the IPv4 frame options.

Signed-off-by: Marian Chereji <marian.chereji@freescale.com>
Change-Id: I69fb1307329b68da652ed85d659aa10e34c5af67
Reviewed-on: http://git.am.freescale.net:8181/4264
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Bulie Radu-Andrei-B37577 <Radu.Bulie@freescale.com>
Reviewed-by: Rivera Jose-B46482 <German.Rivera@freescale.com>
---
 include/linux/fsl_dpa_offload.h | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/include/linux/fsl_dpa_offload.h b/include/linux/fsl_dpa_offload.h
index c85c4c6..b5f4e6e 100644
--- a/include/linux/fsl_dpa_offload.h
+++ b/include/linux/fsl_dpa_offload.h
@@ -162,7 +162,7 @@ struct ipv4_header {
 	uint8_t				*options;
 
 	/* Size of IPv4 options buffer. Zero for no options. */
-	unsigned int			options_size;
+	uint8_t				options_size;
 };
 
 /* Description of the VLAN header */
-- 
1.9.1

