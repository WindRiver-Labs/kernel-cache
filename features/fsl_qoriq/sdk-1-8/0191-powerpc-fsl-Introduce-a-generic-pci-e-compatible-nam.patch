From 7220b318203d6d032482867f6cc368917bce8ad0 Mon Sep 17 00:00:00 2001
From: Laurentiu Tudor <Laurentiu.Tudor@freescale.com>
Date: Thu, 23 May 2013 12:21:51 +0300
Subject: [PATCH 191/987] powerpc/fsl: Introduce a generic pci-e compatible
 named "fsl,qoriq-pcie"

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

This will allow future code to simply check the pci-e controller
version register plus getting rid of the redundant version from
within the compatible string.

Signed-off-by: Laurentiu Tudor <Laurentiu.Tudor@freescale.com>
Change-Id: I7211a7c426f9e11920369355900ccd236fc248a1
Reviewed-on: http://git.am.freescale.net:8181/2670
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Wood Scott-B07421 <scottwood@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
---
 arch/powerpc/boot/dts/fsl/b4420si-post.dtsi   | 2 +-
 arch/powerpc/boot/dts/fsl/b4860si-post.dtsi   | 2 +-
 arch/powerpc/boot/dts/fsl/b4si-post.dtsi      | 2 +-
 arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi | 2 +-
 arch/powerpc/boot/dts/fsl/p1010si-post.dtsi   | 4 ++--
 arch/powerpc/boot/dts/fsl/p1023si-post.dtsi   | 6 +++---
 arch/powerpc/boot/dts/fsl/p2041si-post.dtsi   | 6 +++---
 arch/powerpc/boot/dts/fsl/p3041si-post.dtsi   | 8 ++++----
 arch/powerpc/boot/dts/fsl/p4080si-post.dtsi   | 6 +++---
 arch/powerpc/boot/dts/fsl/p5020si-post.dtsi   | 8 ++++----
 arch/powerpc/boot/dts/fsl/p5040si-post.dtsi   | 6 +++---
 arch/powerpc/boot/dts/fsl/t4240si-post.dtsi   | 8 ++++----
 12 files changed, 30 insertions(+), 30 deletions(-)

diff --git a/arch/powerpc/boot/dts/fsl/b4420si-post.dtsi b/arch/powerpc/boot/dts/fsl/b4420si-post.dtsi
index fc5438d..752f401 100644
--- a/arch/powerpc/boot/dts/fsl/b4420si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4420si-post.dtsi
@@ -230,7 +230,7 @@
 
 /* controller at 0x200000 */
 &pci0 {
-	compatible = "fsl,b4420-pcie", "fsl,qoriq-pcie-v2.4";
+	compatible = "fsl,b4420-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
 };
 
 &dcsr {
diff --git a/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi b/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
index 53467dd..96750ae 100644
--- a/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
@@ -216,7 +216,7 @@
 };
 /* controller at 0x200000 */
 &pci0 {
-	compatible = "fsl,b4860-pcie", "fsl,qoriq-pcie-v2.4";
+	compatible = "fsl,b4860-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
 };
 
 &rio {
diff --git a/arch/powerpc/boot/dts/fsl/b4si-post.dtsi b/arch/powerpc/boot/dts/fsl/b4si-post.dtsi
index 2b9747b..31dca2e 100644
--- a/arch/powerpc/boot/dts/fsl/b4si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4si-post.dtsi
@@ -46,7 +46,7 @@
 
 /* controller at 0x200000 */
 &pci0 {
-	compatible = "fsl,b4-pcie", "fsl,qoriq-pcie-v2.4";
+	compatible = "fsl,b4-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi b/arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi
index 6650619..4346f25 100644
--- a/arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi
@@ -42,7 +42,7 @@
 
 /* controller at 0xa000 */
 &pci0 {
-	compatible = "fsl,bsc9132-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,bsc9132-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/p1010si-post.dtsi b/arch/powerpc/boot/dts/fsl/p1010si-post.dtsi
index 055cece..1804ed7 100644
--- a/arch/powerpc/boot/dts/fsl/p1010si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p1010si-post.dtsi
@@ -41,7 +41,7 @@
 
 /* controller at 0x9000 */
 &pci0 {
-	compatible = "fsl,p1010-pcie", "fsl,qoriq-pcie-v2.3";
+	compatible = "fsl,p1010-pcie", "fsl,qoriq-pcie-v2.3", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -69,7 +69,7 @@
 
 /* controller at 0xa000 */
 &pci1 {
-	compatible = "fsl,p1010-pcie", "fsl,qoriq-pcie-v2.3";
+	compatible = "fsl,p1010-pcie", "fsl,qoriq-pcie-v2.3", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/p1023si-post.dtsi b/arch/powerpc/boot/dts/fsl/p1023si-post.dtsi
index 273ec36..10be887 100644
--- a/arch/powerpc/boot/dts/fsl/p1023si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p1023si-post.dtsi
@@ -47,7 +47,7 @@
 
 /* controller at 0xa000 */
 &pci0 {
-	compatible = "fsl,p1023-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p1023-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -66,7 +66,7 @@
 
 /* controller at 0x9000 */
 &pci1 {
-	compatible = "fsl,p1023-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p1023-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -85,7 +85,7 @@
 
 /* controller at 0xb000 */
 &pci2 {
-	compatible = "fsl,p1023-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p1023-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/p2041si-post.dtsi b/arch/powerpc/boot/dts/fsl/p2041si-post.dtsi
index e9e700b..0b92c22 100644
--- a/arch/powerpc/boot/dts/fsl/p2041si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p2041si-post.dtsi
@@ -46,7 +46,7 @@
 
 /* controller at 0x200000 */
 &pci0 {
-	compatible = "fsl,p2041-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p2041-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -75,7 +75,7 @@
 
 /* controller at 0x201000 */
 &pci1 {
-	compatible = "fsl,p2041-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p2041-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -104,7 +104,7 @@
 
 /* controller at 0x202000 */
 &pci2 {
-	compatible = "fsl,p2041-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p2041-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/p3041si-post.dtsi b/arch/powerpc/boot/dts/fsl/p3041si-post.dtsi
index 18129c3..fc071fe 100644
--- a/arch/powerpc/boot/dts/fsl/p3041si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p3041si-post.dtsi
@@ -46,7 +46,7 @@
 
 /* controller at 0x200000 */
 &pci0 {
-	compatible = "fsl,p3041-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p3041-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -75,7 +75,7 @@
 
 /* controller at 0x201000 */
 &pci1 {
-	compatible = "fsl,p3041-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p3041-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -104,7 +104,7 @@
 
 /* controller at 0x202000 */
 &pci2 {
-	compatible = "fsl,p3041-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p3041-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -133,7 +133,7 @@
 
 /* controller at 0x203000 */
 &pci3 {
-	compatible = "fsl,p3041-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p3041-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/p4080si-post.dtsi b/arch/powerpc/boot/dts/fsl/p4080si-post.dtsi
index 4aa8a64..f1fadb7 100644
--- a/arch/powerpc/boot/dts/fsl/p4080si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p4080si-post.dtsi
@@ -46,7 +46,7 @@
 
 /* controller at 0x200000 */
 &pci0 {
-	compatible = "fsl,p4080-pcie", "fsl,qoriq-pcie-v2.1";
+	compatible = "fsl,p4080-pcie", "fsl,qoriq-pcie-v2.1", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -75,7 +75,7 @@
 
 /* controller at 0x201000 */
 &pci1 {
-	compatible = "fsl,p4080-pcie", "fsl,qoriq-pcie-v2.1";
+	compatible = "fsl,p4080-pcie", "fsl,qoriq-pcie-v2.1", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -104,7 +104,7 @@
 
 /* controller at 0x202000 */
 &pci2 {
-	compatible = "fsl,p4080-pcie", "fsl,qoriq-pcie-v2.1";
+	compatible = "fsl,p4080-pcie", "fsl,qoriq-pcie-v2.1", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/p5020si-post.dtsi b/arch/powerpc/boot/dts/fsl/p5020si-post.dtsi
index f4c8a81..cd01954 100644
--- a/arch/powerpc/boot/dts/fsl/p5020si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p5020si-post.dtsi
@@ -46,7 +46,7 @@
 
 /* controller at 0x200000 */
 &pci0 {
-	compatible = "fsl,p5020-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p5020-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -75,7 +75,7 @@
 
 /* controller at 0x201000 */
 &pci1 {
-	compatible = "fsl,p5020-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p5020-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -104,7 +104,7 @@
 
 /* controller at 0x202000 */
 &pci2 {
-	compatible = "fsl,p5020-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p5020-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -133,7 +133,7 @@
 
 /* controller at 0x203000 */
 &pci3 {
-	compatible = "fsl,p5020-pcie", "fsl,qoriq-pcie-v2.2";
+	compatible = "fsl,p5020-pcie", "fsl,qoriq-pcie-v2.2", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/p5040si-post.dtsi b/arch/powerpc/boot/dts/fsl/p5040si-post.dtsi
index 5d6e7f6..93df6c1 100644
--- a/arch/powerpc/boot/dts/fsl/p5040si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p5040si-post.dtsi
@@ -46,7 +46,7 @@
 
 /* controller at 0x200000 */
 &pci0 {
-	compatible = "fsl,p5040-pcie", "fsl,qoriq-pcie-v2.4";
+	compatible = "fsl,p5040-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -74,7 +74,7 @@
 
 /* controller at 0x201000 */
 &pci1 {
-	compatible = "fsl,p5040-pcie", "fsl,qoriq-pcie-v2.4";
+	compatible = "fsl,p5040-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -102,7 +102,7 @@
 
 /* controller at 0x202000 */
 &pci2 {
-	compatible = "fsl,p5040-pcie", "fsl,qoriq-pcie-v2.4";
+	compatible = "fsl,p5040-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi b/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
index aa407ad..ac73e25 100644
--- a/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
@@ -46,7 +46,7 @@
 
 /* controller at 0x240000 */
 &pci0 {
-	compatible = "fsl,t4240-pcie", "fsl,qoriq-pcie-v3.0";
+	compatible = "fsl,t4240-pcie", "fsl,qoriq-pcie-v3.0", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -72,7 +72,7 @@
 
 /* controller at 0x250000 */
 &pci1 {
-	compatible = "fsl,t4240-pcie", "fsl,qoriq-pcie-v3.0";
+	compatible = "fsl,t4240-pcie", "fsl,qoriq-pcie-v3.0", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -98,7 +98,7 @@
 
 /* controller at 0x260000 */
 &pci2 {
-	compatible = "fsl,t4240-pcie", "fsl,qoriq-pcie-v3.0";
+	compatible = "fsl,t4240-pcie", "fsl,qoriq-pcie-v3.0", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
@@ -124,7 +124,7 @@
 
 /* controller at 0x270000 */
 &pci3 {
-	compatible = "fsl,t4240-pcie", "fsl,qoriq-pcie-v3.0";
+	compatible = "fsl,t4240-pcie", "fsl,qoriq-pcie-v3.0", "fsl,qoriq-pcie";
 	device_type = "pci";
 	#size-cells = <2>;
 	#address-cells = <3>;
-- 
1.9.1

