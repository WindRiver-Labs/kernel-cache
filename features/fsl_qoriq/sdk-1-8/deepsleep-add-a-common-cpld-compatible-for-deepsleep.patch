From 7aa1b815b0cbd03f6c7928632015302aee7e8ff8 Mon Sep 17 00:00:00 2001
From: Wang Dongsheng <dongsheng.wang@freescale.com>
Date: Thu, 11 Sep 2014 14:39:11 +0800
Subject: [PATCH 33/57] deepsleep: add a common cpld compatible for deepsleep

use the common compatible "fsl,deepsleep-cpld" for deepsleep on multiple boards.

Signed-off-by: Wang Dongsheng <dongsheng.wang@freescale.com>
Change-Id: I7efc5292421376d4ca62a4f1489ce7fb9258097d
Reviewed-on: http://git.am.freescale.net:8181/21424
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Xiaobo Xie <X.Xie@freescale.com>
Reviewed-by: Shengzhou Liu <Shengzhou.Liu@freescale.com>
[Original patch taken from QorIQ-SDK-V1.8-20150619-yocto.]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/powerpc/boot/dts/t1024rdb.dts         |    2 +-
 arch/powerpc/boot/dts/t1040rdb-dsar.dts    |    2 +-
 arch/powerpc/boot/dts/t1040rdb.dts         |    2 +-
 arch/powerpc/boot/dts/t1042rdb.dts         |    2 +-
 arch/powerpc/boot/dts/t1042rdb_pi-dsar.dts |    2 +-
 arch/powerpc/boot/dts/t1042rdb_pi.dts      |    2 +-
 arch/powerpc/platforms/85xx/deepsleep.c    |    2 +-
 7 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/arch/powerpc/boot/dts/t1024rdb.dts b/arch/powerpc/boot/dts/t1024rdb.dts
index f2b2350..da9ac57 100644
--- a/arch/powerpc/boot/dts/t1024rdb.dts
+++ b/arch/powerpc/boot/dts/t1024rdb.dts
@@ -66,7 +66,7 @@
 		board-control@2,0 {
 			#address-cells = <1>;
 			#size-cells = <1>;
-			compatible = "fsl,t1024-cpld";
+			compatible = "fsl,t1024-cpld", "fsl,deepsleep-cpld";
 			reg = <3 0 0x300>;
 			ranges = <0 3 0 0x300>;
 			bank-width = <1>;
diff --git a/arch/powerpc/boot/dts/t1040rdb-dsar.dts b/arch/powerpc/boot/dts/t1040rdb-dsar.dts
index b550858..6a27686 100644
--- a/arch/powerpc/boot/dts/t1040rdb-dsar.dts
+++ b/arch/powerpc/boot/dts/t1040rdb-dsar.dts
@@ -115,7 +115,7 @@
 		cpld@3,0 {
 			#address-cells = <1>;
 			#size-cells = <1>;
-			compatible = "fsl,t104xrdb-cpld";
+			compatible = "fsl,t104xrdb-cpld", "fsl,deepsleep-cpld";
 			reg = <3 0 0x20>;
 			ranges = <0 3 0 0x20>;
 			bank-width = <1>;
diff --git a/arch/powerpc/boot/dts/t1040rdb.dts b/arch/powerpc/boot/dts/t1040rdb.dts
index 2022b19..4d6de1f 100644
--- a/arch/powerpc/boot/dts/t1040rdb.dts
+++ b/arch/powerpc/boot/dts/t1040rdb.dts
@@ -98,7 +98,7 @@
 		cpld@3,0 {
 			#address-cells = <1>;
 			#size-cells = <1>;
-			compatible = "fsl,t104xrdb-cpld";
+			compatible = "fsl,t104xrdb-cpld", "fsl,deepsleep-cpld";
 			reg = <3 0 0x20>;
 			ranges = <0 3 0 0x20>;
 			bank-width = <1>;
diff --git a/arch/powerpc/boot/dts/t1042rdb.dts b/arch/powerpc/boot/dts/t1042rdb.dts
index 0f44020..39b591c 100644
--- a/arch/powerpc/boot/dts/t1042rdb.dts
+++ b/arch/powerpc/boot/dts/t1042rdb.dts
@@ -98,7 +98,7 @@
 		cpld@3,0 {
 			#address-cells = <1>;
 			#size-cells = <1>;
-			compatible = "fsl,t104xrdb-cpld";
+			compatible = "fsl,t104xrdb-cpld", "fsl,deepsleep-cpld";
 			reg = <3 0 0x20>;
 			ranges = <0 3 0 0x20>;
 			bank-width = <1>;
diff --git a/arch/powerpc/boot/dts/t1042rdb_pi-dsar.dts b/arch/powerpc/boot/dts/t1042rdb_pi-dsar.dts
index b49e583..905374c 100644
--- a/arch/powerpc/boot/dts/t1042rdb_pi-dsar.dts
+++ b/arch/powerpc/boot/dts/t1042rdb_pi-dsar.dts
@@ -115,7 +115,7 @@
 		cpld@3,0 {
 			#address-cells = <1>;
 			#size-cells = <1>;
-			compatible = "fsl,t104xrdb-cpld";
+			compatible = "fsl,t104xrdb-cpld", "fsl,deepsleep-cpld";
 			reg = <3 0 0x20>;
 			ranges = <0 3 0 0x20>;
 			bank-width = <1>;
diff --git a/arch/powerpc/boot/dts/t1042rdb_pi.dts b/arch/powerpc/boot/dts/t1042rdb_pi.dts
index 3b5cf98..16dc2fa 100644
--- a/arch/powerpc/boot/dts/t1042rdb_pi.dts
+++ b/arch/powerpc/boot/dts/t1042rdb_pi.dts
@@ -97,7 +97,7 @@
 		cpld@3,0 {
 			#address-cells = <1>;
 			#size-cells = <1>;
-			compatible = "fsl,t104xrdb-cpld";
+			compatible = "fsl,t104xrdb-cpld", "fsl,deepsleep-cpld";
 			reg = <3 0 0x20>;
 			ranges = <0 3 0 0x20>;
 			bank-width = <1>;
diff --git a/arch/powerpc/platforms/85xx/deepsleep.c b/arch/powerpc/platforms/85xx/deepsleep.c
index 88dee90..e249a92 100644
--- a/arch/powerpc/platforms/85xx/deepsleep.c
+++ b/arch/powerpc/platforms/85xx/deepsleep.c
@@ -75,7 +75,7 @@ int fsl_dp_iomap(void)
 	if (np) {
 		pld_flag = T1040QDS_TETRA_FLAG;
 	} else {
-		np = of_find_compatible_node(NULL, NULL, "fsl,t104xrdb-cpld");
+		np = of_find_compatible_node(NULL, NULL, "fsl,deepsleep-cpld");
 		if (np) {
 			pld_flag = T104xRDB_CPLD_FLAG;
 		} else {
-- 
1.7.5.4

