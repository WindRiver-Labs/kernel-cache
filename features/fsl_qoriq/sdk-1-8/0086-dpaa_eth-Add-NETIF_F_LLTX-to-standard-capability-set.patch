From d081c76ae0bed27f7cbaee267ee4349764d3a1ce Mon Sep 17 00:00:00 2001
From: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
Date: Mon, 25 Mar 2013 11:33:21 +0200
Subject: [PATCH 086/987] dpaa_eth: Add NETIF_F_LLTX to standard capability set

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

The "lockless tx" capability, although flagged as deprecated, was deemed
closer to upstreamability than our previous NETIF_F_HW_QDISC (meanwhile
moved under ASF config). This has shown no performance impact
whatsoever, at least in termination/netperf tests.

Change-Id: I0294f0f105e56cc00cb957c23a3a6c6d3acc8d6f
Signed-off-by: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
Reviewed-on: http://git.am.freescale.net:8181/1282
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index e4f8efa..bd41f3b 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -3678,8 +3678,10 @@ static int dpa_netdev_init(struct device_node *dpa_node,
 		net_dev->mem_end = priv->mac_dev->res->end;
 
 		mac_addr = priv->mac_dev->addr;
-		net_dev->features |= (NETIF_F_IP_CSUM | NETIF_F_IPV6_CSUM);
-		net_dev->vlan_features |= (NETIF_F_IP_CSUM | NETIF_F_IPV6_CSUM);
+		net_dev->features |= (NETIF_F_IP_CSUM | NETIF_F_IPV6_CSUM |
+			NETIF_F_LLTX);
+		net_dev->vlan_features |= (NETIF_F_IP_CSUM | NETIF_F_IPV6_CSUM |
+			NETIF_F_LLTX);
 
 		/*
 		 * Advertise S/G and HIGHDMA support for MAC-ful,
-- 
1.9.1

