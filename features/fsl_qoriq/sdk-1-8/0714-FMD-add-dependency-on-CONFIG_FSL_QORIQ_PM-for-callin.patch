From 73a1c66c663d43d969acf6f4191d4cc9d0f58604 Mon Sep 17 00:00:00 2001
From: Eyal Harari <Eyal.Harari@freesacle.com>
Date: Thu, 29 May 2014 18:34:00 +0300
Subject: [PATCH 714/987] FMD: add dependency on CONFIG_FSL_QORIQ_PM for
 calling fsl_set_power_except()

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

Signed-off-by: Eyal Harari <Eyal.Harari@freesacle.com>
Change-Id: If804bfb9694ad08330e7a7c083cec9970ad4954d
Reviewed-on: http://git.am.freescale.net:8181/13062
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Mandy Lavi <Mandy.Lavi@freescale.com>
Reviewed-by: Jose Rivera <German.Rivera@freescale.com>
---
 drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c b/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c
index a4a68c0..b4d3fc0 100755
--- a/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c
+++ b/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c
@@ -1110,7 +1110,9 @@ static int fm_soc_suspend(struct device *dev)
 	if (started_ar_enter)
 	{
 		uint32_t *fmclk;
+#ifdef CONFIG_FSL_QORIQ_PM
 		fsl_set_power_except(dev,1);
+#endif
 		FM_PORT_Dsar_enter_final();
 		fmclk = ioremap(SCFG_FMCLKDPSLPCR_ADDR, 4);
 		WRITE_UINT32(*fmclk, SCFG_FMCLKDPSLPCR_DS_VAL);
-- 
1.9.1

