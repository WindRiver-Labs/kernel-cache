From 5acd8410247564d80895c32b0a22f626705a2e21 Mon Sep 17 00:00:00 2001
From: Cristian Stoica <cristian.stoica@freescale.com>
Date: Thu, 18 Sep 2014 14:49:49 +0300
Subject: [PATCH 1311/1336] crypto: caam: remove dead code

- assoc_nents and src_nents are never zero when all_contig is false
- iv_contig is zero on the else branch

Signed-off-by: Cristian Stoica <cristian.stoica@freescale.com>
Change-Id: Iccd420733cac736e92c1f9b0cb8fb83fd39b40e4
Reviewed-on: http://git.am.freescale.net:8181/19799
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Richard Schmitt <richard.schmitt@freescale.com>
[Lu:Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
[Yang: add missing part for upstream commit 35b82e5540ee]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/crypto/caam/caamalg_qi.c | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/drivers/crypto/caam/caamalg_qi.c b/drivers/crypto/caam/caamalg_qi.c
index 414952d..57b38d0 100644
--- a/drivers/crypto/caam/caamalg_qi.c
+++ b/drivers/crypto/caam/caamalg_qi.c
@@ -1185,15 +1185,15 @@ static struct aead_edesc *aead_edesc_alloc(struct aead_request *req,
 		fd_sgt[1].extension = 1;
 		fd_sgt[1].addr = qm_sg_dma;
 
-		sg_to_qm_sg(req->assoc, (assoc_nents ? : 1), sg_table, 0);
-		qm_sg_index += assoc_nents ? : 1;
+		sg_to_qm_sg(req->assoc, assoc_nents, sg_table, 0);
+		qm_sg_index += assoc_nents;
 
 		dma_to_qm_sg_one(sg_table + qm_sg_index, iv_dma, ivsize, 0);
 		qm_sg_index += 1;
 
-		sg_to_qm_sg_last(req->src, (src_nents ? : 1),
+		sg_to_qm_sg_last(req->src, src_nents,
 				 sg_table + qm_sg_index, 0);
-		qm_sg_index += src_nents ? : 1;
+		qm_sg_index += src_nents;
 
 	} else {
 		fd_sgt[1].extension = 0;
-- 
2.0.2

