From 3a0e9609528ac6635d1b45399ca37278eb6a8c23 Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Thu, 7 Mar 2013 19:37:52 +0800
Subject: [PATCH 1177/1207] powerpc/fsl_book3e: fix the relocatable bug in
 fsl_enable_threads

The LOAD_REG_IMMEDIATE can't be used to load a function address when
relocatable enabled. So replace it with LOAD_REG_ADDR.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 arch/powerpc/kernel/exceptions-64e.S | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/powerpc/kernel/exceptions-64e.S b/arch/powerpc/kernel/exceptions-64e.S
index 2002517..6490ea9 100644
--- a/arch/powerpc/kernel/exceptions-64e.S
+++ b/arch/powerpc/kernel/exceptions-64e.S
@@ -1641,7 +1641,7 @@ BEGIN_FTR_SECTION
 	 * Set the NIA for the secondary thread to
 	 * generic_secondary_thread_init
 	 */
-	LOAD_REG_IMMEDIATE(r3, .fsl_secondary_thread_init);
+	LOAD_REG_ADDR(r3, .fsl_secondary_thread_init);
 	MTTMR(TMRN_INIA1, 3);
 
 	/* Release the other thread. It will spin until kick_cpu is called */
-- 
2.0.2

