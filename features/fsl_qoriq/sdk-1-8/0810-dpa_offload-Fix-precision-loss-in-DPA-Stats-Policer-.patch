From c19fe9b031b4e23e486d448d7116ac4eb0bc59e5 Mon Sep 17 00:00:00 2001
From: Anca Jeanina Floarea <anca.floarea@freescale.com>
Date: Mon, 15 Sep 2014 16:08:42 +0300
Subject: [PATCH 810/987] dpa_offload: Fix precision loss in DPA Stats Policer
 counter

The value returned by FM_PCD_PlcrProfileGetCounter function
is cast to uint64_t while the variable to store it in is
uint32_t. Changed the variable from uint32_t to uint64_t.

Signed-off-by: Anca Jeanina Floarea <anca.floarea@freescale.com>
Change-Id: I6c6e7be411ca66ea62541ea860ad39b8d660be66
Reviewed-on: http://git.am.freescale.net:8181/18801
Reviewed-by: Marian-Cornel Chereji <marian.chereji@freescale.com>
Tested-by: Marian-Cornel Chereji <marian.chereji@freescale.com>
[Lu:Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/staging/fsl_dpa_offload/dpa_stats.c | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/drivers/staging/fsl_dpa_offload/dpa_stats.c b/drivers/staging/fsl_dpa_offload/dpa_stats.c
index b3902d0..0e05594 100644
--- a/drivers/staging/fsl_dpa_offload/dpa_stats.c
+++ b/drivers/staging/fsl_dpa_offload/dpa_stats.c
@@ -2342,7 +2342,8 @@ static int set_cls_cnt_plcr_cb(struct dpa_stats_cnt_cb *cnt_cb,
 {
 	struct dpa_stats *dpa_stats = cnt_cb->dpa_stats;
 	uint32_t cnt_sel = params->plcr_params.cnt_sel;
-	uint32_t i, j, stats, stats_idx, stats_base_idx;
+	uint32_t i, j, stats_idx, stats_base_idx;
+	uint64_t stats;
 	int err;
 
 	if (!dpa_stats) {
-- 
1.9.1

