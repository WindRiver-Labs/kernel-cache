From fe65e2be25406ea5412c13777e3cfa6fc6483154 Mon Sep 17 00:00:00 2001
From: Wang Quanyang <quanyang.wang@windriver.com>
Date: Thu, 24 Sep 2015 13:55:29 +0000
Subject: [PATCH 981/987] fsl_eth: use this_cpu_ptr instead of __get_cpu_var

According to the upstream commit 69111bac42f5
("powerpc: Replace __get_cpu_var uses"), use this_cpu_ptr
instead of __get_cpu_var.

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/staging/fsl_qbman/bman_high.c | 2 +-
 drivers/staging/fsl_qbman/qman_high.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/staging/fsl_qbman/bman_high.c b/drivers/staging/fsl_qbman/bman_high.c
index 6006c72..510d835 100644
--- a/drivers/staging/fsl_qbman/bman_high.c
+++ b/drivers/staging/fsl_qbman/bman_high.c
@@ -117,7 +117,7 @@ static inline void put_affine_portal(void)
 }
 static inline struct bman_portal *get_poll_portal(void)
 {
-	return &__get_cpu_var(bman_affine_portal);
+	return this_cpu_ptr(&bman_affine_portal);
 }
 #define put_poll_portal()
 
diff --git a/drivers/staging/fsl_qbman/qman_high.c b/drivers/staging/fsl_qbman/qman_high.c
index 229110f..6b6ff556 100644
--- a/drivers/staging/fsl_qbman/qman_high.c
+++ b/drivers/staging/fsl_qbman/qman_high.c
@@ -194,7 +194,7 @@ static inline void put_affine_portal(void)
  * this case to not disable pre-emption. */
 static inline struct qman_portal *get_poll_portal(void)
 {
-	return &__get_cpu_var(qman_affine_portal);
+	return this_cpu_ptr(&qman_affine_portal);
 }
 #define put_poll_portal()
 
-- 
1.9.1

