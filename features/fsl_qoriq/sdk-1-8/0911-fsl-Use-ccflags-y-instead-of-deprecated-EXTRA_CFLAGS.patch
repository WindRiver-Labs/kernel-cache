From e6980aac88a22a95bcb8a169ed194b322310c7ab Mon Sep 17 00:00:00 2001
From: Wang Dongsheng <dongsheng.wang@freescale.com>
Date: Fri, 20 Mar 2015 13:45:24 +0800
Subject: [PATCH 911/987] fsl: Use ccflags-y instead of deprecated EXTRA_CFLAGS

This allows users to pass in additional compiler flags through the
environment variable EXTRA_CFLAGS, e.g.

   make EXTRA_CFLAGS=-Wno-error

Signed-off-by: Wang Dongsheng <dongsheng.wang@freescale.com>
Change-Id: I36513506ee1671c31bb076e9b73c2e8e2442cf4f
Reviewed-on: http://git.am.freescale.net:8181/33146
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Honghua Yin <Hong-Hua.Yin@freescale.com>
[Yang: Original patch taken from
QorIQ-SDK-V1.8-SOURCE-20150619-yocto.iso]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/crypto/caam/Makefile                       |  2 +-
 drivers/net/ethernet/freescale/dpa/capwap/Makefile |  2 +-
 drivers/net/ethernet/freescale/fman/Makefile       |  2 +-
 .../freescale/fman/Peripherals/FM/HC/Makefile      |  4 +--
 .../freescale/fman/Peripherals/FM/MAC/Makefile     |  4 +--
 .../freescale/fman/Peripherals/FM/Makefile         |  4 +--
 .../freescale/fman/Peripherals/FM/Pcd/Makefile     |  4 +--
 .../freescale/fman/Peripherals/FM/Port/Makefile    |  4 +--
 .../freescale/fman/Peripherals/FM/Rtc/Makefile     |  4 +--
 .../freescale/fman/Peripherals/FM/SP/Makefile      |  4 +--
 drivers/net/ethernet/freescale/fman/etc/Makefile   |  2 +-
 drivers/net/ethernet/freescale/fman/ncsw_config.mk | 38 +++++++++++-----------
 drivers/net/ethernet/freescale/fman/src/Makefile   |  2 +-
 .../ethernet/freescale/fman/src/system/Makefile    |  2 +-
 .../ethernet/freescale/fman/src/wrapper/Makefile   |  6 ++--
 .../net/ethernet/freescale/fman/src/xx/Makefile    |  2 +-
 drivers/staging/fsl_dpa_offload/Makefile           |  2 +-
 drivers/tdm/Makefile                               |  2 +-
 drivers/tdm/device/Makefile                        |  2 +-
 19 files changed, 46 insertions(+), 46 deletions(-)

diff --git a/drivers/crypto/caam/Makefile b/drivers/crypto/caam/Makefile
index 550758a..3904700 100644
--- a/drivers/crypto/caam/Makefile
+++ b/drivers/crypto/caam/Makefile
@@ -2,7 +2,7 @@
 # Makefile for the CAAM backend and dependent components
 #
 ifeq ($(CONFIG_CRYPTO_DEV_FSL_CAAM_DEBUG), y)
-	EXTRA_CFLAGS := -DDEBUG
+	ccflags-y := -DDEBUG
 endif
 
 obj-$(CONFIG_CRYPTO_DEV_FSL_CAAM) += caam.o
diff --git a/drivers/net/ethernet/freescale/dpa/capwap/Makefile b/drivers/net/ethernet/freescale/dpa/capwap/Makefile
index b53fdfb..b7d80b8 100644
--- a/drivers/net/ethernet/freescale/dpa/capwap/Makefile
+++ b/drivers/net/ethernet/freescale/dpa/capwap/Makefile
@@ -38,7 +38,7 @@ ccflags-y += -DVERSION=\"\"
 #Include NetComm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
-EXTRA_CFLAGS += \
+ccflags-y += \
 	-Idrivers/crypto/caam \
 	-Idrivers/net/ethernet/freescale/fman/src/wrapper \
 	-Idrivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd \
diff --git a/drivers/net/ethernet/freescale/fman/Makefile b/drivers/net/ethernet/freescale/fman/Makefile
index 7115296..4a3fc9d 100644
--- a/drivers/net/ethernet/freescale/fman/Makefile
+++ b/drivers/net/ethernet/freescale/fman/Makefile
@@ -1,7 +1,7 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/HC/Makefile b/drivers/net/ethernet/freescale/fman/Peripherals/FM/HC/Makefile
index bcbc72e..a6b64e8 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/HC/Makefile
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/HC/Makefile
@@ -1,14 +1,14 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
 NCSW_FM_INC = $(srctree)/drivers/net/ethernet/freescale/fman/Peripherals/FM/inc
 
-EXTRA_CFLAGS += -I$(NCSW_FM_INC)
+ccflags-y += -I$(NCSW_FM_INC)
 
 obj-y		+= fsl-ncsw-Hc.o
 
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/MAC/Makefile b/drivers/net/ethernet/freescale/fman/Peripherals/FM/MAC/Makefile
index f89b563..6a31a12 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/MAC/Makefile
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/MAC/Makefile
@@ -1,14 +1,14 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
 NCSW_FM_INC = $(srctree)/drivers/net/ethernet/freescale/fman/Peripherals/FM/inc
 
-EXTRA_CFLAGS += -I$(NCSW_FM_INC)
+ccflags-y += -I$(NCSW_FM_INC)
 
 obj-y		+= fsl-ncsw-MAC.o
 
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Makefile b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Makefile
index d691a13..7fbf838 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Makefile
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Makefile
@@ -1,13 +1,13 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 NCSW_FM_INC = $(srctree)/drivers/net/ethernet/freescale/fman/Peripherals/FM/inc
 
-EXTRA_CFLAGS += -I$(NCSW_FM_INC)
+ccflags-y += -I$(NCSW_FM_INC)
 
 
 obj-y		+= fsl-ncsw-PFM1.o
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd/Makefile b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd/Makefile
index 70c7d7e..965c63f 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd/Makefile
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd/Makefile
@@ -1,14 +1,14 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
 NCSW_FM_INC = $(srctree)/drivers/net/ethernet/freescale/fman/Peripherals/FM/inc
 
-EXTRA_CFLAGS += -I$(NCSW_FM_INC)
+ccflags-y += -I$(NCSW_FM_INC)
 
 obj-y		+= fsl-ncsw-Pcd.o
 
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/Makefile b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/Makefile
index c94c54c..4eb302d 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/Makefile
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Port/Makefile
@@ -1,14 +1,14 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
 NCSW_FM_INC = $(srctree)/drivers/net/ethernet/freescale/fman/Peripherals/FM/inc
 
-EXTRA_CFLAGS += -I$(NCSW_FM_INC)
+ccflags-y += -I$(NCSW_FM_INC)
 
 obj-y		+= fsl-ncsw-Pcd.o
 
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Rtc/Makefile b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Rtc/Makefile
index f804c51..e7dfc59 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/Rtc/Makefile
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/Rtc/Makefile
@@ -1,14 +1,14 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
 NCSW_FM_INC = $(srctree)/drivers/net/ethernet/freescale/fman/Peripherals/FM/inc
 
-EXTRA_CFLAGS += -I$(NCSW_FM_INC)
+ccflags-y += -I$(NCSW_FM_INC)
 
 obj-y		+= fsl-ncsw-RTC.o
 
diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/SP/Makefile b/drivers/net/ethernet/freescale/fman/Peripherals/FM/SP/Makefile
index 669e940..47feae7 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/SP/Makefile
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/SP/Makefile
@@ -1,14 +1,14 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
 NCSW_FM_INC = $(srctree)/drivers/net/ethernet/freescale/fman/Peripherals/FM/inc
 
-EXTRA_CFLAGS += -I$(NCSW_FM_INC)
+ccflags-y += -I$(NCSW_FM_INC)
 
 obj-y		+= fsl-ncsw-sp.o
 
diff --git a/drivers/net/ethernet/freescale/fman/etc/Makefile b/drivers/net/ethernet/freescale/fman/etc/Makefile
index 5e7c382..427762f 100644
--- a/drivers/net/ethernet/freescale/fman/etc/Makefile
+++ b/drivers/net/ethernet/freescale/fman/etc/Makefile
@@ -1,7 +1,7 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 
diff --git a/drivers/net/ethernet/freescale/fman/ncsw_config.mk b/drivers/net/ethernet/freescale/fman/ncsw_config.mk
index 14cb9d0..7b386e2 100644
--- a/drivers/net/ethernet/freescale/fman/ncsw_config.mk
+++ b/drivers/net/ethernet/freescale/fman/ncsw_config.mk
@@ -6,36 +6,36 @@ DRV_DPA     = $(srctree)/drivers/net/ethernet/freescale/dpa
 FMAN        = $(srctree)/drivers/net/ethernet/freescale/fman
 
 ifeq ("$(CONFIG_FMAN_P3040_P4080_P5020)", "y")
-EXTRA_CFLAGS +=-include $(FMAN)/p3040_4080_5020_dflags.h
+ccflags-y +=-include $(FMAN)/p3040_4080_5020_dflags.h
 endif
 ifeq ("$(CONFIG_FMAN_P1023)", "y")
-EXTRA_CFLAGS +=-include $(FMAN)/p1023_dflags.h
+ccflags-y +=-include $(FMAN)/p1023_dflags.h
 endif
 ifdef CONFIG_FMAN_T4240
-EXTRA_CFLAGS +=-include $(FMAN)/t4240_dflags.h
+ccflags-y +=-include $(FMAN)/t4240_dflags.h
 endif
 
-EXTRA_CFLAGS += -I$(DRV_DPA)/
-EXTRA_CFLAGS += -I$(FMAN)/inc
-EXTRA_CFLAGS += -I$(FMAN)/inc/cores
-EXTRA_CFLAGS += -I$(FMAN)/inc/etc
-EXTRA_CFLAGS += -I$(FMAN)/inc/Peripherals
-EXTRA_CFLAGS += -I$(FMAN)/inc/flib
+ccflags-y += -I$(DRV_DPA)/
+ccflags-y += -I$(FMAN)/inc
+ccflags-y += -I$(FMAN)/inc/cores
+ccflags-y += -I$(FMAN)/inc/etc
+ccflags-y += -I$(FMAN)/inc/Peripherals
+ccflags-y += -I$(FMAN)/inc/flib
 
 ifeq ("$(CONFIG_FMAN_P3040_P4080_P5020)", "y")
-EXTRA_CFLAGS += -I$(FMAN)/inc/integrations/P3040_P4080_P5020
+ccflags-y += -I$(FMAN)/inc/integrations/P3040_P4080_P5020
 endif
 ifeq ("$(CONFIG_FMAN_P1023)", "y")
-EXTRA_CFLAGS += -I$(FMAN)/inc/integrations/P1023
+ccflags-y += -I$(FMAN)/inc/integrations/P1023
 endif
 ifdef CONFIG_FMAN_T4240
-EXTRA_CFLAGS += -I$(FMAN)/inc/integrations/T4240
+ccflags-y += -I$(FMAN)/inc/integrations/T4240
 endif
 
-EXTRA_CFLAGS += -I$(FMAN)/src/inc
-EXTRA_CFLAGS += -I$(FMAN)/src/inc/system
-EXTRA_CFLAGS += -I$(FMAN)/src/inc/wrapper
-EXTRA_CFLAGS += -I$(FMAN)/src/inc/xx
-EXTRA_CFLAGS += -I$(srctree)/include/uapi/linux/fmd
-EXTRA_CFLAGS += -I$(srctree)/include/uapi/linux/fmd/Peripherals
-EXTRA_CFLAGS += -I$(srctree)/include/uapi/linux/fmd/integrations
+ccflags-y += -I$(FMAN)/src/inc
+ccflags-y += -I$(FMAN)/src/inc/system
+ccflags-y += -I$(FMAN)/src/inc/wrapper
+ccflags-y += -I$(FMAN)/src/inc/xx
+ccflags-y += -I$(srctree)/include/uapi/linux/fmd
+ccflags-y += -I$(srctree)/include/uapi/linux/fmd/Peripherals
+ccflags-y += -I$(srctree)/include/uapi/linux/fmd/integrations
diff --git a/drivers/net/ethernet/freescale/fman/src/Makefile b/drivers/net/ethernet/freescale/fman/src/Makefile
index af5d2e7..b047ea7 100644
--- a/drivers/net/ethernet/freescale/fman/src/Makefile
+++ b/drivers/net/ethernet/freescale/fman/src/Makefile
@@ -1,7 +1,7 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
diff --git a/drivers/net/ethernet/freescale/fman/src/system/Makefile b/drivers/net/ethernet/freescale/fman/src/system/Makefile
index f1aa763..142490b 100644
--- a/drivers/net/ethernet/freescale/fman/src/system/Makefile
+++ b/drivers/net/ethernet/freescale/fman/src/system/Makefile
@@ -1,7 +1,7 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
diff --git a/drivers/net/ethernet/freescale/fman/src/wrapper/Makefile b/drivers/net/ethernet/freescale/fman/src/wrapper/Makefile
index a04e241..f89e8b4 100644
--- a/drivers/net/ethernet/freescale/fman/src/wrapper/Makefile
+++ b/drivers/net/ethernet/freescale/fman/src/wrapper/Makefile
@@ -1,15 +1,15 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
 NCSW_FM_INC = $(srctree)/drivers/net/ethernet/freescale/fman/Peripherals/FM/inc
 
-EXTRA_CFLAGS += -I$(NCSW_FM_INC)
-EXTRA_CFLAGS += -I$(NET_DPA)
+ccflags-y += -I$(NCSW_FM_INC)
+ccflags-y += -I$(NET_DPA)
 
 obj-y		+= fsl-ncsw-PFM.o
 obj-$(CONFIG_FSL_FMAN_TEST)	+= fman_test.o
diff --git a/drivers/net/ethernet/freescale/fman/src/xx/Makefile b/drivers/net/ethernet/freescale/fman/src/xx/Makefile
index 3e857d8..7199b57 100644
--- a/drivers/net/ethernet/freescale/fman/src/xx/Makefile
+++ b/drivers/net/ethernet/freescale/fman/src/xx/Makefile
@@ -1,7 +1,7 @@
 #
 # Makefile for the Freescale Ethernet controllers
 #
-EXTRA_CFLAGS           += -DVERSION=\"\"
+ccflags-y           += -DVERSION=\"\"
 #
 #Include netcomm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
diff --git a/drivers/staging/fsl_dpa_offload/Makefile b/drivers/staging/fsl_dpa_offload/Makefile
index e4d4f3f..d34f8de 100644
--- a/drivers/staging/fsl_dpa_offload/Makefile
+++ b/drivers/staging/fsl_dpa_offload/Makefile
@@ -36,7 +36,7 @@
 #Include NetComm SW specific definitions
 include $(srctree)/drivers/net/ethernet/freescale/fman/ncsw_config.mk
 
-EXTRA_CFLAGS += \
+ccflags-y += \
 	-Idrivers/crypto/caam \
 	-Idrivers/net/ethernet/freescale/fman/src/wrapper \
 	-Idrivers/net/ethernet/freescale/fman/Peripherals/FM/Pcd \
diff --git a/drivers/tdm/Makefile b/drivers/tdm/Makefile
index 2a2e0a5..320aff9 100644
--- a/drivers/tdm/Makefile
+++ b/drivers/tdm/Makefile
@@ -4,5 +4,5 @@
 
 obj-$(CONFIG_TDM)		+= tdm-core.o device/ line_ctrl/ test/
 ifeq ($(CONFIG_TDM_DEBUG_CORE),y)
-EXTRA_CFLAGS += -DDEBUG
+ccflags-y += -DDEBUG
 endif
diff --git a/drivers/tdm/device/Makefile b/drivers/tdm/device/Makefile
index d41d10c..ff5acd6 100644
--- a/drivers/tdm/device/Makefile
+++ b/drivers/tdm/device/Makefile
@@ -5,5 +5,5 @@
 obj-$(CONFIG_TDM_FSL)	+= tdm_fsl.o
 obj-$(CONFIG_FSL_UCC_TDM)	+= fsl_ucc_tdm.o
 #ifeq ($(CONFIG_TDM_DEBUG_BUS),y)
-#EXTRA_CFLAGS += -DDEBUG
+#ccflags-y += -DDEBUG
 #endif
-- 
1.9.1

