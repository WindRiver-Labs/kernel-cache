From 287634def2c231a39ea102779b27875d4e7d0b11 Mon Sep 17 00:00:00 2001
From: Aurelian Zanoschi <Aurelian.Zanoschi@freescale.com>
Date: Fri, 26 Apr 2013 17:56:07 +0300
Subject: [PATCH 145/987] dpa_stats: Updated Traffic Manager counter support

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

Updated the API for the Traffic Manager counter according to the
implementation from QMan.

Signed-off-by: Aurelian Zanoschi <Aurelian.Zanoschi@freescale.com>
Change-Id: I3e0985d4dc402ba59754cec762fdd3a9210e938a
Reviewed-on: http://git.am.freescale.net:8181/2242
Reviewed-by: Floarea Anca Jeanina-B12569 <anca.floarea@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
---
 include/linux/fsl_dpa_stats.h | 20 ++++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)

diff --git a/include/linux/fsl_dpa_stats.h b/include/linux/fsl_dpa_stats.h
index 6046787..ba11791 100644
--- a/include/linux/fsl_dpa_stats.h
+++ b/include/linux/fsl_dpa_stats.h
@@ -463,11 +463,13 @@ struct dpa_stats_cnt_traffic_mng {
 	enum dpa_stats_cnt_traffic_mng_src src;
 
 	/*
-	 * Depending on the Traffic Manager source, the 'src_id' has a
-	 * different meaning: it represents the 'class id' or the
-	 * 'congestion group id'
+	 * Depending on the Traffic Manager source, the 'traffic_obj' has a
+	 * different meaning: it represents a pointer to a structure of type
+	 * 'qm_ceetm_cq' in case the traffic source is a "Class Queue" or a
+	 * pointer to a structure of type 'qm_ceetm_ccg' in case the traffic
+	 * source is a "Class Congestion Group"
 	 */
-	uint8_t src_id;
+	void *traffic_mng;
 
 	/*
 	 * Traffic Manager Class: Number of bytes/frames dequeued from a Class
@@ -666,11 +668,13 @@ struct dpa_stats_cls_cnt_traffic_mng {
 	enum dpa_stats_cnt_traffic_mng_src src;
 
 	/*
-	 * Depending on the Traffic Manager source, the 'src_id' has a
-	 * different meaning: it represents the array of 'class ids' or the
-	 * array of 'congestion group ids'
+	 * Depending on the Traffic Manager source, the 'traffic_obj' has a
+	 * different meaning: it represents an array of pointers to structures
+	 * of type 'qm_ceetm_cq' in case the traffic source is a "Class Queue"
+	 * or an array of pointers to structures of type 'qm_ceetm_ccg' in case
+	 * the traffic source is a "Class Congestion Group"
 	 */
-	uint8_t *src_id;
+	void **traffic_mng;
 
 	/*
 	 * Traffic Manager Class: Number of bytes/frames dequeued from a Class
-- 
1.9.1

