From fb5acaf6a387b160c648e8255976123ab721f606 Mon Sep 17 00:00:00 2001
From: Radu Bulie <radu.bulie@freescale.com>
Date: Mon, 21 Jul 2014 07:41:08 +0000
Subject: [PATCH 802/987] dpa_classifier: Get the header manip descriptor for a
 multicast entry

The hm descriptor for an entry of type multicast was not fetched correctly.
This patch fixes the above issue.

Change-Id: I4ec4bad9ae3d65fe997b5b9047ef705c2eb052b5
Signed-off-by: Radu Bulie <radu.bulie@freescale.com>
Reviewed-by: Marian Chereji <marian.chereji@freescale.com>
Reviewed-on: http://git.am.freescale.net:8181/14840
[Lu:Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/staging/fsl_dpa_offload/dpa_classifier.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/dpa_classifier.c b/drivers/staging/fsl_dpa_offload/dpa_classifier.c
index 63f3010..f94e2bd 100644
--- a/drivers/staging/fsl_dpa_offload/dpa_classifier.c
+++ b/drivers/staging/fsl_dpa_offload/dpa_classifier.c
@@ -3185,7 +3185,7 @@ static int action_to_next_engine_params(const struct dpa_cls_tbl_action *action,
 				return -EINVAL;
 			}
 			next_engine_params->h_Manip = (t_Handle)
-			dpa_classif_hm_lock_chain(action->enq_params.hmd);
+			dpa_classif_hm_lock_chain(action->mcast_params.hmd);
 			if (!next_engine_params->h_Manip) {
 				log_err("Failed to attach HM op hmd=%d to "
 					"classification entry.\n",
@@ -3193,7 +3193,7 @@ static int action_to_next_engine_params(const struct dpa_cls_tbl_action *action,
 				return -EINVAL;
 			}
 
-			*hmd = action->enq_params.hmd;
+			*hmd = action->mcast_params.hmd;
 		} else
 			next_engine_params->h_Manip = NULL;
 		next_engine_params->nextEngine = e_FM_PCD_FR;
-- 
1.9.1

