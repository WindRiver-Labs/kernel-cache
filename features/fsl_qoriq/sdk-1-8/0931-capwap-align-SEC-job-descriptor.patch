From 0dbb212368924a4240a883c27dc7f2b36ce97ab1 Mon Sep 17 00:00:00 2001
From: Pan Jiafei <Jiafei.Pan@freescale.com>
Date: Fri, 27 Mar 2015 10:32:18 +0800
Subject: [PATCH 931/987] capwap: align SEC job descriptor

Require 64 bytes align.
Remove compilation warnings.

Signed-off-by: Pan Jiafei <Jiafei.Pan@freescale.com>
Change-Id: Ic97c690adfca42c8c9ac83de9d89b05ea32b3926
Reviewed-on: http://git.am.freescale.net:8181/33327
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Honghua Yin <Hong-Hua.Yin@freescale.com>
[Yang: Original patch taken from
QorIQ-SDK-V1.8-SOURCE-20150619-yocto.iso]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_desc.h   | 4 ++--
 drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_domain.c | 4 ++--
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_desc.h b/drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_desc.h
index dd76acd..d40cbe8 100644
--- a/drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_desc.h
+++ b/drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_desc.h
@@ -153,7 +153,7 @@ struct dtls_encap_descriptor_t {
 	uint32_t auth_key[13];		/* Max Space for storing auth Key */
 	uint32_t enc_key[7];		/* Max Space for storing enc Key */
 	uint32_t operation_cmd;		/* For operation Command */
-} __packed;
+} __packed __aligned(64);
 
 struct dtls_decap_descriptor_t {
 	struct preheader_t prehdr;
@@ -165,7 +165,7 @@ struct dtls_decap_descriptor_t {
 	uint32_t auth_key[13];		/* Max Space for storing auth Key */
 	uint32_t dec_key[7];		/* Max Space for storing dec Key */
 	uint32_t operation_cmd;		/* For operation Command */
-} __packed;
+} __packed __aligned(64);
 
 #define SEC_DEF_VER 40 /* like in P4080 */
 #define SEC_VER_5_3 53
diff --git a/drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_domain.c b/drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_domain.c
index dbf7a21..b34d959 100644
--- a/drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_domain.c
+++ b/drivers/net/ethernet/freescale/dpa/capwap/dpaa_capwap_domain.c
@@ -523,7 +523,7 @@ int add_in_tunnel(struct dpaa_capwap_domain *capwap_domain,
 	struct auth_params *auth;
 	struct cipher_params *cipher;
 	struct dtls_block_decap_pdb *pdb;
-	struct dtls_decap_descriptor_t *preheader_initdesc;
+	struct dtls_decap_descriptor_t *preheader_initdesc = NULL;
 	struct qman_fq *fq = NULL;
 	uint16_t desc_len;
 	unsigned char *buff_start = NULL;
@@ -827,7 +827,7 @@ int add_out_tunnel(struct dpaa_capwap_domain *capwap_domain,
 	struct dtls_block_encap_pdb *pdb;
 	struct auth_params *auth;
 	struct cipher_params *cipher;
-	struct dtls_encap_descriptor_t *preheader_initdesc;
+	struct dtls_encap_descriptor_t *preheader_initdesc = NULL;
 	struct qman_fq *fq = NULL;
 	uint16_t desc_len;
 	unsigned char *buff_start = NULL;
-- 
1.9.1

