From 9d566f91be26ed188f4f56454e264e6f22b5beca Mon Sep 17 00:00:00 2001
From: Madalin Bucur <madalin.bucur@freescale.com>
Date: Thu, 1 Aug 2013 17:22:04 +0300
Subject: [PATCH 313/987] dpa_eth: fix function type

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

The wrong return type of dpa_bp_priv_seed() caused a crash
on the termination optimized driver flavor.

Signed-off-by: Madalin Bucur <madalin.bucur@freescale.com>

Change-Id: I22cec61c063a901a4d8fd40653fb4fe2cba31435
Reviewed-on: http://git.am.freescale.net:8181/3696
Reviewed-by: Sovaiala Cristian-Constantin-B39531 <Cristian.Sovaiala@freescale.com>
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Radulescu Ruxandra Ioana-B05472 <ruxandra.radulescu@freescale.com>
Reviewed-by: Hamciuc Bogdan-BHAMCIU1 <bogdan.hamciuc@freescale.com>
Reviewed-by: Rivera Jose-B46482 <Jose.G.Rivera@freescale.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.h        | 2 +-
 drivers/net/ethernet/freescale/dpa/dpaa_eth_non_sg.c | 3 ++-
 drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c     | 3 ++-
 3 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.h b/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
index 4f743c3..a677af2 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
@@ -475,7 +475,7 @@ struct fm_port_fqs {
 };
 
 /* functions with different implementation for SG and non-SG: */
-void dpa_bp_priv_seed(struct dpa_bp *dpa_bp);
+int dpa_bp_priv_seed(struct dpa_bp *dpa_bp);
 int dpaa_eth_refill_bpools(struct dpa_percpu_priv_s *percpu_priv);
 void __hot _dpa_rx(struct net_device *net_dev,
 		const struct dpa_priv_s *priv,
diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_non_sg.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_non_sg.c
index 428553a..3bcb5b3 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_non_sg.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_non_sg.c
@@ -132,7 +132,7 @@ uint32_t dpa_bp_default_buf_size_get(void)
 	return default_buf_size;
 }
 
-void dpa_bp_priv_seed(struct dpa_bp *dpa_bp)
+int dpa_bp_priv_seed(struct dpa_bp *dpa_bp)
 {
 	int i;
 	dpa_bp->size = default_buf_size;
@@ -144,6 +144,7 @@ void dpa_bp_priv_seed(struct dpa_bp *dpa_bp)
 		for (j = 0; j < dpa_bp->target_count; j += 8)
 			dpa_bp_add_8(dpa_bp, i);
 	}
+	return 0;
 }
 
 void dpa_bp_priv_non_sg_seed(struct dpa_bp *dpa_bp)
diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
index 0b5d269..aa6083e 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
@@ -132,7 +132,7 @@ void dpa_bp_add_8_bufs(const struct dpa_bp *dpa_bp, int cpu)
 	*count_ptr += _dpa_bp_add_8_bufs(dpa_bp);
 }
 
-void dpa_bp_priv_seed(struct dpa_bp *dpa_bp)
+int dpa_bp_priv_seed(struct dpa_bp *dpa_bp)
 {
 	int i;
 
@@ -147,6 +147,7 @@ void dpa_bp_priv_seed(struct dpa_bp *dpa_bp)
 		for (j = 0; j < dpa_bp->config_count; j += 8)
 			dpa_bp_add_8_bufs(dpa_bp, i);
 	}
+	return 0;
 }
 
 /*
-- 
1.9.1

