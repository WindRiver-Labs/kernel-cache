From 75b810c9b6ebdd7118e274cdfb73f3c2d7f9619b Mon Sep 17 00:00:00 2001
From: Quanyang Wang <quanyang.wang@windriver.com>
Date: Fri, 13 Nov 2015 14:47:32 +0800
Subject: [PATCH 1335/1336] crypto: caam - pass correct argument to
 append_key_aead()

Because of upstream daebc4658588
("crypto: caam - add support for rfc3686 with authenc md5, sha1 and sha2"),
need to pass an argument to point out that if use AES Counter Mode (CTR)
compliant with RFC3686. But in TLS1.0, use CBC but not CTR, so pass 0 to
append_key_aead.

Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 drivers/crypto/caam/caamalg.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/crypto/caam/caamalg.c b/drivers/crypto/caam/caamalg.c
index 4cbb975..45b14df 100644
--- a/drivers/crypto/caam/caamalg.c
+++ b/drivers/crypto/caam/caamalg.c
@@ -1713,7 +1713,7 @@ static int tls_set_sh_desc(struct crypto_aead *aead)
 	/* skip key loading if they are loaded due to sharing */
 	key_jump_cmd = append_jump(desc, JUMP_JSL | JUMP_TEST_ALL |
 				   JUMP_COND_SHRD);
-	append_key_aead(desc, ctx, keys_fit_inline);
+	append_key_aead(desc, ctx, keys_fit_inline, 0);
 	set_jump_tgt_here(desc, key_jump_cmd);
 
 	/* class 2 operation */
-- 
2.0.2

