From 1f2d62d48f3072a9d5020e3dfde0cfb26107849b Mon Sep 17 00:00:00 2001
From: Camelia Groza <camelia.groza@freescale.com>
Date: Fri, 3 Apr 2015 16:44:05 +0300
Subject: [PATCH 941/987] fmd: Fix incorrect disabling of macsec cfg ptp
 register

Signed-off-by: Camelia Groza <camelia.groza@freescale.com>
Change-Id: I7ae237524eea4a1a7587850152ca88eb74a9807d
Reviewed-on: http://git.am.freescale.net:8181/34261
Reviewed-by: Madalin-Cristian Bucur <madalin.bucur@freescale.com>
Tested-by: Cristian-Constantin Sovaiala <Cristian.Sovaiala@freescale.com>
[Yang: Original patch taken from
QorIQ-SDK-V1.8-SOURCE-20150619-yocto.iso]
Signed-off-by: Quanyang Wang <quanyang.wang@windriver.com>
---
 .../ethernet/freescale/fman/Peripherals/FM/MACSEC/fm_macsec_master.c    | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/freescale/fman/Peripherals/FM/MACSEC/fm_macsec_master.c b/drivers/net/ethernet/freescale/fman/Peripherals/FM/MACSEC/fm_macsec_master.c
index 237c4e5..7b82fd0 100644
--- a/drivers/net/ethernet/freescale/fman/Peripherals/FM/MACSEC/fm_macsec_master.c
+++ b/drivers/net/ethernet/freescale/fman/Peripherals/FM/MACSEC/fm_macsec_master.c
@@ -574,7 +574,7 @@ t_Error FmMacsecSetPTP(t_Handle h_FmMacsec, bool enable)
     if (enable)
         tmpReg |= CFG_S0I;
     else
-        tmpReg &= CFG_S0I;
+        tmpReg &= ~CFG_S0I;
     WRITE_UINT32(p_FmMacsec->p_FmMacsecRegs->cfg, tmpReg);
 
     return E_OK;
-- 
1.9.1

