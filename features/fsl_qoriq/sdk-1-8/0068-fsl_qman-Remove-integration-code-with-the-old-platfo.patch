From de44799997fcc2e2fcaac56c789a467dd5938afa Mon Sep 17 00:00:00 2001
From: Andy Fleming <afleming@freescale.com>
Date: Wed, 3 Apr 2013 02:26:37 -0500
Subject: [PATCH 068/987] fsl_qman: Remove integration code with the old
 platform PAMU driver

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

This is to make the ingration patch with the new IOMMU/PAMU driver more
readable

Signed-off-by: Emil Medve <Emilian.Medve@Freescale.com>
Change-Id: Ia8c2acef2f09d0dcbce47cc14f6f9dfbf1f55370
Reviewed-on: http://git.am.freescale.net:8181/1172
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
---
 drivers/staging/fsl_qbman/qman_driver.c | 19 -------------------
 1 file changed, 19 deletions(-)

diff --git a/drivers/staging/fsl_qbman/qman_driver.c b/drivers/staging/fsl_qbman/qman_driver.c
index d183af6..877bee2 100644
--- a/drivers/staging/fsl_qbman/qman_driver.c
+++ b/drivers/staging/fsl_qbman/qman_driver.c
@@ -30,9 +30,6 @@
  */
 
 #include "qman_private.h"
-#ifdef CONFIG_FSL_PAMU
-#include <sysdev/fsl_pamu.h>
-#endif
 
 /* Global variable containing revision id (even on non-control plane systems
  * where CCSR isn't available) */
@@ -432,24 +429,8 @@ static struct qm_portal_config *get_pcfg(struct list_head *list)
 	return pcfg;
 }
 
-#ifdef CONFIG_FSL_PAMU
-static void portal_set_liodns(const struct qm_portal_config *pcfg, int cpu)
-{
-	unsigned int index = 0;
-	unsigned int liodn_cnt = pamu_get_liodn_count(pcfg->node);
-	while (index < liodn_cnt) {
-		int ret = pamu_set_stash_dest(pcfg->node, index++, cpu, 1);
-		if (ret < 0)
-			pr_warning("Failed to set QMan stashing LIODN\n");
-	}
-}
-#else
-#define portal_set_liodns(pcfg, cpu) do { } while (0)
-#endif
-
 static void portal_set_cpu(const struct qm_portal_config *pcfg, int cpu)
 {
-	portal_set_liodns(pcfg, cpu);
 #ifdef CONFIG_FSL_QMAN_CONFIG
 	if (qman_set_sdest(pcfg->public_cfg.channel, cpu))
 #endif
-- 
1.9.1

