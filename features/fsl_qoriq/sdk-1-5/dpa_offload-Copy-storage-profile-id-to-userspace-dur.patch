From c7c2f449c9d1c003e6bb618326ca0c0735b008fc Mon Sep 17 00:00:00 2001
From: Radu Bulie <radu.bulie@freescale.com>
Date: Fri, 12 Jul 2013 12:16:10 +0000
Subject: [PATCH 079/429] dpa_offload: Copy storage profile id to userspace
 during look-up by key or by ref operations

Not all parameters were copied to userspace in classifier wrapper during look-up by
key or by ref operations.
The patch fixes the above issue.

Change-Id: I4c33455a327c8dfd6fd0fa28d13cc7e28b856714
Signed-off-by: Radu Bulie <radu.bulie@freescale.com>
Reviewed-on: http://git.am.freescale.net:8181/3281
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Chereji Marian-Cornel-R27762 <marian.chereji@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[origin patch is from QorIQ-SDK-V1.5-20131219-yocto]
Signed-off-by: Yang Wei <Wei.Yang@windriver.com>
---
 .../staging/fsl_dpa_offload/wrp_dpa_classifier.c   |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/wrp_dpa_classifier.c b/drivers/staging/fsl_dpa_offload/wrp_dpa_classifier.c
index 6d59682..26cab69 100644
--- a/drivers/staging/fsl_dpa_offload/wrp_dpa_classifier.c
+++ b/drivers/staging/fsl_dpa_offload/wrp_dpa_classifier.c
@@ -2411,7 +2411,8 @@ int dpa_cls_tbl_action_params_rcompatcpy(
 		uparam->enq_params.new_fqid =
 				kparam->enq_params.new_fqid;
 		uparam->enq_params.hmd = kparam->enq_params.hmd;
-
+		uparam->enq_params.new_rel_vsp_id =
+				kparam->enq_params.new_rel_vsp_id;
 		if (kparam->enq_params.policer_params) {
 			BUG_ON(!compat_ptr(uparam->enq_params.policer_params));
 			if (copy_to_user(
-- 
1.7.5.4

