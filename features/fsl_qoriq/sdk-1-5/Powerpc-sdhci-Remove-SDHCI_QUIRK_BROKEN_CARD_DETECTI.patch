From 06428618e949e67dfc057c3aa40049102ce3e166 Mon Sep 17 00:00:00 2001
From: "Haijun.Zhang" <Haijun.Zhang@freescale.com>
Date: Sun, 9 Jun 2013 13:00:17 +0800
Subject: [PATCH 062/429] Powerpc/sdhci: Remove
 SDHCI_QUIRK_BROKEN_CARD_DETECTION for P5020 board

We use interrupt detect mode to check card present for p5020 board instead
of polling mode. This can improve read write performance and avoid call
trace root from polling card status every several clock cycle.

Signed-off-by: Haijun Zhang <Haijun.Zhang@freescale.com>
Change-Id: Ifa364e4125878fa9e7a0a6f8aebe7bfd50df1fc0
Reviewed-on: http://git.am.freescale.net:8181/2907
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[origin patch is from QorIQ-SDK-V1.5-20131219-yocto]
Signed-off-by: Yang Wei <Wei.Yang@windriver.com>
---
 drivers/mmc/host/sdhci-pltfm.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/drivers/mmc/host/sdhci-pltfm.c b/drivers/mmc/host/sdhci-pltfm.c
index c2f8089..f335178 100644
--- a/drivers/mmc/host/sdhci-pltfm.c
+++ b/drivers/mmc/host/sdhci-pltfm.c
@@ -97,6 +97,7 @@ void sdhci_get_of_property(struct platform_device *pdev)
 			host->quirks2 |= SDHCI_QUIRK2_LONG_TIME_CMD_COMPLETE_IRQ;
 
 		if (of_device_is_compatible(np, "fsl,p5040-esdhc") ||
+			of_device_is_compatible(np, "fsl,p5020-esdhc") ||
 			of_device_is_compatible(np, "fsl,p4080-esdhc") ||
 			of_device_is_compatible(np, "fsl,p1020-esdhc"))
 			host->quirks &= ~SDHCI_QUIRK_BROKEN_CARD_DETECTION;
-- 
1.7.5.4

