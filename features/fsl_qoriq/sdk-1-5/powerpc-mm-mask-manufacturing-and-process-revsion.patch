From b2e7b3597ffee6a745dd6555c073d54b4afe4cfe Mon Sep 17 00:00:00 2001
From: Yang Wei <Wei.Yang@windriver.com>
Date: Wed, 15 Jan 2014 11:19:24 +0800
Subject: [PATCH 2/2] powerpc/mm: mask manufacturing and process revsion

Refactor erratum 5337, we only compare processor major
revsion number.

Signed-off-by: Yang Wei <Wei.Yang@windriver.com>
---
 arch/powerpc/mm/tlb_nohash.c |    2 +-
 1 files changed, 1 insertions(+), 1 deletions(-)

diff --git a/arch/powerpc/mm/tlb_nohash.c b/arch/powerpc/mm/tlb_nohash.c
index da343df..d4bca6c 100644
--- a/arch/powerpc/mm/tlb_nohash.c
+++ b/arch/powerpc/mm/tlb_nohash.c
@@ -479,7 +479,7 @@ static void setup_page_sizes(void)
 #ifdef CONFIG_FSL_ERRATUM_A_005337
 		 /*  For E6500, hw tablewalk is only unsupported for rev1 */
 		if ((PVR_VER(mfspr(SPRN_PVR)) != PVR_VER_E6500) || \
-			(PVR_REV(mfspr(SPRN_PVR)) == PVR_REV_E6500V1))
+			(PVR_MAJ(mfspr(SPRN_PVR)) == 1))
 			book3e_htw_mode = PPC_HTW_NONE;
 #endif
 
-- 
1.7.5.4

