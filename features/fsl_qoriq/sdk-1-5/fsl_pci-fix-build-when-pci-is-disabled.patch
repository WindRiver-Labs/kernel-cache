From 45e0ab238a157a25a036ef946fc4aaab31900a24 Mon Sep 17 00:00:00 2001
From: Yong Zhang <yong.zhang@windriver.com>
Date: Mon, 28 Apr 2014 14:25:55 +0800
Subject: [PATCH] fsl_pci: fix build when pci is disabled

When pci is disabled, kernel can't build:
arch/powerpc/platforms/85xx/corenet_ds.c: In function 'corenet_ds_setup_arch':
arch/powerpc/platforms/85xx/corenet_ds.c:59:2: error: implicit declaration of
function 'fsl_pci_assign_primary' [-Werror=implicit-function-declaration]

The reason is that there is no definition of fsl_pci_assign_primary()
when CONFIG_FSL_PCI=n. But looking at the code, both CONFIG_FSL_PCI
and CONFIG_PCI take the same effect with regarding to define
fsl_pci_assign_primary(). So remove CONFIG_FSL_PCI to make the build
successfully.

Signed-off-by: Yong Zhang <yong.zhang@windriver.com>
---
 arch/powerpc/sysdev/fsl_pci.h |    2 --
 1 files changed, 0 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/sysdev/fsl_pci.h b/arch/powerpc/sysdev/fsl_pci.h
index df061c0..0f7bb9b 100644
--- a/arch/powerpc/sysdev/fsl_pci.h
+++ b/arch/powerpc/sysdev/fsl_pci.h
@@ -148,13 +148,11 @@ u64 fsl_pci_immrbar_base(struct pci_controller *hose);
 
 extern struct device_node *fsl_pci_primary;
 
-#ifdef CONFIG_FSL_PCI
 #ifdef CONFIG_PCI
 void fsl_pci_assign_primary(void);
 #else
 static inline void fsl_pci_assign_primary(void) {}
 #endif
-#endif
 
 #ifdef CONFIG_EDAC_MPC85XX
 int mpc85xx_pci_err_probe(struct platform_device *op);
-- 
1.7.5.4

