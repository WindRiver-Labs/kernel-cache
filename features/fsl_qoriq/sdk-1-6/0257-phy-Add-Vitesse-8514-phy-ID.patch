From fe9bc7e3a32a0aedfe742d092937504d01fd0010 Mon Sep 17 00:00:00 2001
From: Shaohui Xie <Shaohui.Xie@freescale.com>
Date: Mon, 25 Nov 2013 12:40:49 +0800
Subject: [PATCH 257/466] phy: Add Vitesse 8514 phy ID

commit 167f76a87743dfaf1fec954db5233715ddad49ef upstream

Phy is compatible with Vitesse 82xx

Signed-off-by: Shaohui Xie <Shaohui.Xie@freescale.com>
Signed-off-by: David S. Miller <davem@davemloft.net>
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 drivers/net/phy/vitesse.c |   17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/drivers/net/phy/vitesse.c b/drivers/net/phy/vitesse.c
index d8f5c67..cf45b95 100644
--- a/drivers/net/phy/vitesse.c
+++ b/drivers/net/phy/vitesse.c
@@ -64,6 +64,7 @@
 #define PHY_ID_VSC8211			0x000fc4b0
 #define PHY_ID_VSC8662			0x00070660
 #define PHY_ID_VSC8574			0x000704a0
+#define PHY_ID_VSC8514			0x00070670
 
 MODULE_DESCRIPTION("Vitesse PHY driver");
 MODULE_AUTHOR("Kriston Carson");
@@ -127,6 +128,7 @@ static int vsc82xx_config_intr(struct phy_device *phydev)
 		err = phy_write(phydev, MII_VSC8244_IMASK,
 			((phydev->drv->phy_id == PHY_ID_VSC8234) ||
 			 (phydev->drv->phy_id == PHY_ID_VSC8574) ||
+			 (phydev->drv->phy_id == PHY_ID_VSC8514) ||
 			 (phydev->drv->phy_id == PHY_ID_VSC8244)) ?
 				MII_VSC8244_IMASK_MASK :
 				MII_VSC8221_IMASK_MASK);
@@ -271,6 +273,19 @@ static struct phy_driver vsc82xx_driver[] = {
 	.config_intr	= &vsc82xx_config_intr,
 	.driver 	= { .owner = THIS_MODULE,},
 }, {
+	/* Vitesse 8514 */
+	.phy_id		= PHY_ID_VSC8514,
+	.name		= "Vitesse VSC8514",
+	.phy_id_mask	= 0x000ffff0,
+	.features	= PHY_GBIT_FEATURES,
+	.flags		= PHY_HAS_INTERRUPT,
+	.config_init	= &vsc824x_config_init,
+	.config_aneg	= &vsc82x4_config_aneg,
+	.read_status	= &genphy_read_status,
+	.ack_interrupt	= &vsc824x_ack_interrupt,
+	.config_intr	= &vsc82xx_config_intr,
+	.driver		= { .owner = THIS_MODULE,},
+}, {
 	/* Vitesse 8574 */
 	.phy_id		= PHY_ID_VSC8574,
 	.name		= "Vitesse VSC8574",
@@ -318,6 +333,8 @@ static struct mdio_device_id __maybe_unused vitesse_tbl[] = {
 	{ PHY_ID_VSC8221, 0x000ffff0 },
 	{ PHY_ID_VSC8662, 0x000ffff0 },
 	{ PHY_ID_VSC8211, 0x000ffff0 },
+	{ PHY_ID_VSC8514, 0x000ffff0 },
+	{ PHY_ID_VSC8574, 0x000ffff0 },
 	{ }
 };
 
-- 
1.7.10.4

