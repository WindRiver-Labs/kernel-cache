From 767a3897240c0d43320b1a6a8e22746fe1906c77 Mon Sep 17 00:00:00 2001
From: Vakul Garg <vakul@freescale.com>
Date: Sun, 6 Apr 2014 08:07:46 -0400
Subject: [PATCH 248/466] fsl_qbman: set stash attr window before setting
 attribute

This additional parameter (window number) is required based
on the latest update of pamu driver.

Signed-off-by: Vakul Garg <vakul@freescale.com>
Change-Id: I14a4d61c6f6790aa87ce5924bb9893d9170e8a76
Reviewed-on: http://git.am.freescale.net:8181/10719
Reviewed-by: Haiying Wang <Haiying.Wang@freescale.com>
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Jose Rivera <German.Rivera@freescale.com>
[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 drivers/staging/fsl_qbman/fsl_usdpaa.c |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/staging/fsl_qbman/fsl_usdpaa.c b/drivers/staging/fsl_qbman/fsl_usdpaa.c
index be843e7..7b8db3d 100644
--- a/drivers/staging/fsl_qbman/fsl_usdpaa.c
+++ b/drivers/staging/fsl_qbman/fsl_usdpaa.c
@@ -1328,6 +1328,8 @@ static void portal_config_pamu(struct qm_portal_config *pcfg, uint8_t sdest,
 	}
 	stash_attr.cpu = cpu;
 	stash_attr.cache = cache;
+	/* set stash information for the window */
+	stash_attr.window = 0;
 
 	ret = iommu_domain_set_attr(pcfg->iommu_domain,
 				    DOMAIN_ATTR_PAMU_STASH,
-- 
1.7.10.4

