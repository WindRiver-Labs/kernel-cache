From 49870b5fff7d250183cd6e06c2b1f3c514c7b5b8 Mon Sep 17 00:00:00 2001
From: Varun Sethi <Varun.Sethi@freescale.com>
Date: Tue, 11 Mar 2014 00:53:32 +0530
Subject: [PATCH 169/466] fsl/qman: Modifications for new stash attribute
 setup API.

An additional parameter (window number) is required for API. Add
the window number parameter while invoking the API.

Signed-off-by: Varun Sethi <Varun.Sethi@freescale.com>
Change-Id: I7ff2552bf15bee25a7e41fd5e0a1781a323aceed
Reviewed-on: http://git.am.freescale.net:8181/9618
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Stuart Yoder <stuart.yoder@freescale.com>
Reviewed-by: Jose Rivera <German.Rivera@freescale.com>
[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 drivers/staging/fsl_qbman/qman_driver.c |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/staging/fsl_qbman/qman_driver.c b/drivers/staging/fsl_qbman/qman_driver.c
index 4808c39..fcc5f15 100644
--- a/drivers/staging/fsl_qbman/qman_driver.c
+++ b/drivers/staging/fsl_qbman/qman_driver.c
@@ -508,6 +508,8 @@ static void portal_set_cpu(struct qm_portal_config *pcfg, int cpu)
 	stash_attr.cpu = cpu;
 	stash_attr.cache = IOMMU_ATTR_CACHE_L1;
 	stash_attr.window = ~(u32)0;
+	/* set stash information for the window */
+	stash_attr.window = 0;
 	ret = iommu_domain_set_attr(pcfg->iommu_domain, DOMAIN_ATTR_PAMU_STASH,
 				    &stash_attr);
 	if (ret < 0) {
-- 
1.7.10.4

