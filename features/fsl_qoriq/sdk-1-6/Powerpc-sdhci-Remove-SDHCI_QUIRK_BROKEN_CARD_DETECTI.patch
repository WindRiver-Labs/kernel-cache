From 4a4402efb2fa21a678e37913ae1bf4d4f195093e Mon Sep 17 00:00:00 2001
From: "Haijun.Zhang" <Haijun.Zhang@freescale.com>
Date: Sun, 9 Jun 2013 13:00:17 +0800
Subject: [PATCH 0405/1089] Powerpc/sdhci: Remove
 SDHCI_QUIRK_BROKEN_CARD_DETECTION for P5020 board

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

We use interrupt detect mode to check card present for p5020 board instead
of polling mode. This can improve read write performance and avoid call
trace root from polling card status every several clock cycle.

Signed-off-by: Haijun Zhang <Haijun.Zhang@freescale.com>
Change-Id: Ifa364e4125878fa9e7a0a6f8aebe7bfd50df1fc0
Reviewed-on: http://git.am.freescale.net:8181/2907
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
---
 drivers/mmc/host/sdhci-pltfm.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/mmc/host/sdhci-pltfm.c b/drivers/mmc/host/sdhci-pltfm.c
index 60791c8..7ce1a2f 100644
--- a/drivers/mmc/host/sdhci-pltfm.c
+++ b/drivers/mmc/host/sdhci-pltfm.c
@@ -109,6 +109,7 @@ void sdhci_get_of_property(struct platform_device *pdev)
 			host->quirks2 |= SDHCI_QUIRK2_LONG_TIME_CMD_COMPLETE_IRQ;
 
 		if (of_device_is_compatible(np, "fsl,p5040-esdhc") ||
+			of_device_is_compatible(np, "fsl,p5020-esdhc") ||
 			of_device_is_compatible(np, "fsl,p4080-esdhc") ||
 			of_device_is_compatible(np, "fsl,p1020-esdhc"))
 			host->quirks &= ~SDHCI_QUIRK_BROKEN_CARD_DETECTION;
-- 
2.0.2

