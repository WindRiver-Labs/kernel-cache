From 648c951415cd6b8284e93aa7ac4f4a87ab4c2641 Mon Sep 17 00:00:00 2001
From: Aurelian Zanoschi <Aurelian.Zanoschi@freescale.com>
Date: Wed, 15 May 2013 18:26:45 +0300
Subject: [PATCH 0287/1089] dpa_stats: Updated the compat structure for traffic
 manager counter

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

Added dpa_stats_compat_cnt_traffic_mng and removed the
dpa_stats_compat_cls_cnt_traffic_mng for the Traffic Manager counter in
compat mode in order to be compliant with the updated Traffic Manager
API.

Change-Id: Ife6feaaf72c26439518c4ef3b4758f9653dfca19
Signed-off-by: Aurelian Zanoschi <Aurelian.Zanoschi@freescale.com>
Reviewed-on: http://git.am.freescale.net:8181/2522
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Floarea Anca Jeanina-B12569 <anca.floarea@freescale.com>
Reviewed-by: Chereji Marian-Cornel-R27762 <marian.chereji@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
---
 drivers/staging/fsl_dpa_offload/dpa_stats_ioctl.h | 16 ++++++++--------
 1 file changed, 8 insertions(+), 8 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/dpa_stats_ioctl.h b/drivers/staging/fsl_dpa_offload/dpa_stats_ioctl.h
index e8109d7..070a6f0 100644
--- a/drivers/staging/fsl_dpa_offload/dpa_stats_ioctl.h
+++ b/drivers/staging/fsl_dpa_offload/dpa_stats_ioctl.h
@@ -127,6 +127,12 @@ struct dpa_stats_compat_cnt_classif_node {
 	unsigned int cnt_sel;
 };
 
+struct dpa_stats_compat_cnt_traffic_mng {
+	enum dpa_stats_cnt_traffic_mng_src src;
+	compat_uptr_t traffic_mng;
+	enum dpa_stats_cnt_sel cnt_sel;
+};
+
 struct dpa_stats_compat_cnt_params {
 	enum dpa_stats_cnt_type type;
 	union {
@@ -137,7 +143,7 @@ struct dpa_stats_compat_cnt_params {
 		struct dpa_stats_compat_cnt_classif_tbl classif_tbl_params;
 		struct dpa_stats_compat_cnt_classif_node classif_node_params;
 		struct dpa_stats_cnt_ipsec ipsec_params;
-		struct dpa_stats_cnt_traffic_mng traffic_mng_params;
+		struct dpa_stats_compat_cnt_traffic_mng traffic_mng_params;
 	};
 };
 
@@ -174,12 +180,6 @@ struct dpa_stats_compat_cls_cnt_ipsec {
 	enum dpa_stats_cnt_sel cnt_sel;
 };
 
-struct dpa_stats_compat_cls_cnt_traffic_mng {
-	enum dpa_stats_cnt_traffic_mng_src src;
-	compat_uptr_t src_id;
-	enum dpa_stats_cnt_sel cnt_sel;
-};
-
 struct dpa_stats_compat_cls_cnt_params {
 	unsigned int class_members;
 	enum dpa_stats_cnt_type type;
@@ -191,7 +191,7 @@ struct dpa_stats_compat_cls_cnt_params {
 		struct dpa_stats_compat_cls_cnt_classif_tbl classif_tbl_params;
 		struct dpa_stats_compat_cls_cnt_classif_node ccnode_params;
 		struct dpa_stats_compat_cls_cnt_ipsec ipsec_params;
-		struct dpa_stats_compat_cls_cnt_traffic_mng traffic_mng_params;
+		struct dpa_stats_compat_cnt_traffic_mng traffic_mng_params;
 	};
 };
 
-- 
2.0.2

