From 8d231d7fd150f6d442603a9f426b122b0ceb861a Mon Sep 17 00:00:00 2001
From: Marian Rotariu <marian.rotariu@freescale.com>
Date: Fri, 8 Nov 2013 10:54:59 +0200
Subject: [PATCH 0573/1089] dpaa_eth: remove pr_alert from proxy interface

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

With this patch the user will be able to configure the debug message display
through netdev. Also, an unused variable declaration was removed.

Change-Id: I203cc77fffd14ecbad8a5d115232d9eab1188168
Signed-off-by: Marian Rotariu <marian.rotariu@freescale.com>
Reviewed-on: http://git.am.freescale.net:8181/6315
Reviewed-by: Ruxandra Ioana Radulescu <ruxandra.radulescu@freescale.com>
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Thomas Trefny <Tom.Trefny@freescale.com>
Reviewed-by: Jose Rivera <German.Rivera@freescale.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth_proxy.c | 21 ++++++++++++---------
 1 file changed, 12 insertions(+), 9 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_proxy.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_proxy.c
index 95ad3ea..1c1a121 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_proxy.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_proxy.c
@@ -181,7 +181,6 @@ int dpa_proxy_set_rx_mode(struct proxy_device *proxy_dev,
 		       struct net_device *net_dev)
 {
 	struct mac_device *mac_dev = proxy_dev->mac_dev;
-	const struct dpa_priv_s	*priv = netdev_priv(net_dev);
 	int _errno;
 
 	_errno = mac_dev->set_multi(net_dev, mac_dev);
@@ -205,7 +204,9 @@ int dpa_proxy_start(struct net_device *net_dev)
 
 	_errno = mac_dev->init_phy(net_dev, mac_dev);
 	if (_errno < 0) {
-		pr_alert("init_phy() = %d\n", _errno);
+		if (netif_msg_drv(priv))
+			netdev_err(net_dev, "init_phy() = %d\n",
+					_errno);
 		return _errno;
 	}
 
@@ -214,7 +215,9 @@ int dpa_proxy_start(struct net_device *net_dev)
 
 	_errno = mac_dev->start(mac_dev);
 	if (_errno < 0) {
-		pr_alert("mac_dev->start() = %d\n", _errno);
+		if (netif_msg_drv(priv))
+			netdev_err(net_dev, "mac_dev->start() = %d\n",
+					_errno);
 		return _errno;
 	}
 
@@ -223,15 +226,15 @@ int dpa_proxy_start(struct net_device *net_dev)
 
 int dpa_proxy_stop(struct proxy_device *proxy_dev, struct net_device *net_dev)
 {
-	struct mac_device	*mac_dev;
-	int			 _errno;
-	int			i;
-
-	mac_dev = proxy_dev->mac_dev;
+	struct mac_device *mac_dev = proxy_dev->mac_dev;
+	const struct dpa_priv_s	*priv = netdev_priv(net_dev);
+	int _errno, i;
 
 	_errno = mac_dev->stop(mac_dev);
 	if (_errno < 0) {
-		pr_alert("mac_dev->stop() = %d\n", _errno);
+		if (netif_msg_drv(priv))
+			netdev_err(net_dev, "mac_dev->stop() = %d\n",
+					_errno);
 		return _errno;
 	}
 
-- 
2.0.2

