From 508edf047783d0b584e35cba4d78a4599778bb41 Mon Sep 17 00:00:00 2001
From: "Lu.Jiang" <lu.jiang@windriver.com>
Date: Thu, 4 Sep 2014 17:16:19 +0800
Subject: [PATCH 0140/1089] qoriq: Enable muxing MDIO buses

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

The MDIO muxing drivers needed to be enabled on the platforms
which use them, and the devices needed to be probed.

Change-Id: I6aa210cabb663f63c44c2ddfa5ccc9941e4799ab
Signed-off-by: Andy Fleming <afleming@freescale.com>
Reviewed-on: http://git.am.freescale.net:8181/1265
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Signed-off-by: Lu.Jiang <lu.jiang@windriver.com>
---
 arch/powerpc/platforms/85xx/Kconfig           | 7 +++++--
 arch/powerpc/platforms/85xx/corenet_generic.c | 9 +++++++++
 2 files changed, 14 insertions(+), 2 deletions(-)

diff --git a/arch/powerpc/platforms/85xx/Kconfig b/arch/powerpc/platforms/85xx/Kconfig
index 4c327cf..22d65fb 100644
--- a/arch/powerpc/platforms/85xx/Kconfig
+++ b/arch/powerpc/platforms/85xx/Kconfig
@@ -267,14 +267,17 @@ config CORENET_GENERIC
 	select HAS_RAPIDIO
 	select PPC_EPAPR_HV_PIC
 	select HAS_FSL_QBMAN
+	select MDIO_BUS_MUX if FSL_DPAA_ETH
+	select MDIO_BUS_MUX_MMIOREG if FSL_DPAA_ETH
+	select MDIO_BUS_MUX_GPIO if FSL_DPAA_ETH
 	help
 	  This option enables support for the FSL CoreNet based boards.
 	  For 32bit kernel, the following boards are supported:
 	    P2041 RDB, P3041 DS and P4080 DS
 	  For 64bit kernel, the following boards are supported:
-	    T4240 QDS and B4 QDS
+	    T208x QDS and RDB, T4240 QDS, T4240 RDB and B4 QDS
 	  The following boards are supported for both 32bit and 64bit kernel:
-	    P5020 DS and P5040 DS
+	    P5020 DS, P5040 DS, T104xQDS, T104xRDB
 
 endif # FSL_SOC_BOOKE
 
diff --git a/arch/powerpc/platforms/85xx/corenet_generic.c b/arch/powerpc/platforms/85xx/corenet_generic.c
index 75ae84a..21be308 100644
--- a/arch/powerpc/platforms/85xx/corenet_generic.c
+++ b/arch/powerpc/platforms/85xx/corenet_generic.c
@@ -69,6 +69,15 @@ static const struct of_device_id of_device_ids[] = {
 		.compatible	= "fsl,dpaa",
 	},
 	{
+		.compatible	= "mdio-mux-gpio",
+	},
+	{
+		.compatible	= "fsl,fpga-ngpixis",
+	},
+	{
+		.compatible	= "fsl,fpga-qixis",
+	},
+	{
 		.compatible	= "fsl,srio",
 	},
 	{
-- 
2.0.2

