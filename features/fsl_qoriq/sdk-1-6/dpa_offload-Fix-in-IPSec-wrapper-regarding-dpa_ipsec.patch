From c8a0d7cb1c48b8c921d9116fdc882a3ccd72b511 Mon Sep 17 00:00:00 2001
From: Andrei Varvara <andrei.varvara@freescale.com>
Date: Tue, 4 Mar 2014 13:35:23 +0200
Subject: [PATCH 0751/1089] dpa_offload: Fix in IPSec wrapper regarding
 dpa_ipsec_get_stats

[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]

When doing the Multiple IPSec instances implementation
I had to change the API for dpa_ipsec_get_stats which did
not received as parameter the intance ID.

Unfortunately when updating the IPSec wrapper I forgot to
update also in case of compat mode.

Signed-off-by: Andrei Varvara <andrei.varvara@freescale.com>
Change-Id: I6acddda0e54d1c5e6c1b47122d81559ecd0cf0f3
Reviewed-on: http://git.am.freescale.net:8181/9369
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Marian-Cornel Chereji <marian.chereji@freescale.com>
Reviewed-by: Jose Rivera <German.Rivera@freescale.com>
---
 drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c b/drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c
index a223160..00e327c 100644
--- a/drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c
+++ b/drivers/staging/fsl_dpa_offload/wrp_dpa_ipsec.c
@@ -1548,7 +1548,7 @@ long wrp_dpa_ipsec_do_compat_ioctl(struct file *filp, unsigned int cmd,
 	case DPA_IPSEC_IOC_GET_STATS: {
 		struct dpa_ipsec_stats ipsec_stats;
 
-		ret = dpa_ipsec_get_stats(&ipsec_stats);
+		ret = dpa_ipsec_get_stats(0, &ipsec_stats);
 		if (ret < 0) {
 			log_err("Getting stats failed\n");
 			break;
-- 
2.0.2

