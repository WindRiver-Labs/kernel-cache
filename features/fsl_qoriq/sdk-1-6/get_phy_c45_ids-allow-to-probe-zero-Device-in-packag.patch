From 77239971141f40e6b53364c619f20ec67ce37f8a Mon Sep 17 00:00:00 2001
From: Yanjiang Jin <yanjiang.jin@windriver.com>
Date: Tue, 10 Feb 2015 17:36:21 +0800
Subject: [PATCH 1/6] get_phy_c45_ids() allow to probe zero Device in package.

When the probe returns zero, the function will trap in dead loop.

Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/net/phy/phy_device.c |    5 +++++
 1 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/drivers/net/phy/phy_device.c b/drivers/net/phy/phy_device.c
index b417e9f..629eda0 100644
--- a/drivers/net/phy/phy_device.c
+++ b/drivers/net/phy/phy_device.c
@@ -243,6 +243,11 @@ retry:		reg_addr = MII_ADDR_C45 | i << 16 | 6;
 			return -EIO;
 		c45_ids->devices_in_package |= (phy_reg & 0xffff);
 
+		if ((i == 0) && (c45_ids->devices_in_package == 0)) {
+			*phy_id = 0xffffffff;
+			return 0;
+		}
+
 		if ((c45_ids->devices_in_package & 0x1fffffff) == 0x1fffffff) {
 			if (i) {
 				/*  If mostly Fs, there is no device there,
-- 
1.7.5.4

