From f05f5e43f46cb7bdc31f09343079e9881cf0b921 Mon Sep 17 00:00:00 2001
From: Ioana Tibuleac <ioana.tibuleac@freescale.com>
Date: Tue, 1 Jul 2014 11:13:53 +0800
Subject: [PATCH 226/466] dpaa_offload: New B4 DTS for ONIC integration

modifiy B4 DTS to support the ONIC integration in the ipsec_offload usecase

Change-Id: I3a313d0dcfd8ed8aab22146d935696b96d3d670d
Signed-off-by: Ioana Tibuleac <ioana.tibuleac@freescale.com>
Reviewed-on: http://git.am.freescale.net:8181/10494
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Marian-Cornel Chereji <marian.chereji@freescale.com>
Reviewed-by: Jose Rivera <German.Rivera@freescale.com>
[Original patch taken from QorIQ-SDK-V1.6-SOURCE-20140619-yocto.iso]
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 .../dts/b4860qds-usdpaa-shared-interfaces.dts      |   21 ++++++++++++++++----
 1 file changed, 17 insertions(+), 4 deletions(-)

diff --git a/drivers/staging/fsl_dpa_offload/dts/b4860qds-usdpaa-shared-interfaces.dts b/drivers/staging/fsl_dpa_offload/dts/b4860qds-usdpaa-shared-interfaces.dts
index 0b21504..84f66c2 100644
--- a/drivers/staging/fsl_dpa_offload/dts/b4860qds-usdpaa-shared-interfaces.dts
+++ b/drivers/staging/fsl_dpa_offload/dts/b4860qds-usdpaa-shared-interfaces.dts
@@ -83,6 +83,13 @@
 		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
+	bp17: buffer-pool@17 {
+		compatible = "fsl,b4860-bpool", "fsl,bpool";
+		fsl,bpid = <17>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
+		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
+		fsl,bpool-ethernet-seeds;
+	};
 
 	fsl,dpaa {
 		ethernet@0 {
@@ -148,17 +155,23 @@
                         fsl,qman-frame-queues-tx = <6008 8>;
                         local-mac-address = [00 11 22 33 44 77];
                 };
+		ethernet@19 {
+			compatible = "fsl,b4860-dpa-ethernet-generic", "fsl,dpa-ethernet-generic";
+			fsl,qman-frame-queues-rx = <7000 2>;
+			fsl,qman-frame-queues-tx = <7008 1>;
+			fsl,oh-ports = <&oh2 &oh3>;
+			local-mac-address = [00 11 22 33 44 88];
+		};
 
-
-		dpa-fman0-oh@2 {
+		oh2: dpa-fman0-oh@2 {
 			compatible = "fsl,dpa-oh";
 			/* Define frame queues for the OH port*/
 			/* <OH Rx error, OH Rx default> */
 			fsl,qman-frame-queues-oh = <0x6e 1 0x6f 1>;
-			fsl,bman-buffer-pools = <&bp16>;
+			fsl,bman-buffer-pools = <&bp17>;
 			fsl,fman-oh-port = <&fman0_oh2>;
 		};
-		dpa_fman0_oh3: dpa-fman0-oh@3 {
+		oh3: dpa_fman0_oh3: dpa-fman0-oh@3 {
 			compatible = "fsl,dpa-oh";
 			fsl,qman-frame-queues-oh = <0x68 1 0x69 1>;
 			fsl,bman-buffer-pools = <&bp9>;
-- 
1.7.10.4

