From 3d657d75321064bdd5571c3ba940e3b2401c4f10 Mon Sep 17 00:00:00 2001
From: Zhao Chenhui <chenhui.zhao@freescale.com>
Date: Wed, 22 May 2013 10:41:46 +0800
Subject: [PATCH 342/547] powerpc/bsc913x: fix power node and mpic timer node

 * Add power node.
 * Fix the mpic timer node.

Signed-off-by: Wang Dongsheng <dongsheng.wang@freescale.com>
Signed-off-by: Zhao Chenhui <chenhui.zhao@freescale.com>
Change-Id: I2cfdda17170a8680b19b55da261f712c2068580d
Reviewed-on: http://git.am.freescale.net:8181/2665
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Burmi Naveen-B16502 <NaveenBurmi@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[Original patch taken from QorIQ-SDK-V1.4-SOURCE-20130625-yocto.iso]
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 arch/powerpc/boot/dts/fsl/bsc9131si-post.dtsi | 17 +++++++----------
 arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi |  6 ++++++
 2 files changed, 13 insertions(+), 10 deletions(-)

diff --git a/arch/powerpc/boot/dts/fsl/bsc9131si-post.dtsi b/arch/powerpc/boot/dts/fsl/bsc9131si-post.dtsi
index 5180d9d..632eed0 100644
--- a/arch/powerpc/boot/dts/fsl/bsc9131si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/bsc9131si-post.dtsi
@@ -156,19 +156,12 @@ crypto@30000 {
 };
 
 /include/ "pq3-mpic.dtsi"
-
-timer@41100 {
-	compatible = "fsl,mpic-v1.2-msgr", "fsl,mpic-msg";
-	reg = <0x41400 0x200>;
-	interrupts = <
-		0xb0 2
-		0xb1 2
-		0xb2 2
-		0xb3 2>;
-};
+/include/ "pq3-mpic-timer-B.dtsi"
 
 /include/ "pq3-etsec2-0.dtsi"
 enet0: ethernet@b0000 {
+	fsl,pmc-handle = <&etsec1_clk>;
+
 	queue-group@b0000 {
 		fsl,rx-bit-map = <0xff>;
 		fsl,tx-bit-map = <0xff>;
@@ -178,6 +171,8 @@ enet0: ethernet@b0000 {
 
 /include/ "pq3-etsec2-1.dtsi"
 enet1: ethernet@b1000 {
+	fsl,pmc-handle = <&etsec2_clk>;
+
 	queue-group@b1000 {
 		fsl,rx-bit-map = <0xff>;
 		fsl,tx-bit-map = <0xff>;
@@ -190,4 +185,6 @@ global-utilities@e0000 {
 		reg = <0xe0000 0x1000>;
 		fsl,has-rstcr;
 	};
+
+/include/ "pq3-power.dtsi"
 };
diff --git a/arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi b/arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi
index e42e82b..20962ab 100644
--- a/arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/bsc9132si-post.dtsi
@@ -190,6 +190,8 @@ crypto@30000 {
 
 /include/ "pq3-etsec2-0.dtsi"
 enet0: ethernet@b0000 {
+	fsl,pmc-handle = <&etsec1_clk>;
+
 	queue-group@b0000 {
 		fsl,rx-bit-map = <0xff>;
 		fsl,tx-bit-map = <0xff>;
@@ -199,6 +201,8 @@ enet0: ethernet@b0000 {
 
 /include/ "pq3-etsec2-1.dtsi"
 enet1: ethernet@b1000 {
+	fsl,pmc-handle = <&etsec2_clk>;
+
 	queue-group@b1000 {
 		fsl,rx-bit-map = <0xff>;
 		fsl,tx-bit-map = <0xff>;
@@ -211,4 +215,6 @@ global-utilities@e0000 {
 		reg = <0xe0000 0x1000>;
 		fsl,has-rstcr;
 	};
+
+/include/ "pq3-power.dtsi"
 };
-- 
1.8.4.93.g57e4c17

