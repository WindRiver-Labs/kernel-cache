From 69feb9fb1cf164c14296997aa56e1bf4ce8caf1d Mon Sep 17 00:00:00 2001
From: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
Date: Fri, 19 Oct 2012 12:14:54 +0300
Subject: [PATCH 016/430] dpaa_eth: No longer set netdev->last_rx

The documentation of the net_device->last_rx field advises against the
driver setting it, unless there is an explicit reason to do so.

Change-Id: Ic8cd480eeae2cbf42d6ddb09e99bcf2912cad84c
Signed-off-by: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
(cherry picked from commit 327cdbc91f173c3866a1ef5c83daab852d630c9c)
Reviewed-on: http://git.am.freescale.net:8181/1045
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[original patch is from QorIQ-SDK-V1.4-20130625-yocto]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c    |    3 ---
 drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c |    1 -
 2 files changed, 0 insertions(+), 4 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index 717154e..c3c85bd 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -1342,7 +1342,6 @@ void __hot _dpa_rx(struct net_device *net_dev,
 
 packet_dropped:
 skb_stolen:
-	net_dev->last_rx = jiffies;
 	return;
 
 drop_invalid_frame:
@@ -2098,8 +2097,6 @@ skb_copied:
 		percpu_priv->stats.rx_bytes += dpa_fd_length(fd);
 	}
 
-	net_dev->last_rx = jiffies;
-
 out:
 	if (fd->format == qm_fd_sg)
 		dpa_fd_release_sg(net_dev, fd);
diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
index 067318c..cabf9dc 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
@@ -533,7 +533,6 @@ void __hot _dpa_rx(struct net_device *net_dev,
 	percpu_priv->stats.rx_bytes += skb_len;
 
 packet_dropped:
-	net_dev->last_rx = jiffies;
 	return;
 
 drop_bad_frame:
-- 
1.7.5.4

