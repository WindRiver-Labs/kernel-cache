From f869133616581f3a19bce4d98b19de5300285cbe Mon Sep 17 00:00:00 2001
From: Kevin Hao <kexin.hao@windriver.com>
Date: Thu, 7 Mar 2013 19:37:52 +0800
Subject: [PATCH 529/547] powerpc/fsl_book3e: fix the relocatable bug in
 fsl_enable_threads

The LOAD_REG_IMMEDIATE can't be used to load a function address when
relocatable enabled. So replace it with LOAD_REG_ADDR.

Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 arch/powerpc/kernel/exceptions-64e.S | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/powerpc/kernel/exceptions-64e.S b/arch/powerpc/kernel/exceptions-64e.S
index f6992af..aba47b5 100644
--- a/arch/powerpc/kernel/exceptions-64e.S
+++ b/arch/powerpc/kernel/exceptions-64e.S
@@ -1457,7 +1457,7 @@ BEGIN_FTR_SECTION
 	 * Set the NIA for the secondary thread to
 	 * generic_secondary_thread_init
 	 */
-	LOAD_REG_IMMEDIATE(r3, .fsl_secondary_thread_init);
+	LOAD_REG_ADDR(r3, .fsl_secondary_thread_init);
 	MTTMR(TMRN_INIA1, 3);
 
 	/* Release the other thread. It will spin until kick_cpu is called */
-- 
1.8.4.93.g57e4c17

