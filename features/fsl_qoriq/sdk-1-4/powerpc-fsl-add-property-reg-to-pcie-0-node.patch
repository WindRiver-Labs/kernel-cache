From 06d5b281e79c5d71499a148328b2cfb0a701c30c Mon Sep 17 00:00:00 2001
From: Minghuan Lian <Minghuan.Lian@freescale.com>
Date: Wed, 8 May 2013 14:42:21 +0800
Subject: [PATCH 368/430] powerpc/fsl: add property 'reg' to pcie@0 node

The property 'reg' is used to identify the PCIe device. if there is no 'reg'
the PCI driver can not find PCI device node corresponding to PCI controller,
and can not map the interrupts. So all the INTx interrupts can not be used.

Signed-off-by: Minghuan Lian <Minghuan.Lian@freescale.com>
Change-Id: Ibdb61b288964c8d8639671199b2e0cda88857653
Reviewed-on: http://git.am.freescale.net:8181/2410
Reviewed-by: Zang Tiefei-R61911 <tie-fei.zang@freescale.com>
Reviewed-by: Xie Shaohui-B21989 <Shaohui.Xie@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[Original patch is from QorIQ-SDK-V1.4-20130625-yocto, just a minor
modification to port 3.4 kernel]
Signed-off-by: Wei Yang <Wei.Yang@windriver.com>
---
 arch/powerpc/boot/dts/fsl/b4860si-post.dtsi |    1 +
 arch/powerpc/boot/dts/fsl/t4240si-post.dtsi |    4 ++++
 2 files changed, 5 insertions(+), 0 deletions(-)

diff --git a/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi b/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
index c65b79b..98e292e 100644
--- a/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
@@ -48,6 +48,7 @@
 	bus-range = <0x0 0xff>;
 	interrupts = <20 2 0 0>;
 	pcie@0 {
+		reg = <0 0 0 0 0>;
 		#interrupt-cells = <1>;
 		#size-cells = <2>;
 		#address-cells = <3>;
diff --git a/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi b/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
index c28fbc4..8e25dfc 100644
--- a/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
@@ -61,6 +61,7 @@
 	clock-frequency = <33333333>;
 	interrupts = <20 2 0 0>;
 	pcie@0 {
+		reg = <0 0 0 0 0>;
 		#interrupt-cells = <1>;
 		#size-cells = <2>;
 		#address-cells = <3>;
@@ -87,6 +88,7 @@
 	clock-frequency = <33333333>;
 	interrupts = <21 2 0 0>;
 	pcie@0 {
+		reg = <0 0 0 0 0>;
 		#interrupt-cells = <1>;
 		#size-cells = <2>;
 		#address-cells = <3>;
@@ -113,6 +115,7 @@
 	clock-frequency = <33333333>;
 	interrupts = <22 2 0 0>;
 	pcie@0 {
+		reg = <0 0 0 0 0>;
 		#interrupt-cells = <1>;
 		#size-cells = <2>;
 		#address-cells = <3>;
@@ -139,6 +142,7 @@
 	clock-frequency = <33333333>;
 	interrupts = <23 2 0 0>;
 	pcie@0 {
+		reg = <0 0 0 0 0>;
 		#interrupt-cells = <1>;
 		#size-cells = <2>;
 		#address-cells = <3>;
-- 
1.7.5.4

