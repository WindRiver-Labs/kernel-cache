From abb55186b329ee63a326302045e5ec17db402de6 Mon Sep 17 00:00:00 2001
From: Wei Yang <Wei.Yang@windriver.com>
Date: Thu, 18 Jul 2013 17:44:20 +0800
Subject: [PATCH 499/547] dts/t4240qds: Introduce i2c bus multiplexer support
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

In T4240QDS, a I2C multiplexers(pca9547) is used to partition the
I2C bus into several sub-buses, called “channels”.

* These eeproms are connected to pca947x's channel0, so we need to
  move them to pca947x's channel0.
* a thermal monitor(ADT7481A) is connected to pca947x's channel3

Signed-off-by: Wei Yang <Wei.Yang@windriver.com>
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 arch/powerpc/boot/dts/t4240qds.dts | 86 ++++++++++++++++++++++----------------
 1 file changed, 51 insertions(+), 35 deletions(-)

diff --git a/arch/powerpc/boot/dts/t4240qds.dts b/arch/powerpc/boot/dts/t4240qds.dts
index b6d5bab..a5bb7d7 100644
--- a/arch/powerpc/boot/dts/t4240qds.dts
+++ b/arch/powerpc/boot/dts/t4240qds.dts
@@ -368,45 +368,61 @@
 		};
 
 		i2c@118000 {
-			pca9547@77 {
-				compatible = "philips,pca9547";
-				reg = <0x77>;
-			};
 			eeprom@50 {
 				compatible = "at24,24c64";
 				reg = <0x50>;
 			};
-			eeprom@51 {
-				compatible = "at24,spd";
-				reg = <0x51>;
-			};
-			eeprom@52 {
-				compatible = "at24,spd";
-				reg = <0x52>;
-			};
-			eeprom@53 {
-				compatible = "at24,spd";
-				reg = <0x53>;
-			};
-			eeprom@54 {
-				compatible = "at24,spd";
-				reg = <0x54>;
-			};
-			eeprom@55 {
-				compatible = "at24,spd";
-				reg = <0x55>;
-			};
-			eeprom@56 {
-				compatible = "at24,spd";
-				reg = <0x56>;
-			};
-			eeprom@57 {
-				compatible = "at24,24c02";
-				reg = <0x57>;
-			};
-			rtc@68 {
-				compatible = "dallas,ds3232";
-				reg = <0x68>;
+			pca9547@77 {
+				compatible = "philips,pca9547";
+				reg = <0x77>;
+				#address-cells = <1>;
+				#size-cells = <0>;
+				channel@0 {
+					#address-cells = <1>;
+					#size-cells = <0>;
+					reg = <0>;
+						eeprom@51 {
+							compatible = "at24,spd";
+							reg = <0x51>;
+						};
+						eeprom@52 {
+							compatible = "at24,spd";
+							reg = <0x52>;
+						};
+						eeprom@53 {
+							compatible = "at24,spd";
+							reg = <0x53>;
+						};
+						eeprom@54 {
+							compatible = "at24,spd";
+							reg = <0x54>;
+						};
+						eeprom@55 {
+							compatible = "at24,spd";
+							reg = <0x55>;
+						};
+						eeprom@56 {
+							compatible = "at24,spd";
+							reg = <0x56>;
+						};
+						eeprom@57 {
+							compatible = "at24,24c02";
+							reg = <0x57>;
+						};
+						rtc@68 {
+							compatible = "dallas,ds3232";
+							reg = <0x68>;
+						};
+					};
+				channel@3 {
+					#address-cells = <1>;
+					#size-cells = <0>;
+					reg = <3>;
+						adt7461@4c {
+							compatible = "adi,adt7461";
+							reg = <0x4c>;
+						};
+				};
 			};
 		};
 
-- 
1.8.4.93.g57e4c17

