From 7a8b1e252b635f2f65b2616c9c6d3646f8238c6f Mon Sep 17 00:00:00 2001
From: Xie Xiaobo <X.Xie@freescale.com>
Date: Tue, 14 May 2013 16:46:47 +0800
Subject: [PATCH 350/430] powerpc/fsl-pci: fix pcie range issue for P1025TWR
 board

P1025TWR board has its PCIE memory range less than 0xbfff_ffff,
but in dts its boundary value is 0xe0000000. Both of PCIE are maped
to the same boundary 0xe0000000 which is Overlapped and crossed.
Cpu will access the illicit memery addr and detect error. So update
dts for P1025TWR PCIE.

Signed-off-by: Xie Xiaobo <X.Xie@freescale.com>
Change-Id: I37de02ad659e8562ed6e0cd44da5c31ade8ad039
Reviewed-on: http://git.am.freescale.net:8181/2472
Reviewed-by: Zang Tiefei-R61911 <tie-fei.zang@freescale.com>
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[Original patch is from QorIQ-SDK-V1.4-20130625-yocto, just a minor
modification to port 3.4 kernel]
Signed-off-by: Wei Yang <wei.yang@windriver.com>
---
 arch/powerpc/boot/dts/p1025twr_32b.dts |   14 +++++++-------
 1 files changed, 7 insertions(+), 7 deletions(-)

diff --git a/arch/powerpc/boot/dts/p1025twr_32b.dts b/arch/powerpc/boot/dts/p1025twr_32b.dts
index a3a5266..18a4a57 100644
--- a/arch/powerpc/boot/dts/p1025twr_32b.dts
+++ b/arch/powerpc/boot/dts/p1025twr_32b.dts
@@ -54,12 +54,12 @@
 	};
 
 	pci0: pcie@ffe09000 {
-		ranges = <0x2000000 0x0 0xe0000000 0 0xa0000000 0x0 0x20000000
-			  0x1000000 0x0 0x00000000 0 0xffc10000 0x0 0x10000>;
 		reg = <0 0xffe09000 0 0x1000>;
+		ranges = <0x2000000 0x0 0xa0000000 0 0xa0000000 0x0 0x20000000
+			  0x1000000 0x0 0x00000000 0 0xffc10000 0x0 0x10000>;
 		pcie@0 {
-			ranges = <0x2000000 0x0 0xe0000000
-				  0x2000000 0x0 0xe0000000
+			ranges = <0x2000000 0x0 0xa0000000
+				  0x2000000 0x0 0xa0000000
 				  0x0 0x20000000
 
 				  0x1000000 0x0 0x0
@@ -70,11 +70,11 @@
 
 	pci1: pcie@ffe0a000 {
 		reg = <0 0xffe0a000 0 0x1000>;
-		ranges = <0x2000000 0x0 0xe0000000 0 0x80000000 0x0 0x20000000
+		ranges = <0x2000000 0x0 0x80000000 0 0x80000000 0x0 0x20000000
 			  0x1000000 0x0 0x00000000 0 0xffc00000 0x0 0x10000>;
 		pcie@0 {
-			ranges = <0x2000000 0x0 0xe0000000
-				  0x2000000 0x0 0xe0000000
+			ranges = <0x2000000 0x0 0x80000000
+				  0x2000000 0x0 0x80000000
 				  0x0 0x20000000
 
 				  0x1000000 0x0 0x0
-- 
1.7.5.4

