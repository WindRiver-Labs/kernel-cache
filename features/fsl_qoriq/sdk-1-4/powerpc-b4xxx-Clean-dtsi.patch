From 37ed63dc19ea7baa6a290e4ea134d1b82e49e1af Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Mon, 12 Aug 2013 15:50:42 +0800
Subject: [PATCH 5/7] powerpc/b4xxx: Clean dtsi

We'd better clean these files to make sure these files content
are arranged as same as SDK then it will be convenient to upgrade
SDK in the future.

Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 arch/powerpc/boot/dts/fsl/b4420si-post.dtsi |   37 ++++------
 arch/powerpc/boot/dts/fsl/b4420si-pre.dtsi  |   28 +++-----
 arch/powerpc/boot/dts/fsl/b4860si-post.dtsi |   97 ++++++++++----------------
 arch/powerpc/boot/dts/fsl/b4860si-pre.dtsi  |   43 +++++-------
 4 files changed, 80 insertions(+), 125 deletions(-)

diff --git a/arch/powerpc/boot/dts/fsl/b4420si-post.dtsi b/arch/powerpc/boot/dts/fsl/b4420si-post.dtsi
index 85ea6b3..f039c52 100644
--- a/arch/powerpc/boot/dts/fsl/b4420si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4420si-post.dtsi
@@ -31,16 +31,12 @@
  * (including negligence or otherwise) arising in any way out of the use of
  * this software, even if advised of the possibility of such damage.
  */
-/include/ "b4si-post.dtsi"
 
-/* controller at 0x200000 */
-&pci0 {
-	compatible = "fsl,b4420-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
-};
+/include/ "b4si-post.dtsi"
 
 &bportals {
-    #address-cells = <0x1>;
-    #size-cells = <0x1>;
+	#address-cells = <0x1>;
+	#size-cells = <0x1>;
 	compatible = "simple-bus";
 	bman-portal@0 {
 		cell-index = <0x0>;
@@ -127,9 +123,10 @@
 		interrupts = <131 2 0 0>;
 	};
 };
+
 &qportals {
-    #address-cells = <0x1>;
-    #size-cells = <0x1>;
+	#address-cells = <0x1>;
+	#size-cells = <0x1>;
 	compatible = "simple-bus";
 	qportal0: qman-portal@0 {
 		cell-index = <0x0>;
@@ -138,7 +135,6 @@
 		interrupts = <104 0x2 0 0>;
 		fsl,qman-channel-id = <0x0>;
 	};
-
 	qportal1: qman-portal@4000 {
 		cell-index = <0x1>;
 		compatible = "fsl,qman-portal";
@@ -146,7 +142,6 @@
 		interrupts = <106 0x2 0 0>;
 		fsl,qman-channel-id = <0x1>;
 	};
-
 	qportal2: qman-portal@8000 {
 		cell-index = <0x2>;
 		compatible = "fsl,qman-portal";
@@ -154,7 +149,6 @@
 		interrupts = <108 0x2 0 0>;
 		fsl,qman-channel-id = <0x2>;
 	};
-
 	qportal3: qman-portal@c000 {
 		cell-index = <0x3>;
 		compatible = "fsl,qman-portal";
@@ -162,7 +156,6 @@
 		interrupts = <110 0x2 0 0>;
 		fsl,qman-channel-id = <0x3>;
 	};
-
 	qportal4: qman-portal@10000 {
 		cell-index = <0x4>;
 		compatible = "fsl,qman-portal";
@@ -170,7 +163,6 @@
 		interrupts = <112 0x2 0 0>;
 		fsl,qman-channel-id = <0x4>;
 	};
-
 	qportal5: qman-portal@14000 {
 		cell-index = <0x5>;
 		compatible = "fsl,qman-portal";
@@ -178,7 +170,6 @@
 		interrupts = <114 0x2 0 0>;
 		fsl,qman-channel-id = <0x5>;
 	};
-
 	qportal6: qman-portal@18000 {
 		cell-index = <0x6>;
 		compatible = "fsl,qman-portal";
@@ -186,7 +177,6 @@
 		interrupts = <116 0x2 0 0>;
 		fsl,qman-channel-id = <0x6>;
 	};
-
 	qportal7: qman-portal@1c000 {
 		cell-index = <0x7>;
 		compatible = "fsl,qman-portal";
@@ -194,7 +184,6 @@
 		interrupts = <118 0x2 0 0>;
 		fsl,qman-channel-id = <0x7>;
 	};
-
 	qportal8: qman-portal@20000 {
 		cell-index = <0x8>;
 		compatible = "fsl,qman-portal";
@@ -202,7 +191,6 @@
 		interrupts = <120 0x2 0 0>;
 		fsl,qman-channel-id = <0x8>;
 	};
-
 	qportal9: qman-portal@24000 {
 		cell-index = <0x9>;
 		compatible = "fsl,qman-portal";
@@ -210,7 +198,6 @@
 		interrupts = <122 0x2 0 0>;
 		fsl,qman-channel-id = <0x9>;
 	};
-
 	qportal10: qman-portal@28000 {
 		cell-index = <0xa>;
 		compatible = "fsl,qman-portal";
@@ -218,7 +205,6 @@
 		interrupts = <124 0x2 0 0>;
 		fsl,qman-channel-id = <0xa>;
 	};
-
 	qportal11: qman-portal@2c000 {
 		cell-index = <0xb>;
 		compatible = "fsl,qman-portal";
@@ -226,7 +212,6 @@
 		interrupts = <126 0x2 0 0>;
 		fsl,qman-channel-id = <0xb>;
 	};
-
 	qportal12: qman-portal@30000 {
 		cell-index = <0xc>;
 		compatible = "fsl,qman-portal";
@@ -234,7 +219,6 @@
 		interrupts = <128 0x2 0 0>;
 		fsl,qman-channel-id = <0xc>;
 	};
-
 	qportal13: qman-portal@34000 {
 		cell-index = <0xd>;
 		compatible = "fsl,qman-portal";
@@ -244,6 +228,11 @@
 	};
 };
 
+/* controller at 0x200000 */
+&pci0 {
+	compatible = "fsl,b4420-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
+};
+
 &dcsr {
 	dcsr-epu@0 {
 		compatible = "fsl,b4420-dcsr-epu", "fsl,dcsr-epu";
@@ -284,6 +273,7 @@
 	corenet-cf@18000 {
 		compatible = "fsl,b4420-corenet-cf";
 	};
+
 	guts: global-utilities@e0000 {
 		compatible = "fsl,b4420-device-config", "fsl,qoriq-device-config-2.0";
 	};
@@ -321,8 +311,9 @@
 			clock-output-names = "cmux0";
 		};
 	};
+
 	rcpm: global-utilities@e2000 {
-		compatible = "fsl,b4420-rcpm", "fsl,qoriq-rcpm-2";
+		compatible = "fsl,b4420-rcpm", "fsl,qoriq-rcpm-2.0";
 	};
 
 	L2: l2-cache-controller@c20000 {
diff --git a/arch/powerpc/boot/dts/fsl/b4420si-pre.dtsi b/arch/powerpc/boot/dts/fsl/b4420si-pre.dtsi
index 08d5c17..d56ac22 100644
--- a/arch/powerpc/boot/dts/fsl/b4420si-pre.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4420si-pre.dtsi
@@ -33,6 +33,7 @@
  */
 
 /dts-v1/;
+
 /include/ "e6500_power_isa.dtsi"
 
 / {
@@ -43,53 +44,46 @@
 
 	aliases {
 		ccsr = &soc;
+		dcsr = &dcsr;
 
 		serial0 = &serial0;
 		serial1 = &serial1;
 		serial2 = &serial2;
 		serial3 = &serial3;
-		pci0 = &pci0;
-		usb0 = &usb0;
-		dma0 = &dma0;
-		dma1 = &dma1;
-		sdhc = &sdhc;
 
-		fman0 = &fman0;
 		crypto = &crypto;
 		qman = &qman;
 		bman = &bman;
+		fman0 = &fman0;
 		ethernet0 = &fm1mac1;
 		ethernet1 = &fm1mac2;
 		ethernet2 = &fm1mac3;
 		ethernet3 = &fm1mac4;
 
-		sec_jr0 = &sec_jr0;
-		sec_jr1 = &sec_jr1;
-		sec_jr2 = &sec_jr2;
-		sec_jr3 = &sec_jr3;
-		rtic_a = &rtic_a;
-		rtic_b = &rtic_b;
-		rtic_c = &rtic_c;
-		rtic_d = &rtic_d;
-		sec_mon = &sec_mon;
+		pci0 = &pci0;
+		usb0 = &usb0;
+		dma0 = &dma0;
+		dma1 = &dma1;
+		sdhc = &sdhc;
 	};
 
+
 	cpus {
 		#address-cells = <1>;
 		#size-cells = <0>;
+
 		/*
 		 * Temporarily add next-level-cache info in each cpu node so
 		 * that uboot can do L2 cache fixup. This can be removed once
 		 * u-boot can create cpu node with cache info.
 		 */
-
 		cpu0: PowerPC,e6500@0 {
 			device_type = "cpu";
 			reg = <0 1>;
 			clocks = <&mux0>;
 			next-level-cache = <&L2>;
 		};
-        cpu1: PowerPC,e6500@1 {
+		cpu1: PowerPC,e6500@2 {
 			device_type = "cpu";
 			reg = <2 3>;
 			clocks = <&mux0>;
diff --git a/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi b/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
index 318810b..a166d1c 100644
--- a/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
@@ -6,13 +6,13 @@
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions are met:
  *     * Redistributions of source code must retain the above copyright
- *	 notice, this list of conditions and the following disclaimer.
+ *       notice, this list of conditions and the following disclaimer.
  *     * Redistributions in binary form must reproduce the above copyright
- *	 notice, this list of conditions and the following disclaimer in the
- *	 documentation and/or other materials provided with the distribution.
+ *       notice, this list of conditions and the following disclaimer in the
+ *       documentation and/or other materials provided with the distribution.
  *     * Neither the name of Freescale Semiconductor nor the
- *	 names of its contributors may be used to endorse or promote products
- *	 derived from this software without specific prior written permission.
+ *       names of its contributors may be used to endorse or promote products
+ *       derived from this software without specific prior written permission.
  *
  *
  * ALTERNATIVELY, this software may be distributed under the terms of the
@@ -33,34 +33,9 @@
  */
 
 /include/ "b4si-post.dtsi"
-/* controller at 0x200000 */
-&pci0 {
-	compatible = "fsl,b4860-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
-};
-
-&rio {
-	compatible = "fsl,srio";
-	interrupts = <16 2 1 11>;
-	#address-cells = <2>;
-	#size-cells = <2>;
-	ranges;
-
-	port1 {
-		#address-cells = <2>;
-		#size-cells = <2>;
-		cell-index = <1>;
-	};
-
-	port2 {
-		#address-cells = <2>;
-		#size-cells = <2>;
-		cell-index = <2>;
-	};
-};
-
 &bportals {
-    #address-cells = <0x1>;
-    #size-cells = <0x1>;
+	#address-cells = <0x1>;
+	#size-cells = <0x1>;
 	compatible = "simple-bus";
 	bman-portal@0 {
 		cell-index = <0x0>;
@@ -213,9 +188,10 @@
 		interrupts = <153 2 0 0>;
 	};
 };
+
 &qportals {
-    #address-cells = <0x1>;
-    #size-cells = <0x1>;
+	#address-cells = <0x1>;
+	#size-cells = <0x1>;
 	compatible = "simple-bus";
 	qportal0: qman-portal@0 {
 		cell-index = <0x0>;
@@ -224,7 +200,6 @@
 		interrupts = <104 0x2 0 0>;
 		fsl,qman-channel-id = <0x0>;
 	};
-
 	qportal1: qman-portal@4000 {
 		cell-index = <0x1>;
 		compatible = "fsl,qman-portal";
@@ -232,7 +207,6 @@
 		interrupts = <106 0x2 0 0>;
 		fsl,qman-channel-id = <0x1>;
 	};
-
 	qportal2: qman-portal@8000 {
 		cell-index = <0x2>;
 		compatible = "fsl,qman-portal";
@@ -240,7 +214,6 @@
 		interrupts = <108 0x2 0 0>;
 		fsl,qman-channel-id = <0x2>;
 	};
-
 	qportal3: qman-portal@c000 {
 		cell-index = <0x3>;
 		compatible = "fsl,qman-portal";
@@ -248,7 +221,6 @@
 		interrupts = <110 0x2 0 0>;
 		fsl,qman-channel-id = <0x3>;
 	};
-
 	qportal4: qman-portal@10000 {
 		cell-index = <0x4>;
 		compatible = "fsl,qman-portal";
@@ -256,7 +228,6 @@
 		interrupts = <112 0x2 0 0>;
 		fsl,qman-channel-id = <0x4>;
 	};
-
 	qportal5: qman-portal@14000 {
 		cell-index = <0x5>;
 		compatible = "fsl,qman-portal";
@@ -264,7 +235,6 @@
 		interrupts = <114 0x2 0 0>;
 		fsl,qman-channel-id = <0x5>;
 	};
-
 	qportal6: qman-portal@18000 {
 		cell-index = <0x6>;
 		compatible = "fsl,qman-portal";
@@ -272,7 +242,6 @@
 		interrupts = <116 0x2 0 0>;
 		fsl,qman-channel-id = <0x6>;
 	};
-
 	qportal7: qman-portal@1c000 {
 		cell-index = <0x7>;
 		compatible = "fsl,qman-portal";
@@ -280,7 +249,6 @@
 		interrupts = <118 0x2 0 0>;
 		fsl,qman-channel-id = <0x7>;
 	};
-
 	qportal8: qman-portal@20000 {
 		cell-index = <0x8>;
 		compatible = "fsl,qman-portal";
@@ -288,7 +256,6 @@
 		interrupts = <120 0x2 0 0>;
 		fsl,qman-channel-id = <0x8>;
 	};
-
 	qportal9: qman-portal@24000 {
 		cell-index = <0x9>;
 		compatible = "fsl,qman-portal";
@@ -296,7 +263,6 @@
 		interrupts = <122 0x2 0 0>;
 		fsl,qman-channel-id = <0x9>;
 	};
-
 	qportal10: qman-portal@28000 {
 		cell-index = <0xa>;
 		compatible = "fsl,qman-portal";
@@ -304,7 +270,6 @@
 		interrupts = <124 0x2 0 0>;
 		fsl,qman-channel-id = <0xa>;
 	};
-
 	qportal11: qman-portal@2c000 {
 		cell-index = <0xb>;
 		compatible = "fsl,qman-portal";
@@ -312,7 +277,6 @@
 		interrupts = <126 0x2 0 0>;
 		fsl,qman-channel-id = <0xb>;
 	};
-
 	qportal12: qman-portal@30000 {
 		cell-index = <0xc>;
 		compatible = "fsl,qman-portal";
@@ -320,7 +284,6 @@
 		interrupts = <128 0x2 0 0>;
 		fsl,qman-channel-id = <0xc>;
 	};
-
 	qportal13: qman-portal@34000 {
 		cell-index = <0xd>;
 		compatible = "fsl,qman-portal";
@@ -328,7 +291,6 @@
 		interrupts = <130 0x2 0 0>;
 		fsl,qman-channel-id = <0xd>;
 	};
-
 	qportal14: qman-portal@38000 {
 		cell-index = <0xe>;
 		compatible = "fsl,qman-portal";
@@ -336,7 +298,6 @@
 		interrupts = <132 0x2 0 0>;
 		fsl,qman-channel-id = <0xe>;
 	};
-
 	qportal15: qman-portal@3c000 {
 		cell-index = <0xf>;
 		compatible = "fsl,qman-portal";
@@ -344,7 +305,6 @@
 		interrupts = <134 0x2 0 0>;
 		fsl,qman-channel-id = <0xf>;
 	};
-
 	qportal16: qman-portal@40000 {
 		cell-index = <0x10>;
 		compatible = "fsl,qman-portal";
@@ -352,7 +312,6 @@
 		interrupts = <136 0x2 0 0>;
 		fsl,qman-channel-id = <0x10>;
 	};
-
 	qportal17: qman-portal@44000 {
 		cell-index = <0x11>;
 		compatible = "fsl,qman-portal";
@@ -360,7 +319,6 @@
 		interrupts = <138 0x2 0 0>;
 		fsl,qman-channel-id = <0x11>;
 	};
-
 	qportal18: qman-portal@48000 {
 		cell-index = <0x12>;
 		compatible = "fsl,qman-portal";
@@ -368,7 +326,6 @@
 		interrupts = <140 0x2 0 0>;
 		fsl,qman-channel-id = <0x12>;
 	};
-
 	qportal19: qman-portal@4c000 {
 		cell-index = <0x13>;
 		compatible = "fsl,qman-portal";
@@ -376,7 +333,6 @@
 		interrupts = <142 0x2 0 0>;
 		fsl,qman-channel-id = <0x13>;
 	};
-
 	qportal20: qman-portal@50000 {
 		cell-index = <0x14>;
 		compatible = "fsl,qman-portal";
@@ -384,7 +340,6 @@
 		interrupts = <144 0x2 0 0>;
 		fsl,qman-channel-id = <0x14>;
 	};
-
 	qportal21: qman-portal@54000 {
 		cell-index = <0x15>;
 		compatible = "fsl,qman-portal";
@@ -392,7 +347,6 @@
 		interrupts = <146 0x2 0 0>;
 		fsl,qman-channel-id = <0x15>;
 	};
-
 	qportal22: qman-portal@58000 {
 		cell-index = <0x16>;
 		compatible = "fsl,qman-portal";
@@ -400,7 +354,6 @@
 		interrupts = <148 0x2 0 0>;
 		fsl,qman-channel-id = <0x16>;
 	};
-
 	qportal23: qman-portal@5c000 {
 		cell-index = <0x17>;
 		compatible = "fsl,qman-portal";
@@ -408,7 +361,6 @@
 		interrupts = <150 0x2 0 0>;
 		fsl,qman-channel-id = <0x17>;
 	};
-
 	qportal24: qman-portal@60000 {
 		cell-index = <0x18>;
 		compatible = "fsl,qman-portal";
@@ -417,6 +369,31 @@
 		fsl,qman-channel-id = <0x18>;
 	};
 };
+/* controller at 0x200000 */
+&pci0 {
+	compatible = "fsl,b4860-pcie", "fsl,qoriq-pcie-v2.4", "fsl,qoriq-pcie";
+};
+
+&rio {
+	compatible = "fsl,srio";
+	interrupts = <16 2 1 11>;
+	#address-cells = <2>;
+	#size-cells = <2>;
+	fsl,iommu-parent = <&pamu0>;
+	ranges;
+
+	port1 {
+		#address-cells = <2>;
+		#size-cells = <2>;
+		cell-index = <1>;
+	};
+
+	port2 {
+		#address-cells = <2>;
+		#size-cells = <2>;
+		cell-index = <2>;
+	};
+};
 
 &dcsr {
 	dcsr-epu@0 {
@@ -466,9 +443,8 @@
 };
 
 &soc {
-
 	ddr2: memory-controller@9000 {
-		compatible = "fsl,qoriq-memory-controller-v4.5","fsl,qoriq-memory-controller";
+		compatible = "fsl,qoriq-memory-controller-v4.5", "fsl,qoriq-memory-controller";
 		reg = <0x9000 0x1000>;
 		interrupts = <16 2 1 9>;
 	};
@@ -541,6 +517,7 @@
 	L2: l2-cache-controller@c20000 {
 		compatible = "fsl,b4860-l2-cache-controller";
 	};
+
 /include/ "qoriq-rman-0.dtsi"
 	rman: rman@1e0000 {
 		fsl,qman-channels-id = <0x820 0x821>;
diff --git a/arch/powerpc/boot/dts/fsl/b4860si-pre.dtsi b/arch/powerpc/boot/dts/fsl/b4860si-pre.dtsi
index ba47b23..6c85eca 100644
--- a/arch/powerpc/boot/dts/fsl/b4860si-pre.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4860si-pre.dtsi
@@ -6,13 +6,13 @@
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions are met:
  *     * Redistributions of source code must retain the above copyright
- *	 notice, this list of conditions and the following disclaimer.
+ *       notice, this list of conditions and the following disclaimer.
  *     * Redistributions in binary form must reproduce the above copyright
- *	 notice, this list of conditions and the following disclaimer in the
- *	 documentation and/or other materials provided with the distribution.
+ *       notice, this list of conditions and the following disclaimer in the
+ *       documentation and/or other materials provided with the distribution.
  *     * Neither the name of Freescale Semiconductor nor the
- *	 names of its contributors may be used to endorse or promote products
- *	 derived from this software without specific prior written permission.
+ *       names of its contributors may be used to endorse or promote products
+ *       derived from this software without specific prior written permission.
  *
  *
  * ALTERNATIVELY, this software may be distributed under the terms of the
@@ -33,6 +33,7 @@
  */
 
 /dts-v1/;
+
 /include/ "e6500_power_isa.dtsi"
 
 / {
@@ -43,20 +44,16 @@
 
 	aliases {
 		ccsr = &soc;
+		dcsr = &dcsr;
 
 		serial0 = &serial0;
 		serial1 = &serial1;
 		serial2 = &serial2;
 		serial3 = &serial3;
-		pci0 = &pci0;
-		usb0 = &usb0;
-		dma0 = &dma0;
-		dma1 = &dma1;
-		sdhc = &sdhc;
 
+		crypto = &crypto;
 		qman = &qman;
 		bman = &bman;
-
 		fman0 = &fman0;
 		ethernet0 = &fm1mac1;
 		ethernet1 = &fm1mac2;
@@ -66,16 +63,12 @@
 		ethernet5 = &fm1mac6;
 		ethernet8 = &fm1mac9;
 		ethernet9 = &fm1mac10;
-		crypto = &crypto;
-		sec_jr0 = &sec_jr0;
-		sec_jr1 = &sec_jr1;
-		sec_jr2 = &sec_jr2;
-		sec_jr3 = &sec_jr3;
-		rtic_a = &rtic_a;
-		rtic_b = &rtic_b;
-		rtic_c = &rtic_c;
-		rtic_d = &rtic_d;
-		sec_mon = &sec_mon;
+
+		pci0 = &pci0;
+		usb0 = &usb0;
+		dma0 = &dma0;
+		dma1 = &dma1;
+		sdhc = &sdhc;
 	};
 
 	cpus {
@@ -87,25 +80,25 @@
 		 * that uboot can do L2 cache fixup. This can be removed once
 		 * u-boot can create cpu node with cache info.
 		 */
-        cpu0: PowerPC,e6500@0 {
+		cpu0: PowerPC,e6500@0 {
 			device_type = "cpu";
 			reg = <0 1>;
 			clocks = <&mux0>;
 			next-level-cache = <&L2>;
 		};
-		cpu1: PowerPC,e6500@1 {
+		cpu1: PowerPC,e6500@2 {
 			device_type = "cpu";
 			reg = <2 3>;
 			clocks = <&mux0>;
 			next-level-cache = <&L2>;
 		};
-        cpu2: PowerPC,e6500@2 {
+		cpu2: PowerPC,e6500@4 {
 			device_type = "cpu";
 			reg = <4 5>;
 			clocks = <&mux0>;
 			next-level-cache = <&L2>;
 		};
-        cpu3: PowerPC,e6500@3 {
+		cpu3: PowerPC,e6500@6 {
 			device_type = "cpu";
 			reg = <6 7>;
 			clocks = <&mux0>;
-- 
1.7.5.4

