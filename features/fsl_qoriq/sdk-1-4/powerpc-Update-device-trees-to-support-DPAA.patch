From 7271c929de7fd731f8a5ec658d2d2b74c59bc3d0 Mon Sep 17 00:00:00 2001
From: Andy Fleming <afleming@freescale.com>
Date: Fri, 29 Mar 2013 19:10:12 -0500
Subject: [PATCH 381/430] powerpc: Update device trees to support DPAA

The Datapath Acceleration Architecture devices are added to
the SOCs which make use of them. Compile-tested only.

The big changes from 1.3:
1) PAMU support now updated in each device to reflect new
   architecture which specifies the PAMU topology.
2) Virtual MDIO drivers are now specified using the new
   generic architecture.

Signed-off-by: Andy Fleming <afleming@freescale.com>
Change-Id: Id287a528bf94067aa60f721916462f0797161d89
Reviewed-on: http://git.am.freescale.net:8181/911
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[The original patch is from QorIQ-SDK-V1.4-20130625-yocto, just
a minor modification to port 3.4 kernel]
Signed-off-by: Wei Yang <Wei.Yang@windriver.com>
---
 arch/powerpc/boot/dts/fsl/p1023si-post.dtsi |  121 +++++++++-
 arch/powerpc/boot/dts/fsl/p1023si-pre.dtsi  |    1 +
 arch/powerpc/boot/dts/fsl/p3041si-post.dtsi |    8 +-
 arch/powerpc/boot/dts/fsl/p5020si-post.dtsi |    6 -
 arch/powerpc/boot/dts/fsl/p5020si-pre.dtsi  |    3 +
 arch/powerpc/boot/dts/fsl/t4240si-post.dtsi |    5 +
 arch/powerpc/boot/dts/p1023rds.dts          |   39 +++-
 arch/powerpc/boot/dts/p2041rdb.dts          |    2 +-
 arch/powerpc/boot/dts/p3041ds.dts           |  112 ++++----
 arch/powerpc/boot/dts/p4080ds.dts           |  207 +++++++--------
 arch/powerpc/boot/dts/p5020ds.dts           |  112 ++++----
 arch/powerpc/boot/dts/p5040ds.dts           |  302 ++++++++++-----------
 arch/powerpc/boot/dts/t4240qds.dts          |  381 ++++++++++++---------------
 13 files changed, 699 insertions(+), 600 deletions(-)

diff --git a/arch/powerpc/boot/dts/fsl/p1023si-post.dtsi b/arch/powerpc/boot/dts/fsl/p1023si-post.dtsi
index 7b98967..9663cd9 100644
--- a/arch/powerpc/boot/dts/fsl/p1023si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p1023si-post.dtsi
@@ -1,7 +1,7 @@
 /*
  * P1023/P1017 Silicon/SoC Device Tree Source (post include)
  *
- * Copyright 2011 Freescale Semiconductor Inc.
+ * Copyright 2011-2012 Freescale Semiconductor Inc.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions are met:
@@ -290,4 +290,123 @@
 		reg = <0xe0000 0x1000>;
 		fsl,has-rstcr;
 	};
+
+	fman0: fman@100000 {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		cell-index = <0>;
+		compatible = "fsl,fman", "simple-bus";
+		ranges = <0 0x100000 0x100000>;
+		reg = <0x100000 0x100000>;
+		clock-frequency = <0>;
+		interrupts = <
+			24 2 0 0
+			16 2 0 0>;
+		cc@0 {
+			compatible = "fsl,fman-cc";
+		};
+		muram@0 {
+			compatible = "fsl,fman-muram";
+			reg = <0x0 0x10000>;
+		};
+		bmi@80000 {
+			compatible = "fsl,fman-bmi";
+			reg = <0x80000 0x400>;
+		};
+		qmi@80400 {
+			compatible = "fsl,fman-qmi";
+			reg = <0x80400 0x400>;
+		};
+		policer@c0000 {
+			compatible = "fsl,fman-policer";
+			reg = <0xc0000 0x1000>;
+		};
+		keygen@c1000 {
+			compatible = "fsl,fman-keygen";
+			reg = <0xc1000 0x1000>;
+		};
+		dma@c2000 {
+			compatible = "fsl,fman-dma";
+			reg = <0xc2000 0x1000>;
+		};
+		fpm@c3000 {
+			compatible = "fsl,fman-fpm";
+			reg = <0xc3000 0x1000>;
+		};
+		parser@c7000 {
+			compatible = "fsl,fman-parser";
+			reg = <0xc7000 0x1000>;
+		};
+		fman0_rx0: port@88000 {
+			cell-index = <0>;
+			compatible = "fsl,fman-port-1g-rx";
+			reg = <0x88000 0x1000>;
+		};
+		fman0_rx1: port@89000 {
+			cell-index = <1>;
+			compatible = "fsl,fman-port-1g-rx";
+			reg = <0x89000 0x1000>;
+		};
+		fman0_tx0: port@a8000 {
+			cell-index = <0>;
+			compatible = "fsl,fman-port-1g-tx";
+			reg = <0xa8000 0x1000>;
+			fsl,qman-channel-id = <0x40>;
+		};
+		fman0_tx1: port@a9000 {
+			cell-index = <1>;
+			compatible = "fsl,fman-port-1g-tx";
+			reg = <0xa9000 0x1000>;
+			fsl,qman-channel-id = <0x41>;
+		};
+		fman0_oh1: port@82000 {
+			cell-index = <1>;
+			compatible = "fsl,fman-port-oh";
+			reg = <0x82000 0x1000>;
+			fsl,qman-channel-id = <0x43>;
+		};
+		fman0_oh2: port@83000 {
+			cell-index = <2>;
+			compatible = "fsl,fman-port-oh";
+			reg = <0x83000 0x1000>;
+			fsl,qman-channel-id = <0x44>;
+		};
+		fman0_oh3: port@84000 {
+			cell-index = <3>;
+			compatible = "fsl,fman-port-oh";
+			reg = <0x84000 0x1000>;
+			fsl,qman-channel-id = <0x45>;
+		};
+		fman0_oh4: port@85000 {
+			cell-index = <4>;
+			compatible = "fsl,fman-port-oh";
+			reg = <0x85000 0x1000>;
+			fsl,qman-channel-id = <0x46>;
+		};
+		enet0: ethernet@e0000 {
+			cell-index = <0>;
+			compatible = "fsl,fman-1g-mac";
+			reg = <0xe0000 0x1000>;
+			fsl,port-handles = <&fman0_rx0 &fman0_tx0>;
+			ptimer-handle = <&ptp_timer0>;
+		};
+		enet1: ethernet@e2000 {
+			cell-index = <1>;
+			compatible = "fsl,fman-1g-mac";
+			reg = <0xe2000 0x1000>;
+			fsl,port-handles = <&fman0_rx1 &fman0_tx1>;
+			ptimer-handle = <&ptp_timer0>;
+		};
+		mdio0: mdio@e1120 {
+			#address-cells = <1>;
+			#size-cells = <0>;
+			compatible = "fsl,fman-mdio";
+			reg = <0xe1120 0xee0>;
+			interrupts = <26 1 0 0>;
+		};
+		ptp_timer0: rtc@fe000 {
+			compatible = "fsl,fman-rtc";
+			reg = <0xfe000 0x1000>;
+		};
+	};
 };
diff --git a/arch/powerpc/boot/dts/fsl/p1023si-pre.dtsi b/arch/powerpc/boot/dts/fsl/p1023si-pre.dtsi
index 398df70..d07fdc2 100644
--- a/arch/powerpc/boot/dts/fsl/p1023si-pre.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p1023si-pre.dtsi
@@ -61,6 +61,7 @@
 
 		qman = &qman;
 		bman = &bman;
+		fman0 = &fman0;
 	};
 
 	cpus {
diff --git a/arch/powerpc/boot/dts/fsl/p3041si-post.dtsi b/arch/powerpc/boot/dts/fsl/p3041si-post.dtsi
index da39c2b..7c56b8e 100644
--- a/arch/powerpc/boot/dts/fsl/p3041si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p3041si-post.dtsi
@@ -442,6 +442,10 @@
 /include/ "qoriq-duart-0.dtsi"
 /include/ "qoriq-duart-1.dtsi"
 /include/ "qoriq-gpio-0.dtsi"
+/include/ "qoriq-rman-0.dtsi"
+	rman: rman@1e0000 {
+		fsl,qman-channels-id = <0x62 0x63>;
+	};
 /include/ "qoriq-usb2-mph-0.dtsi"
 	usb0: usb@210000 {
 		compatible = "fsl-usb2-mph-v1.6", "fsl-usb2-mph";
@@ -475,10 +479,6 @@ crypto: crypto@300000 {
 		fsl,iommu-parent = <&pamu1>;
 	};
 /include/ "qoriq-pme-0.dtsi"
-/include/ "qoriq-rman-0.dtsi"
-	rman: rman@1e0000 {
-		fsl,qman-channels-id = <0x62 0x63>;
-	};
 
 /include/ "qoriq-qman1.dtsi"
 /include/ "qoriq-bman1.dtsi"
diff --git a/arch/powerpc/boot/dts/fsl/p5020si-post.dtsi b/arch/powerpc/boot/dts/fsl/p5020si-post.dtsi
index f3368dc..16310a0 100644
--- a/arch/powerpc/boot/dts/fsl/p5020si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p5020si-post.dtsi
@@ -464,14 +464,8 @@
 		fsl,iommu-parent = <&pamu1>;
 	};
 /include/ "qoriq-pme-0.dtsi"
-/include/ "qoriq-rman-0.dtsi"
-	rman: rman@1e0000 {
-		fsl,qman-channels-id = <0x62 0x63>;
-	};
-
 /include/ "qoriq-qman1.dtsi"
 /include/ "qoriq-bman1.dtsi"
-
 /include/ "qoriq-fman-0.dtsi"
 /include/ "qoriq-fman-0-1g-0.dtsi"
 /include/ "qoriq-fman-0-1g-1.dtsi"
diff --git a/arch/powerpc/boot/dts/fsl/p5020si-pre.dtsi b/arch/powerpc/boot/dts/fsl/p5020si-pre.dtsi
index 87e169b..5b9e9f9 100644
--- a/arch/powerpc/boot/dts/fsl/p5020si-pre.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p5020si-pre.dtsi
@@ -74,8 +74,11 @@
 		rtic_d = &rtic_d;
 		sec_mon = &sec_mon;
 
+		rman = &rman;
+		pme = &pme;
 		qman = &qman;
 		bman = &bman;
+		fman0 = &fman0;
 
 		raideng = &raideng;
 		raideng_jr0 = &raideng_jr0;
diff --git a/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi b/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
index a609949..c8a18ac 100644
--- a/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
@@ -318,6 +318,10 @@
 /include/ "qoriq-qman2-portals.dtsi"
 };
 
+&lportals {
+/include/ "interlaken-lac-portals.dtsi"
+};
+
 &soc {
 	#address-cells = <1>;
 	#size-cells = <1>;
@@ -555,6 +559,7 @@
 		};
 /include/ "qoriq-sata2-0.dtsi"
 /include/ "qoriq-sata2-1.dtsi"
+/include/ "interlaken-lac.dtsi"
 /include/ "qoriq-dce-0.dtsi"
 /include/ "qoriq-pme-0.dtsi"
 
diff --git a/arch/powerpc/boot/dts/p1023rds.dts b/arch/powerpc/boot/dts/p1023rds.dts
index beb6cb1..17d2f77 100644
--- a/arch/powerpc/boot/dts/p1023rds.dts
+++ b/arch/powerpc/boot/dts/p1023rds.dts
@@ -1,7 +1,7 @@
 /*
  * P1023 RDS Device Tree Source
  *
- * Copyright 2010-2011 Freescale Semiconductor Inc.
+ * Copyright 2010-2012 Freescale Semiconductor Inc.
  *
  * Author: Roy Zang <tie-fei.zang@freescale.com>
  *
@@ -43,6 +43,11 @@
 	#size-cells = <2>;
 	interrupt-parent = <&mpic>;
 
+	aliases {
+		ethernet0 = &enet0;
+		ethernet1 = &enet1;
+	};
+
 	memory {
 		device_type = "memory";
 	};
@@ -83,6 +88,25 @@
 			dr_mode = "host";
 			phy_type = "ulpi";
 		};
+
+		fman0: fman@100000 {
+			enet0: ethernet@e0000 {
+				phy-handle = <&phy0>;
+				phy-connection-type = "rgmii";
+			};
+			enet1: ethernet@e2000 {
+				phy-handle = <&phy1>;
+				phy-connection-type = "rgmii";
+			};
+			mdio0: mdio@e1120 {
+				phy0: ethernet-phy@2 {
+					reg = <0x02>;
+				};
+				phy1: ethernet-phy@7 {
+					reg = <0x07>;
+				};
+			};
+		};
 	};
 
 	lbc: localbus@ff605000 {
@@ -214,6 +238,19 @@
 				  0x0 0x100000>;
 		};
 	};
+
+	fsl,dpaa {
+		compatible = "fsl,p1023-dpaa", "fsl,dpaa";
+
+		ethernet@0 {
+			compatible = "fsl,p1023-dpa-ethernet", "fsl,dpa-ethernet";
+			fsl,fman-mac = <&enet0>;
+		};
+		ethernet@1 {
+			compatible = "fsl,p1023-dpa-ethernet", "fsl,dpa-ethernet";
+			fsl,fman-mac = <&enet1>;
+		};
+	};
 };
 
 /include/ "fsl/p1023si-post.dtsi"
diff --git a/arch/powerpc/boot/dts/p2041rdb.dts b/arch/powerpc/boot/dts/p2041rdb.dts
index f49eac4..b346b44 100644
--- a/arch/powerpc/boot/dts/p2041rdb.dts
+++ b/arch/powerpc/boot/dts/p2041rdb.dts
@@ -1,7 +1,7 @@
 /*
  * P2041RDB Device Tree Source
  *
- * Copyright 2011 Freescale Semiconductor Inc.
+ * Copyright 2011-2012 Freescale Semiconductor Inc.
  *
  * Redistribution and use in source and binary forms, with or without
  * modification, are permitted provided that the following conditions are met:
diff --git a/arch/powerpc/boot/dts/p3041ds.dts b/arch/powerpc/boot/dts/p3041ds.dts
index 00b4dee..93e6261 100644
--- a/arch/powerpc/boot/dts/p3041ds.dts
+++ b/arch/powerpc/boot/dts/p3041ds.dts
@@ -144,60 +144,6 @@
 					reg = <0x8>;
 					device_type = "tbi-phy";
 				};
-
-				/*
-				 * Virtual MDIO for the two on-board RGMII
-				 * ports.  The fsl,hydra-mdio-muxval property
-				 * is already correct.
-				 */
-				hydra_mdio_rgmii: hydra-mdio-rgmii {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					fsl,hydra-mdio-muxval = <0x00>;
-					status = "disabled";
-
-					phy_rgmii_0: ethernet-phy@0 {
-						reg = <0x0>;
-					};
-					phy_rgmii_1: ethernet-phy@1 {
-						reg = <0x1>;
-					};
-				};
-
-				/*
-				 * Virtual MDIO for the four-port SGMII card.
-				 * The fsl,hydra-mdio-muxval property will be
-				 * fixed-up by U-Boot based on the slot that
-				 * the SGMII card is in.
-				 *
-				 * Note: we do not support DTSEC5 connected to
-				 * SGMII, so this is the only SGMII node.
-				 */
-				hydra_mdio_sgmii: hydra-mdio-sgmii {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					fsl,hydra-mdio-muxval = <0x00>;
-					status = "disabled";
-
-					phy_sgmii_1c: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy_sgmii_1d: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy_sgmii_1e: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy_sgmii_1f: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
 			};
 
 			enet1: ethernet@e2000 {
@@ -407,8 +353,66 @@
 		};
 
 		board-control@3,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
 			compatible = "fsl,p3041ds-fpga", "fsl,fpga-ngpixis";
 			reg = <3 0 0x30>;
+			ranges = <0 3 0 0x30>;
+
+			mdio-mux-emi1 {
+				compatible = "mdio-mux-mmioreg", "mdio-mux";
+				mdio-parent-bus = <&mdio0>;
+				#address-cells = <1>;
+				#size-cells = <0>;
+				reg = <9 1>; // BRDCFG1
+				mux-mask = <0x78>; // EMI1
+
+				/*
+				 * Virtual MDIO for the two on-board RGMII
+				 * ports.  The reg property is already correct.
+				 */
+				hydra_mdio_rgmii: rgmii-mdio@8 {
+					status = "disabled";
+					reg = <8>; /* EMI1_EN | 0 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+
+					phy_rgmii_0: ethernet-phy@0 {
+						reg = <0x0>;
+					};
+					phy_rgmii_1: ethernet-phy@1 {
+						reg = <0x1>;
+					};
+				};
+				/*
+				 * Virtual MDIO for the four-port SGMII card.
+				 * The reg property will be fixed-up
+				 * by U-Boot based on the slot that
+				 * the SGMII card is in.
+				 *
+				 * Note: we do not support DTSEC5 connected to
+				 * SGMII, so this is the only SGMII node.
+				 */
+				hydra_mdio_sgmii: sgmii-mdio@28 {
+					reg = <0x28>; /* EMI1_EN | 0x20 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy_sgmii_1c: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					phy_sgmii_1d: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					phy_sgmii_1e: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					phy_sgmii_1f: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+			};
 		};
 	};
 
diff --git a/arch/powerpc/boot/dts/p4080ds.dts b/arch/powerpc/boot/dts/p4080ds.dts
index df81a19..b348c98 100644
--- a/arch/powerpc/boot/dts/p4080ds.dts
+++ b/arch/powerpc/boot/dts/p4080ds.dts
@@ -151,89 +151,10 @@
 			};
 
 			mdio0: mdio@e1120 {
-				gpios = <&gpio0 0 0
-					 &gpio0 1 0>;
-
 				tbi0: tbi-phy@8 {
 					reg = <0x8>;
 					device_type = "tbi-phy";
 				};
-
-				p4080mdio0: p4080ds-mdio0 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,p4080ds-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,muxval = <0>;
-
-					phyrgmii: ethernet-phy@0 {
-						reg = <0x0>;
-					};
-				};
-
-				p4080mdio1: p4080ds-mdio1 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,p4080ds-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,muxval = <1>;
-
-					phy5: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy6: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy7: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy8: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
-
-				p4080mdio2: p4080ds-mdio2 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,p4080ds-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,muxval = <2>;
-					status = "disabled";
-
-					phy5slot3: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy6slot3: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy7slot3: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy8slot3: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
-
-				p4080mdio3: p4080ds-mdio3 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,p4080ds-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,muxval = <3>;
-
-					phy0: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy1: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy2: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy3: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
 			};
 
 			enet1: ethernet@e2000 {
@@ -280,32 +201,6 @@
 			};
 
 			xmdio0: mdio@f1000 {
-				gpios = <&gpio0 2 0
-					 &gpio0 3 0>;
-
-				p4080xmdio1: p4080ds-xmdio1 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,p4080ds-xmdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,muxval = <1>;
-
-					phy11: ethernet-phy@0 {
-						reg = <0x0>;
-					};
-				};
-
-				p4080xmdio3: p4080ds-xmdio3 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,p4080ds-xmdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,muxval = <3>;
-
-					phy10: ethernet-phy@4 {
-						reg = <0x4>;
-					};
-				};
 			};
 		};
 
@@ -495,6 +390,108 @@
 		};
 	};
 
+	mdio-mux-emi1 {
+		compatible = "mdio-mux-gpio";
+		gpios = <&gpio0 0 0>, <&gpio0 1 0>;
+		mdio-parent-bus = <&mdio0>;
+		#address-cells = <1>;
+		#size-cells = <0>;
+
+		p4080mdio0: mdio@0 {
+			reg = <0>;
+			#address-cells = <1>;
+			#size-cells = <0>;
+
+			phyrgmii: ethernet-phy@0 {
+				reg = <0x0>;
+			};
+		};
+
+		p4080mdio1: mdio@1 {
+			reg = <1>;
+			#address-cells = <1>;
+			#size-cells = <0>;
+
+			phy5: ethernet-phy@1c {
+				reg = <0x1c>;
+			};
+			phy6: ethernet-phy@1d {
+				reg = <0x1d>;
+			};
+			phy7: ethernet-phy@1e {
+				reg = <0x1e>;
+			};
+			phy8: ethernet-phy@1f {
+				reg = <0x1f>;
+			};
+		};
+
+		p4080mdio2: mdio@2 {
+			reg = <2>;
+			#address-cells = <1>;
+			#size-cells = <0>;
+			status = "disabled";
+
+			phy5slot3: ethernet-phy@1c {
+				reg = <0x1c>;
+			};
+			phy6slot3: ethernet-phy@1d {
+				reg = <0x1d>;
+			};
+			phy7slot3: ethernet-phy@1e {
+				reg = <0x1e>;
+			};
+			phy8slot3: ethernet-phy@1f {
+				reg = <0x1f>;
+			};
+		};
+
+		p4080mdio3: mdio@3 {
+			reg = <3>;
+			#address-cells = <1>;
+			#size-cells = <0>;
+
+			phy0: ethernet-phy@1c {
+				reg = <0x1c>;
+			};
+			phy1: ethernet-phy@1d {
+				reg = <0x1d>;
+			};
+			phy2: ethernet-phy@1e {
+				reg = <0x1e>;
+			};
+			phy3: ethernet-phy@1f {
+				reg = <0x1f>;
+			};
+		};
+	};
+	mdio-mux-emi2 {
+		compatible = "mdio-mux-gpio";
+		gpios = <&gpio0 2 0>, <&gpio0 3 0>;
+		mdio-parent-bus = <&xmdio0>;
+		#address-cells = <1>;
+		#size-cells = <0>;
+
+		p4080xmdio1: mdio@1 {
+			reg = <1>;
+			#address-cells = <1>;
+			#size-cells = <0>;
+
+			phy11: ethernet-phy@0 {
+				reg = <0x0>;
+			};
+		};
+
+		p4080xmdio3: mdio@3 {
+			reg = <3>;
+			#address-cells = <1>;
+			#size-cells = <0>;
+
+			phy10: ethernet-phy@4 {
+				reg = <0x4>;
+			};
+		};
+	};
 	fsl,dpaa {
 		compatible = "fsl,p4080-dpaa", "fsl,dpaa";
 
diff --git a/arch/powerpc/boot/dts/p5020ds.dts b/arch/powerpc/boot/dts/p5020ds.dts
index ef94c58..d4a5d8c 100644
--- a/arch/powerpc/boot/dts/p5020ds.dts
+++ b/arch/powerpc/boot/dts/p5020ds.dts
@@ -144,60 +144,6 @@
 					reg = <0x8>;
 					device_type = "tbi-phy";
 				};
-
-				/*
-				 * Virtual MDIO for the two on-board RGMII
-				 * ports.  The fsl,hydra-mdio-muxval property
-				 * is already correct.
-				 */
-				hydra_mdio_rgmii: hydra-mdio-rgmii {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					fsl,hydra-mdio-muxval = <0x00>;
-					status = "disabled";
-
-					phy_rgmii_0: ethernet-phy@0 {
-						reg = <0x0>;
-					};
-					phy_rgmii_1: ethernet-phy@1 {
-						reg = <0x1>;
-					};
-				};
-
-				/*
-				 * Virtual MDIO for the four-port SGMII card.
-				 * The fsl,hydra-mdio-muxval property will be
-				 * fixed-up by U-Boot based on the slot that
-				 * the SGMII card is in.
-				 *
-				 * Note: we do not support DTSEC5 connected to
-				 * SGMII, so this is the only SGMII node.
-				 */
-				hydra_mdio_sgmii: hydra-mdio-sgmii {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					fsl,hydra-mdio-muxval = <0x00>;
-					status = "disabled";
-
-					phy_sgmii_1c: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy_sgmii_1d: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy_sgmii_1e: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy_sgmii_1f: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
 			};
 
 			enet1: ethernet@e2000 {
@@ -408,8 +354,66 @@
 		};
 
 		board-control@3,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
 			compatible = "fsl,p5020ds-fpga", "fsl,fpga-ngpixis";
 			reg = <3 0 0x30>;
+			ranges = <0 3 0 0x30>;
+
+			mdio-mux-emi1 {
+				compatible = "mdio-mux-mmioreg", "mdio-mux";
+				mdio-parent-bus = <&mdio0>;
+				#address-cells = <1>;
+				#size-cells = <0>;
+				reg = <9 1>; // BRDCFG1
+				mux-mask = <0x78>; // EMI1
+
+				/*
+				 * Virtual MDIO for the two on-board RGMII
+				 * ports.  The reg property is already correct.
+				 */
+				hydra_mdio_rgmii: rgmii-mdio@8 {
+					status = "disabled";
+					reg = <8>; /* EMI1_EN | 0 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+
+					phy_rgmii_0: ethernet-phy@0 {
+						reg = <0x0>;
+					};
+					phy_rgmii_1: ethernet-phy@1 {
+						reg = <0x1>;
+					};
+				};
+				/*
+				 * Virtual MDIO for the four-port SGMII card.
+				 * The reg property will be fixed-up
+				 * by U-Boot based on the slot that
+				 * the SGMII card is in.
+				 *
+				 * Note: we do not support DTSEC5 connected to
+				 * SGMII, so this is the only SGMII node.
+				 */
+				hydra_mdio_sgmii: sgmii-mdio@28 {
+					reg = <0x28>; /* EMI1_EN | 0x20 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy_sgmii_1c: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					phy_sgmii_1d: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					phy_sgmii_1e: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					phy_sgmii_1f: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+			};
 		};
 	};
 
diff --git a/arch/powerpc/boot/dts/p5040ds.dts b/arch/powerpc/boot/dts/p5040ds.dts
index d8fcba1..4f7bf80 100644
--- a/arch/powerpc/boot/dts/p5040ds.dts
+++ b/arch/powerpc/boot/dts/p5040ds.dts
@@ -166,128 +166,6 @@
 					reg = <0x8>;
 					device_type = "tbi-phy";
 				};
-
-				/*
-				 * Virtual MDIO for the two on-board RGMII
-				 * ports.  The fsl,hydra-mdio-muxval property
-				 * is already correct.
-				 */
-				hydra_rg: hydra-rg {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-val = <0x08>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					status = "disabled";
-
-					phy_rgmii_0: ethernet-phy@0 {
-						reg = <0x0>;
-					};
-					phy_rgmii_1: ethernet-phy@1 {
-						reg = <0x1>;
-					};
-				};
-
-				/*
-				 * Virtual MDIO for the four-port SGMII cards.
-				 */
-
-				/* This for Slot 2 */
-				hydra_sg_slot2: hydra-sg-slot2 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-val = <0x28>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					status = "disabled";
-
-					phy_sgmii_slot2_1c: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy_sgmii_slot2_1d: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy_sgmii_slot2_1e: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy_sgmii_slot2_1f: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
-
-				/* This for Slot 3 */
-				hydra_sg_slot3: hydra-sg-slot3 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-val = <0x68>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					status = "disabled";
-
-					phy_sgmii_slot3_1c: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy_sgmii_slot3_1d: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy_sgmii_slot3_1e: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy_sgmii_slot3_1f: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
-
-				/* This for Slot 5 */
-				hydra_sg_slot5: hydra-sg-slot5 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-val = <0x38>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					status = "disabled";
-
-					phy_sgmii_slot5_1c: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy_sgmii_slot5_1d: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy_sgmii_slot5_1e: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy_sgmii_slot5_1f: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
-
-				/* This for Slot 6 */
-				hydra_sg_slot6: hydra-sg-slot6 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,hydra-mdio-mux-val = <0x48>;
-					fsl,hydra-mdio-mux-mask = <0x70>;
-					status = "disabled";
-
-					phy_sgmii_slot6_1c: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					phy_sgmii_slot6_1d: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					phy_sgmii_slot6_1e: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					phy_sgmii_slot6_1f: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
 			};
 
 			fm1dtsec2: ethernet@e2000 {
@@ -346,46 +224,8 @@
 				phy-connection-type = "xgmii";
 			};
 
-			/*
-			 * We only support one XAUI card, so the MDIO muxing
-			 * is set by U-Boot, and Linux never touches it.
-			 * Therefore, we don't need a virtual MDIO node.
-			 * However, the phy address depends on the slot, so
-			 * only one of the ethernet-phy nodes below will be
-			 * used.
-			 */
 			xmdio0: mdio@f1000 {
-				/* FM2 10GEC1 is always on slot 1 */
-				hydra_xg_slot1: hydra-xg-slot1 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-xmdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,hydra-mdio-mux-val = <0x00>;
-					fsl,hydra-mdio-mux-mask = <0x06>;
-					status = "disabled";
-
-					phy_xgmii_slot_1: ethernet-phy@0 {
-						reg = <4>;
-					};
-				};
-
-				/* FM1 10GEC1 is always on slot 2 */
-				hydra_xg_slot2: hydra-xg-slot2 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,hydra-xmdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,hydra-mdio-mux-val = <0x02>;
-					fsl,hydra-mdio-mux-mask = <0x06>;
-					status = "disabled";
-
-					phy_xgmii_slot_2: ethernet-phy@4 {
-						reg = <0>;
-					};
-				};
 			};
-
 		};
 
 		fman1: fman@500000 {
@@ -562,8 +402,148 @@
 		};
 
 		board-control@3,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
 			compatible = "fsl,p5040ds-fpga", "fsl,fpga-ngpixis";
-			reg = <3 0 0x40>;
+			reg = <3 0 0x30>;
+			ranges = <0 3 0 0x30>;
+
+			mdio-mux-emi1 {
+				compatible = "mdio-mux-mmioreg", "mdio-mux";
+				mdio-parent-bus = <&mdio0>;
+				#address-cells = <1>;
+				#size-cells = <0>;
+				reg = <9 1>; // BRDCFG1
+				mux-mask = <0x78>; // EMI1
+
+				/*
+				 * Virtual MDIO for the two on-board RGMII
+				 * ports.  The reg property is already correct.
+				 */
+				hydra_rg: rgmii-mdio@8 {
+					status = "disabled";
+					reg = <8>; /* EMI1_EN | 0 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+
+					phy_rgmii_0: ethernet-phy@0 {
+						reg = <0x0>;
+					};
+					phy_rgmii_1: ethernet-phy@1 {
+						reg = <0x1>;
+					};
+				};
+				/*
+				 * Virtual MDIO for the four-port SGMII cards.
+				 */
+				hydra_sg_slot2: sgmii-mdio@28 {
+					reg = <0x28>; /* EMI1_EN | 0x20 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy_sgmii_slot2_1c: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					phy_sgmii_slot2_1d: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					phy_sgmii_slot2_1e: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					phy_sgmii_slot2_1f: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+				hydra_sg_slot3: sgmii-mdio@68 {
+					reg = <0x68>; /* EMI1_EN | 0x60 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy_sgmii_slot3_1c: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					phy_sgmii_slot3_1d: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					phy_sgmii_slot3_1e: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					phy_sgmii_slot3_1f: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+				hydra_sg_slot5: sgmii-mdio@38 {
+					reg = <0x38>; /* EMI1_EN | 0x30 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy_sgmii_slot5_1c: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					phy_sgmii_slot5_1d: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					phy_sgmii_slot5_1e: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					phy_sgmii_slot5_1f: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+				hydra_sg_slot6: sgmii-mdio@48 {
+					reg = <0x48>; /* EMI1_EN | 0x40 */
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy_sgmii_slot6_1c: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					phy_sgmii_slot6_1d: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					phy_sgmii_slot6_1e: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					phy_sgmii_slot6_1f: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+			};
+			mdio-mux-emi2 {
+				compatible = "mdio-mux-mmioreg", "mdio-mux";
+				mdio-parent-bus = <&xmdio0>;
+				#address-cells = <1>;
+				#size-cells = <0>;
+				reg = <9 1>; // BRDCFG1
+				mux-mask = <0x06>; // EMI2
+
+				/* FM2 10GEC1 is always on slot 1 */
+				hydra_xg_slot1: hydra-xg-slot1@0 {
+					#address-cells = <1>;
+					#size-cells = <0>;
+					reg = <0>;
+					status = "disabled";
+
+					phy_xgmii_slot_1: ethernet-phy@0 {
+						reg = <4>;
+					};
+				};
+
+				/* FM1 10GEC1 is always on slot 2 */
+				hydra_xg_slot2: hydra-xg-slot2@2 {
+					#address-cells = <1>;
+					#size-cells = <0>;
+					reg = <2>;
+
+					phy_xgmii_slot_2: ethernet-phy@4 {
+						reg = <0>;
+					};
+				};
+			};
 		};
 	};
 
diff --git a/arch/powerpc/boot/dts/t4240qds.dts b/arch/powerpc/boot/dts/t4240qds.dts
index 741f9b4..2f1e2dc 100644
--- a/arch/powerpc/boot/dts/t4240qds.dts
+++ b/arch/powerpc/boot/dts/t4240qds.dts
@@ -69,11 +69,6 @@
 		emi1_slot2 = &t4240mdio2;
 		emi1_slot3 = &t4240mdio3;
 		emi1_slot4 = &t4240mdio4;
-		emi2_xauislot1 = &t4240xmdio1;
-		emi2_xauislot2 = &t4240xmdio2;
-		emi2_xauislot3 = &t4240xmdio3;
-		emi2_xauislot4 = &t4240xmdio4;
-		emi2_xfislot3 = &t4240xmdio3_xfi;
 	};
 
 	ifc: localbus@ffe124000 {
@@ -177,8 +172,164 @@
 		};
 
 		board-control@3,0 {
+			#address-cells = <1>;
+			#size-cells = <1>;
 			compatible = "fsl,tetra-fpga", "fsl,fpga-qixis";
 			reg = <3 0 0x300>;
+			ranges = <0 3 0 0x300>;
+			mdio-mux-emi1 {
+				compatible = "mdio-mux-mmioreg", "mdio-mux";
+				mdio-parent-bus = <&mdio0>;
+				#address-cells = <1>;
+				#size-cells = <0>;
+				reg = <0x54 1>; // BRDCFG1
+				mux-mask = <0xe0>; // EMI1
+
+				/* Onboard PHYs */
+				t4240mdio0: mdio@0 {
+					reg = <0>;
+					#address-cells = <1>;
+					#size-cells = <0>;
+
+					phyrgmii1: ethernet-phy@1 { /* FM2.5 */
+						reg = <0x1>;
+					};
+					phyrgmii2: ethernet-phy@2 { /* FM1.5 */
+						reg = <0x2>;
+					};
+				};
+
+				/* Slot 1 */
+				t4240mdio1: mdio@20 {
+					reg = <0x20>;
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy1: ethernet-phy@0 {
+						reg = <0x0>;
+					};
+					phy2: ethernet-phy@1 {
+						reg = <0x1>;
+					};
+					phy3: ethernet-phy@2 {
+						reg = <0x2>;
+					};
+					phy4: ethernet-phy@3 {
+						reg = <0x3>;
+					};
+					sgmiiphy11: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					sgmiiphy12: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					sgmiiphy13: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					sgmiiphy14: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+
+				/* Slot 2 */
+				t4240mdio2: mdio@40 {
+					reg = <0x40>;
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy5: ethernet-phy@4 {
+						reg = <0x4>;
+					};
+					phy6: ethernet-phy@5 {
+						reg = <0x5>;
+					};
+					phy7: ethernet-phy@6 {
+						reg = <0x6>;
+					};
+					phy8: ethernet-phy@7 {
+						reg = <0x7>;
+					};
+					sgmiiphy21: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					sgmiiphy22: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					sgmiiphy23: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					sgmiiphy24: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+
+				/* Slot 3 */
+				t4240mdio3: mdio@60 {
+					reg = <0x60>;
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy9: ethernet-phy@8 {
+						reg = <0x8>;
+					};
+					phy10: ethernet-phy@9 {
+						reg = <0x9>;
+					};
+					phy11: ethernet-phy@a {
+						reg = <0xa>;
+					};
+					phy12: ethernet-phy@b {
+						reg = <0xb>;
+					};
+					sgmiiphy31: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					sgmiiphy32: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					sgmiiphy33: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					sgmiiphy34: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+
+				t4240mdio4: mdio@80 {
+					reg = <0x80>;
+					#address-cells = <1>;
+					#size-cells = <0>;
+					status = "disabled";
+
+					phy13: ethernet-phy@c {
+						reg = <0xc>;
+					};
+					phy14: ethernet-phy@d {
+						reg = <0xd>;
+					};
+					phy15: ethernet-phy@e {
+						reg = <0xe>;
+					};
+					phy16: ethernet-phy@f {
+						reg = <0xf>;
+						};
+					sgmiiphy41: ethernet-phy@1c {
+						reg = <0x1c>;
+					};
+					sgmiiphy42: ethernet-phy@1d {
+						reg = <0x1d>;
+					};
+					sgmiiphy43: ethernet-phy@1e {
+						reg = <0x1e>;
+					};
+					sgmiiphy44: ethernet-phy@1f {
+						reg = <0x1f>;
+					};
+				};
+			};
 		};
 	};
 
@@ -366,221 +517,25 @@
 			};
 
 			mdio0: mdio@fc000 {
-				/* For 10g interfaces */
-				t4240mdio0: mdio_onboard {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,mdio-muxval = <0>;
-
-					phyrgmii1: ethernet-phy@1 { /* FM2.5 */
-						reg = <0x1>;
-					};
-					phyrgmii2: ethernet-phy@2 { /* FM1.5 */
-						reg = <0x2>;
-					};
-				};
-
-				t4240mdio1: mdio-slot1 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,mdio-muxval = <1>;
-					status = "disabled";
-
-					phy1: ethernet-phy@0 {
-						reg = <0x0>;
-					};
-					phy2: ethernet-phy@1 {
-						reg = <0x1>;
-					};
-					phy3: ethernet-phy@2 {
-						reg = <0x2>;
-					};
-					phy4: ethernet-phy@3 {
-						reg = <0x3>;
-					};
-					sgmiiphy11: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					sgmiiphy12: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					sgmiiphy13: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					sgmiiphy14: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
-
-				t4240mdio2: mdio-slot2 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,mdio-muxval = <2>;
-					status = "disabled";
-
-					phy5: ethernet-phy@4 {
-						reg = <0x4>;
-					};
-					phy6: ethernet-phy@5 {
-						reg = <0x5>;
-					};
-					phy7: ethernet-phy@6 {
-						reg = <0x6>;
-					};
-					phy8: ethernet-phy@7 {
-						reg = <0x7>;
-					};
-					sgmiiphy21: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					sgmiiphy22: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					sgmiiphy23: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					sgmiiphy24: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
-
-				t4240mdio3: mdio-slot3 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,mdio-muxval = <3>;
-					status = "disabled";
-
-					phy9: ethernet-phy@8 {
-						reg = <0x8>;
-					};
-					phy10: ethernet-phy@9 {
-						reg = <0x9>;
-					};
-					phy11: ethernet-phy@a {
-						reg = <0xa>;
-					};
-					phy12: ethernet-phy@b {
-						reg = <0xb>;
-					};
-					sgmiiphy31: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					sgmiiphy32: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					sgmiiphy33: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					sgmiiphy34: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
-
-				t4240mdio4: mdio-slot4 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&mdio0>;
-					fsl,mdio-muxval = <4>;
-					status = "disabled";
-
-					phy13: ethernet-phy@c {
-						reg = <0xc>;
-					};
-					phy14: ethernet-phy@d {
-						reg = <0xd>;
-					};
-					phy15: ethernet-phy@e {
-						reg = <0xe>;
-					};
-					phy16: ethernet-phy@f {
-						reg = <0xf>;
-						};
-					sgmiiphy41: ethernet-phy@1c {
-						reg = <0x1c>;
-					};
-					sgmiiphy42: ethernet-phy@1d {
-						reg = <0x1d>;
-					};
-					sgmiiphy43: ethernet-phy@1e {
-						reg = <0x1e>;
-					};
-					sgmiiphy44: ethernet-phy@1f {
-						reg = <0x1f>;
-					};
-				};
 			};
 
 			xmdio0: mdio@fd000 {
-				/* For 10g interfaces */
-				t4240xmdio1: xmdio-slot1 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,mdio-muxval = <8>;
-
-					xauiphy1: ethernet-phy@0 {
-						compatible = "ethernet-phy-ieee802.3-c45";
-						reg = <0x0>;
-					};
-				};
-
-				t4240xmdio2: xmdio-slot2 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,mdio-muxval = <8>;
-
-					xauiphy2: ethernet-phy@1 {
-						compatible = "ethernet-phy-ieee802.3-c45";
-						reg = <0x1>;
-					};
+				xauiphy1: ethernet-phy@0 {
+					compatible = "ethernet-phy-ieee802.3-c45";
+					reg = <0x0>;
 				};
 
-				t4240xmdio3: xmdio-slot3 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,mdio-muxval = <8>;
-
-					xauiphy3: ethernet-phy@2 {
-						compatible = "ethernet-phy-ieee802.3-c45";
-						reg = <0x2>;
-					};
+				xauiphy2: ethernet-phy@1 {
+					compatible = "ethernet-phy-ieee802.3-c45";
+					reg = <0x1>;
 				};
-
-				t4240xmdio4: xmdio-slot4 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,mdio-muxval = <8>;
-
-					xauiphy4: ethernet-phy@3 {
-						compatible = "ethernet-phy-ieee802.3-c45";
-						reg = <0x3>;
-					};
+				xauiphy3: ethernet-phy@2 {
+					compatible = "ethernet-phy-ieee802.3-c45";
+					reg = <0x2>;
 				};
-
-				t4240xmdio3_xfi: xmdio_xfi_slot3 {
-					#address-cells = <1>;
-					#size-cells = <0>;
-					compatible = "fsl,tetra-mdio";
-					fsl,mdio-handle = <&xmdio0>;
-					fsl,mdio-muxval = <8>;
-					status = "disabled";
-
+				xauiphy4: ethernet-phy@3 {
+					compatible = "ethernet-phy-ieee802.3-c45";
+					reg = <0x3>;
 				};
 			};
 
-- 
1.7.5.4

