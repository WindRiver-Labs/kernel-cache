From 4326ad53efe8a4c05f4d873d84792e9e53ca9200 Mon Sep 17 00:00:00 2001
From: Claudiu Manoil <claudiu.manoil@freescale.com>
Date: Thu, 4 Apr 2013 14:05:49 +0300
Subject: [PATCH 282/547] ethtool: Add define for nfc rx-flow hashing based on
 SPI

This define makes it possible to enable hashing of AH or ESP flows
(IPSEC) based on their SPI (Security Parameter Index) field.

Signed-off-by: Pankaj Chauhan <pankaj.chauhan@freescale.com>
Signed-off-by: Claudiu Manoil <claudiu.manoil@freescale.com>
Change-Id: Ifb26f878e34f10ccde72507e157809c1807d00c6
Reviewed-on: http://git.am.freescale.net:8181/1008
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[Original patch taken from QorIQ-SDK-V1.4-SOURCE-20130625-yocto.iso]
Signed-off-by: Bin Jiang <bin.jiang@windriver.com>
---
 include/uapi/linux/ethtool.h | 1 +
 1 file changed, 1 insertion(+)

diff --git a/include/uapi/linux/ethtool.h b/include/uapi/linux/ethtool.h
index 0c9b448..71d84a8 100644
--- a/include/uapi/linux/ethtool.h
+++ b/include/uapi/linux/ethtool.h
@@ -1051,6 +1051,7 @@ enum ethtool_sfeatures_retval_bits {
 #define	RXH_IP_DST	(1 << 5)
 #define	RXH_L4_B_0_1	(1 << 6) /* src port in case of TCP/UDP/SCTP */
 #define	RXH_L4_B_2_3	(1 << 7) /* dst port in case of TCP/UDP/SCTP */
+#define	RXH_AH_ESP_SPI	(1 << 8) /* SPI field, for AH/ESP flows */
 #define	RXH_DISCARD	(1 << 31)
 
 #define	RX_CLS_FLOW_DISC	0xffffffffffffffffULL
-- 
1.8.4.93.g57e4c17

