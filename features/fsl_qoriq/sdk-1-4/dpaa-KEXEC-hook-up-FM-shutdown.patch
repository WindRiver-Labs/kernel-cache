From b6e15135494515bbce227704a84190ffc89c9beb Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Wed, 7 Aug 2013 14:02:56 +0800
Subject: [PATCH 169/430] dpaa/KEXEC: hook up FM shutdown

Signed-off-by: Yongli He <yongli.he@windriver.com>
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 .../freescale/fman/src/wrapper/lnxwrp_fm.c         |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c b/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c
index 9ddbcdd..2c419eb 100644
--- a/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c
+++ b/drivers/net/ethernet/freescale/fman/src/wrapper/lnxwrp_fm.c
@@ -1111,6 +1111,9 @@ static struct platform_driver fm_driver = {
         .owner          = THIS_MODULE,
     },
     .probe          = fm_probe,
+#if defined(CONFIG_KEXEC)
+    .shutdown       = fm_remove,
+#endif    
     .remove         = __devexit_p(fm_remove)
 };
 
-- 
1.7.5.4

