From 021df31efc4bc55a0b41d985d2b4f3bf8eed3571 Mon Sep 17 00:00:00 2001
From: Jiang Lu <lu.jiang@windriver.com>
Date: Mon, 24 Jun 2013 15:05:47 +0800
Subject: [PATCH 143/430] fsl_qman: Remove integration code with the old
 platform PAMU driver

This is to make the ingration patch with the new IOMMU/PAMU driver more
readable

Signed-off-by: Emil Medve <Emilian.Medve@Freescale.com>
Change-Id: Ia8c2acef2f09d0dcbce47cc14f6f9dfbf1f55370
Reviewed-on: http://git.am.freescale.net:8181/1172
Reviewed-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
Tested-by: Fleming Andrew-AFLEMING <AFLEMING@freescale.com>
[Original patch is from QorIQ-SDK-V1.4-20130625-yocto, just
a minor modification to port 3.4 kernel]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 drivers/staging/fsl_qbman/qman_driver.c |   16 ----------------
 1 files changed, 0 insertions(+), 16 deletions(-)

diff --git a/drivers/staging/fsl_qbman/qman_driver.c b/drivers/staging/fsl_qbman/qman_driver.c
index 3315902..7cb096a 100644
--- a/drivers/staging/fsl_qbman/qman_driver.c
+++ b/drivers/staging/fsl_qbman/qman_driver.c
@@ -30,7 +30,6 @@
  */
 
 #include "qman_private.h"
-#include <sysdev/fsl_pamu.h>
 
 /* Global variable containing revision id (even on non-control plane systems
  * where CCSR isn't available) */
@@ -423,24 +422,9 @@ static struct qm_portal_config *get_pcfg(struct list_head *list)
 	return pcfg;
 }
 
-#ifdef CONFIG_FSL_PAMU
-static void portal_set_liodns(const struct qm_portal_config *pcfg, int cpu)
-{
-	unsigned int index = 0;
-	unsigned int liodn_cnt = pamu_get_liodn_count(pcfg->node);
-	while (index < liodn_cnt) {
-		int ret = pamu_set_stash_dest(pcfg->node, index++, cpu, 1);
-		if (ret < 0)
-			pr_warning("Failed to set QMan stashing LIODN\n");
-	}
-}
-#else
-#define portal_set_liodns(pcfg, cpu) do { } while (0)
-#endif
 
 static void portal_set_cpu(const struct qm_portal_config *pcfg, int cpu)
 {
-	portal_set_liodns(pcfg, cpu);
 #ifdef CONFIG_FSL_QMAN_CONFIG
 	if (qman_set_sdest(pcfg->public_cfg.channel, cpu))
 #endif
-- 
1.7.5.4

