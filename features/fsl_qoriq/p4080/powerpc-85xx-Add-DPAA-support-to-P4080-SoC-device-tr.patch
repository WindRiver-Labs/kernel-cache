From ed9d44b770ded58df7f2837d728e59c6c5a2d4fc Mon Sep 17 00:00:00 2001
From: Kumar Gala <galak@kernel.crashing.org>
Date: Thu, 17 Nov 2011 10:43:32 -0600
Subject: [PATCH 1/9] powerpc/85xx: Add DPAA support to P4080 SoC device tree
 files

From QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso

P4080 has PME, QMan, Bman, and a two FMAN instances each with one 10g
port and four 1g ports.

Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
---
 arch/powerpc/boot/dts/fsl/p4080si-post.dtsi |  124 +++++++++++++++++++++++++++
 arch/powerpc/boot/dts/fsl/p4080si-pre.dtsi  |    6 ++
 2 files changed, 130 insertions(+)

diff --git a/arch/powerpc/boot/dts/fsl/p4080si-post.dtsi b/arch/powerpc/boot/dts/fsl/p4080si-post.dtsi
index 8d35d2c..eed88f2 100644
--- a/arch/powerpc/boot/dts/fsl/p4080si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p4080si-post.dtsi
@@ -234,6 +234,14 @@
 
 };
 
+&bportals {
+/include/ "qoriq-bman1-portals.dtsi"
+};
+
+&qportals {
+/include/ "qoriq-qman1-portals.dtsi"
+};
+
 &soc {
 	#address-cells = <1>;
 	#size-cells = <1>;
@@ -347,4 +355,120 @@
 /include/ "qoriq-usb2-mph-0.dtsi"
 /include/ "qoriq-usb2-dr-0.dtsi"
 /include/ "qoriq-sec4.0-0.dtsi"
+/include/ "qoriq-pme-0.dtsi"
+/include/ "qoriq-qman1.dtsi"
+/include/ "qoriq-bman1.dtsi"
+/include/ "qoriq-fman-0.dtsi"
+/include/ "qoriq-fman-0-1g-0.dtsi"
+/include/ "qoriq-fman-0-1g-1.dtsi"
+/include/ "qoriq-fman-0-1g-2.dtsi"
+/include/ "qoriq-fman-0-1g-3.dtsi"
+/include/ "qoriq-fman-0-10g-0.dtsi"
+	fman0: fman@400000 {
+		/* tx - 1g - 0 */
+		port@a8000 {
+			fsl,qman-channel-id = <0x41>;
+		};
+		/* tx - 1g - 1 */
+		port@a9000 {
+			fsl,qman-channel-id = <0x42>;
+		};
+		/* tx - 1g - 2 */
+		port@aa000 {
+			fsl,qman-channel-id = <0x43>;
+		};
+		/* tx - 1g - 3 */
+		port@ab000 {
+			fsl,qman-channel-id = <0x44>;
+		};
+		/* tx - 10g - 0 */
+		port@b0000 {
+			fsl,qman-channel-id = <0x40>;
+		};
+		/* offline 0 */
+		port@81000 {
+			fsl,qman-channel-id = <0x45>;
+		};
+		/* offline 1 */
+		port@82000 {
+			fsl,qman-channel-id = <0x46>;
+		};
+		/* offline 2 */
+		port@83000 {
+			fsl,qman-channel-id = <0x47>;
+		};
+		/* offline 3 */
+		port@84000 {
+			fsl,qman-channel-id = <0x48>;
+		};
+		/* offline 4 */
+		port@85000 {
+			fsl,qman-channel-id = <0x49>;
+		};
+		/* offline 5 */
+		port@86000 {
+			fsl,qman-channel-id = <0x4a>;
+		};
+		/* offline 6 */
+		port@87000 {
+			fsl,qman-channel-id = <0x4b>;
+		};
+	};
+
+/include/ "qoriq-fman-1.dtsi"
+/include/ "qoriq-fman-1-1g-0.dtsi"
+/include/ "qoriq-fman-1-1g-1.dtsi"
+/include/ "qoriq-fman-1-1g-2.dtsi"
+/include/ "qoriq-fman-1-1g-3.dtsi"
+/include/ "qoriq-fman-1-10g-0.dtsi"
+	fman1: fman@500000 {
+		/* tx - 1g - 0 */
+		port@a8000 {
+			fsl,qman-channel-id = <0x61>;
+		};
+		/* tx - 1g - 1 */
+		port@a9000 {
+			fsl,qman-channel-id = <0x62>;
+		};
+		/* tx - 1g - 2 */
+		port@aa000 {
+			fsl,qman-channel-id = <0x63>;
+		};
+		/* tx - 1g - 3 */
+		port@ab000 {
+			fsl,qman-channel-id = <0x64>;
+		};
+		/* tx - 10g - 0 */
+		port@b0000 {
+			fsl,qman-channel-id = <0x60>;
+		};
+		/* offline 0 */
+		port@81000 {
+			fsl,qman-channel-id = <0x65>;
+		};
+		/* offline 1 */
+		port@82000 {
+			fsl,qman-channel-id = <0x66>;
+		};
+		/* offline 2 */
+		port@83000 {
+			fsl,qman-channel-id = <0x67>;
+		};
+		/* offline 3 */
+		port@84000 {
+			fsl,qman-channel-id = <0x68>;
+		};
+		/* offline 4 */
+		port@85000 {
+			fsl,qman-channel-id = <0x69>;
+		};
+		/* offline 5 */
+		port@86000 {
+			fsl,qman-channel-id = <0x6a>;
+		};
+		/* offline 6 */
+		port@87000 {
+			fsl,qman-channel-id = <0x6b>;
+		};
+	};
 };
diff --git a/arch/powerpc/boot/dts/fsl/p4080si-pre.dtsi b/arch/powerpc/boot/dts/fsl/p4080si-pre.dtsi
index 493d9a0..aea2e14 100644
--- a/arch/powerpc/boot/dts/fsl/p4080si-pre.dtsi
+++ b/arch/powerpc/boot/dts/fsl/p4080si-pre.dtsi
@@ -72,6 +72,12 @@
 		rtic_c = &rtic_c;
 		rtic_d = &rtic_d;
 		sec_mon = &sec_mon;
+
+		bman = &bman;
+		qman = &qman;
+		pme = &pme;
+		fman0 = &fman0;
+		fman1 = &fman1;
 	};
 
 	cpus {
-- 
1.7.9.7

