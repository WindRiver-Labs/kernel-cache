From 601c55ae5c7fd42fa25c7416817b9b27ccb27ed1 Mon Sep 17 00:00:00 2001
From: Marian Chereji <marian.chereji@nxp.com>
Date: Thu, 25 Feb 2016 19:14:32 +0200
Subject: [PATCH 1132/1383] crypto: caam - add preheader building functions

Exposed some functions which help users set up certain descriptor
preheaders.

Signed-off-by: Marian Chereji <marian.chereji@nxp.com>
[Original patch taken from QorIQ-SDK-V2.0-20160527-yocto]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/crypto/caam/desc.h | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

diff --git a/drivers/crypto/caam/desc.h b/drivers/crypto/caam/desc.h
index d5866c1..cac5bb2 100644
--- a/drivers/crypto/caam/desc.h
+++ b/drivers/crypto/caam/desc.h
@@ -80,6 +80,28 @@ struct sec4_sg_entry {
 #define CLASS_2			(0x02 << CLASS_SHIFT)
 #define CLASS_BOTH		(0x03 << CLASS_SHIFT)
 
+#define PREHDR_IDLEN_SHIFT	32
+#define PREHDR_OFFSET_SHIFT	26
+#define PREHDR_BPID_SHIFT	16
+#define PREHDR_BSIZE_SHIFT	0
+
+#define PREHDR_IDLEN_MASK	GENMASK_ULL(39,32)
+#define PREHDR_OFFSET_MASK	GENMASK_ULL(27,26)
+#define PREHDR_BPID_MASK	GENMASK_ULL(23,16)
+#define PREHDR_BSIZE_MASK	GENMASK_ULL(15,0)
+
+#define PREHEADER_PREP_IDLEN(preh, idlen) \
+	(preh) |= ((u64)(idlen) << PREHDR_IDLEN_SHIFT) & PREHDR_IDLEN_MASK
+
+#define PREHEADER_PREP_BPID(preh, bpid) \
+	(preh) |= ((u64)(bpid) << PREHDR_BPID_SHIFT) & PREHDR_BPID_MASK
+
+#define PREHEADER_PREP_BSIZE(preh, bufsize) \
+	(preh) |= ((u64)(bufsize) << PREHDR_BSIZE_SHIFT) & PREHDR_BSIZE_MASK
+
+#define PREHEADER_PREP_OFFSET(preh, offs) \
+	(preh) |= ((u64)(offs) << PREHDR_OFFSET_SHIFT) & PREHDR_OFFSET_MASK
+
 /*
  * Descriptor header command constructs
  * Covers shared, job, and trusted descriptor headers
-- 
2.8.1

