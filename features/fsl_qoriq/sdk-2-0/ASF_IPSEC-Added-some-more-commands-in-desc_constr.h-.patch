From 7c771a43704327071fb53ca81714da131379f1bd Mon Sep 17 00:00:00 2001
From: Sandeep Malik <Sandeep.Malik@freescale.com>
Date: Sun, 16 Feb 2014 08:47:15 +0530
Subject: [PATCH 1357/1429] ASF_IPSEC: Added some more commands in
 desc_constr.h to

support 3des-xcbc in ASF

desc_constr.h has been modified to provide commands which
are required to support 3des-xcbc Also added a minor correction
in disassembler of decriptor which caused kernel crash on
printing the descriptor using dis-assembler

CR:ENGR00272350

Signed-off-by: Nipun Gupta <nipun.gupta@freescale.com>
Signed-off-by: Sandeep Malik <Sandeep.Malik@freescale.com>
Change-Id: I7d25e8898f3fd7bdc88b3d689434534c4a017bca
Reviewed-on: http://git.am.freescale.net:8181/8827
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Horia Ioan Geanta Neag <horia.geanta@freescale.com>
Reviewed-by: Jose Rivera <German.Rivera@freescale.com>
(cherry picked from commit 3ea7c1eb6de1ba9431119b8eeb7c71a5aefded25)
[Original patch taken from QorIQ-SDK-V2.0-20160527-yocto]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/crypto/caam/desc.h        |    1 +
 drivers/crypto/caam/desc_constr.h |    2 ++
 2 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/drivers/crypto/caam/desc.h b/drivers/crypto/caam/desc.h
index 29c032f..6b454d4 100644
--- a/drivers/crypto/caam/desc.h
+++ b/drivers/crypto/caam/desc.h
@@ -1551,6 +1551,7 @@ struct sec4_sg_entry {
 #define MATH_SRC1_INFIFO	(0x0a << MATH_SRC1_SHIFT)
 #define MATH_SRC1_OUTFIFO	(0x0b << MATH_SRC1_SHIFT)
 #define MATH_SRC1_ONE		(0x0c << MATH_SRC1_SHIFT)
+#define MATH_SRC1_ZERO		(0x0f << MATH_SRC1_SHIFT)
 
 /* Destination selectors */
 #define MATH_DEST_SHIFT		8
diff --git a/drivers/crypto/caam/desc_constr.h b/drivers/crypto/caam/desc_constr.h
index 3f0d265..560a197 100644
--- a/drivers/crypto/caam/desc_constr.h
+++ b/drivers/crypto/caam/desc_constr.h
@@ -212,6 +212,8 @@ APPEND_CMD_LEN(seq_load, SEQ_LOAD)
 APPEND_CMD_LEN(seq_store, SEQ_STORE)
 APPEND_CMD_LEN(seq_fifo_load, SEQ_FIFO_LOAD)
 APPEND_CMD_LEN(seq_fifo_store, SEQ_FIFO_STORE)
+APPEND_CMD_LEN(seq_out_ptr_pre_rto, SEQ_OUT_PTR)
+APPEND_CMD_LEN(seq_in_ptr_pre_rto, SEQ_IN_PTR)
 
 #define APPEND_CMD_PTR(cmd, op) \
 static inline void append_##cmd(u32 *desc, dma_addr_t ptr, unsigned int len, \
-- 
1.7.5.4

