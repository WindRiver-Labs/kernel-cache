From cd31443dbc97bf50b436ab3165666cd0bbced354 Mon Sep 17 00:00:00 2001
From: Chenhui Zhao <chenhui.zhao@nxp.com>
Date: Fri, 22 Jan 2016 18:15:30 +0800
Subject: [PATCH 0155/1429] powerpc/dts: fix dts related problems

* add the SCFG node to t1040si-post.dtsi
* change t1023 to t1024
* change "fsl,qoriq-rcpm-2.0" to "fsl,qoriq-rcpm-2.1" in t1023si-post.dtsi

Signed-off-by: Chenhui Zhao <chenhui.zhao@nxp.com>
[Original patch taken from QorIQ-SDK-V2.0-20160527-yocto]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 arch/powerpc/boot/dts/fsl/t1023si-post.dtsi |    2 +-
 arch/powerpc/boot/dts/fsl/t1040si-post.dtsi |    5 +++++
 arch/powerpc/platforms/85xx/deepsleep.c     |    4 ++--
 3 files changed, 8 insertions(+), 3 deletions(-)

diff --git a/arch/powerpc/boot/dts/fsl/t1023si-post.dtsi b/arch/powerpc/boot/dts/fsl/t1023si-post.dtsi
index 68c3b02..06c556f 100644
--- a/arch/powerpc/boot/dts/fsl/t1023si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/t1023si-post.dtsi
@@ -439,7 +439,7 @@
 	};
 
 	rcpm: global-utilities@e2000 {
-		compatible = "fsl,t1024-rcpm", "fsl,qoriq-rcpm-2.0";
+		compatible = "fsl,t1024-rcpm", "fsl,qoriq-rcpm-2.1";
 		reg = <0xe2000 0x1000>;
 	};
 
diff --git a/arch/powerpc/boot/dts/fsl/t1040si-post.dtsi b/arch/powerpc/boot/dts/fsl/t1040si-post.dtsi
index 49231ec..848a5ce 100644
--- a/arch/powerpc/boot/dts/fsl/t1040si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/t1040si-post.dtsi
@@ -407,6 +407,11 @@
 		reg	   = <0xea000 0x4000>;
 	};
 
+	scfg: global-utilities@fc000 {
+		compatible = "fsl,t1040-scfg";
+		reg = <0xfc000 0x1000>;
+	};
+
 /include/ "elo3-dma-0.dtsi"
 /include/ "elo3-dma-1.dtsi"
 /include/ "qoriq-espi-0.dtsi"
diff --git a/arch/powerpc/platforms/85xx/deepsleep.c b/arch/powerpc/platforms/85xx/deepsleep.c
index ef10a3b..950e585 100644
--- a/arch/powerpc/platforms/85xx/deepsleep.c
+++ b/arch/powerpc/platforms/85xx/deepsleep.c
@@ -293,7 +293,7 @@ static int __init fsl_dp_iomap(void)
 
 	fsl_dp_priv.ccsr_scfg_base = fsl_of_iomap("fsl,t1040-scfg");
 	if (!fsl_dp_priv.ccsr_scfg_base) {
-		fsl_dp_priv.ccsr_scfg_base = fsl_of_iomap("fsl,t1023-scfg");
+		fsl_dp_priv.ccsr_scfg_base = fsl_of_iomap("fsl,t1024-scfg");
 		if (!fsl_dp_priv.ccsr_scfg_base)
 			goto err;
 	}
@@ -326,7 +326,7 @@ static int __init fsl_dp_iomap(void)
 			fsl_of_iomap("fsl,t1040-l3-cache-controller");
 	if (!fsl_dp_priv.ccsr_cpc_base) {
 		fsl_dp_priv.ccsr_cpc_base =
-			fsl_of_iomap("fsl,t1023-l3-cache-controller");
+			fsl_of_iomap("fsl,t1024-l3-cache-controller");
 		if (!fsl_dp_priv.ccsr_cpc_base)
 			goto err;
 	}
-- 
1.7.5.4

