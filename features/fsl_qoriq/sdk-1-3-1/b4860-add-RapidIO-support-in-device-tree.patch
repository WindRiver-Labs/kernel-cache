From 06aeea525cc88201f527b62b036e243c41830a7c Mon Sep 17 00:00:00 2001
From: Lian Minghuan-B31939 <Minghuan.Lian@freescale.com>
Date: Mon, 22 Oct 2012 17:56:36 +0000
Subject: [PATCH 100/227] b4860: add RapidIO support in device tree

Signed-off-by: Minghuan Lian <Minghuan.Lian@freescale.com>
Signed-off-by: Andy Fleming <afleming@freescale.com>
[Kevin: Original patch taken from fsl sdk 1.3.1
QorIQ-SDK-V1.3.1-SOURCE-20121220-yocto.iso.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/boot/dts/b4860qds.dts          |   12 ++++++++++++
 arch/powerpc/boot/dts/fsl/b4860si-post.dtsi |   20 ++++++++++++++++++++
 2 files changed, 32 insertions(+)

diff --git a/arch/powerpc/boot/dts/b4860qds.dts b/arch/powerpc/boot/dts/b4860qds.dts
index e10f8b2..83e2015 100644
--- a/arch/powerpc/boot/dts/b4860qds.dts
+++ b/arch/powerpc/boot/dts/b4860qds.dts
@@ -204,6 +204,18 @@
 				  0 0x00010000>;
 		};
 	};
+
+	rio: rapidio@ffe0c0000 {
+		reg = <0xf 0xfe0c0000 0 0x11000>;
+
+		port1 {
+			ranges = <0 0 0xc 0x20000000 0 0x10000000>;
+		};
+		port2 {
+			ranges = <0 0 0xc 0x30000000 0 0x10000000>;
+		};
+	};
+
 	fsl,dpaa {
 		compatible = "fsl,b4860-dpaa", "fsl,dpaa";
 		ethernet@0 {
diff --git a/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi b/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
index 0fa7bd0..234241d 100644
--- a/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/b4860si-post.dtsi
@@ -64,6 +64,26 @@
 	};
 };
 
+&rio {
+	compatible = "fsl,srio";
+	interrupts = <16 2 1 11>;
+	#address-cells = <2>;
+	#size-cells = <2>;
+	ranges;
+
+	port1 {
+		#address-cells = <2>;
+		#size-cells = <2>;
+		cell-index = <1>;
+	};
+
+	port2 {
+		#address-cells = <2>;
+		#size-cells = <2>;
+		cell-index = <2>;
+	};
+};
+
 &bportals {
 /include/ "qoriq-bman2-portals.dtsi"
 };
-- 
1.7.9.7

