From 208f051f17dd785c49939a585324c94b9924d673 Mon Sep 17 00:00:00 2001
From: Madalin Bucur <madalin.bucur@freescale.com>
Date: Wed, 28 Nov 2012 12:50:40 +0200
Subject: [PATCH 184/227] dpaa_eth: set fm mac handle

Call fm_mac_set_handle() to set the fm mac handle value in the
FM device structure.

Signed-off-by: Madalin Bucur <madalin.bucur@freescale.com>
[Kevin: Original patch taken from fsl sdk 1.3.1
QorIQ-SDK-V1.3.1-SOURCE-20121220-yocto.iso.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/mac-api.c |    4 ++++
 1 file changed, 4 insertions(+)

diff --git a/drivers/net/ethernet/freescale/dpa/mac-api.c b/drivers/net/ethernet/freescale/dpa/mac-api.c
index bdc2107..caa8d95 100644
--- a/drivers/net/ethernet/freescale/dpa/mac-api.c
+++ b/drivers/net/ethernet/freescale/dpa/mac-api.c
@@ -145,6 +145,10 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 		goto _return;
 	}
 
+	fm_mac_set_handle(mac_dev->fm_dev, priv->mac,
+		(macdev2enetinterface(mac_dev) != e_ENET_MODE_XGMII_10000) ?
+			param.macId : param.macId + FM_MAX_NUM_OF_1G_MACS);
+
 	err = FM_MAC_ConfigMaxFrameLength(priv->mac,
 					  fm_get_max_frm());
 	_errno = -GET_ERROR_TYPE(err);
-- 
1.7.9.7

