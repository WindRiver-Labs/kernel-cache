From 5b911254c25953d642245d078ca136649bc42901 Mon Sep 17 00:00:00 2001
From: Andy Fleming <afleming@freescale.com>
Date: Fri, 16 Nov 2012 00:53:08 -0600
Subject: [PATCH 158/227] Modify bus ID for MDIO buses to include address

The simple name was not enough to distinguish the buses. Add in
the address of the base registers, like for fsl_pq_mdio.

Signed-off-by: Andy Fleming <afleming@freescale.com>
[Kevin: Original patch taken from fsl sdk 1.3.1
QorIQ-SDK-V1.3.1-SOURCE-20121220-yocto.iso.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/memac_mdio.c |    2 +-
 drivers/net/ethernet/freescale/dpa/xgmac_mdio.c |    2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/memac_mdio.c b/drivers/net/ethernet/freescale/dpa/memac_mdio.c
index 6fe8b5b..5d27ea3 100644
--- a/drivers/net/ethernet/freescale/dpa/memac_mdio.c
+++ b/drivers/net/ethernet/freescale/dpa/memac_mdio.c
@@ -256,7 +256,7 @@ static int memac_mdio_probe(struct platform_device *ofdev)
 	new_bus->parent = &ofdev->dev;
 	dev_set_drvdata(&ofdev->dev, new_bus);
 
-	sprintf(new_bus->id, "%s", np->name);
+	sprintf(new_bus->id, "%s@%llx", np->name, (unsigned long long)addr);
 
 	err = of_mdiobus_register(new_bus, np);
 
diff --git a/drivers/net/ethernet/freescale/dpa/xgmac_mdio.c b/drivers/net/ethernet/freescale/dpa/xgmac_mdio.c
index 097923d..a66c6be 100644
--- a/drivers/net/ethernet/freescale/dpa/xgmac_mdio.c
+++ b/drivers/net/ethernet/freescale/dpa/xgmac_mdio.c
@@ -220,7 +220,7 @@ static int xgmac_mdio_probe(struct platform_device *ofdev)
 	new_bus->parent = &ofdev->dev;
 	dev_set_drvdata(&ofdev->dev, new_bus);
 
-	sprintf(new_bus->id, "%s", np->name);
+	sprintf(new_bus->id, "%s@%llx", np->name, (unsigned long long)addr);
 
 	err = of_mdiobus_register(new_bus, np);
 
-- 
1.7.9.7

