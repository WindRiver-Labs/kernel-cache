From 262077a3e621e6e216f29a7ff40aa0c52f0b199c Mon Sep 17 00:00:00 2001
From: Hai-Ying Wang <Haiying.Wang@freescale.com>
Date: Thu, 17 May 2012 20:13:17 +0000
Subject: [PATCH 023/227] t4240: add Q/Bman support in device tree

Signed-off-by: Haiying Wang <Haiying.Wang@freescale.com>
[Kevin: Original patch taken from fsl sdk 1.3.1
QorIQ-SDK-V1.3.1-SOURCE-20121220-yocto.iso.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/boot/dts/fsl/t4240si-post.dtsi |   12 ++++++++++++
 arch/powerpc/boot/dts/fsl/t4240si-pre.dtsi  |    3 +++
 arch/powerpc/boot/dts/t4240qds.dts          |   10 ++++++++++
 3 files changed, 25 insertions(+)

diff --git a/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi b/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
index 86334a6..b7978ec 100644
--- a/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
+++ b/arch/powerpc/boot/dts/fsl/t4240si-post.dtsi
@@ -32,6 +32,14 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
+&bportals {
+/include/ "qoriq-bman2-portals.dtsi"
+};
+
+&qportals {
+/include/ "qoriq-qman2-portals.dtsi"
+};
+
 &soc {
 	#address-cells = <1>;
 	#size-cells = <1>;
@@ -106,4 +114,8 @@
 	L2_3: l2-cache-controller@ca0000 {
 		next-level-cache = <&cpc>;
 	};
+
+/include/ "qoriq-qman1.dtsi"
+/include/ "qoriq-bman1.dtsi"
+
 };
diff --git a/arch/powerpc/boot/dts/fsl/t4240si-pre.dtsi b/arch/powerpc/boot/dts/fsl/t4240si-pre.dtsi
index 18377dd..0e5e6e3 100644
--- a/arch/powerpc/boot/dts/fsl/t4240si-pre.dtsi
+++ b/arch/powerpc/boot/dts/fsl/t4240si-pre.dtsi
@@ -46,6 +46,9 @@
 		serial1 = &serial1;
 		serial2 = &serial2;
 		serial3 = &serial3;
+		bman = &bman;
+		qman = &qman;
+
 	};
 
 	cpus {
diff --git a/arch/powerpc/boot/dts/t4240qds.dts b/arch/powerpc/boot/dts/t4240qds.dts
index 11ae24d..aaf8b0e 100644
--- a/arch/powerpc/boot/dts/t4240qds.dts
+++ b/arch/powerpc/boot/dts/t4240qds.dts
@@ -45,6 +45,15 @@
 		device_type = "memory";
 	};
 
+	bportals: bman-portals@ff4000000 {
+		ranges = <0x0 0xf 0xf4000000 0x2000000>;
+	};
+
+	qportals: qman-portals@ff6000000 {
+		ranges = <0x0 0xf 0xf6000000 0x2000000>;
+	};
+
+
 	soc: soc@ffe000000 {
 		ranges = <0x00000000 0xf 0xfe000000 0x1000000>;
 		reg = <0xf 0xfe000000 0 0x00001000>;
@@ -52,3 +61,4 @@
 };
 
 /include/ "fsl/t4240si-post.dtsi"
+/include/ "fsl/qoriq-dpaa-res3.dtsi"
-- 
1.7.9.7

