From a6c0cd7a9f27dde8670182d38aa8d883754d58c5 Mon Sep 17 00:00:00 2001
From: Madalin Bucur <madalin.bucur@freescale.com>
Date: Wed, 5 Dec 2012 18:26:39 +0200
Subject: [PATCH 217/227] fmd: setting default FIFO size

The FMan v3H has a default value of 295KB for the total FIFO size.
Setting the hardware default instead of 256KB.

Signed-off-by: Madalin Bucur <madalin.bucur@freescale.com>
[Kevin: Original patch taken from fsl sdk 1.3.1
QorIQ-SDK-V1.3.1-SOURCE-20121220-yocto.iso.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../dpa/NetCommSw/src/wrapper/lnxwrp_fm.c          |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
index dfdcd4f..651d34a 100644
--- a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm.c
@@ -793,7 +793,9 @@ static t_Error InitFmDev(t_LnxWrpFmDev  *p_LnxWrpFmDev)
     FM_ConfigTotalFifoSize(p_LnxWrpFmDev->h_Dev, 48*KILOBYTE);
 #endif
 #if (DPAA_VERSION >= 11)
-    FM_ConfigTotalFifoSize(p_LnxWrpFmDev->h_Dev, 256*KILOBYTE);
+#define DEFAULT_TOTAL_FIFO_SIZE_FOR_FMAN_V3H 295*KILOBYTE
+    FM_ConfigTotalFifoSize(p_LnxWrpFmDev->h_Dev,
+                           DEFAULT_TOTAL_FIFO_SIZE_FOR_FMAN_V3H);
 #endif /* (DPAA_VERSION >= 11) */
 
     if (FM_Init(p_LnxWrpFmDev->h_Dev) != E_OK)
-- 
1.7.9.7

