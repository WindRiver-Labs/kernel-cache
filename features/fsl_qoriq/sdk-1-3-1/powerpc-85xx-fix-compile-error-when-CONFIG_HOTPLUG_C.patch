From daa67efda6e4651562119f590db318f8bd05d67c Mon Sep 17 00:00:00 2001
From: Zhao Chenhui <chenhui.zhao@freescale.com>
Date: Thu, 29 Nov 2012 18:50:29 +0800
Subject: [PATCH 194/227] powerpc/85xx: fix compile error when
 CONFIG_HOTPLUG_CPU is disabled

../arch/powerpc/platforms/85xx/smp.c:306:4:
error: implicit declaration of function 'generic_set_cpu_up'
../arch/powerpc/platforms/85xx/smp.c:321:4:
error: implicit declaration of function 'is_core_down'
make[3]: *** [arch/powerpc/platforms/85xx/smp.o] Error 1

Signed-off-by: Zhao Chenhui <chenhui.zhao@freescale.com>
Signed-off-by: Andy Fleming <afleming@freescale.com>
[Kevin: Original patch taken from fsl sdk 1.3.1
QorIQ-SDK-V1.3.1-SOURCE-20121220-yocto.iso. Remove the part
for smp.h since we already pick up that in a previous patch.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/platforms/85xx/smp.c |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/arch/powerpc/platforms/85xx/smp.c b/arch/powerpc/platforms/85xx/smp.c
index 28ce9c8..374a597 100644
--- a/arch/powerpc/platforms/85xx/smp.c
+++ b/arch/powerpc/platforms/85xx/smp.c
@@ -324,6 +324,7 @@ static int __cpuinit smp_85xx_kick_cpu(int nr)
 		}
 	}
 
+#ifdef CONFIG_HOTPLUG_CPU
 	/* Starting Thread 0 will reset core, so put both threads down first */
 	if (smt_capable() && system_state == SYSTEM_RUNNING &&
 			cpu_thread_in_core(nr) == 0 && !is_core_down(nr)) {
@@ -332,6 +333,7 @@ static int __cpuinit smp_85xx_kick_cpu(int nr)
 			return -ENOENT;
 	}
 #endif
+#endif
 
 	np = of_get_cpu_node(nr, NULL);
 	cpu_rel_addr = of_get_property(np, "cpu-release-addr", NULL);
-- 
1.7.9.7

