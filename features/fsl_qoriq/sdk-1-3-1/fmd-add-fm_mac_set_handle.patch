From dff42bc04bcbd2719fc4e40753ac4d517c6f15ec Mon Sep 17 00:00:00 2001
From: Madalin Bucur <madalin.bucur@freescale.com>
Date: Wed, 28 Nov 2012 12:47:15 +0200
Subject: [PATCH 183/227] fmd: add fm_mac_set_handle()

Add function used to set mac handle in the wrapper FM device
structure.

Signed-off-by: Madalin Bucur <madalin.bucur@freescale.com>
[Kevin: Original patch taken from fsl sdk 1.3.1
QorIQ-SDK-V1.3.1-SOURCE-20121220-yocto.iso.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../dpa/NetCommSw/src/inc/wrapper/fsl_fman.h       |   11 +++++++++++
 .../dpa/NetCommSw/src/wrapper/lnxwrp_fm_port.c     |   11 +++++++++++
 2 files changed, 22 insertions(+)

diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/inc/wrapper/fsl_fman.h b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/inc/wrapper/fsl_fman.h
index 893180b..b7f0173 100644
--- a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/inc/wrapper/fsl_fman.h
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/inc/wrapper/fsl_fman.h
@@ -233,6 +233,17 @@ int fm_get_tx_port_channel(struct fm_port *port);
 void fm_set_tx_port_params(struct fm_port *port, struct fm_port_non_rx_params *params);
 
 /**************************************************************************//**
+ @Function      fm_mac_set_handle
+
+ @Description   Set mac handle
+
+ @Param[in]     h_lnx_wrp_fm_dev - A handle of the LnxWrp FM device.
+ @Param[in]     h_fm_mac         - A handle of the LnxWrp FM MAC device.
+ @Param[in]     mac_id            - MAC id.
+*//***************************************************************************/
+void fm_mac_set_handle(t_Handle h_lnx_wrp_fm_dev, t_Handle h_fm_mac, int mac_id);
+
+/**************************************************************************//**
  @Function      fm_port_enable
 
  @Description   Enable specific FM-port device (may be Rx or Tx port).
diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm_port.c b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm_port.c
index 96d4dd7..fdbf438 100644
--- a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm_port.c
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_fm_port.c
@@ -692,6 +692,17 @@ void fm_set_tx_port_params(struct fm_port *port,
 }
 EXPORT_SYMBOL(fm_set_tx_port_params);
 
+void fm_mac_set_handle(t_Handle h_lnx_wrp_fm_dev,
+        t_Handle h_fm_mac,
+        int mac_id)
+{
+    t_LnxWrpFmDev *p_lnx_wrp_fm_dev = (t_LnxWrpFmDev *)h_lnx_wrp_fm_dev;
+
+    p_lnx_wrp_fm_dev->macs[mac_id].h_Dev = h_fm_mac;
+    p_lnx_wrp_fm_dev->macs[mac_id].h_LnxWrpFmDev = h_lnx_wrp_fm_dev;
+}
+EXPORT_SYMBOL(fm_mac_set_handle);
+
 static void LnxwrpFmPcdDevExceptionsCb(t_Handle h_App,
 				       e_FmPcdExceptions exception)
 {
-- 
1.7.9.7

