From c7c5df287b00c7e4544dec9858491f533cc8d99e Mon Sep 17 00:00:00 2001
From: Wei Yang <Wei.Yang@windriver.com>
Date: Wed, 10 Apr 2013 15:06:08 +0800
Subject: [PATCH] dts/p1023rdb: Adjust the layout of nor flash

*) since u-boot will read FMAN firmware at an offset of 0xf40000
  bytes from the start of the nor flash. so we need adjust the
  the base address of FMAN firmware.
*) u-boot environment variable is put at an offset of 0xf60000
   bytes from the start of the nor flash. so we add the paration
   for u-boot env variables.

Signed-off-by: Wei Yang <Wei.Yang@windriver.com>
---
 arch/powerpc/boot/dts/p1023rdb.dts |   19 ++++++++++++-------
 1 files changed, 12 insertions(+), 7 deletions(-)

diff --git a/arch/powerpc/boot/dts/p1023rdb.dts b/arch/powerpc/boot/dts/p1023rdb.dts
index e0581ad..f32c836 100644
--- a/arch/powerpc/boot/dts/p1023rdb.dts
+++ b/arch/powerpc/boot/dts/p1023rdb.dts
@@ -137,19 +137,24 @@
 			device-width = <1>;
 			partition@0 {
 				label = "ramdisk";
-				reg = <0x00000000 0x01c00000>;
+				reg = <0x00000000 0x01c40000>;
 			};
-			partition@1c00000 {
+			partition@1c40000 {
 				label = "kernel";
-				reg = <0x01c00000 0x002e0000>;
+				reg = <0x01c40000 0x002e0000>;
 			};
-			partiton@1ee0000 {
+			partiton@1f20000 {
 				label = "dtb";
-				reg = <0x01ee0000 0x00020000>;
+				reg = <0x01f20000 0x00020000>;
 			};
-			partition@1f00000 {
+			partition@1f40000 {
 				label = "firmware";
-				reg = <0x01f00000 0x00080000>;
+				reg = <0x01f40000 0x00020000>;
+				read-only;
+			};
+			partition@1f60000 {
+				label = "u-boot env";
+				reg = <0x01f60000 0x00020000>;
 				read-only;
 			};
 			partition@1f80000 {
-- 
1.7.0

