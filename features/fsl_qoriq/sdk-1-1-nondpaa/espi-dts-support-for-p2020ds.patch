From 334d33dc21b440f665006c39a6882df3ec12bd40 Mon Sep 17 00:00:00 2001
From: Li Yang <leoli@freescale.com>
Date: Mon, 4 Jan 2010 19:16:44 +0800
Subject: [PATCH 04/23] espi dts support for p2020ds

extract from vendor drop _QorIQ_SDK_V1_0x_systembuilder.iso.

Add the SPI node and the partitions to DTS file

Signed-off-by: Jerry Huang <Chang-Ming.Huang@freescale.com>
---
 arch/powerpc/boot/dts/p2020ds.dts |   39 +++++++++++++++++++++++++++++++++++++
 1 file changed, 39 insertions(+)

diff --git a/arch/powerpc/boot/dts/p2020ds.dts b/arch/powerpc/boot/dts/p2020ds.dts
index 237310c..939f3ce 100644
--- a/arch/powerpc/boot/dts/p2020ds.dts
+++ b/arch/powerpc/boot/dts/p2020ds.dts
@@ -32,6 +32,45 @@
 
 	board_soc: soc: soc@ffe00000 {
 		ranges = <0x0 0x0 0xffe00000 0x100000>;
+		spi0: spi@7000 {
+	               cell-index = <0>;
+	               #address-cells = <1>;
+	               #size-cells = <0>;
+	               compatible = "fsl,espi";
+	               interrupt-parent = <&mpic>;
+	               espi,num-ss-bits = <4>;
+	               mode = "cpu";
+	
+	               fsl_m25p80@0 {
+	                       #address-cells = <1>;
+	                       #size-cells = <1>;
+	                       compatible = "fsl,espi-flash";
+	                       reg = <0>;
+	                       linux,modalias = "fsl_m25p80";
+	                       spi-max-frequency = <40000000>; /* input clock */
+	                       partition@0 {
+	                               label = "u-boot-spi";
+	                               reg = <0x00000000 0x00100000>;
+	                               read-only;
+	                       };
+	                       partition@100000 {
+	                               label = "kernel-spi";
+	                               reg = <0x00100000 0x00500000>;
+	                               read-only;
+	                       };
+	                       partition@600000 {
+	                               label = "dtb-spi";
+	                               reg = <0x00600000 0x00100000>;
+	                               read-only;
+	                       };
+	                       partition@700000 {
+	                               label = "file system-spi";
+	                               reg = <0x00700000 0x00900000>;
+	                       };
+	               };
+	
+        	};
+
 	};
 
 	pci2: pcie@ffe08000 {
-- 
1.7.9.7

