From 45da071b270390c8b27d1ce1db237a7ca93453f2 Mon Sep 17 00:00:00 2001
From: Sandeep Malik <Sandeep.Malik@freescale.com>
Date: Mon, 9 Apr 2012 19:24:04 +0530
Subject: [PATCH 028/128] crypto: talitos - add defines for more AES cipher
 modes

Signed-off-by: Sandeep Malik <Sandeep.Malik@freescale.com>

This needs corresponding crypto API algorithm implementations done
before sending upstream.

Signed-off-by: Kim Phillips <kim.phillips@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso image]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/crypto/talitos.h |    8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/drivers/crypto/talitos.h b/drivers/crypto/talitos.h
index f8f29fe..0907555 100644
--- a/drivers/crypto/talitos.h
+++ b/drivers/crypto/talitos.h
@@ -270,6 +270,9 @@ extern int talitos_submit(struct device *dev, int ch, struct talitos_desc *desc,
 #define DESC_HDR_LO_ICCR1_MASK		cpu_to_be32(0x00180000)
 #define DESC_HDR_LO_ICCR1_PASS		cpu_to_be32(0x00080000)
 #define DESC_HDR_LO_ICCR1_FAIL		cpu_to_be32(0x00100000)
+#define DESC_HDR_LO_ICCR0_MASK		cpu_to_be32(0x18000000)
+#define DESC_HDR_LO_ICCR0_PASS		cpu_to_be32(0x08000000)
+#define DESC_HDR_LO_ICCR0_FAIL		cpu_to_be32(0x10000000)
 
 /* primary execution unit select */
 #define	DESC_HDR_SEL0_MASK		cpu_to_be32(0xf0000000)
@@ -304,6 +307,10 @@ extern int talitos_submit(struct device *dev, int ch, struct talitos_desc *desc,
 					 DESC_HDR_MODE0_MDEU_HMAC)
 #define	DESC_HDR_MODE0_MDEU_SHA1_HMAC	(DESC_HDR_MODE0_MDEU_SHA1 | \
 					 DESC_HDR_MODE0_MDEU_HMAC)
+#define DESC_HDR_MODE0_AES_XCBC_MAC	cpu_to_be32(0x08400000)
+#define DESC_HDR_MODE0_AES_XCBC_CICV	cpu_to_be32(0x02000000)
+#define DESC_HDR_MODE0_AES_CTR		cpu_to_be32(0x00600000)
+#define DESC_HDR_MODE0_MDEU_CICV	cpu_to_be32(0x04000000)
 
 /* secondary execution unit select (SEL1) */
 #define	DESC_HDR_SEL1_MASK		cpu_to_be32(0x000f0000)
@@ -340,6 +347,7 @@ extern int talitos_submit(struct device *dev, int ch, struct talitos_desc *desc,
 #define DESC_HDR_TYPE_IPSEC_ESP			cpu_to_be32(1 << 3)
 #define DESC_HDR_TYPE_COMMON_NONSNOOP_NO_AFEU	cpu_to_be32(2 << 3)
 #define DESC_HDR_TYPE_HMAC_SNOOP_NO_AFEU	cpu_to_be32(4 << 3)
+#define DESC_HDR_TYPE_AESU_CTR_HMAC		cpu_to_be32(3 << 6)
 
 /* link table extent field bits */
 #define DESC_PTR_LNKTBL_JUMP			0x80
-- 
1.7.9.7

