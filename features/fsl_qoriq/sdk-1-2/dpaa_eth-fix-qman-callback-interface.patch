From 976d7d9598e312688029c078a071400304ac7dd0 Mon Sep 17 00:00:00 2001
From: Geoff Thorpe <Geoff.Thorpe@freescale.com>
Date: Thu, 3 Nov 2011 13:52:58 -0500
Subject: [PATCH 084/128] dpaa_eth: fix qman callback interface

The 'dc_ern' callback in "struct qman_fq_cb" is being removed, as it
can't ever possibly be triggered, so this removes it. Also, use
C99-style initialisation for structures, so that the code compiles
cleanly against Qman drivers both before and after the 'dc_ern'
removal.

Signed-off-by: Geoff Thorpe <Geoff.Thorpe@freescale.com>
Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso image]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c |   20 +++++++++-----------
 1 file changed, 9 insertions(+), 11 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index fa7b0fe..0a6b2f6 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -1568,28 +1568,26 @@ static void egress_ern(struct qman_portal	*portal,
 }
 
 static const struct qman_fq rx_shared_fq __devinitconst = {
-		.cb = {shared_rx_dqrr, NULL, NULL, NULL}
+	.cb = { .dqrr = shared_rx_dqrr }
 };
 static const struct qman_fq rx_private_defq __devinitconst = {
-		.cb = {ingress_rx_default_dqrr, NULL, NULL, NULL}
+	.cb = { .dqrr = ingress_rx_default_dqrr }
 };
 static const struct qman_fq rx_private_errq __devinitconst = {
-		.cb = {ingress_rx_error_dqrr, NULL, NULL, NULL}
+	.cb = { .dqrr = ingress_rx_error_dqrr }
 };
 static const struct qman_fq tx_private_defq __devinitconst = {
-		.cb = {ingress_tx_default_dqrr, NULL, NULL, NULL}
+	.cb = { .dqrr = ingress_tx_default_dqrr }
 };
 static const struct qman_fq tx_private_errq __devinitconst = {
-		.cb = {ingress_tx_error_dqrr, NULL, NULL, NULL}
-};
-static const struct qman_fq dummyq __devinitconst = {
-		.cb = {NULL, NULL, NULL, NULL}
+	.cb = { .dqrr = ingress_tx_error_dqrr }
 };
+static const struct qman_fq dummyq __devinitconst = { };
 static const struct qman_fq private_egress_fq __devinitconst = {
-	.cb = {NULL, egress_ern, NULL, NULL}
+	.cb = { .ern = egress_ern }
 };
 static const struct qman_fq shared_egress_fq __devinitconst = {
-	.cb = {NULL, shared_ern, NULL, NULL}
+	.cb = { .ern = shared_ern }
 };
 
 #ifdef CONFIG_DPAA_ETH_UNIT_TESTS
@@ -1698,7 +1696,7 @@ out:
 }
 
 static const struct qman_fq tx_unit_test_fq __devinitconst = {
-	.cb = {tx_unit_test_dqrr, tx_unit_test_ern, NULL, NULL}
+	.cb = { .dqrr = tx_unit_test_dqrr, .ern = tx_unit_test_ern }
 };
 
 static struct __devinitdata dpa_fq unit_fq;
-- 
1.7.9.7

