From 5a8bf8b376c22f4a4960442ecf81cc7912fc1cad Mon Sep 17 00:00:00 2001
From: Geoff Thorpe <Geoff.Thorpe@freescale.com>
Date: Thu, 3 Nov 2011 13:52:57 -0500
Subject: [PATCH 127/128] pme2: remove unnecessary 'dc_ern' callback

This handler can't ever possibly be triggered, and the qman interface
it plugs into is going to be removed.

Signed-off-by: Geoff Thorpe <Geoff.Thorpe@freescale.com>
Signed-off-by: Kumar Gala <galak@kernel.crashing.org>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso image]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/staging/fsl_pme2/pme2_high.c |   14 --------------
 1 file changed, 14 deletions(-)

diff --git a/drivers/staging/fsl_pme2/pme2_high.c b/drivers/staging/fsl_pme2/pme2_high.c
index 35c9b77..6511e5d 100644
--- a/drivers/staging/fsl_pme2/pme2_high.c
+++ b/drivers/staging/fsl_pme2/pme2_high.c
@@ -107,8 +107,6 @@ static enum qman_cb_dqrr_result cb_dqrr(struct qman_portal *, struct qman_fq *,
 				const struct qm_dqrr_entry *);
 static void cb_ern(struct qman_portal *, struct qman_fq *,
 				const struct qm_mr_entry *);
-static void cb_dc_ern(struct qman_portal *, struct qman_fq *,
-				const struct qm_mr_entry *);
 static void cb_fqs(struct qman_portal *, struct qman_fq *,
 				const struct qm_mr_entry *);
 static const struct qman_fq_cb pme_fq_base_in = {
@@ -117,7 +115,6 @@ static const struct qman_fq_cb pme_fq_base_in = {
 };
 static const struct qman_fq_cb pme_fq_base_out = {
 	.dqrr = cb_dqrr,
-	.dc_ern = cb_dc_ern,
 	.fqs = cb_fqs
 };
 
@@ -920,17 +917,6 @@ static void cb_ern(__always_unused struct qman_portal *portal,
 		wake_up(&ctx->queue);
 }
 
-static void cb_dc_ern(struct qman_portal *portal, struct qman_fq *fq,
-				const struct qm_mr_entry *mr)
-{
-	struct pme_ctx *ctx = (struct pme_ctx *)fq;
-	/* This, umm, *shouldn't* happen. It's pretty bad. Things are expected
-	 * to fall apart here, but we'll continue long enough to get out of
-	 * interrupt context and let the user unwind whatever they can. */
-	pr_err("PME2 h/w enqueue rejection - expect catastrophe!\n");
-	cb_helper(portal, ctx, &mr->dcern.fd, 1);
-}
-
 static void cb_fqs(__always_unused struct qman_portal *portal,
 			__always_unused struct qman_fq *fq,
 			const struct qm_mr_entry *mr)
-- 
1.7.9.7

