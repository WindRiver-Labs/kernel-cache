From 45d021800862cb58f2576763926c33965f3480e6 Mon Sep 17 00:00:00 2001
From: Ioana Radulescu <ruxandra.radulescu@freescale.com>
Date: Wed, 18 Apr 2012 20:44:31 +0000
Subject: [PATCH 117/128] dpaa_eth: Fix incrementing of Tx error counter

The tx error counter was not being incremented on an error path
in the Tx function for shared interfaces.

Signed-off-by: Ioana Radulescu <ruxandra.radulescu@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso image]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c |    1 +
 1 file changed, 1 insertion(+)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index daad6d7..105979b 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -1248,6 +1248,7 @@ static int __hot dpa_shared_tx(struct sk_buff *skb, struct net_device *net_dev)
 
 	dpa_bp = dpa_size2pool(priv, skb_headlen(skb));
 	if (unlikely(IS_ERR(dpa_bp))) {
+		percpu_priv->stats.tx_errors++;
 		err = PTR_ERR(dpa_bp);
 		goto bpools_too_small_error;
 	}
-- 
1.7.9.7

