From 53b185aba39e3dc5e145e72b7079cc8cb0508558 Mon Sep 17 00:00:00 2001
From: Ruxandra Radulescu <ruxandra.radulescu@freescale.com>
Date: Fri, 9 Mar 2012 15:21:23 +0000
Subject: [PATCH 102/128] dpaa_eth: Code cleanup

Remove some unused defines and variables from the code.

Signed-off-by: Ioana Radulescu <ruxandra.radulescu@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso image]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c |   25 -------------------------
 drivers/net/ethernet/freescale/dpa/dpaa_eth.h |    1 -
 2 files changed, 26 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index 3dfc609..cef2678 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -69,13 +69,8 @@
 
 #define DEFAULT_COUNT		64
 #define DEFAULT_BUF_SIZE DPA_BP_SIZE(fsl_fman_phy_maxfrm);
-#define DPA_MAX_TX_BACKLOG	512
 #define DPA_NAPI_WEIGHT		64
 
-#define DPA_BP_REFILL (1 | (smp_processor_id() << 16))
-#define DPA_BP_FINE ((smp_processor_id() << 16))
-#define DPA_BP_REFILL_NEEDED 1
-
 /* S/G table requires at least 256 bytes */
 #define SGT_BUFFER_SIZE		DPA_BP_SIZE(256)
 
@@ -164,12 +159,6 @@ struct dpa_fq {
 
 /* BM */
 
-#ifdef DEBUG
-#define GFP_DPA_BP	(GFP_DMA | __GFP_ZERO | GFP_ATOMIC)
-#else
-#define GFP_DPA_BP	(GFP_DMA | GFP_ATOMIC)
-#endif
-
 #define DPA_BP_HEAD (DPA_PRIV_DATA_SIZE + DPA_PARSE_RESULTS_SIZE + \
 			DPA_HASH_RESULTS_SIZE)
 #define DPA_BP_SIZE(s)	(DPA_BP_HEAD + (s))
@@ -665,18 +654,6 @@ static void _dpa_cleanup_tx_fd(const struct dpa_priv_s *priv,
 
 /* net_device */
 
-#define NN_ALLOCATED_SPACE(net_dev) \
-		max((size_t)arp_hdr_len(net_dev),  sizeof(struct iphdr))
-#define NN_RESERVED_SPACE(net_dev) \
-		min((size_t)arp_hdr_len(net_dev),  sizeof(struct iphdr))
-
-#define TT_ALLOCATED_SPACE(net_dev) \
-	max(sizeof(struct icmphdr), max(sizeof(struct udphdr), \
-		sizeof(struct tcphdr)))
-#define TT_RESERVED_SPACE(net_dev) \
-	min(sizeof(struct icmphdr), min(sizeof(struct udphdr), \
-		sizeof(struct tcphdr)))
-
 static struct net_device_stats * __cold
 dpa_get_stats(struct net_device *net_dev)
 {
@@ -1216,7 +1193,6 @@ static int __hot dpa_shared_tx(struct sk_buff *skb, struct net_device *net_dev)
 	struct bm_buffer bmb;
 	struct dpa_percpu_priv_s *percpu_priv;
 	struct dpa_priv_s *priv;
-	struct device *dev;
 	struct qm_fd fd;
 	int queue_mapping;
 	int err;
@@ -1224,7 +1200,6 @@ static int __hot dpa_shared_tx(struct sk_buff *skb, struct net_device *net_dev)
 
 	priv = netdev_priv(net_dev);
 	percpu_priv = per_cpu_ptr(priv->percpu_priv, smp_processor_id());
-	dev = net_dev->dev.parent;
 
 	memset(&fd, 0, sizeof(fd));
 	fd.format = qm_fd_contig;
diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.h b/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
index 1e91706..86a61d9 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.h
@@ -70,7 +70,6 @@ struct dpa_bp {
 	void				*vaddr;
 	int kernel_pool;
 	int *percpu_count;
-	int *needs_refill;
 	atomic_t refs;
 };
 
-- 
1.7.9.7

