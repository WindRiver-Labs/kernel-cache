From 56aa8e746029a67c8d84032242a20850eb90aab1 Mon Sep 17 00:00:00 2001
From: Cristian Sovaiala <cristian.sovaiala@freescale.com>
Date: Thu, 26 Jan 2012 12:59:33 +0200
Subject: [PATCH 086/128] dpaa_eth: Reset packet counters

During the unit test, the TX counters are being incremented.
Reset the stats structure to ensure all counters are set to 0.

Signed-off-by: Cristian Sovaiala <cristian.sovaiala@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso image]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c |    3 +++
 1 file changed, 3 insertions(+)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index 4f18932..38d8f30 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -1835,6 +1835,9 @@ fq_create_fail:
 	if (tests_failed)
 		err = -EINVAL;
 
+	/* Reset counters */
+	memset(&percpu_priv->stats, 0, sizeof(percpu_priv->stats));
+
 	return err;
 }
 #endif
-- 
1.7.9.7

