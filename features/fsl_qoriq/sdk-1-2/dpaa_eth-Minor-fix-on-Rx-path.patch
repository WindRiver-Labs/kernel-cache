From 6c91b273e9ad3d55e42a70fca3935a23a80db966 Mon Sep 17 00:00:00 2001
From: Ioana Radulescu <ruxandra.radulescu@freescale.com>
Date: Thu, 26 Jan 2012 14:48:38 +0200
Subject: [PATCH 091/128] dpaa_eth: Minor fix on Rx path

Don't assume a clean (newly allocated/recycled) skb always has
NET_SKB_PAD bytes of headroom. Instead, use the function provided
by the stack.

Signed-off-by: Ioana Radulescu <ruxandra.radulescu@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso image]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index de9be31..5b64a68 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -765,10 +765,10 @@ static int dpa_process_one(struct dpa_percpu_priv_s *percpu_priv,
 	(*percpu_priv->dpa_bp_count)--;
 
 	/*
-	 * The skb is currently pointed at head + NET_SKB_PAD. The packet
+	 * The skb is currently pointed at head + headroom. The packet
 	 * starts at skb->head + pad + fd offset.
 	 */
-	data_start = pad + dpa_fd_offset(fd) - NET_SKB_PAD;
+	data_start = pad + dpa_fd_offset(fd) - skb_headroom(skb);
 	skb_put(skb, dpa_fd_length(fd) + data_start);
 	skb_pull(skb, data_start);
 
-- 
1.7.9.7

