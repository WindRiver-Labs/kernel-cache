From e61d58897aff0c3b1cbcc3c53d3816c54a56ffda Mon Sep 17 00:00:00 2001
From: Kim Phillips <kim.phillips@freescale.com>
Date: Fri, 1 Jun 2012 03:24:19 +0000
Subject: [PATCH 028/121] fsl_pci: fix error: unused variable 'hose'

mpc83xx builds are broken because of this error:

arch/powerpc/sysdev/fsl_pci.c: In function 'fsl_pci_probe':
arch/powerpc/sysdev/fsl_pci.c:894:25: error: unused variable 'hose' [-Werror=unused-variable]
cc1: all warnings being treated as errors

This patch moves the definition of hose inside the #ifdef
configuration block of the code that uses it.

Signed-off-by: Kim Phillips <kim.phillips@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.2-SOURCE-20120614-yocto.iso image]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 arch/powerpc/sysdev/fsl_pci.c |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/arch/powerpc/sysdev/fsl_pci.c b/arch/powerpc/sysdev/fsl_pci.c
index dc4f666..284512b 100644
--- a/arch/powerpc/sysdev/fsl_pci.c
+++ b/arch/powerpc/sysdev/fsl_pci.c
@@ -902,7 +902,6 @@ static const struct of_device_id pci_ids[] = {
 int primary_phb_addr;
 static int __devinit fsl_pci_probe(struct platform_device *pdev)
 {
-	struct pci_controller *hose;
 	int ret;
 	bool is_primary;
 
@@ -914,6 +913,8 @@ static int __devinit fsl_pci_probe(struct platform_device *pdev)
 
 #ifdef CONFIG_SWIOTLB
 		if (ret == 0) {
+			struct pci_controller *hose;
+
 			hose = pci_find_hose_for_OF_device(pdev->dev.of_node);
 			/*
 			 * if we couldn't map all of DRAM via the dma windows
-- 
1.7.9.7

