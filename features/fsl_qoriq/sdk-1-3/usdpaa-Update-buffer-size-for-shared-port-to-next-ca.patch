From d417862156db228d88e808f316b40343e5bc7871 Mon Sep 17 00:00:00 2001
From: Yashpal Dutta <yashpal.dutta@freescale.com>
Date: Wed, 13 Jun 2012 18:35:18 +0000
Subject: [PATCH 150/162] usdpaa: Update buffer size for shared port to next
 cacheline

Shared port handler in dpaa_eth driver doesn't support SG frames. Due to
recent increase in annotation area size in dpaa_eth driver to handle
IPSec buffer recycling issue, SG frames started appearing on shared port

Keeping buffer size to 1728 ensure that no SG frame would occur on Shared MAC
ports unless jumbo frame is enabled on these ports

Signed-off-by: Yashpal Dutta <yashpal.dutta@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.3-SOURCE-20121114-yocto.iso tarball. Remove the parts for
p2041 and p5040.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../boot/dts/p3041ds-usdpaa-shared-interfaces.dts  |    6 +++---
 .../boot/dts/p4080ds-usdpaa-shared-interfaces.dts  |    6 +++---
 .../boot/dts/p5020ds-usdpaa-shared-interfaces.dts  |    6 +++---
 3 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/arch/powerpc/boot/dts/p3041ds-usdpaa-shared-interfaces.dts b/arch/powerpc/boot/dts/p3041ds-usdpaa-shared-interfaces.dts
index df0cc89..7b4005b 100644
--- a/arch/powerpc/boot/dts/p3041ds-usdpaa-shared-interfaces.dts
+++ b/arch/powerpc/boot/dts/p3041ds-usdpaa-shared-interfaces.dts
@@ -58,19 +58,19 @@
 	bp9: buffer-pool@9 {
 		compatible = "fsl,p3041-bpool", "fsl,bpool";
 		fsl,bpid = <9>;
-		fsl,bpool-ethernet-cfg = <0 0 0 1600 0 0xfeedabba>;
+		fsl,bpool-ethernet-cfg = <0 0 0 1728 0 0xfeedabba>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp16: buffer-pool@16 {
 		compatible = "fsl,p3041-bpool", "fsl,bpool";
 		fsl,bpid = <16>;
-		fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp17: buffer-pool@17 {
 		compatible = "fsl,p3041-bpool", "fsl,bpool";
 		fsl,bpid = <17>;
-		fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 
diff --git a/arch/powerpc/boot/dts/p4080ds-usdpaa-shared-interfaces.dts b/arch/powerpc/boot/dts/p4080ds-usdpaa-shared-interfaces.dts
index 36902fd..65ad32a 100644
--- a/arch/powerpc/boot/dts/p4080ds-usdpaa-shared-interfaces.dts
+++ b/arch/powerpc/boot/dts/p4080ds-usdpaa-shared-interfaces.dts
@@ -58,19 +58,19 @@
 	bp9: buffer-pool@9 {
 		compatible = "fsl,p4080-bpool", "fsl,bpool";
 		fsl,bpid = <9>;
-		fsl,bpool-ethernet-cfg = <0 0 0 1600 0 0xfeedabba>;
+		fsl,bpool-ethernet-cfg = <0 0 0 1728 0 0xfeedabba>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp16: buffer-pool@16 {
                         compatible = "fsl,p4080-bpool", "fsl,bpool";
                         fsl,bpid = <16>;
-                        fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+                        fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
                         fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
        };
 	bp17: buffer-pool@17 {
                         compatible = "fsl,p4080-bpool", "fsl,bpool";
                         fsl,bpid = <17>;
-                        fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+                        fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
                         fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
        };
 	fsl,dpaa {
diff --git a/arch/powerpc/boot/dts/p5020ds-usdpaa-shared-interfaces.dts b/arch/powerpc/boot/dts/p5020ds-usdpaa-shared-interfaces.dts
index 87c3702..67c8ae8 100644
--- a/arch/powerpc/boot/dts/p5020ds-usdpaa-shared-interfaces.dts
+++ b/arch/powerpc/boot/dts/p5020ds-usdpaa-shared-interfaces.dts
@@ -58,19 +58,19 @@
 	bp9: buffer-pool@9 {
 		compatible = "fsl,p5020-bpool", "fsl,bpool";
 		fsl,bpid = <9>;
-		fsl,bpool-ethernet-cfg = <0 0 0 1600 0 0xfeedabba>;
+		fsl,bpool-ethernet-cfg = <0 0 0 1728 0 0xfeedabba>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp16: buffer-pool@16 {
 		compatible = "fsl,p5020-bpool", "fsl,bpool";
 		fsl,bpid = <16>;
-		fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp17: buffer-pool@17 {
 		compatible = "fsl,p5020-bpool", "fsl,bpool";
 		fsl,bpid = <17>;
-		fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 
-- 
1.7.9.7

