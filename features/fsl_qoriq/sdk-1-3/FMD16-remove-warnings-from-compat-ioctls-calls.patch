From 2c3775d0cc9ceefc37eb76801ac5bd537e1f8607 Mon Sep 17 00:00:00 2001
From: Andrei Pistirica <sorin.pistirica@freescale.com>
Date: Fri, 25 May 2012 11:25:14 +0300
Subject: [PATCH 070/162] FMD16 remove warnings from compat ioctls calls.

Replaced warning directive with printks.

Signed-off-by: Andrei Pistirica <sorin.pistirica@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.3-SOURCE-20121114-yocto.iso tarball.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../dpa/NetCommSw/src/wrapper/lnxwrp_ioctls_fm.c   |   16 +++++++++-------
 1 file changed, 9 insertions(+), 7 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_ioctls_fm.c b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_ioctls_fm.c
index 2303f9a..6762017 100644
--- a/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_ioctls_fm.c
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/src/wrapper/lnxwrp_ioctls_fm.c
@@ -1838,7 +1838,6 @@ invalid_port_id:
             break;
         }
 #if defined(CONFIG_COMPAT)
-#warning TODO: compat ioctl call not implemented!
         case FM_PCD_IOC_HASH_TABLE_SET_COMPAT:
 #endif
         case FM_PCD_IOC_HASH_TABLE_SET:
@@ -1853,9 +1852,11 @@ invalid_port_id:
             memset(param, 0, sizeof(*param)) ;
 
 #if defined(CONFIG_COMPAT)
-#warning TODO: compat ioctl call not implemented!
             if (compat)
             {
+                printk(KERN_WARNING "FM_PCD_IOC_HASH_TABLE_SET: compat ioctl call not implemented! \n");
+                kfree(param);
+                RETURN_ERROR(MINOR, E_INVALID_HANDLE, ("IOCTL FM PCD"));
             }
             else
 #endif
@@ -1868,7 +1869,6 @@ invalid_port_id:
             param->id = FM_PCD_HashTableSet(p_LnxWrpFmDev->h_PcdDev, (t_FmPcdHashTableParams *) param);
 
 #if defined(CONFIG_COMPAT)
-#warning TODO: compat ioctl call not implemented!
             if (compat)
             {
             }
@@ -1912,7 +1912,6 @@ invalid_port_id:
             return FM_PCD_HashTableDelete(id.obj);
         }
 #if defined(CONFIG_COMPAT)
-#warning TODO: compat ioctl call not implemented!
         case FM_PCD_IOC_HASH_TABLE_ADD_KEY_COMPAT:
 #endif
         case FM_PCD_IOC_HASH_TABLE_ADD_KEY:
@@ -1927,9 +1926,11 @@ invalid_port_id:
             memset(param, 0, sizeof(*param)) ;
 
 #if defined(CONFIG_COMPAT)
-#warning TODO: compat ioctl call not implemented!
             if (compat)
             {
+                printk(KERN_WARNING "FM_PCD_IOC_HASH_TABLE_ADD_KEY: compat ioctl call not implemented!");
+                kfree(param);
+                RETURN_ERROR(MINOR, E_INVALID_HANDLE, ("IOCTL FM PCD"));
             }
             else
 #endif
@@ -1946,7 +1947,6 @@ invalid_port_id:
         }
 
 #if defined(CONFIG_COMPAT)
-#warning TODO: compat ioctl call not implemented!
         case FM_PCD_IOC_HASH_TABLE_REMOVE_KEY_COMPAT:
 #endif
         case FM_PCD_IOC_HASH_TABLE_REMOVE_KEY:
@@ -1961,9 +1961,11 @@ invalid_port_id:
             memset(param, 0, sizeof(*param)) ;
 
 #if defined(CONFIG_COMPAT)
-#warning TODO: compat ioctl call not implemented!
             if (compat)
             {
+                printk(KERN_WARNING "FM_PCD_IOC_HASH_TABLE_REMOVE_KEY: compat ioctl call not implemented!");
+                kfree(param);
+                RETURN_ERROR(MINOR, E_INVALID_HANDLE, ("IOCTL FM PCD"));
             }
             else
 #endif
-- 
1.7.9.7

