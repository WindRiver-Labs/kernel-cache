From 21172c50ba4bcc05c3bba4502ab3f670aa2d1525 Mon Sep 17 00:00:00 2001
From: Jiang Bin <bin.jiang@windriver.com>
Date: Thu, 15 Nov 2012 16:56:03 +0800
Subject: [PATCH] crypto/talitos: Fix return from DEF_TALITOS_DONE, but forget
 to do unlock

The commit "crypto: talitos - Replace the tasklet implementation with NAPI"
adds "return" before "unlock" operation and makes system hang.

Signed-off-by: Jiang Bin <bin.jiang@windriver.com>
---
 drivers/crypto/talitos.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/crypto/talitos.c b/drivers/crypto/talitos.c
index 8240d10..f1c0b26 100644
--- a/drivers/crypto/talitos.c
+++ b/drivers/crypto/talitos.c
@@ -338,8 +338,8 @@ out:									\
 			  TALITOS_IMR_LO_INIT);				\
 	}								\
 									\
-	return work_done;						\
 	spin_unlock_irqrestore(&priv->reg_lock, flags);			\
+	return work_done;						\
 }
 DEF_TALITOS_DONE(4ch, TALITOS_ISR_4CHDONE, 4)
 DEF_TALITOS_DONE(ch0_2, TALITOS_ISR_CH_0_2_DONE, 2)
-- 
1.7.9.7

