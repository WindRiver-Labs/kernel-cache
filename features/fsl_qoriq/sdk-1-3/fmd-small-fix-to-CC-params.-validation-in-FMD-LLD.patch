From 373fee958d041b303d1e4f6bea44e7d232727c73 Mon Sep 17 00:00:00 2001
From: Stefan Szabo <szbs001@freescale.com>
Date: Mon, 1 Oct 2012 18:09:38 +0300
Subject: [PATCH 085/162] fmd: small fix to CC params.' validation in FMD LLD

Signed-off-by: Stefan Szabo <szbs001@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.3-SOURCE-20121114-yocto.iso tarball.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../dpa/NetCommSw/Peripherals/FM/Pcd/fm_cc.c       |    7 +++----
 1 file changed, 3 insertions(+), 4 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/Peripherals/FM/Pcd/fm_cc.c b/drivers/net/ethernet/freescale/dpa/NetCommSw/Peripherals/FM/Pcd/fm_cc.c
index a1e67ba..e25ec55 100644
--- a/drivers/net/ethernet/freescale/dpa/NetCommSw/Peripherals/FM/Pcd/fm_cc.c
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/Peripherals/FM/Pcd/fm_cc.c
@@ -1471,10 +1471,9 @@ t_Error ValidateNextEngineParams(t_Handle                   h_FmPcd,
              break;
 
          case (e_FM_PCD_DONE):
-             if (p_FmPcdCcNextEngineParams->params.enqueueParams.action == e_FM_PCD_ENQ_FRAME)
-             {
-                 if (p_FmPcdCcNextEngineParams->params.enqueueParams.overrideFqid &&
-                         !p_FmPcdCcNextEngineParams->params.enqueueParams.newFqid)
+             if (p_FmPcdCcNextEngineParams->params.enqueueParams.action == e_FM_PCD_ENQ_FRAME &&
+                     p_FmPcdCcNextEngineParams->params.enqueueParams.overrideFqid) {
+                 if (!p_FmPcdCcNextEngineParams->params.enqueueParams.newFqid)
                      RETURN_ERROR(MAJOR, E_INVALID_STATE, ("overrideFqid defined, but not newFqid."));
                  if (p_FmPcdCcNextEngineParams->params.enqueueParams.newFqid & ~0x00FFFFFF)
                      RETURN_ERROR(MAJOR, E_INVALID_VALUE, ("fqidForCtrlFlow must be between 1 and 2^24-1"));
-- 
1.7.9.7

