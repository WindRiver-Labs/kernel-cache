From 4663979171de0b2863a1c3c73ddd255a1595f42d Mon Sep 17 00:00:00 2001
From: Jiang Bin <bin.jiang@windriver.com>
Date: Sun, 9 Dec 2012 09:16:55 +0800
Subject: [PATCH] p2020ds: Enable rising edge-triggered interrupt for i8259 in
 DTS

i8259 cascaded to mpic is not threaded but all devices routed to i8259
are threaded. One given PCIe device interrupt only disables PCIe irq
then wakeup this associated interrupt thread, but doesn't disable i8259
irq for mpic, so we'll have a irq storm from i8259 triggered by PCIe
device.

Since i8259 pin always keeps high level until PCIe device thread is
handled/EOIed, Use rising edge-triggered interrupt for i8259 as a
workaround to make threaded irq have a chance to run including PCIe
device.

Signed-off-by: Jiang Bin <bin.jiang@windriver.com>
---
 arch/powerpc/boot/dts/p2020ds.dtsi |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/arch/powerpc/boot/dts/p2020ds.dtsi b/arch/powerpc/boot/dts/p2020ds.dtsi
index 69365b5..8f33f53 100644
--- a/arch/powerpc/boot/dts/p2020ds.dtsi
+++ b/arch/powerpc/boot/dts/p2020ds.dtsi
@@ -316,7 +316,7 @@
 					#address-cells = <0>;
 					#interrupt-cells = <2>;
 					compatible = "chrp,iic";
-					interrupts = <4 1 0 0>;
+					interrupts = <4 3 0 0>;
 					interrupt-parent = <&mpic>;
 				};
 
-- 
1.7.9.7

