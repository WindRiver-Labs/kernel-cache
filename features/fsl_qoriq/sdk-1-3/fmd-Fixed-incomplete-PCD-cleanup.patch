From f478703ca9bc0843afdca6653d315abb97afa51c Mon Sep 17 00:00:00 2001
From: Stefan Szabo <szbs001@freescale.com>
Date: Thu, 9 Aug 2012 13:22:16 +0300
Subject: [PATCH 079/162] fmd: Fixed incomplete PCD cleanup

Failure to set this flag in the DetachPCD() LLD function
was causing cleanup-related issues in FMC and other userspace apps.

Signed-off-by: Floarea Anca Jeanina <B12569@freescale.com>
Signed-off-by: Stefan Szabo <szbs001@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.3-SOURCE-20121114-yocto.iso tarball.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 .../dpa/NetCommSw/Peripherals/FM/Port/fm_port.c    |    2 ++
 1 file changed, 2 insertions(+)

diff --git a/drivers/net/ethernet/freescale/dpa/NetCommSw/Peripherals/FM/Port/fm_port.c b/drivers/net/ethernet/freescale/dpa/NetCommSw/Peripherals/FM/Port/fm_port.c
index 3269080..5a9d36c 100644
--- a/drivers/net/ethernet/freescale/dpa/NetCommSw/Peripherals/FM/Port/fm_port.c
+++ b/drivers/net/ethernet/freescale/dpa/NetCommSw/Peripherals/FM/Port/fm_port.c
@@ -2030,6 +2030,8 @@ static t_Error DetachPCD(t_FmPort *p_FmPort)
         if (FmSetNumOfRiscsPerPort(p_FmPort->h_Fm, p_FmPort->hardwarePortId, 2, p_FmPort->orFmanCtrl)!= E_OK)
             RETURN_ERROR(MAJOR, E_INVALID_STATE, NO_MSG);
 
+    p_FmPort->requiredAction = 0;
+
     return E_OK;
 }
 
-- 
1.7.9.7

