From b9fcfe2af7b97b3856a914f21ee8833a9b43eee2 Mon Sep 17 00:00:00 2001
From: Tiejun Chen <tiejun.chen@windriver.com>
Date: Tue, 4 Dec 2012 14:29:16 +0800
Subject: [PATCH 15/22] usdpaa: p2041rdb/p5040ds: Update buffer size for
 shared port to next cacheline

Shared port handler in dpaa_eth driver doesn't support SG frames. Due to
recent increase in annotation area size in dpaa_eth driver to handle
IPSec buffer recycling issue, SG frames started appearing on shared port

Keeping buffer size to 1728 ensure that no SG frame would occur on Shared MAC
ports unless jumbo frame is enabled on these ports

Signed-off-by: Yashpal Dutta <yashpal.dutta@freescale.com>
[Extracted from QorIQ-SDK-V1.3-SOURCE-20121114-yocto.iso]
Signed-off-by: Tiejun Chen <tiejun.chen@windriver.com>
---
 .../boot/dts/p2041rdb-usdpaa-shared-interfaces.dts |    6 +++---
 .../boot/dts/p5040ds-usdpaa-shared-interfaces.dts  |    6 +++---
 2 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/arch/powerpc/boot/dts/p2041rdb-usdpaa-shared-interfaces.dts b/arch/powerpc/boot/dts/p2041rdb-usdpaa-shared-interfaces.dts
index 3edf09b..8aeb65b 100644
--- a/arch/powerpc/boot/dts/p2041rdb-usdpaa-shared-interfaces.dts
+++ b/arch/powerpc/boot/dts/p2041rdb-usdpaa-shared-interfaces.dts
@@ -58,19 +58,19 @@
 	bp9: buffer-pool@9 {
 		compatible = "fsl,p2041-bpool", "fsl,bpool";
 		fsl,bpid = <9>;
-		fsl,bpool-ethernet-cfg = <0 0 0 1600 0 0xfeedabba>;
+		fsl,bpool-ethernet-cfg = <0 0 0 1728 0 0xfeedabba>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp16: buffer-pool@16 {
 		compatible = "fsl,p2041-bpool", "fsl,bpool";
 		fsl,bpid = <16>;
-		fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp17: buffer-pool@17 {
 		compatible = "fsl,p2041-bpool", "fsl,bpool";
 		fsl,bpid = <17>;
-		fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 
diff --git a/arch/powerpc/boot/dts/p5040ds-usdpaa-shared-interfaces.dts b/arch/powerpc/boot/dts/p5040ds-usdpaa-shared-interfaces.dts
index 9ea2b39..6981600 100644
--- a/arch/powerpc/boot/dts/p5040ds-usdpaa-shared-interfaces.dts
+++ b/arch/powerpc/boot/dts/p5040ds-usdpaa-shared-interfaces.dts
@@ -58,19 +58,19 @@
 	bp9: buffer-pool@9 {
 		compatible = "fsl,p5040-bpool", "fsl,bpool";
 		fsl,bpid = <9>;
-		fsl,bpool-ethernet-cfg = <0 0 0 1600 0 0xfeedabba>;
+		fsl,bpool-ethernet-cfg = <0 0 0 1728 0 0xfeedabba>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp16: buffer-pool@16 {
 		compatible = "fsl,p5040-bpool", "fsl,bpool";
 		fsl,bpid = <16>;
-		fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 	bp17: buffer-pool@17 {
 		compatible = "fsl,p5040-bpool", "fsl,bpool";
 		fsl,bpid = <17>;
-		fsl,bpool-ethernet-cfg = <0 2048 0 1600 0 0>;
+		fsl,bpool-ethernet-cfg = <0 2048 0 1728 0 0>;
 		fsl,bpool-thresholds = <0x100 0x300 0x0 0x0>;
 	};
 
-- 
1.7.9.7

