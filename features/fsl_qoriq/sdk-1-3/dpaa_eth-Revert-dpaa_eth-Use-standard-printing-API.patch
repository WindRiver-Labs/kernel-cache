From 48a7f654c4a72f130e9390fe18ae902373e9c094 Mon Sep 17 00:00:00 2001
From: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
Date: Fri, 19 Oct 2012 21:40:23 +0300
Subject: [PATCH 057/162] dpaa_eth: Revert "dpaa_eth: Use standard printing
 API"

This reverts commits:
 - 4e68237dbbf6bea3e0cd926cbad2a182d75e9dff "dpaa_eth:
Use standard printing API" and
 - e3e44370d93eb93c3307d1d17a3932552bc2dd0a "dpaa_eth: Fix compilation
error with FSL_DPAA_1588".

For esoteric reasons, what was supposed to be a purely cosmetic patch
turned out to incur a 3-5% performance penalty on the DPAA-Ethernet
driver (both SG and non-SG variants), on parts with (or reduced to) 1 or
2 cores. We have no choice but reverting this for now.

The two commits referred to here should have been originally a single
commit, so squashing and reverting both in one step.

Signed-off-by: Bogdan Hamciuc <bogdan.hamciuc@freescale.com>
[Kevin: Original patch taken from FSL
QorIQ-SDK-V1.3-SOURCE-20121114-yocto.iso tarball. Use
raw_smp_processor_id for cpu_printk macro.]
Signed-off-by: Kevin Hao <kexin.hao@windriver.com>
---
 drivers/net/ethernet/freescale/dpa/dpa-ethtool.c   |   38 ++--
 .../net/ethernet/freescale/dpa/dpaa_eth-common.h   |   91 ++++++++++
 drivers/net/ethernet/freescale/dpa/dpaa_eth.c      |  187 ++++++++++----------
 drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c   |   33 ++--
 drivers/net/ethernet/freescale/dpa/mac-api.c       |   85 +++++----
 drivers/net/ethernet/freescale/dpa/mac.c           |   68 ++++---
 drivers/net/ethernet/freescale/dpa/offline_port.c  |   67 ++++---
 7 files changed, 319 insertions(+), 250 deletions(-)

diff --git a/drivers/net/ethernet/freescale/dpa/dpa-ethtool.c b/drivers/net/ethernet/freescale/dpa/dpa-ethtool.c
index 9c48856..ccc97ab 100644
--- a/drivers/net/ethernet/freescale/dpa/dpa-ethtool.c
+++ b/drivers/net/ethernet/freescale/dpa/dpa-ethtool.c
@@ -29,10 +29,6 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
-#define pr_fmt(fmt) \
-	KBUILD_MODNAME ": %s:%hu:%s() " fmt, \
-	KBUILD_BASENAME".c", __LINE__, __func__
-
 #include <linux/string.h>
 
 #include "dpaa_eth.h"
@@ -45,17 +41,17 @@ static int __cold dpa_get_settings(struct net_device *net_dev, struct ethtool_cm
 	priv = netdev_priv(net_dev);
 
 	if (priv->mac_dev == NULL) {
-		netdev_info(net_dev, "This is a MAC-less interface\n");
+		cpu_netdev_info(net_dev, "This is a MAC-less interface\n");
 		return -ENODEV;
 	}
 	if (unlikely(priv->mac_dev->phy_dev == NULL)) {
-		netdev_err(net_dev, "phy device not initialized\n");
+		cpu_netdev_err(net_dev, "phy device not initialized\n");
 		return -ENODEV;
 	}
 
 	_errno = phy_ethtool_gset(priv->mac_dev->phy_dev, et_cmd);
 	if (unlikely(_errno < 0))
-		netdev_err(net_dev, "phy_ethtool_gset() = %d\n", _errno);
+		cpu_netdev_err(net_dev, "phy_ethtool_gset() = %d\n", _errno);
 
 	return _errno;
 }
@@ -68,17 +64,17 @@ static int __cold dpa_set_settings(struct net_device *net_dev, struct ethtool_cm
 	priv = netdev_priv(net_dev);
 
 	if (priv->mac_dev == NULL) {
-		netdev_info(net_dev, "This is a MAC-less interface\n");
+		cpu_netdev_info(net_dev, "This is a MAC-less interface\n");
 		return -ENODEV;
 	}
 	if (unlikely(priv->mac_dev->phy_dev == NULL)) {
-		netdev_err(net_dev, "phy device not initialized\n");
+		cpu_netdev_err(net_dev, "phy device not initialized\n");
 		return -ENODEV;
 	}
 
 	_errno = phy_ethtool_sset(priv->mac_dev->phy_dev, et_cmd);
 	if (unlikely(_errno < 0))
-		netdev_err(net_dev, "phy_ethtool_sset() = %d\n", _errno);
+		cpu_netdev_err(net_dev, "phy_ethtool_sset() = %d\n", _errno);
 
 	return _errno;
 }
@@ -94,9 +90,9 @@ static void __cold dpa_get_drvinfo(struct net_device *net_dev, struct ethtool_dr
 	_errno = snprintf(drvinfo->fw_version, sizeof(drvinfo->fw_version), "%X", 0);
 
 	if (unlikely(_errno >= sizeof(drvinfo->fw_version))) {	/* Truncated output */
-		netdev_notice(net_dev, "snprintf() = %d\n", _errno);
+		cpu_netdev_notice(net_dev, "snprintf() = %d\n", _errno);
 	} else if (unlikely(_errno < 0)) {
-		netdev_warn(net_dev, "snprintf() = %d\n", _errno);
+		cpu_netdev_warn(net_dev, "snprintf() = %d\n", _errno);
 		memset(drvinfo->fw_version, 0, sizeof(drvinfo->fw_version));
 	}
 	strncpy(drvinfo->bus_info, dev_name(net_dev->dev.parent->parent),
@@ -121,11 +117,11 @@ int __cold dpa_nway_reset(struct net_device *net_dev)
 	priv = netdev_priv(net_dev);
 
 	if (priv->mac_dev == NULL) {
-		netdev_info(net_dev, "This is a MAC-less interface\n");
+		cpu_netdev_info(net_dev, "This is a MAC-less interface\n");
 		return -ENODEV;
 	}
 	if (unlikely(priv->mac_dev->phy_dev == NULL)) {
-		netdev_err(net_dev, "phy device not initialized\n");
+		cpu_netdev_err(net_dev, "phy device not initialized\n");
 		return -ENODEV;
 	}
 
@@ -133,7 +129,7 @@ int __cold dpa_nway_reset(struct net_device *net_dev)
 	if (priv->mac_dev->phy_dev->autoneg) {
 		_errno = phy_start_aneg(priv->mac_dev->phy_dev);
 		if (unlikely(_errno < 0))
-			netdev_err(net_dev, "phy_start_aneg() = %d\n",
+			cpu_netdev_err(net_dev, "phy_start_aneg() = %d\n",
 					_errno);
 	}
 
@@ -160,11 +156,11 @@ void __cold dpa_get_pauseparam(struct net_device *net_dev, struct ethtool_pausep
 	priv = netdev_priv(net_dev);
 
 	if (priv->mac_dev == NULL) {
-		netdev_info(net_dev, "This is a MAC-less interface\n");
+		cpu_netdev_info(net_dev, "This is a MAC-less interface\n");
 		return;
 	}
 	if (unlikely(priv->mac_dev->phy_dev == NULL)) {
-		netdev_err(net_dev, "phy device not initialized\n");
+		cpu_netdev_err(net_dev, "phy device not initialized\n");
 		return;
 	}
 
@@ -178,11 +174,11 @@ int __cold dpa_set_pauseparam(struct net_device *net_dev, struct ethtool_pausepa
 	priv = netdev_priv(net_dev);
 
 	if (priv->mac_dev == NULL) {
-		netdev_info(net_dev, "This is a MAC-less interface\n");
+		cpu_netdev_info(net_dev, "This is a MAC-less interface\n");
 		return -ENODEV;
 	}
 	if (unlikely(priv->mac_dev->phy_dev == NULL)) {
-		netdev_err(net_dev, "phy device not initialized\n");
+		cpu_netdev_err(net_dev, "phy device not initialized\n");
 		return -ENODEV;
 	}
 
@@ -193,7 +189,7 @@ int __cold dpa_set_pauseparam(struct net_device *net_dev, struct ethtool_pausepa
 
 u32 dpa_get_rx_csum(struct net_device *dev)
 {
-	netdev_info(dev, "Can't automatically tell the status of "
+	cpu_netdev_info(dev, "Can't automatically tell the status of "
 		"Rx checksum validation. Feature not available yet.\n"
 		"Rx csum validation is most commonly performed (for supported "
 		"protocols) if a PCD scheme is applied on this interface.\n");
@@ -202,7 +198,7 @@ u32 dpa_get_rx_csum(struct net_device *dev)
 
 int dpa_set_rx_csum(struct net_device *dev, uint32_t data)
 {
-	netdev_info(dev, "Can't automatically %s Rx checksum validation."
+	cpu_netdev_info(dev, "Can't automatically %s Rx checksum validation."
 		"Feature not available yet.\n"
 		"Rx csum validation is most commonly performed (for supported "
 		"protocols) if a PCD scheme is applied on this interface.\n",
diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth-common.h b/drivers/net/ethernet/freescale/dpa/dpaa_eth-common.h
index 0aa504d..1a08a7e 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth-common.h
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth-common.h
@@ -37,8 +37,99 @@
 #include <linux/device.h>	/* dev_*() */
 #include <linux/smp.h>		/* smp_processor_id() */
 
+/* The basename of the source file is being compiled */
+#define __file__ KBUILD_BASENAME".c"
+
 #define __hot
 
+#define cpu_printk(level, format, arg...) \
+	pr_##level("cpu%d: " format, raw_smp_processor_id(), ##arg)
+
+#define cpu_pr_emerg(format, arg...)	\
+	cpu_printk(emerg, format, ##arg)
+#define cpu_pr_alert(format, arg...)	\
+	cpu_printk(alert, format, ##arg)
+#define cpu_pr_crit(format, arg...)	\
+	cpu_printk(crit, format, ##arg)
+#define cpu_pr_err(format, arg...)	\
+	cpu_printk(err, format, ##arg)
+#define cpu_pr_warning(format, arg...)	\
+	cpu_printk(warning, format, ##arg)
+#define cpu_pr_notice(format, arg...)	\
+	cpu_printk(notice, format, ##arg)
+#define cpu_pr_info(format, arg...)	\
+	cpu_printk(info, format, ##arg)
+#define cpu_pr_debug(format, arg...)	\
+	cpu_printk(debug, format, ##arg)
+
+/* Keep this in sync with the dev_*() definitions from linux/device.h */
+#define cpu_dev_printk(level, dev, format, arg...) \
+	cpu_pr_##level("%s: %s: " format, dev_driver_string(dev), \
+			dev_name(dev), ##arg)
+
+#define cpu_dev_emerg(dev, format, arg...)	\
+	cpu_dev_printk(emerg, dev, format, ##arg)
+#define cpu_dev_alert(dev, format, arg...)	\
+	cpu_dev_printk(alert, dev, format, ##arg)
+#define cpu_dev_crit(dev, format, arg...)	\
+	cpu_dev_printk(crit, dev, format, ##arg)
+#define cpu_dev_err(dev, format, arg...)	\
+	cpu_dev_printk(err, dev, format, ##arg)
+#define cpu_dev_warn(dev, format, arg...)	\
+	cpu_dev_printk(warning, dev, format, ##arg)
+#define cpu_dev_notice(dev, format, arg...)	\
+	cpu_dev_printk(notice, dev, format, ##arg)
+#define cpu_dev_info(dev, format, arg...)	\
+	cpu_dev_printk(info, dev, format, ##arg)
+#define cpu_dev_dbg(dev, format, arg...)	\
+	cpu_dev_printk(debug, dev, format, ##arg)
+
+#define dpaa_eth_printk(level, dev, format, arg...) \
+	cpu_dev_printk(level, dev, "%s:%hu:%s() " format, \
+			__file__, __LINE__, __func__, ##arg)
+
+#define dpaa_eth_emerg(dev, format, arg...)	\
+	dpaa_eth_printk(emerg, dev, format, ##arg)
+#define dpaa_eth_alert(dev, format, arg...)	\
+	dpaa_eth_printk(alert, dev, format, ##arg)
+#define dpaa_eth_crit(dev, format, arg...)	\
+	dpaa_eth_printk(crit, dev, format, ##arg)
+#define dpaa_eth_err(dev, format, arg...)	\
+	dpaa_eth_printk(err, dev, format, ##arg)
+#define dpaa_eth_warning(dev, format, arg...)	\
+	dpaa_eth_printk(warning, dev, format, ##arg)
+#define dpaa_eth_notice(dev, format, arg...)	\
+	dpaa_eth_printk(notice, dev, format, ##arg)
+#define dpaa_eth_info(dev, format, arg...)	\
+	dpaa_eth_printk(info, dev, format, ##arg)
+#define dpaa_eth_debug(dev, format, arg...)	\
+	dpaa_eth_printk(debug, dev, format, ##arg)
+
+#define cpu_netdev_emerg(net_dev, format, arg...)	\
+	dpaa_eth_emerg((net_dev)->dev.parent, "%s: " format, \
+			(net_dev)->name , ##arg)
+#define cpu_netdev_alert(net_dev, format, arg...)	\
+	dpaa_eth_alert((net_dev)->dev.parent, "%s: " format, \
+			(net_dev)->name , ##arg)
+#define cpu_netdev_crit(net_dev, format, arg...)	\
+	dpaa_eth_crit((net_dev)->dev.parent, "%s: " format, \
+			(net_dev)->name , ##arg)
+#define cpu_netdev_err(net_dev, format, arg...)		\
+	dpaa_eth_err((net_dev)->dev.parent, "%s: " format, \
+			(net_dev)->name , ##arg)
+#define cpu_netdev_warn(net_dev, format, arg...)	\
+	dpaa_eth_warning((net_dev)->dev.parent, "%s: " format, \
+			(net_dev)->name , ##arg)
+#define cpu_netdev_notice(net_dev, format, arg...)	\
+	dpaa_eth_notice((net_dev)->dev.parent, "%s: " format, \
+			(net_dev)->name , ##arg)
+#define cpu_netdev_info(net_dev, format, arg...)	\
+	dpaa_eth_info((net_dev)->dev.parent, "%s: " format, \
+			(net_dev)->name , ##arg)
+#define cpu_netdev_dbg(net_dev, format, arg...)		\
+	dpaa_eth_debug((net_dev)->dev.parent, "%s: " format, \
+			(net_dev)->name , ##arg)
+
 /* Simple enum of FQ types - used for array indexing */
 enum {RX, TX};
 
diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
index 44a485e..150038b 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth.c
@@ -30,10 +30,6 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
-#define pr_fmt(fmt) \
-	KBUILD_MODNAME ": %s:%hu:%s() " fmt, \
-	KBUILD_BASENAME".c", __LINE__, __func__
-
 #include <linux/init.h>
 #include <linux/module.h>
 #include <linux/sort.h>
@@ -303,7 +299,7 @@ static void dpa_bp_add_8(struct dpa_bp *dpa_bp)
 		addr = dma_map_single(dpa_bp->dev, skb->head + pad,
 				dpa_bp->size, DMA_BIDIRECTIONAL);
 		if (unlikely(dma_mapping_error(dpa_bp->dev, addr))) {
-			dev_err(dpa_bp->dev, "DMA mapping failed");
+			dpaa_eth_err(dpa_bp->dev, "DMA mapping failed");
 			break;
 		}
 
@@ -425,7 +421,7 @@ static int dpa_make_shared_port_pool(struct dpa_bp *bp)
 	bp->vaddr = devm_ioremap_prot(bp->dev, bp->paddr,
 			bp->size * bp->config_count, 0);
 	if (bp->vaddr == NULL) {
-		pr_err("Could not map memory for pool %d\n", bp->bpid);
+		cpu_pr_err("Could not map memory for pool %d\n", bp->bpid);
 		return -EIO;
 	}
 
@@ -469,7 +465,7 @@ dpa_bp_alloc(struct dpa_bp *dpa_bp)
 
 	dpa_bp->pool = bman_new_pool(&bp_params);
 	if (unlikely(dpa_bp->pool == NULL)) {
-		pr_err("bman_new_pool() failed\n");
+		cpu_pr_err("bman_new_pool() failed\n");
 		return -ENODEV;
 	}
 
@@ -591,7 +587,7 @@ _dpa_fq_alloc(struct list_head *list, struct dpa_fq *dpa_fq)
 
 	_errno = qman_create_fq(dpa_fq->fqid, dpa_fq->flags, &dpa_fq->fq_base);
 	if (_errno) {
-		dev_err(dev, "qman_create_fq() failed\n");
+		dpaa_eth_err(dev, "qman_create_fq() failed\n");
 		return _errno;
 	}
 	fq = &dpa_fq->fq_base;
@@ -630,7 +626,7 @@ _dpa_fq_alloc(struct list_head *list, struct dpa_fq *dpa_fq)
 
 		_errno = qman_init_fq(fq, QMAN_INITFQ_FLAG_SCHED, &initfq);
 		if (_errno < 0) {
-			dev_err(dev, "qman_init_fq(%u) = %d\n",
+			dpaa_eth_err(dev, "qman_init_fq(%u) = %d\n",
 					qman_fq_fqid(fq), _errno);
 			qman_destroy_fq(fq, 0);
 			return _errno;
@@ -658,12 +654,12 @@ _dpa_fq_free(struct device *dev, struct qman_fq *fq)
 	if (dpa_fq->init) {
 		_errno = qman_retire_fq(fq, NULL);
 		if (unlikely(_errno < 0) && netif_msg_drv(priv))
-			dev_err(dev, "qman_retire_fq(%u) = %d\n",
+			dpaa_eth_err(dev, "qman_retire_fq(%u) = %d\n",
 					qman_fq_fqid(fq), _errno);
 
 		__errno = qman_oos_fq(fq);
 		if (unlikely(__errno < 0) && netif_msg_drv(priv)) {
-			dev_err(dev, "qman_oos_fq(%u) = %d\n",
+			dpaa_eth_err(dev, "qman_oos_fq(%u) = %d\n",
 					qman_fq_fqid(fq), __errno);
 			if (_errno >= 0)
 				_errno = __errno;
@@ -749,7 +745,7 @@ dpa_fd_release_sg(const struct net_device *net_dev,
 		sgt = kmalloc(DPA_SGT_MAX_ENTRIES * sizeof(*sgt), GFP_ATOMIC);
 		if (sgt == NULL) {
 			if (netif_msg_tx_err(priv) && net_ratelimit())
-				netdev_err(net_dev,
+				cpu_netdev_err(net_dev,
 					"Memory allocation failed\n");
 			return;
 		}
@@ -893,9 +889,9 @@ static int dpa_change_mtu(struct net_device *net_dev, int new_mtu)
 
 	/* Make sure we don't exceed the Ethernet controller's MAXFRM */
 	if (new_mtu < min_mtu || new_mtu > max_mtu) {
-		netdev_err(net_dev, "Invalid L3 mtu %d "
-			"(must be between %d and %d).\n",
-			new_mtu, min_mtu, max_mtu);
+		cpu_netdev_err(net_dev, "Invalid L3 mtu %d "
+				"(must be between %d and %d).\n",
+				new_mtu, min_mtu, max_mtu);
 		return -EINVAL;
 	}
 	net_dev->mtu = new_mtu;
@@ -932,7 +928,9 @@ static int dpa_set_mac_address(struct net_device *net_dev, void *addr)
 	_errno = eth_mac_addr(net_dev, addr);
 	if (_errno < 0) {
 		if (netif_msg_drv(priv))
-			netdev_err(net_dev, "eth_mac_addr() = %d\n", _errno);
+			cpu_netdev_err(net_dev,
+				       "eth_mac_addr() = %d\n",
+				       _errno);
 		return _errno;
 	}
 
@@ -943,8 +941,9 @@ static int dpa_set_mac_address(struct net_device *net_dev, void *addr)
 	_errno = priv->mac_dev->change_addr(priv->mac_dev, net_dev->dev_addr);
 	if (_errno < 0) {
 		if (netif_msg_drv(priv))
-			netdev_err(net_dev,
-				"mac_dev->change_addr() = %d\n", _errno);
+			cpu_netdev_err(net_dev,
+				       "mac_dev->change_addr() = %d\n",
+				       _errno);
 		return _errno;
 	}
 
@@ -964,13 +963,14 @@ static void dpa_set_rx_mode(struct net_device *net_dev)
 	if (!!(net_dev->flags & IFF_PROMISC) != priv->mac_dev->promisc) {
 		_errno = priv->mac_dev->change_promisc(priv->mac_dev);
 		if (unlikely(_errno < 0) && netif_msg_drv(priv))
-			netdev_err(net_dev,
-				"mac_dev->change_promisc() = %d\n", _errno);
+			cpu_netdev_err(net_dev,
+					   "mac_dev->change_promisc() = %d\n",
+					   _errno);
 	}
 
 	_errno = priv->mac_dev->set_multi(net_dev);
 	if (unlikely(_errno < 0) && netif_msg_drv(priv))
-		netdev_err(net_dev, "mac_dev->set_multi() = %d\n", _errno);
+		cpu_netdev_err(net_dev, "mac_dev->set_multi() = %d\n", _errno);
 }
 
 #ifdef CONFIG_FSL_DPA_1588
@@ -1064,8 +1064,8 @@ static void _dpa_rx_error(struct net_device *net_dev,
 		pr_warn_once("fsl-dpa: non-zero error counters in fman statistics (sysfs)\n");
 	else
 		if (netif_msg_hw(priv) && net_ratelimit())
-			netdev_err(net_dev, "FD status = 0x%08x\n",
-				fd->status & FM_FD_STAT_ERRORS);
+			cpu_netdev_err(net_dev, "FD status = 0x%08x\n",
+					fd->status & FM_FD_STAT_ERRORS);
 
 	if (dpaa_eth_hooks.rx_error &&
 		dpaa_eth_hooks.rx_error(net_dev, fd, fqid) == DPAA_ETH_STOLEN)
@@ -1097,8 +1097,8 @@ static void _dpa_tx_error(struct net_device		*net_dev,
 	struct sk_buff *skb;
 
 	if (netif_msg_hw(priv) && net_ratelimit())
-		netdev_warn(net_dev, "FD status = 0x%08x\n",
-			fd->status & FM_FD_STAT_ERRORS);
+		cpu_netdev_warn(net_dev, "FD status = 0x%08x\n",
+				fd->status & FM_FD_STAT_ERRORS);
 
 	if (dpaa_eth_hooks.tx_error &&
 		dpaa_eth_hooks.tx_error(net_dev, fd, fqid) == DPAA_ETH_STOLEN)
@@ -1220,8 +1220,8 @@ void __hot _dpa_rx(struct net_device *net_dev,
 
 	if (unlikely(fd_status & FM_FD_STAT_ERRORS) != 0) {
 		if (netif_msg_hw(priv) && net_ratelimit())
-			netdev_warn(net_dev, "FD status = 0x%08x\n",
-				fd->status & FM_FD_STAT_ERRORS);
+			cpu_netdev_warn(net_dev, "FD status = 0x%08x\n",
+					fd->status & FM_FD_STAT_ERRORS);
 
 		percpu_priv->stats.rx_errors++;
 
@@ -1231,7 +1231,7 @@ void __hot _dpa_rx(struct net_device *net_dev,
 	if (unlikely(fd->format != qm_fd_contig)) {
 		percpu_priv->stats.rx_dropped++;
 		if (netif_msg_rx_status(priv) && net_ratelimit())
-			netdev_warn(net_dev, "Dropping a SG frame\n");
+			cpu_netdev_warn(net_dev, "Dropping a SG frame\n");
 		goto _return_dpa_fd_release;
 	}
 
@@ -1359,8 +1359,8 @@ static void __hot _dpa_tx_conf(struct net_device	*net_dev,
 
 	if (unlikely(fd->status & FM_FD_STAT_ERRORS) != 0) {
 		if (netif_msg_hw(priv) && net_ratelimit())
-			netdev_warn(net_dev, "FD status = 0x%08x\n",
-				fd->status & FM_FD_STAT_ERRORS);
+			cpu_netdev_warn(net_dev, "FD status = 0x%08x\n",
+					fd->status & FM_FD_STAT_ERRORS);
 
 		percpu_priv->stats.tx_errors++;
 	}
@@ -1451,7 +1451,7 @@ int dpa_enable_tx_csum(struct dpa_priv_s *priv,
 	default:
 		/* We shouldn't even be here */
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_alert(priv->net_dev, "Can't compute HW csum "
+			cpu_netdev_alert(priv->net_dev, "Can't compute HW csum "
 				"for L3 proto 0x%x\n", ntohs(skb->protocol));
 		retval = -EIO;
 		goto return_error;
@@ -1468,7 +1468,7 @@ int dpa_enable_tx_csum(struct dpa_priv_s *priv,
 	default:
 		/* This can as well be a BUG() */
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_alert(priv->net_dev, "Can't compute HW csum "
+			cpu_netdev_alert(priv->net_dev, "Can't compute HW csum "
 				"for L4 proto 0x%x\n", l4_proto);
 		retval = -EIO;
 		goto return_error;
@@ -1564,7 +1564,7 @@ static int __hot dpa_shared_tx(struct sk_buff *skb, struct net_device *net_dev)
 
 	if (unlikely(err < 0)) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "Tx HW csum error: %d\n", err);
+			cpu_netdev_err(net_dev, "Tx HW csum error: %d\n", err);
 		percpu_priv->stats.tx_errors++;
 		goto l3_l4_csum_failed;
 	}
@@ -1596,7 +1596,7 @@ static int skb_to_sg_fd(struct dpa_priv_s *priv,
 	vaddr = kmalloc(SGT_BUFFER_SIZE, GFP_ATOMIC);
 	if (unlikely(vaddr == NULL)) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "Memory allocation failed\n");
+			cpu_netdev_err(net_dev, "Memory allocation failed\n");
 		return -ENOMEM;
 	}
 	/* Store skb backpointer at the beginning of the buffer */
@@ -1613,7 +1613,7 @@ static int skb_to_sg_fd(struct dpa_priv_s *priv,
 		(char *)vaddr + DPA_TX_PRIV_DATA_SIZE);
 	if (unlikely(err < 0)) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "HW csum error: %d\n", err);
+			cpu_netdev_err(net_dev, "HW csum error: %d\n", err);
 		kfree(vaddr);
 		return err;
 	}
@@ -1623,7 +1623,7 @@ static int skb_to_sg_fd(struct dpa_priv_s *priv,
 			       DMA_TO_DEVICE);
 	if (unlikely(dma_mapping_error(dpa_bp->dev, paddr))) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "DMA mapping failed\n");
+			cpu_netdev_err(net_dev, "DMA mapping failed\n");
 		kfree(vaddr);
 		return -EINVAL;
 	}
@@ -1651,7 +1651,7 @@ static int skb_to_sg_fd(struct dpa_priv_s *priv,
 			       dpa_bp->size, DMA_TO_DEVICE);
 	if (unlikely(dma_mapping_error(dpa_bp->dev, paddr))) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "DMA mapping failed\n");
+			cpu_netdev_err(net_dev, "DMA mapping failed\n");
 		return -EINVAL;
 	}
 	sg_entry->addr_hi = upper_32_bits(paddr);
@@ -1754,7 +1754,7 @@ static int skb_to_contig_fd(struct dpa_priv_s *priv,
 				 ((char *)skbh) + DPA_TX_PRIV_DATA_SIZE);
 	if (unlikely(err < 0)) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "HW csum error: %d\n", err);
+			cpu_netdev_err(net_dev, "HW csum error: %d\n", err);
 		return err;
 	}
 
@@ -1765,7 +1765,7 @@ static int skb_to_contig_fd(struct dpa_priv_s *priv,
 	addr = dma_map_single(dpa_bp->dev, skbh, dpa_bp->size, dma_dir);
 	if (unlikely(dma_mapping_error(dpa_bp->dev, addr))) {
 		if (netif_msg_tx_err(priv)  && net_ratelimit())
-			netdev_err(net_dev, "dma_map_single() failed\n");
+			cpu_netdev_err(net_dev, "dma_map_single() failed\n");
 		return -EINVAL;
 	}
 
@@ -1947,8 +1947,8 @@ shared_rx_dqrr(struct qman_portal *portal, struct qman_fq *fq,
 
 	if (unlikely(fd->status & FM_FD_STAT_ERRORS) != 0) {
 		if (netif_msg_hw(priv) && net_ratelimit())
-			netdev_warn(net_dev, "FD status = 0x%08x\n",
-				fd->status & FM_FD_STAT_ERRORS);
+			cpu_netdev_warn(net_dev, "FD status = 0x%08x\n",
+					fd->status & FM_FD_STAT_ERRORS);
 
 		percpu_priv->stats.rx_errors++;
 
@@ -1960,7 +1960,7 @@ shared_rx_dqrr(struct qman_portal *portal, struct qman_fq *fq,
 				 GFP_ATOMIC);
 	if (unlikely(skb == NULL)) {
 		if (netif_msg_rx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "Could not alloc skb\n");
+			cpu_netdev_err(net_dev, "Could not alloc skb\n");
 
 		percpu_priv->stats.rx_dropped++;
 
@@ -1991,7 +1991,7 @@ shared_rx_dqrr(struct qman_portal *portal, struct qman_fq *fq,
 					GFP_ATOMIC);
 			if (unlikely(sgt == NULL)) {
 				if (netif_msg_tx_err(priv) && net_ratelimit())
-					netdev_err(net_dev,
+					cpu_netdev_err(net_dev,
 						"Memory allocation failed\n");
 				return -ENOMEM;
 			}
@@ -2585,7 +2585,7 @@ static int __cold dpa_start(struct net_device *net_dev)
 	err = mac_dev->init_phy(net_dev);
 	if (err < 0) {
 		if (netif_msg_ifup(priv))
-			netdev_err(net_dev, "init_phy() = %d\n", err);
+			cpu_netdev_err(net_dev, "init_phy() = %d\n", err);
 		goto init_phy_failed;
 	}
 
@@ -2595,7 +2595,7 @@ static int __cold dpa_start(struct net_device *net_dev)
 	err = priv->mac_dev->start(mac_dev);
 	if (err < 0) {
 		if (netif_msg_ifup(priv))
-			netdev_err(net_dev, "mac_dev->start() = %d\n", err);
+			cpu_netdev_err(net_dev, "mac_dev->start() = %d\n", err);
 		goto mac_start_failed;
 	}
 
@@ -2631,7 +2631,8 @@ static int __cold dpa_stop(struct net_device *net_dev)
 	_errno = mac_dev->stop(mac_dev);
 	if (unlikely(_errno < 0))
 		if (netif_msg_ifdown(priv))
-			netdev_err(net_dev, "mac_dev->stop() = %d\n", _errno);
+			cpu_netdev_err(net_dev, "mac_dev->stop() = %d\n",
+					_errno);
 
 	for_each_port_device(i, mac_dev->port_dev)
 		fm_port_disable(mac_dev->port_dev[i]);
@@ -2654,7 +2655,7 @@ static void __cold dpa_timeout(struct net_device *net_dev)
 	percpu_priv = per_cpu_ptr(priv->percpu_priv, smp_processor_id());
 
 	if (netif_msg_timer(priv))
-		netdev_crit(net_dev, "Transmit timeout latency: %u ms\n",
+		cpu_netdev_crit(net_dev, "Transmit timeout latency: %u ms\n",
 			jiffies_to_msecs(jiffies - net_dev->trans_start));
 
 	percpu_priv->stats.tx_errors++;
@@ -2707,13 +2708,13 @@ dpa_bp_probe(struct platform_device *_of_dev, size_t *count)
 
 	dpa_bp = devm_kzalloc(dev, *count * sizeof(*dpa_bp), GFP_KERNEL);
 	if (unlikely(dpa_bp == NULL)) {
-		dev_err(dev, "devm_kzalloc() failed\n");
+		dpaa_eth_err(dev, "devm_kzalloc() failed\n");
 		return ERR_PTR(-ENOMEM);
 	}
 
 	dev_node = of_find_node_by_path("/");
 	if (unlikely(dev_node == NULL)) {
-		dev_err(dev, "of_find_node_by_path(/) failed\n");
+		dpaa_eth_err(dev, "of_find_node_by_path(/) failed\n");
 		return ERR_PTR(-EINVAL);
 	}
 
@@ -2724,12 +2725,12 @@ dpa_bp_probe(struct platform_device *_of_dev, size_t *count)
 		of_node_put(dev_node);
 		dev_node = of_find_node_by_phandle(phandle_prop[i]);
 		if (unlikely(dev_node == NULL)) {
-			dev_err(dev, "of_find_node_by_phandle() failed\n");
+			dpaa_eth_err(dev, "of_find_node_by_phandle() failed\n");
 			return ERR_PTR(-EFAULT);
 		}
 
 		if (unlikely(!of_device_is_compatible(dev_node, "fsl,bpool"))) {
-			dev_err(dev,
+			dpaa_eth_err(dev,
 				"!of_device_is_compatible(%s, fsl,bpool)\n",
 				dev_node->full_name);
 			dpa_bp = ERR_PTR(-EINVAL);
@@ -2738,7 +2739,7 @@ dpa_bp_probe(struct platform_device *_of_dev, size_t *count)
 
 		bpid = of_get_property(dev_node, "fsl,bpid", &lenp);
 		if ((bpid == NULL) || (lenp != sizeof(*bpid))) {
-			dev_err(dev, "fsl,bpid property not found.\n");
+			dpaa_eth_err(dev, "fsl,bpid property not found.\n");
 			dpa_bp = ERR_PTR(-EINVAL);
 			goto _return_of_node_put;
 		}
@@ -2769,7 +2770,7 @@ dpa_bp_probe(struct platform_device *_of_dev, size_t *count)
 	}
 
 	if (has_kernel_pool && has_shared_pool) {
-		dev_err(dev, "Invalid buffer pool configuration "
+		dpaa_eth_err(dev, "Invalid buffer pool configuration "
 			"for node %s\n", dev_node->full_name);
 		dpa_bp = ERR_PTR(-EINVAL);
 		goto _return_of_node_put;
@@ -2778,7 +2779,7 @@ dpa_bp_probe(struct platform_device *_of_dev, size_t *count)
 		dpa_bp->size = DEFAULT_BUF_SIZE;
 #ifdef CONFIG_DPAA_ETH_SG_SUPPORT
 		if (dpa_bp->size > PAGE_SIZE) {
-			dev_warn(dev, "Default buffer size too large. "
+			dpaa_eth_warning(dev, "Default buffer size too large. "
 				     "Round down to PAGE_SIZE\n");
 			dpa_bp->size = PAGE_SIZE;
 		}
@@ -2807,7 +2808,7 @@ static int dpa_bp_create(struct net_device *net_dev, struct dpa_bp *dpa_bp,
 		priv->shared = 0;
 
 		if (netif_msg_probe(priv))
-			dev_info(net_dev->dev.parent,
+			cpu_dev_info(net_dev->dev.parent,
 				"Using private BM buffer pools\n");
 	} else {
 		priv->shared = 1;
@@ -2862,13 +2863,13 @@ dpa_mac_probe(struct platform_device *_of_dev)
 
 	mac_node = of_find_node_by_phandle(*phandle_prop);
 	if (unlikely(mac_node == NULL)) {
-		dev_err(dpa_dev, "of_find_node_by_phandle() failed\n");
+		dpaa_eth_err(dpa_dev, "of_find_node_by_phandle() failed\n");
 		return ERR_PTR(-EFAULT);
 	}
 
 	of_dev = of_find_device_by_node(mac_node);
 	if (unlikely(of_dev == NULL)) {
-		dev_err(dpa_dev, "of_find_device_by_node(%s) failed\n",
+		dpaa_eth_err(dpa_dev, "of_find_device_by_node(%s) failed\n",
 				mac_node->full_name);
 		of_node_put(mac_node);
 		return ERR_PTR(-EINVAL);
@@ -2879,7 +2880,7 @@ dpa_mac_probe(struct platform_device *_of_dev)
 
 	mac_dev = dev_get_drvdata(dev);
 	if (unlikely(mac_dev == NULL)) {
-		dev_err(dpa_dev, "dev_get_drvdata(%s) failed\n",
+		dpaa_eth_err(dpa_dev, "dev_get_drvdata(%s) failed\n",
 				dev_name(dev));
 		return ERR_PTR(-EINVAL);
 	}
@@ -2893,8 +2894,8 @@ dpa_mac_probe(struct platform_device *_of_dev)
 		if (timer_node && (net_dev = dev_get_drvdata(dpa_dev))) {
 			priv = netdev_priv(net_dev);
 			if (!dpa_ptp_init(priv))
-				dev_info(dev, "%s: ptp-timer enabled\n",
-					mac_node->full_name);
+				dpaa_eth_info(dev, "%s: ptp-timer enabled\n",
+						mac_node->full_name);
 		}
 	}
 #endif
@@ -3069,7 +3070,8 @@ static int __cold dpa_debugfs_open(struct inode *inode, struct file *file)
 		net_dev = (struct net_device *)inode->i_private;
 
 		if (netif_msg_drv((struct dpa_priv_s *)netdev_priv(net_dev)))
-			netdev_err(net_dev, "single_open() = %d\n", _errno);
+			cpu_netdev_err(net_dev, "single_open() = %d\n",
+					_errno);
 	}
 	return _errno;
 }
@@ -3171,7 +3173,7 @@ dpa_fq_probe(struct platform_device *_of_dev, struct list_head *list,
 		dpa_fq = devm_kzalloc(dev, sizeof(*dpa_fq) * fqids[i].count,
 					GFP_KERNEL);
 		if (dpa_fq == NULL) {
-			dev_err(dev, "devm_kzalloc() failed\n");
+			dpaa_eth_err(dev, "devm_kzalloc() failed\n");
 			return -ENOMEM;
 		}
 
@@ -3180,7 +3182,7 @@ dpa_fq_probe(struct platform_device *_of_dev, struct list_head *list,
 			*errq = dpa_fq;
 
 			if (fqids[i].count != 1) {
-				dev_err(dev, "Too many error queues!\n");
+				dpaa_eth_err(dev, "Too many error queues!\n");
 				err = -EINVAL;
 				goto invalid_error_queues;
 			}
@@ -3194,7 +3196,7 @@ dpa_fq_probe(struct platform_device *_of_dev, struct list_head *list,
 			*defq = dpa_fq;
 
 			if (fqids[i].count != 1) {
-				dev_err(dev, "Too many default queues!\n");
+				dpaa_eth_err(dev, "Too many default queues!\n");
 				err = -EINVAL;
 				goto invalid_default_queues;
 			}
@@ -3283,7 +3285,7 @@ static void dpa_setup_ingress_queues(struct dpa_priv_s *priv,
 	for_each_cpu(cpu, affine_cpus)
 		portals[num_portals++] = qman_affine_channel(cpu);
 	if (num_portals == 0) {
-		dev_err(fq->net_dev->dev.parent,
+		dpaa_eth_err(fq->net_dev->dev.parent,
 			     "No Qman software (affine) channels found");
 		return;
 	}
@@ -3358,7 +3360,7 @@ static void dpa_rx_fq_init(struct dpa_priv_s *priv, struct list_head *head,
 		return;
 
 	if (defq->fqid == 0 && netif_msg_probe(priv))
-		pr_info("Using dynamic RX QM frame queues\n");
+		cpu_pr_info("Using dynamic RX QM frame queues\n");
 
 	if (priv->shared) {
 		dpa_setup_ingress(priv, defq, &rx_shared_fq);
@@ -3381,7 +3383,7 @@ static void dpa_tx_fq_init(struct dpa_priv_s *priv, struct list_head *head,
 		return;
 
 	if (defq->fqid == 0 && netif_msg_probe(priv))
-		pr_info("Using dynamic TX QM frame queues\n");
+		cpu_pr_info("Using dynamic TX QM frame queues\n");
 
 	/* The shared driver doesn't use tx confirmation */
 	if (priv->shared) {
@@ -3406,7 +3408,7 @@ static int dpa_netdev_init(struct device_node *dpa_node,
 		mac_addr = of_get_mac_address(dpa_node);
 		if (mac_addr == NULL) {
 			if (netif_msg_probe(priv))
-				dev_err(dev, "No MAC address found!\n");
+				dpaa_eth_err(dev, "No MAC address found!\n");
 			return -EINVAL;
 		}
 	} else {
@@ -3448,7 +3450,7 @@ static int dpa_netdev_init(struct device_node *dpa_node,
 
 	err = register_netdev(net_dev);
 	if (err < 0) {
-		dev_err(dev, "register_netdev() = %d\n", err);
+		dpaa_eth_err(dev, "register_netdev() = %d\n", err);
 		return err;
 	}
 
@@ -3457,10 +3459,10 @@ static int dpa_netdev_init(struct device_node *dpa_node,
 						 dpa_debugfs_root, net_dev,
 						 &dpa_debugfs_fops);
 	if (unlikely(priv->debugfs_file == NULL)) {
-		netdev_err(net_dev, "debugfs_create_file(%s/%s/%s) = %d\n",
-			powerpc_debugfs_root->d_iname,
-			dpa_debugfs_root->d_iname,
-			net_dev->name, err);
+		cpu_netdev_err(net_dev, "debugfs_create_file(%s/%s/%s) = %d\n",
+				powerpc_debugfs_root->d_iname,
+				dpa_debugfs_root->d_iname,
+				net_dev->name, err);
 
 		unregister_netdev(net_dev);
 		return -ENOMEM;
@@ -3514,7 +3516,7 @@ static int dpa_private_netdev_init(struct device_node *dpa_node,
 int dpa_alloc_pcd_fqids(struct device *dev, uint32_t num,
 				uint8_t alignment, uint32_t *base_fqid)
 {
-	dev_crit(dev, "callback not implemented!\n");
+	dpaa_eth_crit(dev, "callback not implemented!\n");
 	BUG();
 
 	return 0;
@@ -3523,7 +3525,7 @@ int dpa_alloc_pcd_fqids(struct device *dev, uint32_t num,
 int dpa_free_pcd_fqids(struct device *dev, uint32_t base_fqid)
 {
 
-	dev_crit(dev, "callback not implemented!\n");
+	dpaa_eth_crit(dev, "callback not implemented!\n");
 	BUG();
 
 	return 0;
@@ -3663,7 +3665,7 @@ static int dpaa_eth_cgr_init(struct dpa_priv_s *priv)
 
 	err = qman_alloc_cgrid(&priv->cgr_data.cgr.cgrid);
 	if (err < 0) {
-		pr_err("Error %d allocating CGR ID\n", err);
+		cpu_pr_err("Error %d allocating CGR ID\n", err);
 		goto out_error;
 	}
 	priv->cgr_data.cgr.cb = dpaa_eth_cgscn;
@@ -3691,12 +3693,12 @@ static int dpaa_eth_cgr_init(struct dpa_priv_s *priv)
 	err = qman_create_cgr(&priv->cgr_data.cgr, QMAN_CGR_FLAG_USE_INIT,
 		&initcgr);
 	if (err < 0) {
-		pr_err("Error %d creating CGR with ID %d\n", err,
+		cpu_pr_err("Error %d creating CGR with ID %d\n", err,
 			priv->cgr_data.cgr.cgrid);
 		qman_release_cgrid(priv->cgr_data.cgr.cgrid);
 		goto out_error;
 	}
-	pr_debug("Created CGR %d for netdev with hwaddr %pM on "
+	cpu_pr_debug("Created CGR %d for netdev with hwaddr %pM on "
 		"QMan channel %d\n", priv->cgr_data.cgr.cgrid,
 		priv->mac_dev->addr, priv->cgr_data.cgr.chan);
 
@@ -3755,7 +3757,7 @@ dpaa_eth_probe(struct platform_device *_of_dev)
 	if (!proxy_enet) {
 		net_dev = alloc_etherdev_mq(sizeof(*priv), DPAA_ETH_TX_QUEUES);
 		if (!net_dev) {
-			dev_err(dev, "alloc_etherdev_mq() failed\n");
+			dpaa_eth_err(dev, "alloc_etherdev_mq() failed\n");
 			return -ENOMEM;
 		}
 
@@ -3858,7 +3860,7 @@ dpaa_eth_probe(struct platform_device *_of_dev)
 		 */
 		err = dpaa_eth_cgr_init(priv);
 		if (err < 0) {
-			dev_err(dev, "Error initializing CGR\n");
+			dpaa_eth_err(dev, "Error initializing CGR\n");
 			goto cgr_init_failed;
 		}
 
@@ -3920,7 +3922,7 @@ dpaa_eth_probe(struct platform_device *_of_dev)
 	priv->percpu_priv = __alloc_percpu(sizeof(*priv->percpu_priv),
 					   __alignof__(*priv->percpu_priv));
 	if (priv->percpu_priv == NULL) {
-		dev_err(dev, "__alloc_percpu() failed\n");
+		dpaa_eth_err(dev, "__alloc_percpu() failed\n");
 		err = -ENOMEM;
 		goto alloc_percpu_failed;
 	}
@@ -4032,7 +4034,7 @@ static int __init __cold dpa_load(void)
 {
 	int	 _errno;
 
-	printk(KERN_INFO KBUILD_MODNAME ": "DPA_DESCRIPTION " (" VERSION ")\n");
+	cpu_pr_info(KBUILD_MODNAME ": " DPA_DESCRIPTION " (" VERSION ")\n");
 
 	/* initialise dpaa_eth mirror values */
 	dpa_rx_extra_headroom = fm_get_rx_extra_headroom();
@@ -4043,19 +4045,19 @@ static int __init __cold dpa_load(void)
 					      powerpc_debugfs_root);
 	if (unlikely(dpa_debugfs_root == NULL)) {
 		_errno = -ENOMEM;
-		printk(KERN_ERR KBUILD_MODNAME ": %s:%hu:%s(): "
-			"debugfs_create_dir(%s/"KBUILD_MODNAME") = %d\n",
-			KBUILD_BASENAME".c", __LINE__, __func__,
-			powerpc_debugfs_root->d_iname, _errno);
+		cpu_pr_err(KBUILD_MODNAME ": %s:%hu:%s(): "
+			   "debugfs_create_dir(%s/"KBUILD_MODNAME") = %d\n",
+			   __file__, __LINE__, __func__,
+			   powerpc_debugfs_root->d_iname, _errno);
 		goto _return;
 	}
 #endif
 
 	_errno = platform_driver_register(&dpa_driver);
 	if (unlikely(_errno < 0)) {
-		printk(KERN_ERR KBUILD_MODNAME
+		cpu_pr_err(KBUILD_MODNAME
 			": %s:%hu:%s(): platform_driver_register() = %d\n",
-			KBUILD_BASENAME".c", __LINE__, __func__, _errno);
+			__file__, __LINE__, __func__, _errno);
 		goto _return_debugfs_remove;
 	}
 
@@ -4066,8 +4068,7 @@ _return_debugfs_remove:
 	debugfs_remove(dpa_debugfs_root);
 #endif
 _return:
-	printk(KERN_DEBUG KBUILD_MODNAME ": %s:%s() ->\n",
-		KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": %s:%s() ->\n", __file__, __func__);
 
 	return _errno;
 }
@@ -4075,8 +4076,7 @@ module_init(dpa_load);
 
 static void __exit __cold dpa_unload(void)
 {
-	printk(KERN_DEBUG KBUILD_MODNAME ": -> %s:%s()\n",
-		KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": -> %s:%s()\n", __file__, __func__);
 
 	platform_driver_unregister(&dpa_driver);
 
@@ -4084,7 +4084,6 @@ static void __exit __cold dpa_unload(void)
 	debugfs_remove(dpa_debugfs_root);
 #endif
 
-	printk(KERN_DEBUG KBUILD_MODNAME ": %s:%s() ->\n",
-		KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": %s:%s() ->\n", __file__, __func__);
 }
 module_exit(dpa_unload);
diff --git a/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c b/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
index 31a6118..96890c3 100644
--- a/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
+++ b/drivers/net/ethernet/freescale/dpa/dpaa_eth_sg.c
@@ -30,10 +30,6 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
-#define pr_fmt(fmt) \
-	KBUILD_MODNAME ": %s:%hu:%s() " fmt, \
-	KBUILD_BASENAME".c", __LINE__, __func__
-
 #include <linux/init.h>
 #include <linux/skbuff.h>
 #include <linux/highmem.h>
@@ -80,7 +76,7 @@ static void dpa_bp_add_page(struct dpa_bp *dpa_bp, unsigned long vaddr)
 	addr = dma_map_single(dpa_bp->dev, (void *)vaddr, dpa_bp->size,
 			      DMA_BIDIRECTIONAL);
 	if (unlikely(dma_mapping_error(dpa_bp->dev, addr))) {
-		dev_err(dpa_bp->dev, "DMA mapping failed");
+		dpaa_eth_err(dpa_bp->dev, "DMA mapping failed");
 		return;
 	}
 
@@ -105,7 +101,7 @@ void dpa_bp_add_8_pages(struct dpa_bp *dpa_bp, int cpu_id)
 	for (i = 0; i < 8; i++) {
 		new_page = __get_free_page(GFP_ATOMIC);
 		if (unlikely(!new_page)) {
-			dev_err(dpa_bp->dev, "__get_free_page() failed\n");
+			dpaa_eth_err(dpa_bp->dev, "__get_free_page() failed\n");
 			bm_buffer_set64(&bmb[i], 0);
 			break;
 		}
@@ -113,7 +109,7 @@ void dpa_bp_add_8_pages(struct dpa_bp *dpa_bp, int cpu_id)
 		addr = dma_map_single(dpa_bp->dev, (void *)new_page,
 				dpa_bp->size, DMA_BIDIRECTIONAL);
 		if (unlikely(dma_mapping_error(dpa_bp->dev, addr))) {
-			dev_err(dpa_bp->dev, "DMA mapping failed");
+			dpaa_eth_err(dpa_bp->dev, "DMA mapping failed");
 			free_page(new_page);
 			break;
 		}
@@ -446,8 +442,8 @@ void __hot _dpa_rx(struct net_device *net_dev,
 
 	if (unlikely(fd_status & FM_FD_STAT_ERRORS) != 0) {
 		if (netif_msg_hw(priv) && net_ratelimit())
-			netdev_warn(net_dev, "FD status = 0x%08x\n",
-				fd_status & FM_FD_STAT_ERRORS);
+			cpu_netdev_warn(net_dev, "FD status = 0x%08x\n",
+					fd_status & FM_FD_STAT_ERRORS);
 
 		percpu_priv->stats.rx_errors++;
 		goto _release_frame;
@@ -462,7 +458,8 @@ void __hot _dpa_rx(struct net_device *net_dev,
 			DPA_COPIED_HEADERS_SIZE);
 		if (unlikely(skb == NULL)) {
 			if (netif_msg_rx_err(priv) && net_ratelimit())
-				netdev_err(net_dev, "Could not alloc skb\n");
+				cpu_netdev_err(net_dev,
+						"Could not alloc skb\n");
 			percpu_priv->stats.rx_dropped++;
 			goto _release_frame;
 		}
@@ -566,7 +563,7 @@ static int __hot skb_to_contig_fd(struct dpa_priv_s *priv,
 				 ((char *)skbh) + DPA_TX_PRIV_DATA_SIZE);
 	if (unlikely(err < 0)) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "HW csum error: %d\n", err);
+			cpu_netdev_err(net_dev, "HW csum error: %d\n", err);
 		return err;
 	}
 
@@ -578,7 +575,7 @@ static int __hot skb_to_contig_fd(struct dpa_priv_s *priv,
 	addr = dma_map_single(dpa_bp->dev, skbh, dpa_bp->size, DMA_TO_DEVICE);
 	if (unlikely(dma_mapping_error(dpa_bp->dev, addr))) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "dma_map_single() failed\n");
+			cpu_netdev_err(net_dev, "dma_map_single() failed\n");
 		return -EINVAL;
 	}
 	fd->addr_hi = upper_32_bits(addr);
@@ -610,7 +607,7 @@ static int __hot skb_to_sg_fd(struct dpa_priv_s *priv,
 	/* get a new page to store the SGTable */
 	sgt_page = __get_free_page(GFP_ATOMIC);
 	if (unlikely(!sgt_page)) {
-		dev_err(dpa_bp->dev, "__get_free_page() failed\n");
+		dpaa_eth_err(dpa_bp->dev, "__get_free_page() failed\n");
 		return -ENOMEM;
 	}
 
@@ -624,7 +621,7 @@ static int __hot skb_to_sg_fd(struct dpa_priv_s *priv,
 				 (void *)sgt_page + DPA_TX_PRIV_DATA_SIZE);
 	if (unlikely(err < 0)) {
 		if (netif_msg_tx_err(priv) && net_ratelimit())
-			netdev_err(net_dev, "HW csum error: %d\n", err);
+			cpu_netdev_err(net_dev, "HW csum error: %d\n", err);
 		goto csum_failed;
 	}
 
@@ -670,7 +667,7 @@ static int __hot skb_to_sg_fd(struct dpa_priv_s *priv,
 	 */
 	sg0_page = __get_free_page(GFP_ATOMIC);
 	if (unlikely(!sg0_page)) {
-		dev_err(dpa_bp->dev, "__get_free_page() failed\n");
+		dpaa_eth_err(dpa_bp->dev, "__get_free_page() failed\n");
 		err = -ENOMEM;
 		goto sg0_page_alloc_failed;
 	}
@@ -694,7 +691,7 @@ static int __hot skb_to_sg_fd(struct dpa_priv_s *priv,
 	memcpy(buffer_start + sgt[0].offset, skb->data, skb_headlen(skb));
 	addr = dma_map_single(dpa_bp->dev, buffer_start, dpa_bp->size, dma_dir);
 	if (unlikely(dma_mapping_error(dpa_bp->dev, addr))) {
-		dev_err(dpa_bp->dev, "DMA mapping failed");
+		dpaa_eth_err(dpa_bp->dev, "DMA mapping failed");
 		err = -EINVAL;
 		goto sg0_map_failed;
 
@@ -715,7 +712,7 @@ static int __hot skb_to_sg_fd(struct dpa_priv_s *priv,
 		addr = dma_map_page(dpa_bp->dev, frag->page, frag->page_offset,
 			dpa_bp->size, dma_dir);
 		if (unlikely(dma_mapping_error(dpa_bp->dev, addr))) {
-			dev_err(dpa_bp->dev, "DMA mapping failed");
+			dpaa_eth_err(dpa_bp->dev, "DMA mapping failed");
 			err = -EINVAL;
 			goto sg_map_failed;
 		}
@@ -736,7 +733,7 @@ static int __hot skb_to_sg_fd(struct dpa_priv_s *priv,
 
 	addr = dma_map_single(dpa_bp->dev, buffer_start, dpa_bp->size, dma_dir);
 	if (unlikely(dma_mapping_error(dpa_bp->dev, addr))) {
-		dev_err(dpa_bp->dev, "DMA mapping failed");
+		dpaa_eth_err(dpa_bp->dev, "DMA mapping failed");
 		err = -EINVAL;
 		goto sgt_map_failed;
 	}
diff --git a/drivers/net/ethernet/freescale/dpa/mac-api.c b/drivers/net/ethernet/freescale/dpa/mac-api.c
index 7348976..31c4c58 100644
--- a/drivers/net/ethernet/freescale/dpa/mac-api.c
+++ b/drivers/net/ethernet/freescale/dpa/mac-api.c
@@ -29,10 +29,6 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
-#define pr_fmt(fmt) \
-	KBUILD_MODNAME ": %s:%hu:%s() " fmt, \
-	KBUILD_BASENAME".c", __LINE__, __func__
-
 #include <linux/init.h>
 #include <linux/module.h>
 #include <linux/of_platform.h>
@@ -115,7 +111,7 @@ static void mac_exception(t_Handle _mac_dev, e_FmMacExceptions exception)
 		printk(KERN_ERR "10G MAC got RX FIFO Error = %x\n", exception);
 	}
 
-	dev_dbg(mac_dev->dev, "%s:%s() -> %d\n", KBUILD_BASENAME".c", __func__,
+	cpu_dev_dbg(mac_dev->dev, "%s:%s() -> %d\n", __file__, __func__,
 		exception);
 }
 
@@ -143,7 +139,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 
 	priv->mac = FM_MAC_Config(&param);
 	if (unlikely(priv->mac == NULL)) {
-		dev_err(mac_dev->dev, "FM_MAC_Config() failed\n");
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Config() failed\n");
 		_errno = -EINVAL;
 		goto _return;
 	}
@@ -152,7 +148,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 					  fm_get_max_frm());
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0)) {
-		dev_err(mac_dev->dev,
+		dpaa_eth_err(mac_dev->dev,
 			"FM_MAC_ConfigMaxFrameLength() = 0x%08x\n", err);
 		goto _return_fm_mac_free;
 	}
@@ -162,7 +158,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 		err = FM_MAC_ConfigPadAndCrc(priv->mac, true);
 		_errno = -GET_ERROR_TYPE(err);
 		if (unlikely(_errno < 0)) {
-			dev_err(mac_dev->dev,
+			dpaa_eth_err(mac_dev->dev,
 				"FM_MAC_ConfigPadAndCrc() = 0x%08x\n", err);
 			goto _return_fm_mac_free;
 		}
@@ -170,7 +166,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 		err = FM_MAC_ConfigHalfDuplex(priv->mac, mac_dev->half_duplex);
 		_errno = -GET_ERROR_TYPE(err);
 		if (unlikely(_errno < 0)) {
-			dev_err(mac_dev->dev,
+			dpaa_eth_err(mac_dev->dev,
 				"FM_MAC_ConfigHalfDuplex() = 0x%08x\n", err);
 			goto _return_fm_mac_free;
 		}
@@ -179,7 +175,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 		err = FM_MAC_ConfigResetOnInit(priv->mac, true);
 		_errno = -GET_ERROR_TYPE(err);
 		if (unlikely(_errno < 0)) {
-			dev_err(mac_dev->dev,
+			dpaa_eth_err(mac_dev->dev,
 				"FM_MAC_ConfigResetOnInit() = 0x%08x\n", err);
 			goto _return_fm_mac_free;
 		}
@@ -188,7 +184,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 	err = FM_MAC_Init(priv->mac);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0)) {
-		dev_err(mac_dev->dev, "FM_MAC_Init() = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Init() = 0x%08x\n", err);
 		goto _return_fm_mac_free;
 	}
 
@@ -199,7 +195,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 				e_FM_MAC_EX_1G_RX_MIB_CNT_OVFL, FALSE);
 		_errno = -GET_ERROR_TYPE(err);
 		if (unlikely(_errno < 0)) {
-			dev_err(mac_dev->dev,
+			dpaa_eth_err(mac_dev->dev,
 				"FM_MAC_SetException() = 0x%08x\n", err);
 			goto _return_fm_mac_free;
 		}
@@ -212,7 +208,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 					  e_FM_MAC_EX_10G_1TX_ECC_ER, FALSE);
 		_errno = -GET_ERROR_TYPE(err);
 		if (unlikely(_errno < 0)) {
-			dev_err(mac_dev->dev,
+			dpaa_eth_err(mac_dev->dev,
 				"FM_MAC_SetException() = 0x%08x\n", err);
 			goto _return_fm_mac_free;
 		}
@@ -221,11 +217,11 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 	err = FM_MAC_GetVesrion(priv->mac, &version);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0)) {
-		dev_err(mac_dev->dev, "FM_MAC_GetVesrion() = 0x%08x\n",
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_GetVesrion() = 0x%08x\n",
 				err);
 		goto _return_fm_mac_free;
 	}
-	dev_info(mac_dev->dev, "FMan %s version: 0x%08x\n",
+	cpu_dev_info(mac_dev->dev, "FMan %s version: 0x%08x\n",
 		((macdev2enetinterface(mac_dev) != e_ENET_MODE_XGMII_10000) ?
 			"dTSEC" : "XGEC"), version);
 
@@ -235,7 +231,7 @@ static int __devinit __cold init(struct mac_device *mac_dev)
 _return_fm_mac_free:
 	err = FM_MAC_Free(priv->mac);
 	if (unlikely(-GET_ERROR_TYPE(err) < 0))
-		dev_err(mac_dev->dev, "FM_MAC_Free() = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Free() = 0x%08x\n", err);
 _return:
 	return _errno;
 }
@@ -250,7 +246,7 @@ static int __cold start(struct mac_device *mac_dev)
 			e_COMM_MODE_RX_AND_TX);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_MAC_Enable() = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Enable() = 0x%08x\n", err);
 
 	if (phy_dev) {
 		if (macdev2enetinterface(mac_dev) != e_ENET_MODE_XGMII_10000)
@@ -275,7 +271,7 @@ static int __cold stop(struct mac_device *mac_dev)
 				e_COMM_MODE_RX_AND_TX);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_MAC_Disable() = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Disable() = 0x%08x\n", err);
 
 	return _errno;
 }
@@ -290,7 +286,7 @@ static int __cold change_promisc(struct mac_device *mac_dev)
 			mac_dev->promisc = !mac_dev->promisc);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev,
+		dpaa_eth_err(mac_dev->dev,
 				"FM_MAC_SetPromiscuous() = 0x%08x\n", err);
 
 	return _errno;
@@ -316,7 +312,7 @@ static int __cold set_multi(struct net_device *net_dev)
 					       (t_EnetAddr  *)old_addr->addr);
 		_errno = -GET_ERROR_TYPE(err);
 		if (_errno < 0) {
-			dev_err(mac_dev->dev,
+			dpaa_eth_err(mac_dev->dev,
 				"FM_MAC_RemoveHashMacAddr() = 0x%08x\n", err);
 			return _errno;
 		}
@@ -330,13 +326,13 @@ static int __cold set_multi(struct net_device *net_dev)
 				(t_EnetAddr *)ha->addr);
 		_errno = -GET_ERROR_TYPE(err);
 		if (_errno < 0) {
-			dev_err(mac_dev->dev,
+			dpaa_eth_err(mac_dev->dev,
 				     "FM_MAC_AddHashMacAddr() = 0x%08x\n", err);
 			return _errno;
 		}
 		tmp = kmalloc(sizeof(struct mac_address), GFP_ATOMIC);
 		if (!tmp) {
-			dev_err(mac_dev->dev, "Out of memory\n");
+			dpaa_eth_err(mac_dev->dev, "Out of memory\n");
 			return -ENOMEM;
 		}
 		memcpy(tmp->addr, ha->addr, ETH_ALEN);
@@ -355,7 +351,7 @@ static int __cold change_addr(struct mac_device *mac_dev, uint8_t *addr)
 			(t_EnetAddr *)addr);
 	_errno = -GET_ERROR_TYPE(err);
 	if (_errno < 0)
-		dev_err(mac_dev->dev,
+		dpaa_eth_err(mac_dev->dev,
 			     "FM_MAC_ModifyMacAddr() = 0x%08x\n", err);
 
 	return _errno;
@@ -387,7 +383,8 @@ static void adjust_link(struct net_device *net_dev)
 			phy_dev->speed, phy_dev->duplex);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_MAC_AdjustLink() = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_AdjustLink() = 0x%08x\n",
+				err);
 
 	return;
 }
@@ -411,10 +408,10 @@ static int dtsec_init_phy(struct net_device *net_dev)
 		phy_dev = of_phy_connect(net_dev, mac_dev->phy_node,
 				&adjust_link, 0, mac_dev->phy_if);
 	if (unlikely(phy_dev == NULL) || IS_ERR(phy_dev)) {
-		netdev_err(net_dev, "Could not connect to PHY %s\n",
-			mac_dev->phy_node ?
-				mac_dev->phy_node->full_name :
-				mac_dev->fixed_bus_id);
+		cpu_netdev_err(net_dev, "Could not connect to PHY %s\n",
+				mac_dev->phy_node ?
+					mac_dev->phy_node->full_name :
+					mac_dev->fixed_bus_id);
 		return phy_dev == NULL ? -ENODEV : PTR_ERR(phy_dev);
 	}
 
@@ -440,10 +437,10 @@ static int xgmac_init_phy(struct net_device *net_dev)
 		phy_dev = of_phy_attach(net_dev, mac_dev->phy_node, 0,
 				mac_dev->phy_if);
 	if (unlikely(phy_dev == NULL) || IS_ERR(phy_dev)) {
-		netdev_err(net_dev, "Could not attach to PHY %s\n",
-			mac_dev->phy_node ?
-				mac_dev->phy_node->full_name :
-				mac_dev->fixed_bus_id);
+		cpu_netdev_err(net_dev, "Could not attach to PHY %s\n",
+				mac_dev->phy_node ?
+					mac_dev->phy_node->full_name :
+					mac_dev->fixed_bus_id);
 		return phy_dev == NULL ? -ENODEV : PTR_ERR(phy_dev);
 	}
 
@@ -466,12 +463,12 @@ static int __cold uninit(struct mac_device *mac_dev)
 	err = FM_MAC_Disable(priv->mac, e_COMM_MODE_RX_AND_TX);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_MAC_Disable() = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Disable() = 0x%08x\n", err);
 
 	err = FM_MAC_Free(priv->mac);
 	__errno = -GET_ERROR_TYPE(err);
 	if (unlikely(__errno < 0)) {
-		dev_err(mac_dev->dev, "FM_MAC_Free() = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Free() = 0x%08x\n", err);
 		if (_errno < 0)
 			_errno = __errno;
 	}
@@ -490,7 +487,7 @@ static int __cold ptp_enable(struct mac_device *mac_dev)
 	err = FM_MAC_Enable1588TimeStamp(priv->mac);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_MAC_Enable1588TimeStamp()"
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Enable1588TimeStamp()"
 				"= 0x%08x\n", err);
 	return _errno;
 }
@@ -506,7 +503,7 @@ static int __cold ptp_disable(struct mac_device *mac_dev)
 	err = FM_MAC_Disable1588TimeStamp(priv->mac);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_MAC_Disable1588TimeStamp()"
+		dpaa_eth_err(mac_dev->dev, "FM_MAC_Disable1588TimeStamp()"
 				"= 0x%08x\n", err);
 	return _errno;
 }
@@ -528,7 +525,7 @@ static int __cold fm_rtc_enable(struct net_device *net_dev)
 	err = FM_RTC_Enable(fm_get_rtc_handle(mac_dev->fm_dev), 0);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_RTC_Enable = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_RTC_Enable = 0x%08x\n", err);
 
 	return _errno;
 }
@@ -543,7 +540,7 @@ static int __cold fm_rtc_disable(struct net_device *net_dev)
 	err = FM_RTC_Disable(fm_get_rtc_handle(mac_dev->fm_dev));
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_RTC_Disable = 0x%08x\n", err);
+		dpaa_eth_err(mac_dev->dev, "FM_RTC_Disable = 0x%08x\n", err);
 
 	return _errno;
 }
@@ -558,7 +555,7 @@ static int __cold fm_rtc_get_cnt(struct net_device *net_dev, uint64_t *ts)
 	err = FM_RTC_GetCurrentTime(fm_get_rtc_handle(mac_dev->fm_dev), ts);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_RTC_GetCurrentTime = 0x%08x\n",
+		dpaa_eth_err(mac_dev->dev, "FM_RTC_GetCurrentTime = 0x%08x\n",
 				err);
 
 	return _errno;
@@ -574,7 +571,7 @@ static int __cold fm_rtc_set_cnt(struct net_device *net_dev, uint64_t ts)
 	err = FM_RTC_SetCurrentTime(fm_get_rtc_handle(mac_dev->fm_dev), ts);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_RTC_SetCurrentTime = 0x%08x\n",
+		dpaa_eth_err(mac_dev->dev, "FM_RTC_SetCurrentTime = 0x%08x\n",
 				err);
 
 	return _errno;
@@ -591,7 +588,7 @@ static int __cold fm_rtc_get_drift(struct net_device *net_dev, uint32_t *drift)
 			drift);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_RTC_GetFreqCompensation ="
+		dpaa_eth_err(mac_dev->dev, "FM_RTC_GetFreqCompensation ="
 				"0x%08x\n", err);
 
 	return _errno;
@@ -608,7 +605,7 @@ static int __cold fm_rtc_set_drift(struct net_device *net_dev, uint32_t drift)
 			drift);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_RTC_SetFreqCompensation ="
+		dpaa_eth_err(mac_dev->dev, "FM_RTC_SetFreqCompensation ="
 				"0x%08x\n", err);
 
 	return _errno;
@@ -657,7 +654,7 @@ static int __cold fm_rtc_set_alarm(struct net_device *net_dev, uint32_t id,
 			&alarm);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_RTC_SetAlarm ="
+		dpaa_eth_err(mac_dev->dev, "FM_RTC_SetAlarm ="
 				"0x%08x\n", err);
 
 	return _errno;
@@ -678,7 +675,7 @@ static int __cold fm_rtc_set_fiper(struct net_device *net_dev, uint32_t id,
 	err = FM_RTC_SetPeriodicPulse(fm_get_rtc_handle(mac_dev->fm_dev), &pp);
 	_errno = -GET_ERROR_TYPE(err);
 	if (unlikely(_errno < 0))
-		dev_err(mac_dev->dev, "FM_RTC_SetPeriodicPulse ="
+		dpaa_eth_err(mac_dev->dev, "FM_RTC_SetPeriodicPulse ="
 				"0x%08x\n", err);
 
 	return _errno;
diff --git a/drivers/net/ethernet/freescale/dpa/mac.c b/drivers/net/ethernet/freescale/dpa/mac.c
index dbca462..6a9458e 100644
--- a/drivers/net/ethernet/freescale/dpa/mac.c
+++ b/drivers/net/ethernet/freescale/dpa/mac.c
@@ -29,10 +29,6 @@
  * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  */
 
-#define pr_fmt(fmt) \
-	KBUILD_MODNAME ": %s:%hu:%s() " fmt, \
-	KBUILD_BASENAME".c", __LINE__, __func__
-
 #include <linux/init.h>
 #include <linux/module.h>
 #include <linux/of_platform.h>
@@ -158,7 +154,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 	mac_dev = alloc_macdev(dev, mac_sizeof_priv[i], mac_setup[i]);
 	if (IS_ERR(mac_dev)) {
 		_errno = PTR_ERR(mac_dev);
-		dev_err(dev, "alloc_macdev() = %d\n", _errno);
+		dpaa_eth_err(dev, "alloc_macdev() = %d\n", _errno);
 		goto _return;
 	}
 
@@ -167,7 +163,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 	/* Get the FM node */
 	dev_node = of_get_parent(mac_node);
 	if (unlikely(dev_node == NULL)) {
-		dev_err(dev, "of_get_parent(%s) failed\n",
+		dpaa_eth_err(dev, "of_get_parent(%s) failed\n",
 				mac_node->full_name);
 		_errno = -EINVAL;
 		goto _return_dev_set_drvdata;
@@ -175,7 +171,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 
 	of_dev = of_find_device_by_node(dev_node);
 	if (unlikely(of_dev == NULL)) {
-		dev_err(dev, "of_find_device_by_node(%s) failed\n",
+		dpaa_eth_err(dev, "of_find_device_by_node(%s) failed\n",
 				dev_node->full_name);
 		_errno = -EINVAL;
 		goto _return_of_node_put;
@@ -183,7 +179,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 
 	mac_dev->fm_dev = fm_bind(&of_dev->dev);
 	if (unlikely(mac_dev->fm_dev == NULL)) {
-		dev_err(dev, "fm_bind(%s) failed\n", dev_node->full_name);
+		dpaa_eth_err(dev, "fm_bind(%s) failed\n", dev_node->full_name);
 		_errno = -ENODEV;
 		goto _return_of_node_put;
 	}
@@ -194,7 +190,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 	/* Get the address of the memory mapped registers */
 	_errno = of_address_to_resource(mac_node, 0, &res);
 	if (unlikely(_errno < 0)) {
-		dev_err(dev, "of_address_to_resource(%s) = %d\n",
+		dpaa_eth_err(dev, "of_address_to_resource(%s) = %d\n",
 				mac_node->full_name, _errno);
 		goto _return_dev_set_drvdata;
 	}
@@ -204,7 +200,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 		fm_get_mem_region(mac_dev->fm_dev),
 		res.start, res.end + 1 - res.start, "mac");
 	if (unlikely(mac_dev->res == NULL)) {
-		dev_err(dev, "__devm_request_mem_region(mac) failed\n");
+		dpaa_eth_err(dev, "__devm_request_mem_region(mac) failed\n");
 		_errno = -EBUSY;
 		goto _return_dev_set_drvdata;
 	}
@@ -212,7 +208,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 	mac_dev->vaddr = devm_ioremap(dev, mac_dev->res->start,
 				      mac_dev->res->end + 1 - mac_dev->res->start);
 	if (unlikely(mac_dev->vaddr == NULL)) {
-		dev_err(dev, "devm_ioremap() failed\n");
+		dpaa_eth_err(dev, "devm_ioremap() failed\n");
 		_errno = -EIO;
 		goto _return_dev_set_drvdata;
 	}
@@ -247,7 +243,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 	/* Get the cell-index */
 	uint32_prop = of_get_property(mac_node, "cell-index", &lenp);
 	if (unlikely(uint32_prop == NULL)) {
-		dev_err(dev, "of_get_property(%s, cell-index) failed\n",
+		dpaa_eth_err(dev, "of_get_property(%s, cell-index) failed\n",
 				mac_node->full_name);
 		_errno = -EINVAL;
 		goto _return_dev_set_drvdata;
@@ -258,7 +254,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 	/* Get the MAC address */
 	mac_addr = of_get_mac_address(mac_node);
 	if (unlikely(mac_addr == NULL)) {
-		dev_err(dev, "of_get_mac_address(%s) failed\n",
+		dpaa_eth_err(dev, "of_get_mac_address(%s) failed\n",
 				mac_node->full_name);
 		_errno = -EINVAL;
 		goto _return_dev_set_drvdata;
@@ -268,7 +264,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 	/* Get the port handles */
 	phandle_prop = of_get_property(mac_node, "fsl,port-handles", &lenp);
 	if (unlikely(phandle_prop == NULL)) {
-		dev_err(dev, "of_get_property(%s, port-handles) failed\n",
+		dpaa_eth_err(dev, "of_get_property(%s, port-handles) failed\n",
 				mac_node->full_name);
 		_errno = -EINVAL;
 		goto _return_dev_set_drvdata;
@@ -279,14 +275,14 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 		/* Find the port node */
 		dev_node = of_find_node_by_phandle(phandle_prop[i]);
 		if (unlikely(dev_node == NULL)) {
-			dev_err(dev, "of_find_node_by_phandle() failed\n");
+			dpaa_eth_err(dev, "of_find_node_by_phandle() failed\n");
 			_errno = -EINVAL;
 			goto _return_of_node_put;
 		}
 
 		of_dev = of_find_device_by_node(dev_node);
 		if (unlikely(of_dev == NULL)) {
-			dev_err(dev, "of_find_device_by_node(%s) failed\n",
+			dpaa_eth_err(dev, "of_find_device_by_node(%s) failed\n",
 					dev_node->full_name);
 			_errno = -EINVAL;
 			goto _return_of_node_put;
@@ -294,7 +290,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 
 		mac_dev->port_dev[i] = fm_port_bind(&of_dev->dev);
 		if (unlikely(mac_dev->port_dev[i] == NULL)) {
-			dev_err(dev, "dev_get_drvdata(%s) failed\n",
+			dpaa_eth_err(dev, "dev_get_drvdata(%s) failed\n",
 					dev_node->full_name);
 			_errno = -EINVAL;
 			goto _return_of_node_put;
@@ -306,10 +302,10 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 	char_prop = (const char *)of_get_property(mac_node,
 						"phy-connection-type", NULL);
 	if (unlikely(char_prop == NULL)) {
-		dev_warn(dev,
-			"of_get_property(%s, phy-connection-type) "
-			"failed. Defaulting to MII\n",
-			mac_node->full_name);
+		dpaa_eth_warning(dev,
+				"of_get_property(%s, phy-connection-type) "
+				"failed. Defaulting to MII\n",
+				mac_node->full_name);
 		mac_dev->phy_if = PHY_INTERFACE_MODE_MII;
 	} else
 		mac_dev->phy_if = str2phy(char_prop);
@@ -339,7 +335,7 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 		const u32 *phy_id = of_get_property(mac_node, "fixed-link",
 							&sz);
 		if (!phy_id || sz < sizeof(*phy_id)) {
-			dev_err(dev, "No PHY (or fixed link) found\n");
+			cpu_dev_err(dev, "No PHY (or fixed link) found\n");
 			_errno = -EINVAL;
 			goto _return_dev_set_drvdata;
 		}
@@ -349,14 +345,14 @@ static int __devinit __cold mac_probe(struct platform_device *_of_dev)
 
 	_errno = mac_dev->init(mac_dev);
 	if (unlikely(_errno < 0)) {
-		dev_err(dev, "mac_dev->init() = %d\n", _errno);
+		dpaa_eth_err(dev, "mac_dev->init() = %d\n", _errno);
 		goto _return_dev_set_drvdata;
 	}
 
-	dev_info(dev,
+	cpu_dev_info(dev,
 		"FMan MAC address: %02hx:%02hx:%02hx:%02hx:%02hx:%02hx\n",
-		mac_dev->addr[0], mac_dev->addr[1], mac_dev->addr[2],
-		mac_dev->addr[3], mac_dev->addr[4], mac_dev->addr[5]);
+		     mac_dev->addr[0], mac_dev->addr[1], mac_dev->addr[2],
+		     mac_dev->addr[3], mac_dev->addr[4], mac_dev->addr[5]);
 
 	goto _return;
 
@@ -401,25 +397,23 @@ static int __init __cold mac_load(void)
 {
 	int	 _errno;
 
-	printk(KERN_DEBUG KBUILD_MODNAME ": -> %s:%s()\n",
-		KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": -> %s:%s()\n", __file__, __func__);
 
-	printk(KERN_INFO KBUILD_MODNAME ": %s (" VERSION ")\n",
+	cpu_pr_info(KBUILD_MODNAME ": %s (" VERSION ")\n",
 		mac_driver_description);
 
 	_errno = platform_driver_register(&mac_driver);
 	if (unlikely(_errno < 0)) {
-		printk(KERN_ERR KBUILD_MODNAME ": %s:%hu:%s(): "\
-			"of_register_platform_driver() = %d\n",
-			KBUILD_BASENAME".c", __LINE__, __func__, _errno);
+		cpu_pr_err(KBUILD_MODNAME ": %s:%hu:%s(): " \
+			"platform_driver_register() = %d\n",
+			   __file__, __LINE__, __func__, _errno);
 		goto _return;
 	}
 
 	goto _return;
 
 _return:
-	printk(KERN_DEBUG KBUILD_MODNAME ": %s:%s() ->\n",
-		KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": %s:%s() ->\n", __file__, __func__);
 
 	return _errno;
 }
@@ -427,12 +421,10 @@ module_init(mac_load);
 
 static void __exit __cold mac_unload(void)
 {
-	printk(KERN_DEBUG KBUILD_MODNAME ": -> %s:%s()\n",
-		KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": -> %s:%s()\n", __file__, __func__);
 
 	platform_driver_unregister(&mac_driver);
 
-	printk(KERN_DEBUG KBUILD_MODNAME ": %s:%s() ->\n",
-		KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": %s:%s() ->\n", __file__, __func__);
 }
 module_exit(mac_unload);
diff --git a/drivers/net/ethernet/freescale/dpa/offline_port.c b/drivers/net/ethernet/freescale/dpa/offline_port.c
index b4bc3c8..9db069f 100644
--- a/drivers/net/ethernet/freescale/dpa/offline_port.c
+++ b/drivers/net/ethernet/freescale/dpa/offline_port.c
@@ -35,10 +35,6 @@
  * Validates device-tree configuration and sets up the offline ports.
  */
 
-#define pr_fmt(fmt) \
-	KBUILD_MODNAME ": %s:%hu:%s() " fmt, \
-	KBUILD_BASENAME".c", __LINE__, __func__
-
 #include <linux/init.h>
 #include <linux/module.h>
 #include <linux/of_platform.h>
@@ -83,7 +79,7 @@ static int __devinit __cold oh_alloc_pcd_fqids(struct device *dev,
 	uint8_t alignment,
 	uint32_t *base_fqid)
 {
-	dev_crit(dev, "callback not implemented!\n");
+	cpu_dev_crit(dev, "callback not implemented!\n");
 	BUG();
 
 	return 0;
@@ -91,7 +87,7 @@ static int __devinit __cold oh_alloc_pcd_fqids(struct device *dev,
 
 static int __devinit __cold oh_free_pcd_fqids(struct device *dev, uint32_t base_fqid)
 {
-	dev_crit(dev, "callback not implemented!\n");
+	dpaa_eth_crit(dev, "callback not implemented!\n");
 	BUG();
 
 	return 0;
@@ -126,7 +122,7 @@ oh_port_probe(struct platform_device *_of_dev)
 	if (!match)
 		return -EINVAL;
 
-	dev_dbg(dpa_oh_dev, "Probing OH port...\n");
+	cpu_dev_dbg(dpa_oh_dev, "Probing OH port...\n");
 
 	/*
 	 * Find the referenced OH node
@@ -135,27 +131,28 @@ oh_port_probe(struct platform_device *_of_dev)
 	oh_port_handle = of_get_property(dpa_oh_node,
 		"fsl,fman-oh-port", &lenp);
 	if (oh_port_handle == NULL) {
-		dev_err(dpa_oh_dev, "No OH port handle found in node %s\n",
+		cpu_dev_err(dpa_oh_dev, "No OH port handle found in node %s\n",
 			dpa_oh_node->full_name);
 		return -EINVAL;
 	}
 
 	BUG_ON(lenp % sizeof(*oh_port_handle));
 	if (lenp != sizeof(*oh_port_handle)) {
-		dev_err(dpa_oh_dev, "Found %lu OH port bindings in node %s, "
-			"only 1 phandle is allowed.\n",
-			(unsigned long int)(lenp / sizeof(*oh_port_handle)), dpa_oh_node->full_name);
+		cpu_dev_err(dpa_oh_dev, "Found %lu OH port bindings in node %s,"
+			" only 1 phandle is allowed.\n",
+			(unsigned long int)(lenp / sizeof(*oh_port_handle)),
+			dpa_oh_node->full_name);
 		return -EINVAL;
 	}
 
 	/* Read configuration for the OH port */
 	oh_node = of_find_node_by_phandle(*oh_port_handle);
 	if (oh_node == NULL) {
-		dev_err(dpa_oh_dev, "Can't find OH node referenced from "
+		cpu_dev_err(dpa_oh_dev, "Can't find OH node referenced from "
 			"node %s\n", dpa_oh_node->full_name);
 		return -EINVAL;
 	}
-	dev_info(dpa_oh_dev, "Found OH node handle compatible with %s.\n",
+	cpu_dev_info(dpa_oh_dev, "Found OH node handle compatible with %s.\n",
 		match->compatible);
 
 	oh_of_dev = of_find_device_by_node(oh_node);
@@ -180,7 +177,7 @@ oh_port_probe(struct platform_device *_of_dev)
 
 	/* If we aren't the "owner" of the OH node, we're done here. */
 	if (!init_oh_port) {
-		dev_dbg(dpa_oh_dev, "Not owning the shared OH port %s, "
+		cpu_dev_dbg(dpa_oh_dev, "Not owning the shared OH port %s, "
 			"will not initialize it.\n", oh_node->full_name);
 		return 0;
 	}
@@ -188,7 +185,7 @@ oh_port_probe(struct platform_device *_of_dev)
 	/* Allocate OH dev private data */
 	oh_config = devm_kzalloc(dpa_oh_dev, sizeof(*oh_config), GFP_KERNEL);
 	if (oh_config == NULL) {
-		dev_err(dpa_oh_dev, "Can't allocate private data for "
+		cpu_dev_err(dpa_oh_dev, "Can't allocate private data for "
 			"OH node %s referenced from node %s!\n",
 			oh_node->full_name, dpa_oh_node->full_name);
 		return -ENOMEM;
@@ -200,7 +197,7 @@ oh_port_probe(struct platform_device *_of_dev)
 	oh_all_queues = (uint32_t *)of_get_property(dpa_oh_node,
 		"fsl,qman-frame-queues-oh", &lenp);
 	if (oh_all_queues == NULL) {
-		dev_err(dpa_oh_dev, "No frame queues have been "
+		cpu_dev_err(dpa_oh_dev, "No frame queues have been "
 			"defined for OH node %s referenced from node %s\n",
 			oh_node->full_name, dpa_oh_node->full_name);
 		_errno = -EINVAL;
@@ -211,7 +208,7 @@ oh_port_probe(struct platform_device *_of_dev)
 	BUG_ON(lenp % (2 * sizeof(*oh_all_queues)));
 	queues_count = lenp / (2 * sizeof(*oh_all_queues));
 	if (queues_count != 2) {
-		dev_err(dpa_oh_dev, "Error and Default queues must be "
+		dpaa_eth_err(dpa_oh_dev, "Error and Default queues must be "
 			"defined for OH node %s referenced from node %s\n",
 			oh_node->full_name, dpa_oh_node->full_name);
 		_errno = -EINVAL;
@@ -219,14 +216,14 @@ oh_port_probe(struct platform_device *_of_dev)
 	}
 
 	/* Read the FQIDs defined for this OH port */
-	dev_dbg(dpa_oh_dev, "Reading %d queues...\n", queues_count);
+	cpu_dev_dbg(dpa_oh_dev, "Reading %d queues...\n", queues_count);
 	fq_idx = 0;
 
 	/* Error FQID - must be present */
 	crt_fqid_base = oh_all_queues[fq_idx++];
 	crt_fq_count = oh_all_queues[fq_idx++];
 	if (crt_fq_count != 1) {
-		dev_err(dpa_oh_dev, "Only 1 Error FQ allowed in OH node %s "
+		cpu_dev_err(dpa_oh_dev, "Only 1 Error FQ allowed in OH node %s "
 			"referenced from node %s (read: %d FQIDs).\n",
 			oh_node->full_name, dpa_oh_node->full_name,
 			crt_fq_count);
@@ -234,14 +231,14 @@ oh_port_probe(struct platform_device *_of_dev)
 		goto return_kfree;
 	}
 	oh_config->error_fqid = crt_fqid_base;
-	dev_dbg(dpa_oh_dev, "Read Error FQID 0x%x for OH port %s.\n",
+	cpu_dev_dbg(dpa_oh_dev, "Read Error FQID 0x%x for OH port %s.\n",
 		oh_config->error_fqid, oh_node->full_name);
 
 	/* Default FQID - must be present */
 	crt_fqid_base = oh_all_queues[fq_idx++];
 	crt_fq_count = oh_all_queues[fq_idx++];
 	if (crt_fq_count != 1) {
-		dev_err(dpa_oh_dev, "Only 1 Default FQ allowed "
+		cpu_dev_err(dpa_oh_dev, "Only 1 Default FQ allowed "
 			"in OH node %s referenced from %s (read: %d FQIDs).\n",
 			oh_node->full_name, dpa_oh_node->full_name,
 			crt_fq_count);
@@ -249,14 +246,14 @@ oh_port_probe(struct platform_device *_of_dev)
 		goto return_kfree;
 	}
 	oh_config->default_fqid = crt_fqid_base;
-	dev_dbg(dpa_oh_dev, "Read Default FQID 0x%x for OH port %s.\n",
+	cpu_dev_dbg(dpa_oh_dev, "Read Default FQID 0x%x for OH port %s.\n",
 		oh_config->default_fqid, oh_node->full_name);
 
 	/* Get a handle to the fm_port so we can set
 	 * its configuration params */
 	oh_config->oh_port = fm_port_bind(oh_dev);
 	if (oh_config->oh_port == NULL) {
-		dev_err(dpa_oh_dev, "NULL drvdata from fm port dev %s!\n",
+		cpu_dev_err(dpa_oh_dev, "NULL drvdata from fm port dev %s!\n",
 			oh_node->full_name);
 		_errno = -EINVAL;
 		goto return_kfree;
@@ -276,7 +273,7 @@ oh_port_probe(struct platform_device *_of_dev)
 
 	/* Enable the OH port */
 	fm_port_enable(oh_config->oh_port);
-	dev_info(dpa_oh_dev, "OH port %s enabled.\n", oh_node->full_name);
+	cpu_dev_info(dpa_oh_dev, "OH port %s enabled.\n", oh_node->full_name);
 
 	return 0;
 
@@ -290,20 +287,20 @@ static int __devexit __cold oh_port_remove(struct platform_device *_of_dev)
 	int _errno = 0;
 	struct dpa_oh_config_s *oh_config;
 
-	pr_info("Removing OH port...\n");
+	cpu_pr_info("Removing OH port...\n");
 
 	oh_config = dev_get_drvdata(&_of_dev->dev);
 	if (oh_config == NULL) {
-		printk(KERN_ERR KBUILD_MODNAME
+		cpu_pr_err(KBUILD_MODNAME
 			": %s:%hu:%s(): No OH config in device private data!\n",
-			KBUILD_BASENAME".c", __LINE__, __func__);
+			__file__, __LINE__, __func__);
 		_errno = -ENODEV;
 		goto return_error;
 	}
 	if (oh_config->oh_port == NULL) {
-		printk(KERN_ERR KBUILD_MODNAME
+		cpu_pr_err(KBUILD_MODNAME
 			": %s:%hu:%s(): No fm port in device private data!\n",
-			KBUILD_BASENAME".c", __LINE__, __func__);
+			__file__, __LINE__, __func__);
 		_errno = -EINVAL;
 		goto return_error;
 	}
@@ -320,26 +317,26 @@ static int __init __cold oh_port_load(void)
 {
 	int _errno;
 
-	pr_info(KBUILD_MODNAME ": " OH_MOD_DESCRIPTION " (" VERSION ")\n");
+	cpu_pr_info(KBUILD_MODNAME ": " OH_MOD_DESCRIPTION " (" VERSION ")\n");
 
 	_errno = platform_driver_register(&oh_port_driver);
 	if (_errno < 0) {
-		printk(KERN_ERR KBUILD_MODNAME
+		cpu_pr_err(KBUILD_MODNAME
 			": %s:%hu:%s(): platform_driver_register() = %d\n",
-			KBUILD_BASENAME".c", __LINE__, __func__, _errno);
+			__file__, __LINE__, __func__, _errno);
 	}
 
-	pr_debug(KBUILD_MODNAME ": %s:%s()->\n", KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": %s:%s() ->\n", __file__, __func__);
 	return _errno;
 }
 module_init(oh_port_load);
 
 static void __exit __cold oh_port_unload(void)
 {
-	pr_debug(KBUILD_MODNAME ":-> %s:%s()\n", KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": -> %s:%s()\n", __file__, __func__);
 
 	platform_driver_unregister(&oh_port_driver);
 
-	pr_debug(KBUILD_MODNAME ": %s:%s()->\n", KBUILD_BASENAME".c", __func__);
+	cpu_pr_debug(KBUILD_MODNAME ": %s:%s() ->\n", __file__, __func__);
 }
 module_exit(oh_port_unload);
-- 
1.7.9.7

