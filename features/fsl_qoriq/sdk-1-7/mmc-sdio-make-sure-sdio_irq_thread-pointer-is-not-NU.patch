From 8405b0ea3c4be2ba092b829f716a97160a9cc5ec Mon Sep 17 00:00:00 2001
From: Qiu Wujie <b49553@freescale.com>
Date: Mon, 17 Nov 2014 14:06:29 +0800
Subject: [PATCH 245/399] mmc: sdio: make sure sdio_irq_thread pointer is not
 NULL.

Signed-off-by: Wujie Qiu <B49553@freescale.com>
Change-Id: Icf01605c71a19e0ffa01e85b1ed93eb0704493da
Reviewed-on: http://git.am.freescale.net:8181/23831
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Xiaobo Xie <X.Xie@freescale.com>
Reviewed-by: Matthew Weigel <Matthew.Weigel@freescale.com>
[Lu:Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto.iso]
Signed-off-by: Jiang Lu <lu.jiang@windriver.com>
---
 include/linux/mmc/host.h |    3 ++-
 1 files changed, 2 insertions(+), 1 deletions(-)

diff --git a/include/linux/mmc/host.h b/include/linux/mmc/host.h
index d583bf9..f6f4aeb 100644
--- a/include/linux/mmc/host.h
+++ b/include/linux/mmc/host.h
@@ -395,7 +395,8 @@ static inline void mmc_signal_sdio_irq(struct mmc_host *host)
 {
 	host->ops->enable_sdio_irq(host, 0);
 	host->sdio_irq_pending = true;
-	wake_up_process(host->sdio_irq_thread);
+	if (host->sdio_irq_thread)
+		wake_up_process(host->sdio_irq_thread);
 }
 
 #ifdef CONFIG_REGULATOR
-- 
1.7.5.4

