From e70c8d18dff85db164dfa04a9277b50decd86e1a Mon Sep 17 00:00:00 2001
From: Shaohui Xie <Shaohui.Xie@freescale.com>
Date: Tue, 18 Nov 2014 17:05:49 +0800
Subject: [PATCH 1/3] ahci: added freescale AHCI to platform compatible list

Signed-off-by: Shaohui Xie <Shaohui.Xie@freescale.com>
Change-Id: Icfc5b97394f3443762fca8cf1fee6a44ea5874e6
Reviewed-on: http://git.am.freescale.net:8181/31840
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Xiaobo Xie <X.Xie@freescale.com>
Reviewed-by: Zhengxiong Jin <Jason.Jin@freescale.com>
[Zhenbo: Original patch taken from FSL QorIQ SDK v1.8 SOURCE yocto.iso,
made some trivial modifications to fix the conflict.]
Signed-off-by: Zhenbo Gao <zhenbo.gao@windriver.com>
---
 .../devicetree/bindings/ata/ahci-platform.txt      |    4 +++-
 drivers/ata/ahci_platform.c                        |    1 +
 2 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/Documentation/devicetree/bindings/ata/ahci-platform.txt b/Documentation/devicetree/bindings/ata/ahci-platform.txt
index 89de156..e23a450 100644
--- a/Documentation/devicetree/bindings/ata/ahci-platform.txt
+++ b/Documentation/devicetree/bindings/ata/ahci-platform.txt
@@ -4,7 +4,9 @@ SATA nodes are defined to describe on-chip Serial ATA controllers.
 Each SATA controller should have its own node.
 
 Required properties:
-- compatible        : compatible list, contains "snps,spear-ahci"
+- compatible        : compatible list, contains 
+ - "snps,spear-ahci"
+ - "fsl,<chip>-ahci"
 - interrupts        : <interrupt mapping for SATA IRQ>
 - reg               : <registers mapping>
 
diff --git a/drivers/ata/ahci_platform.c b/drivers/ata/ahci_platform.c
index 62c73da..4045ad2 100644
--- a/drivers/ata/ahci_platform.c
+++ b/drivers/ata/ahci_platform.c
@@ -331,6 +331,7 @@ disable_unprepare_clk:
 static SIMPLE_DEV_PM_OPS(ahci_pm_ops, ahci_suspend, ahci_resume);
 
 static const struct of_device_id ahci_of_match[] = {
+	{ .compatible = "fsl,ls1021a-ahci", },
 	{ .compatible = "snps,spear-ahci", },
 	{ .compatible = "snps,exynos5440-ahci", },
 	{ .compatible = "ibm,476gtr-ahci", },
-- 
1.7.5.4

