From f9152bf00f649a312eb767cf35f84b185670ddee Mon Sep 17 00:00:00 2001
From: Chenhui Zhao <chenhui.zhao@freescale.com>
Date: Fri, 24 Oct 2014 15:50:01 +0800
Subject: [PATCH 042/128] pm: ls1: diable QE device to make deep sleep work

The temporary workaround will disable the QE device before entering
deep sleep. It makes deep sleep work, and should be removed after
resolving the problem.

Signed-off-by: Chenhui Zhao <chenhui.zhao@freescale.com>
Change-Id: Ib8c079ef67773eb3e058cf03331a0ed9c7707113
Reviewed-on: http://git.am.freescale.net:8181/21981
Tested-by: Review Code-CDREVIEW <CDREVIEW@freescale.com>
Reviewed-by: Zhengxiong Jin <Jason.Jin@freescale.com>
[Xulin: Original patch taken from
QorIQ-SDK-V1.7-SOURCE-20141218-yocto_RDS_20150206.iso]
Signed-off-by: Xulin Sun <xulin.sun@windriver.com>
---
 arch/arm/mach-imx/pm-ls1.c |    3 +++
 1 files changed, 3 insertions(+), 0 deletions(-)

diff --git a/arch/arm/mach-imx/pm-ls1.c b/arch/arm/mach-imx/pm-ls1.c
index ed4292a..bdcd92b 100644
--- a/arch/arm/mach-imx/pm-ls1.c
+++ b/arch/arm/mach-imx/pm-ls1.c
@@ -241,6 +241,9 @@ static void ls1_enter_deepsleep(void)
 {
 	u32 tmp;
 
+	/* disable QE device to make deep sleep work  */
+	iowrite32be(0x00000001, ls1_pm_base.dcfg + 0x70);
+
 	/* save DDR data */
 	ls1_save_ddr(ls1_pm_base.scfg);
 
-- 
1.7.5.4

