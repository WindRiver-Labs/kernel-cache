From 32325b07ba7e302f5ba80734d887ccc6ea5d6437 Mon Sep 17 00:00:00 2001
From: Ioana Radulescu <ruxandra.radulescu@nxp.com>
Date: Wed, 4 Jan 2017 18:38:23 +0200
Subject: [PATCH 334/388] staging: fsl-dpaa2/eth: Don't use GRO flush timeout

It turns out this causes unnacceptable latency in some
scenarios. So just go back to using napi_complete() instead of
napi_complete_done().

Signed-off-by: Ioana Radulescu <ruxandra.radulescu@nxp.com>
[Original patch taken from SDK-V2.0-1703]
Signed-off-by: Yanjiang Jin <yanjiang.jin@windriver.com>
---
 drivers/staging/fsl-dpaa2/ethernet/dpaa2-eth.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/drivers/staging/fsl-dpaa2/ethernet/dpaa2-eth.c b/drivers/staging/fsl-dpaa2/ethernet/dpaa2-eth.c
index bf78ff9..2210f2e 100644
--- a/drivers/staging/fsl-dpaa2/ethernet/dpaa2-eth.c
+++ b/drivers/staging/fsl-dpaa2/ethernet/dpaa2-eth.c
@@ -1070,7 +1070,7 @@ static int dpaa2_eth_poll(struct napi_struct *napi, int budget)
 
 	/* We didn't consume the entire budget, finish napi and
 	 * re-enable data availability notifications */
-	napi_complete_done(napi, cleaned);
+	napi_complete(napi);
 	do {
 		err = dpaa2_io_service_rearm(NULL, &ch->nctx);
 		cpu_relax();
-- 
2.9.3

