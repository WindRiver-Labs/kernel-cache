From 6a426935fa7229380b1b6e894b9461959e8dfb88 Mon Sep 17 00:00:00 2001
From: Allan Stephens <allan.stephens@windriver.com>
Date: Wed, 10 Nov 2010 22:22:14 -0800
Subject: [PATCH 08/22] tipc: Revert "Eliminate useless linked list initialization"

commit 588fb5329755929b069bd9f63bc7c923e6cc8d41 from
http://tipc.cslab.ericsson.net/cgi-bin/gitweb.cgi?p=people/allan/tipc.git;a=shortlog;h=tipc1.7

Restore a linked list initialization step during port creation
that was optimized out by commit aada77372861d5ca93e4c49062e512c895319b40.
(Although the optimization is currently correct, future changes to
Linux's linked list macros could make the initialization step necessary.)

Signed-off-by: Allan Stephens <allan.stephens@windriver.com>
Integrated-by: Howard Xu <Hao.Xu@windriver.com>
---
 net/tipc/tipc_port.c |    1 +
 1 files changed, 1 insertions(+), 0 deletions(-)

diff --git a/net/tipc/tipc_port.c b/net/tipc/tipc_port.c
index a73bb97..b0a41c6 100644
--- a/net/tipc/tipc_port.c
+++ b/net/tipc/tipc_port.c
@@ -247,6 +247,7 @@ struct tipc_port *tipc_createport_raw(void *usr_handle,
 	p_ptr->user_port = NULL;
 	k_init_timer(&p_ptr->timer, (Handler)port_timeout, ref);
 	INIT_LIST_HEAD(&p_ptr->publications);
+	INIT_LIST_HEAD(&p_ptr->port_list);
 
 	/*
 	 * Must hold port list lock while initializing message header template
-- 
1.6.5.2

